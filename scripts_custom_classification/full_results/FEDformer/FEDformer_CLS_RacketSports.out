Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.642353057861328
Epoch: 1, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.167 Vali Acc: 0.592 Test Loss: 1.167 Test Acc: 0.592
Validation loss decreased (inf --> -0.592094).  Saving model ...
Epoch: 2 cost time: 1.8685557842254639
Epoch: 2, Steps: 10 | Train Loss: 0.915 Vali Loss: 0.892 Vali Acc: 0.638 Test Loss: 0.892 Test Acc: 0.638
Validation loss decreased (-0.592094 --> -0.638149).  Saving model ...
Epoch: 3 cost time: 1.9427378177642822
Epoch: 3, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.776 Vali Acc: 0.684 Test Loss: 0.776 Test Acc: 0.684
Validation loss decreased (-0.638149 --> -0.684203).  Saving model ...
Epoch: 4 cost time: 1.8336732387542725
Epoch: 4, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.694 Vali Acc: 0.743 Test Loss: 0.694 Test Acc: 0.743
Validation loss decreased (-0.684203 --> -0.743414).  Saving model ...
Epoch: 5 cost time: 1.8821868896484375
Epoch: 5, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.649 Vali Acc: 0.763 Test Loss: 0.649 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763151).  Saving model ...
Epoch: 6 cost time: 2.0436246395111084
Epoch: 6, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782888).  Saving model ...
Epoch: 7 cost time: 1.9442288875579834
Epoch: 7, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.699 Vali Acc: 0.816 Test Loss: 0.699 Test Acc: 0.816
Validation loss decreased (-0.782888 --> -0.815782).  Saving model ...
Epoch: 8 cost time: 2.202350616455078
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.736 Vali Acc: 0.816 Test Loss: 0.736 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.03705096244812
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.751 Vali Acc: 0.822 Test Loss: 0.751 Test Acc: 0.822
Validation loss decreased (-0.815782 --> -0.822361).  Saving model ...
Epoch: 10 cost time: 2.0082569122314453
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.777 Vali Acc: 0.809 Test Loss: 0.777 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.086919069290161
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.803 Test Loss: 0.812 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9616179466247559
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.840 Vali Acc: 0.809 Test Loss: 0.840 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7595672607421875
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.859 Vali Acc: 0.809 Test Loss: 0.859 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7797799110412598
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.809 Test Loss: 0.871 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8744840621948242
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.889 Vali Acc: 0.803 Test Loss: 0.889 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8298993110656738
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.909 Vali Acc: 0.803 Test Loss: 0.909 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.902284860610962
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.927 Vali Acc: 0.809 Test Loss: 0.927 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8747034072875977
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.938 Vali Acc: 0.809 Test Loss: 0.938 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0208206176757812
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.951 Vali Acc: 0.809 Test Loss: 0.951 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 12482052
model size : 67.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5071003437042236
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.219 Vali Acc: 0.546 Test Loss: 1.219 Test Acc: 0.546
Validation loss decreased (inf --> -0.546040).  Saving model ...
Epoch: 2 cost time: 2.0131916999816895
Epoch: 2, Steps: 10 | Train Loss: 0.971 Vali Loss: 0.950 Vali Acc: 0.625 Test Loss: 0.950 Test Acc: 0.625
Validation loss decreased (-0.546040 --> -0.624990).  Saving model ...
Epoch: 3 cost time: 1.9747891426086426
Epoch: 3, Steps: 10 | Train Loss: 0.516 Vali Loss: 0.806 Vali Acc: 0.684 Test Loss: 0.806 Test Acc: 0.684
Validation loss decreased (-0.624990 --> -0.684202).  Saving model ...
Epoch: 4 cost time: 1.8867263793945312
Epoch: 4, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.718 Vali Acc: 0.757 Test Loss: 0.718 Test Acc: 0.757
Validation loss decreased (-0.684202 --> -0.756572).  Saving model ...
Epoch: 5 cost time: 1.9728467464447021
Epoch: 5, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 6 cost time: 1.8103277683258057
Epoch: 6, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.687 Vali Acc: 0.770 Test Loss: 0.687 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9185807704925537
Epoch: 7, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.712 Vali Acc: 0.796 Test Loss: 0.712 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796046).  Saving model ...
Epoch: 8 cost time: 1.9113185405731201
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.748 Vali Acc: 0.796 Test Loss: 0.748 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1554057598114014
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.778 Vali Acc: 0.789 Test Loss: 0.778 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.046795129776001
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.807 Vali Acc: 0.803 Test Loss: 0.807 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 11 cost time: 2.1359851360321045
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.840 Vali Acc: 0.803 Test Loss: 0.840 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1540768146514893
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.871 Vali Acc: 0.809 Test Loss: 0.871 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809202).  Saving model ...
Epoch: 13 cost time: 2.019294500350952
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.891 Vali Acc: 0.809 Test Loss: 0.891 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9135301113128662
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.905 Vali Acc: 0.809 Test Loss: 0.905 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.906181812286377
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.919 Vali Acc: 0.809 Test Loss: 0.919 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0468850135803223
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.932 Vali Acc: 0.809 Test Loss: 0.932 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9578466415405273
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.951 Vali Acc: 0.796 Test Loss: 0.951 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1617379188537598
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.961 Vali Acc: 0.796 Test Loss: 0.961 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.989361047744751
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.973 Vali Acc: 0.796 Test Loss: 0.973 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.181411027908325
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.803 Test Loss: 0.983 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3431029319763184
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.796 Test Loss: 0.997 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.180795907974243
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.015 Vali Acc: 0.796 Test Loss: 1.015 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 12482052
model size : 67.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.533842086791992
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.310 Vali Acc: 0.395 Test Loss: 1.310 Test Acc: 0.395
Validation loss decreased (inf --> -0.394724).  Saving model ...
Epoch: 2 cost time: 2.0140774250030518
Epoch: 2, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.394724 --> -0.532884).  Saving model ...
Epoch: 3 cost time: 2.006842851638794
Epoch: 3, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.838 Vali Acc: 0.684 Test Loss: 0.838 Test Acc: 0.684
Validation loss decreased (-0.532884 --> -0.684202).  Saving model ...
Epoch: 4 cost time: 2.084378480911255
Epoch: 4, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.713 Vali Acc: 0.697 Test Loss: 0.713 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697361).  Saving model ...
Epoch: 5 cost time: 2.2224366664886475
Epoch: 5, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.653 Vali Acc: 0.743 Test Loss: 0.653 Test Acc: 0.743
Validation loss decreased (-0.697361 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 2.2348592281341553
Epoch: 6, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.675 Vali Acc: 0.763 Test Loss: 0.675 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763151).  Saving model ...
Epoch: 7 cost time: 2.3827271461486816
Epoch: 7, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.678 Vali Acc: 0.763 Test Loss: 0.678 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.131540060043335
Epoch: 8, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.735 Vali Acc: 0.770 Test Loss: 0.735 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769729).  Saving model ...
Epoch: 9 cost time: 2.340221643447876
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.802 Vali Acc: 0.783 Test Loss: 0.802 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782887).  Saving model ...
Epoch: 10 cost time: 2.2549338340759277
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.850 Vali Acc: 0.789 Test Loss: 0.850 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789465).  Saving model ...
Epoch: 11 cost time: 2.047093629837036
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.879 Vali Acc: 0.789 Test Loss: 0.879 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3923232555389404
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.905 Vali Acc: 0.783 Test Loss: 0.905 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1137750148773193
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.919 Vali Acc: 0.783 Test Loss: 0.919 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1400017738342285
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.783 Test Loss: 0.930 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3864450454711914
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.938 Vali Acc: 0.783 Test Loss: 0.938 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0139245986938477
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.944 Vali Acc: 0.789 Test Loss: 0.944 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.135911703109741
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.954 Vali Acc: 0.789 Test Loss: 0.954 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.29074764251709
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.962 Vali Acc: 0.783 Test Loss: 0.962 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1611204147338867
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.972 Vali Acc: 0.789 Test Loss: 0.972 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.2179951667785645
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.982 Vali Acc: 0.789 Test Loss: 0.982 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 12482052
model size : 67.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.59218692779541
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.360 Vali Acc: 0.342 Test Loss: 1.360 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 2.1039538383483887
Epoch: 2, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
Validation loss decreased (-0.342092 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 1.953974723815918
Epoch: 3, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.934 Vali Acc: 0.592 Test Loss: 0.934 Test Acc: 0.592
Validation loss decreased (-0.499989 --> -0.592096).  Saving model ...
Epoch: 4 cost time: 1.9732661247253418
Epoch: 4, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.780 Vali Acc: 0.671 Test Loss: 0.780 Test Acc: 0.671
Validation loss decreased (-0.592096 --> -0.671045).  Saving model ...
Epoch: 5 cost time: 2.0662789344787598
Epoch: 5, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.722 Vali Acc: 0.724 Test Loss: 0.722 Test Acc: 0.724
Validation loss decreased (-0.671045 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 2.0160574913024902
Epoch: 6, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.690 Vali Acc: 0.776 Test Loss: 0.690 Test Acc: 0.776
Validation loss decreased (-0.723677 --> -0.776309).  Saving model ...
Epoch: 7 cost time: 2.0630853176116943
Epoch: 7, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.695 Vali Acc: 0.796 Test Loss: 0.695 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796046).  Saving model ...
Epoch: 8 cost time: 2.338165521621704
Epoch: 8, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0992939472198486
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.771 Vali Acc: 0.789 Test Loss: 0.771 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1216912269592285
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.803 Vali Acc: 0.796 Test Loss: 0.803 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.213155508041382
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.823 Vali Acc: 0.803 Test Loss: 0.823 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802623).  Saving model ...
Epoch: 12 cost time: 2.2015841007232666
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.848 Vali Acc: 0.803 Test Loss: 0.848 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1596288681030273
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.863 Vali Acc: 0.796 Test Loss: 0.863 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1583690643310547
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.874 Vali Acc: 0.803 Test Loss: 0.874 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.987058162689209
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.884 Vali Acc: 0.803 Test Loss: 0.884 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.970757246017456
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.896 Vali Acc: 0.803 Test Loss: 0.896 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9959135055541992
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.912 Vali Acc: 0.796 Test Loss: 0.912 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0477871894836426
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.924 Vali Acc: 0.796 Test Loss: 0.924 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1878395080566406
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.803 Test Loss: 0.933 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0889437198638916
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.941 Vali Acc: 0.803 Test Loss: 0.941 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.093799591064453
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.950 Vali Acc: 0.796 Test Loss: 0.950 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 12482052
model size : 67.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6921567916870117
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.388 Vali Acc: 0.303 Test Loss: 1.388 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 2.101936101913452
Epoch: 2, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.200 Vali Acc: 0.467 Test Loss: 1.200 Test Acc: 0.467
Validation loss decreased (-0.302618 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 2.277332305908203
Epoch: 3, Steps: 10 | Train Loss: 0.867 Vali Loss: 0.956 Vali Acc: 0.645 Test Loss: 0.956 Test Acc: 0.645
Validation loss decreased (-0.467093 --> -0.644727).  Saving model ...
Epoch: 4 cost time: 2.0833635330200195
Epoch: 4, Steps: 10 | Train Loss: 0.522 Vali Loss: 0.848 Vali Acc: 0.671 Test Loss: 0.848 Test Acc: 0.671
Validation loss decreased (-0.644727 --> -0.671044).  Saving model ...
Epoch: 5 cost time: 2.1358675956726074
Epoch: 5, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.770 Vali Acc: 0.704 Test Loss: 0.770 Test Acc: 0.704
Validation loss decreased (-0.671044 --> -0.703940).  Saving model ...
Epoch: 6 cost time: 2.296820878982544
Epoch: 6, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.820 Vali Acc: 0.737 Test Loss: 0.820 Test Acc: 0.737
Validation loss decreased (-0.703940 --> -0.736834).  Saving model ...
Epoch: 7 cost time: 2.1498095989227295
Epoch: 7, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.824 Vali Acc: 0.757 Test Loss: 0.824 Test Acc: 0.757
Validation loss decreased (-0.736834 --> -0.756571).  Saving model ...
Epoch: 8 cost time: 2.1897475719451904
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.919 Vali Acc: 0.763 Test Loss: 0.919 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763149).  Saving model ...
Epoch: 9 cost time: 2.309603214263916
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.975 Vali Acc: 0.776 Test Loss: 0.975 Test Acc: 0.776
Validation loss decreased (-0.763149 --> -0.776306).  Saving model ...
Epoch: 10 cost time: 2.383143663406372
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.025 Vali Acc: 0.783 Test Loss: 1.025 Test Acc: 0.783
Validation loss decreased (-0.776306 --> -0.782884).  Saving model ...
Epoch: 11 cost time: 2.040971517562866
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.079 Vali Acc: 0.783 Test Loss: 1.079 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.00661563873291
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.112 Vali Acc: 0.776 Test Loss: 1.112 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0612924098968506
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.122 Vali Acc: 0.776 Test Loss: 1.122 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1279170513153076
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.122 Vali Acc: 0.776 Test Loss: 1.122 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.938852310180664
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.134 Vali Acc: 0.776 Test Loss: 1.134 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.021164655685425
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.147 Vali Acc: 0.776 Test Loss: 1.147 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2582223415374756
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.157 Vali Acc: 0.776 Test Loss: 1.157 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.331620216369629
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.164 Vali Acc: 0.776 Test Loss: 1.164 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.174894094467163
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.178 Vali Acc: 0.776 Test Loss: 1.178 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.255060911178589
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.190 Vali Acc: 0.776 Test Loss: 1.190 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 12482052
model size : 67.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8492398262023926
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.351 Vali Acc: 0.309 Test Loss: 1.351 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.8988816738128662
Epoch: 2, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.150 Vali Acc: 0.513 Test Loss: 1.150 Test Acc: 0.513
Validation loss decreased (-0.309197 --> -0.513146).  Saving model ...
Epoch: 3 cost time: 2.0067543983459473
Epoch: 3, Steps: 10 | Train Loss: 0.854 Vali Loss: 0.915 Vali Acc: 0.645 Test Loss: 0.915 Test Acc: 0.645
Validation loss decreased (-0.513146 --> -0.644728).  Saving model ...
Epoch: 4 cost time: 2.0219223499298096
Epoch: 4, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.795 Vali Acc: 0.678 Test Loss: 0.795 Test Acc: 0.678
Validation loss decreased (-0.644728 --> -0.677624).  Saving model ...
Epoch: 5 cost time: 2.241624593734741
Epoch: 5, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.748 Vali Acc: 0.737 Test Loss: 0.748 Test Acc: 0.737
Validation loss decreased (-0.677624 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 2.4236669540405273
Epoch: 6, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.771 Vali Acc: 0.737 Test Loss: 0.771 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3080005645751953
Epoch: 7, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.796 Vali Acc: 0.776 Test Loss: 0.796 Test Acc: 0.776
Validation loss decreased (-0.736835 --> -0.776308).  Saving model ...
Epoch: 8 cost time: 2.2163915634155273
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.859 Vali Acc: 0.763 Test Loss: 0.859 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9166655540466309
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.884 Vali Acc: 0.789 Test Loss: 0.884 Test Acc: 0.789
Validation loss decreased (-0.776308 --> -0.789465).  Saving model ...
Epoch: 10 cost time: 2.139601230621338
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.944 Vali Acc: 0.776 Test Loss: 0.944 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.185532331466675
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.988 Vali Acc: 0.776 Test Loss: 0.988 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.157120704650879
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.019 Vali Acc: 0.770 Test Loss: 1.019 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9478833675384521
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.039 Vali Acc: 0.776 Test Loss: 1.039 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1197659969329834
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.056 Vali Acc: 0.776 Test Loss: 1.056 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.148649215698242
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.776 Test Loss: 1.077 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.403123617172241
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.093 Vali Acc: 0.776 Test Loss: 1.093 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0389177799224854
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.102 Vali Acc: 0.783 Test Loss: 1.102 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.020700454711914
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.106 Vali Acc: 0.783 Test Loss: 1.106 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1623547077178955
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.114 Vali Acc: 0.783 Test Loss: 1.114 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 12482052
model size : 67.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7868728637695312
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 2.026611089706421
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 1.9559226036071777
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.230249 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 2.073589324951172
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 5 cost time: 2.013704776763916
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 6 cost time: 2.3738465309143066
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 7 cost time: 2.100739002227783
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 8 cost time: 1.9803247451782227
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 9 cost time: 2.276670455932617
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 10 cost time: 2.3178000450134277
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 11 cost time: 2.194509506225586
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 12 cost time: 2.188096046447754
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 13 cost time: 2.3105175495147705
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 14 cost time: 2.0470097064971924
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.263144 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 1.9579474925994873
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 2.0692248344421387
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 2.166139841079712
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 2.2423460483551025
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 2.0956718921661377
Epoch: 19, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 2.1797127723693848
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 1.9726176261901855
Epoch: 21, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.055415391921997
Epoch: 22, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 2.0250935554504395
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1349289417266846
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 2.225602626800537
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 2.291844129562378
Epoch: 26, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.19754958152771
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.0101239681243896
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 1.8826401233673096
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.0462541580200195
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 1.9143316745758057
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 2.191784381866455
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.27009916305542
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.124070405960083
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.1400279998779297
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 1.962496280670166
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.1121718883514404
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 1.9869427680969238
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.0191900730133057
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.326685667037964
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 2.230266571044922
Epoch: 41, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 2.1820738315582275
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.0624213218688965
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.2108302116394043
Epoch: 44, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 45 cost time: 1.9195890426635742
Epoch: 45, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.1212966442108154
Epoch: 46, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.996518850326538
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 48 cost time: 2.0970394611358643
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.1350955963134766
Epoch: 49, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.3822121620178223
Epoch: 50, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.054657220840454
Epoch: 51, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 52 cost time: 2.374194622039795
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.9928014278411865
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.9991600513458252
Epoch: 54, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.9942054748535156
Epoch: 55, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.9211573600769043
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.9884755611419678
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.8926153182983398
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 2.378220796585083
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 2.1716136932373047
Epoch: 60, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 2.150139808654785
Epoch: 61, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 12482052
model size : 67.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4832024574279785
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.214 Vali Acc: 0.507 Test Loss: 1.214 Test Acc: 0.507
Validation loss decreased (inf --> -0.506567).  Saving model ...
Epoch: 2 cost time: 2.2651758193969727
Epoch: 2, Steps: 10 | Train Loss: 0.959 Vali Loss: 0.924 Vali Acc: 0.632 Test Loss: 0.924 Test Acc: 0.632
Validation loss decreased (-0.506567 --> -0.631570).  Saving model ...
Epoch: 3 cost time: 2.1945462226867676
Epoch: 3, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.806 Vali Acc: 0.684 Test Loss: 0.806 Test Acc: 0.684
Validation loss decreased (-0.631570 --> -0.684202).  Saving model ...
Epoch: 4 cost time: 2.2136800289154053
Epoch: 4, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.741 Vali Acc: 0.704 Test Loss: 0.741 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703940).  Saving model ...
Epoch: 5 cost time: 2.2331418991088867
Epoch: 5, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.648 Vali Acc: 0.763 Test Loss: 0.648 Test Acc: 0.763
Validation loss decreased (-0.703940 --> -0.763151).  Saving model ...
Epoch: 6 cost time: 2.1856064796447754
Epoch: 6, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.674 Vali Acc: 0.776 Test Loss: 0.674 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 7 cost time: 2.2219245433807373
Epoch: 7, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 8 cost time: 2.086052656173706
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.735 Vali Acc: 0.796 Test Loss: 0.735 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 9 cost time: 1.9601004123687744
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.782 Vali Acc: 0.789 Test Loss: 0.782 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.087242603302002
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.808 Vali Acc: 0.783 Test Loss: 0.808 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.012850522994995
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.831 Vali Acc: 0.789 Test Loss: 0.831 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1189639568328857
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.849 Vali Acc: 0.796 Test Loss: 0.849 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.127955436706543
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.858 Vali Acc: 0.796 Test Loss: 0.858 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3060836791992188
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.872 Vali Acc: 0.796 Test Loss: 0.872 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1156911849975586
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.887 Vali Acc: 0.796 Test Loss: 0.887 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1567556858062744
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.796 Test Loss: 0.899 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.201201915740967
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.919 Vali Acc: 0.796 Test Loss: 0.919 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9496417045593262
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.934 Vali Acc: 0.796 Test Loss: 0.934 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 9336324
model size : 55.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.569065809249878
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.242 Vali Acc: 0.493 Test Loss: 1.242 Test Acc: 0.493
Validation loss decreased (inf --> -0.493409).  Saving model ...
Epoch: 2 cost time: 2.091501235961914
Epoch: 2, Steps: 10 | Train Loss: 1.001 Vali Loss: 0.982 Vali Acc: 0.572 Test Loss: 0.982 Test Acc: 0.572
Validation loss decreased (-0.493409 --> -0.572359).  Saving model ...
Epoch: 3 cost time: 2.1978490352630615
Epoch: 3, Steps: 10 | Train Loss: 0.625 Vali Loss: 0.850 Vali Acc: 0.645 Test Loss: 0.850 Test Acc: 0.645
Validation loss decreased (-0.572359 --> -0.644728).  Saving model ...
Epoch: 4 cost time: 2.1503970623016357
Epoch: 4, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.756 Vali Acc: 0.730 Test Loss: 0.756 Test Acc: 0.730
Validation loss decreased (-0.644728 --> -0.730256).  Saving model ...
Epoch: 5 cost time: 2.26932954788208
Epoch: 5, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.684 Vali Acc: 0.743 Test Loss: 0.684 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 6 cost time: 2.061305284500122
Epoch: 6, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.703 Vali Acc: 0.770 Test Loss: 0.703 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769730).  Saving model ...
Epoch: 7 cost time: 1.8561673164367676
Epoch: 7, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.725 Vali Acc: 0.776 Test Loss: 0.725 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 8 cost time: 2.100188732147217
Epoch: 8, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.744 Vali Acc: 0.803 Test Loss: 0.744 Test Acc: 0.803
Validation loss decreased (-0.776309 --> -0.802624).  Saving model ...
Epoch: 9 cost time: 1.9727051258087158
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.791 Vali Acc: 0.796 Test Loss: 0.791 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2683823108673096
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.823 Vali Acc: 0.809 Test Loss: 0.823 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809202).  Saving model ...
Epoch: 11 cost time: 2.1386091709136963
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.849 Vali Acc: 0.796 Test Loss: 0.849 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.288228988647461
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.866 Vali Acc: 0.796 Test Loss: 0.866 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0946457386016846
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.873 Vali Acc: 0.796 Test Loss: 0.873 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1753885746002197
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.889 Vali Acc: 0.803 Test Loss: 0.889 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.022103786468506
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.907 Vali Acc: 0.803 Test Loss: 0.907 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.086909532546997
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.803 Test Loss: 0.917 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0707623958587646
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.803 Test Loss: 0.935 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.001911163330078
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.946 Vali Acc: 0.796 Test Loss: 0.946 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8690919876098633
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.803 Test Loss: 0.958 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1588358879089355
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.964 Vali Acc: 0.803 Test Loss: 0.964 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 9336324
model size : 55.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9264986515045166
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.276 Vali Acc: 0.428 Test Loss: 1.276 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 2.1218042373657227
Epoch: 2, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.049 Vali Acc: 0.566 Test Loss: 1.049 Test Acc: 0.566
Validation loss decreased (-0.427619 --> -0.565779).  Saving model ...
Epoch: 3 cost time: 1.9940211772918701
Epoch: 3, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.837 Vali Acc: 0.664 Test Loss: 0.837 Test Acc: 0.664
Validation loss decreased (-0.565779 --> -0.664465).  Saving model ...
Epoch: 4 cost time: 2.1051008701324463
Epoch: 4, Steps: 10 | Train Loss: 0.403 Vali Loss: 0.698 Vali Acc: 0.724 Test Loss: 0.698 Test Acc: 0.724
Validation loss decreased (-0.664465 --> -0.723677).  Saving model ...
Epoch: 5 cost time: 1.9495933055877686
Epoch: 5, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.649 Vali Acc: 0.750 Test Loss: 0.649 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 1.9338605403900146
Epoch: 6, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.691 Vali Acc: 0.743 Test Loss: 0.691 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1706576347351074
Epoch: 7, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.697 Vali Acc: 0.789 Test Loss: 0.697 Test Acc: 0.789
Validation loss decreased (-0.749994 --> -0.789467).  Saving model ...
Epoch: 8 cost time: 2.043532371520996
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.729 Vali Acc: 0.789 Test Loss: 0.729 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.191707134246826
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.799 Vali Acc: 0.783 Test Loss: 0.799 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.181544065475464
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.846 Vali Acc: 0.776 Test Loss: 0.846 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2039787769317627
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.868 Vali Acc: 0.776 Test Loss: 0.868 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2264926433563232
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.877 Vali Acc: 0.783 Test Loss: 0.877 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3241260051727295
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.885 Vali Acc: 0.789 Test Loss: 0.885 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.198941469192505
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.901 Vali Acc: 0.789 Test Loss: 0.901 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3258557319641113
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.789 Test Loss: 0.917 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.381502389907837
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.929 Vali Acc: 0.789 Test Loss: 0.929 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1077208518981934
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.949 Vali Acc: 0.789 Test Loss: 0.949 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 9336324
model size : 55.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.073800563812256
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.330 Vali Acc: 0.368 Test Loss: 1.330 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 2.2572362422943115
Epoch: 2, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (-0.368408 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 2.3068039417266846
Epoch: 3, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.939 Vali Acc: 0.592 Test Loss: 0.939 Test Acc: 0.592
Validation loss decreased (-0.499988 --> -0.592096).  Saving model ...
Epoch: 4 cost time: 2.269883632659912
Epoch: 4, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.798 Vali Acc: 0.625 Test Loss: 0.798 Test Acc: 0.625
Validation loss decreased (-0.592096 --> -0.624992).  Saving model ...
Epoch: 5 cost time: 2.262763500213623
Epoch: 5, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.711 Vali Acc: 0.743 Test Loss: 0.711 Test Acc: 0.743
Validation loss decreased (-0.624992 --> -0.743414).  Saving model ...
Epoch: 6 cost time: 2.018223524093628
Epoch: 6, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.720 Vali Acc: 0.750 Test Loss: 0.720 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 1.9454305171966553
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.718 Vali Acc: 0.770 Test Loss: 0.718 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 2.174467086791992
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.764 Vali Acc: 0.770 Test Loss: 0.764 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2193851470947266
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.830 Vali Acc: 0.789 Test Loss: 0.830 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789465).  Saving model ...
Epoch: 10 cost time: 2.05808162689209
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.856 Vali Acc: 0.783 Test Loss: 0.856 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2906196117401123
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.864 Vali Acc: 0.776 Test Loss: 0.864 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.95326566696167
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.876 Vali Acc: 0.783 Test Loss: 0.876 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8668122291564941
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.889 Vali Acc: 0.789 Test Loss: 0.889 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.024244546890259
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.907 Vali Acc: 0.783 Test Loss: 0.907 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9027509689331055
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.916 Vali Acc: 0.783 Test Loss: 0.916 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2428388595581055
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.929 Vali Acc: 0.783 Test Loss: 0.929 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4352493286132812
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.944 Vali Acc: 0.789 Test Loss: 0.944 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.232149600982666
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.950 Vali Acc: 0.789 Test Loss: 0.950 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.4059433937072754
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.789 Test Loss: 0.959 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 9336324
model size : 55.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3874220848083496
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.374 Vali Acc: 0.309 Test Loss: 1.374 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.9405841827392578
Epoch: 2, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.214 Vali Acc: 0.493 Test Loss: 1.214 Test Acc: 0.493
Validation loss decreased (-0.309197 --> -0.493409).  Saving model ...
Epoch: 3 cost time: 2.270495891571045
Epoch: 3, Steps: 10 | Train Loss: 0.925 Vali Loss: 0.941 Vali Acc: 0.671 Test Loss: 0.941 Test Acc: 0.671
Validation loss decreased (-0.493409 --> -0.671043).  Saving model ...
Epoch: 4 cost time: 2.1890580654144287
Epoch: 4, Steps: 10 | Train Loss: 0.534 Vali Loss: 0.792 Vali Acc: 0.684 Test Loss: 0.792 Test Acc: 0.684
Validation loss decreased (-0.671043 --> -0.684203).  Saving model ...
Epoch: 5 cost time: 2.419017791748047
Epoch: 5, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
Validation loss decreased (-0.684203 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 2.2220520973205566
Epoch: 6, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.750 Vali Acc: 0.757 Test Loss: 0.750 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756571).  Saving model ...
Epoch: 7 cost time: 2.0741231441497803
Epoch: 7, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.822 Vali Acc: 0.770 Test Loss: 0.822 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769729).  Saving model ...
Epoch: 8 cost time: 2.0000438690185547
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.864 Vali Acc: 0.783 Test Loss: 0.864 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782886).  Saving model ...
Epoch: 9 cost time: 2.103529453277588
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.944 Vali Acc: 0.776 Test Loss: 0.944 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2839620113372803
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.966 Vali Acc: 0.789 Test Loss: 0.966 Test Acc: 0.789
Validation loss decreased (-0.782886 --> -0.789464).  Saving model ...
Epoch: 11 cost time: 2.273174524307251
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.009 Vali Acc: 0.776 Test Loss: 1.009 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2448620796203613
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.045 Vali Acc: 0.776 Test Loss: 1.045 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2780399322509766
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.055 Vali Acc: 0.783 Test Loss: 1.055 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.185194730758667
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.058 Vali Acc: 0.783 Test Loss: 1.058 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1262364387512207
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.062 Vali Acc: 0.783 Test Loss: 1.062 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0199472904205322
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.068 Vali Acc: 0.783 Test Loss: 1.068 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.198701858520508
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.783 Test Loss: 1.087 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.294992446899414
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.783 Test Loss: 1.105 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.2957534790039062
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.114 Vali Acc: 0.783 Test Loss: 1.114 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.5186047554016113
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.121 Vali Acc: 0.783 Test Loss: 1.121 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 9336324
model size : 55.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4702134132385254
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.411 Vali Acc: 0.289 Test Loss: 1.411 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.082542657852173
Epoch: 2, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.218 Vali Acc: 0.487 Test Loss: 1.218 Test Acc: 0.487
Validation loss decreased (-0.289460 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 2.1753294467926025
Epoch: 3, Steps: 10 | Train Loss: 0.911 Vali Loss: 0.939 Vali Acc: 0.664 Test Loss: 0.939 Test Acc: 0.664
Validation loss decreased (-0.486830 --> -0.664464).  Saving model ...
Epoch: 4 cost time: 2.2388267517089844
Epoch: 4, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.774 Vali Acc: 0.684 Test Loss: 0.774 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684203).  Saving model ...
Epoch: 5 cost time: 2.2041189670562744
Epoch: 5, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.724 Vali Acc: 0.757 Test Loss: 0.724 Test Acc: 0.757
Validation loss decreased (-0.684203 --> -0.756572).  Saving model ...
Epoch: 6 cost time: 2.285656452178955
Epoch: 6, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.726 Vali Acc: 0.776 Test Loss: 0.726 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 7 cost time: 2.23360013961792
Epoch: 7, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.805 Vali Acc: 0.763 Test Loss: 0.805 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3357927799224854
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.837 Vali Acc: 0.783 Test Loss: 0.837 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782886).  Saving model ...
Epoch: 9 cost time: 2.0101444721221924
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.910 Vali Acc: 0.783 Test Loss: 0.910 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1061723232269287
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.932 Vali Acc: 0.783 Test Loss: 0.932 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9795887470245361
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.960 Vali Acc: 0.789 Test Loss: 0.960 Test Acc: 0.789
Validation loss decreased (-0.782886 --> -0.789464).  Saving model ...
Epoch: 12 cost time: 1.992206335067749
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.985 Vali Acc: 0.783 Test Loss: 0.985 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2403571605682373
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.999 Vali Acc: 0.783 Test Loss: 0.999 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1874895095825195
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.016 Vali Acc: 0.783 Test Loss: 1.016 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0931990146636963
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.031 Vali Acc: 0.783 Test Loss: 1.031 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2014355659484863
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.038 Vali Acc: 0.783 Test Loss: 1.038 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1445159912109375
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.783 Test Loss: 1.055 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.059528350830078
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.069 Vali Acc: 0.783 Test Loss: 1.069 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.997406244277954
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.783 Test Loss: 1.079 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8597877025604248
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.085 Vali Acc: 0.783 Test Loss: 1.085 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9615490436553955
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.098 Vali Acc: 0.789 Test Loss: 1.098 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 9336324
model size : 55.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8860199451446533
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.2354650497436523
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 1.8982243537902832
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8953299522399902
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 5 cost time: 1.8725199699401855
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 6 cost time: 2.008958578109741
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 7 cost time: 2.063293695449829
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 8 cost time: 2.0955512523651123
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 9 cost time: 2.1946680545806885
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 10 cost time: 2.105480194091797
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 11 cost time: 1.8724260330200195
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 12 cost time: 2.030001401901245
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 13 cost time: 1.989736795425415
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 14 cost time: 1.783395767211914
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 15 cost time: 2.0136139392852783
Epoch: 15, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 16 cost time: 2.0605101585388184
Epoch: 16, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.263144 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 2.071434736251831
Epoch: 17, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 2.05576491355896
Epoch: 18, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 1.8415842056274414
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 1.9252281188964844
Epoch: 20, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 1.8670423030853271
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.0522541999816895
Epoch: 22, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 1.99029541015625
Epoch: 23, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 1.9534811973571777
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 1.8627963066101074
Epoch: 25, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 2.003328323364258
Epoch: 26, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 1.8727788925170898
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 1.7363862991333008
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 1.955214500427246
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.0535073280334473
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.034846782684326
Epoch: 31, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 1.9491305351257324
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.1513140201568604
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.0858232975006104
Epoch: 34, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.2234981060028076
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.2871499061584473
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.027754068374634
Epoch: 37, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 1.9998114109039307
Epoch: 38, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.0225493907928467
Epoch: 39, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.0659875869750977
Epoch: 40, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 1.9667682647705078
Epoch: 41, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 2.1188676357269287
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.8262584209442139
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.022120237350464
Epoch: 44, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.810213327407837
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.122190237045288
Epoch: 46, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.1485583782196045
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.144676685333252
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.089747190475464
Epoch: 49, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.8179941177368164
Epoch: 50, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.7710397243499756
Epoch: 51, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.7746481895446777
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.9575648307800293
Epoch: 53, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 9336324
model size : 55.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.786431074142456
Epoch: 1, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.206 Vali Acc: 0.520 Test Loss: 1.206 Test Acc: 0.520
Validation loss decreased (inf --> -0.519725).  Saving model ...
Epoch: 2 cost time: 2.156053066253662
Epoch: 2, Steps: 10 | Train Loss: 0.946 Vali Loss: 0.941 Vali Acc: 0.632 Test Loss: 0.941 Test Acc: 0.632
Validation loss decreased (-0.519725 --> -0.631570).  Saving model ...
Epoch: 3 cost time: 1.9886860847473145
Epoch: 3, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.825 Vali Acc: 0.684 Test Loss: 0.825 Test Acc: 0.684
Validation loss decreased (-0.631570 --> -0.684202).  Saving model ...
Epoch: 4 cost time: 2.1516101360321045
Epoch: 4, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.744 Vali Acc: 0.704 Test Loss: 0.744 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703940).  Saving model ...
Epoch: 5 cost time: 2.277926445007324
Epoch: 5, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.676 Vali Acc: 0.776 Test Loss: 0.676 Test Acc: 0.776
Validation loss decreased (-0.703940 --> -0.776309).  Saving model ...
Epoch: 6 cost time: 2.315221071243286
Epoch: 6, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.651 Vali Acc: 0.776 Test Loss: 0.651 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776309).  Saving model ...
Epoch: 7 cost time: 2.243776559829712
Epoch: 7, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.678 Vali Acc: 0.789 Test Loss: 0.678 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 8 cost time: 2.2315995693206787
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.688 Vali Acc: 0.789 Test Loss: 0.688 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.147101402282715
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.718 Vali Acc: 0.796 Test Loss: 0.718 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 10 cost time: 2.0387492179870605
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.765 Vali Acc: 0.796 Test Loss: 0.765 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1366126537323
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.808 Vali Acc: 0.789 Test Loss: 0.808 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8777148723602295
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.842 Vali Acc: 0.789 Test Loss: 0.842 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.335500717163086
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.863 Vali Acc: 0.789 Test Loss: 0.863 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3485913276672363
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.884 Vali Acc: 0.789 Test Loss: 0.884 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2211387157440186
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.896 Vali Acc: 0.789 Test Loss: 0.896 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9747724533081055
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.912 Vali Acc: 0.789 Test Loss: 0.912 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8770158290863037
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.923 Vali Acc: 0.789 Test Loss: 0.923 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8365097045898438
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.944 Vali Acc: 0.789 Test Loss: 0.944 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9861509799957275
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.963 Vali Acc: 0.789 Test Loss: 0.963 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 7763460
model size : 49.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1875343322753906
Epoch: 1, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.238 Vali Acc: 0.507 Test Loss: 1.238 Test Acc: 0.507
Validation loss decreased (inf --> -0.506567).  Saving model ...
Epoch: 2 cost time: 1.9731454849243164
Epoch: 2, Steps: 10 | Train Loss: 0.978 Vali Loss: 0.991 Vali Acc: 0.658 Test Loss: 0.991 Test Acc: 0.658
Validation loss decreased (-0.506567 --> -0.657885).  Saving model ...
Epoch: 3 cost time: 1.8393101692199707
Epoch: 3, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.870 Vali Acc: 0.678 Test Loss: 0.870 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677623).  Saving model ...
Epoch: 4 cost time: 2.1528778076171875
Epoch: 4, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.760 Vali Acc: 0.717 Test Loss: 0.760 Test Acc: 0.717
Validation loss decreased (-0.677623 --> -0.717098).  Saving model ...
Epoch: 5 cost time: 2.2437334060668945
Epoch: 5, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.680 Vali Acc: 0.743 Test Loss: 0.680 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 6 cost time: 2.1593403816223145
Epoch: 6, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
Validation loss decreased (-0.743414 --> -0.782888).  Saving model ...
Epoch: 7 cost time: 2.1950199604034424
Epoch: 7, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.668 Vali Acc: 0.796 Test Loss: 0.668 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796046).  Saving model ...
Epoch: 8 cost time: 1.8458471298217773
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.689 Vali Acc: 0.796 Test Loss: 0.689 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9395697116851807
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.700 Vali Acc: 0.816 Test Loss: 0.700 Test Acc: 0.816
Validation loss decreased (-0.796046 --> -0.815782).  Saving model ...
Epoch: 10 cost time: 1.909287929534912
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.740 Vali Acc: 0.789 Test Loss: 0.740 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.229387044906616
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.795 Vali Acc: 0.789 Test Loss: 0.795 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1226601600646973
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.830 Vali Acc: 0.789 Test Loss: 0.830 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1518590450286865
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.851 Vali Acc: 0.789 Test Loss: 0.851 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3647382259368896
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.866 Vali Acc: 0.789 Test Loss: 0.866 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0129261016845703
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.876 Vali Acc: 0.796 Test Loss: 0.876 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8300981521606445
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.892 Vali Acc: 0.796 Test Loss: 0.892 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.793043613433838
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.796 Test Loss: 0.906 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.431051254272461
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.796 Test Loss: 0.926 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0804014205932617
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.796 Test Loss: 0.943 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 7763460
model size : 49.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5782132148742676
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.281 Vali Acc: 0.421 Test Loss: 1.281 Test Acc: 0.421
Validation loss decreased (inf --> -0.421040).  Saving model ...
Epoch: 2 cost time: 2.0370616912841797
Epoch: 2, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.070 Vali Acc: 0.572 Test Loss: 1.070 Test Acc: 0.572
Validation loss decreased (-0.421040 --> -0.572358).  Saving model ...
Epoch: 3 cost time: 2.159433364868164
Epoch: 3, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.892 Vali Acc: 0.658 Test Loss: 0.892 Test Acc: 0.658
Validation loss decreased (-0.572358 --> -0.657886).  Saving model ...
Epoch: 4 cost time: 2.1381375789642334
Epoch: 4, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.738 Vali Acc: 0.704 Test Loss: 0.738 Test Acc: 0.704
Validation loss decreased (-0.657886 --> -0.703940).  Saving model ...
Epoch: 5 cost time: 2.1697728633880615
Epoch: 5, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.664 Vali Acc: 0.757 Test Loss: 0.664 Test Acc: 0.757
Validation loss decreased (-0.703940 --> -0.756572).  Saving model ...
Epoch: 6 cost time: 2.0658814907073975
Epoch: 6, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.640 Vali Acc: 0.770 Test Loss: 0.640 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 7 cost time: 1.8763458728790283
Epoch: 7, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.722 Vali Acc: 0.770 Test Loss: 0.722 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9795646667480469
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.738 Vali Acc: 0.776 Test Loss: 0.738 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776308).  Saving model ...
Epoch: 9 cost time: 2.161759853363037
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.749 Vali Acc: 0.789 Test Loss: 0.749 Test Acc: 0.789
Validation loss decreased (-0.776308 --> -0.789466).  Saving model ...
Epoch: 10 cost time: 2.0750203132629395
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.820 Vali Acc: 0.776 Test Loss: 0.820 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1781208515167236
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.861 Vali Acc: 0.770 Test Loss: 0.861 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.187694549560547
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.884 Vali Acc: 0.770 Test Loss: 0.884 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1606433391571045
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.893 Vali Acc: 0.783 Test Loss: 0.893 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9842026233673096
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.904 Vali Acc: 0.783 Test Loss: 0.904 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.073216438293457
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.914 Vali Acc: 0.783 Test Loss: 0.914 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9330360889434814
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.783 Test Loss: 0.930 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2021572589874268
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.940 Vali Acc: 0.776 Test Loss: 0.940 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2240006923675537
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.956 Vali Acc: 0.776 Test Loss: 0.956 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.212136745452881
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.966 Vali Acc: 0.783 Test Loss: 0.966 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 7763460
model size : 49.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4250364303588867
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.347 Vali Acc: 0.329 Test Loss: 1.347 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 2.0489537715911865
Epoch: 2, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.161 Vali Acc: 0.447 Test Loss: 1.161 Test Acc: 0.447
Validation loss decreased (-0.328934 --> -0.447357).  Saving model ...
Epoch: 3 cost time: 2.130340099334717
Epoch: 3, Steps: 10 | Train Loss: 0.830 Vali Loss: 0.961 Vali Acc: 0.572 Test Loss: 0.961 Test Acc: 0.572
Validation loss decreased (-0.447357 --> -0.572359).  Saving model ...
Epoch: 4 cost time: 2.201051712036133
Epoch: 4, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.793 Vali Acc: 0.645 Test Loss: 0.793 Test Acc: 0.645
Validation loss decreased (-0.572359 --> -0.644729).  Saving model ...
Epoch: 5 cost time: 2.033409357070923
Epoch: 5, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.699 Vali Acc: 0.711 Test Loss: 0.699 Test Acc: 0.711
Validation loss decreased (-0.644729 --> -0.710519).  Saving model ...
Epoch: 6 cost time: 2.051262140274048
Epoch: 6, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.683 Vali Acc: 0.770 Test Loss: 0.683 Test Acc: 0.770
Validation loss decreased (-0.710519 --> -0.769730).  Saving model ...
Epoch: 7 cost time: 1.9507806301116943
Epoch: 7, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.753 Vali Acc: 0.770 Test Loss: 0.753 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.893700122833252
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.762 Vali Acc: 0.776 Test Loss: 0.762 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776308).  Saving model ...
Epoch: 9 cost time: 1.9304771423339844
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.763 Vali Acc: 0.796 Test Loss: 0.763 Test Acc: 0.796
Validation loss decreased (-0.776308 --> -0.796045).  Saving model ...
Epoch: 10 cost time: 2.1476285457611084
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.811 Vali Acc: 0.783 Test Loss: 0.811 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7862977981567383
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.854 Vali Acc: 0.783 Test Loss: 0.854 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9893369674682617
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.789 Test Loss: 0.878 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0886759757995605
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.888 Vali Acc: 0.796 Test Loss: 0.888 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.112427234649658
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.899 Vali Acc: 0.789 Test Loss: 0.899 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1529335975646973
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.909 Vali Acc: 0.789 Test Loss: 0.909 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2456657886505127
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.925 Vali Acc: 0.783 Test Loss: 0.925 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.100285530090332
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.940 Vali Acc: 0.783 Test Loss: 0.940 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9643068313598633
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.952 Vali Acc: 0.783 Test Loss: 0.952 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0059049129486084
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.963 Vali Acc: 0.789 Test Loss: 0.963 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 7763460
model size : 49.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.788667917251587
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.381 Vali Acc: 0.263 Test Loss: 1.381 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.0886662006378174
Epoch: 2, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.180 Vali Acc: 0.441 Test Loss: 1.180 Test Acc: 0.441
Validation loss decreased (-0.263144 --> -0.440778).  Saving model ...
Epoch: 3 cost time: 2.025607109069824
Epoch: 3, Steps: 10 | Train Loss: 0.942 Vali Loss: 0.943 Vali Acc: 0.618 Test Loss: 0.943 Test Acc: 0.618
Validation loss decreased (-0.440778 --> -0.618412).  Saving model ...
Epoch: 4 cost time: 1.842327356338501
Epoch: 4, Steps: 10 | Train Loss: 0.554 Vali Loss: 0.777 Vali Acc: 0.664 Test Loss: 0.777 Test Acc: 0.664
Validation loss decreased (-0.618412 --> -0.664466).  Saving model ...
Epoch: 5 cost time: 2.075761079788208
Epoch: 5, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
Validation loss decreased (-0.664466 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 2.125415325164795
Epoch: 6, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.706 Vali Acc: 0.757 Test Loss: 0.706 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756572).  Saving model ...
Epoch: 7 cost time: 2.2168843746185303
Epoch: 7, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.003950595855713
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.809 Vali Acc: 0.783 Test Loss: 0.809 Test Acc: 0.783
Validation loss decreased (-0.756572 --> -0.782887).  Saving model ...
Epoch: 9 cost time: 1.8290596008300781
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.827 Vali Acc: 0.783 Test Loss: 0.827 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.764674186706543
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.928 Vali Acc: 0.757 Test Loss: 0.928 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.122403621673584
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.997 Vali Acc: 0.776 Test Loss: 0.997 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1224372386932373
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.032 Vali Acc: 0.783 Test Loss: 1.032 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.172990560531616
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.030 Vali Acc: 0.783 Test Loss: 1.030 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8741211891174316
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.039 Vali Acc: 0.783 Test Loss: 1.039 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8957951068878174
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.043 Vali Acc: 0.783 Test Loss: 1.043 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.031210422515869
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.056 Vali Acc: 0.783 Test Loss: 1.056 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.119229316711426
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.064 Vali Acc: 0.783 Test Loss: 1.064 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0296401977539062
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.783 Test Loss: 1.075 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 7763460
model size : 49.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6401848793029785
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.415 Vali Acc: 0.270 Test Loss: 1.415 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 2.4286062717437744
Epoch: 2, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.211 Vali Acc: 0.474 Test Loss: 1.211 Test Acc: 0.474
Validation loss decreased (-0.269723 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 2.175612211227417
Epoch: 3, Steps: 10 | Train Loss: 0.923 Vali Loss: 0.966 Vali Acc: 0.645 Test Loss: 0.966 Test Acc: 0.645
Validation loss decreased (-0.473672 --> -0.644727).  Saving model ...
Epoch: 4 cost time: 2.4042470455169678
Epoch: 4, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.810 Vali Acc: 0.664 Test Loss: 0.810 Test Acc: 0.664
Validation loss decreased (-0.644727 --> -0.664466).  Saving model ...
Epoch: 5 cost time: 2.1508548259735107
Epoch: 5, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.736 Vali Acc: 0.724 Test Loss: 0.736 Test Acc: 0.724
Validation loss decreased (-0.664466 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.8938970565795898
Epoch: 6, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.724 Vali Acc: 0.750 Test Loss: 0.724 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 2.4297611713409424
Epoch: 7, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.782 Vali Acc: 0.757 Test Loss: 0.782 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756571).  Saving model ...
Epoch: 8 cost time: 2.334479570388794
Epoch: 8, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.828 Vali Acc: 0.770 Test Loss: 0.828 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769729).  Saving model ...
Epoch: 9 cost time: 2.160104990005493
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.858 Vali Acc: 0.763 Test Loss: 0.858 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0744357109069824
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.991 Vali Acc: 0.757 Test Loss: 0.991 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9880640506744385
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.024 Vali Acc: 0.763 Test Loss: 1.024 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1572461128234863
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.045 Vali Acc: 0.783 Test Loss: 1.045 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782884).  Saving model ...
Epoch: 13 cost time: 1.9508075714111328
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.057 Vali Acc: 0.783 Test Loss: 1.057 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2148075103759766
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.070 Vali Acc: 0.776 Test Loss: 1.070 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1665403842926025
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.776 Test Loss: 1.075 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.210641622543335
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.083 Vali Acc: 0.776 Test Loss: 1.083 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0417697429656982
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.783 Test Loss: 1.087 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.012683391571045
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.098 Vali Acc: 0.783 Test Loss: 1.098 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0696611404418945
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.110 Vali Acc: 0.783 Test Loss: 1.110 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2016220092773438
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.124 Vali Acc: 0.783 Test Loss: 1.124 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.313267230987549
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.135 Vali Acc: 0.776 Test Loss: 1.135 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.225745439529419
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.140 Vali Acc: 0.776 Test Loss: 1.140 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 7763460
model size : 49.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6487460136413574
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 2.228266716003418
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 2.119687795639038
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 4 cost time: 2.1612236499786377
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 5 cost time: 2.0915913581848145
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 6 cost time: 1.9316999912261963
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 7 cost time: 2.2326576709747314
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 8 cost time: 2.2048165798187256
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 9 cost time: 2.240494966506958
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 10 cost time: 2.370826005935669
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.223670 --> -0.282881).  Saving model ...
Epoch: 11 cost time: 2.1436331272125244
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 12 cost time: 2.0805211067199707
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 13 cost time: 2.123412847518921
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 2.1573500633239746
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 2.1685705184936523
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 2.059231996536255
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 2.2764835357666016
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 2.189019203186035
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0008015632629395
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.026951313018799
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 2.1159918308258057
Epoch: 21, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.1415798664093018
Epoch: 22, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 1.915867567062378
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 1.9982788562774658
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 1.8929157257080078
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 2.1208817958831787
Epoch: 26, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.2069904804229736
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.0801303386688232
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.2226054668426514
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 1.9152636528015137
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.037733316421509
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 1.8870735168457031
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.195059061050415
Epoch: 33, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 1.9598426818847656
Epoch: 34, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.0913686752319336
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.979813575744629
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.0058624744415283
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 1.9751708507537842
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.032731294631958
Epoch: 39, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.9977078437805176
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8778302669525146
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.9437217712402344
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 1.9439046382904053
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.8221278190612793
Epoch: 44, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 45 cost time: 1.7807655334472656
Epoch: 45, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.1194655895233154
Epoch: 46, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.840357780456543
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.928849220275879
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.0279388427734375
Epoch: 49, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.085162401199341
Epoch: 50, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.0860848426818848
Epoch: 51, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.9958248138427734
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 2.174104690551758
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.8652839660644531
Epoch: 54, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.9398810863494873
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.8112967014312744
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 2.029808759689331
Epoch: 57, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.9445264339447021
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.8054587841033936
Epoch: 59, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 7763460
model size : 49.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3601925373077393
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.248 Vali Acc: 0.467 Test Loss: 1.248 Test Acc: 0.467
Validation loss decreased (inf --> -0.467093).  Saving model ...
Epoch: 2 cost time: 2.0394628047943115
Epoch: 2, Steps: 10 | Train Loss: 1.054 Vali Loss: 0.986 Vali Acc: 0.632 Test Loss: 0.986 Test Acc: 0.632
Validation loss decreased (-0.467093 --> -0.631569).  Saving model ...
Epoch: 3 cost time: 2.01304030418396
Epoch: 3, Steps: 10 | Train Loss: 0.625 Vali Loss: 0.834 Vali Acc: 0.691 Test Loss: 0.834 Test Acc: 0.691
Validation loss decreased (-0.631569 --> -0.690781).  Saving model ...
Epoch: 4 cost time: 2.1648576259613037
Epoch: 4, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.767 Vali Acc: 0.717 Test Loss: 0.767 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717098).  Saving model ...
Epoch: 5 cost time: 2.250457286834717
Epoch: 5, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.689 Vali Acc: 0.750 Test Loss: 0.689 Test Acc: 0.750
Validation loss decreased (-0.717098 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 2.174131393432617
Epoch: 6, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
Validation loss decreased (-0.749993 --> -0.789467).  Saving model ...
Epoch: 7 cost time: 2.0906877517700195
Epoch: 7, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.687 Vali Acc: 0.796 Test Loss: 0.687 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 8 cost time: 2.02209210395813
Epoch: 8, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.728 Vali Acc: 0.789 Test Loss: 0.728 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0311777591705322
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.822 Vali Acc: 0.796 Test Loss: 0.822 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9335145950317383
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.848 Vali Acc: 0.789 Test Loss: 0.848 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.186345338821411
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.876 Vali Acc: 0.796 Test Loss: 0.876 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0041229724884033
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.897 Vali Acc: 0.789 Test Loss: 0.897 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0245094299316406
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.912 Vali Acc: 0.789 Test Loss: 0.912 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0053720474243164
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.919 Vali Acc: 0.789 Test Loss: 0.919 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7870864868164062
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.926 Vali Acc: 0.789 Test Loss: 0.926 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1264281272888184
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.933 Vali Acc: 0.789 Test Loss: 0.933 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9347448348999023
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.945 Vali Acc: 0.789 Test Loss: 0.945 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 6977028
model size : 46.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.424560308456421
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.265 Vali Acc: 0.428 Test Loss: 1.265 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 2.1637489795684814
Epoch: 2, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.022 Vali Acc: 0.645 Test Loss: 1.022 Test Acc: 0.645
Validation loss decreased (-0.427619 --> -0.644727).  Saving model ...
Epoch: 3 cost time: 1.9105000495910645
Epoch: 3, Steps: 10 | Train Loss: 0.675 Vali Loss: 0.855 Vali Acc: 0.671 Test Loss: 0.855 Test Acc: 0.671
Validation loss decreased (-0.644727 --> -0.671044).  Saving model ...
Epoch: 4 cost time: 1.949138879776001
Epoch: 4, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.771 Vali Acc: 0.704 Test Loss: 0.771 Test Acc: 0.704
Validation loss decreased (-0.671044 --> -0.703940).  Saving model ...
Epoch: 5 cost time: 1.9101455211639404
Epoch: 5, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.683 Vali Acc: 0.724 Test Loss: 0.683 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 2.091069221496582
Epoch: 6, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
Validation loss decreased (-0.723677 --> -0.796046).  Saving model ...
Epoch: 7 cost time: 2.268496513366699
Epoch: 7, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.698 Vali Acc: 0.796 Test Loss: 0.698 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.000552177429199
Epoch: 8, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.720 Vali Acc: 0.776 Test Loss: 0.720 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1775362491607666
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.794 Vali Acc: 0.776 Test Loss: 0.794 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1186628341674805
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.821 Vali Acc: 0.789 Test Loss: 0.821 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0421535968780518
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.845 Vali Acc: 0.796 Test Loss: 0.845 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0937037467956543
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.869 Vali Acc: 0.796 Test Loss: 0.869 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9148213863372803
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.886 Vali Acc: 0.796 Test Loss: 0.886 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.966317892074585
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.899 Vali Acc: 0.789 Test Loss: 0.899 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.023859977722168
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.911 Vali Acc: 0.789 Test Loss: 0.911 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.014932632446289
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.922 Vali Acc: 0.783 Test Loss: 0.922 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 6977028
model size : 46.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2336411476135254
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.338 Vali Acc: 0.355 Test Loss: 1.338 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.634314775466919
Epoch: 2, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.116 Vali Acc: 0.546 Test Loss: 1.116 Test Acc: 0.546
Validation loss decreased (-0.355250 --> -0.546041).  Saving model ...
Epoch: 3 cost time: 1.9048140048980713
Epoch: 3, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.897 Vali Acc: 0.632 Test Loss: 0.897 Test Acc: 0.632
Validation loss decreased (-0.546041 --> -0.631570).  Saving model ...
Epoch: 4 cost time: 1.8810367584228516
Epoch: 4, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.740 Vali Acc: 0.717 Test Loss: 0.740 Test Acc: 0.717
Validation loss decreased (-0.631570 --> -0.717098).  Saving model ...
Epoch: 5 cost time: 1.9143762588500977
Epoch: 5, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.662 Vali Acc: 0.757 Test Loss: 0.662 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756572).  Saving model ...
Epoch: 6 cost time: 2.1351559162139893
Epoch: 6, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.630 Vali Acc: 0.776 Test Loss: 0.630 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 7 cost time: 1.8906347751617432
Epoch: 7, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.680 Vali Acc: 0.776 Test Loss: 0.680 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.904219150543213
Epoch: 8, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.701 Vali Acc: 0.809 Test Loss: 0.701 Test Acc: 0.809
Validation loss decreased (-0.776309 --> -0.809204).  Saving model ...
Epoch: 9 cost time: 1.9033315181732178
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.780 Vali Acc: 0.789 Test Loss: 0.780 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9796123504638672
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.839 Vali Acc: 0.776 Test Loss: 0.839 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.05903697013855
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.874 Vali Acc: 0.783 Test Loss: 0.874 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.055363655090332
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.891 Vali Acc: 0.783 Test Loss: 0.891 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1465084552764893
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.905 Vali Acc: 0.776 Test Loss: 0.905 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0800983905792236
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.917 Vali Acc: 0.783 Test Loss: 0.917 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1460344791412354
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.928 Vali Acc: 0.783 Test Loss: 0.928 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0741584300994873
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.938 Vali Acc: 0.783 Test Loss: 0.938 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0194475650787354
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.950 Vali Acc: 0.789 Test Loss: 0.950 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.021550416946411
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.966 Vali Acc: 0.789 Test Loss: 0.966 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 6977028
model size : 46.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3783082962036133
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.345 Vali Acc: 0.342 Test Loss: 1.345 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 2.0116610527038574
Epoch: 2, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
Validation loss decreased (-0.342092 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.9958012104034424
Epoch: 3, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.960 Vali Acc: 0.586 Test Loss: 0.960 Test Acc: 0.586
Validation loss decreased (-0.499988 --> -0.585517).  Saving model ...
Epoch: 4 cost time: 1.821084976196289
Epoch: 4, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.791 Vali Acc: 0.625 Test Loss: 0.791 Test Acc: 0.625
Validation loss decreased (-0.585517 --> -0.624992).  Saving model ...
Epoch: 5 cost time: 1.9080336093902588
Epoch: 5, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.702 Vali Acc: 0.730 Test Loss: 0.702 Test Acc: 0.730
Validation loss decreased (-0.624992 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 2.1741936206817627
Epoch: 6, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.657 Vali Acc: 0.783 Test Loss: 0.657 Test Acc: 0.783
Validation loss decreased (-0.730256 --> -0.782888).  Saving model ...
Epoch: 7 cost time: 2.076054096221924
Epoch: 7, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 8 cost time: 1.9170498847961426
Epoch: 8, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.692 Vali Acc: 0.809 Test Loss: 0.692 Test Acc: 0.809
Validation loss decreased (-0.789467 --> -0.809204).  Saving model ...
Epoch: 9 cost time: 2.1549410820007324
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.793 Vali Acc: 0.796 Test Loss: 0.793 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2602388858795166
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.850 Vali Acc: 0.789 Test Loss: 0.850 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1933231353759766
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.874 Vali Acc: 0.803 Test Loss: 0.874 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0289559364318848
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.893 Vali Acc: 0.789 Test Loss: 0.893 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9872174263000488
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.904 Vali Acc: 0.783 Test Loss: 0.904 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2327752113342285
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.904 Vali Acc: 0.789 Test Loss: 0.904 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1559150218963623
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.905 Vali Acc: 0.796 Test Loss: 0.905 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1586873531341553
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.911 Vali Acc: 0.803 Test Loss: 0.911 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0584263801574707
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.918 Vali Acc: 0.803 Test Loss: 0.918 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.144103765487671
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.932 Vali Acc: 0.803 Test Loss: 0.932 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 6977028
model size : 46.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.919618844985962
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.381 Vali Acc: 0.270 Test Loss: 1.381 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.9134910106658936
Epoch: 2, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.202 Vali Acc: 0.513 Test Loss: 1.202 Test Acc: 0.513
Validation loss decreased (-0.269723 --> -0.513146).  Saving model ...
Epoch: 3 cost time: 2.0516750812530518
Epoch: 3, Steps: 10 | Train Loss: 0.967 Vali Loss: 0.951 Vali Acc: 0.625 Test Loss: 0.951 Test Acc: 0.625
Validation loss decreased (-0.513146 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 2.3005568981170654
Epoch: 4, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.811 Vali Acc: 0.678 Test Loss: 0.811 Test Acc: 0.678
Validation loss decreased (-0.624990 --> -0.677623).  Saving model ...
Epoch: 5 cost time: 2.077538251876831
Epoch: 5, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.739 Vali Acc: 0.737 Test Loss: 0.739 Test Acc: 0.737
Validation loss decreased (-0.677623 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 2.1854677200317383
Epoch: 6, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.723 Vali Acc: 0.743 Test Loss: 0.723 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 7 cost time: 1.957235336303711
Epoch: 7, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.752 Vali Acc: 0.783 Test Loss: 0.752 Test Acc: 0.783
Validation loss decreased (-0.743414 --> -0.782887).  Saving model ...
Epoch: 8 cost time: 2.114584445953369
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.842 Vali Acc: 0.776 Test Loss: 0.842 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9828577041625977
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.934 Vali Acc: 0.776 Test Loss: 0.934 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.140429735183716
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.042 Vali Acc: 0.770 Test Loss: 1.042 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0267605781555176
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.086 Vali Acc: 0.770 Test Loss: 1.086 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0786705017089844
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.095 Vali Acc: 0.770 Test Loss: 1.095 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0242369174957275
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.091 Vali Acc: 0.770 Test Loss: 1.091 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1974358558654785
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.095 Vali Acc: 0.776 Test Loss: 1.095 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0967607498168945
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.103 Vali Acc: 0.770 Test Loss: 1.103 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.29474139213562
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.108 Vali Acc: 0.770 Test Loss: 1.108 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0369536876678467
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.783 Test Loss: 1.105 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 6977028
model size : 46.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7336013317108154
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.408 Vali Acc: 0.309 Test Loss: 1.408 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 2.0443882942199707
Epoch: 2, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.221 Vali Acc: 0.441 Test Loss: 1.221 Test Acc: 0.441
Validation loss decreased (-0.309196 --> -0.440777).  Saving model ...
Epoch: 3 cost time: 1.959855318069458
Epoch: 3, Steps: 10 | Train Loss: 0.947 Vali Loss: 0.970 Vali Acc: 0.605 Test Loss: 0.970 Test Acc: 0.605
Validation loss decreased (-0.440777 --> -0.605253).  Saving model ...
Epoch: 4 cost time: 1.8559112548828125
Epoch: 4, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.824 Vali Acc: 0.678 Test Loss: 0.824 Test Acc: 0.678
Validation loss decreased (-0.605253 --> -0.677623).  Saving model ...
Epoch: 5 cost time: 2.117325782775879
Epoch: 5, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.759 Vali Acc: 0.724 Test Loss: 0.759 Test Acc: 0.724
Validation loss decreased (-0.677623 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 2.047886848449707
Epoch: 6, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.730 Vali Acc: 0.743 Test Loss: 0.730 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 7 cost time: 1.8594563007354736
Epoch: 7, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.765 Vali Acc: 0.763 Test Loss: 0.765 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763150).  Saving model ...
Epoch: 8 cost time: 1.9715585708618164
Epoch: 8, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.812 Vali Acc: 0.776 Test Loss: 0.812 Test Acc: 0.776
Validation loss decreased (-0.763150 --> -0.776308).  Saving model ...
Epoch: 9 cost time: 1.618377923965454
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.932 Vali Acc: 0.770 Test Loss: 0.932 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7761311531066895
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.017 Vali Acc: 0.776 Test Loss: 1.017 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0893123149871826
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.052 Vali Acc: 0.776 Test Loss: 1.052 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9888625144958496
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.065 Vali Acc: 0.783 Test Loss: 1.065 Test Acc: 0.783
Validation loss decreased (-0.776308 --> -0.782884).  Saving model ...
Epoch: 13 cost time: 2.081092357635498
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.076 Vali Acc: 0.783 Test Loss: 1.076 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.110898971557617
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.082 Vali Acc: 0.776 Test Loss: 1.082 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.975538969039917
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.087 Vali Acc: 0.783 Test Loss: 1.087 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9696285724639893
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.092 Vali Acc: 0.783 Test Loss: 1.092 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.001572847366333
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.094 Vali Acc: 0.783 Test Loss: 1.094 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9340598583221436
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.107 Vali Acc: 0.789 Test Loss: 1.107 Test Acc: 0.789
Validation loss decreased (-0.782884 --> -0.789463).  Saving model ...
Epoch: 19 cost time: 1.8631103038787842
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.119 Vali Acc: 0.789 Test Loss: 1.119 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7950949668884277
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.120 Vali Acc: 0.789 Test Loss: 1.120 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0871376991271973
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.121 Vali Acc: 0.789 Test Loss: 1.121 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.736532211303711
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.130 Vali Acc: 0.789 Test Loss: 1.130 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1030147075653076
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.139 Vali Acc: 0.789 Test Loss: 1.139 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7719905376434326
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.151 Vali Acc: 0.789 Test Loss: 1.151 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.913086175918579
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.159 Vali Acc: 0.789 Test Loss: 1.159 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9464666843414307
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.169 Vali Acc: 0.789 Test Loss: 1.169 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.80055570602417
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.179 Vali Acc: 0.789 Test Loss: 1.179 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.872145414352417
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.783 Test Loss: 1.187 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 6977028
model size : 46.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.679222822189331
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 2.1144633293151855
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 2.2227535247802734
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 2.0328333377838135
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 2.0990893840789795
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 6 cost time: 2.091855525970459
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 7 cost time: 1.9801836013793945
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 8 cost time: 1.9985682964324951
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 9 cost time: 2.1503567695617676
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 10 cost time: 2.11714768409729
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 11 cost time: 1.9325833320617676
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 12 cost time: 1.9639630317687988
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 13 cost time: 2.1124112606048584
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 2.0147035121917725
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 1.8887379169464111
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 1.8484225273132324
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 1.9339969158172607
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 1.8051605224609375
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 1.8034179210662842
Epoch: 19, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 1.8892221450805664
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 1.9819695949554443
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.0774424076080322
Epoch: 22, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 2.011197090148926
Epoch: 23, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 1.9761950969696045
Epoch: 24, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0464284420013428
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.065721035003662
Epoch: 26, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 1.9836366176605225
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.1707136631011963
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.0442216396331787
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.01493501663208
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.026589870452881
Epoch: 31, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 2.0084614753723145
Epoch: 32, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8506436347961426
Epoch: 33, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 1.795210599899292
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 1.8878796100616455
Epoch: 35, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 1.8414897918701172
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 1.9279096126556396
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 1.9216866493225098
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 1.8939275741577148
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 1.6825053691864014
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.702759027481079
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7384440898895264
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.7091667652130127
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.885108470916748
Epoch: 44, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.7116632461547852
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.0603065490722656
Epoch: 46, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 1.8569011688232422
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.8606302738189697
Epoch: 48, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.08381986618042
Epoch: 49, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.819974660873413
Epoch: 50, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.00734281539917
Epoch: 51, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 52 cost time: 1.8808000087738037
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 53 cost time: 2.062605142593384
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 2.0128965377807617
Epoch: 54, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 55 cost time: 1.8061566352844238
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 56 cost time: 1.90592622756958
Epoch: 56, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 57 cost time: 1.84686279296875
Epoch: 57, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 58 cost time: 1.9439103603363037
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 59 cost time: 1.8589751720428467
Epoch: 59, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.8561060428619385
Epoch: 60, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.0511865615844727
Epoch: 61, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.7588140964508057
Epoch: 62, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 63 cost time: 2.028541088104248
Epoch: 63, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.9347991943359375
Epoch: 64, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.8635270595550537
Epoch: 65, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.851724624633789
Epoch: 66, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.9755654335021973
Epoch: 67, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.9635348320007324
Epoch: 68, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.9907760620117188
Epoch: 69, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 2.0372557640075684
Epoch: 70, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.9412248134613037
Epoch: 71, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.873908519744873
Epoch: 72, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 6977028
model size : 46.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3183929920196533
Epoch: 1, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.284 Vali Acc: 0.493 Test Loss: 1.284 Test Acc: 0.493
Validation loss decreased (inf --> -0.493408).  Saving model ...
Epoch: 2 cost time: 2.0195984840393066
Epoch: 2, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.018 Vali Acc: 0.625 Test Loss: 1.018 Test Acc: 0.625
Validation loss decreased (-0.493408 --> -0.624990).  Saving model ...
Epoch: 3 cost time: 1.9561116695404053
Epoch: 3, Steps: 10 | Train Loss: 0.651 Vali Loss: 0.877 Vali Acc: 0.691 Test Loss: 0.877 Test Acc: 0.691
Validation loss decreased (-0.624990 --> -0.690781).  Saving model ...
Epoch: 4 cost time: 2.059483528137207
Epoch: 4, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.782 Vali Acc: 0.717 Test Loss: 0.782 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717097).  Saving model ...
Epoch: 5 cost time: 1.8787572383880615
Epoch: 5, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.707 Vali Acc: 0.757 Test Loss: 0.707 Test Acc: 0.757
Validation loss decreased (-0.717097 --> -0.756572).  Saving model ...
Epoch: 6 cost time: 2.1009609699249268
Epoch: 6, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.661 Vali Acc: 0.776 Test Loss: 0.661 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 7 cost time: 2.1770615577697754
Epoch: 7, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.727 Vali Acc: 0.783 Test Loss: 0.727 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782887).  Saving model ...
Epoch: 8 cost time: 2.126643180847168
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.736 Vali Acc: 0.776 Test Loss: 0.736 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1392629146575928
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.760 Vali Acc: 0.809 Test Loss: 0.760 Test Acc: 0.809
Validation loss decreased (-0.782887 --> -0.809203).  Saving model ...
Epoch: 10 cost time: 1.8993940353393555
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.800 Vali Acc: 0.803 Test Loss: 0.800 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9558601379394531
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.854 Vali Acc: 0.789 Test Loss: 0.854 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0957705974578857
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.895 Vali Acc: 0.803 Test Loss: 0.895 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0189270973205566
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.921 Vali Acc: 0.803 Test Loss: 0.921 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2490010261535645
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.937 Vali Acc: 0.803 Test Loss: 0.937 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.045851945877075
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.951 Vali Acc: 0.796 Test Loss: 0.951 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2325470447540283
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.963 Vali Acc: 0.796 Test Loss: 0.963 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.070054769515991
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.974 Vali Acc: 0.796 Test Loss: 0.974 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.035865545272827
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.796 Test Loss: 0.984 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1099748611450195
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.803 Test Loss: 0.995 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 6583812
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7494053840637207
Epoch: 1, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.310 Vali Acc: 0.434 Test Loss: 1.310 Test Acc: 0.434
Validation loss decreased (inf --> -0.434197).  Saving model ...
Epoch: 2 cost time: 2.0658891201019287
Epoch: 2, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.062 Vali Acc: 0.586 Test Loss: 1.062 Test Acc: 0.586
Validation loss decreased (-0.434197 --> -0.585516).  Saving model ...
Epoch: 3 cost time: 1.8501429557800293
Epoch: 3, Steps: 10 | Train Loss: 0.706 Vali Loss: 0.906 Vali Acc: 0.658 Test Loss: 0.906 Test Acc: 0.658
Validation loss decreased (-0.585516 --> -0.657886).  Saving model ...
Epoch: 4 cost time: 1.7856385707855225
Epoch: 4, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.803 Vali Acc: 0.711 Test Loss: 0.803 Test Acc: 0.711
Validation loss decreased (-0.657886 --> -0.710518).  Saving model ...
Epoch: 5 cost time: 1.8837354183197021
Epoch: 5, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.716 Vali Acc: 0.737 Test Loss: 0.716 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 1.9434809684753418
Epoch: 6, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.672 Vali Acc: 0.783 Test Loss: 0.672 Test Acc: 0.783
Validation loss decreased (-0.736835 --> -0.782888).  Saving model ...
Epoch: 7 cost time: 2.064964532852173
Epoch: 7, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.729 Vali Acc: 0.783 Test Loss: 0.729 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0728583335876465
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.728 Vali Acc: 0.783 Test Loss: 0.728 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9189376831054688
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.761 Vali Acc: 0.789 Test Loss: 0.761 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789466).  Saving model ...
Epoch: 10 cost time: 1.9895844459533691
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.809 Vali Acc: 0.803 Test Loss: 0.809 Test Acc: 0.803
Validation loss decreased (-0.789466 --> -0.802623).  Saving model ...
Epoch: 11 cost time: 2.0121700763702393
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.852 Vali Acc: 0.803 Test Loss: 0.852 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.060211181640625
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.875 Vali Acc: 0.803 Test Loss: 0.875 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0750391483306885
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.894 Vali Acc: 0.803 Test Loss: 0.894 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1578640937805176
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.909 Vali Acc: 0.809 Test Loss: 0.909 Test Acc: 0.809
Validation loss decreased (-0.802623 --> -0.809201).  Saving model ...
Epoch: 15 cost time: 2.0474612712860107
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.809 Test Loss: 0.927 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0027687549591064
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.942 Vali Acc: 0.809 Test Loss: 0.942 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.075376272201538
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.956 Vali Acc: 0.809 Test Loss: 0.956 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.160980224609375
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.968 Vali Acc: 0.809 Test Loss: 0.968 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0690221786499023
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.981 Vali Acc: 0.809 Test Loss: 0.981 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.2245147228240967
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.809 Test Loss: 0.997 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.09448504447937
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.803 Test Loss: 1.005 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0815112590789795
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.803 Test Loss: 1.017 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1206586360931396
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.803 Test Loss: 1.036 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.0093119144439697
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.809 Test Loss: 1.046 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 6583812
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.433833599090576
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.368 Vali Acc: 0.309 Test Loss: 1.368 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 2.060962438583374
Epoch: 2, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.143 Vali Acc: 0.526 Test Loss: 1.143 Test Acc: 0.526
Validation loss decreased (-0.309197 --> -0.526304).  Saving model ...
Epoch: 3 cost time: 2.106449604034424
Epoch: 3, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.933 Vali Acc: 0.618 Test Loss: 0.933 Test Acc: 0.618
Validation loss decreased (-0.526304 --> -0.618412).  Saving model ...
Epoch: 4 cost time: 1.8611524105072021
Epoch: 4, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.778 Vali Acc: 0.704 Test Loss: 0.778 Test Acc: 0.704
Validation loss decreased (-0.618412 --> -0.703940).  Saving model ...
Epoch: 5 cost time: 2.0621981620788574
Epoch: 5, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.680 Vali Acc: 0.750 Test Loss: 0.680 Test Acc: 0.750
Validation loss decreased (-0.703940 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.8373589515686035
Epoch: 6, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.643 Vali Acc: 0.770 Test Loss: 0.643 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 7 cost time: 1.819645643234253
Epoch: 7, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.721 Vali Acc: 0.770 Test Loss: 0.721 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8080785274505615
Epoch: 8, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.727 Vali Acc: 0.816 Test Loss: 0.727 Test Acc: 0.816
Validation loss decreased (-0.769730 --> -0.815782).  Saving model ...
Epoch: 9 cost time: 2.0399866104125977
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.776 Vali Acc: 0.809 Test Loss: 0.776 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0583200454711914
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.831 Vali Acc: 0.789 Test Loss: 0.831 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0386133193969727
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.878 Vali Acc: 0.783 Test Loss: 0.878 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.037904739379883
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.899 Vali Acc: 0.789 Test Loss: 0.899 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9680242538452148
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.917 Vali Acc: 0.796 Test Loss: 0.917 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0291645526885986
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.933 Vali Acc: 0.796 Test Loss: 0.933 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0626258850097656
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.954 Vali Acc: 0.783 Test Loss: 0.954 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0720431804656982
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.965 Vali Acc: 0.796 Test Loss: 0.965 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.033355474472046
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.970 Vali Acc: 0.796 Test Loss: 0.970 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1800472736358643
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.796 Test Loss: 0.979 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 6583812
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.708437919616699
Epoch: 1, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.356 Vali Acc: 0.289 Test Loss: 1.356 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.1471669673919678
Epoch: 2, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.198 Vali Acc: 0.408 Test Loss: 1.198 Test Acc: 0.408
Validation loss decreased (-0.289460 --> -0.407883).  Saving model ...
Epoch: 3 cost time: 2.2156968116760254
Epoch: 3, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.975 Vali Acc: 0.566 Test Loss: 0.975 Test Acc: 0.566
Validation loss decreased (-0.407883 --> -0.565780).  Saving model ...
Epoch: 4 cost time: 1.8377716541290283
Epoch: 4, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.804 Vali Acc: 0.632 Test Loss: 0.804 Test Acc: 0.632
Validation loss decreased (-0.565780 --> -0.631571).  Saving model ...
Epoch: 5 cost time: 2.139496326446533
Epoch: 5, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.702 Vali Acc: 0.724 Test Loss: 0.702 Test Acc: 0.724
Validation loss decreased (-0.631571 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.9992125034332275
Epoch: 6, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.646 Vali Acc: 0.783 Test Loss: 0.646 Test Acc: 0.783
Validation loss decreased (-0.723677 --> -0.782888).  Saving model ...
Epoch: 7 cost time: 1.8688232898712158
Epoch: 7, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.717 Vali Acc: 0.783 Test Loss: 0.717 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0766241550445557
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789466).  Saving model ...
Epoch: 9 cost time: 1.8341691493988037
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.779 Vali Acc: 0.796 Test Loss: 0.779 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796045).  Saving model ...
Epoch: 10 cost time: 1.9699175357818604
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.823 Vali Acc: 0.783 Test Loss: 0.823 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9224827289581299
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.871 Vali Acc: 0.783 Test Loss: 0.871 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0481626987457275
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.889 Vali Acc: 0.783 Test Loss: 0.889 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7981410026550293
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.903 Vali Acc: 0.789 Test Loss: 0.903 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7782046794891357
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.919 Vali Acc: 0.789 Test Loss: 0.919 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.025219440460205
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.939 Vali Acc: 0.789 Test Loss: 0.939 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9148063659667969
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.953 Vali Acc: 0.783 Test Loss: 0.953 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0740959644317627
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.960 Vali Acc: 0.803 Test Loss: 0.960 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802622).  Saving model ...
Epoch: 18 cost time: 1.9676296710968018
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.962 Vali Acc: 0.803 Test Loss: 0.962 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.048038959503174
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.972 Vali Acc: 0.809 Test Loss: 0.972 Test Acc: 0.809
Validation loss decreased (-0.802622 --> -0.809201).  Saving model ...
Epoch: 20 cost time: 1.978832483291626
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.986 Vali Acc: 0.809 Test Loss: 0.986 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0468151569366455
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.803 Test Loss: 0.994 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0203521251678467
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.004 Vali Acc: 0.809 Test Loss: 1.004 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.000305414199829
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.015 Vali Acc: 0.809 Test Loss: 1.015 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8973088264465332
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.816 Test Loss: 1.024 Test Acc: 0.816
Validation loss decreased (-0.809201 --> -0.815779).  Saving model ...
Epoch: 25 cost time: 2.0016074180603027
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.033 Vali Acc: 0.809 Test Loss: 1.033 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.899134874343872
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.816 Test Loss: 1.045 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.997814416885376
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.052 Vali Acc: 0.816 Test Loss: 1.052 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8808493614196777
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.064 Vali Acc: 0.816 Test Loss: 1.064 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.963693618774414
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.816 Test Loss: 1.075 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8313040733337402
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.816 Test Loss: 1.081 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8710741996765137
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.816 Test Loss: 1.089 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.8144629001617432
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.092 Vali Acc: 0.816 Test Loss: 1.092 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9170660972595215
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.104 Vali Acc: 0.816 Test Loss: 1.104 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9724047183990479
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.816 Test Loss: 1.113 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 6583812
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.448789358139038
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.382 Vali Acc: 0.309 Test Loss: 1.382 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.9968078136444092
Epoch: 2, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.225 Vali Acc: 0.441 Test Loss: 1.225 Test Acc: 0.441
Validation loss decreased (-0.309197 --> -0.440777).  Saving model ...
Epoch: 3 cost time: 1.9413509368896484
Epoch: 3, Steps: 10 | Train Loss: 0.950 Vali Loss: 0.957 Vali Acc: 0.612 Test Loss: 0.957 Test Acc: 0.612
Validation loss decreased (-0.440777 --> -0.611833).  Saving model ...
Epoch: 4 cost time: 2.023871898651123
Epoch: 4, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.825 Vali Acc: 0.678 Test Loss: 0.825 Test Acc: 0.678
Validation loss decreased (-0.611833 --> -0.677623).  Saving model ...
Epoch: 5 cost time: 1.9260168075561523
Epoch: 5, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.789 Vali Acc: 0.697 Test Loss: 0.789 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697361).  Saving model ...
Epoch: 6 cost time: 1.993995189666748
Epoch: 6, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.717 Vali Acc: 0.743 Test Loss: 0.717 Test Acc: 0.743
Validation loss decreased (-0.697361 --> -0.743414).  Saving model ...
Epoch: 7 cost time: 1.9938380718231201
Epoch: 7, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.821 Vali Acc: 0.757 Test Loss: 0.821 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756571).  Saving model ...
Epoch: 8 cost time: 2.081655979156494
Epoch: 8, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.831 Vali Acc: 0.770 Test Loss: 0.831 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769729).  Saving model ...
Epoch: 9 cost time: 2.011338233947754
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.904 Vali Acc: 0.783 Test Loss: 0.904 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782886).  Saving model ...
Epoch: 10 cost time: 2.358924627304077
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.938 Vali Acc: 0.776 Test Loss: 0.938 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.169360876083374
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.977 Vali Acc: 0.783 Test Loss: 0.977 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0493459701538086
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.012 Vali Acc: 0.789 Test Loss: 1.012 Test Acc: 0.789
Validation loss decreased (-0.782886 --> -0.789464).  Saving model ...
Epoch: 13 cost time: 2.0139927864074707
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.053 Vali Acc: 0.789 Test Loss: 1.053 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9409964084625244
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.069 Vali Acc: 0.789 Test Loss: 1.069 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0727455615997314
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.084 Vali Acc: 0.783 Test Loss: 1.084 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.048977851867676
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.101 Vali Acc: 0.783 Test Loss: 1.101 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1644887924194336
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.117 Vali Acc: 0.783 Test Loss: 1.117 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.89876127243042
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.124 Vali Acc: 0.783 Test Loss: 1.124 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.088693857192993
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.132 Vali Acc: 0.783 Test Loss: 1.132 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0916261672973633
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.148 Vali Acc: 0.783 Test Loss: 1.148 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.05242657661438
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.163 Vali Acc: 0.783 Test Loss: 1.163 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7329051494598389
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.171 Vali Acc: 0.783 Test Loss: 1.171 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 6583812
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2027008533477783
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.402 Vali Acc: 0.309 Test Loss: 1.402 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.805241346359253
Epoch: 2, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.221 Vali Acc: 0.428 Test Loss: 1.221 Test Acc: 0.428
Validation loss decreased (-0.309197 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 2.0946624279022217
Epoch: 3, Steps: 10 | Train Loss: 0.928 Vali Loss: 0.943 Vali Acc: 0.632 Test Loss: 0.943 Test Acc: 0.632
Validation loss decreased (-0.427619 --> -0.631570).  Saving model ...
Epoch: 4 cost time: 1.905442237854004
Epoch: 4, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.802 Vali Acc: 0.678 Test Loss: 0.802 Test Acc: 0.678
Validation loss decreased (-0.631570 --> -0.677624).  Saving model ...
Epoch: 5 cost time: 1.9265286922454834
Epoch: 5, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.753 Vali Acc: 0.717 Test Loss: 0.753 Test Acc: 0.717
Validation loss decreased (-0.677624 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.8516876697540283
Epoch: 6, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.695 Vali Acc: 0.757 Test Loss: 0.695 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756572).  Saving model ...
Epoch: 7 cost time: 2.0033628940582275
Epoch: 7, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.786 Vali Acc: 0.776 Test Loss: 0.786 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776308).  Saving model ...
Epoch: 8 cost time: 2.1280431747436523
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.834 Vali Acc: 0.776 Test Loss: 0.834 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9714128971099854
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.868 Vali Acc: 0.783 Test Loss: 0.868 Test Acc: 0.783
Validation loss decreased (-0.776308 --> -0.782886).  Saving model ...
Epoch: 10 cost time: 2.105360507965088
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.907 Vali Acc: 0.783 Test Loss: 0.907 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2063608169555664
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.957 Vali Acc: 0.783 Test Loss: 0.957 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.004041910171509
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.983 Vali Acc: 0.783 Test Loss: 0.983 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1489150524139404
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.011 Vali Acc: 0.783 Test Loss: 1.011 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1521520614624023
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.022 Vali Acc: 0.783 Test Loss: 1.022 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9670953750610352
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.034 Vali Acc: 0.783 Test Loss: 1.034 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9376180171966553
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.783 Test Loss: 1.052 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9996533393859863
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.067 Vali Acc: 0.783 Test Loss: 1.067 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0884130001068115
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.074 Vali Acc: 0.783 Test Loss: 1.074 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9828760623931885
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.783 Test Loss: 1.087 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 6583812
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.261655807495117
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.8268256187438965
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.7333312034606934
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 1.940514326095581
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 1.951767921447754
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 6 cost time: 1.9169154167175293
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 7 cost time: 1.9592156410217285
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 8 cost time: 1.9090867042541504
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 9 cost time: 1.8635172843933105
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 10 cost time: 1.9664485454559326
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 11 cost time: 1.8489015102386475
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 12 cost time: 1.8634819984436035
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 13 cost time: 1.8765430450439453
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 1.9599976539611816
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 1.9060399532318115
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7799043655395508
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 1.842743158340454
Epoch: 17, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 1.9011263847351074
Epoch: 18, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 1.7630696296691895
Epoch: 19, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 1.7065987586975098
Epoch: 20, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 1.857386589050293
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8141915798187256
Epoch: 22, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 1.9218037128448486
Epoch: 23, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 1.9529492855072021
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 2.084660768508911
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 1.9239795207977295
Epoch: 26, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 1.8787469863891602
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 1.7648372650146484
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 1.6811985969543457
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 1.8067631721496582
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 1.6630454063415527
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 1.632922887802124
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 1.7321619987487793
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 1.8196725845336914
Epoch: 34, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8081934452056885
Epoch: 35, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 1.6428523063659668
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 1.7357091903686523
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 1.8250491619110107
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 1.8152673244476318
Epoch: 39, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.925105333328247
Epoch: 40, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.9222080707550049
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 1.9990086555480957
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.8831346035003662
Epoch: 43, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 1.869859218597412
Epoch: 44, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 45 cost time: 1.930494785308838
Epoch: 45, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 1.8464505672454834
Epoch: 46, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.9851188659667969
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.801374912261963
Epoch: 48, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 1.7201223373413086
Epoch: 49, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 1.924191951751709
Epoch: 50, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 1.8176014423370361
Epoch: 51, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.849604606628418
Epoch: 52, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.794966220855713
Epoch: 53, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 1.7685213088989258
Epoch: 54, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 55 cost time: 1.8689372539520264
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.7989983558654785
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.8799543380737305
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.789055585861206
Epoch: 58, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.8615593910217285
Epoch: 59, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 60 cost time: 1.7248175144195557
Epoch: 60, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 61 cost time: 1.9351882934570312
Epoch: 61, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 62 cost time: 1.9335646629333496
Epoch: 62, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.9915361404418945
Epoch: 63, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.8755137920379639
Epoch: 64, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.0309314727783203
Epoch: 65, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.9514188766479492
Epoch: 66, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.8947398662567139
Epoch: 67, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.8358898162841797
Epoch: 68, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.8848750591278076
Epoch: 69, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.8867225646972656
Epoch: 70, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.799083948135376
Epoch: 71, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 6583812
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.474778890609741
Epoch: 1, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.285 Vali Acc: 0.375 Test Loss: 1.285 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.9515249729156494
Epoch: 2, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.011 Vali Acc: 0.572 Test Loss: 1.011 Test Acc: 0.572
Validation loss decreased (-0.374987 --> -0.572358).  Saving model ...
Epoch: 3 cost time: 2.021212339401245
Epoch: 3, Steps: 10 | Train Loss: 0.684 Vali Loss: 0.846 Vali Acc: 0.658 Test Loss: 0.846 Test Acc: 0.658
Validation loss decreased (-0.572358 --> -0.657886).  Saving model ...
Epoch: 4 cost time: 2.068349599838257
Epoch: 4, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.739 Vali Acc: 0.691 Test Loss: 0.739 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690782).  Saving model ...
Epoch: 5 cost time: 2.184353828430176
Epoch: 5, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.677 Vali Acc: 0.730 Test Loss: 0.677 Test Acc: 0.730
Validation loss decreased (-0.690782 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 2.429471254348755
Epoch: 6, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.660 Vali Acc: 0.757 Test Loss: 0.660 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756572).  Saving model ...
Epoch: 7 cost time: 2.1897287368774414
Epoch: 7, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.631 Vali Acc: 0.776 Test Loss: 0.631 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 8 cost time: 2.062687635421753
Epoch: 8, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.624 Vali Acc: 0.789 Test Loss: 0.624 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 9 cost time: 2.2206850051879883
Epoch: 9, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 2.120388984680176
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
Validation loss decreased (-0.802626 --> -0.822362).  Saving model ...
Epoch: 11 cost time: 2.3460607528686523
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.678 Vali Acc: 0.816 Test Loss: 0.678 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8515934944152832
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.679 Vali Acc: 0.803 Test Loss: 0.679 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8786108493804932
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.691 Vali Acc: 0.796 Test Loss: 0.691 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7115156650543213
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.708 Vali Acc: 0.816 Test Loss: 0.708 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8625531196594238
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.733 Vali Acc: 0.809 Test Loss: 0.733 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9598073959350586
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.754 Vali Acc: 0.803 Test Loss: 0.754 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.840721607208252
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.765 Vali Acc: 0.809 Test Loss: 0.765 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.002239942550659
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.772 Vali Acc: 0.816 Test Loss: 0.772 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8046140670776367
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.786 Vali Acc: 0.816 Test Loss: 0.786 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.883073329925537
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.799 Vali Acc: 0.816 Test Loss: 0.799 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 4717316
model size : 27.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3117241859436035
Epoch: 1, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.291 Vali Acc: 0.375 Test Loss: 1.291 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 2.0206844806671143
Epoch: 2, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.052 Vali Acc: 0.599 Test Loss: 1.052 Test Acc: 0.599
Validation loss decreased (-0.374987 --> -0.598674).  Saving model ...
Epoch: 3 cost time: 1.9509756565093994
Epoch: 3, Steps: 10 | Train Loss: 0.733 Vali Loss: 0.894 Vali Acc: 0.632 Test Loss: 0.894 Test Acc: 0.632
Validation loss decreased (-0.598674 --> -0.631570).  Saving model ...
Epoch: 4 cost time: 1.9344482421875
Epoch: 4, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.787 Vali Acc: 0.691 Test Loss: 0.787 Test Acc: 0.691
Validation loss decreased (-0.631570 --> -0.690782).  Saving model ...
Epoch: 5 cost time: 2.0110132694244385
Epoch: 5, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.703 Vali Acc: 0.737 Test Loss: 0.703 Test Acc: 0.737
Validation loss decreased (-0.690782 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 1.9554429054260254
Epoch: 6, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.672 Vali Acc: 0.730 Test Loss: 0.672 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9734106063842773
Epoch: 7, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.623 Vali Acc: 0.757 Test Loss: 0.623 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.814112901687622
Epoch: 8, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.606 Vali Acc: 0.789 Test Loss: 0.606 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.9036786556243896
Epoch: 9, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.006256580352783
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.652 Vali Acc: 0.803 Test Loss: 0.652 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802625).  Saving model ...
Epoch: 11 cost time: 1.8872439861297607
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.691 Vali Acc: 0.789 Test Loss: 0.691 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6676363945007324
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.705 Vali Acc: 0.783 Test Loss: 0.705 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8499822616577148
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.711 Vali Acc: 0.789 Test Loss: 0.711 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7441129684448242
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.718 Vali Acc: 0.789 Test Loss: 0.718 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8419017791748047
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.740 Vali Acc: 0.809 Test Loss: 0.740 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809203).  Saving model ...
Epoch: 16 cost time: 1.7574849128723145
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.760 Vali Acc: 0.796 Test Loss: 0.760 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.861330270767212
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.774 Vali Acc: 0.796 Test Loss: 0.774 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9143295288085938
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.776 Vali Acc: 0.809 Test Loss: 0.776 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9078941345214844
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.785 Vali Acc: 0.789 Test Loss: 0.785 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9500598907470703
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.799 Vali Acc: 0.789 Test Loss: 0.799 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.981971263885498
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.816 Vali Acc: 0.789 Test Loss: 0.816 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8933775424957275
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.832 Vali Acc: 0.796 Test Loss: 0.832 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9642465114593506
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.844 Vali Acc: 0.796 Test Loss: 0.844 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.891331672668457
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.857 Vali Acc: 0.796 Test Loss: 0.857 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.080253839492798
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.867 Vali Acc: 0.796 Test Loss: 0.867 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 4717316
model size : 27.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.330836534500122
Epoch: 1, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.292 Vali Acc: 0.454 Test Loss: 1.292 Test Acc: 0.454
Validation loss decreased (inf --> -0.453934).  Saving model ...
Epoch: 2 cost time: 1.7652888298034668
Epoch: 2, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.117 Vali Acc: 0.572 Test Loss: 1.117 Test Acc: 0.572
Validation loss decreased (-0.453934 --> -0.572357).  Saving model ...
Epoch: 3 cost time: 2.0874478816986084
Epoch: 3, Steps: 10 | Train Loss: 0.846 Vali Loss: 0.975 Vali Acc: 0.605 Test Loss: 0.975 Test Acc: 0.605
Validation loss decreased (-0.572357 --> -0.605253).  Saving model ...
Epoch: 4 cost time: 1.8410615921020508
Epoch: 4, Steps: 10 | Train Loss: 0.602 Vali Loss: 0.853 Vali Acc: 0.664 Test Loss: 0.853 Test Acc: 0.664
Validation loss decreased (-0.605253 --> -0.664465).  Saving model ...
Epoch: 5 cost time: 1.9211156368255615
Epoch: 5, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.756 Vali Acc: 0.711 Test Loss: 0.756 Test Acc: 0.711
Validation loss decreased (-0.664465 --> -0.710519).  Saving model ...
Epoch: 6 cost time: 1.7934954166412354
Epoch: 6, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.693 Vali Acc: 0.717 Test Loss: 0.693 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 2.0078279972076416
Epoch: 7, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.633 Vali Acc: 0.757 Test Loss: 0.633 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.9271924495697021
Epoch: 8, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.597 Vali Acc: 0.770 Test Loss: 0.597 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.9051613807678223
Epoch: 9, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.619 Vali Acc: 0.770 Test Loss: 0.619 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0369699001312256
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.641 Vali Acc: 0.796 Test Loss: 0.641 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796046).  Saving model ...
Epoch: 11 cost time: 2.1163601875305176
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.667 Vali Acc: 0.796 Test Loss: 0.667 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8831486701965332
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.695 Vali Acc: 0.796 Test Loss: 0.695 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8051741123199463
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.711 Vali Acc: 0.809 Test Loss: 0.711 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809203).  Saving model ...
Epoch: 14 cost time: 1.9420528411865234
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.720 Vali Acc: 0.809 Test Loss: 0.720 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.781907081604004
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.737 Vali Acc: 0.809 Test Loss: 0.737 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.886812686920166
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.755 Vali Acc: 0.809 Test Loss: 0.755 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8344697952270508
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.768 Vali Acc: 0.809 Test Loss: 0.768 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8152780532836914
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.773 Vali Acc: 0.816 Test Loss: 0.773 Test Acc: 0.816
Validation loss decreased (-0.809203 --> -0.815782).  Saving model ...
Epoch: 19 cost time: 1.9044582843780518
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.780 Vali Acc: 0.816 Test Loss: 0.780 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9367871284484863
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.792 Vali Acc: 0.803 Test Loss: 0.792 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9004666805267334
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.810 Vali Acc: 0.803 Test Loss: 0.810 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8547124862670898
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.827 Vali Acc: 0.803 Test Loss: 0.827 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9353790283203125
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.838 Vali Acc: 0.809 Test Loss: 0.838 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.036109209060669
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.849 Vali Acc: 0.809 Test Loss: 0.849 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7528786659240723
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.860 Vali Acc: 0.809 Test Loss: 0.860 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.0822672843933105
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.868 Vali Acc: 0.816 Test Loss: 0.868 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9144892692565918
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.878 Vali Acc: 0.809 Test Loss: 0.878 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8424770832061768
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.885 Vali Acc: 0.809 Test Loss: 0.885 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 4717316
model size : 27.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.468845844268799
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.336 Vali Acc: 0.395 Test Loss: 1.336 Test Acc: 0.395
Validation loss decreased (inf --> -0.394723).  Saving model ...
Epoch: 2 cost time: 2.0015218257904053
Epoch: 2, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.211 Vali Acc: 0.461 Test Loss: 1.211 Test Acc: 0.461
Validation loss decreased (-0.394723 --> -0.460514).  Saving model ...
Epoch: 3 cost time: 2.035020112991333
Epoch: 3, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.087 Vali Acc: 0.520 Test Loss: 1.087 Test Acc: 0.520
Validation loss decreased (-0.460514 --> -0.519726).  Saving model ...
Epoch: 4 cost time: 2.1792490482330322
Epoch: 4, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.954 Vali Acc: 0.566 Test Loss: 0.954 Test Acc: 0.566
Validation loss decreased (-0.519726 --> -0.565780).  Saving model ...
Epoch: 5 cost time: 2.0947678089141846
Epoch: 5, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.829 Vali Acc: 0.632 Test Loss: 0.829 Test Acc: 0.632
Validation loss decreased (-0.565780 --> -0.631571).  Saving model ...
Epoch: 6 cost time: 2.260655641555786
Epoch: 6, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.737 Vali Acc: 0.671 Test Loss: 0.737 Test Acc: 0.671
Validation loss decreased (-0.631571 --> -0.671045).  Saving model ...
Epoch: 7 cost time: 2.101886510848999
Epoch: 7, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.679 Vali Acc: 0.724 Test Loss: 0.679 Test Acc: 0.724
Validation loss decreased (-0.671045 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 2.039736032485962
Epoch: 8, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.614 Vali Acc: 0.757 Test Loss: 0.614 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 2.185417652130127
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.629 Vali Acc: 0.776 Test Loss: 0.629 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.8879475593566895
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.652 Vali Acc: 0.796 Test Loss: 0.652 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796046).  Saving model ...
Epoch: 11 cost time: 1.9531528949737549
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.672 Vali Acc: 0.803 Test Loss: 0.672 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 12 cost time: 1.8140013217926025
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6772964000701904
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.703 Vali Acc: 0.789 Test Loss: 0.703 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0834908485412598
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.905195951461792
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.736 Vali Acc: 0.803 Test Loss: 0.736 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6529231071472168
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.751 Vali Acc: 0.796 Test Loss: 0.751 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.872121810913086
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.764 Vali Acc: 0.803 Test Loss: 0.764 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7248420715332031
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.771 Vali Acc: 0.809 Test Loss: 0.771 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809203).  Saving model ...
Epoch: 19 cost time: 1.9274861812591553
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.777 Vali Acc: 0.803 Test Loss: 0.777 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9884095191955566
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.786 Vali Acc: 0.803 Test Loss: 0.786 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0349411964416504
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.803 Test Loss: 0.794 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.151003360748291
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.811 Vali Acc: 0.803 Test Loss: 0.811 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.126718521118164
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.824 Vali Acc: 0.803 Test Loss: 0.824 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0512001514434814
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.833 Vali Acc: 0.803 Test Loss: 0.833 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.015408754348755
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.843 Vali Acc: 0.809 Test Loss: 0.843 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9836056232452393
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.852 Vali Acc: 0.809 Test Loss: 0.852 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9282846450805664
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.864 Vali Acc: 0.796 Test Loss: 0.864 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9341938495635986
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.809 Test Loss: 0.869 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 4717316
model size : 27.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1009256839752197
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.378 Vali Acc: 0.349 Test Loss: 1.378 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 1.9748919010162354
Epoch: 2, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.286 Vali Acc: 0.368 Test Loss: 1.286 Test Acc: 0.368
Validation loss decreased (-0.348670 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.9165542125701904
Epoch: 3, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.160 Vali Acc: 0.520 Test Loss: 1.160 Test Acc: 0.520
Validation loss decreased (-0.368408 --> -0.519725).  Saving model ...
Epoch: 4 cost time: 2.1106534004211426
Epoch: 4, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.006 Vali Acc: 0.599 Test Loss: 1.006 Test Acc: 0.599
Validation loss decreased (-0.519725 --> -0.598674).  Saving model ...
Epoch: 5 cost time: 2.202155113220215
Epoch: 5, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.864 Vali Acc: 0.645 Test Loss: 0.864 Test Acc: 0.645
Validation loss decreased (-0.598674 --> -0.644728).  Saving model ...
Epoch: 6 cost time: 1.7893311977386475
Epoch: 6, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.791 Vali Acc: 0.684 Test Loss: 0.791 Test Acc: 0.684
Validation loss decreased (-0.644728 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 1.9279088973999023
Epoch: 7, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.743 Vali Acc: 0.711 Test Loss: 0.743 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710519).  Saving model ...
Epoch: 8 cost time: 1.9557373523712158
Epoch: 8, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.722 Vali Acc: 0.743 Test Loss: 0.722 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 1.962472915649414
Epoch: 9, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.759 Vali Acc: 0.743 Test Loss: 0.759 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9123625755310059
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.800 Vali Acc: 0.757 Test Loss: 0.800 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756571).  Saving model ...
Epoch: 11 cost time: 1.920515775680542
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7033729553222656
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.913 Vali Acc: 0.763 Test Loss: 0.913 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763149).  Saving model ...
Epoch: 13 cost time: 2.247657537460327
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.934 Vali Acc: 0.770 Test Loss: 0.934 Test Acc: 0.770
Validation loss decreased (-0.763149 --> -0.769728).  Saving model ...
Epoch: 14 cost time: 2.0606439113616943
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.931 Vali Acc: 0.770 Test Loss: 0.931 Test Acc: 0.770
Validation loss decreased (-0.769728 --> -0.769728).  Saving model ...
Epoch: 15 cost time: 2.038217306137085
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.940 Vali Acc: 0.770 Test Loss: 0.940 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8794090747833252
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.970 Vali Acc: 0.763 Test Loss: 0.970 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7561516761779785
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.988 Vali Acc: 0.770 Test Loss: 0.988 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0041184425354004
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.988 Vali Acc: 0.770 Test Loss: 0.988 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0760250091552734
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.007 Vali Acc: 0.763 Test Loss: 1.007 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.1298577785491943
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.023 Vali Acc: 0.763 Test Loss: 1.023 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9419739246368408
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.036 Vali Acc: 0.763 Test Loss: 1.036 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.178447961807251
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.051 Vali Acc: 0.770 Test Loss: 1.051 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.2145516872406006
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.056 Vali Acc: 0.763 Test Loss: 1.056 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.1393609046936035
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.070 Vali Acc: 0.763 Test Loss: 1.070 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 4717316
model size : 27.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.341393232345581
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.359 Vali Acc: 0.368 Test Loss: 1.359 Test Acc: 0.368
Validation loss decreased (inf --> -0.368407).  Saving model ...
Epoch: 2 cost time: 2.01918888092041
Epoch: 2, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.249 Vali Acc: 0.454 Test Loss: 1.249 Test Acc: 0.454
Validation loss decreased (-0.368407 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 1.9893887042999268
Epoch: 3, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.107 Vali Acc: 0.539 Test Loss: 1.107 Test Acc: 0.539
Validation loss decreased (-0.453935 --> -0.539463).  Saving model ...
Epoch: 4 cost time: 1.974001407623291
Epoch: 4, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.956 Vali Acc: 0.632 Test Loss: 0.956 Test Acc: 0.632
Validation loss decreased (-0.539463 --> -0.631569).  Saving model ...
Epoch: 5 cost time: 1.8767638206481934
Epoch: 5, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.824 Vali Acc: 0.691 Test Loss: 0.824 Test Acc: 0.691
Validation loss decreased (-0.631569 --> -0.690781).  Saving model ...
Epoch: 6 cost time: 2.1027634143829346
Epoch: 6, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.755 Vali Acc: 0.697 Test Loss: 0.755 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697361).  Saving model ...
Epoch: 7 cost time: 2.073715925216675
Epoch: 7, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.719 Vali Acc: 0.730 Test Loss: 0.719 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 2.2698776721954346
Epoch: 8, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.701 Vali Acc: 0.757 Test Loss: 0.701 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756572).  Saving model ...
Epoch: 9 cost time: 2.0814778804779053
Epoch: 9, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.723 Vali Acc: 0.757 Test Loss: 0.723 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0329854488372803
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.765 Vali Acc: 0.776 Test Loss: 0.765 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776308).  Saving model ...
Epoch: 11 cost time: 1.9907104969024658
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.817 Vali Acc: 0.783 Test Loss: 0.817 Test Acc: 0.783
Validation loss decreased (-0.776308 --> -0.782887).  Saving model ...
Epoch: 12 cost time: 2.20181941986084
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.820 Vali Acc: 0.783 Test Loss: 0.820 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2777292728424072
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.844 Vali Acc: 0.783 Test Loss: 0.844 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.087590217590332
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.852 Vali Acc: 0.783 Test Loss: 0.852 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8052780628204346
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.880 Vali Acc: 0.783 Test Loss: 0.880 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9762485027313232
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.909 Vali Acc: 0.783 Test Loss: 0.909 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7683930397033691
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.926 Vali Acc: 0.783 Test Loss: 0.926 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8220407962799072
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.920 Vali Acc: 0.783 Test Loss: 0.920 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7427847385406494
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.932 Vali Acc: 0.783 Test Loss: 0.932 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9898781776428223
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.953 Vali Acc: 0.783 Test Loss: 0.953 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0656468868255615
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.967 Vali Acc: 0.783 Test Loss: 0.967 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 4717316
model size : 27.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8470444679260254
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 2.0218353271484375
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.230249 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 2.113030195236206
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 2.15667462348938
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 2.063211679458618
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 6 cost time: 1.8339903354644775
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 7 cost time: 2.178804636001587
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 8 cost time: 1.9207537174224854
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 9 cost time: 2.131088972091675
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 10 cost time: 1.9307992458343506
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 11 cost time: 1.9421372413635254
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 12 cost time: 1.9150784015655518
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 13 cost time: 2.0310091972351074
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 2.071239948272705
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 1.9374535083770752
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 2.0090901851654053
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 2.067385196685791
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 2.0601165294647217
Epoch: 18, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 1.9231867790222168
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 1.8802211284637451
Epoch: 20, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 2.0269668102264404
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.0378341674804688
Epoch: 22, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 2.088595390319824
Epoch: 23, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 2.1833720207214355
Epoch: 24, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 2.076662302017212
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9705028533935547
Epoch: 26, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 1.9238872528076172
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.1607062816619873
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.076756000518799
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.1045758724212646
Epoch: 30, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.1324570178985596
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 2.118459701538086
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.1728930473327637
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.4383132457733154
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.2478749752044678
Epoch: 35, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 1.9231624603271484
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 1.957749605178833
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 1.9429163932800293
Epoch: 38, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.0175271034240723
Epoch: 39, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.859985113143921
Epoch: 40, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.095771074295044
Epoch: 41, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 1.936779499053955
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 1.9314055442810059
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.1261494159698486
Epoch: 44, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 45 cost time: 2.2311980724334717
Epoch: 45, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.0642199516296387
Epoch: 46, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 2.0949957370758057
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 48 cost time: 2.129347801208496
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.2876338958740234
Epoch: 49, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.2116191387176514
Epoch: 50, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.0016438961029053
Epoch: 51, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.010103225708008
Epoch: 52, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 2.0791492462158203
Epoch: 53, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 2.127903938293457
Epoch: 54, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 55 cost time: 2.021428108215332
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 56 cost time: 2.1778695583343506
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 57 cost time: 1.9753272533416748
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.2782671451568604
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 59 cost time: 1.944742202758789
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.2009077072143555
Epoch: 60, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.1988542079925537
Epoch: 61, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 2.2476468086242676
Epoch: 62, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 63 cost time: 2.136974573135376
Epoch: 63, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.9964985847473145
Epoch: 64, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.1200718879699707
Epoch: 65, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.9447882175445557
Epoch: 66, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.982231616973877
Epoch: 67, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.9101858139038086
Epoch: 68, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.9788281917572021
Epoch: 69, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 2.0622119903564453
Epoch: 70, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 2.0427680015563965
Epoch: 71, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.79156494140625
Epoch: 72, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 4717316
model size : 27.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9673614501953125
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.297 Vali Acc: 0.428 Test Loss: 1.297 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 2.020251989364624
Epoch: 2, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.055 Vali Acc: 0.671 Test Loss: 1.055 Test Acc: 0.671
Validation loss decreased (-0.427619 --> -0.671042).  Saving model ...
Epoch: 3 cost time: 1.9694328308105469
Epoch: 3, Steps: 10 | Train Loss: 0.794 Vali Loss: 0.874 Vali Acc: 0.671 Test Loss: 0.874 Test Acc: 0.671
Validation loss decreased (-0.671042 --> -0.671044).  Saving model ...
Epoch: 4 cost time: 1.9939806461334229
Epoch: 4, Steps: 10 | Train Loss: 0.554 Vali Loss: 0.790 Vali Acc: 0.711 Test Loss: 0.790 Test Acc: 0.711
Validation loss decreased (-0.671044 --> -0.710518).  Saving model ...
Epoch: 5 cost time: 1.85886812210083
Epoch: 5, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.756 Vali Acc: 0.737 Test Loss: 0.756 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 2.053913116455078
Epoch: 6, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.686 Vali Acc: 0.717 Test Loss: 0.686 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9371793270111084
Epoch: 7, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 2.0629916191101074
Epoch: 8, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.607 Vali Acc: 0.770 Test Loss: 0.607 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.7402245998382568
Epoch: 9, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.616 Vali Acc: 0.789 Test Loss: 0.616 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.8414218425750732
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809204).  Saving model ...
Epoch: 11 cost time: 1.8284835815429688
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.666 Vali Acc: 0.803 Test Loss: 0.666 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.873333215713501
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.684 Vali Acc: 0.809 Test Loss: 0.684 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8669404983520508
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.703 Vali Acc: 0.809 Test Loss: 0.703 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.803356647491455
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.704 Vali Acc: 0.803 Test Loss: 0.704 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7914698123931885
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.727 Vali Acc: 0.803 Test Loss: 0.727 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7398934364318848
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.752 Vali Acc: 0.803 Test Loss: 0.752 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9914896488189697
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.774 Vali Acc: 0.803 Test Loss: 0.774 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9564642906188965
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.796 Test Loss: 0.793 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9268743991851807
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.804 Vali Acc: 0.796 Test Loss: 0.804 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8444817066192627
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.822 Vali Acc: 0.803 Test Loss: 0.822 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 3144452
model size : 21.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.604729413986206
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.299 Vali Acc: 0.428 Test Loss: 1.299 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 1.8677268028259277
Epoch: 2, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.085 Vali Acc: 0.632 Test Loss: 1.085 Test Acc: 0.632
Validation loss decreased (-0.427619 --> -0.631568).  Saving model ...
Epoch: 3 cost time: 1.802384614944458
Epoch: 3, Steps: 10 | Train Loss: 0.859 Vali Loss: 0.914 Vali Acc: 0.671 Test Loss: 0.914 Test Acc: 0.671
Validation loss decreased (-0.631568 --> -0.671043).  Saving model ...
Epoch: 4 cost time: 2.0915567874908447
Epoch: 4, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.805 Vali Acc: 0.691 Test Loss: 0.805 Test Acc: 0.691
Validation loss decreased (-0.671043 --> -0.690781).  Saving model ...
Epoch: 5 cost time: 1.8180770874023438
Epoch: 5, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.755 Vali Acc: 0.743 Test Loss: 0.755 Test Acc: 0.743
Validation loss decreased (-0.690781 --> -0.743414).  Saving model ...
Epoch: 6 cost time: 1.8796825408935547
Epoch: 6, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.683 Vali Acc: 0.763 Test Loss: 0.683 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763151).  Saving model ...
Epoch: 7 cost time: 1.9500858783721924
Epoch: 7, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.632 Vali Acc: 0.763 Test Loss: 0.632 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.9455468654632568
Epoch: 8, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.9198060035705566
Epoch: 9, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.607 Vali Acc: 0.796 Test Loss: 0.607 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 1.9959609508514404
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.632 Vali Acc: 0.783 Test Loss: 0.632 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.15805721282959
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.653 Vali Acc: 0.803 Test Loss: 0.653 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 12 cost time: 2.289130687713623
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.680 Vali Acc: 0.796 Test Loss: 0.680 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1294355392456055
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.691 Vali Acc: 0.796 Test Loss: 0.691 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0925378799438477
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.695 Vali Acc: 0.796 Test Loss: 0.695 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.014739751815796
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.722 Vali Acc: 0.803 Test Loss: 0.722 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.005307674407959
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.751 Vali Acc: 0.789 Test Loss: 0.751 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0068016052246094
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.772 Vali Acc: 0.796 Test Loss: 0.772 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9136812686920166
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.791 Vali Acc: 0.803 Test Loss: 0.791 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0858376026153564
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.805 Vali Acc: 0.803 Test Loss: 0.805 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.979353427886963
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.827 Vali Acc: 0.803 Test Loss: 0.827 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9438984394073486
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.838 Vali Acc: 0.803 Test Loss: 0.838 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 3144452
model size : 21.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.593050003051758
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.335 Vali Acc: 0.336 Test Loss: 1.335 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 2.079167604446411
Epoch: 2, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.183 Vali Acc: 0.493 Test Loss: 1.183 Test Acc: 0.493
Validation loss decreased (-0.335513 --> -0.493409).  Saving model ...
Epoch: 3 cost time: 2.104231595993042
Epoch: 3, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.026 Vali Acc: 0.586 Test Loss: 1.026 Test Acc: 0.586
Validation loss decreased (-0.493409 --> -0.585516).  Saving model ...
Epoch: 4 cost time: 2.141404390335083
Epoch: 4, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.880 Vali Acc: 0.671 Test Loss: 0.880 Test Acc: 0.671
Validation loss decreased (-0.585516 --> -0.671044).  Saving model ...
Epoch: 5 cost time: 2.222142219543457
Epoch: 5, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.771 Vali Acc: 0.678 Test Loss: 0.771 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677624).  Saving model ...
Epoch: 6 cost time: 2.1175858974456787
Epoch: 6, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.656 Vali Acc: 0.730 Test Loss: 0.656 Test Acc: 0.730
Validation loss decreased (-0.677624 --> -0.730257).  Saving model ...
Epoch: 7 cost time: 2.2584288120269775
Epoch: 7, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.600 Vali Acc: 0.757 Test Loss: 0.600 Test Acc: 0.757
Validation loss decreased (-0.730257 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 2.261798858642578
Epoch: 8, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.32391357421875
Epoch: 9, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.9738869667053223
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802625).  Saving model ...
Epoch: 11 cost time: 2.2013401985168457
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2628493309020996
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.673 Vali Acc: 0.803 Test Loss: 0.673 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0386621952056885
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.688 Vali Acc: 0.809 Test Loss: 0.688 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 14 cost time: 2.000213623046875
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.702 Vali Acc: 0.809 Test Loss: 0.702 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.295886516571045
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.728 Vali Acc: 0.809 Test Loss: 0.728 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9807255268096924
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.748 Vali Acc: 0.809 Test Loss: 0.748 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0342624187469482
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.764 Vali Acc: 0.809 Test Loss: 0.764 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9324188232421875
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.783 Vali Acc: 0.803 Test Loss: 0.783 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0556721687316895
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.799 Vali Acc: 0.809 Test Loss: 0.799 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.183030605316162
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.817 Vali Acc: 0.809 Test Loss: 0.817 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0796079635620117
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.827 Vali Acc: 0.816 Test Loss: 0.827 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815781).  Saving model ...
Epoch: 22 cost time: 2.322876453399658
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.837 Vali Acc: 0.809 Test Loss: 0.837 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2607290744781494
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.847 Vali Acc: 0.809 Test Loss: 0.847 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1992173194885254
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.859 Vali Acc: 0.809 Test Loss: 0.859 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.134075403213501
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.872 Vali Acc: 0.803 Test Loss: 0.872 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.158143997192383
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.884 Vali Acc: 0.803 Test Loss: 0.884 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0437111854553223
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.892 Vali Acc: 0.803 Test Loss: 0.892 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.269909143447876
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.809 Test Loss: 0.899 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.0098021030426025
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.905 Vali Acc: 0.816 Test Loss: 0.905 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.982607364654541
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.912 Vali Acc: 0.809 Test Loss: 0.912 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9669537544250488
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.922 Vali Acc: 0.809 Test Loss: 0.922 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 3144452
model size : 21.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.93847393989563
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.433 Vali Acc: 0.263 Test Loss: 1.433 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.8691496849060059
Epoch: 2, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.329 Vali Acc: 0.336 Test Loss: 1.329 Test Acc: 0.336
Validation loss decreased (-0.263144 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 2.103165626525879
Epoch: 3, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.182 Vali Acc: 0.428 Test Loss: 1.182 Test Acc: 0.428
Validation loss decreased (-0.335513 --> -0.427620).  Saving model ...
Epoch: 4 cost time: 1.7887234687805176
Epoch: 4, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.011 Vali Acc: 0.553 Test Loss: 1.011 Test Acc: 0.553
Validation loss decreased (-0.427620 --> -0.552621).  Saving model ...
Epoch: 5 cost time: 2.0185530185699463
Epoch: 5, Steps: 10 | Train Loss: 0.569 Vali Loss: 0.883 Vali Acc: 0.618 Test Loss: 0.883 Test Acc: 0.618
Validation loss decreased (-0.552621 --> -0.618412).  Saving model ...
Epoch: 6 cost time: 2.0699026584625244
Epoch: 6, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.759 Vali Acc: 0.664 Test Loss: 0.759 Test Acc: 0.664
Validation loss decreased (-0.618412 --> -0.664466).  Saving model ...
Epoch: 7 cost time: 2.1039540767669678
Epoch: 7, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.642 Vali Acc: 0.717 Test Loss: 0.642 Test Acc: 0.717
Validation loss decreased (-0.664466 --> -0.717099).  Saving model ...
Epoch: 8 cost time: 2.2550480365753174
Epoch: 8, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.621 Vali Acc: 0.763 Test Loss: 0.621 Test Acc: 0.763
Validation loss decreased (-0.717099 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 2.0641798973083496
Epoch: 9, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 2.3098349571228027
Epoch: 10, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.637 Vali Acc: 0.776 Test Loss: 0.637 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.914241075515747
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.656 Vali Acc: 0.783 Test Loss: 0.656 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 12 cost time: 1.9567172527313232
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.670 Vali Acc: 0.796 Test Loss: 0.670 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796046).  Saving model ...
Epoch: 13 cost time: 2.252291679382324
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.695 Vali Acc: 0.796 Test Loss: 0.695 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9267966747283936
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.718 Vali Acc: 0.796 Test Loss: 0.718 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1190271377563477
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.741 Vali Acc: 0.796 Test Loss: 0.741 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8374450206756592
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.748 Vali Acc: 0.796 Test Loss: 0.748 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1129467487335205
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.764 Vali Acc: 0.796 Test Loss: 0.764 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.077786684036255
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.786 Vali Acc: 0.796 Test Loss: 0.786 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.061978340148926
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.796 Vali Acc: 0.796 Test Loss: 0.796 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.046536445617676
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.807 Vali Acc: 0.803 Test Loss: 0.807 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 21 cost time: 2.004669427871704
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.817 Vali Acc: 0.809 Test Loss: 0.817 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809202).  Saving model ...
Epoch: 22 cost time: 2.2476747035980225
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.830 Vali Acc: 0.803 Test Loss: 0.830 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8859927654266357
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.843 Vali Acc: 0.809 Test Loss: 0.843 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8410794734954834
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.853 Vali Acc: 0.816 Test Loss: 0.853 Test Acc: 0.816
Validation loss decreased (-0.809202 --> -0.815781).  Saving model ...
Epoch: 25 cost time: 1.817671298980713
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.863 Vali Acc: 0.809 Test Loss: 0.863 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9950520992279053
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.875 Vali Acc: 0.809 Test Loss: 0.875 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.889725685119629
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.885 Vali Acc: 0.809 Test Loss: 0.885 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8305864334106445
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.895 Vali Acc: 0.809 Test Loss: 0.895 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9775843620300293
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.905 Vali Acc: 0.809 Test Loss: 0.905 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.1488444805145264
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.911 Vali Acc: 0.816 Test Loss: 0.911 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.064056634902954
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.816 Test Loss: 0.915 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.1836888790130615
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.923 Vali Acc: 0.816 Test Loss: 0.923 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.000732421875
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.816 Test Loss: 0.936 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.0901355743408203
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.940 Vali Acc: 0.816 Test Loss: 0.940 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 3144452
model size : 21.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7583582401275635
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.428 Vali Acc: 0.243 Test Loss: 1.428 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.8179538249969482
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.341 Vali Acc: 0.296 Test Loss: 1.341 Test Acc: 0.296
Validation loss decreased (-0.243407 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.8167636394500732
Epoch: 3, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.203 Vali Acc: 0.467 Test Loss: 1.203 Test Acc: 0.467
Validation loss decreased (-0.296039 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 2.0048816204071045
Epoch: 4, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.017 Vali Acc: 0.612 Test Loss: 1.017 Test Acc: 0.612
Validation loss decreased (-0.467093 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 1.7476904392242432
Epoch: 5, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.857 Vali Acc: 0.645 Test Loss: 0.857 Test Acc: 0.645
Validation loss decreased (-0.611832 --> -0.644728).  Saving model ...
Epoch: 6 cost time: 1.8510479927062988
Epoch: 6, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.732 Vali Acc: 0.684 Test Loss: 0.732 Test Acc: 0.684
Validation loss decreased (-0.644728 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 2.0158848762512207
Epoch: 7, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.699 Vali Acc: 0.724 Test Loss: 0.699 Test Acc: 0.724
Validation loss decreased (-0.684203 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 1.948469638824463
Epoch: 8, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.689 Vali Acc: 0.730 Test Loss: 0.689 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 9 cost time: 2.045474052429199
Epoch: 9, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.686 Vali Acc: 0.757 Test Loss: 0.686 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756572).  Saving model ...
Epoch: 10 cost time: 1.9575915336608887
Epoch: 10, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.716 Vali Acc: 0.757 Test Loss: 0.716 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.982886791229248
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.756 Vali Acc: 0.770 Test Loss: 0.756 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769729).  Saving model ...
Epoch: 12 cost time: 1.989262580871582
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.826 Vali Acc: 0.776 Test Loss: 0.826 Test Acc: 0.776
Validation loss decreased (-0.769729 --> -0.776308).  Saving model ...
Epoch: 13 cost time: 2.229790210723877
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.831 Vali Acc: 0.776 Test Loss: 0.831 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9083497524261475
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.822 Vali Acc: 0.783 Test Loss: 0.822 Test Acc: 0.783
Validation loss decreased (-0.776308 --> -0.782887).  Saving model ...
Epoch: 15 cost time: 1.8920750617980957
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.870 Vali Acc: 0.776 Test Loss: 0.870 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8750176429748535
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.908 Vali Acc: 0.789 Test Loss: 0.908 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789465).  Saving model ...
Epoch: 17 cost time: 1.891608715057373
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.925 Vali Acc: 0.783 Test Loss: 0.925 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8921711444854736
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.948 Vali Acc: 0.783 Test Loss: 0.948 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0161454677581787
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.967 Vali Acc: 0.783 Test Loss: 0.967 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0553500652313232
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.987 Vali Acc: 0.783 Test Loss: 0.987 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2706286907196045
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.001 Vali Acc: 0.783 Test Loss: 1.001 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1125378608703613
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.017 Vali Acc: 0.783 Test Loss: 1.017 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0279009342193604
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.024 Vali Acc: 0.776 Test Loss: 1.024 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7547187805175781
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.034 Vali Acc: 0.770 Test Loss: 1.034 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9672582149505615
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.770 Test Loss: 1.052 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.1269540786743164
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.065 Vali Acc: 0.776 Test Loss: 1.065 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 3144452
model size : 21.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2253055572509766
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.425 Vali Acc: 0.257 Test Loss: 1.425 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.979924201965332
Epoch: 2, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.334 Vali Acc: 0.342 Test Loss: 1.334 Test Acc: 0.342
Validation loss decreased (-0.256565 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.885643482208252
Epoch: 3, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.194 Vali Acc: 0.474 Test Loss: 1.194 Test Acc: 0.474
Validation loss decreased (-0.342092 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 1.9193792343139648
Epoch: 4, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.019 Vali Acc: 0.599 Test Loss: 1.019 Test Acc: 0.599
Validation loss decreased (-0.473672 --> -0.598674).  Saving model ...
Epoch: 5 cost time: 1.7702572345733643
Epoch: 5, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.879 Vali Acc: 0.638 Test Loss: 0.879 Test Acc: 0.638
Validation loss decreased (-0.598674 --> -0.638149).  Saving model ...
Epoch: 6 cost time: 1.8852386474609375
Epoch: 6, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.767 Vali Acc: 0.678 Test Loss: 0.767 Test Acc: 0.678
Validation loss decreased (-0.638149 --> -0.677624).  Saving model ...
Epoch: 7 cost time: 1.9791975021362305
Epoch: 7, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.730 Vali Acc: 0.724 Test Loss: 0.730 Test Acc: 0.724
Validation loss decreased (-0.677624 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 1.8942313194274902
Epoch: 8, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.712 Vali Acc: 0.737 Test Loss: 0.712 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 1.7765965461730957
Epoch: 9, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.697 Vali Acc: 0.776 Test Loss: 0.697 Test Acc: 0.776
Validation loss decreased (-0.736835 --> -0.776309).  Saving model ...
Epoch: 10 cost time: 1.761772871017456
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.728 Vali Acc: 0.763 Test Loss: 0.728 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7519617080688477
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.748 Vali Acc: 0.789 Test Loss: 0.748 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789466).  Saving model ...
Epoch: 12 cost time: 1.8809738159179688
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.788 Vali Acc: 0.783 Test Loss: 0.788 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7544538974761963
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.801 Vali Acc: 0.789 Test Loss: 0.801 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7198162078857422
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.803 Vali Acc: 0.789 Test Loss: 0.803 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9056651592254639
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.840 Vali Acc: 0.783 Test Loss: 0.840 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0451667308807373
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.867 Vali Acc: 0.783 Test Loss: 0.867 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.792961597442627
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.890 Vali Acc: 0.783 Test Loss: 0.890 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9554319381713867
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.918 Vali Acc: 0.783 Test Loss: 0.918 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9712917804718018
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.940 Vali Acc: 0.783 Test Loss: 0.940 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8108117580413818
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.960 Vali Acc: 0.776 Test Loss: 0.960 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5907130241394043
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.964 Vali Acc: 0.776 Test Loss: 0.964 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 3144452
model size : 21.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.602158784866333
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 1.7489116191864014
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 2.1558117866516113
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 4 cost time: 2.0327260494232178
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 5 cost time: 2.00191593170166
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 6 cost time: 1.9576342105865479
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 7 cost time: 1.9671592712402344
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 8 cost time: 1.9560344219207764
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 9 cost time: 1.917466163635254
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 10 cost time: 1.8720495700836182
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.223670 --> -0.282881).  Saving model ...
Epoch: 11 cost time: 1.950462818145752
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 12 cost time: 2.078301191329956
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 13 cost time: 1.9103071689605713
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 1.9487359523773193
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 1.9804294109344482
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 2.0168018341064453
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0180230140686035
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 2.114060163497925
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 1.9638123512268066
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 1.9471311569213867
Epoch: 20, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 1.9118459224700928
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.082432985305786
Epoch: 22, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 1.9682204723358154
Epoch: 23, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 1.8058011531829834
Epoch: 24, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 2.0062429904937744
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.002305269241333
Epoch: 26, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.086812973022461
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.1157631874084473
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.104738712310791
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.2772305011749268
Epoch: 30, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.239847421646118
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.189697265625
Epoch: 32, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.1403183937072754
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.223863124847412
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.2198281288146973
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 1.9548804759979248
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.0406906604766846
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.9402618408203125
Epoch: 38, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.083982467651367
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 1.867225170135498
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 1.8551490306854248
Epoch: 41, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 1.9154350757598877
Epoch: 42, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 1.984328031539917
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.0186641216278076
Epoch: 44, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.0395562648773193
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 1.9925994873046875
Epoch: 46, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 1.9038805961608887
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.77042555809021
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.7531764507293701
Epoch: 49, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.856161117553711
Epoch: 50, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.8230712413787842
Epoch: 51, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.839888095855713
Epoch: 52, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.787365436553955
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 1.7309465408325195
Epoch: 54, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 55 cost time: 1.933072566986084
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 56 cost time: 2.10728120803833
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.0142483711242676
Epoch: 57, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.0176172256469727
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.9460997581481934
Epoch: 59, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 60 cost time: 1.9788627624511719
Epoch: 60, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 61 cost time: 2.1774139404296875
Epoch: 61, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 62 cost time: 2.020720958709717
Epoch: 62, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.141810417175293
Epoch: 63, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.990276575088501
Epoch: 64, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.161654472351074
Epoch: 65, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.9363617897033691
Epoch: 66, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 2.0681889057159424
Epoch: 67, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.8804118633270264
Epoch: 68, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 2.1085264682769775
Epoch: 69, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 2.149163246154785
Epoch: 70, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 2.1211085319519043
Epoch: 71, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 3144452
model size : 21.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5078938007354736
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.245 Vali Acc: 0.493 Test Loss: 1.245 Test Acc: 0.493
Validation loss decreased (inf --> -0.493409).  Saving model ...
Epoch: 2 cost time: 1.7613279819488525
Epoch: 2, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.066 Vali Acc: 0.651 Test Loss: 1.066 Test Acc: 0.651
Validation loss decreased (-0.493409 --> -0.651305).  Saving model ...
Epoch: 3 cost time: 1.9615719318389893
Epoch: 3, Steps: 10 | Train Loss: 0.862 Vali Loss: 0.903 Vali Acc: 0.691 Test Loss: 0.903 Test Acc: 0.691
Validation loss decreased (-0.651305 --> -0.690780).  Saving model ...
Epoch: 4 cost time: 2.025745391845703
Epoch: 4, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.801 Vali Acc: 0.704 Test Loss: 0.801 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703939).  Saving model ...
Epoch: 5 cost time: 1.6916518211364746
Epoch: 5, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.8744392395019531
Epoch: 6, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.694 Vali Acc: 0.724 Test Loss: 0.694 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 7 cost time: 2.184119701385498
Epoch: 7, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.654 Vali Acc: 0.757 Test Loss: 0.654 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756572).  Saving model ...
Epoch: 8 cost time: 2.162365436553955
Epoch: 8, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 1.9446215629577637
Epoch: 9, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.619 Vali Acc: 0.776 Test Loss: 0.619 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 2.3100311756134033
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.614 Vali Acc: 0.803 Test Loss: 0.614 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802625).  Saving model ...
Epoch: 11 cost time: 2.2625012397766113
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.647 Vali Acc: 0.796 Test Loss: 0.647 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.274080276489258
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.035564422607422
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.709 Vali Acc: 0.803 Test Loss: 0.709 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0168721675872803
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.718 Vali Acc: 0.796 Test Loss: 0.718 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1334307193756104
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.734 Vali Acc: 0.803 Test Loss: 0.734 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.952683687210083
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.749 Vali Acc: 0.803 Test Loss: 0.749 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0031511783599854
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.768 Vali Acc: 0.803 Test Loss: 0.768 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.021206855773926
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.791 Vali Acc: 0.803 Test Loss: 0.791 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1062560081481934
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.814 Vali Acc: 0.803 Test Loss: 0.814 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.2207236289978027
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.822 Vali Acc: 0.803 Test Loss: 0.822 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 2358020
model size : 18.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6549301147460938
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.265 Vali Acc: 0.467 Test Loss: 1.265 Test Acc: 0.467
Validation loss decreased (inf --> -0.467093).  Saving model ...
Epoch: 2 cost time: 1.9306600093841553
Epoch: 2, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.105 Vali Acc: 0.592 Test Loss: 1.105 Test Acc: 0.592
Validation loss decreased (-0.467093 --> -0.592094).  Saving model ...
Epoch: 3 cost time: 1.8403537273406982
Epoch: 3, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.946 Vali Acc: 0.678 Test Loss: 0.946 Test Acc: 0.678
Validation loss decreased (-0.592094 --> -0.677622).  Saving model ...
Epoch: 4 cost time: 2.074124574661255
Epoch: 4, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.841 Vali Acc: 0.697 Test Loss: 0.841 Test Acc: 0.697
Validation loss decreased (-0.677622 --> -0.697360).  Saving model ...
Epoch: 5 cost time: 1.955747127532959
Epoch: 5, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.775 Vali Acc: 0.730 Test Loss: 0.775 Test Acc: 0.730
Validation loss decreased (-0.697360 --> -0.730255).  Saving model ...
Epoch: 6 cost time: 1.8838255405426025
Epoch: 6, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.697 Vali Acc: 0.750 Test Loss: 0.697 Test Acc: 0.750
Validation loss decreased (-0.730255 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 2.0214245319366455
Epoch: 7, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.653 Vali Acc: 0.770 Test Loss: 0.653 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 1.9696083068847656
Epoch: 8, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.624 Vali Acc: 0.750 Test Loss: 0.624 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9618875980377197
Epoch: 9, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.619 Vali Acc: 0.763 Test Loss: 0.619 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.958329439163208
Epoch: 10, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.620 Vali Acc: 0.776 Test Loss: 0.620 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.882725477218628
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.652 Vali Acc: 0.803 Test Loss: 0.652 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802625).  Saving model ...
Epoch: 12 cost time: 2.184119462966919
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.159929037094116
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.710 Vali Acc: 0.783 Test Loss: 0.710 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0508666038513184
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.719 Vali Acc: 0.783 Test Loss: 0.719 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9522509574890137
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.727 Vali Acc: 0.789 Test Loss: 0.727 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3749125003814697
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.735 Vali Acc: 0.789 Test Loss: 0.735 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.135232448577881
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.761 Vali Acc: 0.796 Test Loss: 0.761 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.235806703567505
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.784 Vali Acc: 0.789 Test Loss: 0.784 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.326270580291748
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.808 Vali Acc: 0.789 Test Loss: 0.808 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2381584644317627
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.816 Vali Acc: 0.789 Test Loss: 0.816 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0704212188720703
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.825 Vali Acc: 0.796 Test Loss: 0.825 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 2358020
model size : 18.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.212347984313965
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.332 Vali Acc: 0.368 Test Loss: 1.332 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 1.8641231060028076
Epoch: 2, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.209 Vali Acc: 0.487 Test Loss: 1.209 Test Acc: 0.487
Validation loss decreased (-0.368408 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 1.938253402709961
Epoch: 3, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.059 Vali Acc: 0.599 Test Loss: 1.059 Test Acc: 0.599
Validation loss decreased (-0.486830 --> -0.598674).  Saving model ...
Epoch: 4 cost time: 2.03640079498291
Epoch: 4, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.923 Vali Acc: 0.651 Test Loss: 0.923 Test Acc: 0.651
Validation loss decreased (-0.598674 --> -0.651307).  Saving model ...
Epoch: 5 cost time: 2.3074028491973877
Epoch: 5, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.811 Vali Acc: 0.697 Test Loss: 0.811 Test Acc: 0.697
Validation loss decreased (-0.651307 --> -0.697360).  Saving model ...
Epoch: 6 cost time: 2.1055655479431152
Epoch: 6, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.717 Vali Acc: 0.711 Test Loss: 0.717 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710519).  Saving model ...
Epoch: 7 cost time: 2.169851303100586
Epoch: 7, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.655 Vali Acc: 0.724 Test Loss: 0.655 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723678).  Saving model ...
Epoch: 8 cost time: 2.104602098464966
Epoch: 8, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.625 Vali Acc: 0.763 Test Loss: 0.625 Test Acc: 0.763
Validation loss decreased (-0.723678 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 2.0570085048675537
Epoch: 9, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.612 Vali Acc: 0.763 Test Loss: 0.612 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.988948106765747
Epoch: 10, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
Validation loss decreased (-0.763152 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.813626766204834
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.651 Vali Acc: 0.783 Test Loss: 0.651 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8919682502746582
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9098434448242188
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.709 Vali Acc: 0.776 Test Loss: 0.709 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8168141841888428
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.720 Vali Acc: 0.796 Test Loss: 0.720 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9306049346923828
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.726 Vali Acc: 0.803 Test Loss: 0.726 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802624).  Saving model ...
Epoch: 16 cost time: 2.107987880706787
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.733 Vali Acc: 0.809 Test Loss: 0.733 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809203).  Saving model ...
Epoch: 17 cost time: 1.9630372524261475
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.755 Vali Acc: 0.803 Test Loss: 0.755 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.222231149673462
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.776 Vali Acc: 0.803 Test Loss: 0.776 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.196329355239868
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.804 Vali Acc: 0.796 Test Loss: 0.804 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8984458446502686
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.818 Vali Acc: 0.796 Test Loss: 0.818 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9277465343475342
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.827 Vali Acc: 0.796 Test Loss: 0.827 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.92387056350708
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.836 Vali Acc: 0.803 Test Loss: 0.836 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.869276762008667
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.847 Vali Acc: 0.796 Test Loss: 0.847 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8278062343597412
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.856 Vali Acc: 0.796 Test Loss: 0.856 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7931725978851318
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.863 Vali Acc: 0.796 Test Loss: 0.863 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9529621601104736
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.877 Vali Acc: 0.796 Test Loss: 0.877 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2358020
model size : 18.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7657034397125244
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.403 Vali Acc: 0.243 Test Loss: 1.403 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 2.1376147270202637
Epoch: 2, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.310 Vali Acc: 0.322 Test Loss: 1.310 Test Acc: 0.322
Validation loss decreased (-0.243407 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.9136886596679688
Epoch: 3, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.187 Vali Acc: 0.447 Test Loss: 1.187 Test Acc: 0.447
Validation loss decreased (-0.322355 --> -0.447357).  Saving model ...
Epoch: 4 cost time: 2.0344059467315674
Epoch: 4, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.044 Vali Acc: 0.546 Test Loss: 1.044 Test Acc: 0.546
Validation loss decreased (-0.447357 --> -0.546042).  Saving model ...
Epoch: 5 cost time: 2.011869430541992
Epoch: 5, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.899 Vali Acc: 0.559 Test Loss: 0.899 Test Acc: 0.559
Validation loss decreased (-0.546042 --> -0.559202).  Saving model ...
Epoch: 6 cost time: 2.147463083267212
Epoch: 6, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.770 Vali Acc: 0.651 Test Loss: 0.770 Test Acc: 0.651
Validation loss decreased (-0.559202 --> -0.651308).  Saving model ...
Epoch: 7 cost time: 1.9336094856262207
Epoch: 7, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.682 Vali Acc: 0.724 Test Loss: 0.682 Test Acc: 0.724
Validation loss decreased (-0.651308 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 2.178367853164673
Epoch: 8, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.660 Vali Acc: 0.743 Test Loss: 0.660 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 2.2608275413513184
Epoch: 9, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.618 Vali Acc: 0.770 Test Loss: 0.618 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 2.2729170322418213
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.616 Vali Acc: 0.776 Test Loss: 0.616 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 2.255598545074463
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.652 Vali Acc: 0.776 Test Loss: 0.652 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.324143648147583
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.678 Vali Acc: 0.789 Test Loss: 0.678 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789467).  Saving model ...
Epoch: 13 cost time: 2.3516476154327393
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.710 Vali Acc: 0.789 Test Loss: 0.710 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1610655784606934
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.719 Vali Acc: 0.796 Test Loss: 0.719 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 15 cost time: 2.0270111560821533
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.722 Vali Acc: 0.809 Test Loss: 0.722 Test Acc: 0.809
Validation loss decreased (-0.796045 --> -0.809203).  Saving model ...
Epoch: 16 cost time: 2.035735845565796
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.729 Vali Acc: 0.796 Test Loss: 0.729 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9477949142456055
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.749 Vali Acc: 0.803 Test Loss: 0.749 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1533989906311035
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.765 Vali Acc: 0.803 Test Loss: 0.765 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8638412952423096
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.786 Vali Acc: 0.816 Test Loss: 0.786 Test Acc: 0.816
Validation loss decreased (-0.809203 --> -0.815782).  Saving model ...
Epoch: 20 cost time: 2.1123886108398438
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.797 Vali Acc: 0.816 Test Loss: 0.797 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1432037353515625
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.807 Vali Acc: 0.816 Test Loss: 0.807 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.278646945953369
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.816 Vali Acc: 0.816 Test Loss: 0.816 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0158348083496094
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.827 Vali Acc: 0.816 Test Loss: 0.827 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1521072387695312
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.835 Vali Acc: 0.816 Test Loss: 0.835 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.0949690341949463
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.842 Vali Acc: 0.816 Test Loss: 0.842 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.024496078491211
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.853 Vali Acc: 0.816 Test Loss: 0.853 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.2384469509124756
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.866 Vali Acc: 0.816 Test Loss: 0.866 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.999155044555664
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.880 Vali Acc: 0.816 Test Loss: 0.880 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.067399501800537
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.889 Vali Acc: 0.816 Test Loss: 0.889 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 2358020
model size : 18.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6202926635742188
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.413 Vali Acc: 0.230 Test Loss: 1.413 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 2.101090431213379
Epoch: 2, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.342 Vali Acc: 0.309 Test Loss: 1.342 Test Acc: 0.309
Validation loss decreased (-0.230249 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 1.9937570095062256
Epoch: 3, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.215 Vali Acc: 0.447 Test Loss: 1.215 Test Acc: 0.447
Validation loss decreased (-0.309197 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 1.991072177886963
Epoch: 4, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.045 Vali Acc: 0.579 Test Loss: 1.045 Test Acc: 0.579
Validation loss decreased (-0.447356 --> -0.578937).  Saving model ...
Epoch: 5 cost time: 2.194596290588379
Epoch: 5, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.877 Vali Acc: 0.638 Test Loss: 0.877 Test Acc: 0.638
Validation loss decreased (-0.578937 --> -0.638149).  Saving model ...
Epoch: 6 cost time: 2.0417892932891846
Epoch: 6, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.758 Vali Acc: 0.691 Test Loss: 0.758 Test Acc: 0.691
Validation loss decreased (-0.638149 --> -0.690782).  Saving model ...
Epoch: 7 cost time: 1.8068785667419434
Epoch: 7, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.719 Vali Acc: 0.724 Test Loss: 0.719 Test Acc: 0.724
Validation loss decreased (-0.690782 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 1.8237886428833008
Epoch: 8, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.689 Vali Acc: 0.743 Test Loss: 0.689 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 1.7492332458496094
Epoch: 9, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.717 Vali Acc: 0.750 Test Loss: 0.717 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 1.7588274478912354
Epoch: 10, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.711 Vali Acc: 0.750 Test Loss: 0.711 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 1.6940090656280518
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.771 Vali Acc: 0.757 Test Loss: 0.771 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756571).  Saving model ...
Epoch: 12 cost time: 1.8213984966278076
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.817 Vali Acc: 0.783 Test Loss: 0.817 Test Acc: 0.783
Validation loss decreased (-0.756571 --> -0.782887).  Saving model ...
Epoch: 13 cost time: 1.7384724617004395
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.884 Vali Acc: 0.757 Test Loss: 0.884 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0775036811828613
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.899 Vali Acc: 0.770 Test Loss: 0.899 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.958552360534668
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.912 Vali Acc: 0.776 Test Loss: 0.912 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.005321502685547
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.920 Vali Acc: 0.783 Test Loss: 0.920 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.040677309036255
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.956 Vali Acc: 0.783 Test Loss: 0.956 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.033362865447998
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.979 Vali Acc: 0.783 Test Loss: 0.979 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6548035144805908
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.005 Vali Acc: 0.783 Test Loss: 1.005 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6660890579223633
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.996 Vali Acc: 0.783 Test Loss: 0.996 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8674333095550537
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.017 Vali Acc: 0.783 Test Loss: 1.017 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7956695556640625
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.038 Vali Acc: 0.783 Test Loss: 1.038 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 2358020
model size : 18.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3680286407470703
Epoch: 1, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.423 Vali Acc: 0.237 Test Loss: 1.423 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 2.1621627807617188
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.347 Vali Acc: 0.303 Test Loss: 1.347 Test Acc: 0.303
Validation loss decreased (-0.236828 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 2.153561592102051
Epoch: 3, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.302618 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 2.0148000717163086
Epoch: 4, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.050 Vali Acc: 0.599 Test Loss: 1.050 Test Acc: 0.599
Validation loss decreased (-0.499988 --> -0.598674).  Saving model ...
Epoch: 5 cost time: 2.140108346939087
Epoch: 5, Steps: 10 | Train Loss: 0.734 Vali Loss: 0.884 Vali Acc: 0.645 Test Loss: 0.884 Test Acc: 0.645
Validation loss decreased (-0.598674 --> -0.644728).  Saving model ...
Epoch: 6 cost time: 1.8581385612487793
Epoch: 6, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.757 Vali Acc: 0.717 Test Loss: 0.757 Test Acc: 0.717
Validation loss decreased (-0.644728 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 1.9180564880371094
Epoch: 7, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.705 Vali Acc: 0.730 Test Loss: 0.705 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.8687753677368164
Epoch: 8, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.690 Vali Acc: 0.743 Test Loss: 0.690 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 1.951026201248169
Epoch: 9, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.703 Vali Acc: 0.763 Test Loss: 0.703 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763151).  Saving model ...
Epoch: 10 cost time: 2.008573055267334
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.701 Vali Acc: 0.770 Test Loss: 0.701 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 11 cost time: 1.7779383659362793
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.746 Vali Acc: 0.783 Test Loss: 0.746 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782887).  Saving model ...
Epoch: 12 cost time: 2.107930898666382
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.794 Vali Acc: 0.783 Test Loss: 0.794 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.028965711593628
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.841 Vali Acc: 0.776 Test Loss: 0.841 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9635615348815918
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.864 Vali Acc: 0.789 Test Loss: 0.864 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789465).  Saving model ...
Epoch: 15 cost time: 2.0236897468566895
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.888 Vali Acc: 0.783 Test Loss: 0.888 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.035756826400757
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.894 Vali Acc: 0.789 Test Loss: 0.894 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9806451797485352
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.925 Vali Acc: 0.783 Test Loss: 0.925 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8358194828033447
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.952 Vali Acc: 0.783 Test Loss: 0.952 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9485976696014404
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.981 Vali Acc: 0.776 Test Loss: 0.981 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7962589263916016
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.966 Vali Acc: 0.783 Test Loss: 0.966 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.869598627090454
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.975 Vali Acc: 0.789 Test Loss: 0.975 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.791358470916748
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.992 Vali Acc: 0.783 Test Loss: 0.992 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.060358762741089
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.015 Vali Acc: 0.783 Test Loss: 1.015 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8667378425598145
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.036 Vali Acc: 0.783 Test Loss: 1.036 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 2358020
model size : 18.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.693108558654785
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 2.045745849609375
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 1.9801342487335205
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 4 cost time: 1.9926457405090332
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 5 cost time: 1.8368093967437744
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 6 cost time: 2.0542783737182617
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.230249 --> -0.282881).  Saving model ...
Epoch: 7 cost time: 1.8406336307525635
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 8 cost time: 1.9807491302490234
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 9 cost time: 2.1476669311523438
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 10 cost time: 2.027036666870117
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 11 cost time: 2.199265718460083
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 12 cost time: 2.2499358654022217
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 13 cost time: 2.203397035598755
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 1.997375726699829
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 2.07615327835083
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 1.866666555404663
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 2.0706918239593506
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 1.9921531677246094
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 1.9275453090667725
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 2.118434429168701
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 2.016831636428833
Epoch: 21, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.1593141555786133
Epoch: 22, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 2.093118906021118
Epoch: 23, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 1.9685304164886475
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 2.332397937774658
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 2.0509791374206543
Epoch: 26, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.0403013229370117
Epoch: 27, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 1.9491462707519531
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 1.994471788406372
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.1325104236602783
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.0406618118286133
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 2.0689146518707275
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.350349187850952
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.069554567337036
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.2331762313842773
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 2.0905375480651855
Epoch: 36, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.105530023574829
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.14554500579834
Epoch: 38, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.1027753353118896
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.0097293853759766
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 2.1604597568511963
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.9915697574615479
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.8650007247924805
Epoch: 43, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 1.8318324089050293
Epoch: 44, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 45 cost time: 1.91524338722229
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 1.9755525588989258
Epoch: 46, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.9172117710113525
Epoch: 47, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.8256592750549316
Epoch: 48, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 1.9507477283477783
Epoch: 49, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.021946668624878
Epoch: 50, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.246723175048828
Epoch: 51, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.4243698120117188
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.169551372528076
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.253976821899414
Epoch: 54, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 55 cost time: 2.2627291679382324
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.3638837337493896
Epoch: 56, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 57 cost time: 2.07399845123291
Epoch: 57, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 58 cost time: 1.942094087600708
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.1321048736572266
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.1137542724609375
Epoch: 60, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.162670850753784
Epoch: 61, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 2.1069412231445312
Epoch: 62, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 2.131495475769043
Epoch: 63, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 2.187100887298584
Epoch: 64, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 2.1139113903045654
Epoch: 65, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.9923467636108398
Epoch: 66, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.959937334060669
Epoch: 67, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 2358020
model size : 18.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2885239124298096
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.426 Vali Acc: 0.263 Test Loss: 1.426 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.0386016368865967
Epoch: 2, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.196 Vali Acc: 0.539 Test Loss: 1.196 Test Acc: 0.539
Validation loss decreased (-0.263144 --> -0.539462).  Saving model ...
Epoch: 3 cost time: 1.9745631217956543
Epoch: 3, Steps: 10 | Train Loss: 0.948 Vali Loss: 0.995 Vali Acc: 0.612 Test Loss: 0.995 Test Acc: 0.612
Validation loss decreased (-0.539462 --> -0.611832).  Saving model ...
Epoch: 4 cost time: 2.084362030029297
Epoch: 4, Steps: 10 | Train Loss: 0.651 Vali Loss: 0.869 Vali Acc: 0.664 Test Loss: 0.869 Test Acc: 0.664
Validation loss decreased (-0.611832 --> -0.664465).  Saving model ...
Epoch: 5 cost time: 1.9919610023498535
Epoch: 5, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.786 Vali Acc: 0.684 Test Loss: 0.786 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684203).  Saving model ...
Epoch: 6 cost time: 1.7699434757232666
Epoch: 6, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
Validation loss decreased (-0.684203 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 1.9306895732879639
Epoch: 7, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.672 Vali Acc: 0.743 Test Loss: 0.672 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9669945240020752
Epoch: 8, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.637 Vali Acc: 0.770 Test Loss: 0.637 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 9 cost time: 1.948021411895752
Epoch: 9, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.634 Vali Acc: 0.796 Test Loss: 0.634 Test Acc: 0.796
Validation loss decreased (-0.769730 --> -0.796046).  Saving model ...
Epoch: 10 cost time: 1.8399040699005127
Epoch: 10, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.645 Vali Acc: 0.796 Test Loss: 0.645 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9398577213287354
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.651 Vali Acc: 0.809 Test Loss: 0.651 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809204).  Saving model ...
Epoch: 12 cost time: 2.2006280422210693
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.066418170928955
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.707 Vali Acc: 0.809 Test Loss: 0.707 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1446852684020996
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.733 Vali Acc: 0.816 Test Loss: 0.733 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815782).  Saving model ...
Epoch: 15 cost time: 2.0737569332122803
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.772 Vali Acc: 0.789 Test Loss: 0.772 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.794935941696167
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.774 Vali Acc: 0.816 Test Loss: 0.774 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9077112674713135
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.792 Vali Acc: 0.816 Test Loss: 0.792 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2194623947143555
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.811 Vali Acc: 0.803 Test Loss: 0.811 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.977792501449585
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.833 Vali Acc: 0.816 Test Loss: 0.833 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0608530044555664
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.856 Vali Acc: 0.809 Test Loss: 0.856 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0631508827209473
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.869 Vali Acc: 0.803 Test Loss: 0.869 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.192685842514038
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.880 Vali Acc: 0.809 Test Loss: 0.880 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1495161056518555
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.894 Vali Acc: 0.809 Test Loss: 0.894 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.054365396499634
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.909 Vali Acc: 0.809 Test Loss: 0.909 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1964804
model size : 17.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3282511234283447
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.428 Vali Acc: 0.276 Test Loss: 1.428 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.7893736362457275
Epoch: 2, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.222 Vali Acc: 0.520 Test Loss: 1.222 Test Acc: 0.520
Validation loss decreased (-0.276302 --> -0.519725).  Saving model ...
Epoch: 3 cost time: 1.9121990203857422
Epoch: 3, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.032 Vali Acc: 0.632 Test Loss: 1.032 Test Acc: 0.632
Validation loss decreased (-0.519725 --> -0.631569).  Saving model ...
Epoch: 4 cost time: 1.8058524131774902
Epoch: 4, Steps: 10 | Train Loss: 0.715 Vali Loss: 0.895 Vali Acc: 0.658 Test Loss: 0.895 Test Acc: 0.658
Validation loss decreased (-0.631569 --> -0.657886).  Saving model ...
Epoch: 5 cost time: 1.943408489227295
Epoch: 5, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.794 Vali Acc: 0.717 Test Loss: 0.794 Test Acc: 0.717
Validation loss decreased (-0.657886 --> -0.717097).  Saving model ...
Epoch: 6 cost time: 1.914376974105835
Epoch: 6, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.713 Vali Acc: 0.737 Test Loss: 0.713 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736835).  Saving model ...
Epoch: 7 cost time: 2.0083675384521484
Epoch: 7, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.664 Vali Acc: 0.757 Test Loss: 0.664 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 8 cost time: 2.1312003135681152
Epoch: 8, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.641 Vali Acc: 0.770 Test Loss: 0.641 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 9 cost time: 1.9821631908416748
Epoch: 9, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.631 Vali Acc: 0.770 Test Loss: 0.631 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.835761308670044
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.640 Vali Acc: 0.770 Test Loss: 0.640 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.78670072555542
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 1.7468852996826172
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.685 Vali Acc: 0.783 Test Loss: 0.685 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8658528327941895
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.700 Vali Acc: 0.796 Test Loss: 0.700 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 14 cost time: 1.8188109397888184
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.727 Vali Acc: 0.796 Test Loss: 0.727 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9617633819580078
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.761 Vali Acc: 0.789 Test Loss: 0.761 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.998230218887329
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.765 Vali Acc: 0.796 Test Loss: 0.765 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0085291862487793
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.781 Vali Acc: 0.796 Test Loss: 0.781 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0243730545043945
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.797 Vali Acc: 0.803 Test Loss: 0.797 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 19 cost time: 2.1116690635681152
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.819 Vali Acc: 0.796 Test Loss: 0.819 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.810377836227417
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.843 Vali Acc: 0.796 Test Loss: 0.843 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.972303867340088
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.856 Vali Acc: 0.796 Test Loss: 0.856 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8334908485412598
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.864 Vali Acc: 0.796 Test Loss: 0.864 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.775604009628296
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.796 Test Loss: 0.878 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9716825485229492
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.895 Vali Acc: 0.796 Test Loss: 0.895 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8947086334228516
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.901 Vali Acc: 0.803 Test Loss: 0.901 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9851491451263428
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.904 Vali Acc: 0.803 Test Loss: 0.904 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9974353313446045
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.918 Vali Acc: 0.803 Test Loss: 0.918 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.0143699645996094
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.932 Vali Acc: 0.803 Test Loss: 0.932 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1964804
model size : 17.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.105531692504883
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.429 Vali Acc: 0.230 Test Loss: 1.429 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.7342548370361328
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.284 Vali Acc: 0.395 Test Loss: 1.284 Test Acc: 0.395
Validation loss decreased (-0.230249 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 1.7585046291351318
Epoch: 3, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.123 Vali Acc: 0.599 Test Loss: 1.123 Test Acc: 0.599
Validation loss decreased (-0.394724 --> -0.598673).  Saving model ...
Epoch: 4 cost time: 1.9579787254333496
Epoch: 4, Steps: 10 | Train Loss: 0.852 Vali Loss: 0.981 Vali Acc: 0.632 Test Loss: 0.981 Test Acc: 0.632
Validation loss decreased (-0.598673 --> -0.631569).  Saving model ...
Epoch: 5 cost time: 1.9012022018432617
Epoch: 5, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.845 Vali Acc: 0.678 Test Loss: 0.845 Test Acc: 0.678
Validation loss decreased (-0.631569 --> -0.677623).  Saving model ...
Epoch: 6 cost time: 2.0941083431243896
Epoch: 6, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.725 Vali Acc: 0.711 Test Loss: 0.725 Test Acc: 0.711
Validation loss decreased (-0.677623 --> -0.710519).  Saving model ...
Epoch: 7 cost time: 2.0653622150421143
Epoch: 7, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.641 Vali Acc: 0.730 Test Loss: 0.641 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730257).  Saving model ...
Epoch: 8 cost time: 2.0901830196380615
Epoch: 8, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.614 Vali Acc: 0.724 Test Loss: 0.614 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0276503562927246
Epoch: 9, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
Validation loss decreased (-0.730257 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.9337527751922607
Epoch: 10, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.627 Vali Acc: 0.776 Test Loss: 0.627 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8852856159210205
Epoch: 11, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0411131381988525
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.683 Vali Acc: 0.789 Test Loss: 0.683 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.092292308807373
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.679 Vali Acc: 0.796 Test Loss: 0.679 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 14 cost time: 2.0077078342437744
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.703 Vali Acc: 0.796 Test Loss: 0.703 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0524327754974365
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.737 Vali Acc: 0.789 Test Loss: 0.737 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.338808059692383
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.756 Vali Acc: 0.789 Test Loss: 0.756 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1373138427734375
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.772 Vali Acc: 0.796 Test Loss: 0.772 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2168033123016357
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.788 Vali Acc: 0.796 Test Loss: 0.788 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.129953145980835
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.806 Vali Acc: 0.796 Test Loss: 0.806 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8761937618255615
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.824 Vali Acc: 0.796 Test Loss: 0.824 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0566964149475098
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.831 Vali Acc: 0.796 Test Loss: 0.831 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.1834774017333984
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.842 Vali Acc: 0.796 Test Loss: 0.842 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0071611404418945
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.858 Vali Acc: 0.796 Test Loss: 0.858 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 1964804
model size : 17.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.62258243560791
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.378 Vali Acc: 0.316 Test Loss: 1.378 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 2.013322353363037
Epoch: 2, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.288 Vali Acc: 0.428 Test Loss: 1.288 Test Acc: 0.428
Validation loss decreased (-0.315776 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 2.0717577934265137
Epoch: 3, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.165 Vali Acc: 0.546 Test Loss: 1.165 Test Acc: 0.546
Validation loss decreased (-0.427619 --> -0.546041).  Saving model ...
Epoch: 4 cost time: 1.7741892337799072
Epoch: 4, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.039 Vali Acc: 0.592 Test Loss: 1.039 Test Acc: 0.592
Validation loss decreased (-0.546041 --> -0.592095).  Saving model ...
Epoch: 5 cost time: 2.0249643325805664
Epoch: 5, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.904 Vali Acc: 0.618 Test Loss: 0.904 Test Acc: 0.618
Validation loss decreased (-0.592095 --> -0.618412).  Saving model ...
Epoch: 6 cost time: 1.836489200592041
Epoch: 6, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.778 Vali Acc: 0.678 Test Loss: 0.778 Test Acc: 0.678
Validation loss decreased (-0.618412 --> -0.677624).  Saving model ...
Epoch: 7 cost time: 1.857759714126587
Epoch: 7, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.675 Vali Acc: 0.737 Test Loss: 0.675 Test Acc: 0.737
Validation loss decreased (-0.677624 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 1.9241559505462646
Epoch: 8, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.950643539428711
Epoch: 9, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.636 Vali Acc: 0.770 Test Loss: 0.636 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769730).  Saving model ...
Epoch: 10 cost time: 2.1281003952026367
Epoch: 10, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.657 Vali Acc: 0.776 Test Loss: 0.657 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 11 cost time: 2.140260696411133
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.664 Vali Acc: 0.796 Test Loss: 0.664 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796046).  Saving model ...
Epoch: 12 cost time: 1.9839568138122559
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9006752967834473
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 14 cost time: 1.9277522563934326
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.716 Vali Acc: 0.809 Test Loss: 0.716 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809203).  Saving model ...
Epoch: 15 cost time: 1.9099211692810059
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.741 Vali Acc: 0.803 Test Loss: 0.741 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.002131223678589
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.754 Vali Acc: 0.803 Test Loss: 0.754 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8536376953125
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.767 Vali Acc: 0.796 Test Loss: 0.767 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.195399284362793
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.784 Vali Acc: 0.809 Test Loss: 0.784 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1400723457336426
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.804 Vali Acc: 0.809 Test Loss: 0.804 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.206563711166382
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.821 Vali Acc: 0.809 Test Loss: 0.821 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0869150161743164
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.831 Vali Acc: 0.809 Test Loss: 0.831 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.3038365840911865
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.846 Vali Acc: 0.809 Test Loss: 0.846 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9830677509307861
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.859 Vali Acc: 0.809 Test Loss: 0.859 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8891949653625488
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.873 Vali Acc: 0.809 Test Loss: 0.873 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1964804
model size : 17.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0365612506866455
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.387 Vali Acc: 0.322 Test Loss: 1.387 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.8848466873168945
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.310 Vali Acc: 0.362 Test Loss: 1.310 Test Acc: 0.362
Validation loss decreased (-0.322355 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.8852295875549316
Epoch: 3, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.194 Vali Acc: 0.533 Test Loss: 1.194 Test Acc: 0.533
Validation loss decreased (-0.361829 --> -0.532883).  Saving model ...
Epoch: 4 cost time: 1.8045766353607178
Epoch: 4, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.038 Vali Acc: 0.625 Test Loss: 1.038 Test Acc: 0.625
Validation loss decreased (-0.532883 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 1.7411060333251953
Epoch: 5, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.874 Vali Acc: 0.671 Test Loss: 0.874 Test Acc: 0.671
Validation loss decreased (-0.624990 --> -0.671044).  Saving model ...
Epoch: 6 cost time: 1.8462224006652832
Epoch: 6, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.773 Vali Acc: 0.704 Test Loss: 0.773 Test Acc: 0.704
Validation loss decreased (-0.671044 --> -0.703940).  Saving model ...
Epoch: 7 cost time: 2.0157997608184814
Epoch: 7, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.726 Vali Acc: 0.717 Test Loss: 0.726 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 2.1556692123413086
Epoch: 8, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.693 Vali Acc: 0.737 Test Loss: 0.693 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 1.9877431392669678
Epoch: 9, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.712 Vali Acc: 0.750 Test Loss: 0.712 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 2.004788875579834
Epoch: 10, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.750 Vali Acc: 0.757 Test Loss: 0.750 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756571).  Saving model ...
Epoch: 11 cost time: 2.046863555908203
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.764 Vali Acc: 0.776 Test Loss: 0.764 Test Acc: 0.776
Validation loss decreased (-0.756571 --> -0.776308).  Saving model ...
Epoch: 12 cost time: 1.7906110286712646
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.832 Vali Acc: 0.763 Test Loss: 0.832 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7088069915771484
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.848 Vali Acc: 0.770 Test Loss: 0.848 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.869715929031372
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.883 Vali Acc: 0.770 Test Loss: 0.883 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8704936504364014
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.937 Vali Acc: 0.757 Test Loss: 0.937 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2171170711517334
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.937 Vali Acc: 0.763 Test Loss: 0.937 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.056934356689453
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.948 Vali Acc: 0.770 Test Loss: 0.948 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8961303234100342
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.970 Vali Acc: 0.770 Test Loss: 0.970 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.092400074005127
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.992 Vali Acc: 0.776 Test Loss: 0.992 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.986358880996704
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.014 Vali Acc: 0.770 Test Loss: 1.014 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.829411506652832
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.024 Vali Acc: 0.770 Test Loss: 1.024 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 1964804
model size : 17.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7826435565948486
Epoch: 1, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.403 Vali Acc: 0.289 Test Loss: 1.403 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.057011842727661
Epoch: 2, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.324 Vali Acc: 0.368 Test Loss: 1.324 Test Acc: 0.368
Validation loss decreased (-0.289460 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.8732433319091797
Epoch: 3, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.207 Vali Acc: 0.507 Test Loss: 1.207 Test Acc: 0.507
Validation loss decreased (-0.368408 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 2.0546817779541016
Epoch: 4, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.052 Vali Acc: 0.632 Test Loss: 1.052 Test Acc: 0.632
Validation loss decreased (-0.506567 --> -0.631568).  Saving model ...
Epoch: 5 cost time: 1.9619176387786865
Epoch: 5, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.887 Vali Acc: 0.684 Test Loss: 0.887 Test Acc: 0.684
Validation loss decreased (-0.631568 --> -0.684202).  Saving model ...
Epoch: 6 cost time: 1.7087647914886475
Epoch: 6, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.776 Vali Acc: 0.724 Test Loss: 0.776 Test Acc: 0.724
Validation loss decreased (-0.684202 --> -0.723676).  Saving model ...
Epoch: 7 cost time: 1.7013659477233887
Epoch: 7, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.721 Vali Acc: 0.717 Test Loss: 0.721 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.733790397644043
Epoch: 8, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.686 Vali Acc: 0.724 Test Loss: 0.686 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723677).  Saving model ...
Epoch: 9 cost time: 1.699295997619629
Epoch: 9, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.687 Vali Acc: 0.737 Test Loss: 0.687 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 10 cost time: 1.992509365081787
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.722 Vali Acc: 0.757 Test Loss: 0.722 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 11 cost time: 1.9410245418548584
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.725 Vali Acc: 0.783 Test Loss: 0.725 Test Acc: 0.783
Validation loss decreased (-0.756572 --> -0.782887).  Saving model ...
Epoch: 12 cost time: 2.0387156009674072
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.772 Vali Acc: 0.776 Test Loss: 0.772 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0817506313323975
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.790 Vali Acc: 0.789 Test Loss: 0.790 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789466).  Saving model ...
Epoch: 14 cost time: 2.033691644668579
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.821 Vali Acc: 0.776 Test Loss: 0.821 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8542706966400146
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.856 Vali Acc: 0.770 Test Loss: 0.856 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7896997928619385
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.859 Vali Acc: 0.776 Test Loss: 0.859 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9123952388763428
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.880 Vali Acc: 0.776 Test Loss: 0.880 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.771500825881958
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.900 Vali Acc: 0.770 Test Loss: 0.900 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.1283071041107178
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.919 Vali Acc: 0.776 Test Loss: 0.919 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1283469200134277
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.943 Vali Acc: 0.776 Test Loss: 0.943 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0499582290649414
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.952 Vali Acc: 0.776 Test Loss: 0.952 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.1515629291534424
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.962 Vali Acc: 0.776 Test Loss: 0.962 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.161285877227783
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.973 Vali Acc: 0.776 Test Loss: 0.973 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1964804
model size : 17.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.077759265899658
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 2.057028293609619
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 2.086374521255493
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 4 cost time: 1.9428212642669678
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 5 cost time: 1.9391109943389893
Epoch: 5, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 6 cost time: 1.9183812141418457
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 7 cost time: 1.8730533123016357
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 8 cost time: 1.8337452411651611
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 9 cost time: 1.708367109298706
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 10 cost time: 1.8381221294403076
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 11 cost time: 2.170494318008423
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.223670 --> -0.282881).  Saving model ...
Epoch: 12 cost time: 2.084451675415039
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 13 cost time: 1.8986477851867676
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 1.983304738998413
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 1.7354419231414795
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 2.009389638900757
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 1.788344383239746
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8168432712554932
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 1.8357429504394531
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.132930278778076
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 2.0001845359802246
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.1458346843719482
Epoch: 22, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.03762149810791
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9426109790802002
Epoch: 24, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.977240800857544
Epoch: 25, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 1.9474492073059082
Epoch: 26, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 1.8770673274993896
Epoch: 27, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.154049873352051
Epoch: 28, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.0609426498413086
Epoch: 29, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.0318098068237305
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.0445315837860107
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 2.1032333374023438
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 1.9291415214538574
Epoch: 33, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 1.9085335731506348
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 1.8982353210449219
Epoch: 35, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 1.980393648147583
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.027308225631714
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.1648471355438232
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 1.981557846069336
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 1.939305067062378
Epoch: 40, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 1.823545217514038
Epoch: 41, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 1.944908857345581
Epoch: 42, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 1.8295488357543945
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 1.8956093788146973
Epoch: 44, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 45 cost time: 1.9875917434692383
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.0232183933258057
Epoch: 46, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 2.3064286708831787
Epoch: 47, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.2736096382141113
Epoch: 48, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.9551243782043457
Epoch: 49, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.8979194164276123
Epoch: 50, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.1101858615875244
Epoch: 51, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.1672403812408447
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.2526776790618896
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.178464889526367
Epoch: 54, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.2007040977478027
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.0158324241638184
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.8502552509307861
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.8260724544525146
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.872326374053955
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.8616411685943604
Epoch: 60, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 1964804
model size : 17.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.687643051147461
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.377 Vali Acc: 0.368 Test Loss: 1.377 Test Acc: 0.368
Validation loss decreased (inf --> -0.368407).  Saving model ...
Epoch: 2 cost time: 2.171477794647217
Epoch: 2, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.158 Vali Acc: 0.539 Test Loss: 1.158 Test Acc: 0.539
Validation loss decreased (-0.368407 --> -0.539462).  Saving model ...
Epoch: 3 cost time: 2.2436506748199463
Epoch: 3, Steps: 10 | Train Loss: 0.911 Vali Loss: 0.982 Vali Acc: 0.658 Test Loss: 0.982 Test Acc: 0.658
Validation loss decreased (-0.539462 --> -0.657885).  Saving model ...
Epoch: 4 cost time: 1.7480061054229736
Epoch: 4, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.861 Vali Acc: 0.697 Test Loss: 0.861 Test Acc: 0.697
Validation loss decreased (-0.657885 --> -0.697360).  Saving model ...
Epoch: 5 cost time: 2.015697956085205
Epoch: 5, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.784 Vali Acc: 0.691 Test Loss: 0.784 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.766514778137207
Epoch: 6, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 2.157470941543579
Epoch: 7, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.661 Vali Acc: 0.737 Test Loss: 0.661 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 2.164501667022705
Epoch: 8, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.617 Vali Acc: 0.776 Test Loss: 0.617 Test Acc: 0.776
Validation loss decreased (-0.736835 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.9240121841430664
Epoch: 9, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 2.0437090396881104
Epoch: 10, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815783).  Saving model ...
Epoch: 11 cost time: 2.254538059234619
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.618 Vali Acc: 0.803 Test Loss: 0.618 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.079272985458374
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.654 Vali Acc: 0.816 Test Loss: 0.654 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1188628673553467
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.682 Vali Acc: 0.809 Test Loss: 0.682 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1846163272857666
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.708 Vali Acc: 0.803 Test Loss: 0.708 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8273811340332031
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.726 Vali Acc: 0.796 Test Loss: 0.726 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1353919506073
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.744 Vali Acc: 0.796 Test Loss: 0.744 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9561734199523926
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.159560203552246
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.772 Vali Acc: 0.803 Test Loss: 0.772 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3152689933776855
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.793 Vali Acc: 0.803 Test Loss: 0.793 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1583354473114014
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.822 Vali Acc: 0.809 Test Loss: 0.822 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1768196
model size : 16.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.391030788421631
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.402 Vali Acc: 0.303 Test Loss: 1.402 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.989006519317627
Epoch: 2, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.199 Vali Acc: 0.553 Test Loss: 1.199 Test Acc: 0.553
Validation loss decreased (-0.302618 --> -0.552620).  Saving model ...
Epoch: 3 cost time: 2.2406699657440186
Epoch: 3, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.034 Vali Acc: 0.664 Test Loss: 1.034 Test Acc: 0.664
Validation loss decreased (-0.552620 --> -0.664463).  Saving model ...
Epoch: 4 cost time: 2.0724072456359863
Epoch: 4, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.912 Vali Acc: 0.678 Test Loss: 0.912 Test Acc: 0.678
Validation loss decreased (-0.664463 --> -0.677622).  Saving model ...
Epoch: 5 cost time: 2.3151299953460693
Epoch: 5, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.824 Vali Acc: 0.704 Test Loss: 0.824 Test Acc: 0.704
Validation loss decreased (-0.677622 --> -0.703939).  Saving model ...
Epoch: 6 cost time: 2.3118910789489746
Epoch: 6, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.743 Vali Acc: 0.697 Test Loss: 0.743 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.827331304550171
Epoch: 7, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.670 Vali Acc: 0.757 Test Loss: 0.670 Test Acc: 0.757
Validation loss decreased (-0.703939 --> -0.756572).  Saving model ...
Epoch: 8 cost time: 1.9108185768127441
Epoch: 8, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.621 Vali Acc: 0.757 Test Loss: 0.621 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 1.910214900970459
Epoch: 9, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.603 Vali Acc: 0.776 Test Loss: 0.603 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 2.1143264770507812
Epoch: 10, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.623 Vali Acc: 0.783 Test Loss: 0.623 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 2.1575496196746826
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.628 Vali Acc: 0.796 Test Loss: 0.628 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796046).  Saving model ...
Epoch: 12 cost time: 2.0815329551696777
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.655 Vali Acc: 0.796 Test Loss: 0.655 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.384354829788208
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.684 Vali Acc: 0.796 Test Loss: 0.684 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2975311279296875
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.714 Vali Acc: 0.803 Test Loss: 0.714 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 15 cost time: 1.9281396865844727
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.731 Vali Acc: 0.803 Test Loss: 0.731 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.067225456237793
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.753 Vali Acc: 0.796 Test Loss: 0.753 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7950093746185303
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.773 Vali Acc: 0.803 Test Loss: 0.773 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.229060411453247
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.775 Vali Acc: 0.809 Test Loss: 0.775 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809203).  Saving model ...
Epoch: 19 cost time: 2.2530677318573
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.792 Vali Acc: 0.809 Test Loss: 0.792 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1330952644348145
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.817 Vali Acc: 0.803 Test Loss: 0.817 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2431910037994385
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.834 Vali Acc: 0.803 Test Loss: 0.834 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2346625328063965
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.840 Vali Acc: 0.809 Test Loss: 0.840 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.0365161895751953
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.849 Vali Acc: 0.809 Test Loss: 0.849 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0251517295837402
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.864 Vali Acc: 0.809 Test Loss: 0.864 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.0491490364074707
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.884 Vali Acc: 0.809 Test Loss: 0.884 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9187073707580566
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.898 Vali Acc: 0.809 Test Loss: 0.898 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.1594653129577637
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.907 Vali Acc: 0.809 Test Loss: 0.907 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.294099807739258
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.914 Vali Acc: 0.809 Test Loss: 0.914 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1768196
model size : 16.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.385580539703369
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.404 Vali Acc: 0.250 Test Loss: 1.404 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.844752311706543
Epoch: 2, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.265 Vali Acc: 0.454 Test Loss: 1.265 Test Acc: 0.454
Validation loss decreased (-0.249986 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 2.0645077228546143
Epoch: 3, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.121 Vali Acc: 0.605 Test Loss: 1.121 Test Acc: 0.605
Validation loss decreased (-0.453935 --> -0.605252).  Saving model ...
Epoch: 4 cost time: 1.6789088249206543
Epoch: 4, Steps: 10 | Train Loss: 0.873 Vali Loss: 0.985 Vali Acc: 0.618 Test Loss: 0.985 Test Acc: 0.618
Validation loss decreased (-0.605252 --> -0.618411).  Saving model ...
Epoch: 5 cost time: 2.093097448348999
Epoch: 5, Steps: 10 | Train Loss: 0.656 Vali Loss: 0.852 Vali Acc: 0.691 Test Loss: 0.852 Test Acc: 0.691
Validation loss decreased (-0.618411 --> -0.690781).  Saving model ...
Epoch: 6 cost time: 2.1161861419677734
Epoch: 6, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.728 Vali Acc: 0.730 Test Loss: 0.728 Test Acc: 0.730
Validation loss decreased (-0.690781 --> -0.730256).  Saving model ...
Epoch: 7 cost time: 2.1501927375793457
Epoch: 7, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.638 Vali Acc: 0.743 Test Loss: 0.638 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 1.9996552467346191
Epoch: 8, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.594 Vali Acc: 0.743 Test Loss: 0.594 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 2.0639588832855225
Epoch: 9, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.582 Vali Acc: 0.757 Test Loss: 0.582 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.7170944213867188
Epoch: 10, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.7781867980957031
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.626 Vali Acc: 0.796 Test Loss: 0.626 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796046).  Saving model ...
Epoch: 12 cost time: 1.906648874282837
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.073075532913208
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.684 Vali Acc: 0.796 Test Loss: 0.684 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9968798160552979
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.707 Vali Acc: 0.796 Test Loss: 0.707 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0847291946411133
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.721 Vali Acc: 0.803 Test Loss: 0.721 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 16 cost time: 2.050701856613159
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.750 Vali Acc: 0.796 Test Loss: 0.750 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8467671871185303
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.770 Vali Acc: 0.789 Test Loss: 0.770 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.948059320449829
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.780 Vali Acc: 0.789 Test Loss: 0.780 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.852306842803955
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.799 Vali Acc: 0.796 Test Loss: 0.799 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8801722526550293
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.816 Vali Acc: 0.796 Test Loss: 0.816 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.114640474319458
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.832 Vali Acc: 0.789 Test Loss: 0.832 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.2086379528045654
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.839 Vali Acc: 0.796 Test Loss: 0.839 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2270400524139404
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.851 Vali Acc: 0.796 Test Loss: 0.851 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1529815196990967
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.866 Vali Acc: 0.789 Test Loss: 0.866 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.992804765701294
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.887 Vali Acc: 0.796 Test Loss: 0.887 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1768196
model size : 16.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.41291880607605
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.451 Vali Acc: 0.204 Test Loss: 1.451 Test Acc: 0.204
Validation loss decreased (inf --> -0.203933).  Saving model ...
Epoch: 2 cost time: 2.1418163776397705
Epoch: 2, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.347 Vali Acc: 0.316 Test Loss: 1.347 Test Acc: 0.316
Validation loss decreased (-0.203933 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 2.1051321029663086
Epoch: 3, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.226 Vali Acc: 0.467 Test Loss: 1.226 Test Acc: 0.467
Validation loss decreased (-0.315776 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 2.161848545074463
Epoch: 4, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.084 Vali Acc: 0.579 Test Loss: 1.084 Test Acc: 0.579
Validation loss decreased (-0.467093 --> -0.578937).  Saving model ...
Epoch: 5 cost time: 2.2276298999786377
Epoch: 5, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.928 Vali Acc: 0.612 Test Loss: 0.928 Test Acc: 0.612
Validation loss decreased (-0.578937 --> -0.611833).  Saving model ...
Epoch: 6 cost time: 1.8300366401672363
Epoch: 6, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.782 Vali Acc: 0.678 Test Loss: 0.782 Test Acc: 0.678
Validation loss decreased (-0.611833 --> -0.677624).  Saving model ...
Epoch: 7 cost time: 1.8912768363952637
Epoch: 7, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.662 Vali Acc: 0.743 Test Loss: 0.662 Test Acc: 0.743
Validation loss decreased (-0.677624 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 1.8331201076507568
Epoch: 8, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.603 Vali Acc: 0.770 Test Loss: 0.603 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 2.0132668018341064
Epoch: 9, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.593 Vali Acc: 0.770 Test Loss: 0.593 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 2.1906096935272217
Epoch: 10, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.635 Vali Acc: 0.763 Test Loss: 0.635 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9670703411102295
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.627 Vali Acc: 0.789 Test Loss: 0.627 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 2.19931697845459
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9870574474334717
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.683 Vali Acc: 0.796 Test Loss: 0.683 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 14 cost time: 1.9205408096313477
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.702 Vali Acc: 0.803 Test Loss: 0.702 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 15 cost time: 1.8662569522857666
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9139752388000488
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.747 Vali Acc: 0.803 Test Loss: 0.747 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8769314289093018
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.757 Vali Acc: 0.803 Test Loss: 0.757 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3976967334747314
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.766 Vali Acc: 0.809 Test Loss: 0.766 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809203).  Saving model ...
Epoch: 19 cost time: 2.385039806365967
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.786 Vali Acc: 0.803 Test Loss: 0.786 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.322674036026001
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.809 Vali Acc: 0.816 Test Loss: 0.809 Test Acc: 0.816
Validation loss decreased (-0.809203 --> -0.815781).  Saving model ...
Epoch: 21 cost time: 2.323715925216675
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.823 Vali Acc: 0.809 Test Loss: 0.823 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0418429374694824
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.818 Vali Acc: 0.803 Test Loss: 0.818 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1345860958099365
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.822 Vali Acc: 0.803 Test Loss: 0.822 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9238269329071045
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.837 Vali Acc: 0.803 Test Loss: 0.837 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9491314888000488
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.857 Vali Acc: 0.803 Test Loss: 0.857 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.1984076499938965
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.868 Vali Acc: 0.809 Test Loss: 0.868 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.2081964015960693
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.873 Vali Acc: 0.809 Test Loss: 0.873 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.1798834800720215
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.877 Vali Acc: 0.809 Test Loss: 0.877 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.194161891937256
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.886 Vali Acc: 0.809 Test Loss: 0.886 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.2886416912078857
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.900 Vali Acc: 0.809 Test Loss: 0.900 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1768196
model size : 16.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.152899980545044
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.440 Vali Acc: 0.270 Test Loss: 1.440 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 1.8295745849609375
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.347 Vali Acc: 0.368 Test Loss: 1.347 Test Acc: 0.368
Validation loss decreased (-0.269722 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.8478868007659912
Epoch: 3, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.235 Vali Acc: 0.520 Test Loss: 1.235 Test Acc: 0.520
Validation loss decreased (-0.368408 --> -0.519724).  Saving model ...
Epoch: 4 cost time: 1.9928929805755615
Epoch: 4, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.068 Vali Acc: 0.625 Test Loss: 1.068 Test Acc: 0.625
Validation loss decreased (-0.519724 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 1.8131794929504395
Epoch: 5, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.892 Vali Acc: 0.658 Test Loss: 0.892 Test Acc: 0.658
Validation loss decreased (-0.624989 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.9186677932739258
Epoch: 6, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.746 Vali Acc: 0.704 Test Loss: 0.746 Test Acc: 0.704
Validation loss decreased (-0.657886 --> -0.703940).  Saving model ...
Epoch: 7 cost time: 1.852137565612793
Epoch: 7, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.671 Vali Acc: 0.730 Test Loss: 0.671 Test Acc: 0.730
Validation loss decreased (-0.703940 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.8634343147277832
Epoch: 8, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.653 Vali Acc: 0.743 Test Loss: 0.653 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 1.864264726638794
Epoch: 9, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.666 Vali Acc: 0.770 Test Loss: 0.666 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769730).  Saving model ...
Epoch: 10 cost time: 1.910224437713623
Epoch: 10, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.690 Vali Acc: 0.763 Test Loss: 0.690 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8549551963806152
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.717 Vali Acc: 0.776 Test Loss: 0.717 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 12 cost time: 1.7991535663604736
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.790 Vali Acc: 0.776 Test Loss: 0.790 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7634899616241455
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.856 Vali Acc: 0.770 Test Loss: 0.856 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8269734382629395
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.890 Vali Acc: 0.783 Test Loss: 0.890 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782886).  Saving model ...
Epoch: 15 cost time: 1.9562137126922607
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.884 Vali Acc: 0.783 Test Loss: 0.884 Test Acc: 0.783
Validation loss decreased (-0.782886 --> -0.782886).  Saving model ...
Epoch: 16 cost time: 1.7354271411895752
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.914 Vali Acc: 0.783 Test Loss: 0.914 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8742268085479736
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.941 Vali Acc: 0.783 Test Loss: 0.941 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9498326778411865
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.945 Vali Acc: 0.783 Test Loss: 0.945 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9711081981658936
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.967 Vali Acc: 0.783 Test Loss: 0.967 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0547351837158203
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.992 Vali Acc: 0.789 Test Loss: 0.992 Test Acc: 0.789
Validation loss decreased (-0.782886 --> -0.789464).  Saving model ...
Epoch: 21 cost time: 2.033881664276123
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.010 Vali Acc: 0.783 Test Loss: 1.010 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.002551794052124
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.009 Vali Acc: 0.783 Test Loss: 1.009 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.919677495956421
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.017 Vali Acc: 0.783 Test Loss: 1.017 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0568974018096924
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.035 Vali Acc: 0.783 Test Loss: 1.035 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8835692405700684
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.058 Vali Acc: 0.789 Test Loss: 1.058 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9218497276306152
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.070 Vali Acc: 0.789 Test Loss: 1.070 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.018277883529663
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.079 Vali Acc: 0.783 Test Loss: 1.079 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7794170379638672
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.088 Vali Acc: 0.789 Test Loss: 1.088 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8992199897766113
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.096 Vali Acc: 0.776 Test Loss: 1.096 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6232542991638184
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.108 Vali Acc: 0.776 Test Loss: 1.108 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1768196
model size : 16.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2325100898742676
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.416 Vali Acc: 0.289 Test Loss: 1.416 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.8369348049163818
Epoch: 2, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.321 Vali Acc: 0.395 Test Loss: 1.321 Test Acc: 0.395
Validation loss decreased (-0.289460 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 2.0321226119995117
Epoch: 3, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.206 Vali Acc: 0.493 Test Loss: 1.206 Test Acc: 0.493
Validation loss decreased (-0.394724 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 2.1296236515045166
Epoch: 4, Steps: 10 | Train Loss: 0.970 Vali Loss: 1.037 Vali Acc: 0.625 Test Loss: 1.037 Test Acc: 0.625
Validation loss decreased (-0.493409 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 2.1214890480041504
Epoch: 5, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.866 Vali Acc: 0.691 Test Loss: 0.866 Test Acc: 0.691
Validation loss decreased (-0.624990 --> -0.690781).  Saving model ...
Epoch: 6 cost time: 1.9254710674285889
Epoch: 6, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 1.9408111572265625
Epoch: 7, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.672 Vali Acc: 0.730 Test Loss: 0.672 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 2.283118724822998
Epoch: 8, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.655 Vali Acc: 0.743 Test Loss: 0.655 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 2.0085811614990234
Epoch: 9, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.662 Vali Acc: 0.750 Test Loss: 0.662 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 2.087892532348633
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 11 cost time: 2.2958617210388184
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.700 Vali Acc: 0.770 Test Loss: 0.700 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 2.128403663635254
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.749 Vali Acc: 0.770 Test Loss: 0.749 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0086021423339844
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.802 Vali Acc: 0.776 Test Loss: 0.802 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776308).  Saving model ...
Epoch: 14 cost time: 2.1306653022766113
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.830 Vali Acc: 0.776 Test Loss: 0.830 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1226789951324463
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.837 Vali Acc: 0.776 Test Loss: 0.837 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0612518787384033
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.865 Vali Acc: 0.776 Test Loss: 0.865 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0321662425994873
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.885 Vali Acc: 0.776 Test Loss: 0.885 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9563100337982178
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.899 Vali Acc: 0.776 Test Loss: 0.899 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9153268337249756
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.920 Vali Acc: 0.770 Test Loss: 0.920 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.056222915649414
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.937 Vali Acc: 0.770 Test Loss: 0.937 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.966254711151123
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.949 Vali Acc: 0.770 Test Loss: 0.949 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.919431447982788
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.953 Vali Acc: 0.783 Test Loss: 0.953 Test Acc: 0.783
Validation loss decreased (-0.776308 --> -0.782885).  Saving model ...
Epoch: 23 cost time: 1.860940933227539
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.966 Vali Acc: 0.783 Test Loss: 0.966 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.01436448097229
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.990 Vali Acc: 0.783 Test Loss: 0.990 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9816460609436035
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.013 Vali Acc: 0.770 Test Loss: 1.013 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8582916259765625
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.022 Vali Acc: 0.783 Test Loss: 1.022 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9684422016143799
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.025 Vali Acc: 0.783 Test Loss: 1.025 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9661109447479248
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.030 Vali Acc: 0.789 Test Loss: 1.030 Test Acc: 0.789
Validation loss decreased (-0.782885 --> -0.789463).  Saving model ...
Epoch: 29 cost time: 1.9712941646575928
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.040 Vali Acc: 0.783 Test Loss: 1.040 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9880378246307373
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.051 Vali Acc: 0.783 Test Loss: 1.051 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9462676048278809
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.065 Vali Acc: 0.789 Test Loss: 1.065 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.297668695449829
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.073 Vali Acc: 0.783 Test Loss: 1.073 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.955794334411621
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.088 Vali Acc: 0.783 Test Loss: 1.088 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.0557289123535156
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.101 Vali Acc: 0.789 Test Loss: 1.101 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.1323020458221436
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.109 Vali Acc: 0.789 Test Loss: 1.109 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.0223355293273926
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.114 Vali Acc: 0.789 Test Loss: 1.114 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.1265594959259033
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.121 Vali Acc: 0.789 Test Loss: 1.121 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.117642402648926
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.122 Vali Acc: 0.789 Test Loss: 1.122 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1768196
model size : 16.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3639516830444336
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.224 Test Loss: 1.387 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 2.124818801879883
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.224 Test Loss: 1.387 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 2.0673673152923584
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.224 Test Loss: 1.387 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 4 cost time: 1.9990105628967285
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 5 cost time: 2.086731433868408
Epoch: 5, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 6 cost time: 2.044290542602539
Epoch: 6, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 7 cost time: 2.0990805625915527
Epoch: 7, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 8 cost time: 1.9116129875183105
Epoch: 8, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 9 cost time: 2.1402218341827393
Epoch: 9, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 10 cost time: 2.098890542984009
Epoch: 10, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 11 cost time: 2.0924623012542725
Epoch: 11, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 12 cost time: 1.8434605598449707
Epoch: 12, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 13 cost time: 2.0400078296661377
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 14 cost time: 2.2603580951690674
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 15 cost time: 1.9301085472106934
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 16 cost time: 2.093324661254883
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.223670 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 2.102238893508911
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 2.11444091796875
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 1.8277478218078613
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 1.9564099311828613
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 1.9607737064361572
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 1.9879765510559082
Epoch: 22, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 2.017219305038452
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 1.8786678314208984
Epoch: 24, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.955819845199585
Epoch: 25, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 2.054837703704834
Epoch: 26, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.2074825763702393
Epoch: 27, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.1067161560058594
Epoch: 28, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.109204053878784
Epoch: 29, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.072918653488159
Epoch: 30, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 1.9775593280792236
Epoch: 31, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 2.0758018493652344
Epoch: 32, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9513590335845947
Epoch: 33, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.240236520767212
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.109949827194214
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 2.1607816219329834
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.104602336883545
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.102889060974121
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 1.959712266921997
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.205230712890625
Epoch: 40, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 1.7559731006622314
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 1.9218432903289795
Epoch: 42, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 1.9200081825256348
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 1.9375081062316895
Epoch: 44, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.158766031265259
Epoch: 45, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.049678325653076
Epoch: 46, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.1843631267547607
Epoch: 47, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 48 cost time: 2.1074447631835938
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.155211925506592
Epoch: 49, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.1078972816467285
Epoch: 50, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.098654270172119
Epoch: 51, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 52 cost time: 2.0693817138671875
Epoch: 52, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.0878994464874268
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.151282548904419
Epoch: 54, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.1520891189575195
Epoch: 55, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 2.177154779434204
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.292126417160034
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 58 cost time: 2.39262056350708
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.1619365215301514
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.038130283355713
Epoch: 60, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.096219778060913
Epoch: 61, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 62 cost time: 2.1303272247314453
Epoch: 62, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 63 cost time: 1.989363431930542
Epoch: 63, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 64 cost time: 1.8853445053100586
Epoch: 64, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.9525108337402344
Epoch: 65, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.9797961711883545
Epoch: 66, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.836683988571167
Epoch: 67, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 2.0748748779296875
Epoch: 68, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.9515998363494873
Epoch: 69, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 2.0935568809509277
Epoch: 70, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 2.0098156929016113
Epoch: 71, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 2.151339292526245
Epoch: 72, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 2.1349451541900635
Epoch: 73, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 1768196
model size : 16.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8235702514648438
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.297 Vali Acc: 0.428 Test Loss: 1.297 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 2.2586936950683594
Epoch: 2, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.102 Vali Acc: 0.599 Test Loss: 1.102 Test Acc: 0.599
Validation loss decreased (-0.427619 --> -0.598673).  Saving model ...
Epoch: 3 cost time: 2.0111567974090576
Epoch: 3, Steps: 10 | Train Loss: 0.929 Vali Loss: 0.938 Vali Acc: 0.704 Test Loss: 0.938 Test Acc: 0.704
Validation loss decreased (-0.598673 --> -0.703938).  Saving model ...
Epoch: 4 cost time: 2.1289660930633545
Epoch: 4, Steps: 10 | Train Loss: 0.704 Vali Loss: 0.844 Vali Acc: 0.711 Test Loss: 0.844 Test Acc: 0.711
Validation loss decreased (-0.703938 --> -0.710518).  Saving model ...
Epoch: 5 cost time: 2.1019177436828613
Epoch: 5, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.777 Vali Acc: 0.730 Test Loss: 0.777 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730255).  Saving model ...
Epoch: 6 cost time: 2.183441638946533
Epoch: 6, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.723 Vali Acc: 0.757 Test Loss: 0.723 Test Acc: 0.757
Validation loss decreased (-0.730255 --> -0.756572).  Saving model ...
Epoch: 7 cost time: 2.102771520614624
Epoch: 7, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.702 Vali Acc: 0.743 Test Loss: 0.702 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.048232316970825
Epoch: 8, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.674 Vali Acc: 0.737 Test Loss: 0.674 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9958527088165283
Epoch: 9, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.653 Vali Acc: 0.763 Test Loss: 0.653 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 10 cost time: 2.147963047027588
Epoch: 10, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.628 Vali Acc: 0.770 Test Loss: 0.628 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 2.023007869720459
Epoch: 11, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.629 Vali Acc: 0.783 Test Loss: 0.629 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782888).  Saving model ...
Epoch: 12 cost time: 2.017777442932129
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.639 Vali Acc: 0.789 Test Loss: 0.639 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 13 cost time: 1.9448456764221191
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 14 cost time: 1.853153944015503
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.644 Vali Acc: 0.803 Test Loss: 0.644 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802625).  Saving model ...
Epoch: 15 cost time: 1.8695588111877441
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.643 Vali Acc: 0.796 Test Loss: 0.643 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9524407386779785
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.662 Vali Acc: 0.796 Test Loss: 0.662 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7530670166015625
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 18 cost time: 1.8734591007232666
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7594249248504639
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.695 Vali Acc: 0.809 Test Loss: 0.695 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8968799114227295
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.714 Vali Acc: 0.803 Test Loss: 0.714 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9778423309326172
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.723 Vali Acc: 0.809 Test Loss: 0.723 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.006115198135376
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.740 Vali Acc: 0.796 Test Loss: 0.740 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.957111120223999
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.745 Vali Acc: 0.796 Test Loss: 0.745 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.2541933059692383
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.757 Vali Acc: 0.796 Test Loss: 0.757 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.0089263916015625
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.771 Vali Acc: 0.789 Test Loss: 0.771 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.974454641342163
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.790 Vali Acc: 0.796 Test Loss: 0.790 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.252814769744873
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.788 Vali Acc: 0.803 Test Loss: 0.788 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1977732
model size : 12.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.39859676361084
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.291 Vali Acc: 0.454 Test Loss: 1.291 Test Acc: 0.454
Validation loss decreased (inf --> -0.453934).  Saving model ...
Epoch: 2 cost time: 1.771195888519287
Epoch: 2, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.124 Vali Acc: 0.618 Test Loss: 1.124 Test Acc: 0.618
Validation loss decreased (-0.453934 --> -0.618410).  Saving model ...
Epoch: 3 cost time: 1.6746859550476074
Epoch: 3, Steps: 10 | Train Loss: 0.969 Vali Loss: 0.976 Vali Acc: 0.678 Test Loss: 0.976 Test Acc: 0.678
Validation loss decreased (-0.618410 --> -0.677622).  Saving model ...
Epoch: 4 cost time: 1.9246056079864502
Epoch: 4, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.886 Vali Acc: 0.691 Test Loss: 0.886 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690781).  Saving model ...
Epoch: 5 cost time: 1.8102824687957764
Epoch: 5, Steps: 10 | Train Loss: 0.571 Vali Loss: 0.811 Vali Acc: 0.724 Test Loss: 0.811 Test Acc: 0.724
Validation loss decreased (-0.690781 --> -0.723676).  Saving model ...
Epoch: 6 cost time: 1.7250316143035889
Epoch: 6, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.751 Vali Acc: 0.737 Test Loss: 0.751 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736835).  Saving model ...
Epoch: 7 cost time: 1.8204529285430908
Epoch: 7, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.715 Vali Acc: 0.750 Test Loss: 0.715 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 1.713982343673706
Epoch: 8, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.660 Vali Acc: 0.750 Test Loss: 0.660 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 1.917182207107544
Epoch: 9, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.637 Vali Acc: 0.763 Test Loss: 0.637 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.771193265914917
Epoch: 10, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.613 Vali Acc: 0.763 Test Loss: 0.613 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.5958805084228516
Epoch: 11, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.606 Vali Acc: 0.776 Test Loss: 0.606 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.715651273727417
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.636448621749878
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8988721370697021
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.5954155921936035
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.612 Vali Acc: 0.803 Test Loss: 0.612 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 16 cost time: 1.7541205883026123
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.629 Vali Acc: 0.796 Test Loss: 0.629 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7178878784179688
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8911948204040527
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8753511905670166
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8409996032714844
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7854273319244385
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.686 Vali Acc: 0.789 Test Loss: 0.686 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.025691270828247
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7711899280548096
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.703 Vali Acc: 0.789 Test Loss: 0.703 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8513834476470947
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.713 Vali Acc: 0.789 Test Loss: 0.713 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9977095127105713
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1977732
model size : 12.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6800811290740967
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.345 Vali Acc: 0.349 Test Loss: 1.345 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 2.044981002807617
Epoch: 2, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.218 Vali Acc: 0.526 Test Loss: 1.218 Test Acc: 0.526
Validation loss decreased (-0.348671 --> -0.526304).  Saving model ...
Epoch: 3 cost time: 2.0274581909179688
Epoch: 3, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.088 Vali Acc: 0.605 Test Loss: 1.088 Test Acc: 0.605
Validation loss decreased (-0.526304 --> -0.605252).  Saving model ...
Epoch: 4 cost time: 1.9442965984344482
Epoch: 4, Steps: 10 | Train Loss: 0.890 Vali Loss: 0.982 Vali Acc: 0.632 Test Loss: 0.982 Test Acc: 0.632
Validation loss decreased (-0.605252 --> -0.631569).  Saving model ...
Epoch: 5 cost time: 1.9779210090637207
Epoch: 5, Steps: 10 | Train Loss: 0.728 Vali Loss: 0.889 Vali Acc: 0.697 Test Loss: 0.889 Test Acc: 0.697
Validation loss decreased (-0.631569 --> -0.697360).  Saving model ...
Epoch: 6 cost time: 2.0559511184692383
Epoch: 6, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.810 Vali Acc: 0.684 Test Loss: 0.810 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9181876182556152
Epoch: 7, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.752 Vali Acc: 0.717 Test Loss: 0.752 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.9523775577545166
Epoch: 8, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.684 Vali Acc: 0.757 Test Loss: 0.684 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756572).  Saving model ...
Epoch: 9 cost time: 2.065906286239624
Epoch: 9, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.640 Vali Acc: 0.757 Test Loss: 0.640 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.9464614391326904
Epoch: 10, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.602 Vali Acc: 0.757 Test Loss: 0.602 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.9577603340148926
Epoch: 11, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 2.0804970264434814
Epoch: 12, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 2.1037230491638184
Epoch: 13, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2419440746307373
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.578 Vali Acc: 0.796 Test Loss: 0.578 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 2.2498300075531006
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0273594856262207
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9272675514221191
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.612 Vali Acc: 0.783 Test Loss: 0.612 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0203804969787598
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.623 Vali Acc: 0.789 Test Loss: 0.623 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.073267936706543
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.144829511642456
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.653 Vali Acc: 0.789 Test Loss: 0.653 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1409120559692383
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.103973865509033
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.672 Vali Acc: 0.809 Test Loss: 0.672 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809204).  Saving model ...
Epoch: 23 cost time: 2.017592430114746
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.675 Vali Acc: 0.809 Test Loss: 0.675 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0881471633911133
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.685 Vali Acc: 0.816 Test Loss: 0.685 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 25 cost time: 2.1440179347991943
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.692 Vali Acc: 0.809 Test Loss: 0.692 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.006962299346924
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.705 Vali Acc: 0.809 Test Loss: 0.705 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1004769802093506
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.716 Vali Acc: 0.809 Test Loss: 0.716 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.163384199142456
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.726 Vali Acc: 0.809 Test Loss: 0.726 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9447288513183594
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.736 Vali Acc: 0.809 Test Loss: 0.736 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9538547992706299
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.747 Vali Acc: 0.809 Test Loss: 0.747 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.089437961578369
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.759 Vali Acc: 0.809 Test Loss: 0.759 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.0229477882385254
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.767 Vali Acc: 0.809 Test Loss: 0.767 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.1959712505340576
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.779 Vali Acc: 0.809 Test Loss: 0.779 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.100344657897949
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.786 Vali Acc: 0.816 Test Loss: 0.786 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1977732
model size : 12.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.844292640686035
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.391 Vali Acc: 0.303 Test Loss: 1.391 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.9853620529174805
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.310 Vali Acc: 0.375 Test Loss: 1.310 Test Acc: 0.375
Validation loss decreased (-0.302618 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 2.0693180561065674
Epoch: 3, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.210 Vali Acc: 0.467 Test Loss: 1.210 Test Acc: 0.467
Validation loss decreased (-0.374987 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 1.9212265014648438
Epoch: 4, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.119 Vali Acc: 0.526 Test Loss: 1.119 Test Acc: 0.526
Validation loss decreased (-0.467093 --> -0.526305).  Saving model ...
Epoch: 5 cost time: 1.9120430946350098
Epoch: 5, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.043 Vali Acc: 0.539 Test Loss: 1.043 Test Acc: 0.539
Validation loss decreased (-0.526305 --> -0.539463).  Saving model ...
Epoch: 6 cost time: 2.0271553993225098
Epoch: 6, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.955 Vali Acc: 0.599 Test Loss: 0.955 Test Acc: 0.599
Validation loss decreased (-0.539463 --> -0.598675).  Saving model ...
Epoch: 7 cost time: 1.7815937995910645
Epoch: 7, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.878 Vali Acc: 0.599 Test Loss: 0.878 Test Acc: 0.599
Validation loss decreased (-0.598675 --> -0.598675).  Saving model ...
Epoch: 8 cost time: 2.01054310798645
Epoch: 8, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.780 Vali Acc: 0.678 Test Loss: 0.780 Test Acc: 0.678
Validation loss decreased (-0.598675 --> -0.677624).  Saving model ...
Epoch: 9 cost time: 1.9079139232635498
Epoch: 9, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.705 Vali Acc: 0.711 Test Loss: 0.705 Test Acc: 0.711
Validation loss decreased (-0.677624 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 1.9414894580841064
Epoch: 10, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.652 Vali Acc: 0.757 Test Loss: 0.652 Test Acc: 0.757
Validation loss decreased (-0.710519 --> -0.756572).  Saving model ...
Epoch: 11 cost time: 2.1152024269104004
Epoch: 11, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.609 Vali Acc: 0.776 Test Loss: 0.609 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.911165714263916
Epoch: 12, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.968688726425171
Epoch: 13, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.590 Vali Acc: 0.776 Test Loss: 0.590 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.8875207901000977
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
Validation loss decreased (-0.776310 --> -0.809205).  Saving model ...
Epoch: 15 cost time: 1.9064316749572754
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 16 cost time: 2.014486074447632
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.092428684234619
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0255603790283203
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.606 Vali Acc: 0.816 Test Loss: 0.606 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.060039758682251
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.617 Vali Acc: 0.829 Test Loss: 0.617 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828941).  Saving model ...
Epoch: 20 cost time: 2.0305392742156982
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.627 Vali Acc: 0.829 Test Loss: 0.627 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9573619365692139
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.639 Vali Acc: 0.829 Test Loss: 0.639 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.002964973449707
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.649 Vali Acc: 0.829 Test Loss: 0.649 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9152765274047852
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.653 Vali Acc: 0.829 Test Loss: 0.653 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7213771343231201
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.664 Vali Acc: 0.836 Test Loss: 0.664 Test Acc: 0.836
Validation loss decreased (-0.828941 --> -0.835520).  Saving model ...
Epoch: 25 cost time: 1.8934850692749023
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.675 Vali Acc: 0.836 Test Loss: 0.675 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7690033912658691
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.689 Vali Acc: 0.829 Test Loss: 0.689 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9294028282165527
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.694 Vali Acc: 0.836 Test Loss: 0.694 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.95355224609375
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.698 Vali Acc: 0.829 Test Loss: 0.698 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8673155307769775
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.704 Vali Acc: 0.829 Test Loss: 0.704 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9916541576385498
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.712 Vali Acc: 0.829 Test Loss: 0.712 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.816030502319336
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.721 Vali Acc: 0.829 Test Loss: 0.721 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.964909553527832
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.732 Vali Acc: 0.829 Test Loss: 0.732 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9508945941925049
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.745 Vali Acc: 0.829 Test Loss: 0.745 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9977362155914307
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.752 Vali Acc: 0.829 Test Loss: 0.752 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 1977732
model size : 12.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.809436082839966
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.404 Vali Acc: 0.296 Test Loss: 1.404 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 2.131150722503662
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.357 Vali Acc: 0.316 Test Loss: 1.357 Test Acc: 0.316
Validation loss decreased (-0.296039 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 1.8983116149902344
Epoch: 3, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.300 Vali Acc: 0.336 Test Loss: 1.300 Test Acc: 0.336
Validation loss decreased (-0.315776 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 2.3121895790100098
Epoch: 4, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.238 Vali Acc: 0.434 Test Loss: 1.238 Test Acc: 0.434
Validation loss decreased (-0.335513 --> -0.434198).  Saving model ...
Epoch: 5 cost time: 2.104722499847412
Epoch: 5, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.169 Vali Acc: 0.487 Test Loss: 1.169 Test Acc: 0.487
Validation loss decreased (-0.434198 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 2.121216058731079
Epoch: 6, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.088 Vali Acc: 0.572 Test Loss: 1.088 Test Acc: 0.572
Validation loss decreased (-0.486830 --> -0.572358).  Saving model ...
Epoch: 7 cost time: 2.033600091934204
Epoch: 7, Steps: 10 | Train Loss: 0.747 Vali Loss: 1.005 Vali Acc: 0.579 Test Loss: 1.005 Test Acc: 0.579
Validation loss decreased (-0.572358 --> -0.578937).  Saving model ...
Epoch: 8 cost time: 1.902944803237915
Epoch: 8, Steps: 10 | Train Loss: 0.571 Vali Loss: 0.915 Vali Acc: 0.605 Test Loss: 0.915 Test Acc: 0.605
Validation loss decreased (-0.578937 --> -0.605254).  Saving model ...
Epoch: 9 cost time: 2.110883951187134
Epoch: 9, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.828 Vali Acc: 0.664 Test Loss: 0.828 Test Acc: 0.664
Validation loss decreased (-0.605254 --> -0.664465).  Saving model ...
Epoch: 10 cost time: 1.9219181537628174
Epoch: 10, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.754 Vali Acc: 0.737 Test Loss: 0.754 Test Acc: 0.737
Validation loss decreased (-0.664465 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 2.0215566158294678
Epoch: 11, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.718 Vali Acc: 0.743 Test Loss: 0.718 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 1.9961235523223877
Epoch: 12, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.704 Vali Acc: 0.730 Test Loss: 0.704 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.05132794380188
Epoch: 13, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.697 Vali Acc: 0.757 Test Loss: 0.697 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 14 cost time: 1.9055252075195312
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.691 Vali Acc: 0.763 Test Loss: 0.691 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 15 cost time: 2.019016981124878
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.684 Vali Acc: 0.770 Test Loss: 0.684 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 16 cost time: 2.0060460567474365
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.720 Vali Acc: 0.770 Test Loss: 0.720 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.118133783340454
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.718 Vali Acc: 0.789 Test Loss: 0.718 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789467).  Saving model ...
Epoch: 18 cost time: 2.047360897064209
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.750 Vali Acc: 0.783 Test Loss: 0.750 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8937366008758545
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.795 Vali Acc: 0.783 Test Loss: 0.795 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.007681369781494
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.786 Vali Acc: 0.783 Test Loss: 0.786 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1518747806549072
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.791 Vali Acc: 0.796 Test Loss: 0.791 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 22 cost time: 2.013383150100708
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.813 Vali Acc: 0.770 Test Loss: 0.813 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9882571697235107
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.818 Vali Acc: 0.783 Test Loss: 0.818 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0173816680908203
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.828 Vali Acc: 0.789 Test Loss: 0.828 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9875690937042236
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.850 Vali Acc: 0.789 Test Loss: 0.850 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0587549209594727
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.878 Vali Acc: 0.783 Test Loss: 0.878 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.1646432876586914
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.880 Vali Acc: 0.789 Test Loss: 0.880 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.087829351425171
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.905 Vali Acc: 0.789 Test Loss: 0.905 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9929449558258057
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.929 Vali Acc: 0.783 Test Loss: 0.929 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.021540641784668
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.930 Vali Acc: 0.789 Test Loss: 0.930 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.0397236347198486
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.927 Vali Acc: 0.796 Test Loss: 0.927 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 1977732
model size : 12.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.417010545730591
Epoch: 1, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.395 Vali Acc: 0.270 Test Loss: 1.395 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.9471423625946045
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.341 Vali Acc: 0.382 Test Loss: 1.341 Test Acc: 0.382
Validation loss decreased (-0.269723 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.8923420906066895
Epoch: 3, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.271 Vali Acc: 0.421 Test Loss: 1.271 Test Acc: 0.421
Validation loss decreased (-0.381566 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.8740513324737549
Epoch: 4, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.195 Vali Acc: 0.513 Test Loss: 1.195 Test Acc: 0.513
Validation loss decreased (-0.421040 --> -0.513146).  Saving model ...
Epoch: 5 cost time: 2.010226249694824
Epoch: 5, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.112 Vali Acc: 0.553 Test Loss: 1.112 Test Acc: 0.553
Validation loss decreased (-0.513146 --> -0.552620).  Saving model ...
Epoch: 6 cost time: 1.7743828296661377
Epoch: 6, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.019 Vali Acc: 0.625 Test Loss: 1.019 Test Acc: 0.625
Validation loss decreased (-0.552620 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 1.9724438190460205
Epoch: 7, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.931 Vali Acc: 0.651 Test Loss: 0.931 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651306).  Saving model ...
Epoch: 8 cost time: 1.9225783348083496
Epoch: 8, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.840 Vali Acc: 0.658 Test Loss: 0.840 Test Acc: 0.658
Validation loss decreased (-0.651306 --> -0.657886).  Saving model ...
Epoch: 9 cost time: 1.9620659351348877
Epoch: 9, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
Validation loss decreased (-0.657886 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 2.02400803565979
Epoch: 10, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
Validation loss decreased (-0.717098 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 1.9739270210266113
Epoch: 11, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.682 Vali Acc: 0.770 Test Loss: 0.682 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 2.002347469329834
Epoch: 12, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.669 Vali Acc: 0.770 Test Loss: 0.669 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 13 cost time: 2.105266809463501
Epoch: 13, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 14 cost time: 2.1043410301208496
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.664 Vali Acc: 0.770 Test Loss: 0.664 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0379745960235596
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.664 Vali Acc: 0.776 Test Loss: 0.664 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1081836223602295
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1665077209472656
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.687 Vali Acc: 0.796 Test Loss: 0.687 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796046).  Saving model ...
Epoch: 18 cost time: 2.059682846069336
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.711 Vali Acc: 0.783 Test Loss: 0.711 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.021021842956543
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.738 Vali Acc: 0.770 Test Loss: 0.738 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9617283344268799
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.753 Vali Acc: 0.776 Test Loss: 0.753 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9727122783660889
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.762 Vali Acc: 0.776 Test Loss: 0.762 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8938865661621094
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.765 Vali Acc: 0.783 Test Loss: 0.765 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.077592611312866
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.748 Vali Acc: 0.789 Test Loss: 0.748 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.06350040435791
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.758 Vali Acc: 0.796 Test Loss: 0.758 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.0275213718414307
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.776 Vali Acc: 0.776 Test Loss: 0.776 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.004131317138672
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.802 Vali Acc: 0.776 Test Loss: 0.802 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8075511455535889
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.806 Vali Acc: 0.789 Test Loss: 0.806 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 1977732
model size : 12.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9222159385681152
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 2.1802728176116943
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 2.187727451324463
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 4 cost time: 2.1335978507995605
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 5 cost time: 2.223153829574585
Epoch: 5, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 6 cost time: 2.115710973739624
Epoch: 6, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 7 cost time: 1.9624748229980469
Epoch: 7, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 8 cost time: 2.1323297023773193
Epoch: 8, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 9 cost time: 2.120532274246216
Epoch: 9, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 10 cost time: 1.9443552494049072
Epoch: 10, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 11 cost time: 2.0766637325286865
Epoch: 11, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 12 cost time: 1.951521396636963
Epoch: 12, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 13 cost time: 1.983834981918335
Epoch: 13, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 14 cost time: 2.0011627674102783
Epoch: 14, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 15 cost time: 2.1966521739959717
Epoch: 15, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 16 cost time: 2.1295769214630127
Epoch: 16, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 17 cost time: 1.9585604667663574
Epoch: 17, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 18 cost time: 2.1874916553497314
Epoch: 18, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 19 cost time: 2.239819049835205
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 20 cost time: 2.015486717224121
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 21 cost time: 2.1091928482055664
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 22 cost time: 2.194321393966675
Epoch: 22, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 23 cost time: 2.341026544570923
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.230249 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 2.388453722000122
Epoch: 24, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9806580543518066
Epoch: 25, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 1.9721839427947998
Epoch: 26, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.0618462562561035
Epoch: 27, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.086188316345215
Epoch: 28, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.0006706714630127
Epoch: 29, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.224155902862549
Epoch: 30, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.2673943042755127
Epoch: 31, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 1.829256534576416
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 1.878432273864746
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 1.9304296970367432
Epoch: 34, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.3826117515563965
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 2.1547651290893555
Epoch: 36, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.158832311630249
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.1427292823791504
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.4461748600006104
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.0434117317199707
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 1.9669678211212158
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 1.8982758522033691
Epoch: 42, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 2.0538876056671143
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.0578136444091797
Epoch: 44, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.142603635787964
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.974440097808838
Epoch: 46, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 2.102595329284668
Epoch: 47, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 48 cost time: 2.0736382007598877
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.059413433074951
Epoch: 49, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.0824053287506104
Epoch: 50, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.2729365825653076
Epoch: 51, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 52 cost time: 2.292417287826538
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 53 cost time: 2.378765106201172
Epoch: 53, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 2.1282882690429688
Epoch: 54, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.0909264087677
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.201526403427124
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.2799880504608154
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.1997416019439697
Epoch: 58, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.0721964836120605
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 2.057422637939453
Epoch: 60, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 61 cost time: 1.8701653480529785
Epoch: 61, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 62 cost time: 2.1707887649536133
Epoch: 62, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 63 cost time: 2.0653982162475586
Epoch: 63, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.006923198699951
Epoch: 64, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.1620521545410156
Epoch: 65, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.9834246635437012
Epoch: 66, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.9922056198120117
Epoch: 67, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 2.2781145572662354
Epoch: 68, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 2.2355031967163086
Epoch: 69, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 2.2794408798217773
Epoch: 70, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 2.1547839641571045
Epoch: 71, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 2.2120413780212402
Epoch: 72, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 1977732
model size : 12.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9358274936676025
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.370 Vali Acc: 0.355 Test Loss: 1.370 Test Acc: 0.355
Validation loss decreased (inf --> -0.355249).  Saving model ...
Epoch: 2 cost time: 2.211015462875366
Epoch: 2, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.230 Vali Acc: 0.520 Test Loss: 1.230 Test Acc: 0.520
Validation loss decreased (-0.355249 --> -0.519725).  Saving model ...
Epoch: 3 cost time: 2.1854960918426514
Epoch: 3, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.079 Vali Acc: 0.566 Test Loss: 1.079 Test Acc: 0.566
Validation loss decreased (-0.519725 --> -0.565779).  Saving model ...
Epoch: 4 cost time: 2.2381184101104736
Epoch: 4, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.961 Vali Acc: 0.625 Test Loss: 0.961 Test Acc: 0.625
Validation loss decreased (-0.565779 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 2.3953187465667725
Epoch: 5, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.879 Vali Acc: 0.658 Test Loss: 0.879 Test Acc: 0.658
Validation loss decreased (-0.624990 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 2.0977396965026855
Epoch: 6, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.820 Vali Acc: 0.691 Test Loss: 0.820 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690781).  Saving model ...
Epoch: 7 cost time: 2.421820878982544
Epoch: 7, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.770 Vali Acc: 0.697 Test Loss: 0.770 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 2.1860692501068115
Epoch: 8, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.732 Vali Acc: 0.717 Test Loss: 0.732 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 2.1916069984436035
Epoch: 9, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.686 Vali Acc: 0.737 Test Loss: 0.686 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 10 cost time: 2.331671953201294
Epoch: 10, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.661 Vali Acc: 0.743 Test Loss: 0.661 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 11 cost time: 2.1965980529785156
Epoch: 11, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.642 Vali Acc: 0.757 Test Loss: 0.642 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 12 cost time: 2.025449752807617
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.622 Vali Acc: 0.763 Test Loss: 0.622 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 2.2350621223449707
Epoch: 13, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789467).  Saving model ...
Epoch: 14 cost time: 2.07468843460083
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0921006202697754
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.639 Vali Acc: 0.796 Test Loss: 0.639 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 16 cost time: 2.3419764041900635
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.649 Vali Acc: 0.796 Test Loss: 0.649 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1821393966674805
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1715269088745117
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.658 Vali Acc: 0.803 Test Loss: 0.658 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 19 cost time: 1.965867042541504
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.137747287750244
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.680 Vali Acc: 0.796 Test Loss: 0.680 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0593175888061523
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.705 Vali Acc: 0.796 Test Loss: 0.705 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0044565200805664
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.724 Vali Acc: 0.796 Test Loss: 0.724 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.2310445308685303
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.712 Vali Acc: 0.789 Test Loss: 0.712 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0905303955078125
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.729 Vali Acc: 0.796 Test Loss: 0.729 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.231685161590576
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.746 Vali Acc: 0.789 Test Loss: 0.746 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.093442440032959
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.765 Vali Acc: 0.796 Test Loss: 0.765 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.25508713722229
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.769 Vali Acc: 0.796 Test Loss: 0.769 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.098097562789917
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.778 Vali Acc: 0.803 Test Loss: 0.778 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1191300
model size : 9.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6157991886138916
Epoch: 1, Steps: 10 | Train Loss: 1.525 Vali Loss: 1.396 Vali Acc: 0.276 Test Loss: 1.396 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 2.1241815090179443
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.267 Vali Acc: 0.467 Test Loss: 1.267 Test Acc: 0.467
Validation loss decreased (-0.276302 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 2.0052900314331055
Epoch: 3, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.121 Vali Acc: 0.572 Test Loss: 1.121 Test Acc: 0.572
Validation loss decreased (-0.467093 --> -0.572357).  Saving model ...
Epoch: 4 cost time: 2.0533523559570312
Epoch: 4, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.002 Vali Acc: 0.605 Test Loss: 1.002 Test Acc: 0.605
Validation loss decreased (-0.572357 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 2.0842747688293457
Epoch: 5, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.911 Vali Acc: 0.664 Test Loss: 0.911 Test Acc: 0.664
Validation loss decreased (-0.605253 --> -0.664465).  Saving model ...
Epoch: 6 cost time: 2.042961359024048
Epoch: 6, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.847 Vali Acc: 0.704 Test Loss: 0.847 Test Acc: 0.704
Validation loss decreased (-0.664465 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 1.9860382080078125
Epoch: 7, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.790 Vali Acc: 0.711 Test Loss: 0.790 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710518).  Saving model ...
Epoch: 8 cost time: 2.1461267471313477
Epoch: 8, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.734 Vali Acc: 0.737 Test Loss: 0.734 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 2.0076582431793213
Epoch: 9, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763151).  Saving model ...
Epoch: 10 cost time: 2.0708863735198975
Epoch: 10, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.653 Vali Acc: 0.763 Test Loss: 0.653 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 11 cost time: 1.9127869606018066
Epoch: 11, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782888).  Saving model ...
Epoch: 12 cost time: 2.1611390113830566
Epoch: 12, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.605 Vali Acc: 0.783 Test Loss: 0.605 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 2.192068338394165
Epoch: 13, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.607 Vali Acc: 0.789 Test Loss: 0.607 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.9473903179168701
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.603 Vali Acc: 0.796 Test Loss: 0.603 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 2.036695718765259
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.975311279296875
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.610 Vali Acc: 0.783 Test Loss: 0.610 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9820139408111572
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.618 Vali Acc: 0.789 Test Loss: 0.618 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.930725336074829
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.626 Vali Acc: 0.796 Test Loss: 0.626 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9974215030670166
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.632 Vali Acc: 0.796 Test Loss: 0.632 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9633395671844482
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.643 Vali Acc: 0.796 Test Loss: 0.643 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.015821933746338
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.655 Vali Acc: 0.796 Test Loss: 0.655 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0203137397766113
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.673 Vali Acc: 0.796 Test Loss: 0.673 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9970839023590088
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.670 Vali Acc: 0.796 Test Loss: 0.670 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.1576366424560547
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.685 Vali Acc: 0.796 Test Loss: 0.685 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 1191300
model size : 9.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.887871742248535
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.446 Vali Acc: 0.224 Test Loss: 1.446 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 2.089510679244995
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.348 Vali Acc: 0.296 Test Loss: 1.348 Test Acc: 0.296
Validation loss decreased (-0.223670 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.9848768711090088
Epoch: 3, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.226 Vali Acc: 0.480 Test Loss: 1.226 Test Acc: 0.480
Validation loss decreased (-0.296039 --> -0.480251).  Saving model ...
Epoch: 4 cost time: 2.165592670440674
Epoch: 4, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.104 Vali Acc: 0.579 Test Loss: 1.104 Test Acc: 0.579
Validation loss decreased (-0.480251 --> -0.578936).  Saving model ...
Epoch: 5 cost time: 2.104475259780884
Epoch: 5, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.003 Vali Acc: 0.645 Test Loss: 1.003 Test Acc: 0.645
Validation loss decreased (-0.578936 --> -0.644727).  Saving model ...
Epoch: 6 cost time: 2.032686710357666
Epoch: 6, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.912 Vali Acc: 0.684 Test Loss: 0.912 Test Acc: 0.684
Validation loss decreased (-0.644727 --> -0.684201).  Saving model ...
Epoch: 7 cost time: 2.0097553730010986
Epoch: 7, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.833 Vali Acc: 0.711 Test Loss: 0.833 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710518).  Saving model ...
Epoch: 8 cost time: 1.955549955368042
Epoch: 8, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.751 Vali Acc: 0.724 Test Loss: 0.751 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723677).  Saving model ...
Epoch: 9 cost time: 2.0317935943603516
Epoch: 9, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.689 Vali Acc: 0.737 Test Loss: 0.689 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 10 cost time: 2.004882574081421
Epoch: 10, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.642 Vali Acc: 0.743 Test Loss: 0.642 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 11 cost time: 1.9078648090362549
Epoch: 11, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.615 Vali Acc: 0.743 Test Loss: 0.615 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 2.031036138534546
Epoch: 12, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.586 Vali Acc: 0.757 Test Loss: 0.586 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 2.0237817764282227
Epoch: 13, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.584 Vali Acc: 0.757 Test Loss: 0.584 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 2.0515949726104736
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 2.043531656265259
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0189225673675537
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.608 Vali Acc: 0.783 Test Loss: 0.608 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0960311889648438
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796046).  Saving model ...
Epoch: 18 cost time: 2.0029571056365967
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.628 Vali Acc: 0.789 Test Loss: 0.628 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8493342399597168
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.639 Vali Acc: 0.796 Test Loss: 0.639 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9176270961761475
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.658 Vali Acc: 0.796 Test Loss: 0.658 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9637911319732666
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.672 Vali Acc: 0.803 Test Loss: 0.672 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 22 cost time: 1.954376220703125
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0062100887298584
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.691 Vali Acc: 0.803 Test Loss: 0.691 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9824011325836182
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.703 Vali Acc: 0.803 Test Loss: 0.703 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.255303144454956
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.708 Vali Acc: 0.809 Test Loss: 0.708 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809203).  Saving model ...
Epoch: 26 cost time: 2.065793991088867
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.722 Vali Acc: 0.803 Test Loss: 0.722 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9434125423431396
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.731 Vali Acc: 0.809 Test Loss: 0.731 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0538511276245117
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.736 Vali Acc: 0.803 Test Loss: 0.736 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9637172222137451
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.748 Vali Acc: 0.803 Test Loss: 0.748 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9519305229187012
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.761 Vali Acc: 0.816 Test Loss: 0.761 Test Acc: 0.816
Validation loss decreased (-0.809203 --> -0.815782).  Saving model ...
Epoch: 31 cost time: 1.89174222946167
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.769 Vali Acc: 0.816 Test Loss: 0.769 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.1186516284942627
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.777 Vali Acc: 0.809 Test Loss: 0.777 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.014573097229004
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.787 Vali Acc: 0.816 Test Loss: 0.787 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8891198635101318
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.795 Vali Acc: 0.816 Test Loss: 0.795 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.0455241203308105
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.800 Vali Acc: 0.816 Test Loss: 0.800 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.789116621017456
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.812 Vali Acc: 0.809 Test Loss: 0.812 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.9264845848083496
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.822 Vali Acc: 0.809 Test Loss: 0.822 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.9094903469085693
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.824 Vali Acc: 0.809 Test Loss: 0.824 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.952697515487671
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.836 Vali Acc: 0.809 Test Loss: 0.836 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.9360005855560303
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.847 Vali Acc: 0.809 Test Loss: 0.847 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1191300
model size : 9.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8511860370635986
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.439 Vali Acc: 0.263 Test Loss: 1.439 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.375837802886963
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.381 Vali Acc: 0.316 Test Loss: 1.381 Test Acc: 0.316
Validation loss decreased (-0.263144 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 2.46691632270813
Epoch: 3, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.303 Vali Acc: 0.388 Test Loss: 1.303 Test Acc: 0.388
Validation loss decreased (-0.315776 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 2.2769699096679688
Epoch: 4, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.218 Vali Acc: 0.474 Test Loss: 1.218 Test Acc: 0.474
Validation loss decreased (-0.388145 --> -0.473672).  Saving model ...
Epoch: 5 cost time: 2.172311782836914
Epoch: 5, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.122 Vali Acc: 0.526 Test Loss: 1.122 Test Acc: 0.526
Validation loss decreased (-0.473672 --> -0.526305).  Saving model ...
Epoch: 6 cost time: 2.107712507247925
Epoch: 6, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.028 Vali Acc: 0.579 Test Loss: 1.028 Test Acc: 0.579
Validation loss decreased (-0.526305 --> -0.578937).  Saving model ...
Epoch: 7 cost time: 2.011629104614258
Epoch: 7, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.943 Vali Acc: 0.599 Test Loss: 0.943 Test Acc: 0.599
Validation loss decreased (-0.578937 --> -0.598675).  Saving model ...
Epoch: 8 cost time: 2.095517873764038
Epoch: 8, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.842 Vali Acc: 0.618 Test Loss: 0.842 Test Acc: 0.618
Validation loss decreased (-0.598675 --> -0.618413).  Saving model ...
Epoch: 9 cost time: 2.167161226272583
Epoch: 9, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.757 Vali Acc: 0.691 Test Loss: 0.757 Test Acc: 0.691
Validation loss decreased (-0.618413 --> -0.690782).  Saving model ...
Epoch: 10 cost time: 2.0366709232330322
Epoch: 10, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.696 Vali Acc: 0.724 Test Loss: 0.696 Test Acc: 0.724
Validation loss decreased (-0.690782 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 2.052086353302002
Epoch: 11, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.662 Vali Acc: 0.737 Test Loss: 0.662 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 2.173997640609741
Epoch: 12, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.605 Vali Acc: 0.783 Test Loss: 0.605 Test Acc: 0.783
Validation loss decreased (-0.736835 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.8523750305175781
Epoch: 13, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.9288971424102783
Epoch: 14, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.587 Vali Acc: 0.783 Test Loss: 0.587 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.049299955368042
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.112112283706665
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8759913444519043
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.600 Vali Acc: 0.770 Test Loss: 0.600 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.15048885345459
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.620 Vali Acc: 0.770 Test Loss: 0.620 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.145507574081421
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.624 Vali Acc: 0.783 Test Loss: 0.624 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1599676609039307
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.637 Vali Acc: 0.776 Test Loss: 0.637 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1983137130737305
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.659 Vali Acc: 0.789 Test Loss: 0.659 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 22 cost time: 2.429056406021118
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.156839609146118
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.671 Vali Acc: 0.816 Test Loss: 0.671 Test Acc: 0.816
Validation loss decreased (-0.789467 --> -0.815783).  Saving model ...
Epoch: 24 cost time: 2.1486144065856934
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.678 Vali Acc: 0.816 Test Loss: 0.678 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1237449645996094
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.2110235691070557
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.705 Vali Acc: 0.803 Test Loss: 0.705 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9550647735595703
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.709 Vali Acc: 0.809 Test Loss: 0.709 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.260685443878174
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.714 Vali Acc: 0.816 Test Loss: 0.714 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.1203341484069824
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.726 Vali Acc: 0.822 Test Loss: 0.726 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822361).  Saving model ...
Epoch: 30 cost time: 2.0179667472839355
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.736 Vali Acc: 0.822 Test Loss: 0.736 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.119626760482788
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.746 Vali Acc: 0.822 Test Loss: 0.746 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9992280006408691
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.758 Vali Acc: 0.809 Test Loss: 0.758 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.1215250492095947
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.765 Vali Acc: 0.816 Test Loss: 0.765 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.0781219005584717
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.774 Vali Acc: 0.809 Test Loss: 0.774 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.0794990062713623
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.781 Vali Acc: 0.809 Test Loss: 0.781 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.1342484951019287
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.789 Vali Acc: 0.809 Test Loss: 0.789 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.067366600036621
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.792 Vali Acc: 0.816 Test Loss: 0.792 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.080181121826172
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.795 Vali Acc: 0.816 Test Loss: 0.795 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.1500887870788574
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.806 Vali Acc: 0.809 Test Loss: 0.806 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1191300
model size : 9.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5322067737579346
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.415 Vali Acc: 0.217 Test Loss: 1.415 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 1.9423189163208008
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.372 Vali Acc: 0.289 Test Loss: 1.372 Test Acc: 0.289
Validation loss decreased (-0.217091 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 1.9843838214874268
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.322 Vali Acc: 0.336 Test Loss: 1.322 Test Acc: 0.336
Validation loss decreased (-0.289460 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 1.9549574851989746
Epoch: 4, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.263 Vali Acc: 0.388 Test Loss: 1.263 Test Acc: 0.388
Validation loss decreased (-0.335513 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 2.234699010848999
Epoch: 5, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.180 Vali Acc: 0.454 Test Loss: 1.180 Test Acc: 0.454
Validation loss decreased (-0.388145 --> -0.453936).  Saving model ...
Epoch: 6 cost time: 2.2415037155151367
Epoch: 6, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.088 Vali Acc: 0.559 Test Loss: 1.088 Test Acc: 0.559
Validation loss decreased (-0.453936 --> -0.559200).  Saving model ...
Epoch: 7 cost time: 2.285140037536621
Epoch: 7, Steps: 10 | Train Loss: 0.811 Vali Loss: 0.987 Vali Acc: 0.618 Test Loss: 0.987 Test Acc: 0.618
Validation loss decreased (-0.559200 --> -0.618411).  Saving model ...
Epoch: 8 cost time: 2.0305848121643066
Epoch: 8, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.870 Vali Acc: 0.651 Test Loss: 0.870 Test Acc: 0.651
Validation loss decreased (-0.618411 --> -0.651307).  Saving model ...
Epoch: 9 cost time: 2.3359851837158203
Epoch: 9, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.779 Vali Acc: 0.684 Test Loss: 0.779 Test Acc: 0.684
Validation loss decreased (-0.651307 --> -0.684203).  Saving model ...
Epoch: 10 cost time: 2.1521806716918945
Epoch: 10, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.727 Vali Acc: 0.684 Test Loss: 0.727 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684203).  Saving model ...
Epoch: 11 cost time: 2.1286065578460693
Epoch: 11, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.697 Vali Acc: 0.697 Test Loss: 0.697 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 12 cost time: 2.338961124420166
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.664 Vali Acc: 0.711 Test Loss: 0.664 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710520).  Saving model ...
Epoch: 13 cost time: 2.1302223205566406
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.656 Vali Acc: 0.724 Test Loss: 0.656 Test Acc: 0.724
Validation loss decreased (-0.710520 --> -0.723678).  Saving model ...
Epoch: 14 cost time: 2.1305742263793945
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.668 Vali Acc: 0.750 Test Loss: 0.668 Test Acc: 0.750
Validation loss decreased (-0.723678 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 2.2650768756866455
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.713 Vali Acc: 0.750 Test Loss: 0.713 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.251124143600464
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.716 Vali Acc: 0.757 Test Loss: 0.716 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 17 cost time: 2.2590513229370117
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.716 Vali Acc: 0.757 Test Loss: 0.716 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9083192348480225
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.747 Vali Acc: 0.763 Test Loss: 0.747 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763150).  Saving model ...
Epoch: 19 cost time: 2.009624719619751
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.764 Vali Acc: 0.770 Test Loss: 0.764 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769729).  Saving model ...
Epoch: 20 cost time: 2.046340227127075
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.778 Vali Acc: 0.770 Test Loss: 0.778 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.009052276611328
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.806 Vali Acc: 0.770 Test Loss: 0.806 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2787649631500244
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.819 Vali Acc: 0.770 Test Loss: 0.819 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0462212562561035
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.799 Vali Acc: 0.789 Test Loss: 0.799 Test Acc: 0.789
Validation loss decreased (-0.769729 --> -0.789466).  Saving model ...
Epoch: 24 cost time: 1.9149248600006104
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.841 Vali Acc: 0.783 Test Loss: 0.841 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.182772397994995
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.860 Vali Acc: 0.763 Test Loss: 0.860 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.946532964706421
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.869 Vali Acc: 0.783 Test Loss: 0.869 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.893143653869629
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.865 Vali Acc: 0.776 Test Loss: 0.865 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.067514181137085
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.879 Vali Acc: 0.776 Test Loss: 0.879 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.0605177879333496
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.893 Vali Acc: 0.776 Test Loss: 0.893 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9304134845733643
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.896 Vali Acc: 0.776 Test Loss: 0.896 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.0868265628814697
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.901 Vali Acc: 0.776 Test Loss: 0.901 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.0116610527038574
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.907 Vali Acc: 0.776 Test Loss: 0.907 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.068681478500366
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.912 Vali Acc: 0.776 Test Loss: 0.912 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1191300
model size : 9.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8429818153381348
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.391 Vali Acc: 0.289 Test Loss: 1.391 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.1817615032196045
Epoch: 2, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.351 Vali Acc: 0.336 Test Loss: 1.351 Test Acc: 0.336
Validation loss decreased (-0.289460 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 2.246983766555786
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.298 Vali Acc: 0.382 Test Loss: 1.298 Test Acc: 0.382
Validation loss decreased (-0.335513 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 2.2368555068969727
Epoch: 4, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.232 Vali Acc: 0.441 Test Loss: 1.232 Test Acc: 0.441
Validation loss decreased (-0.381566 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 2.190443754196167
Epoch: 5, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.147 Vali Acc: 0.539 Test Loss: 1.147 Test Acc: 0.539
Validation loss decreased (-0.440777 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 2.2184555530548096
Epoch: 6, Steps: 10 | Train Loss: 0.876 Vali Loss: 1.054 Vali Acc: 0.612 Test Loss: 1.054 Test Acc: 0.612
Validation loss decreased (-0.539462 --> -0.611832).  Saving model ...
Epoch: 7 cost time: 1.880380392074585
Epoch: 7, Steps: 10 | Train Loss: 0.719 Vali Loss: 0.960 Vali Acc: 0.645 Test Loss: 0.960 Test Acc: 0.645
Validation loss decreased (-0.611832 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 2.263359785079956
Epoch: 8, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.852 Vali Acc: 0.638 Test Loss: 0.852 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.085822105407715
Epoch: 9, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.764 Vali Acc: 0.711 Test Loss: 0.764 Test Acc: 0.711
Validation loss decreased (-0.644727 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 2.131641387939453
Epoch: 10, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.706 Vali Acc: 0.717 Test Loss: 0.706 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 1.987985610961914
Epoch: 11, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.663 Vali Acc: 0.743 Test Loss: 0.663 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 2.030851364135742
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.631 Vali Acc: 0.750 Test Loss: 0.631 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 2.0362846851348877
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.628 Vali Acc: 0.737 Test Loss: 0.628 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8493247032165527
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.636 Vali Acc: 0.757 Test Loss: 0.636 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 2.156907796859741
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.349836826324463
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.684 Vali Acc: 0.763 Test Loss: 0.684 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763151).  Saving model ...
Epoch: 17 cost time: 2.1687121391296387
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.686 Vali Acc: 0.776 Test Loss: 0.686 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 18 cost time: 2.0855560302734375
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.706 Vali Acc: 0.770 Test Loss: 0.706 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3530845642089844
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.715 Vali Acc: 0.770 Test Loss: 0.715 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1385538578033447
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782887).  Saving model ...
Epoch: 21 cost time: 2.1525301933288574
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.751 Vali Acc: 0.770 Test Loss: 0.751 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1605923175811768
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.769 Vali Acc: 0.776 Test Loss: 0.769 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1157872676849365
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.769 Vali Acc: 0.789 Test Loss: 0.769 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789466).  Saving model ...
Epoch: 24 cost time: 2.208950996398926
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.791 Vali Acc: 0.776 Test Loss: 0.791 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.090284824371338
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.801 Vali Acc: 0.776 Test Loss: 0.801 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1640195846557617
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.814 Vali Acc: 0.776 Test Loss: 0.814 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1527624130249023
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.821 Vali Acc: 0.776 Test Loss: 0.821 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.0895352363586426
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.832 Vali Acc: 0.783 Test Loss: 0.832 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.281982898712158
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.846 Vali Acc: 0.783 Test Loss: 0.846 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.2644028663635254
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.859 Vali Acc: 0.783 Test Loss: 0.859 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.2112507820129395
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.872 Vali Acc: 0.783 Test Loss: 0.872 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.4191391468048096
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.880 Vali Acc: 0.783 Test Loss: 0.880 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.198378801345825
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.881 Vali Acc: 0.783 Test Loss: 0.881 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1191300
model size : 9.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.636781692504883
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.9893760681152344
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 1.9431440830230713
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 2.02038836479187
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 5 cost time: 1.9801034927368164
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 6 cost time: 1.909484624862671
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 7 cost time: 2.2324252128601074
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 8 cost time: 2.1036813259124756
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 9 cost time: 2.3187286853790283
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 10 cost time: 2.238445997238159
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 11 cost time: 2.268894672393799
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 12 cost time: 2.23588228225708
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 13 cost time: 2.2787482738494873
Epoch: 13, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.263144 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 2.1237988471984863
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.189314603805542
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 2.1319968700408936
Epoch: 16, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 2.141475200653076
Epoch: 17, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 1.8821933269500732
Epoch: 18, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 2.0848777294158936
Epoch: 19, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 1.99295973777771
Epoch: 20, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 1.889197826385498
Epoch: 21, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.138734817504883
Epoch: 22, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.030856132507324
Epoch: 23, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1968822479248047
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 2.0965702533721924
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 2.0235228538513184
Epoch: 26, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.101717948913574
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.2467899322509766
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.205965757369995
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.033752918243408
Epoch: 30, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2454919815063477
Epoch: 31, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 1.891812801361084
Epoch: 32, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.0011086463928223
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.0736947059631348
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.09438157081604
Epoch: 35, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 2.1968674659729004
Epoch: 36, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 1.9439105987548828
Epoch: 37, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.0976004600524902
Epoch: 38, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.204824924468994
Epoch: 39, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.1240005493164062
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 2.146294593811035
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.327993869781494
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 2.1889216899871826
Epoch: 43, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.3553061485290527
Epoch: 44, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.162362575531006
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.2596750259399414
Epoch: 46, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.1090457439422607
Epoch: 47, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.8701281547546387
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.0063693523406982
Epoch: 49, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 1.9523146152496338
Epoch: 50, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 1.9195358753204346
Epoch: 51, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 52 cost time: 2.0173120498657227
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 53 cost time: 1.8166930675506592
Epoch: 53, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 2.1633388996124268
Epoch: 54, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.2876017093658447
Epoch: 55, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 56 cost time: 2.198477268218994
Epoch: 56, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 57 cost time: 2.167020559310913
Epoch: 57, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.339306116104126
Epoch: 58, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.14711856842041
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 60 cost time: 2.3731276988983154
Epoch: 60, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.070570230484009
Epoch: 61, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 62 cost time: 2.0848164558410645
Epoch: 62, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.9874258041381836
Epoch: 63, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 64 cost time: 1.957944631576538
Epoch: 64, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 65 cost time: 1.9372873306274414
Epoch: 65, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.0455448627471924
Epoch: 66, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.2771823406219482
Epoch: 67, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 2.14038348197937
Epoch: 68, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 69 cost time: 2.1982781887054443
Epoch: 69, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 70 cost time: 2.2351906299591064
Epoch: 70, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 2.324551582336426
Epoch: 71, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 2.0533607006073
Epoch: 72, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 73 cost time: 2.3516290187835693
Epoch: 73, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.0189743041992188
Epoch: 74, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 2.2598562240600586
Epoch: 75, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 2.1168057918548584
Epoch: 76, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.9639427661895752
Epoch: 77, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.940347671508789
Epoch: 78, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.9670929908752441
Epoch: 79, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 2.030900478363037
Epoch: 80, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 1.8383252620697021
Epoch: 81, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 2.1047511100769043
Epoch: 82, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 1191300
model size : 9.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.622197389602661
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.352 Vali Acc: 0.322 Test Loss: 1.352 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 2.038020133972168
Epoch: 2, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.231 Vali Acc: 0.447 Test Loss: 1.231 Test Acc: 0.447
Validation loss decreased (-0.322355 --> -0.447356).  Saving model ...
Epoch: 3 cost time: 2.305314064025879
Epoch: 3, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.099 Vali Acc: 0.612 Test Loss: 1.099 Test Acc: 0.612
Validation loss decreased (-0.447356 --> -0.611831).  Saving model ...
Epoch: 4 cost time: 2.156947374343872
Epoch: 4, Steps: 10 | Train Loss: 0.871 Vali Loss: 0.991 Vali Acc: 0.658 Test Loss: 0.991 Test Acc: 0.658
Validation loss decreased (-0.611831 --> -0.657885).  Saving model ...
Epoch: 5 cost time: 2.0764870643615723
Epoch: 5, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.921 Vali Acc: 0.671 Test Loss: 0.921 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671043).  Saving model ...
Epoch: 6 cost time: 2.3417773246765137
Epoch: 6, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.861 Vali Acc: 0.691 Test Loss: 0.861 Test Acc: 0.691
Validation loss decreased (-0.671043 --> -0.690781).  Saving model ...
Epoch: 7 cost time: 2.2316908836364746
Epoch: 7, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.815 Vali Acc: 0.704 Test Loss: 0.815 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703939).  Saving model ...
Epoch: 8 cost time: 2.1997482776641846
Epoch: 8, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.779 Vali Acc: 0.711 Test Loss: 0.779 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710519).  Saving model ...
Epoch: 9 cost time: 2.1906445026397705
Epoch: 9, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.732 Vali Acc: 0.730 Test Loss: 0.732 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 2.2541654109954834
Epoch: 10, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.706 Vali Acc: 0.743 Test Loss: 0.706 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 11 cost time: 2.302304267883301
Epoch: 11, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.663 Vali Acc: 0.750 Test Loss: 0.663 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 2.1046547889709473
Epoch: 12, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.657 Vali Acc: 0.743 Test Loss: 0.657 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0482406616210938
Epoch: 13, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.647 Vali Acc: 0.763 Test Loss: 0.647 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 14 cost time: 1.8933677673339844
Epoch: 14, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.639 Vali Acc: 0.776 Test Loss: 0.639 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 15 cost time: 1.9627995491027832
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.660 Vali Acc: 0.770 Test Loss: 0.660 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.149104118347168
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.656 Vali Acc: 0.789 Test Loss: 0.656 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 17 cost time: 2.2216169834136963
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.667 Vali Acc: 0.796 Test Loss: 0.667 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 18 cost time: 2.36453914642334
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.690 Vali Acc: 0.796 Test Loss: 0.690 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1901612281799316
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.702 Vali Acc: 0.796 Test Loss: 0.702 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.228762149810791
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.698 Vali Acc: 0.789 Test Loss: 0.698 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.277988910675049
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.734 Vali Acc: 0.789 Test Loss: 0.734 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2569057941436768
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.748 Vali Acc: 0.796 Test Loss: 0.748 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.1068503856658936
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.757 Vali Acc: 0.789 Test Loss: 0.757 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.922943115234375
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.769 Vali Acc: 0.789 Test Loss: 0.769 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.1473217010498047
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.780 Vali Acc: 0.789 Test Loss: 0.780 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.007148504257202
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.791 Vali Acc: 0.789 Test Loss: 0.791 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.216573476791382
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.809 Vali Acc: 0.796 Test Loss: 0.809 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 798084
model size : 7.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.733530044555664
Epoch: 1, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.319 Vali Acc: 0.375 Test Loss: 1.319 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 2.176366090774536
Epoch: 2, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.223 Vali Acc: 0.474 Test Loss: 1.223 Test Acc: 0.474
Validation loss decreased (-0.374987 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 2.3389744758605957
Epoch: 3, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.113 Vali Acc: 0.579 Test Loss: 1.113 Test Acc: 0.579
Validation loss decreased (-0.473672 --> -0.578936).  Saving model ...
Epoch: 4 cost time: 2.262225866317749
Epoch: 4, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.020 Vali Acc: 0.605 Test Loss: 1.020 Test Acc: 0.605
Validation loss decreased (-0.578936 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 2.321868419647217
Epoch: 5, Steps: 10 | Train Loss: 0.776 Vali Loss: 0.950 Vali Acc: 0.605 Test Loss: 0.950 Test Acc: 0.605
Validation loss decreased (-0.605253 --> -0.605254).  Saving model ...
Epoch: 6 cost time: 2.209110975265503
Epoch: 6, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.881 Vali Acc: 0.658 Test Loss: 0.881 Test Acc: 0.658
Validation loss decreased (-0.605254 --> -0.657886).  Saving model ...
Epoch: 7 cost time: 2.5267434120178223
Epoch: 7, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.827 Vali Acc: 0.704 Test Loss: 0.827 Test Acc: 0.704
Validation loss decreased (-0.657886 --> -0.703939).  Saving model ...
Epoch: 8 cost time: 2.197002410888672
Epoch: 8, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.772 Vali Acc: 0.717 Test Loss: 0.772 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 1.9179387092590332
Epoch: 9, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
Validation loss decreased (-0.717098 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 2.211992025375366
Epoch: 10, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.687 Vali Acc: 0.743 Test Loss: 0.687 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.126180410385132
Epoch: 11, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.652 Vali Acc: 0.757 Test Loss: 0.652 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 2.0529909133911133
Epoch: 12, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.645 Vali Acc: 0.776 Test Loss: 0.645 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 13 cost time: 1.8432159423828125
Epoch: 13, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.634 Vali Acc: 0.776 Test Loss: 0.634 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776309).  Saving model ...
Epoch: 14 cost time: 2.059051036834717
Epoch: 14, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.623 Vali Acc: 0.776 Test Loss: 0.623 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.938272476196289
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796046).  Saving model ...
Epoch: 16 cost time: 1.910315752029419
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.629 Vali Acc: 0.783 Test Loss: 0.629 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.226198673248291
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2188720703125
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.186659097671509
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.659 Vali Acc: 0.796 Test Loss: 0.659 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0866024494171143
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.425954580307007
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 22 cost time: 2.0972800254821777
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.688 Vali Acc: 0.789 Test Loss: 0.688 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.195295572280884
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.694 Vali Acc: 0.789 Test Loss: 0.694 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9853720664978027
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.708 Vali Acc: 0.796 Test Loss: 0.708 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.239685535430908
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.724 Vali Acc: 0.796 Test Loss: 0.724 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.2653889656066895
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.732 Vali Acc: 0.796 Test Loss: 0.732 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.267274856567383
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.748 Vali Acc: 0.796 Test Loss: 0.748 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.3035073280334473
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.751 Vali Acc: 0.789 Test Loss: 0.751 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.0884883403778076
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.746 Vali Acc: 0.789 Test Loss: 0.746 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.113908052444458
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.756 Vali Acc: 0.789 Test Loss: 0.756 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.2976138591766357
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.769 Vali Acc: 0.789 Test Loss: 0.769 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 798084
model size : 7.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8903815746307373
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.355 Vali Acc: 0.368 Test Loss: 1.355 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 2.0209455490112305
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.283 Vali Acc: 0.362 Test Loss: 1.283 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0084054470062256
Epoch: 3, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.185 Vali Acc: 0.467 Test Loss: 1.185 Test Acc: 0.467
Validation loss decreased (-0.368408 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 2.0915982723236084
Epoch: 4, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.089 Vali Acc: 0.546 Test Loss: 1.089 Test Acc: 0.546
Validation loss decreased (-0.467093 --> -0.546042).  Saving model ...
Epoch: 5 cost time: 1.636488676071167
Epoch: 5, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.006 Vali Acc: 0.618 Test Loss: 1.006 Test Acc: 0.618
Validation loss decreased (-0.546042 --> -0.618411).  Saving model ...
Epoch: 6 cost time: 1.83294677734375
Epoch: 6, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.919 Vali Acc: 0.671 Test Loss: 0.919 Test Acc: 0.671
Validation loss decreased (-0.618411 --> -0.671043).  Saving model ...
Epoch: 7 cost time: 1.9538888931274414
Epoch: 7, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.836 Vali Acc: 0.697 Test Loss: 0.836 Test Acc: 0.697
Validation loss decreased (-0.671043 --> -0.697360).  Saving model ...
Epoch: 8 cost time: 1.8987805843353271
Epoch: 8, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.756 Vali Acc: 0.717 Test Loss: 0.756 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 1.9350385665893555
Epoch: 9, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.691 Vali Acc: 0.730 Test Loss: 0.691 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 1.950007677078247
Epoch: 10, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.650 Vali Acc: 0.743 Test Loss: 0.650 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 11 cost time: 1.8228638172149658
Epoch: 11, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.624 Vali Acc: 0.757 Test Loss: 0.624 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 12 cost time: 2.0112686157226562
Epoch: 12, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.602 Vali Acc: 0.770 Test Loss: 0.602 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.843374490737915
Epoch: 13, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.79219388961792
Epoch: 14, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.590 Vali Acc: 0.803 Test Loss: 0.590 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 2.084177255630493
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.971256971359253
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.598 Vali Acc: 0.803 Test Loss: 0.598 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0505714416503906
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 18 cost time: 1.9846704006195068
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8863093852996826
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.641 Vali Acc: 0.809 Test Loss: 0.641 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2256596088409424
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.645 Vali Acc: 0.816 Test Loss: 0.645 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 21 cost time: 2.11781907081604
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.665 Vali Acc: 0.809 Test Loss: 0.665 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1081104278564453
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.679 Vali Acc: 0.796 Test Loss: 0.679 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8795039653778076
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.692 Vali Acc: 0.796 Test Loss: 0.692 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9636359214782715
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.706 Vali Acc: 0.803 Test Loss: 0.706 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9615485668182373
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.722 Vali Acc: 0.803 Test Loss: 0.722 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.987739086151123
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.731 Vali Acc: 0.809 Test Loss: 0.731 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9315376281738281
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.742 Vali Acc: 0.803 Test Loss: 0.742 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7534515857696533
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.745 Vali Acc: 0.803 Test Loss: 0.745 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9334290027618408
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.742 Vali Acc: 0.829 Test Loss: 0.742 Test Acc: 0.829
Validation loss decreased (-0.815783 --> -0.828940).  Saving model ...
Epoch: 30 cost time: 1.9324867725372314
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.756 Vali Acc: 0.829 Test Loss: 0.756 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7937192916870117
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.766 Vali Acc: 0.829 Test Loss: 0.766 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9531965255737305
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.778 Vali Acc: 0.822 Test Loss: 0.778 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7620000839233398
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.792 Vali Acc: 0.809 Test Loss: 0.792 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.034792423248291
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.800 Vali Acc: 0.816 Test Loss: 0.800 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.032710552215576
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.809 Vali Acc: 0.822 Test Loss: 0.809 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.016583204269409
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.811 Vali Acc: 0.822 Test Loss: 0.811 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.32712459564209
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.819 Vali Acc: 0.816 Test Loss: 0.819 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.9716615676879883
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.830 Vali Acc: 0.816 Test Loss: 0.830 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.3279991149902344
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.834 Vali Acc: 0.816 Test Loss: 0.834 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 798084
model size : 7.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7065680027008057
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.392 Vali Acc: 0.289 Test Loss: 1.392 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.9086158275604248
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.342 Vali Acc: 0.303 Test Loss: 1.342 Test Acc: 0.303
Validation loss decreased (-0.289460 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 1.8942439556121826
Epoch: 3, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.272 Vali Acc: 0.382 Test Loss: 1.272 Test Acc: 0.382
Validation loss decreased (-0.302618 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 2.1758360862731934
Epoch: 4, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.197 Vali Acc: 0.487 Test Loss: 1.197 Test Acc: 0.487
Validation loss decreased (-0.381566 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 2.0559349060058594
Epoch: 5, Steps: 10 | Train Loss: 0.970 Vali Loss: 1.118 Vali Acc: 0.520 Test Loss: 1.118 Test Acc: 0.520
Validation loss decreased (-0.486830 --> -0.519726).  Saving model ...
Epoch: 6 cost time: 2.2117161750793457
Epoch: 6, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.017 Vali Acc: 0.592 Test Loss: 1.017 Test Acc: 0.592
Validation loss decreased (-0.519726 --> -0.592095).  Saving model ...
Epoch: 7 cost time: 2.135801076889038
Epoch: 7, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.926 Vali Acc: 0.599 Test Loss: 0.926 Test Acc: 0.599
Validation loss decreased (-0.592095 --> -0.598675).  Saving model ...
Epoch: 8 cost time: 2.111344575881958
Epoch: 8, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.832 Vali Acc: 0.658 Test Loss: 0.832 Test Acc: 0.658
Validation loss decreased (-0.598675 --> -0.657886).  Saving model ...
Epoch: 9 cost time: 2.1787335872650146
Epoch: 9, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.743 Vali Acc: 0.691 Test Loss: 0.743 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690782).  Saving model ...
Epoch: 10 cost time: 1.9375991821289062
Epoch: 10, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.687 Vali Acc: 0.730 Test Loss: 0.687 Test Acc: 0.730
Validation loss decreased (-0.690782 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.9404356479644775
Epoch: 11, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.635 Vali Acc: 0.750 Test Loss: 0.635 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 2.006561040878296
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 2.011594533920288
Epoch: 13, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.577 Vali Acc: 0.776 Test Loss: 0.577 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 2.0223445892333984
Epoch: 14, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.9758353233337402
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.578 Vali Acc: 0.776 Test Loss: 0.578 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9120781421661377
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1685891151428223
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 2.109583616256714
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.617 Vali Acc: 0.796 Test Loss: 0.617 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796046).  Saving model ...
Epoch: 19 cost time: 2.0538506507873535
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.137002944946289
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809204).  Saving model ...
Epoch: 21 cost time: 2.069079637527466
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.651 Vali Acc: 0.789 Test Loss: 0.651 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2520244121551514
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.657 Vali Acc: 0.803 Test Loss: 0.657 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.945286512374878
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.665 Vali Acc: 0.803 Test Loss: 0.665 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8981804847717285
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.680 Vali Acc: 0.796 Test Loss: 0.680 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.089834451675415
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.696 Vali Acc: 0.796 Test Loss: 0.696 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0071115493774414
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.707 Vali Acc: 0.803 Test Loss: 0.707 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0376498699188232
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.724 Vali Acc: 0.816 Test Loss: 0.724 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815782).  Saving model ...
Epoch: 28 cost time: 2.1116068363189697
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.727 Vali Acc: 0.803 Test Loss: 0.727 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9674797058105469
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.728 Vali Acc: 0.822 Test Loss: 0.728 Test Acc: 0.822
Validation loss decreased (-0.815782 --> -0.822361).  Saving model ...
Epoch: 30 cost time: 2.1778790950775146
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.742 Vali Acc: 0.822 Test Loss: 0.742 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.1786859035491943
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.748 Vali Acc: 0.822 Test Loss: 0.748 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1458942890167236
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.758 Vali Acc: 0.822 Test Loss: 0.758 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.148318290710449
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.772 Vali Acc: 0.809 Test Loss: 0.772 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.1790668964385986
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.777 Vali Acc: 0.822 Test Loss: 0.777 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.2186810970306396
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.789 Vali Acc: 0.809 Test Loss: 0.789 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.9488115310668945
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.792 Vali Acc: 0.822 Test Loss: 0.792 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.8484246730804443
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.799 Vali Acc: 0.822 Test Loss: 0.799 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.7743098735809326
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.805 Vali Acc: 0.822 Test Loss: 0.805 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.8231837749481201
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.808 Vali Acc: 0.822 Test Loss: 0.808 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 798084
model size : 7.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.321434259414673
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.395 Vali Acc: 0.263 Test Loss: 1.395 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.333711624145508
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.359 Vali Acc: 0.270 Test Loss: 1.359 Test Acc: 0.270
Validation loss decreased (-0.263144 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 2.1910431385040283
Epoch: 3, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.321 Vali Acc: 0.322 Test Loss: 1.321 Test Acc: 0.322
Validation loss decreased (-0.269723 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 2.0005805492401123
Epoch: 4, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.263 Vali Acc: 0.342 Test Loss: 1.263 Test Acc: 0.342
Validation loss decreased (-0.322355 --> -0.342093).  Saving model ...
Epoch: 5 cost time: 2.097719430923462
Epoch: 5, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.198 Vali Acc: 0.441 Test Loss: 1.198 Test Acc: 0.441
Validation loss decreased (-0.342093 --> -0.440777).  Saving model ...
Epoch: 6 cost time: 2.325286626815796
Epoch: 6, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.098 Vali Acc: 0.539 Test Loss: 1.098 Test Acc: 0.539
Validation loss decreased (-0.440777 --> -0.539463).  Saving model ...
Epoch: 7 cost time: 2.0432140827178955
Epoch: 7, Steps: 10 | Train Loss: 0.842 Vali Loss: 0.995 Vali Acc: 0.592 Test Loss: 0.995 Test Acc: 0.592
Validation loss decreased (-0.539463 --> -0.592095).  Saving model ...
Epoch: 8 cost time: 2.1995835304260254
Epoch: 8, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.895 Vali Acc: 0.638 Test Loss: 0.895 Test Acc: 0.638
Validation loss decreased (-0.592095 --> -0.638149).  Saving model ...
Epoch: 9 cost time: 2.1006548404693604
Epoch: 9, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.808 Vali Acc: 0.678 Test Loss: 0.808 Test Acc: 0.678
Validation loss decreased (-0.638149 --> -0.677624).  Saving model ...
Epoch: 10 cost time: 2.3462677001953125
Epoch: 10, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.749 Vali Acc: 0.717 Test Loss: 0.749 Test Acc: 0.717
Validation loss decreased (-0.677624 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 1.9829599857330322
Epoch: 11, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.700 Vali Acc: 0.711 Test Loss: 0.700 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.085456609725952
Epoch: 12, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.678 Vali Acc: 0.730 Test Loss: 0.678 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 13 cost time: 2.234457492828369
Epoch: 13, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.649 Vali Acc: 0.724 Test Loss: 0.649 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.230597972869873
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.655 Vali Acc: 0.750 Test Loss: 0.655 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 2.2689294815063477
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.679 Vali Acc: 0.750 Test Loss: 0.679 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2724130153656006
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.689 Vali Acc: 0.757 Test Loss: 0.689 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 17 cost time: 2.128281354904175
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.720 Vali Acc: 0.757 Test Loss: 0.720 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1510205268859863
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.740 Vali Acc: 0.763 Test Loss: 0.740 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763150).  Saving model ...
Epoch: 19 cost time: 2.0625431537628174
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.764 Vali Acc: 0.763 Test Loss: 0.764 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9623029232025146
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.761 Vali Acc: 0.783 Test Loss: 0.761 Test Acc: 0.783
Validation loss decreased (-0.763150 --> -0.782887).  Saving model ...
Epoch: 21 cost time: 1.9539341926574707
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.784 Vali Acc: 0.757 Test Loss: 0.784 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0671849250793457
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.795 Vali Acc: 0.776 Test Loss: 0.795 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7769989967346191
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.811 Vali Acc: 0.776 Test Loss: 0.811 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.031116247177124
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.844 Vali Acc: 0.776 Test Loss: 0.844 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.31575345993042
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.861 Vali Acc: 0.770 Test Loss: 0.861 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.151614189147949
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.870 Vali Acc: 0.776 Test Loss: 0.870 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.2082107067108154
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.877 Vali Acc: 0.776 Test Loss: 0.877 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.1364855766296387
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.876 Vali Acc: 0.783 Test Loss: 0.876 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.050105094909668
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.874 Vali Acc: 0.783 Test Loss: 0.874 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.0806660652160645
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.888 Vali Acc: 0.776 Test Loss: 0.888 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 798084
model size : 7.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.702444314956665
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.405 Vali Acc: 0.303 Test Loss: 1.405 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 2.0675270557403564
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.366 Vali Acc: 0.329 Test Loss: 1.366 Test Acc: 0.329
Validation loss decreased (-0.302618 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 2.1398894786834717
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.320 Vali Acc: 0.355 Test Loss: 1.320 Test Acc: 0.355
Validation loss decreased (-0.328934 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 2.1814441680908203
Epoch: 4, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.256 Vali Acc: 0.408 Test Loss: 1.256 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 2.2529900074005127
Epoch: 5, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.183 Vali Acc: 0.461 Test Loss: 1.183 Test Acc: 0.461
Validation loss decreased (-0.407882 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 2.172933340072632
Epoch: 6, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.080 Vali Acc: 0.586 Test Loss: 1.080 Test Acc: 0.586
Validation loss decreased (-0.460514 --> -0.585516).  Saving model ...
Epoch: 7 cost time: 2.1593945026397705
Epoch: 7, Steps: 10 | Train Loss: 0.797 Vali Loss: 0.974 Vali Acc: 0.625 Test Loss: 0.974 Test Acc: 0.625
Validation loss decreased (-0.585516 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 2.233649492263794
Epoch: 8, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.875 Vali Acc: 0.645 Test Loss: 0.875 Test Acc: 0.645
Validation loss decreased (-0.624990 --> -0.644728).  Saving model ...
Epoch: 9 cost time: 2.188979148864746
Epoch: 9, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.789 Vali Acc: 0.671 Test Loss: 0.789 Test Acc: 0.671
Validation loss decreased (-0.644728 --> -0.671045).  Saving model ...
Epoch: 10 cost time: 2.224639892578125
Epoch: 10, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.721 Vali Acc: 0.724 Test Loss: 0.721 Test Acc: 0.724
Validation loss decreased (-0.671045 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 2.035518169403076
Epoch: 11, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.665 Vali Acc: 0.743 Test Loss: 0.665 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 1.8178424835205078
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.648 Vali Acc: 0.757 Test Loss: 0.648 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 13 cost time: 1.8476109504699707
Epoch: 13, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.645 Vali Acc: 0.743 Test Loss: 0.645 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.965942621231079
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.649 Vali Acc: 0.757 Test Loss: 0.649 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.971477746963501
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.662 Vali Acc: 0.770 Test Loss: 0.662 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 16 cost time: 1.9430437088012695
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.661 Vali Acc: 0.770 Test Loss: 0.661 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 17 cost time: 1.88423752784729
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.684 Vali Acc: 0.770 Test Loss: 0.684 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1427786350250244
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.704 Vali Acc: 0.770 Test Loss: 0.704 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.071388006210327
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.728 Vali Acc: 0.783 Test Loss: 0.728 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782887).  Saving model ...
Epoch: 20 cost time: 1.9640631675720215
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.733 Vali Acc: 0.783 Test Loss: 0.733 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.127535820007324
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.107396125793457
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.753 Vali Acc: 0.789 Test Loss: 0.753 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789466).  Saving model ...
Epoch: 23 cost time: 2.0503504276275635
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.757 Vali Acc: 0.776 Test Loss: 0.757 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0587751865386963
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.779 Vali Acc: 0.770 Test Loss: 0.779 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0009608268737793
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.802 Vali Acc: 0.783 Test Loss: 0.802 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9494638442993164
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.809 Vali Acc: 0.783 Test Loss: 0.809 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.0414516925811768
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.819 Vali Acc: 0.783 Test Loss: 0.819 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9228181838989258
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.819 Vali Acc: 0.770 Test Loss: 0.819 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.085875988006592
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.823 Vali Acc: 0.770 Test Loss: 0.823 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.0145325660705566
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.843 Vali Acc: 0.763 Test Loss: 0.843 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.2989253997802734
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.854 Vali Acc: 0.770 Test Loss: 0.854 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.2411181926727295
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.870 Vali Acc: 0.763 Test Loss: 0.870 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 798084
model size : 7.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7166121006011963
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.8843684196472168
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 1.8401031494140625
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 4 cost time: 1.9503686428070068
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 5 cost time: 1.9859585762023926
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 6 cost time: 1.982086181640625
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 7 cost time: 1.871490240097046
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 8 cost time: 2.100677967071533
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 9 cost time: 2.0655224323272705
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 10 cost time: 1.9487576484680176
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 11 cost time: 2.0337960720062256
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 12 cost time: 2.09335994720459
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 13 cost time: 1.8835785388946533
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8511238098144531
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.230249 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 1.9190304279327393
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 1.9264531135559082
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 2.0140321254730225
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 2.063000202178955
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 2.0420846939086914
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 2.2344729900360107
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 2.1892001628875732
Epoch: 21, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.1849660873413086
Epoch: 22, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 2.2127959728240967
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 2.2301015853881836
Epoch: 24, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 2.2795462608337402
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 2.0676844120025635
Epoch: 26, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.406374454498291
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.3129637241363525
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.0586302280426025
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0430548191070557
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.2370684146881104
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 2.232759952545166
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.0975520610809326
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9643299579620361
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.9766995906829834
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 1.9500608444213867
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.232883930206299
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.414865732192993
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.2313570976257324
Epoch: 39, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.3326523303985596
Epoch: 40, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 2.323575496673584
Epoch: 41, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 2.4073007106781006
Epoch: 42, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.1189587116241455
Epoch: 43, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.2527706623077393
Epoch: 44, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 45 cost time: 2.1594433784484863
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 1.9566376209259033
Epoch: 46, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 2.061721086502075
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 48 cost time: 2.434034585952759
Epoch: 48, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.48763108253479
Epoch: 49, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.1807026863098145
Epoch: 50, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.4530062675476074
Epoch: 51, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 52 cost time: 2.5976035594940186
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.1405653953552246
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.9994032382965088
Epoch: 54, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.105771780014038
Epoch: 55, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 56 cost time: 2.150062084197998
Epoch: 56, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 57 cost time: 2.0857648849487305
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 58 cost time: 1.893730878829956
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 59 cost time: 2.287543296813965
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 60 cost time: 2.1040239334106445
Epoch: 60, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.5088047981262207
Epoch: 61, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 2.1571621894836426
Epoch: 62, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 63 cost time: 2.2390081882476807
Epoch: 63, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.046154260635376
Epoch: 64, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.9631373882293701
Epoch: 65, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.9355897903442383
Epoch: 66, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 2.028844118118286
Epoch: 67, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 2.0860345363616943
Epoch: 68, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 2.298898220062256
Epoch: 69, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 2.1618492603302
Epoch: 70, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 2.1279067993164062
Epoch: 71, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 2.1856131553649902
Epoch: 72, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 798084
model size : 7.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4347009658813477
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.383 Vali Acc: 0.309 Test Loss: 1.383 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 2.0539891719818115
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.262 Vali Acc: 0.454 Test Loss: 1.262 Test Acc: 0.454
Validation loss decreased (-0.309197 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 1.9583919048309326
Epoch: 3, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.127 Vali Acc: 0.592 Test Loss: 1.127 Test Acc: 0.592
Validation loss decreased (-0.453935 --> -0.592094).  Saving model ...
Epoch: 4 cost time: 1.9960086345672607
Epoch: 4, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.013 Vali Acc: 0.651 Test Loss: 1.013 Test Acc: 0.651
Validation loss decreased (-0.592094 --> -0.651306).  Saving model ...
Epoch: 5 cost time: 1.9999804496765137
Epoch: 5, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.926 Vali Acc: 0.684 Test Loss: 0.926 Test Acc: 0.684
Validation loss decreased (-0.651306 --> -0.684201).  Saving model ...
Epoch: 6 cost time: 2.017484664916992
Epoch: 6, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.862 Vali Acc: 0.697 Test Loss: 0.862 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697360).  Saving model ...
Epoch: 7 cost time: 2.037374258041382
Epoch: 7, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.811 Vali Acc: 0.697 Test Loss: 0.811 Test Acc: 0.697
Validation loss decreased (-0.697360 --> -0.697360).  Saving model ...
Epoch: 8 cost time: 2.053114414215088
Epoch: 8, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.781 Vali Acc: 0.704 Test Loss: 0.781 Test Acc: 0.704
Validation loss decreased (-0.697360 --> -0.703940).  Saving model ...
Epoch: 9 cost time: 2.1143009662628174
Epoch: 9, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.723 Vali Acc: 0.737 Test Loss: 0.723 Test Acc: 0.737
Validation loss decreased (-0.703940 --> -0.736835).  Saving model ...
Epoch: 10 cost time: 1.8830609321594238
Epoch: 10, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.694 Vali Acc: 0.724 Test Loss: 0.694 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9889707565307617
Epoch: 11, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.650 Vali Acc: 0.743 Test Loss: 0.650 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 1.825148105621338
Epoch: 12, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.634 Vali Acc: 0.770 Test Loss: 0.634 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769730).  Saving model ...
Epoch: 13 cost time: 1.834918737411499
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.600 Vali Acc: 0.770 Test Loss: 0.600 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.9323372840881348
Epoch: 14, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.603 Vali Acc: 0.796 Test Loss: 0.603 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.9437522888183594
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9415452480316162
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1396918296813965
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.621 Vali Acc: 0.789 Test Loss: 0.621 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.237140655517578
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.646 Vali Acc: 0.796 Test Loss: 0.646 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.137455463409424
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.657 Vali Acc: 0.789 Test Loss: 0.657 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.233856439590454
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.679 Vali Acc: 0.796 Test Loss: 0.679 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0945444107055664
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.695 Vali Acc: 0.796 Test Loss: 0.695 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.008575677871704
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.704 Vali Acc: 0.803 Test Loss: 0.704 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 23 cost time: 2.024616241455078
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.712 Vali Acc: 0.809 Test Loss: 0.712 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809203).  Saving model ...
Epoch: 24 cost time: 1.8362655639648438
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.737 Vali Acc: 0.803 Test Loss: 0.737 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2407286167144775
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.749 Vali Acc: 0.803 Test Loss: 0.749 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.029599666595459
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.764 Vali Acc: 0.803 Test Loss: 0.764 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.213733196258545
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.783 Vali Acc: 0.789 Test Loss: 0.783 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.490968942642212
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.790 Vali Acc: 0.789 Test Loss: 0.790 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.3327531814575195
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.800 Vali Acc: 0.789 Test Loss: 0.800 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.427588939666748
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.815 Vali Acc: 0.789 Test Loss: 0.815 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.3510637283325195
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.826 Vali Acc: 0.796 Test Loss: 0.826 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.2342519760131836
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.837 Vali Acc: 0.803 Test Loss: 0.837 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.0358998775482178
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.850 Vali Acc: 0.803 Test Loss: 0.850 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 601476
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.576791524887085
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.394 Vali Acc: 0.303 Test Loss: 1.394 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 2.4749577045440674
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.283 Vali Acc: 0.461 Test Loss: 1.283 Test Acc: 0.461
Validation loss decreased (-0.302618 --> -0.460513).  Saving model ...
Epoch: 3 cost time: 2.1423535346984863
Epoch: 3, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.155 Vali Acc: 0.572 Test Loss: 1.155 Test Acc: 0.572
Validation loss decreased (-0.460513 --> -0.572357).  Saving model ...
Epoch: 4 cost time: 2.1569783687591553
Epoch: 4, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.042 Vali Acc: 0.612 Test Loss: 1.042 Test Acc: 0.612
Validation loss decreased (-0.572357 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 2.322780132293701
Epoch: 5, Steps: 10 | Train Loss: 0.830 Vali Loss: 0.949 Vali Acc: 0.691 Test Loss: 0.949 Test Acc: 0.691
Validation loss decreased (-0.611832 --> -0.690780).  Saving model ...
Epoch: 6 cost time: 2.3762705326080322
Epoch: 6, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.876 Vali Acc: 0.697 Test Loss: 0.876 Test Acc: 0.697
Validation loss decreased (-0.690780 --> -0.697360).  Saving model ...
Epoch: 7 cost time: 2.139880418777466
Epoch: 7, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.817 Vali Acc: 0.691 Test Loss: 0.817 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1009745597839355
Epoch: 8, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.773 Vali Acc: 0.704 Test Loss: 0.773 Test Acc: 0.704
Validation loss decreased (-0.697360 --> -0.703940).  Saving model ...
Epoch: 9 cost time: 2.2267792224884033
Epoch: 9, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.707 Vali Acc: 0.724 Test Loss: 0.707 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 10 cost time: 2.2151126861572266
Epoch: 10, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.679 Vali Acc: 0.737 Test Loss: 0.679 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 2.0869359970092773
Epoch: 11, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.643 Vali Acc: 0.770 Test Loss: 0.643 Test Acc: 0.770
Validation loss decreased (-0.736835 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 2.22760272026062
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.629 Vali Acc: 0.789 Test Loss: 0.629 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789467).  Saving model ...
Epoch: 13 cost time: 2.2511017322540283
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3363099098205566
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.598 Vali Acc: 0.796 Test Loss: 0.598 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 2.265866994857788
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.604 Vali Acc: 0.796 Test Loss: 0.604 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1938560009002686
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.427781820297241
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3230645656585693
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.632 Vali Acc: 0.796 Test Loss: 0.632 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1918561458587646
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.218510627746582
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.652 Vali Acc: 0.796 Test Loss: 0.652 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8106343746185303
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.666 Vali Acc: 0.796 Test Loss: 0.666 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.937774896621704
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.675 Vali Acc: 0.803 Test Loss: 0.675 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 23 cost time: 2.0249691009521484
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.685 Vali Acc: 0.809 Test Loss: 0.685 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 24 cost time: 1.9892678260803223
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.712 Vali Acc: 0.803 Test Loss: 0.712 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1167569160461426
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.732 Vali Acc: 0.803 Test Loss: 0.732 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0890438556671143
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.746 Vali Acc: 0.809 Test Loss: 0.746 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1366677284240723
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.750 Vali Acc: 0.789 Test Loss: 0.750 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1292827129364014
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.749 Vali Acc: 0.803 Test Loss: 0.749 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.0179383754730225
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.760 Vali Acc: 0.803 Test Loss: 0.760 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.998358964920044
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.776 Vali Acc: 0.803 Test Loss: 0.776 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.897454023361206
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.787 Vali Acc: 0.803 Test Loss: 0.787 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.1318109035491943
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.794 Vali Acc: 0.809 Test Loss: 0.794 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.192030429840088
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.800 Vali Acc: 0.809 Test Loss: 0.800 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 601476
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9105262756347656
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.420 Vali Acc: 0.276 Test Loss: 1.420 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 2.327509641647339
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.345 Vali Acc: 0.362 Test Loss: 1.345 Test Acc: 0.362
Validation loss decreased (-0.276302 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 2.0908470153808594
Epoch: 3, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.254 Vali Acc: 0.487 Test Loss: 1.254 Test Acc: 0.487
Validation loss decreased (-0.361829 --> -0.486830).  Saving model ...
Epoch: 4 cost time: 2.2418532371520996
Epoch: 4, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.157 Vali Acc: 0.559 Test Loss: 1.157 Test Acc: 0.559
Validation loss decreased (-0.486830 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.877772569656372
Epoch: 5, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.060 Vali Acc: 0.632 Test Loss: 1.060 Test Acc: 0.632
Validation loss decreased (-0.559199 --> -0.631568).  Saving model ...
Epoch: 6 cost time: 1.8700857162475586
Epoch: 6, Steps: 10 | Train Loss: 0.769 Vali Loss: 0.967 Vali Acc: 0.684 Test Loss: 0.967 Test Acc: 0.684
Validation loss decreased (-0.631568 --> -0.684201).  Saving model ...
Epoch: 7 cost time: 2.1908788681030273
Epoch: 7, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.884 Vali Acc: 0.678 Test Loss: 0.884 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9871079921722412
Epoch: 8, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.810 Vali Acc: 0.730 Test Loss: 0.810 Test Acc: 0.730
Validation loss decreased (-0.684201 --> -0.730255).  Saving model ...
Epoch: 9 cost time: 1.923520565032959
Epoch: 9, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.734 Vali Acc: 0.730 Test Loss: 0.734 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 2.148101568222046
Epoch: 10, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.693 Vali Acc: 0.737 Test Loss: 0.693 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 2.185060977935791
Epoch: 11, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.657 Vali Acc: 0.757 Test Loss: 0.657 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 2.0216727256774902
Epoch: 12, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.641 Vali Acc: 0.757 Test Loss: 0.641 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 2.1526081562042236
Epoch: 13, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.613 Vali Acc: 0.776 Test Loss: 0.613 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 2.221794605255127
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.612 Vali Acc: 0.783 Test Loss: 0.612 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.8767573833465576
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.624 Vali Acc: 0.783 Test Loss: 0.624 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0265908241271973
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.623 Vali Acc: 0.803 Test Loss: 0.623 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802625).  Saving model ...
Epoch: 17 cost time: 2.054237127304077
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8801510334014893
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.661 Vali Acc: 0.803 Test Loss: 0.661 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8754992485046387
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.673 Vali Acc: 0.803 Test Loss: 0.673 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8598520755767822
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.682 Vali Acc: 0.803 Test Loss: 0.682 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9540081024169922
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.693 Vali Acc: 0.809 Test Loss: 0.693 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 22 cost time: 2.2410354614257812
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.701 Vali Acc: 0.809 Test Loss: 0.701 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.764431953430176
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.708 Vali Acc: 0.803 Test Loss: 0.708 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2142200469970703
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.729 Vali Acc: 0.809 Test Loss: 0.729 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1202783584594727
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.747 Vali Acc: 0.796 Test Loss: 0.747 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.2574665546417236
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.1287589073181152
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.037017583847046
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.760 Vali Acc: 0.809 Test Loss: 0.760 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.0310375690460205
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.774 Vali Acc: 0.809 Test Loss: 0.774 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.0518202781677246
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.796 Test Loss: 0.789 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.2542526721954346
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.798 Vali Acc: 0.803 Test Loss: 0.798 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 601476
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7220969200134277
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.397 Vali Acc: 0.289 Test Loss: 1.397 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.2110249996185303
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.348 Vali Acc: 0.382 Test Loss: 1.348 Test Acc: 0.382
Validation loss decreased (-0.289460 --> -0.381565).  Saving model ...
Epoch: 3 cost time: 1.9625582695007324
Epoch: 3, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.287 Vali Acc: 0.414 Test Loss: 1.287 Test Acc: 0.414
Validation loss decreased (-0.381565 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 2.159575939178467
Epoch: 4, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.214 Vali Acc: 0.467 Test Loss: 1.214 Test Acc: 0.467
Validation loss decreased (-0.414461 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 2.1876564025878906
Epoch: 5, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.133 Vali Acc: 0.526 Test Loss: 1.133 Test Acc: 0.526
Validation loss decreased (-0.467093 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 2.1456503868103027
Epoch: 6, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.054 Vali Acc: 0.592 Test Loss: 1.054 Test Acc: 0.592
Validation loss decreased (-0.526304 --> -0.592095).  Saving model ...
Epoch: 7 cost time: 2.244309425354004
Epoch: 7, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.967 Vali Acc: 0.632 Test Loss: 0.967 Test Acc: 0.632
Validation loss decreased (-0.592095 --> -0.631569).  Saving model ...
Epoch: 8 cost time: 2.1779086589813232
Epoch: 8, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.867 Vali Acc: 0.671 Test Loss: 0.867 Test Acc: 0.671
Validation loss decreased (-0.631569 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 2.1986277103424072
Epoch: 9, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.777 Vali Acc: 0.691 Test Loss: 0.777 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690782).  Saving model ...
Epoch: 10 cost time: 2.1002769470214844
Epoch: 10, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.722 Vali Acc: 0.711 Test Loss: 0.722 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710519).  Saving model ...
Epoch: 11 cost time: 1.9175171852111816
Epoch: 11, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 2.243675947189331
Epoch: 12, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.639 Vali Acc: 0.776 Test Loss: 0.639 Test Acc: 0.776
Validation loss decreased (-0.736835 --> -0.776309).  Saving model ...
Epoch: 13 cost time: 2.0415990352630615
Epoch: 13, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.617 Vali Acc: 0.770 Test Loss: 0.617 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.415210723876953
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 2.195526599884033
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.614 Vali Acc: 0.803 Test Loss: 0.614 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802625).  Saving model ...
Epoch: 16 cost time: 2.2490034103393555
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802625).  Saving model ...
Epoch: 17 cost time: 2.3330001831054688
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.622 Vali Acc: 0.809 Test Loss: 0.622 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 18 cost time: 2.308732032775879
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.647 Vali Acc: 0.816 Test Loss: 0.647 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 19 cost time: 2.108656167984009
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.661 Vali Acc: 0.816 Test Loss: 0.661 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.92106294631958
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.669 Vali Acc: 0.816 Test Loss: 0.669 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.076927661895752
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.675 Vali Acc: 0.816 Test Loss: 0.675 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2164626121520996
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.685 Vali Acc: 0.816 Test Loss: 0.685 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.0389244556427
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1792025566101074
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.711 Vali Acc: 0.809 Test Loss: 0.711 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.242253303527832
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.724 Vali Acc: 0.816 Test Loss: 0.724 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.034968137741089
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.737 Vali Acc: 0.816 Test Loss: 0.737 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.2001895904541016
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.743 Vali Acc: 0.809 Test Loss: 0.743 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.233630657196045
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.750 Vali Acc: 0.809 Test Loss: 0.750 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 601476
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.631427764892578
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.447 Vali Acc: 0.263 Test Loss: 1.447 Test Acc: 0.263
Validation loss decreased (inf --> -0.263143).  Saving model ...
Epoch: 2 cost time: 1.9897077083587646
Epoch: 2, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.411 Vali Acc: 0.276 Test Loss: 1.411 Test Acc: 0.276
Validation loss decreased (-0.263143 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 2.0761420726776123
Epoch: 3, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.363 Vali Acc: 0.296 Test Loss: 1.363 Test Acc: 0.296
Validation loss decreased (-0.276302 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 2.0058670043945312
Epoch: 4, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.294 Vali Acc: 0.408 Test Loss: 1.294 Test Acc: 0.408
Validation loss decreased (-0.296039 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 2.0180020332336426
Epoch: 5, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.202 Vali Acc: 0.487 Test Loss: 1.202 Test Acc: 0.487
Validation loss decreased (-0.407882 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 2.1000497341156006
Epoch: 6, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.095 Vali Acc: 0.546 Test Loss: 1.095 Test Acc: 0.546
Validation loss decreased (-0.486830 --> -0.546042).  Saving model ...
Epoch: 7 cost time: 2.0659124851226807
Epoch: 7, Steps: 10 | Train Loss: 0.870 Vali Loss: 0.978 Vali Acc: 0.566 Test Loss: 0.978 Test Acc: 0.566
Validation loss decreased (-0.546042 --> -0.565780).  Saving model ...
Epoch: 8 cost time: 1.9348433017730713
Epoch: 8, Steps: 10 | Train Loss: 0.718 Vali Loss: 0.872 Vali Acc: 0.638 Test Loss: 0.872 Test Acc: 0.638
Validation loss decreased (-0.565780 --> -0.638149).  Saving model ...
Epoch: 9 cost time: 1.97377347946167
Epoch: 9, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.790 Vali Acc: 0.684 Test Loss: 0.790 Test Acc: 0.684
Validation loss decreased (-0.638149 --> -0.684203).  Saving model ...
Epoch: 10 cost time: 2.2143056392669678
Epoch: 10, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.749 Vali Acc: 0.717 Test Loss: 0.749 Test Acc: 0.717
Validation loss decreased (-0.684203 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 2.1382782459259033
Epoch: 11, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.699 Vali Acc: 0.724 Test Loss: 0.699 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 12 cost time: 2.1808524131774902
Epoch: 12, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 13 cost time: 2.385209560394287
Epoch: 13, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.655 Vali Acc: 0.743 Test Loss: 0.655 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 14 cost time: 2.139665126800537
Epoch: 14, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.674 Vali Acc: 0.750 Test Loss: 0.674 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 2.1556806564331055
Epoch: 15, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.696 Vali Acc: 0.750 Test Loss: 0.696 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3172428607940674
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9480993747711182
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.730 Vali Acc: 0.750 Test Loss: 0.730 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.993891954421997
Epoch: 18, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.755 Vali Acc: 0.757 Test Loss: 0.755 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756571).  Saving model ...
Epoch: 19 cost time: 2.0709378719329834
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.753 Vali Acc: 0.763 Test Loss: 0.753 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763150).  Saving model ...
Epoch: 20 cost time: 1.8749158382415771
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.774 Vali Acc: 0.770 Test Loss: 0.774 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769729).  Saving model ...
Epoch: 21 cost time: 2.1532039642333984
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.810 Vali Acc: 0.763 Test Loss: 0.810 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0851266384124756
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.832 Vali Acc: 0.763 Test Loss: 0.832 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1328158378601074
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.836 Vali Acc: 0.763 Test Loss: 0.836 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.136324167251587
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.855 Vali Acc: 0.776 Test Loss: 0.855 Test Acc: 0.776
Validation loss decreased (-0.769729 --> -0.776307).  Saving model ...
Epoch: 25 cost time: 2.075747013092041
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.873 Vali Acc: 0.770 Test Loss: 0.873 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1080498695373535
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.887 Vali Acc: 0.770 Test Loss: 0.887 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0825300216674805
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.905 Vali Acc: 0.770 Test Loss: 0.905 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8374524116516113
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.918 Vali Acc: 0.783 Test Loss: 0.918 Test Acc: 0.783
Validation loss decreased (-0.776307 --> -0.782886).  Saving model ...
Epoch: 29 cost time: 1.7949512004852295
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.936 Vali Acc: 0.783 Test Loss: 0.936 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.902787685394287
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.954 Vali Acc: 0.783 Test Loss: 0.954 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9341208934783936
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.956 Vali Acc: 0.783 Test Loss: 0.956 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9986164569854736
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.962 Vali Acc: 0.783 Test Loss: 0.962 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.2254109382629395
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.973 Vali Acc: 0.783 Test Loss: 0.973 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.132047653198242
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.984 Vali Acc: 0.776 Test Loss: 0.984 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.30743408203125
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.990 Vali Acc: 0.783 Test Loss: 0.990 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.384835720062256
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.995 Vali Acc: 0.783 Test Loss: 0.995 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.346505641937256
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.997 Vali Acc: 0.783 Test Loss: 0.997 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.333366632461548
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.997 Vali Acc: 0.783 Test Loss: 0.997 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 601476
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.751176595687866
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.476 Vali Acc: 0.263 Test Loss: 1.476 Test Acc: 0.263
Validation loss decreased (inf --> -0.263143).  Saving model ...
Epoch: 2 cost time: 2.41756272315979
Epoch: 2, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.436 Vali Acc: 0.283 Test Loss: 1.436 Test Acc: 0.283
Validation loss decreased (-0.263143 --> -0.282880).  Saving model ...
Epoch: 3 cost time: 2.2272398471832275
Epoch: 3, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.379 Vali Acc: 0.309 Test Loss: 1.379 Test Acc: 0.309
Validation loss decreased (-0.282880 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 2.1882851123809814
Epoch: 4, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.301 Vali Acc: 0.355 Test Loss: 1.301 Test Acc: 0.355
Validation loss decreased (-0.309197 --> -0.355250).  Saving model ...
Epoch: 5 cost time: 2.441587209701538
Epoch: 5, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.205 Vali Acc: 0.441 Test Loss: 1.205 Test Acc: 0.441
Validation loss decreased (-0.355250 --> -0.440777).  Saving model ...
Epoch: 6 cost time: 2.252264976501465
Epoch: 6, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.096 Vali Acc: 0.520 Test Loss: 1.096 Test Acc: 0.520
Validation loss decreased (-0.440777 --> -0.519726).  Saving model ...
Epoch: 7 cost time: 2.1765754222869873
Epoch: 7, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.984 Vali Acc: 0.599 Test Loss: 0.984 Test Acc: 0.599
Validation loss decreased (-0.519726 --> -0.598674).  Saving model ...
Epoch: 8 cost time: 2.2266876697540283
Epoch: 8, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.880 Vali Acc: 0.645 Test Loss: 0.880 Test Acc: 0.645
Validation loss decreased (-0.598674 --> -0.644728).  Saving model ...
Epoch: 9 cost time: 2.086427927017212
Epoch: 9, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.811 Vali Acc: 0.691 Test Loss: 0.811 Test Acc: 0.691
Validation loss decreased (-0.644728 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 2.060392141342163
Epoch: 10, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.769 Vali Acc: 0.704 Test Loss: 0.769 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703940).  Saving model ...
Epoch: 11 cost time: 2.0242202281951904
Epoch: 11, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.731 Vali Acc: 0.717 Test Loss: 0.731 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 12 cost time: 2.1310861110687256
Epoch: 12, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.700 Vali Acc: 0.743 Test Loss: 0.700 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 13 cost time: 2.133812665939331
Epoch: 13, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.679 Vali Acc: 0.770 Test Loss: 0.679 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769730).  Saving model ...
Epoch: 14 cost time: 2.1847963333129883
Epoch: 14, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.696 Vali Acc: 0.757 Test Loss: 0.696 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2334389686584473
Epoch: 15, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.716 Vali Acc: 0.750 Test Loss: 0.716 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.19830584526062
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.715 Vali Acc: 0.776 Test Loss: 0.715 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 17 cost time: 2.0828778743743896
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.732 Vali Acc: 0.770 Test Loss: 0.732 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9973976612091064
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.754 Vali Acc: 0.770 Test Loss: 0.754 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.078655481338501
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.759 Vali Acc: 0.776 Test Loss: 0.759 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.787743330001831
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.773 Vali Acc: 0.789 Test Loss: 0.773 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789466).  Saving model ...
Epoch: 21 cost time: 2.1465156078338623
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.802 Vali Acc: 0.776 Test Loss: 0.802 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9861540794372559
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.822 Vali Acc: 0.783 Test Loss: 0.822 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0122339725494385
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.829 Vali Acc: 0.789 Test Loss: 0.829 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1745083332061768
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.848 Vali Acc: 0.776 Test Loss: 0.848 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.1061453819274902
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.862 Vali Acc: 0.783 Test Loss: 0.862 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.1603708267211914
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.876 Vali Acc: 0.776 Test Loss: 0.876 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.2522101402282715
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.888 Vali Acc: 0.783 Test Loss: 0.888 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.1328284740448
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.900 Vali Acc: 0.796 Test Loss: 0.900 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796044).  Saving model ...
Epoch: 29 cost time: 2.0565147399902344
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.913 Vali Acc: 0.796 Test Loss: 0.913 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.042017698287964
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.929 Vali Acc: 0.783 Test Loss: 0.929 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.2300684452056885
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.933 Vali Acc: 0.789 Test Loss: 0.933 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.2002718448638916
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.937 Vali Acc: 0.796 Test Loss: 0.937 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.193420171737671
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.941 Vali Acc: 0.796 Test Loss: 0.941 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.312680721282959
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.948 Vali Acc: 0.783 Test Loss: 0.948 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.182591676712036
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.954 Vali Acc: 0.789 Test Loss: 0.954 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.391441583633423
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.964 Vali Acc: 0.796 Test Loss: 0.964 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.349199056625366
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.968 Vali Acc: 0.789 Test Loss: 0.968 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.264449119567871
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.969 Vali Acc: 0.796 Test Loss: 0.969 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 601476
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3724913597106934
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.1280245780944824
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 1.9687354564666748
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 2.0096635818481445
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 5 cost time: 1.9167277812957764
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 6 cost time: 1.8128297328948975
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 7 cost time: 1.9990649223327637
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 8 cost time: 1.8989038467407227
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 9 cost time: 1.8774924278259277
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 10 cost time: 1.7987890243530273
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 11 cost time: 2.0292844772338867
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 12 cost time: 2.166425943374634
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 13 cost time: 2.230274200439453
Epoch: 13, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 14 cost time: 2.1669857501983643
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.346099376678467
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 16 cost time: 2.180995225906372
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0386476516723633
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 18 cost time: 2.2247469425201416
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 19 cost time: 2.0886595249176025
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 20 cost time: 2.255964517593384
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 21 cost time: 2.197993278503418
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 22 cost time: 2.45072603225708
Epoch: 22, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 23 cost time: 2.1510045528411865
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 24 cost time: 2.5063297748565674
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 25 cost time: 2.17083477973938
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 26 cost time: 2.083712577819824
Epoch: 26, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 27 cost time: 2.174682378768921
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 28 cost time: 2.136848211288452
Epoch: 28, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 29 cost time: 2.0738160610198975
Epoch: 29, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 30 cost time: 1.9343056678771973
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9980762004852295
Epoch: 31, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 32 cost time: 2.0525777339935303
Epoch: 32, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 33 cost time: 1.9509289264678955
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 34 cost time: 2.025161027908325
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.1772351264953613
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 36 cost time: 2.2521581649780273
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.263144 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.405290126800537
Epoch: 37, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.3041653633117676
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.3920271396636963
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.2041025161743164
Epoch: 40, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 2.0399692058563232
Epoch: 41, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 2.2979636192321777
Epoch: 42, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 2.378096580505371
Epoch: 43, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.378453016281128
Epoch: 44, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.376258611679077
Epoch: 45, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.4774930477142334
Epoch: 46, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 2.3766167163848877
Epoch: 47, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.2431600093841553
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.250633716583252
Epoch: 49, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.240602731704712
Epoch: 50, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.208061695098877
Epoch: 51, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.2299699783325195
Epoch: 52, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 53 cost time: 2.4969987869262695
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 2.326641798019409
Epoch: 54, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 55 cost time: 2.408585786819458
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.142716646194458
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 57 cost time: 2.2432637214660645
Epoch: 57, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 58 cost time: 1.978672981262207
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 59 cost time: 2.0109152793884277
Epoch: 59, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.407534599304199
Epoch: 60, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.2702863216400146
Epoch: 61, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 2.31587815284729
Epoch: 62, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 2.3027172088623047
Epoch: 63, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 2.092672109603882
Epoch: 64, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 65 cost time: 2.155163288116455
Epoch: 65, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 66 cost time: 2.2486777305603027
Epoch: 66, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.4072492122650146
Epoch: 67, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 2.2649130821228027
Epoch: 68, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 69 cost time: 2.206149101257324
Epoch: 69, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 2.345669746398926
Epoch: 70, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 2.4035415649414062
Epoch: 71, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 72 cost time: 2.1697518825531006
Epoch: 72, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 2.4524497985839844
Epoch: 73, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 2.2988431453704834
Epoch: 74, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 2.512038230895996
Epoch: 75, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 2.3934738636016846
Epoch: 76, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 2.521582841873169
Epoch: 77, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 2.4382801055908203
Epoch: 78, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 2.457580327987671
Epoch: 79, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 2.238856077194214
Epoch: 80, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 2.279595375061035
Epoch: 81, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 601476
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.2125115394592285
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.429 Vali Acc: 0.243 Test Loss: 1.429 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 2.2498505115509033
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.320 Vali Acc: 0.401 Test Loss: 1.320 Test Acc: 0.401
Validation loss decreased (-0.243407 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 1.9515578746795654
Epoch: 3, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.186 Vali Acc: 0.526 Test Loss: 1.186 Test Acc: 0.526
Validation loss decreased (-0.401303 --> -0.526304).  Saving model ...
Epoch: 4 cost time: 2.170550584793091
Epoch: 4, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.055 Vali Acc: 0.586 Test Loss: 1.055 Test Acc: 0.586
Validation loss decreased (-0.526304 --> -0.585516).  Saving model ...
Epoch: 5 cost time: 2.261092185974121
Epoch: 5, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.954 Vali Acc: 0.651 Test Loss: 0.954 Test Acc: 0.651
Validation loss decreased (-0.585516 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 2.3284571170806885
Epoch: 6, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.886 Vali Acc: 0.678 Test Loss: 0.886 Test Acc: 0.678
Validation loss decreased (-0.651306 --> -0.677623).  Saving model ...
Epoch: 7 cost time: 2.37890887260437
Epoch: 7, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.829 Vali Acc: 0.697 Test Loss: 0.829 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697360).  Saving model ...
Epoch: 8 cost time: 2.4788546562194824
Epoch: 8, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.779 Vali Acc: 0.724 Test Loss: 0.779 Test Acc: 0.724
Validation loss decreased (-0.697360 --> -0.723676).  Saving model ...
Epoch: 9 cost time: 2.2559292316436768
Epoch: 9, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.740 Vali Acc: 0.711 Test Loss: 0.740 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.294278383255005
Epoch: 10, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.704 Vali Acc: 0.724 Test Loss: 0.704 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 2.1503968238830566
Epoch: 11, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.677 Vali Acc: 0.737 Test Loss: 0.677 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 2.414140224456787
Epoch: 12, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.648 Vali Acc: 0.763 Test Loss: 0.648 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763151).  Saving model ...
Epoch: 13 cost time: 2.275435209274292
Epoch: 13, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.608 Vali Acc: 0.776 Test Loss: 0.608 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 2.24489688873291
Epoch: 14, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.594 Vali Acc: 0.789 Test Loss: 0.594 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 2.3113958835601807
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 2.3306713104248047
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809204).  Saving model ...
Epoch: 17 cost time: 2.270563840866089
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.627 Vali Acc: 0.803 Test Loss: 0.627 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.508394479751587
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.649 Vali Acc: 0.803 Test Loss: 0.649 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.442777633666992
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.668 Vali Acc: 0.809 Test Loss: 0.668 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2510788440704346
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.677 Vali Acc: 0.809 Test Loss: 0.677 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1648337841033936
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.697 Vali Acc: 0.809 Test Loss: 0.697 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.4115712642669678
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.717 Vali Acc: 0.803 Test Loss: 0.717 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.2773497104644775
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.733 Vali Acc: 0.803 Test Loss: 0.733 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.338674306869507
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.739 Vali Acc: 0.796 Test Loss: 0.739 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.425025224685669
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.759 Vali Acc: 0.803 Test Loss: 0.759 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.409644842147827
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.769 Vali Acc: 0.803 Test Loss: 0.769 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 503172
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.271586179733276
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.425 Vali Acc: 0.276 Test Loss: 1.425 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 2.4010443687438965
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.333 Vali Acc: 0.388 Test Loss: 1.333 Test Acc: 0.388
Validation loss decreased (-0.276302 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 2.275735855102539
Epoch: 3, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.388145 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 2.4278035163879395
Epoch: 4, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.098 Vali Acc: 0.566 Test Loss: 1.098 Test Acc: 0.566
Validation loss decreased (-0.499988 --> -0.565778).  Saving model ...
Epoch: 5 cost time: 2.2285025119781494
Epoch: 5, Steps: 10 | Train Loss: 0.876 Vali Loss: 1.007 Vali Acc: 0.599 Test Loss: 1.007 Test Acc: 0.599
Validation loss decreased (-0.565778 --> -0.598674).  Saving model ...
Epoch: 6 cost time: 2.1860663890838623
Epoch: 6, Steps: 10 | Train Loss: 0.719 Vali Loss: 0.935 Vali Acc: 0.605 Test Loss: 0.935 Test Acc: 0.605
Validation loss decreased (-0.598674 --> -0.605254).  Saving model ...
Epoch: 7 cost time: 2.287595748901367
Epoch: 7, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.880 Vali Acc: 0.638 Test Loss: 0.880 Test Acc: 0.638
Validation loss decreased (-0.605254 --> -0.638149).  Saving model ...
Epoch: 8 cost time: 2.184458017349243
Epoch: 8, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.821 Vali Acc: 0.704 Test Loss: 0.821 Test Acc: 0.704
Validation loss decreased (-0.638149 --> -0.703939).  Saving model ...
Epoch: 9 cost time: 2.156820774078369
Epoch: 9, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.766 Vali Acc: 0.697 Test Loss: 0.766 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.529716730117798
Epoch: 10, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.717 Vali Acc: 0.730 Test Loss: 0.717 Test Acc: 0.730
Validation loss decreased (-0.703939 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 2.335850477218628
Epoch: 11, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.680 Vali Acc: 0.750 Test Loss: 0.680 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 2.4140625
Epoch: 12, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.645 Vali Acc: 0.776 Test Loss: 0.645 Test Acc: 0.776
Validation loss decreased (-0.749993 --> -0.776309).  Saving model ...
Epoch: 13 cost time: 2.5161232948303223
Epoch: 13, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 2.3022053241729736
Epoch: 14, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.8594865798950195
Epoch: 15, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.280867576599121
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3263139724731445
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.619 Vali Acc: 0.796 Test Loss: 0.619 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 18 cost time: 2.069951057434082
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809204).  Saving model ...
Epoch: 19 cost time: 2.3756446838378906
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.648 Vali Acc: 0.803 Test Loss: 0.648 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.256618022918701
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.398448944091797
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.672 Vali Acc: 0.796 Test Loss: 0.672 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0358004570007324
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.686 Vali Acc: 0.803 Test Loss: 0.686 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1782917976379395
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1379566192626953
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.697 Vali Acc: 0.803 Test Loss: 0.697 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.1217470169067383
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.718 Vali Acc: 0.803 Test Loss: 0.718 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.3753340244293213
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.728 Vali Acc: 0.803 Test Loss: 0.728 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.3137319087982178
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.738 Vali Acc: 0.803 Test Loss: 0.738 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.1467089653015137
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.748 Vali Acc: 0.803 Test Loss: 0.748 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 503172
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.183497190475464
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.452 Vali Acc: 0.270 Test Loss: 1.452 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 2.270418882369995
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.385 Vali Acc: 0.316 Test Loss: 1.385 Test Acc: 0.316
Validation loss decreased (-0.269722 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 2.220344305038452
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.299 Vali Acc: 0.408 Test Loss: 1.299 Test Acc: 0.408
Validation loss decreased (-0.315776 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 2.125364065170288
Epoch: 4, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.197 Vali Acc: 0.461 Test Loss: 1.197 Test Acc: 0.461
Validation loss decreased (-0.407882 --> -0.460514).  Saving model ...
Epoch: 5 cost time: 2.01104998588562
Epoch: 5, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.108 Vali Acc: 0.539 Test Loss: 1.108 Test Acc: 0.539
Validation loss decreased (-0.460514 --> -0.539463).  Saving model ...
Epoch: 6 cost time: 2.054920196533203
Epoch: 6, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.026 Vali Acc: 0.599 Test Loss: 1.026 Test Acc: 0.599
Validation loss decreased (-0.539463 --> -0.598674).  Saving model ...
Epoch: 7 cost time: 2.135807752609253
Epoch: 7, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.938 Vali Acc: 0.671 Test Loss: 0.938 Test Acc: 0.671
Validation loss decreased (-0.598674 --> -0.671043).  Saving model ...
Epoch: 8 cost time: 2.268092632293701
Epoch: 8, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.851 Vali Acc: 0.678 Test Loss: 0.851 Test Acc: 0.678
Validation loss decreased (-0.671043 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 2.1645736694335938
Epoch: 9, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.773 Vali Acc: 0.691 Test Loss: 0.773 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690782).  Saving model ...
Epoch: 10 cost time: 2.1644246578216553
Epoch: 10, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.704 Vali Acc: 0.730 Test Loss: 0.704 Test Acc: 0.730
Validation loss decreased (-0.690782 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 2.0500404834747314
Epoch: 11, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.649 Vali Acc: 0.743 Test Loss: 0.649 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 2.0986881256103516
Epoch: 12, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.620 Vali Acc: 0.743 Test Loss: 0.620 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 13 cost time: 2.019871234893799
Epoch: 13, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 2.0798697471618652
Epoch: 14, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 2.1543142795562744
Epoch: 15, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.595 Vali Acc: 0.783 Test Loss: 0.595 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 2.3281800746917725
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.218674421310425
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.8815648555755615
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1024656295776367
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0360982418060303
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.645 Vali Acc: 0.783 Test Loss: 0.645 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.23673939704895
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.661 Vali Acc: 0.796 Test Loss: 0.661 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 22 cost time: 2.32672119140625
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.679 Vali Acc: 0.796 Test Loss: 0.679 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.295952320098877
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.695 Vali Acc: 0.796 Test Loss: 0.695 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.300687313079834
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.705 Vali Acc: 0.796 Test Loss: 0.705 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.170413017272949
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.719 Vali Acc: 0.789 Test Loss: 0.719 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0565624237060547
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.728 Vali Acc: 0.796 Test Loss: 0.728 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.1486246585845947
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.733 Vali Acc: 0.803 Test Loss: 0.733 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 28 cost time: 2.1502790451049805
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.739 Vali Acc: 0.796 Test Loss: 0.739 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3508574962615967
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.746 Vali Acc: 0.796 Test Loss: 0.746 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.280895709991455
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.754 Vali Acc: 0.796 Test Loss: 0.754 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.3873581886291504
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.762 Vali Acc: 0.803 Test Loss: 0.762 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.2626607418060303
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.776 Vali Acc: 0.803 Test Loss: 0.776 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.138644218444824
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.790 Vali Acc: 0.803 Test Loss: 0.790 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.171583890914917
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.798 Vali Acc: 0.803 Test Loss: 0.798 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.17069149017334
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.807 Vali Acc: 0.796 Test Loss: 0.807 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.2253952026367188
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.815 Vali Acc: 0.796 Test Loss: 0.815 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.390950918197632
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.827 Vali Acc: 0.796 Test Loss: 0.827 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 503172
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.644798994064331
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.471 Vali Acc: 0.217 Test Loss: 1.471 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 2.0684430599212646
Epoch: 2, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
Validation loss decreased (-0.217091 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 2.1561570167541504
Epoch: 3, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.362 Vali Acc: 0.322 Test Loss: 1.362 Test Acc: 0.322
Validation loss decreased (-0.243407 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 2.335862398147583
Epoch: 4, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.284 Vali Acc: 0.382 Test Loss: 1.284 Test Acc: 0.382
Validation loss decreased (-0.322355 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 2.230839729309082
Epoch: 5, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.201 Vali Acc: 0.414 Test Loss: 1.201 Test Acc: 0.414
Validation loss decreased (-0.381566 --> -0.414462).  Saving model ...
Epoch: 6 cost time: 2.3686249256134033
Epoch: 6, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.113 Vali Acc: 0.513 Test Loss: 1.113 Test Acc: 0.513
Validation loss decreased (-0.414462 --> -0.513147).  Saving model ...
Epoch: 7 cost time: 2.3055777549743652
Epoch: 7, Steps: 10 | Train Loss: 0.772 Vali Loss: 1.012 Vali Acc: 0.592 Test Loss: 1.012 Test Acc: 0.592
Validation loss decreased (-0.513147 --> -0.592095).  Saving model ...
Epoch: 8 cost time: 2.1369755268096924
Epoch: 8, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.906 Vali Acc: 0.612 Test Loss: 0.906 Test Acc: 0.612
Validation loss decreased (-0.592095 --> -0.611833).  Saving model ...
Epoch: 9 cost time: 2.123699188232422
Epoch: 9, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.825 Vali Acc: 0.632 Test Loss: 0.825 Test Acc: 0.632
Validation loss decreased (-0.611833 --> -0.631571).  Saving model ...
Epoch: 10 cost time: 2.05705189704895
Epoch: 10, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.733 Vali Acc: 0.691 Test Loss: 0.733 Test Acc: 0.691
Validation loss decreased (-0.631571 --> -0.690782).  Saving model ...
Epoch: 11 cost time: 2.3748257160186768
Epoch: 11, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.661 Vali Acc: 0.730 Test Loss: 0.661 Test Acc: 0.730
Validation loss decreased (-0.690782 --> -0.730257).  Saving model ...
Epoch: 12 cost time: 2.4376742839813232
Epoch: 12, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.623 Vali Acc: 0.743 Test Loss: 0.623 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 13 cost time: 2.228759288787842
Epoch: 13, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.593 Vali Acc: 0.776 Test Loss: 0.593 Test Acc: 0.776
Validation loss decreased (-0.743415 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 2.4393327236175537
Epoch: 14, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 2.1412839889526367
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2096619606018066
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0786004066467285
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.034695863723755
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 19 cost time: 2.310663938522339
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.416534900665283
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.623 Vali Acc: 0.796 Test Loss: 0.623 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3944828510284424
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.641 Vali Acc: 0.796 Test Loss: 0.641 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.107118606567383
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 23 cost time: 2.006032705307007
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.667 Vali Acc: 0.796 Test Loss: 0.667 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1545283794403076
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.677 Vali Acc: 0.816 Test Loss: 0.677 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815783).  Saving model ...
Epoch: 25 cost time: 2.3400371074676514
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.692 Vali Acc: 0.803 Test Loss: 0.692 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3441452980041504
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.698 Vali Acc: 0.809 Test Loss: 0.698 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.431913375854492
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.706 Vali Acc: 0.809 Test Loss: 0.706 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0402586460113525
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.716 Vali Acc: 0.803 Test Loss: 0.716 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.139983654022217
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.723 Vali Acc: 0.796 Test Loss: 0.723 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.194962978363037
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.176677703857422
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.735 Vali Acc: 0.796 Test Loss: 0.735 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.2800092697143555
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.747 Vali Acc: 0.803 Test Loss: 0.747 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.4376327991485596
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.762 Vali Acc: 0.796 Test Loss: 0.762 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.2620255947113037
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.774 Vali Acc: 0.796 Test Loss: 0.774 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 503172
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.1477437019348145
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.442 Vali Acc: 0.243 Test Loss: 1.442 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 2.2802724838256836
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.412 Vali Acc: 0.283 Test Loss: 1.412 Test Acc: 0.283
Validation loss decreased (-0.243407 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 2.3448872566223145
Epoch: 3, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.371 Vali Acc: 0.336 Test Loss: 1.371 Test Acc: 0.336
Validation loss decreased (-0.282881 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 2.393054246902466
Epoch: 4, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.306 Vali Acc: 0.349 Test Loss: 1.306 Test Acc: 0.349
Validation loss decreased (-0.335513 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 2.2562007904052734
Epoch: 5, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.220 Vali Acc: 0.454 Test Loss: 1.220 Test Acc: 0.454
Validation loss decreased (-0.348671 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 2.1048977375030518
Epoch: 6, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.117 Vali Acc: 0.566 Test Loss: 1.117 Test Acc: 0.566
Validation loss decreased (-0.453935 --> -0.565778).  Saving model ...
Epoch: 7 cost time: 2.231372833251953
Epoch: 7, Steps: 10 | Train Loss: 0.897 Vali Loss: 0.995 Vali Acc: 0.586 Test Loss: 0.995 Test Acc: 0.586
Validation loss decreased (-0.565778 --> -0.585516).  Saving model ...
Epoch: 8 cost time: 2.1256377696990967
Epoch: 8, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.875 Vali Acc: 0.645 Test Loss: 0.875 Test Acc: 0.645
Validation loss decreased (-0.585516 --> -0.644728).  Saving model ...
Epoch: 9 cost time: 2.4390203952789307
Epoch: 9, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.797 Vali Acc: 0.671 Test Loss: 0.797 Test Acc: 0.671
Validation loss decreased (-0.644728 --> -0.671045).  Saving model ...
Epoch: 10 cost time: 2.3141911029815674
Epoch: 10, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.745 Vali Acc: 0.704 Test Loss: 0.745 Test Acc: 0.704
Validation loss decreased (-0.671045 --> -0.703940).  Saving model ...
Epoch: 11 cost time: 2.4385874271392822
Epoch: 11, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.685 Vali Acc: 0.724 Test Loss: 0.685 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 12 cost time: 2.203009843826294
Epoch: 12, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.639 Vali Acc: 0.743 Test Loss: 0.639 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743415).  Saving model ...
Epoch: 13 cost time: 2.325188636779785
Epoch: 13, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 2.104823112487793
Epoch: 14, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.614 Vali Acc: 0.757 Test Loss: 0.614 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 2.1668894290924072
Epoch: 15, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.617 Vali Acc: 0.763 Test Loss: 0.617 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 2.122957706451416
Epoch: 16, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.628 Vali Acc: 0.770 Test Loss: 0.628 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 17 cost time: 2.2074790000915527
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.651 Vali Acc: 0.770 Test Loss: 0.651 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.501420259475708
Epoch: 18, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.678 Vali Acc: 0.770 Test Loss: 0.678 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1060099601745605
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.723 Vali Acc: 0.763 Test Loss: 0.723 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8673248291015625
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.719 Vali Acc: 0.789 Test Loss: 0.719 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789466).  Saving model ...
Epoch: 21 cost time: 2.1652631759643555
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.737 Vali Acc: 0.796 Test Loss: 0.737 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796045).  Saving model ...
Epoch: 22 cost time: 2.075949192047119
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.763 Vali Acc: 0.776 Test Loss: 0.763 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0382626056671143
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.787 Vali Acc: 0.783 Test Loss: 0.787 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.041692018508911
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.788 Vali Acc: 0.789 Test Loss: 0.788 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.176562786102295
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.809 Vali Acc: 0.783 Test Loss: 0.809 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.232213020324707
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.813 Vali Acc: 0.783 Test Loss: 0.813 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9330713748931885
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.822 Vali Acc: 0.783 Test Loss: 0.822 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.151139497756958
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.829 Vali Acc: 0.789 Test Loss: 0.829 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9642608165740967
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.841 Vali Acc: 0.789 Test Loss: 0.841 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9957027435302734
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.849 Vali Acc: 0.789 Test Loss: 0.849 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.2239317893981934
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.870 Vali Acc: 0.783 Test Loss: 0.870 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 503172
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.072633266448975
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.420 Vali Acc: 0.243 Test Loss: 1.420 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 2.4695916175842285
Epoch: 2, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.243407 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 2.181727409362793
Epoch: 3, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.338 Vali Acc: 0.355 Test Loss: 1.338 Test Acc: 0.355
Validation loss decreased (-0.282881 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 2.0915818214416504
Epoch: 4, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.266 Vali Acc: 0.408 Test Loss: 1.266 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 2.061556100845337
Epoch: 5, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.177 Vali Acc: 0.461 Test Loss: 1.177 Test Acc: 0.461
Validation loss decreased (-0.407882 --> -0.460515).  Saving model ...
Epoch: 6 cost time: 2.0480194091796875
Epoch: 6, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.075 Vali Acc: 0.579 Test Loss: 1.075 Test Acc: 0.579
Validation loss decreased (-0.460515 --> -0.578937).  Saving model ...
Epoch: 7 cost time: 2.1059956550598145
Epoch: 7, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.957 Vali Acc: 0.612 Test Loss: 0.957 Test Acc: 0.612
Validation loss decreased (-0.578937 --> -0.611833).  Saving model ...
Epoch: 8 cost time: 2.114074468612671
Epoch: 8, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.843 Vali Acc: 0.664 Test Loss: 0.843 Test Acc: 0.664
Validation loss decreased (-0.611833 --> -0.664465).  Saving model ...
Epoch: 9 cost time: 2.3089816570281982
Epoch: 9, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
Validation loss decreased (-0.664465 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 2.480621814727783
Epoch: 10, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.711 Vali Acc: 0.737 Test Loss: 0.711 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 2.102454900741577
Epoch: 11, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.665 Vali Acc: 0.757 Test Loss: 0.665 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 2.1858630180358887
Epoch: 12, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.637 Vali Acc: 0.770 Test Loss: 0.637 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 13 cost time: 2.161566734313965
Epoch: 13, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.627 Vali Acc: 0.763 Test Loss: 0.627 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.250537157058716
Epoch: 14, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.628 Vali Acc: 0.763 Test Loss: 0.628 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1890809535980225
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.640 Vali Acc: 0.763 Test Loss: 0.640 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.214256525039673
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.658 Vali Acc: 0.763 Test Loss: 0.658 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2939159870147705
Epoch: 17, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.669 Vali Acc: 0.770 Test Loss: 0.669 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2792773246765137
Epoch: 18, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.691 Vali Acc: 0.776 Test Loss: 0.691 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 19 cost time: 2.3386805057525635
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.728 Vali Acc: 0.757 Test Loss: 0.728 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1087453365325928
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.739 Vali Acc: 0.770 Test Loss: 0.739 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.237600088119507
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.757 Vali Acc: 0.783 Test Loss: 0.757 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782887).  Saving model ...
Epoch: 22 cost time: 2.128542423248291
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.777 Vali Acc: 0.776 Test Loss: 0.777 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.006288528442383
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.793 Vali Acc: 0.776 Test Loss: 0.793 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.20703125
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.800 Vali Acc: 0.776 Test Loss: 0.800 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1214466094970703
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.823 Vali Acc: 0.776 Test Loss: 0.823 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.084442377090454
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.830 Vali Acc: 0.776 Test Loss: 0.830 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.2197155952453613
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.834 Vali Acc: 0.776 Test Loss: 0.834 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.3367013931274414
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.842 Vali Acc: 0.776 Test Loss: 0.842 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.17874813079834
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.856 Vali Acc: 0.776 Test Loss: 0.856 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.197237253189087
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.865 Vali Acc: 0.776 Test Loss: 0.865 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.2839789390563965
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.879 Vali Acc: 0.776 Test Loss: 0.879 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 503172
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.372837066650391
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.2488162517547607
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3775386810302734
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0153515338897705
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 5 cost time: 2.341397285461426
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 6 cost time: 2.256347417831421
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 7 cost time: 2.351979970932007
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 8 cost time: 2.136362314224243
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 9 cost time: 1.9547574520111084
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 10 cost time: 2.1738815307617188
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 11 cost time: 2.008335590362549
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 12 cost time: 2.033151865005493
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 13 cost time: 2.11783766746521
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 14 cost time: 2.067584753036499
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 15 cost time: 2.1495018005371094
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.263144 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 2.1224701404571533
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 2.0821757316589355
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 2.177764654159546
Epoch: 18, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 2.3236966133117676
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 2.274430274963379
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 2.1658687591552734
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.4185879230499268
Epoch: 22, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2240593433380127
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 2.4594430923461914
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.437565326690674
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.140979528427124
Epoch: 26, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.3030357360839844
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.169963836669922
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.3339505195617676
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.3348348140716553
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.222618579864502
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9409148693084717
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.1504738330841064
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.038084030151367
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.1582722663879395
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 2.042046308517456
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.1000375747680664
Epoch: 37, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.198051691055298
Epoch: 38, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 1.9603097438812256
Epoch: 39, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.183929204940796
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 2.284445285797119
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.4849088191986084
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 2.4481751918792725
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.0955617427825928
Epoch: 44, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 45 cost time: 2.182758331298828
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.2726035118103027
Epoch: 46, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.3752808570861816
Epoch: 47, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 48 cost time: 2.0610833168029785
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.1966712474823
Epoch: 49, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.334341049194336
Epoch: 50, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.1659128665924072
Epoch: 51, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.1868886947631836
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 53 cost time: 2.2995195388793945
Epoch: 53, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.141982316970825
Epoch: 54, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.0879111289978027
Epoch: 55, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.858823537826538
Epoch: 56, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.9881880283355713
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.0473291873931885
Epoch: 58, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 59 cost time: 2.078873872756958
Epoch: 59, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 60 cost time: 2.256395101547241
Epoch: 60, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.157264232635498
Epoch: 61, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 2.3850457668304443
Epoch: 62, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 2.28975248336792
Epoch: 63, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 2.1681809425354004
Epoch: 64, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 2.0557408332824707
Epoch: 65, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 2.1236929893493652
Epoch: 66, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 2.1740775108337402
Epoch: 67, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 2.3920185565948486
Epoch: 68, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 2.2264750003814697
Epoch: 69, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 503172
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.868061065673828
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.403 Vali Acc: 0.342 Test Loss: 1.403 Test Acc: 0.342
Validation loss decreased (inf --> -0.342091).  Saving model ...
Epoch: 2 cost time: 2.3099801540374756
Epoch: 2, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.269 Vali Acc: 0.493 Test Loss: 1.269 Test Acc: 0.493
Validation loss decreased (-0.342091 --> -0.493408).  Saving model ...
Epoch: 3 cost time: 2.1815011501312256
Epoch: 3, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.142 Vali Acc: 0.592 Test Loss: 1.142 Test Acc: 0.592
Validation loss decreased (-0.493408 --> -0.592094).  Saving model ...
Epoch: 4 cost time: 2.2250161170959473
Epoch: 4, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.038 Vali Acc: 0.664 Test Loss: 1.038 Test Acc: 0.664
Validation loss decreased (-0.592094 --> -0.664463).  Saving model ...
Epoch: 5 cost time: 2.251105546951294
Epoch: 5, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.963 Vali Acc: 0.678 Test Loss: 0.963 Test Acc: 0.678
Validation loss decreased (-0.664463 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 2.309917688369751
Epoch: 6, Steps: 10 | Train Loss: 0.640 Vali Loss: 0.914 Vali Acc: 0.684 Test Loss: 0.914 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684201).  Saving model ...
Epoch: 7 cost time: 2.1396427154541016
Epoch: 7, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.885 Vali Acc: 0.691 Test Loss: 0.885 Test Acc: 0.691
Validation loss decreased (-0.684201 --> -0.690781).  Saving model ...
Epoch: 8 cost time: 2.127720355987549
Epoch: 8, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.844 Vali Acc: 0.704 Test Loss: 0.844 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703939).  Saving model ...
Epoch: 9 cost time: 2.333049774169922
Epoch: 9, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.815 Vali Acc: 0.704 Test Loss: 0.815 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703939).  Saving model ...
Epoch: 10 cost time: 2.508057117462158
Epoch: 10, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.779 Vali Acc: 0.724 Test Loss: 0.779 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723676).  Saving model ...
Epoch: 11 cost time: 2.1903464794158936
Epoch: 11, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.754 Vali Acc: 0.724 Test Loss: 0.754 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723677).  Saving model ...
Epoch: 12 cost time: 1.999823808670044
Epoch: 12, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.736 Vali Acc: 0.730 Test Loss: 0.736 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 13 cost time: 2.2939393520355225
Epoch: 13, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.709 Vali Acc: 0.737 Test Loss: 0.709 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 14 cost time: 2.2526659965515137
Epoch: 14, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.693 Vali Acc: 0.770 Test Loss: 0.693 Test Acc: 0.770
Validation loss decreased (-0.736835 --> -0.769730).  Saving model ...
Epoch: 15 cost time: 2.3822739124298096
Epoch: 15, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.694 Vali Acc: 0.770 Test Loss: 0.694 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.239757776260376
Epoch: 16, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.683 Vali Acc: 0.763 Test Loss: 0.683 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5793232917785645
Epoch: 17, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.688 Vali Acc: 0.770 Test Loss: 0.688 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 18 cost time: 2.2092599868774414
Epoch: 18, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.697 Vali Acc: 0.776 Test Loss: 0.697 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 19 cost time: 2.4276843070983887
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.695 Vali Acc: 0.783 Test Loss: 0.695 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 20 cost time: 2.175448417663574
Epoch: 20, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.691 Vali Acc: 0.783 Test Loss: 0.691 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 21 cost time: 2.0156610012054443
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.692 Vali Acc: 0.783 Test Loss: 0.692 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.301436424255371
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3075437545776367
Epoch: 23, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.717 Vali Acc: 0.770 Test Loss: 0.717 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4789981842041016
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.724 Vali Acc: 0.783 Test Loss: 0.724 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.4290003776550293
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.730 Vali Acc: 0.783 Test Loss: 0.730 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.4556164741516113
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.743 Vali Acc: 0.789 Test Loss: 0.743 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789466).  Saving model ...
Epoch: 27 cost time: 2.0803029537200928
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.759 Vali Acc: 0.789 Test Loss: 0.759 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.1263792514801025
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.761 Vali Acc: 0.789 Test Loss: 0.761 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.2568411827087402
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.766 Vali Acc: 0.783 Test Loss: 0.766 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.1522698402404785
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.793 Vali Acc: 0.789 Test Loss: 0.793 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.2221779823303223
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.810 Vali Acc: 0.789 Test Loss: 0.810 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.852318286895752
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.822 Vali Acc: 0.783 Test Loss: 0.822 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.010341167449951
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.830 Vali Acc: 0.770 Test Loss: 0.830 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.9717662334442139
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.828 Vali Acc: 0.783 Test Loss: 0.828 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.134143590927124
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.842 Vali Acc: 0.796 Test Loss: 0.842 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796044).  Saving model ...
Epoch: 36 cost time: 2.350653648376465
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.861 Vali Acc: 0.789 Test Loss: 0.861 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.9205234050750732
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.861 Vali Acc: 0.789 Test Loss: 0.861 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.2204344272613525
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.861 Vali Acc: 0.789 Test Loss: 0.861 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.231113910675049
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.864 Vali Acc: 0.789 Test Loss: 0.864 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.085015296936035
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.884 Vali Acc: 0.796 Test Loss: 0.884 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.4762773513793945
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.885 Vali Acc: 0.789 Test Loss: 0.885 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.321349620819092
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.902 Vali Acc: 0.789 Test Loss: 0.902 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.13167142868042
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.921 Vali Acc: 0.789 Test Loss: 0.921 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.2432456016540527
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.935 Vali Acc: 0.783 Test Loss: 0.935 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.3126258850097656
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.950 Vali Acc: 0.789 Test Loss: 0.950 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 893636
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.171003103256226
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.406 Vali Acc: 0.283 Test Loss: 1.406 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 2.211808681488037
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.301 Vali Acc: 0.467 Test Loss: 1.301 Test Acc: 0.467
Validation loss decreased (-0.282881 --> -0.467092).  Saving model ...
Epoch: 3 cost time: 2.129723310470581
Epoch: 3, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.199 Vali Acc: 0.599 Test Loss: 1.199 Test Acc: 0.599
Validation loss decreased (-0.467092 --> -0.598672).  Saving model ...
Epoch: 4 cost time: 1.9973030090332031
Epoch: 4, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.105 Vali Acc: 0.625 Test Loss: 1.105 Test Acc: 0.625
Validation loss decreased (-0.598672 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 2.1937918663024902
Epoch: 5, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.028 Vali Acc: 0.632 Test Loss: 1.028 Test Acc: 0.632
Validation loss decreased (-0.624989 --> -0.631569).  Saving model ...
Epoch: 6 cost time: 1.950439453125
Epoch: 6, Steps: 10 | Train Loss: 0.722 Vali Loss: 0.974 Vali Acc: 0.664 Test Loss: 0.974 Test Acc: 0.664
Validation loss decreased (-0.631569 --> -0.664464).  Saving model ...
Epoch: 7 cost time: 1.938577651977539
Epoch: 7, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.930 Vali Acc: 0.691 Test Loss: 0.930 Test Acc: 0.691
Validation loss decreased (-0.664464 --> -0.690780).  Saving model ...
Epoch: 8 cost time: 2.0876200199127197
Epoch: 8, Steps: 10 | Train Loss: 0.541 Vali Loss: 0.875 Vali Acc: 0.678 Test Loss: 0.875 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9558837413787842
Epoch: 9, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.839 Vali Acc: 0.691 Test Loss: 0.839 Test Acc: 0.691
Validation loss decreased (-0.690780 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 2.2626829147338867
Epoch: 10, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.798 Vali Acc: 0.717 Test Loss: 0.798 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717097).  Saving model ...
Epoch: 11 cost time: 2.4506821632385254
Epoch: 11, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.768 Vali Acc: 0.737 Test Loss: 0.768 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736834).  Saving model ...
Epoch: 12 cost time: 2.3007988929748535
Epoch: 12, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.742 Vali Acc: 0.750 Test Loss: 0.742 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 2.120577812194824
Epoch: 13, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.718 Vali Acc: 0.743 Test Loss: 0.718 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.167905330657959
Epoch: 14, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.699 Vali Acc: 0.743 Test Loss: 0.699 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1782772541046143
Epoch: 15, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.695 Vali Acc: 0.757 Test Loss: 0.695 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 16 cost time: 2.177733898162842
Epoch: 16, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.674 Vali Acc: 0.757 Test Loss: 0.674 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 17 cost time: 2.2286782264709473
Epoch: 17, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.671 Vali Acc: 0.770 Test Loss: 0.671 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 18 cost time: 2.210707426071167
Epoch: 18, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.686 Vali Acc: 0.770 Test Loss: 0.686 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3631646633148193
Epoch: 19, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.682 Vali Acc: 0.789 Test Loss: 0.682 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789467).  Saving model ...
Epoch: 20 cost time: 2.254673957824707
Epoch: 20, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.676 Vali Acc: 0.776 Test Loss: 0.676 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3154823780059814
Epoch: 21, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.680 Vali Acc: 0.789 Test Loss: 0.680 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 22 cost time: 2.1831653118133545
Epoch: 22, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.683 Vali Acc: 0.796 Test Loss: 0.683 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 23 cost time: 2.1667778491973877
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.682 Vali Acc: 0.789 Test Loss: 0.682 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.53959584236145
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.699 Vali Acc: 0.796 Test Loss: 0.699 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2359495162963867
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.709 Vali Acc: 0.803 Test Loss: 0.709 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 26 cost time: 2.1223368644714355
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.055769443511963
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.724 Vali Acc: 0.803 Test Loss: 0.724 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2625813484191895
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.726 Vali Acc: 0.803 Test Loss: 0.726 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0852017402648926
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.731 Vali Acc: 0.796 Test Loss: 0.731 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.199227809906006
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.757 Vali Acc: 0.803 Test Loss: 0.757 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.121307849884033
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.775 Vali Acc: 0.803 Test Loss: 0.775 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.019261598587036
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.778 Vali Acc: 0.803 Test Loss: 0.778 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.1847379207611084
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.780 Vali Acc: 0.803 Test Loss: 0.780 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.10959529876709
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.782 Vali Acc: 0.803 Test Loss: 0.782 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.4419121742248535
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.800 Vali Acc: 0.803 Test Loss: 0.800 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 893636
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.070903778076172
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.420 Vali Acc: 0.243 Test Loss: 1.420 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 2.2013673782348633
Epoch: 2, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.349 Vali Acc: 0.355 Test Loss: 1.349 Test Acc: 0.355
Validation loss decreased (-0.243407 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 2.324467182159424
Epoch: 3, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.269 Vali Acc: 0.493 Test Loss: 1.269 Test Acc: 0.493
Validation loss decreased (-0.355250 --> -0.493408).  Saving model ...
Epoch: 4 cost time: 2.1697309017181396
Epoch: 4, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.191 Vali Acc: 0.586 Test Loss: 1.191 Test Acc: 0.586
Validation loss decreased (-0.493408 --> -0.585514).  Saving model ...
Epoch: 5 cost time: 2.135542392730713
Epoch: 5, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.107 Vali Acc: 0.618 Test Loss: 1.107 Test Acc: 0.618
Validation loss decreased (-0.585514 --> -0.618410).  Saving model ...
Epoch: 6 cost time: 2.3719592094421387
Epoch: 6, Steps: 10 | Train Loss: 0.880 Vali Loss: 1.040 Vali Acc: 0.651 Test Loss: 1.040 Test Acc: 0.651
Validation loss decreased (-0.618410 --> -0.651305).  Saving model ...
Epoch: 7 cost time: 2.3508336544036865
Epoch: 7, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.980 Vali Acc: 0.651 Test Loss: 0.980 Test Acc: 0.651
Validation loss decreased (-0.651305 --> -0.651306).  Saving model ...
Epoch: 8 cost time: 2.2787065505981445
Epoch: 8, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.932 Vali Acc: 0.651 Test Loss: 0.932 Test Acc: 0.651
Validation loss decreased (-0.651306 --> -0.651306).  Saving model ...
Epoch: 9 cost time: 2.0547709465026855
Epoch: 9, Steps: 10 | Train Loss: 0.569 Vali Loss: 0.893 Vali Acc: 0.678 Test Loss: 0.893 Test Acc: 0.678
Validation loss decreased (-0.651306 --> -0.677623).  Saving model ...
Epoch: 10 cost time: 2.003117322921753
Epoch: 10, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.843 Vali Acc: 0.671 Test Loss: 0.843 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0459742546081543
Epoch: 11, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.803 Vali Acc: 0.684 Test Loss: 0.803 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684202).  Saving model ...
Epoch: 12 cost time: 1.9706542491912842
Epoch: 12, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.766 Vali Acc: 0.711 Test Loss: 0.766 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710519).  Saving model ...
Epoch: 13 cost time: 2.055537462234497
Epoch: 13, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.728 Vali Acc: 0.730 Test Loss: 0.728 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 14 cost time: 2.0019307136535645
Epoch: 14, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.697 Vali Acc: 0.730 Test Loss: 0.697 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 2.0065770149230957
Epoch: 15, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.681 Vali Acc: 0.737 Test Loss: 0.681 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 16 cost time: 2.0741655826568604
Epoch: 16, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.659 Vali Acc: 0.750 Test Loss: 0.659 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 17 cost time: 2.130415916442871
Epoch: 17, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.659 Vali Acc: 0.743 Test Loss: 0.659 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.047380208969116
Epoch: 18, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.661 Vali Acc: 0.743 Test Loss: 0.661 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.034172773361206
Epoch: 19, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.657 Vali Acc: 0.757 Test Loss: 0.657 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 20 cost time: 2.2126264572143555
Epoch: 20, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.658 Vali Acc: 0.763 Test Loss: 0.658 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 21 cost time: 2.1997439861297607
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.660 Vali Acc: 0.763 Test Loss: 0.660 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1301705837249756
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.665 Vali Acc: 0.757 Test Loss: 0.665 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1147210597991943
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.671 Vali Acc: 0.770 Test Loss: 0.671 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 24 cost time: 2.1909079551696777
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.686 Vali Acc: 0.770 Test Loss: 0.686 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.341050624847412
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.698 Vali Acc: 0.770 Test Loss: 0.698 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1451354026794434
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.703 Vali Acc: 0.776 Test Loss: 0.703 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 27 cost time: 2.2012877464294434
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.707 Vali Acc: 0.770 Test Loss: 0.707 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.353273630142212
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.712 Vali Acc: 0.770 Test Loss: 0.712 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.326894760131836
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.712 Vali Acc: 0.763 Test Loss: 0.712 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0234973430633545
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.719 Vali Acc: 0.757 Test Loss: 0.719 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.1454169750213623
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.729 Vali Acc: 0.789 Test Loss: 0.729 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789466).  Saving model ...
Epoch: 32 cost time: 2.0583131313323975
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.745 Vali Acc: 0.776 Test Loss: 0.745 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1696114540100098
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.761 Vali Acc: 0.763 Test Loss: 0.761 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.971785545349121
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.770 Vali Acc: 0.770 Test Loss: 0.770 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.2493345737457275
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.783 Vali Acc: 0.770 Test Loss: 0.783 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.187983512878418
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.784 Vali Acc: 0.776 Test Loss: 0.784 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.222391366958618
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.788 Vali Acc: 0.763 Test Loss: 0.788 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.1669774055480957
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.789 Vali Acc: 0.770 Test Loss: 0.789 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.2803852558135986
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.791 Vali Acc: 0.783 Test Loss: 0.791 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.0376391410827637
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.802 Vali Acc: 0.789 Test Loss: 0.802 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.1371090412139893
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.810 Vali Acc: 0.783 Test Loss: 0.810 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 893636
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.370240688323975
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.396 Vali Acc: 0.303 Test Loss: 1.396 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 2.1355440616607666
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.349 Vali Acc: 0.382 Test Loss: 1.349 Test Acc: 0.382
Validation loss decreased (-0.302618 --> -0.381565).  Saving model ...
Epoch: 3 cost time: 2.3222696781158447
Epoch: 3, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.307 Vali Acc: 0.414 Test Loss: 1.307 Test Acc: 0.414
Validation loss decreased (-0.381565 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 2.2004549503326416
Epoch: 4, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.262 Vali Acc: 0.461 Test Loss: 1.262 Test Acc: 0.461
Validation loss decreased (-0.414461 --> -0.460514).  Saving model ...
Epoch: 5 cost time: 2.3062407970428467
Epoch: 5, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.207 Vali Acc: 0.493 Test Loss: 1.207 Test Acc: 0.493
Validation loss decreased (-0.460514 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 2.269390106201172
Epoch: 6, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.160 Vali Acc: 0.493 Test Loss: 1.160 Test Acc: 0.493
Validation loss decreased (-0.493409 --> -0.493409).  Saving model ...
Epoch: 7 cost time: 2.1240367889404297
Epoch: 7, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
Validation loss decreased (-0.493409 --> -0.532884).  Saving model ...
Epoch: 8 cost time: 2.223067045211792
Epoch: 8, Steps: 10 | Train Loss: 0.742 Vali Loss: 1.075 Vali Acc: 0.559 Test Loss: 1.075 Test Acc: 0.559
Validation loss decreased (-0.532884 --> -0.559200).  Saving model ...
Epoch: 9 cost time: 2.1309518814086914
Epoch: 9, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.033 Vali Acc: 0.579 Test Loss: 1.033 Test Acc: 0.579
Validation loss decreased (-0.559200 --> -0.578937).  Saving model ...
Epoch: 10 cost time: 2.061492443084717
Epoch: 10, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.982 Vali Acc: 0.586 Test Loss: 0.982 Test Acc: 0.586
Validation loss decreased (-0.578937 --> -0.585517).  Saving model ...
Epoch: 11 cost time: 2.071871042251587
Epoch: 11, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.911 Vali Acc: 0.599 Test Loss: 0.911 Test Acc: 0.599
Validation loss decreased (-0.585517 --> -0.598675).  Saving model ...
Epoch: 12 cost time: 2.0927906036376953
Epoch: 12, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.853 Vali Acc: 0.638 Test Loss: 0.853 Test Acc: 0.638
Validation loss decreased (-0.598675 --> -0.638149).  Saving model ...
Epoch: 13 cost time: 2.20906925201416
Epoch: 13, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.809 Vali Acc: 0.645 Test Loss: 0.809 Test Acc: 0.645
Validation loss decreased (-0.638149 --> -0.644729).  Saving model ...
Epoch: 14 cost time: 2.1107823848724365
Epoch: 14, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.765 Vali Acc: 0.651 Test Loss: 0.765 Test Acc: 0.651
Validation loss decreased (-0.644729 --> -0.651308).  Saving model ...
Epoch: 15 cost time: 2.0420682430267334
Epoch: 15, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.728 Vali Acc: 0.704 Test Loss: 0.728 Test Acc: 0.704
Validation loss decreased (-0.651308 --> -0.703940).  Saving model ...
Epoch: 16 cost time: 2.2558069229125977
Epoch: 16, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.680 Vali Acc: 0.737 Test Loss: 0.680 Test Acc: 0.737
Validation loss decreased (-0.703940 --> -0.736835).  Saving model ...
Epoch: 17 cost time: 1.9270350933074951
Epoch: 17, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.664 Vali Acc: 0.750 Test Loss: 0.664 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 18 cost time: 1.9875919818878174
Epoch: 18, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.646 Vali Acc: 0.743 Test Loss: 0.646 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9001014232635498
Epoch: 19, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.628 Vali Acc: 0.757 Test Loss: 0.628 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 20 cost time: 2.2124197483062744
Epoch: 20, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.630 Vali Acc: 0.750 Test Loss: 0.630 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1084187030792236
Epoch: 21, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.626 Vali Acc: 0.743 Test Loss: 0.626 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.15981388092041
Epoch: 22, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.049344301223755
Epoch: 23, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.629 Vali Acc: 0.757 Test Loss: 0.629 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1741561889648438
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.136932373046875
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.632 Vali Acc: 0.776 Test Loss: 0.632 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776309).  Saving model ...
Epoch: 26 cost time: 2.150104284286499
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.641 Vali Acc: 0.770 Test Loss: 0.641 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.157414436340332
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.645 Vali Acc: 0.783 Test Loss: 0.645 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 28 cost time: 2.075063705444336
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9820647239685059
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.654 Vali Acc: 0.776 Test Loss: 0.654 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9924280643463135
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.658 Vali Acc: 0.776 Test Loss: 0.658 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.2232446670532227
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.663 Vali Acc: 0.776 Test Loss: 0.663 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.048290967941284
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.673 Vali Acc: 0.763 Test Loss: 0.673 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.060081958770752
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.686 Vali Acc: 0.783 Test Loss: 0.686 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.033496141433716
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.698 Vali Acc: 0.776 Test Loss: 0.698 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.179377794265747
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.9637339115142822
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.707 Vali Acc: 0.776 Test Loss: 0.707 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.2115285396575928
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.708 Vali Acc: 0.776 Test Loss: 0.708 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 893636
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.293099403381348
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.465 Vali Acc: 0.217 Test Loss: 1.465 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 2.147616386413574
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.428 Vali Acc: 0.224 Test Loss: 1.428 Test Acc: 0.224
Validation loss decreased (-0.217091 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 2.2842252254486084
Epoch: 3, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (-0.223670 --> -0.269723).  Saving model ...
Epoch: 4 cost time: 2.2062320709228516
Epoch: 4, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.363 Vali Acc: 0.342 Test Loss: 1.363 Test Acc: 0.342
Validation loss decreased (-0.269723 --> -0.342092).  Saving model ...
Epoch: 5 cost time: 2.287818431854248
Epoch: 5, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.318 Vali Acc: 0.349 Test Loss: 1.318 Test Acc: 0.349
Validation loss decreased (-0.342092 --> -0.348671).  Saving model ...
Epoch: 6 cost time: 2.2780842781066895
Epoch: 6, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.272 Vali Acc: 0.388 Test Loss: 1.272 Test Acc: 0.388
Validation loss decreased (-0.348671 --> -0.388145).  Saving model ...
Epoch: 7 cost time: 2.3211488723754883
Epoch: 7, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.213 Vali Acc: 0.441 Test Loss: 1.213 Test Acc: 0.441
Validation loss decreased (-0.388145 --> -0.440777).  Saving model ...
Epoch: 8 cost time: 2.0162084102630615
Epoch: 8, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.152 Vali Acc: 0.474 Test Loss: 1.152 Test Acc: 0.474
Validation loss decreased (-0.440777 --> -0.473673).  Saving model ...
Epoch: 9 cost time: 2.292545795440674
Epoch: 9, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.085 Vali Acc: 0.546 Test Loss: 1.085 Test Acc: 0.546
Validation loss decreased (-0.473673 --> -0.546042).  Saving model ...
Epoch: 10 cost time: 2.1311471462249756
Epoch: 10, Steps: 10 | Train Loss: 0.807 Vali Loss: 1.004 Vali Acc: 0.566 Test Loss: 1.004 Test Acc: 0.566
Validation loss decreased (-0.546042 --> -0.565779).  Saving model ...
Epoch: 11 cost time: 2.118851661682129
Epoch: 11, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.911 Vali Acc: 0.632 Test Loss: 0.911 Test Acc: 0.632
Validation loss decreased (-0.565779 --> -0.631570).  Saving model ...
Epoch: 12 cost time: 2.3014745712280273
Epoch: 12, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.837 Vali Acc: 0.632 Test Loss: 0.837 Test Acc: 0.632
Validation loss decreased (-0.631570 --> -0.631571).  Saving model ...
Epoch: 13 cost time: 2.313387393951416
Epoch: 13, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.775 Vali Acc: 0.671 Test Loss: 0.775 Test Acc: 0.671
Validation loss decreased (-0.631571 --> -0.671045).  Saving model ...
Epoch: 14 cost time: 2.448197603225708
Epoch: 14, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.739 Vali Acc: 0.664 Test Loss: 0.739 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2134432792663574
Epoch: 15, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.720 Vali Acc: 0.704 Test Loss: 0.720 Test Acc: 0.704
Validation loss decreased (-0.671045 --> -0.703940).  Saving model ...
Epoch: 16 cost time: 1.9823980331420898
Epoch: 16, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.703 Vali Acc: 0.711 Test Loss: 0.703 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 17 cost time: 2.190701961517334
Epoch: 17, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.699 Vali Acc: 0.737 Test Loss: 0.699 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736835).  Saving model ...
Epoch: 18 cost time: 2.338538885116577
Epoch: 18, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.176145553588867
Epoch: 19, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.708 Vali Acc: 0.724 Test Loss: 0.708 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3028788566589355
Epoch: 20, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.699 Vali Acc: 0.730 Test Loss: 0.699 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.196476697921753
Epoch: 21, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.712 Vali Acc: 0.730 Test Loss: 0.712 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.160966396331787
Epoch: 22, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.730 Vali Acc: 0.717 Test Loss: 0.730 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.242152214050293
Epoch: 23, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.729 Vali Acc: 0.724 Test Loss: 0.729 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.333240270614624
Epoch: 24, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.759 Vali Acc: 0.704 Test Loss: 0.759 Test Acc: 0.704
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.2572598457336426
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.777 Vali Acc: 0.717 Test Loss: 0.777 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.168020725250244
Epoch: 26, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.798 Vali Acc: 0.724 Test Loss: 0.798 Test Acc: 0.724
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.3796021938323975
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.797 Vali Acc: 0.743 Test Loss: 0.797 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743413).  Saving model ...
Epoch: 28 cost time: 2.269348382949829
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.809 Vali Acc: 0.730 Test Loss: 0.809 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3874521255493164
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.821 Vali Acc: 0.730 Test Loss: 0.821 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.255784273147583
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.830 Vali Acc: 0.730 Test Loss: 0.830 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.3517227172851562
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.828 Vali Acc: 0.743 Test Loss: 0.828 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.228299856185913
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.826 Vali Acc: 0.757 Test Loss: 0.826 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756571).  Saving model ...
Epoch: 33 cost time: 2.3319342136383057
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.152919054031372
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.856 Vali Acc: 0.757 Test Loss: 0.856 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.2228035926818848
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.3086681365966797
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.861 Vali Acc: 0.743 Test Loss: 0.861 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.074313163757324
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.865 Vali Acc: 0.743 Test Loss: 0.865 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.2586829662323
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.875 Vali Acc: 0.750 Test Loss: 0.875 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.3441991806030273
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.894 Vali Acc: 0.750 Test Loss: 0.894 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.990473747253418
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.927 Vali Acc: 0.743 Test Loss: 0.927 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.0230116844177246
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.924 Vali Acc: 0.750 Test Loss: 0.924 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.254300832748413
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.899 Vali Acc: 0.757 Test Loss: 0.899 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.756578947368421
model parameter : 893636
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.053908824920654
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.417 Vali Acc: 0.250 Test Loss: 1.417 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 2.352041244506836
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.371 Vali Acc: 0.316 Test Loss: 1.371 Test Acc: 0.316
Validation loss decreased (-0.249986 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 2.3024673461914062
Epoch: 3, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.330 Vali Acc: 0.309 Test Loss: 1.330 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1841487884521484
Epoch: 4, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.293 Vali Acc: 0.349 Test Loss: 1.293 Test Acc: 0.349
Validation loss decreased (-0.315776 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 1.9520111083984375
Epoch: 5, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.248 Vali Acc: 0.388 Test Loss: 1.248 Test Acc: 0.388
Validation loss decreased (-0.348671 --> -0.388145).  Saving model ...
Epoch: 6 cost time: 1.898146629333496
Epoch: 6, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.201 Vali Acc: 0.447 Test Loss: 1.201 Test Acc: 0.447
Validation loss decreased (-0.388145 --> -0.447356).  Saving model ...
Epoch: 7 cost time: 2.0775904655456543
Epoch: 7, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.150 Vali Acc: 0.507 Test Loss: 1.150 Test Acc: 0.507
Validation loss decreased (-0.447356 --> -0.506567).  Saving model ...
Epoch: 8 cost time: 2.0661351680755615
Epoch: 8, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.097 Vali Acc: 0.539 Test Loss: 1.097 Test Acc: 0.539
Validation loss decreased (-0.506567 --> -0.539463).  Saving model ...
Epoch: 9 cost time: 2.1894774436950684
Epoch: 9, Steps: 10 | Train Loss: 0.814 Vali Loss: 1.036 Vali Acc: 0.572 Test Loss: 1.036 Test Acc: 0.572
Validation loss decreased (-0.539463 --> -0.572358).  Saving model ...
Epoch: 10 cost time: 2.2202308177948
Epoch: 10, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.965 Vali Acc: 0.572 Test Loss: 0.965 Test Acc: 0.572
Validation loss decreased (-0.572358 --> -0.572359).  Saving model ...
Epoch: 11 cost time: 2.218508005142212
Epoch: 11, Steps: 10 | Train Loss: 0.630 Vali Loss: 0.881 Vali Acc: 0.638 Test Loss: 0.881 Test Acc: 0.638
Validation loss decreased (-0.572359 --> -0.638149).  Saving model ...
Epoch: 12 cost time: 2.0432212352752686
Epoch: 12, Steps: 10 | Train Loss: 0.485 Vali Loss: 0.812 Vali Acc: 0.671 Test Loss: 0.812 Test Acc: 0.671
Validation loss decreased (-0.638149 --> -0.671045).  Saving model ...
Epoch: 13 cost time: 2.0675365924835205
Epoch: 13, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.756 Vali Acc: 0.704 Test Loss: 0.756 Test Acc: 0.704
Validation loss decreased (-0.671045 --> -0.703940).  Saving model ...
Epoch: 14 cost time: 1.9629619121551514
Epoch: 14, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.722 Vali Acc: 0.717 Test Loss: 0.722 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 15 cost time: 2.329101085662842
Epoch: 15, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.705 Vali Acc: 0.724 Test Loss: 0.705 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 16 cost time: 2.2195184230804443
Epoch: 16, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.686 Vali Acc: 0.724 Test Loss: 0.686 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 17 cost time: 2.197505474090576
Epoch: 17, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.676 Vali Acc: 0.743 Test Loss: 0.676 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 18 cost time: 2.758904218673706
Epoch: 18, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.680 Vali Acc: 0.743 Test Loss: 0.680 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.26998233795166
Epoch: 19, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.674 Vali Acc: 0.750 Test Loss: 0.674 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 20 cost time: 2.1964497566223145
Epoch: 20, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.677 Vali Acc: 0.757 Test Loss: 0.677 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 21 cost time: 2.1157920360565186
Epoch: 21, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.676 Vali Acc: 0.750 Test Loss: 0.676 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1252601146698
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.672 Vali Acc: 0.750 Test Loss: 0.672 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1096274852752686
Epoch: 23, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.662 Vali Acc: 0.750 Test Loss: 0.662 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9941935539245605
Epoch: 24, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.674 Vali Acc: 0.750 Test Loss: 0.674 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.2053864002227783
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.698 Vali Acc: 0.750 Test Loss: 0.698 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.145799398422241
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.712 Vali Acc: 0.750 Test Loss: 0.712 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9412407875061035
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.717 Vali Acc: 0.750 Test Loss: 0.717 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.0633182525634766
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.733 Vali Acc: 0.743 Test Loss: 0.733 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.0570106506347656
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.746 Vali Acc: 0.750 Test Loss: 0.746 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.1086204051971436
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.757 Vali Acc: 0.757 Test Loss: 0.757 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.756578947368421
model parameter : 893636
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.091534376144409
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.155200719833374
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 2.026982069015503
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 2.09084415435791
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 5 cost time: 2.163851022720337
Epoch: 5, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 6 cost time: 2.278665781021118
Epoch: 6, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 7 cost time: 2.060788154602051
Epoch: 7, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 8 cost time: 2.4476253986358643
Epoch: 8, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 9 cost time: 2.1066734790802
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 10 cost time: 2.2475855350494385
Epoch: 10, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 11 cost time: 2.1302807331085205
Epoch: 11, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 12 cost time: 2.188096761703491
Epoch: 12, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 13 cost time: 2.363412618637085
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 14 cost time: 2.216308116912842
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 15 cost time: 2.276773452758789
Epoch: 15, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 16 cost time: 2.3194680213928223
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 17 cost time: 2.3313212394714355
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 18 cost time: 2.4501993656158447
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 19 cost time: 2.1867973804473877
Epoch: 19, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 20 cost time: 2.210480213165283
Epoch: 20, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 21 cost time: 2.0994060039520264
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 22 cost time: 2.220247983932495
Epoch: 22, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 23 cost time: 2.1087594032287598
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 24 cost time: 2.2669527530670166
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 25 cost time: 1.950418472290039
Epoch: 25, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 26 cost time: 2.353151321411133
Epoch: 26, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 27 cost time: 2.116607427597046
Epoch: 27, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.056304693222046
Epoch: 28, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 29 cost time: 2.2374532222747803
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 30 cost time: 2.1644699573516846
Epoch: 30, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0638411045074463
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 32 cost time: 2.0990750789642334
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 33 cost time: 2.360107421875
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 34 cost time: 2.227651357650757
Epoch: 34, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 35 cost time: 2.3985021114349365
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 36 cost time: 2.266653537750244
Epoch: 36, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 37 cost time: 2.3506672382354736
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 38 cost time: 2.255211114883423
Epoch: 38, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 39 cost time: 2.186361312866211
Epoch: 39, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 40 cost time: 2.3032071590423584
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.239365339279175
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 42 cost time: 2.100314140319824
Epoch: 42, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 43 cost time: 1.976050615310669
Epoch: 43, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 44 cost time: 2.192854166030884
Epoch: 44, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 45 cost time: 1.9108786582946777
Epoch: 45, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 46 cost time: 2.2033209800720215
Epoch: 46, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 47 cost time: 2.0143651962280273
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.263144 --> -0.282881).  Saving model ...
Epoch: 48 cost time: 2.072472333908081
Epoch: 48, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.1822211742401123
Epoch: 49, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 1.9780285358428955
Epoch: 50, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.270793914794922
Epoch: 51, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 52 cost time: 2.286555767059326
Epoch: 52, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 53 cost time: 2.320894956588745
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 2.200254201889038
Epoch: 54, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 55 cost time: 2.159602165222168
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 56 cost time: 2.193330764770508
Epoch: 56, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 57 cost time: 2.280747652053833
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.279881238937378
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 59 cost time: 2.2324275970458984
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 60 cost time: 2.1263253688812256
Epoch: 60, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 61 cost time: 2.142306327819824
Epoch: 61, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 62 cost time: 2.159189224243164
Epoch: 62, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 63 cost time: 2.1551594734191895
Epoch: 63, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.123943567276001
Epoch: 64, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.082794189453125
Epoch: 65, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 2.0040104389190674
Epoch: 66, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 2.2097151279449463
Epoch: 67, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 2.2141482830047607
Epoch: 68, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 2.145962953567505
Epoch: 69, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 2.1645901203155518
Epoch: 70, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 2.2163918018341064
Epoch: 71, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 2.216364622116089
Epoch: 72, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 893636
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8616976737976074
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.336 Vali Acc: 0.322 Test Loss: 1.336 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 2.108067750930786
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.248 Vali Acc: 0.454 Test Loss: 1.248 Test Acc: 0.454
Validation loss decreased (-0.322355 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 1.978813886642456
Epoch: 3, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.144 Vali Acc: 0.579 Test Loss: 1.144 Test Acc: 0.579
Validation loss decreased (-0.453935 --> -0.578936).  Saving model ...
Epoch: 4 cost time: 2.015848159790039
Epoch: 4, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.054 Vali Acc: 0.638 Test Loss: 1.054 Test Acc: 0.638
Validation loss decreased (-0.578936 --> -0.638147).  Saving model ...
Epoch: 5 cost time: 2.084885835647583
Epoch: 5, Steps: 10 | Train Loss: 0.892 Vali Loss: 0.976 Vali Acc: 0.651 Test Loss: 0.976 Test Acc: 0.651
Validation loss decreased (-0.638147 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 2.0189943313598633
Epoch: 6, Steps: 10 | Train Loss: 0.752 Vali Loss: 0.918 Vali Acc: 0.658 Test Loss: 0.918 Test Acc: 0.658
Validation loss decreased (-0.651306 --> -0.657886).  Saving model ...
Epoch: 7 cost time: 2.1379659175872803
Epoch: 7, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.873 Vali Acc: 0.658 Test Loss: 0.873 Test Acc: 0.658
Validation loss decreased (-0.657886 --> -0.657886).  Saving model ...
Epoch: 8 cost time: 2.1671829223632812
Epoch: 8, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.841 Vali Acc: 0.678 Test Loss: 0.841 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 2.117168664932251
Epoch: 9, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.804 Vali Acc: 0.704 Test Loss: 0.804 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703939).  Saving model ...
Epoch: 10 cost time: 2.3495428562164307
Epoch: 10, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.767 Vali Acc: 0.717 Test Loss: 0.767 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 2.2802531719207764
Epoch: 11, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.731 Vali Acc: 0.724 Test Loss: 0.731 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 12 cost time: 2.1647260189056396
Epoch: 12, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.702 Vali Acc: 0.743 Test Loss: 0.702 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 13 cost time: 2.0906741619110107
Epoch: 13, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.672 Vali Acc: 0.763 Test Loss: 0.672 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763151).  Saving model ...
Epoch: 14 cost time: 2.2613346576690674
Epoch: 14, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.657 Vali Acc: 0.763 Test Loss: 0.657 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 15 cost time: 2.2065060138702393
Epoch: 15, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.626 Vali Acc: 0.763 Test Loss: 0.626 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 2.1465392112731934
Epoch: 16, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.612 Vali Acc: 0.783 Test Loss: 0.612 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.8991782665252686
Epoch: 17, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.946749210357666
Epoch: 18, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0156028270721436
Epoch: 19, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.607 Vali Acc: 0.783 Test Loss: 0.607 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1314926147460938
Epoch: 20, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.597 Vali Acc: 0.796 Test Loss: 0.597 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0970723628997803
Epoch: 21, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 22 cost time: 2.067180633544922
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9962103366851807
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.614 Vali Acc: 0.803 Test Loss: 0.614 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0128960609436035
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.622 Vali Acc: 0.796 Test Loss: 0.622 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.095546245574951
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.631 Vali Acc: 0.796 Test Loss: 0.631 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9966232776641846
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0594143867492676
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 28 cost time: 2.1598546504974365
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.649 Vali Acc: 0.796 Test Loss: 0.649 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.091548442840576
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.660 Vali Acc: 0.809 Test Loss: 0.660 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.2715303897857666
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.670 Vali Acc: 0.809 Test Loss: 0.670 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.2123935222625732
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.683 Vali Acc: 0.803 Test Loss: 0.683 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.153282880783081
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.696 Vali Acc: 0.803 Test Loss: 0.696 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.143165111541748
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.706 Vali Acc: 0.803 Test Loss: 0.706 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.2690420150756836
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.725 Vali Acc: 0.803 Test Loss: 0.725 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.0852530002593994
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.739 Vali Acc: 0.803 Test Loss: 0.739 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.159886360168457
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.730 Vali Acc: 0.809 Test Loss: 0.730 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.0610668659210205
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.731 Vali Acc: 0.796 Test Loss: 0.731 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 500420
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9593989849090576
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.344 Vali Acc: 0.368 Test Loss: 1.344 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 1.9525477886199951
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.265 Vali Acc: 0.428 Test Loss: 1.265 Test Acc: 0.428
Validation loss decreased (-0.368408 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 2.03916597366333
Epoch: 3, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.172 Vali Acc: 0.586 Test Loss: 1.172 Test Acc: 0.586
Validation loss decreased (-0.427619 --> -0.585515).  Saving model ...
Epoch: 4 cost time: 1.8434505462646484
Epoch: 4, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.086 Vali Acc: 0.632 Test Loss: 1.086 Test Acc: 0.632
Validation loss decreased (-0.585515 --> -0.631568).  Saving model ...
Epoch: 5 cost time: 2.081017255783081
Epoch: 5, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.008 Vali Acc: 0.651 Test Loss: 1.008 Test Acc: 0.651
Validation loss decreased (-0.631568 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 2.180788040161133
Epoch: 6, Steps: 10 | Train Loss: 0.823 Vali Loss: 0.951 Vali Acc: 0.658 Test Loss: 0.951 Test Acc: 0.658
Validation loss decreased (-0.651306 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 2.0857012271881104
Epoch: 7, Steps: 10 | Train Loss: 0.703 Vali Loss: 0.901 Vali Acc: 0.697 Test Loss: 0.901 Test Acc: 0.697
Validation loss decreased (-0.657885 --> -0.697359).  Saving model ...
Epoch: 8 cost time: 2.110645055770874
Epoch: 8, Steps: 10 | Train Loss: 0.596 Vali Loss: 0.864 Vali Acc: 0.704 Test Loss: 0.864 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703939).  Saving model ...
Epoch: 9 cost time: 2.292858362197876
Epoch: 9, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.822 Vali Acc: 0.704 Test Loss: 0.822 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703939).  Saving model ...
Epoch: 10 cost time: 2.210057497024536
Epoch: 10, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.785 Vali Acc: 0.717 Test Loss: 0.785 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717097).  Saving model ...
Epoch: 11 cost time: 2.1550960540771484
Epoch: 11, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.739 Vali Acc: 0.737 Test Loss: 0.739 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 2.0838260650634766
Epoch: 12, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.710 Vali Acc: 0.743 Test Loss: 0.710 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 13 cost time: 2.056715965270996
Epoch: 13, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.682 Vali Acc: 0.737 Test Loss: 0.682 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1782350540161133
Epoch: 14, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.660 Vali Acc: 0.750 Test Loss: 0.660 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 2.0434160232543945
Epoch: 15, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 2.0560004711151123
Epoch: 16, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.607 Vali Acc: 0.763 Test Loss: 0.607 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.9655215740203857
Epoch: 17, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.9657816886901855
Epoch: 18, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.597 Vali Acc: 0.763 Test Loss: 0.597 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.066002130508423
Epoch: 19, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 20 cost time: 2.1004717350006104
Epoch: 20, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 21 cost time: 2.1780905723571777
Epoch: 21, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 22 cost time: 2.1339211463928223
Epoch: 22, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0312559604644775
Epoch: 23, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.610 Vali Acc: 0.783 Test Loss: 0.610 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.113250494003296
Epoch: 24, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.617 Vali Acc: 0.783 Test Loss: 0.617 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0356662273406982
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.622 Vali Acc: 0.783 Test Loss: 0.622 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.1185052394866943
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.629 Vali Acc: 0.783 Test Loss: 0.629 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.1365983486175537
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 28 cost time: 2.136737108230591
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.650 Vali Acc: 0.803 Test Loss: 0.650 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 29 cost time: 2.1045968532562256
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.660 Vali Acc: 0.803 Test Loss: 0.660 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.969050407409668
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9309163093566895
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9965236186981201
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.9788947105407715
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.706 Vali Acc: 0.803 Test Loss: 0.706 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.0280561447143555
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.721 Vali Acc: 0.796 Test Loss: 0.721 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.127260684967041
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.734 Vali Acc: 0.796 Test Loss: 0.734 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.094231128692627
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.735 Vali Acc: 0.796 Test Loss: 0.735 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.133445978164673
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.740 Vali Acc: 0.796 Test Loss: 0.740 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.132344961166382
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.751 Vali Acc: 0.796 Test Loss: 0.751 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 500420
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.346467733383179
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.368 Vali Acc: 0.289 Test Loss: 1.368 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.1044070720672607
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.314 Vali Acc: 0.329 Test Loss: 1.314 Test Acc: 0.329
Validation loss decreased (-0.289460 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 2.20247220993042
Epoch: 3, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.246 Vali Acc: 0.421 Test Loss: 1.246 Test Acc: 0.421
Validation loss decreased (-0.328934 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 2.337697982788086
Epoch: 4, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.176 Vali Acc: 0.526 Test Loss: 1.176 Test Acc: 0.526
Validation loss decreased (-0.421040 --> -0.526304).  Saving model ...
Epoch: 5 cost time: 2.1407876014709473
Epoch: 5, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.106 Vali Acc: 0.599 Test Loss: 1.106 Test Acc: 0.599
Validation loss decreased (-0.526304 --> -0.598673).  Saving model ...
Epoch: 6 cost time: 2.0805675983428955
Epoch: 6, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.043 Vali Acc: 0.625 Test Loss: 1.043 Test Acc: 0.625
Validation loss decreased (-0.598673 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 2.0145328044891357
Epoch: 7, Steps: 10 | Train Loss: 0.852 Vali Loss: 0.983 Vali Acc: 0.645 Test Loss: 0.983 Test Acc: 0.645
Validation loss decreased (-0.624990 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 2.2013447284698486
Epoch: 8, Steps: 10 | Train Loss: 0.724 Vali Loss: 0.929 Vali Acc: 0.645 Test Loss: 0.929 Test Acc: 0.645
Validation loss decreased (-0.644727 --> -0.644728).  Saving model ...
Epoch: 9 cost time: 2.0685391426086426
Epoch: 9, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.873 Vali Acc: 0.684 Test Loss: 0.873 Test Acc: 0.684
Validation loss decreased (-0.644728 --> -0.684202).  Saving model ...
Epoch: 10 cost time: 2.0701494216918945
Epoch: 10, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.822 Vali Acc: 0.697 Test Loss: 0.822 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697360).  Saving model ...
Epoch: 11 cost time: 2.074930429458618
Epoch: 11, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.773 Vali Acc: 0.724 Test Loss: 0.773 Test Acc: 0.724
Validation loss decreased (-0.697360 --> -0.723676).  Saving model ...
Epoch: 12 cost time: 2.123248815536499
Epoch: 12, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.733 Vali Acc: 0.737 Test Loss: 0.733 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736835).  Saving model ...
Epoch: 13 cost time: 1.9543945789337158
Epoch: 13, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.694 Vali Acc: 0.737 Test Loss: 0.694 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 14 cost time: 1.9152345657348633
Epoch: 14, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.664 Vali Acc: 0.730 Test Loss: 0.664 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.012983560562134
Epoch: 15, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.634 Vali Acc: 0.757 Test Loss: 0.634 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 16 cost time: 2.2441866397857666
Epoch: 16, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.045726776123047
Epoch: 17, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.596 Vali Acc: 0.743 Test Loss: 0.596 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.009385347366333
Epoch: 18, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.594 Vali Acc: 0.743 Test Loss: 0.594 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.981494665145874
Epoch: 19, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.597 Vali Acc: 0.757 Test Loss: 0.597 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 20 cost time: 2.1779792308807373
Epoch: 20, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.604 Vali Acc: 0.750 Test Loss: 0.604 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.105029821395874
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.600 Vali Acc: 0.770 Test Loss: 0.600 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 22 cost time: 2.0712342262268066
Epoch: 22, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.605 Vali Acc: 0.770 Test Loss: 0.605 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.184946060180664
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.603 Vali Acc: 0.776 Test Loss: 0.603 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 2.247222661972046
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.209609270095825
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.628 Vali Acc: 0.763 Test Loss: 0.628 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.137885093688965
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.635 Vali Acc: 0.763 Test Loss: 0.635 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1987569332122803
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.638 Vali Acc: 0.770 Test Loss: 0.638 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.273247003555298
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.647 Vali Acc: 0.776 Test Loss: 0.647 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.3011314868927
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.656 Vali Acc: 0.776 Test Loss: 0.656 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.113661289215088
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.667 Vali Acc: 0.776 Test Loss: 0.667 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.953613519668579
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.680 Vali Acc: 0.776 Test Loss: 0.680 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.190425157546997
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.694 Vali Acc: 0.776 Test Loss: 0.694 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9906697273254395
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.695 Vali Acc: 0.783 Test Loss: 0.695 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 34 cost time: 2.0378634929656982
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.703 Vali Acc: 0.789 Test Loss: 0.703 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 35 cost time: 1.9115304946899414
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.715 Vali Acc: 0.776 Test Loss: 0.715 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0327179431915283
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.724 Vali Acc: 0.783 Test Loss: 0.724 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.922468900680542
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.1316752433776855
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.2418696880340576
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.748 Vali Acc: 0.776 Test Loss: 0.748 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.214195966720581
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.748 Vali Acc: 0.783 Test Loss: 0.748 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.182629108428955
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.749 Vali Acc: 0.783 Test Loss: 0.749 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.1441516876220703
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.760 Vali Acc: 0.783 Test Loss: 0.760 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.1137020587921143
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.772 Vali Acc: 0.783 Test Loss: 0.772 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.157306432723999
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.779 Vali Acc: 0.783 Test Loss: 0.779 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 500420
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9934659004211426
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.397 Vali Acc: 0.224 Test Loss: 1.397 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 2.138576030731201
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.360 Vali Acc: 0.283 Test Loss: 1.360 Test Acc: 0.283
Validation loss decreased (-0.223670 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 2.0709540843963623
Epoch: 3, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.311 Vali Acc: 0.368 Test Loss: 1.311 Test Acc: 0.368
Validation loss decreased (-0.282881 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 2.1258063316345215
Epoch: 4, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.258 Vali Acc: 0.434 Test Loss: 1.258 Test Acc: 0.434
Validation loss decreased (-0.368408 --> -0.434198).  Saving model ...
Epoch: 5 cost time: 2.288837194442749
Epoch: 5, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.206 Vali Acc: 0.487 Test Loss: 1.206 Test Acc: 0.487
Validation loss decreased (-0.434198 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 2.217071771621704
Epoch: 6, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.156 Vali Acc: 0.513 Test Loss: 1.156 Test Acc: 0.513
Validation loss decreased (-0.486830 --> -0.513146).  Saving model ...
Epoch: 7 cost time: 2.309316873550415
Epoch: 7, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.106 Vali Acc: 0.546 Test Loss: 1.106 Test Acc: 0.546
Validation loss decreased (-0.513146 --> -0.546042).  Saving model ...
Epoch: 8 cost time: 2.404365301132202
Epoch: 8, Steps: 10 | Train Loss: 0.798 Vali Loss: 1.052 Vali Acc: 0.579 Test Loss: 1.052 Test Acc: 0.579
Validation loss decreased (-0.546042 --> -0.578937).  Saving model ...
Epoch: 9 cost time: 2.4053492546081543
Epoch: 9, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.994 Vali Acc: 0.599 Test Loss: 0.994 Test Acc: 0.599
Validation loss decreased (-0.578937 --> -0.598674).  Saving model ...
Epoch: 10 cost time: 2.3510708808898926
Epoch: 10, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.934 Vali Acc: 0.632 Test Loss: 0.934 Test Acc: 0.632
Validation loss decreased (-0.598674 --> -0.631570).  Saving model ...
Epoch: 11 cost time: 2.2872931957244873
Epoch: 11, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.862 Vali Acc: 0.645 Test Loss: 0.862 Test Acc: 0.645
Validation loss decreased (-0.631570 --> -0.644728).  Saving model ...
Epoch: 12 cost time: 2.4023473262786865
Epoch: 12, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.795 Vali Acc: 0.684 Test Loss: 0.795 Test Acc: 0.684
Validation loss decreased (-0.644728 --> -0.684203).  Saving model ...
Epoch: 13 cost time: 1.9672503471374512
Epoch: 13, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.739 Vali Acc: 0.678 Test Loss: 0.739 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1715292930603027
Epoch: 14, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.688 Vali Acc: 0.691 Test Loss: 0.688 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690783).  Saving model ...
Epoch: 15 cost time: 2.123260498046875
Epoch: 15, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.647 Vali Acc: 0.743 Test Loss: 0.647 Test Acc: 0.743
Validation loss decreased (-0.690783 --> -0.743415).  Saving model ...
Epoch: 16 cost time: 2.229012966156006
Epoch: 16, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.624 Vali Acc: 0.743 Test Loss: 0.624 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 17 cost time: 2.1630423069000244
Epoch: 17, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.596 Vali Acc: 0.770 Test Loss: 0.596 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 18 cost time: 2.156686305999756
Epoch: 18, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 2.51789927482605
Epoch: 19, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.568 Vali Acc: 0.770 Test Loss: 0.568 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4085605144500732
Epoch: 20, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 21 cost time: 2.3403737545013428
Epoch: 21, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 22 cost time: 2.227323293685913
Epoch: 22, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.569 Vali Acc: 0.763 Test Loss: 0.569 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.299623966217041
Epoch: 23, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.261383533477783
Epoch: 24, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.586 Vali Acc: 0.776 Test Loss: 0.586 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.3034582138061523
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0932841300964355
Epoch: 26, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.597 Vali Acc: 0.750 Test Loss: 0.597 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.3258986473083496
Epoch: 27, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.600 Vali Acc: 0.757 Test Loss: 0.600 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.2486021518707275
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.605 Vali Acc: 0.770 Test Loss: 0.605 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.1169724464416504
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.608 Vali Acc: 0.770 Test Loss: 0.608 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.1607744693756104
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.613 Vali Acc: 0.763 Test Loss: 0.613 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.1836369037628174
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.625 Vali Acc: 0.776 Test Loss: 0.625 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 500420
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.089277267456055
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.441 Vali Acc: 0.217 Test Loss: 1.441 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 2.0987305641174316
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.421 Vali Acc: 0.230 Test Loss: 1.421 Test Acc: 0.230
Validation loss decreased (-0.217091 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 2.354311227798462
Epoch: 3, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.397 Vali Acc: 0.263 Test Loss: 1.397 Test Acc: 0.263
Validation loss decreased (-0.230249 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 2.230018377304077
Epoch: 4, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.366 Vali Acc: 0.316 Test Loss: 1.366 Test Acc: 0.316
Validation loss decreased (-0.263144 --> -0.315776).  Saving model ...
Epoch: 5 cost time: 2.083562135696411
Epoch: 5, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.332 Vali Acc: 0.342 Test Loss: 1.332 Test Acc: 0.342
Validation loss decreased (-0.315776 --> -0.342092).  Saving model ...
Epoch: 6 cost time: 2.286167621612549
Epoch: 6, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.294 Vali Acc: 0.375 Test Loss: 1.294 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.9408519268035889
Epoch: 7, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.248 Vali Acc: 0.401 Test Loss: 1.248 Test Acc: 0.401
Validation loss decreased (-0.374987 --> -0.401303).  Saving model ...
Epoch: 8 cost time: 1.9781239032745361
Epoch: 8, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.194 Vali Acc: 0.428 Test Loss: 1.194 Test Acc: 0.428
Validation loss decreased (-0.401303 --> -0.427620).  Saving model ...
Epoch: 9 cost time: 1.9421212673187256
Epoch: 9, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.129 Vali Acc: 0.507 Test Loss: 1.129 Test Acc: 0.507
Validation loss decreased (-0.427620 --> -0.506568).  Saving model ...
Epoch: 10 cost time: 1.8653125762939453
Epoch: 10, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.052 Vali Acc: 0.553 Test Loss: 1.052 Test Acc: 0.553
Validation loss decreased (-0.506568 --> -0.552621).  Saving model ...
Epoch: 11 cost time: 2.0285913944244385
Epoch: 11, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.960 Vali Acc: 0.632 Test Loss: 0.960 Test Acc: 0.632
Validation loss decreased (-0.552621 --> -0.631569).  Saving model ...
Epoch: 12 cost time: 2.061703681945801
Epoch: 12, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.875 Vali Acc: 0.671 Test Loss: 0.875 Test Acc: 0.671
Validation loss decreased (-0.631569 --> -0.671044).  Saving model ...
Epoch: 13 cost time: 2.0904858112335205
Epoch: 13, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.798 Vali Acc: 0.671 Test Loss: 0.798 Test Acc: 0.671
Validation loss decreased (-0.671044 --> -0.671045).  Saving model ...
Epoch: 14 cost time: 1.8538837432861328
Epoch: 14, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.741 Vali Acc: 0.717 Test Loss: 0.741 Test Acc: 0.717
Validation loss decreased (-0.671045 --> -0.717098).  Saving model ...
Epoch: 15 cost time: 2.078296661376953
Epoch: 15, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.686 Vali Acc: 0.724 Test Loss: 0.686 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 16 cost time: 2.1033778190612793
Epoch: 16, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.673 Vali Acc: 0.743 Test Loss: 0.673 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 17 cost time: 2.185986280441284
Epoch: 17, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.650 Vali Acc: 0.737 Test Loss: 0.650 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1435775756835938
Epoch: 18, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.655 Vali Acc: 0.750 Test Loss: 0.655 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 19 cost time: 2.2534825801849365
Epoch: 19, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.665 Vali Acc: 0.737 Test Loss: 0.665 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3004915714263916
Epoch: 20, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.669 Vali Acc: 0.737 Test Loss: 0.669 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.164889335632324
Epoch: 21, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.681 Vali Acc: 0.737 Test Loss: 0.681 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.318268299102783
Epoch: 22, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.713 Vali Acc: 0.737 Test Loss: 0.713 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.2089171409606934
Epoch: 23, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.709 Vali Acc: 0.750 Test Loss: 0.709 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9639770984649658
Epoch: 24, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.731 Vali Acc: 0.750 Test Loss: 0.731 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8980870246887207
Epoch: 25, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.738 Vali Acc: 0.750 Test Loss: 0.738 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.1278038024902344
Epoch: 26, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.893207311630249
Epoch: 27, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.770 Vali Acc: 0.757 Test Loss: 0.770 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756571).  Saving model ...
Epoch: 28 cost time: 1.9310309886932373
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.818 Vali Acc: 0.737 Test Loss: 0.818 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0082569122314453
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.787 Vali Acc: 0.757 Test Loss: 0.787 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9578273296356201
Epoch: 30, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.800 Vali Acc: 0.757 Test Loss: 0.800 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.934584379196167
Epoch: 31, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.0760459899902344
Epoch: 32, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.847 Vali Acc: 0.763 Test Loss: 0.847 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763149).  Saving model ...
Epoch: 33 cost time: 2.1437251567840576
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.819 Vali Acc: 0.776 Test Loss: 0.819 Test Acc: 0.776
Validation loss decreased (-0.763149 --> -0.776308).  Saving model ...
Epoch: 34 cost time: 2.1516919136047363
Epoch: 34, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.836 Vali Acc: 0.770 Test Loss: 0.836 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.1932828426361084
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.859 Vali Acc: 0.763 Test Loss: 0.859 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.2167422771453857
Epoch: 36, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.894 Vali Acc: 0.750 Test Loss: 0.894 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.1333959102630615
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.909 Vali Acc: 0.757 Test Loss: 0.909 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.3479371070861816
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.935 Vali Acc: 0.770 Test Loss: 0.935 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.2015185356140137
Epoch: 39, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.950 Vali Acc: 0.770 Test Loss: 0.950 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.135624885559082
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.975 Vali Acc: 0.770 Test Loss: 0.975 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.9587538242340088
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.951 Vali Acc: 0.763 Test Loss: 0.951 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.120988607406616
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.938 Vali Acc: 0.763 Test Loss: 0.938 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.861896276473999
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.942 Vali Acc: 0.770 Test Loss: 0.942 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 500420
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.994565963745117
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.438 Vali Acc: 0.250 Test Loss: 1.438 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 2.495366334915161
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.418 Vali Acc: 0.270 Test Loss: 1.418 Test Acc: 0.270
Validation loss decreased (-0.249986 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 2.4160590171813965
Epoch: 3, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.393 Vali Acc: 0.289 Test Loss: 1.393 Test Acc: 0.289
Validation loss decreased (-0.269723 --> -0.289460).  Saving model ...
Epoch: 4 cost time: 2.189467191696167
Epoch: 4, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.362 Vali Acc: 0.303 Test Loss: 1.362 Test Acc: 0.303
Validation loss decreased (-0.289460 --> -0.302618).  Saving model ...
Epoch: 5 cost time: 2.181431531906128
Epoch: 5, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.329 Vali Acc: 0.342 Test Loss: 1.329 Test Acc: 0.342
Validation loss decreased (-0.302618 --> -0.342092).  Saving model ...
Epoch: 6 cost time: 2.0575785636901855
Epoch: 6, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.295 Vali Acc: 0.395 Test Loss: 1.295 Test Acc: 0.395
Validation loss decreased (-0.342092 --> -0.394724).  Saving model ...
Epoch: 7 cost time: 2.283031702041626
Epoch: 7, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.247 Vali Acc: 0.454 Test Loss: 1.247 Test Acc: 0.454
Validation loss decreased (-0.394724 --> -0.453935).  Saving model ...
Epoch: 8 cost time: 2.147751808166504
Epoch: 8, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.195 Vali Acc: 0.487 Test Loss: 1.195 Test Acc: 0.487
Validation loss decreased (-0.453935 --> -0.486830).  Saving model ...
Epoch: 9 cost time: 2.2709503173828125
Epoch: 9, Steps: 10 | Train Loss: 0.892 Vali Loss: 1.134 Vali Acc: 0.513 Test Loss: 1.134 Test Acc: 0.513
Validation loss decreased (-0.486830 --> -0.513147).  Saving model ...
Epoch: 10 cost time: 2.356468677520752
Epoch: 10, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.069 Vali Acc: 0.559 Test Loss: 1.069 Test Acc: 0.559
Validation loss decreased (-0.513147 --> -0.559200).  Saving model ...
Epoch: 11 cost time: 2.214348554611206
Epoch: 11, Steps: 10 | Train Loss: 0.711 Vali Loss: 0.982 Vali Acc: 0.592 Test Loss: 0.982 Test Acc: 0.592
Validation loss decreased (-0.559200 --> -0.592095).  Saving model ...
Epoch: 12 cost time: 1.9946937561035156
Epoch: 12, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.899 Vali Acc: 0.651 Test Loss: 0.899 Test Acc: 0.651
Validation loss decreased (-0.592095 --> -0.651307).  Saving model ...
Epoch: 13 cost time: 2.3068935871124268
Epoch: 13, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.824 Vali Acc: 0.658 Test Loss: 0.824 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657887).  Saving model ...
Epoch: 14 cost time: 2.1890783309936523
Epoch: 14, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.767 Vali Acc: 0.697 Test Loss: 0.767 Test Acc: 0.697
Validation loss decreased (-0.657887 --> -0.697361).  Saving model ...
Epoch: 15 cost time: 2.251095771789551
Epoch: 15, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.716 Vali Acc: 0.704 Test Loss: 0.716 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 16 cost time: 2.2426810264587402
Epoch: 16, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.691 Vali Acc: 0.724 Test Loss: 0.691 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 17 cost time: 2.4297494888305664
Epoch: 17, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.665 Vali Acc: 0.737 Test Loss: 0.665 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 18 cost time: 2.365463972091675
Epoch: 18, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 19 cost time: 2.215259552001953
Epoch: 19, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.661 Vali Acc: 0.750 Test Loss: 0.661 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1894917488098145
Epoch: 20, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.670 Vali Acc: 0.757 Test Loss: 0.670 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 21 cost time: 2.2475976943969727
Epoch: 21, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.686 Vali Acc: 0.737 Test Loss: 0.686 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2482187747955322
Epoch: 22, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.701 Vali Acc: 0.750 Test Loss: 0.701 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.488659381866455
Epoch: 23, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.690 Vali Acc: 0.763 Test Loss: 0.690 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 24 cost time: 2.2249999046325684
Epoch: 24, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.701 Vali Acc: 0.763 Test Loss: 0.701 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0670480728149414
Epoch: 25, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.706 Vali Acc: 0.770 Test Loss: 0.706 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 26 cost time: 2.405360460281372
Epoch: 26, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.706 Vali Acc: 0.763 Test Loss: 0.706 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.04561185836792
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.718 Vali Acc: 0.770 Test Loss: 0.718 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8584938049316406
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.748 Vali Acc: 0.763 Test Loss: 0.748 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0202982425689697
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.757 Vali Acc: 0.763 Test Loss: 0.757 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.049051523208618
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.771 Vali Acc: 0.763 Test Loss: 0.771 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.140876293182373
Epoch: 31, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.781 Vali Acc: 0.770 Test Loss: 0.781 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.093170166015625
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.794 Vali Acc: 0.763 Test Loss: 0.794 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9988813400268555
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.794 Vali Acc: 0.763 Test Loss: 0.794 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.316819667816162
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.802 Vali Acc: 0.757 Test Loss: 0.802 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.1618003845214844
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.809 Vali Acc: 0.750 Test Loss: 0.809 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 500420
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.466590881347656
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 2.187757968902588
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 2.092752695083618
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 2.088365077972412
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 2.3664419651031494
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 6 cost time: 2.519420862197876
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 7 cost time: 2.0416197776794434
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 8 cost time: 2.0817482471466064
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 9 cost time: 2.3144338130950928
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 10 cost time: 2.2188971042633057
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 11 cost time: 2.41705060005188
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 12 cost time: 2.1833088397979736
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 13 cost time: 2.2876086235046387
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 2.2861244678497314
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 2.189678907394409
Epoch: 15, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 2.088763475418091
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 2.0861310958862305
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 1.846766710281372
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 1.9927830696105957
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 1.9915344715118408
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 2.3131844997406006
Epoch: 21, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 1.9194612503051758
Epoch: 22, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 2.255214214324951
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 2.3767361640930176
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 2.32919979095459
Epoch: 25, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3122329711914062
Epoch: 26, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.3990490436553955
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.2596962451934814
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.458855152130127
Epoch: 29, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.350013017654419
Epoch: 30, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.2001497745513916
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.1936936378479004
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.04661226272583
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.3397247791290283
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.2578749656677246
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 2.4435408115386963
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.201847553253174
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.2270073890686035
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.225105047225952
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.2399258613586426
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 2.5169641971588135
Epoch: 41, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 2.1435937881469727
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 2.343997001647949
Epoch: 43, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.242128610610962
Epoch: 44, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 45 cost time: 2.360970973968506
Epoch: 45, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.0436744689941406
Epoch: 46, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.308133840560913
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 48 cost time: 2.0842337608337402
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.131990909576416
Epoch: 49, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.0606114864349365
Epoch: 50, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.272665023803711
Epoch: 51, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.305269956588745
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.3106048107147217
Epoch: 53, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.240612506866455
Epoch: 54, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.486147880554199
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.419642210006714
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.441094398498535
Epoch: 57, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.4356651306152344
Epoch: 58, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 2.22811222076416
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 2.25818133354187
Epoch: 60, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 500420
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6155149936676025
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.363 Vali Acc: 0.283 Test Loss: 1.363 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 2.1075503826141357
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.292 Vali Acc: 0.368 Test Loss: 1.292 Test Acc: 0.368
Validation loss decreased (-0.282881 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 2.028615713119507
Epoch: 3, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.205 Vali Acc: 0.526 Test Loss: 1.205 Test Acc: 0.526
Validation loss decreased (-0.368408 --> -0.526304).  Saving model ...
Epoch: 4 cost time: 2.1218106746673584
Epoch: 4, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.118 Vali Acc: 0.605 Test Loss: 1.118 Test Acc: 0.605
Validation loss decreased (-0.526304 --> -0.605252).  Saving model ...
Epoch: 5 cost time: 1.9533438682556152
Epoch: 5, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.040 Vali Acc: 0.651 Test Loss: 1.040 Test Acc: 0.651
Validation loss decreased (-0.605252 --> -0.651305).  Saving model ...
Epoch: 6 cost time: 2.009769916534424
Epoch: 6, Steps: 10 | Train Loss: 0.896 Vali Loss: 0.974 Vali Acc: 0.658 Test Loss: 0.974 Test Acc: 0.658
Validation loss decreased (-0.651305 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 2.142948627471924
Epoch: 7, Steps: 10 | Train Loss: 0.744 Vali Loss: 0.924 Vali Acc: 0.671 Test Loss: 0.924 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671043).  Saving model ...
Epoch: 8 cost time: 2.3750197887420654
Epoch: 8, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.883 Vali Acc: 0.678 Test Loss: 0.883 Test Acc: 0.678
Validation loss decreased (-0.671043 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 2.125598192214966
Epoch: 9, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.852 Vali Acc: 0.691 Test Loss: 0.852 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 2.0237414836883545
Epoch: 10, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.815 Vali Acc: 0.704 Test Loss: 0.815 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703939).  Saving model ...
Epoch: 11 cost time: 2.2371034622192383
Epoch: 11, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.787 Vali Acc: 0.717 Test Loss: 0.787 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717097).  Saving model ...
Epoch: 12 cost time: 2.1819446086883545
Epoch: 12, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.756 Vali Acc: 0.724 Test Loss: 0.756 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723677).  Saving model ...
Epoch: 13 cost time: 2.1513195037841797
Epoch: 13, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.734 Vali Acc: 0.737 Test Loss: 0.734 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 14 cost time: 2.3278586864471436
Epoch: 14, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.711 Vali Acc: 0.750 Test Loss: 0.711 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 2.2402331829071045
Epoch: 15, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.696 Vali Acc: 0.763 Test Loss: 0.696 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 16 cost time: 2.128427505493164
Epoch: 16, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.681 Vali Acc: 0.757 Test Loss: 0.681 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1477229595184326
Epoch: 17, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.668 Vali Acc: 0.770 Test Loss: 0.668 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 18 cost time: 2.07822847366333
Epoch: 18, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.667 Vali Acc: 0.776 Test Loss: 0.667 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 19 cost time: 2.068073034286499
Epoch: 19, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.661 Vali Acc: 0.776 Test Loss: 0.661 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776309).  Saving model ...
Epoch: 20 cost time: 2.1649200916290283
Epoch: 20, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.657 Vali Acc: 0.789 Test Loss: 0.657 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 21 cost time: 1.954714059829712
Epoch: 21, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.654 Vali Acc: 0.776 Test Loss: 0.654 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9078707695007324
Epoch: 22, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.648 Vali Acc: 0.796 Test Loss: 0.648 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 23 cost time: 1.9689207077026367
Epoch: 23, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9376373291015625
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.658 Vali Acc: 0.789 Test Loss: 0.658 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.047804355621338
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.668 Vali Acc: 0.796 Test Loss: 0.668 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.984001636505127
Epoch: 26, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.673 Vali Acc: 0.796 Test Loss: 0.673 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9817531108856201
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.679 Vali Acc: 0.796 Test Loss: 0.679 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1201560497283936
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.695 Vali Acc: 0.796 Test Loss: 0.695 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.1278717517852783
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.703 Vali Acc: 0.796 Test Loss: 0.703 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.1867716312408447
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.723 Vali Acc: 0.796 Test Loss: 0.723 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.052976608276367
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.750 Vali Acc: 0.789 Test Loss: 0.750 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.2120559215545654
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.761 Vali Acc: 0.796 Test Loss: 0.761 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 303812
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.151383876800537
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.347 Vali Acc: 0.355 Test Loss: 1.347 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 2.3322722911834717
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.293 Vali Acc: 0.434 Test Loss: 1.293 Test Acc: 0.434
Validation loss decreased (-0.355250 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 2.2389323711395264
Epoch: 3, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.225 Vali Acc: 0.533 Test Loss: 1.225 Test Acc: 0.533
Validation loss decreased (-0.434198 --> -0.532882).  Saving model ...
Epoch: 4 cost time: 2.392404317855835
Epoch: 4, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.154 Vali Acc: 0.592 Test Loss: 1.154 Test Acc: 0.592
Validation loss decreased (-0.532882 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 2.2934188842773438
Epoch: 5, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.088 Vali Acc: 0.632 Test Loss: 1.088 Test Acc: 0.632
Validation loss decreased (-0.592094 --> -0.631568).  Saving model ...
Epoch: 6 cost time: 2.294342279434204
Epoch: 6, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.028 Vali Acc: 0.632 Test Loss: 1.028 Test Acc: 0.632
Validation loss decreased (-0.631568 --> -0.631569).  Saving model ...
Epoch: 7 cost time: 2.293780565261841
Epoch: 7, Steps: 10 | Train Loss: 0.825 Vali Loss: 0.981 Vali Acc: 0.645 Test Loss: 0.981 Test Acc: 0.645
Validation loss decreased (-0.631569 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 2.234978675842285
Epoch: 8, Steps: 10 | Train Loss: 0.711 Vali Loss: 0.943 Vali Acc: 0.651 Test Loss: 0.943 Test Acc: 0.651
Validation loss decreased (-0.644727 --> -0.651306).  Saving model ...
Epoch: 9 cost time: 2.2369096279144287
Epoch: 9, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.905 Vali Acc: 0.664 Test Loss: 0.905 Test Acc: 0.664
Validation loss decreased (-0.651306 --> -0.664465).  Saving model ...
Epoch: 10 cost time: 2.224982976913452
Epoch: 10, Steps: 10 | Train Loss: 0.539 Vali Loss: 0.863 Vali Acc: 0.691 Test Loss: 0.863 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690781).  Saving model ...
Epoch: 11 cost time: 2.127542734146118
Epoch: 11, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.825 Vali Acc: 0.717 Test Loss: 0.825 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717097).  Saving model ...
Epoch: 12 cost time: 2.192751407623291
Epoch: 12, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.785 Vali Acc: 0.730 Test Loss: 0.785 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730255).  Saving model ...
Epoch: 13 cost time: 2.1563282012939453
Epoch: 13, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.759 Vali Acc: 0.743 Test Loss: 0.759 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743413).  Saving model ...
Epoch: 14 cost time: 2.1664845943450928
Epoch: 14, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.730 Vali Acc: 0.750 Test Loss: 0.730 Test Acc: 0.750
Validation loss decreased (-0.743413 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 2.2326138019561768
Epoch: 15, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.708 Vali Acc: 0.763 Test Loss: 0.708 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 16 cost time: 2.088035821914673
Epoch: 16, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.692 Vali Acc: 0.763 Test Loss: 0.692 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 17 cost time: 2.181154251098633
Epoch: 17, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.675 Vali Acc: 0.770 Test Loss: 0.675 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 18 cost time: 2.233886241912842
Epoch: 18, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.679 Vali Acc: 0.770 Test Loss: 0.679 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2095794677734375
Epoch: 19, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 20 cost time: 2.4095640182495117
Epoch: 20, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.666 Vali Acc: 0.770 Test Loss: 0.666 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3216001987457275
Epoch: 21, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.660 Vali Acc: 0.776 Test Loss: 0.660 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776309).  Saving model ...
Epoch: 22 cost time: 2.287998914718628
Epoch: 22, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.660 Vali Acc: 0.789 Test Loss: 0.660 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 23 cost time: 2.305856943130493
Epoch: 23, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3664896488189697
Epoch: 24, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.667 Vali Acc: 0.783 Test Loss: 0.667 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2142364978790283
Epoch: 25, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.672 Vali Acc: 0.776 Test Loss: 0.672 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2900679111480713
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.682 Vali Acc: 0.770 Test Loss: 0.682 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.224562644958496
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.684 Vali Acc: 0.776 Test Loss: 0.684 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0251705646514893
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.697 Vali Acc: 0.776 Test Loss: 0.697 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.882789373397827
Epoch: 29, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.698 Vali Acc: 0.776 Test Loss: 0.698 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.44244647026062
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.714 Vali Acc: 0.776 Test Loss: 0.714 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.4594485759735107
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.738 Vali Acc: 0.776 Test Loss: 0.738 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.3846654891967773
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.749 Vali Acc: 0.763 Test Loss: 0.749 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 303812
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.039085626602173
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.401 Vali Acc: 0.309 Test Loss: 1.401 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.9499380588531494
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.356 Vali Acc: 0.349 Test Loss: 1.356 Test Acc: 0.349
Validation loss decreased (-0.309197 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 2.248924493789673
Epoch: 3, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.298 Vali Acc: 0.408 Test Loss: 1.298 Test Acc: 0.408
Validation loss decreased (-0.348671 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 2.0074808597564697
Epoch: 4, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.236 Vali Acc: 0.480 Test Loss: 1.236 Test Acc: 0.480
Validation loss decreased (-0.407882 --> -0.480251).  Saving model ...
Epoch: 5 cost time: 2.2832188606262207
Epoch: 5, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.175 Vali Acc: 0.526 Test Loss: 1.175 Test Acc: 0.526
Validation loss decreased (-0.480251 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 2.205317974090576
Epoch: 6, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.110 Vali Acc: 0.586 Test Loss: 1.110 Test Acc: 0.586
Validation loss decreased (-0.526304 --> -0.585515).  Saving model ...
Epoch: 7 cost time: 2.2911312580108643
Epoch: 7, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.051 Vali Acc: 0.612 Test Loss: 1.051 Test Acc: 0.612
Validation loss decreased (-0.585515 --> -0.611832).  Saving model ...
Epoch: 8 cost time: 2.1666133403778076
Epoch: 8, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.002 Vali Acc: 0.638 Test Loss: 1.002 Test Acc: 0.638
Validation loss decreased (-0.611832 --> -0.638148).  Saving model ...
Epoch: 9 cost time: 2.2028377056121826
Epoch: 9, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.949 Vali Acc: 0.645 Test Loss: 0.949 Test Acc: 0.645
Validation loss decreased (-0.638148 --> -0.644727).  Saving model ...
Epoch: 10 cost time: 2.1228365898132324
Epoch: 10, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.892 Vali Acc: 0.671 Test Loss: 0.892 Test Acc: 0.671
Validation loss decreased (-0.644727 --> -0.671044).  Saving model ...
Epoch: 11 cost time: 2.03389835357666
Epoch: 11, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.841 Vali Acc: 0.671 Test Loss: 0.841 Test Acc: 0.671
Validation loss decreased (-0.671044 --> -0.671044).  Saving model ...
Epoch: 12 cost time: 2.064164161682129
Epoch: 12, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.786 Vali Acc: 0.724 Test Loss: 0.786 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723676).  Saving model ...
Epoch: 13 cost time: 2.12603759765625
Epoch: 13, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.742 Vali Acc: 0.711 Test Loss: 0.742 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.983469009399414
Epoch: 14, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.711 Vali Acc: 0.730 Test Loss: 0.711 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 2.2770726680755615
Epoch: 15, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.686 Vali Acc: 0.750 Test Loss: 0.686 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 2.190268039703369
Epoch: 16, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.670 Vali Acc: 0.750 Test Loss: 0.670 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 17 cost time: 2.3327882289886475
Epoch: 17, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.300873279571533
Epoch: 18, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.644 Vali Acc: 0.743 Test Loss: 0.644 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4438796043395996
Epoch: 19, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.642 Vali Acc: 0.750 Test Loss: 0.642 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 20 cost time: 2.3085594177246094
Epoch: 20, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.635 Vali Acc: 0.750 Test Loss: 0.635 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 21 cost time: 2.423597574234009
Epoch: 21, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.626 Vali Acc: 0.770 Test Loss: 0.626 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 22 cost time: 2.3693244457244873
Epoch: 22, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.629 Vali Acc: 0.770 Test Loss: 0.629 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3033204078674316
Epoch: 23, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.633 Vali Acc: 0.770 Test Loss: 0.633 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1119883060455322
Epoch: 24, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.648 Vali Acc: 0.770 Test Loss: 0.648 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1062171459198
Epoch: 25, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.661 Vali Acc: 0.776 Test Loss: 0.661 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776309).  Saving model ...
Epoch: 26 cost time: 1.947479486465454
Epoch: 26, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.670 Vali Acc: 0.783 Test Loss: 0.670 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 27 cost time: 1.912449836730957
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 28 cost time: 2.1287925243377686
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.683 Vali Acc: 0.789 Test Loss: 0.683 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.200415849685669
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.697 Vali Acc: 0.789 Test Loss: 0.697 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.106412887573242
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.717 Vali Acc: 0.783 Test Loss: 0.717 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.3703954219818115
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.733 Vali Acc: 0.789 Test Loss: 0.733 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.3138010501861572
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.737 Vali Acc: 0.789 Test Loss: 0.737 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.2256946563720703
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.745 Vali Acc: 0.776 Test Loss: 0.745 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.3355321884155273
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.749 Vali Acc: 0.789 Test Loss: 0.749 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.193413019180298
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.761 Vali Acc: 0.789 Test Loss: 0.761 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.144421339035034
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.769 Vali Acc: 0.796 Test Loss: 0.769 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 37 cost time: 2.238468885421753
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.782 Vali Acc: 0.789 Test Loss: 0.782 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.056417465209961
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.789 Vali Acc: 0.789 Test Loss: 0.789 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.1178226470947266
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.796 Vali Acc: 0.789 Test Loss: 0.796 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.1870903968811035
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.804 Vali Acc: 0.783 Test Loss: 0.804 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.2074732780456543
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.810 Vali Acc: 0.783 Test Loss: 0.810 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.1157960891723633
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.821 Vali Acc: 0.783 Test Loss: 0.821 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.191272735595703
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.830 Vali Acc: 0.783 Test Loss: 0.830 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.2215237617492676
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.836 Vali Acc: 0.783 Test Loss: 0.836 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.214568853378296
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.839 Vali Acc: 0.776 Test Loss: 0.839 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.173252820968628
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.846 Vali Acc: 0.776 Test Loss: 0.846 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 303812
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4000391960144043
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.405 Vali Acc: 0.237 Test Loss: 1.405 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 2.0435965061187744
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.374 Vali Acc: 0.270 Test Loss: 1.374 Test Acc: 0.270
Validation loss decreased (-0.236828 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 2.1996026039123535
Epoch: 3, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.337 Vali Acc: 0.309 Test Loss: 1.337 Test Acc: 0.309
Validation loss decreased (-0.269723 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 2.0184175968170166
Epoch: 4, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.300 Vali Acc: 0.336 Test Loss: 1.300 Test Acc: 0.336
Validation loss decreased (-0.309197 --> -0.335513).  Saving model ...
Epoch: 5 cost time: 2.194568634033203
Epoch: 5, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.259 Vali Acc: 0.401 Test Loss: 1.259 Test Acc: 0.401
Validation loss decreased (-0.335513 --> -0.401303).  Saving model ...
Epoch: 6 cost time: 2.1242940425872803
Epoch: 6, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.210 Vali Acc: 0.441 Test Loss: 1.210 Test Acc: 0.441
Validation loss decreased (-0.401303 --> -0.440777).  Saving model ...
Epoch: 7 cost time: 2.2079079151153564
Epoch: 7, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.166 Vali Acc: 0.480 Test Loss: 1.166 Test Acc: 0.480
Validation loss decreased (-0.440777 --> -0.480251).  Saving model ...
Epoch: 8 cost time: 2.363990545272827
Epoch: 8, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.121 Vali Acc: 0.526 Test Loss: 1.121 Test Acc: 0.526
Validation loss decreased (-0.480251 --> -0.526305).  Saving model ...
Epoch: 9 cost time: 2.3541834354400635
Epoch: 9, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.526305 --> -0.532884).  Saving model ...
Epoch: 10 cost time: 2.3953373432159424
Epoch: 10, Steps: 10 | Train Loss: 0.709 Vali Loss: 1.007 Vali Acc: 0.559 Test Loss: 1.007 Test Acc: 0.559
Validation loss decreased (-0.532884 --> -0.559200).  Saving model ...
Epoch: 11 cost time: 2.2855489253997803
Epoch: 11, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.957 Vali Acc: 0.586 Test Loss: 0.957 Test Acc: 0.586
Validation loss decreased (-0.559200 --> -0.585517).  Saving model ...
Epoch: 12 cost time: 2.231689691543579
Epoch: 12, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.895 Vali Acc: 0.599 Test Loss: 0.895 Test Acc: 0.599
Validation loss decreased (-0.585517 --> -0.598675).  Saving model ...
Epoch: 13 cost time: 2.1747336387634277
Epoch: 13, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.835 Vali Acc: 0.612 Test Loss: 0.835 Test Acc: 0.612
Validation loss decreased (-0.598675 --> -0.611834).  Saving model ...
Epoch: 14 cost time: 2.0245437622070312
Epoch: 14, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.795 Vali Acc: 0.632 Test Loss: 0.795 Test Acc: 0.632
Validation loss decreased (-0.611834 --> -0.631571).  Saving model ...
Epoch: 15 cost time: 2.0898959636688232
Epoch: 15, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.753 Vali Acc: 0.658 Test Loss: 0.753 Test Acc: 0.658
Validation loss decreased (-0.631571 --> -0.657887).  Saving model ...
Epoch: 16 cost time: 2.0836193561553955
Epoch: 16, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.723 Vali Acc: 0.678 Test Loss: 0.723 Test Acc: 0.678
Validation loss decreased (-0.657887 --> -0.677624).  Saving model ...
Epoch: 17 cost time: 1.9869139194488525
Epoch: 17, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.690 Vali Acc: 0.704 Test Loss: 0.690 Test Acc: 0.704
Validation loss decreased (-0.677624 --> -0.703940).  Saving model ...
Epoch: 18 cost time: 2.07448673248291
Epoch: 18, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.672 Vali Acc: 0.743 Test Loss: 0.672 Test Acc: 0.743
Validation loss decreased (-0.703940 --> -0.743414).  Saving model ...
Epoch: 19 cost time: 2.1301262378692627
Epoch: 19, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.659 Vali Acc: 0.737 Test Loss: 0.659 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0192883014678955
Epoch: 20, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.646 Vali Acc: 0.763 Test Loss: 0.646 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763151).  Saving model ...
Epoch: 21 cost time: 2.159437656402588
Epoch: 21, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.631 Vali Acc: 0.757 Test Loss: 0.631 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2404298782348633
Epoch: 22, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.626 Vali Acc: 0.763 Test Loss: 0.626 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 2.178823232650757
Epoch: 23, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.627 Vali Acc: 0.763 Test Loss: 0.627 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.210508108139038
Epoch: 24, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.3227365016937256
Epoch: 25, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.648 Vali Acc: 0.750 Test Loss: 0.648 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.1467974185943604
Epoch: 26, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.655 Vali Acc: 0.743 Test Loss: 0.655 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9041693210601807
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.660 Vali Acc: 0.763 Test Loss: 0.660 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0285468101501465
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.669 Vali Acc: 0.763 Test Loss: 0.669 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9531524181365967
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.673 Vali Acc: 0.757 Test Loss: 0.673 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8471269607543945
Epoch: 30, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.689 Vali Acc: 0.757 Test Loss: 0.689 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9824459552764893
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.706 Vali Acc: 0.750 Test Loss: 0.706 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.122436046600342
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.713 Vali Acc: 0.763 Test Loss: 0.713 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 303812
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.0388078689575195
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.388 Vali Acc: 0.303 Test Loss: 1.388 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 2.26193904876709
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.371 Vali Acc: 0.322 Test Loss: 1.371 Test Acc: 0.322
Validation loss decreased (-0.302618 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 2.301891326904297
Epoch: 3, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.349 Vali Acc: 0.368 Test Loss: 1.349 Test Acc: 0.368
Validation loss decreased (-0.322355 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 2.368338108062744
Epoch: 4, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.327 Vali Acc: 0.368 Test Loss: 1.327 Test Acc: 0.368
Validation loss decreased (-0.368408 --> -0.368408).  Saving model ...
Epoch: 5 cost time: 2.1764793395996094
Epoch: 5, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.297 Vali Acc: 0.382 Test Loss: 1.297 Test Acc: 0.382
Validation loss decreased (-0.368408 --> -0.381566).  Saving model ...
Epoch: 6 cost time: 2.030076503753662
Epoch: 6, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.262 Vali Acc: 0.414 Test Loss: 1.262 Test Acc: 0.414
Validation loss decreased (-0.381566 --> -0.414461).  Saving model ...
Epoch: 7 cost time: 2.1787164211273193
Epoch: 7, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.218 Vali Acc: 0.467 Test Loss: 1.218 Test Acc: 0.467
Validation loss decreased (-0.414461 --> -0.467093).  Saving model ...
Epoch: 8 cost time: 2.320762872695923
Epoch: 8, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.170 Vali Acc: 0.441 Test Loss: 1.170 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1369283199310303
Epoch: 9, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.109 Vali Acc: 0.526 Test Loss: 1.109 Test Acc: 0.526
Validation loss decreased (-0.467093 --> -0.526305).  Saving model ...
Epoch: 10 cost time: 2.0869178771972656
Epoch: 10, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.038 Vali Acc: 0.566 Test Loss: 1.038 Test Acc: 0.566
Validation loss decreased (-0.526305 --> -0.565779).  Saving model ...
Epoch: 11 cost time: 2.07350754737854
Epoch: 11, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.961 Vali Acc: 0.618 Test Loss: 0.961 Test Acc: 0.618
Validation loss decreased (-0.565779 --> -0.618411).  Saving model ...
Epoch: 12 cost time: 2.189110517501831
Epoch: 12, Steps: 10 | Train Loss: 0.667 Vali Loss: 0.882 Vali Acc: 0.691 Test Loss: 0.882 Test Acc: 0.691
Validation loss decreased (-0.618411 --> -0.690781).  Saving model ...
Epoch: 13 cost time: 2.1353919506073
Epoch: 13, Steps: 10 | Train Loss: 0.567 Vali Loss: 0.817 Vali Acc: 0.691 Test Loss: 0.817 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690781).  Saving model ...
Epoch: 14 cost time: 2.271899700164795
Epoch: 14, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.769 Vali Acc: 0.684 Test Loss: 0.769 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.278578758239746
Epoch: 15, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.739 Vali Acc: 0.691 Test Loss: 0.739 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690782).  Saving model ...
Epoch: 16 cost time: 2.1818103790283203
Epoch: 16, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.720 Vali Acc: 0.704 Test Loss: 0.720 Test Acc: 0.704
Validation loss decreased (-0.690782 --> -0.703940).  Saving model ...
Epoch: 17 cost time: 1.9406237602233887
Epoch: 17, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.692 Vali Acc: 0.717 Test Loss: 0.692 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 18 cost time: 2.093296766281128
Epoch: 18, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.681 Vali Acc: 0.711 Test Loss: 0.681 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0227086544036865
Epoch: 19, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.669 Vali Acc: 0.717 Test Loss: 0.669 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717099).  Saving model ...
Epoch: 20 cost time: 2.000863790512085
Epoch: 20, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.670 Vali Acc: 0.737 Test Loss: 0.670 Test Acc: 0.737
Validation loss decreased (-0.717099 --> -0.736835).  Saving model ...
Epoch: 21 cost time: 2.1449098587036133
Epoch: 21, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.665 Vali Acc: 0.730 Test Loss: 0.665 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1509509086608887
Epoch: 22, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.663 Vali Acc: 0.737 Test Loss: 0.663 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 23 cost time: 2.3558034896850586
Epoch: 23, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 24 cost time: 2.2934043407440186
Epoch: 24, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.681 Vali Acc: 0.737 Test Loss: 0.681 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3220643997192383
Epoch: 25, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749993).  Saving model ...
Epoch: 26 cost time: 2.3521158695220947
Epoch: 26, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.719 Vali Acc: 0.743 Test Loss: 0.719 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.720150947570801
Epoch: 27, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.701 Vali Acc: 0.750 Test Loss: 0.701 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 28 cost time: 2.3527956008911133
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.725 Vali Acc: 0.750 Test Loss: 0.725 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3253636360168457
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.130389451980591
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.783 Vali Acc: 0.737 Test Loss: 0.783 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.2630393505096436
Epoch: 31, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.782 Vali Acc: 0.737 Test Loss: 0.782 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.1036911010742188
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.781 Vali Acc: 0.743 Test Loss: 0.781 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.1220591068267822
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.784 Vali Acc: 0.763 Test Loss: 0.784 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763150).  Saving model ...
Epoch: 34 cost time: 2.3476972579956055
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.777 Vali Acc: 0.763 Test Loss: 0.777 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763150).  Saving model ...
Epoch: 35 cost time: 2.01601243019104
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.794 Vali Acc: 0.737 Test Loss: 0.794 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.173713207244873
Epoch: 36, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.813 Vali Acc: 0.737 Test Loss: 0.813 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.284128189086914
Epoch: 37, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.821 Vali Acc: 0.757 Test Loss: 0.821 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.4346301555633545
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.234516143798828
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.821 Vali Acc: 0.757 Test Loss: 0.821 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.426499605178833
Epoch: 40, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.4663054943084717
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.859 Vali Acc: 0.730 Test Loss: 0.859 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.212679862976074
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.870 Vali Acc: 0.737 Test Loss: 0.870 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.852609634399414
Epoch: 43, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.864 Vali Acc: 0.737 Test Loss: 0.864 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.0819599628448486
Epoch: 44, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 303812
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.195437908172607
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.401 Vali Acc: 0.276 Test Loss: 1.401 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 2.1970767974853516
Epoch: 2, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.381 Vali Acc: 0.296 Test Loss: 1.381 Test Acc: 0.296
Validation loss decreased (-0.276302 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 2.2884907722473145
Epoch: 3, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.355 Vali Acc: 0.309 Test Loss: 1.355 Test Acc: 0.309
Validation loss decreased (-0.296039 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 2.210040807723999
Epoch: 4, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.329 Vali Acc: 0.329 Test Loss: 1.329 Test Acc: 0.329
Validation loss decreased (-0.309197 --> -0.328934).  Saving model ...
Epoch: 5 cost time: 2.346465826034546
Epoch: 5, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.296 Vali Acc: 0.342 Test Loss: 1.296 Test Acc: 0.342
Validation loss decreased (-0.328934 --> -0.342092).  Saving model ...
Epoch: 6 cost time: 2.442612409591675
Epoch: 6, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.253 Vali Acc: 0.395 Test Loss: 1.253 Test Acc: 0.395
Validation loss decreased (-0.342092 --> -0.394724).  Saving model ...
Epoch: 7 cost time: 2.159151077270508
Epoch: 7, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.204 Vali Acc: 0.428 Test Loss: 1.204 Test Acc: 0.428
Validation loss decreased (-0.394724 --> -0.427620).  Saving model ...
Epoch: 8 cost time: 2.324366807937622
Epoch: 8, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.427620 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 2.1221935749053955
Epoch: 9, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.085 Vali Acc: 0.586 Test Loss: 1.085 Test Acc: 0.586
Validation loss decreased (-0.499988 --> -0.585515).  Saving model ...
Epoch: 10 cost time: 2.337489128112793
Epoch: 10, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.012 Vali Acc: 0.651 Test Loss: 1.012 Test Acc: 0.651
Validation loss decreased (-0.585515 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 2.0921823978424072
Epoch: 11, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.940 Vali Acc: 0.658 Test Loss: 0.940 Test Acc: 0.658
Validation loss decreased (-0.651306 --> -0.657885).  Saving model ...
Epoch: 12 cost time: 2.2078113555908203
Epoch: 12, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.868 Vali Acc: 0.678 Test Loss: 0.868 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677623).  Saving model ...
Epoch: 13 cost time: 2.170752763748169
Epoch: 13, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.807 Vali Acc: 0.684 Test Loss: 0.807 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684202).  Saving model ...
Epoch: 14 cost time: 2.408517360687256
Epoch: 14, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.765 Vali Acc: 0.678 Test Loss: 0.765 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2025201320648193
Epoch: 15, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.735 Vali Acc: 0.684 Test Loss: 0.735 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684203).  Saving model ...
Epoch: 16 cost time: 2.37998366355896
Epoch: 16, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.717 Vali Acc: 0.704 Test Loss: 0.717 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703940).  Saving model ...
Epoch: 17 cost time: 2.4061174392700195
Epoch: 17, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 18 cost time: 2.124866008758545
Epoch: 18, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.687 Vali Acc: 0.717 Test Loss: 0.687 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717098).  Saving model ...
Epoch: 19 cost time: 2.2155990600585938
Epoch: 19, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.666 Vali Acc: 0.724 Test Loss: 0.666 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723678).  Saving model ...
Epoch: 20 cost time: 2.0157506465911865
Epoch: 20, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.661 Vali Acc: 0.737 Test Loss: 0.661 Test Acc: 0.737
Validation loss decreased (-0.723678 --> -0.736835).  Saving model ...
Epoch: 21 cost time: 2.014458417892456
Epoch: 21, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.654 Vali Acc: 0.770 Test Loss: 0.654 Test Acc: 0.770
Validation loss decreased (-0.736835 --> -0.769730).  Saving model ...
Epoch: 22 cost time: 2.059006929397583
Epoch: 22, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.656 Vali Acc: 0.770 Test Loss: 0.656 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.929858684539795
Epoch: 23, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.656 Vali Acc: 0.776 Test Loss: 0.656 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 24 cost time: 2.1580698490142822
Epoch: 24, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 25 cost time: 2.2207818031311035
Epoch: 25, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.681 Vali Acc: 0.783 Test Loss: 0.681 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2766008377075195
Epoch: 26, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.690 Vali Acc: 0.783 Test Loss: 0.690 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.144850730895996
Epoch: 27, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.690 Vali Acc: 0.763 Test Loss: 0.690 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.234705924987793
Epoch: 28, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.712 Vali Acc: 0.770 Test Loss: 0.712 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.346588373184204
Epoch: 29, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.732 Vali Acc: 0.763 Test Loss: 0.732 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.063023805618286
Epoch: 30, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.753 Vali Acc: 0.763 Test Loss: 0.753 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.2042057514190674
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.766 Vali Acc: 0.757 Test Loss: 0.766 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.1429755687713623
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.771 Vali Acc: 0.770 Test Loss: 0.771 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.3955647945404053
Epoch: 33, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.772 Vali Acc: 0.770 Test Loss: 0.772 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.3423995971679688
Epoch: 34, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.762 Vali Acc: 0.763 Test Loss: 0.762 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 303812
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8359079360961914
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.2138071060180664
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 2.139845848083496
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 2.097200632095337
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 5 cost time: 2.1331536769866943
Epoch: 5, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 6 cost time: 2.277514934539795
Epoch: 6, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 7 cost time: 2.44362211227417
Epoch: 7, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 8 cost time: 2.568618059158325
Epoch: 8, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 9 cost time: 2.2214391231536865
Epoch: 9, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 10 cost time: 2.144773483276367
Epoch: 10, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 11 cost time: 2.4261069297790527
Epoch: 11, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 12 cost time: 2.4596636295318604
Epoch: 12, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 13 cost time: 2.670133113861084
Epoch: 13, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 14 cost time: 2.1434669494628906
Epoch: 14, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 15 cost time: 2.41566801071167
Epoch: 15, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 16 cost time: 2.532802104949951
Epoch: 16, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 17 cost time: 2.402282953262329
Epoch: 17, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 18 cost time: 2.4494898319244385
Epoch: 18, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 19 cost time: 2.5092217922210693
Epoch: 19, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 20 cost time: 2.2354519367218018
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 21 cost time: 2.330278158187866
Epoch: 21, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 22 cost time: 2.1843948364257812
Epoch: 22, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 23 cost time: 2.1504013538360596
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 24 cost time: 2.02836012840271
Epoch: 24, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 25 cost time: 2.0927391052246094
Epoch: 25, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 26 cost time: 2.2582216262817383
Epoch: 26, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 27 cost time: 2.307619333267212
Epoch: 27, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.285459041595459
Epoch: 28, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 29 cost time: 2.230045795440674
Epoch: 29, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 30 cost time: 2.3151540756225586
Epoch: 30, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 31 cost time: 2.1528608798980713
Epoch: 31, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 32 cost time: 2.380357265472412
Epoch: 32, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 33 cost time: 2.2899296283721924
Epoch: 33, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 34 cost time: 2.4180123805999756
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 35 cost time: 2.480534076690674
Epoch: 35, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 36 cost time: 2.6142868995666504
Epoch: 36, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 37 cost time: 2.3755476474761963
Epoch: 37, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 38 cost time: 2.3877947330474854
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 39 cost time: 2.3678877353668213
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 40 cost time: 2.28794264793396
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 41 cost time: 2.0838000774383545
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 42 cost time: 2.2723793983459473
Epoch: 42, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 43 cost time: 2.3816940784454346
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 44 cost time: 2.4056756496429443
Epoch: 44, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.263144 --> -0.282881).  Saving model ...
Epoch: 45 cost time: 2.3121891021728516
Epoch: 45, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.315398931503296
Epoch: 46, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 2.3011903762817383
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 48 cost time: 2.312549352645874
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.1972577571868896
Epoch: 49, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.1016674041748047
Epoch: 50, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.247788190841675
Epoch: 51, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 52 cost time: 2.157404899597168
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 53 cost time: 2.0957489013671875
Epoch: 53, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 2.0384862422943115
Epoch: 54, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 55 cost time: 2.4818270206451416
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.2575557231903076
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 57 cost time: 2.429121494293213
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 58 cost time: 2.1551973819732666
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 59 cost time: 2.487832546234131
Epoch: 59, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 60 cost time: 2.265080213546753
Epoch: 60, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 61 cost time: 2.2481801509857178
Epoch: 61, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 62 cost time: 2.2094075679779053
Epoch: 62, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.275888204574585
Epoch: 63, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.0568573474884033
Epoch: 64, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.141631841659546
Epoch: 65, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 66 cost time: 2.4573144912719727
Epoch: 66, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 67 cost time: 2.3245108127593994
Epoch: 67, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.1881160736083984
Epoch: 68, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 69 cost time: 2.173269271850586
Epoch: 69, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 2.2443771362304688
Epoch: 70, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 71 cost time: 2.038193702697754
Epoch: 71, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.9179017543792725
Epoch: 72, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 2.018263339996338
Epoch: 73, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.9867818355560303
Epoch: 74, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 75 cost time: 2.0832486152648926
Epoch: 75, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 2.1958680152893066
Epoch: 76, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 2.2259013652801514
Epoch: 77, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 2.3401992321014404
Epoch: 78, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 2.378373384475708
Epoch: 79, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 2.214911699295044
Epoch: 80, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 2.083203077316284
Epoch: 81, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 2.1949243545532227
Epoch: 82, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 1.8987300395965576
Epoch: 83, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 2.2545816898345947
Epoch: 84, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 303812
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.163459062576294
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.382 Vali Acc: 0.316 Test Loss: 1.382 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 2.359459400177002
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
Validation loss decreased (-0.315776 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 2.303816080093384
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.254 Vali Acc: 0.480 Test Loss: 1.254 Test Acc: 0.480
Validation loss decreased (-0.374987 --> -0.480251).  Saving model ...
Epoch: 4 cost time: 2.08754825592041
Epoch: 4, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.172 Vali Acc: 0.572 Test Loss: 1.172 Test Acc: 0.572
Validation loss decreased (-0.480251 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 2.1975369453430176
Epoch: 5, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.101 Vali Acc: 0.618 Test Loss: 1.101 Test Acc: 0.618
Validation loss decreased (-0.572357 --> -0.618410).  Saving model ...
Epoch: 6 cost time: 2.290771722793579
Epoch: 6, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.032 Vali Acc: 0.658 Test Loss: 1.032 Test Acc: 0.658
Validation loss decreased (-0.618410 --> -0.657884).  Saving model ...
Epoch: 7 cost time: 2.24992299079895
Epoch: 7, Steps: 10 | Train Loss: 0.802 Vali Loss: 0.974 Vali Acc: 0.671 Test Loss: 0.974 Test Acc: 0.671
Validation loss decreased (-0.657884 --> -0.671043).  Saving model ...
Epoch: 8 cost time: 2.2962679862976074
Epoch: 8, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.931 Vali Acc: 0.691 Test Loss: 0.931 Test Acc: 0.691
Validation loss decreased (-0.671043 --> -0.690780).  Saving model ...
Epoch: 9 cost time: 2.313328266143799
Epoch: 9, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.892 Vali Acc: 0.678 Test Loss: 0.892 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.420820713043213
Epoch: 10, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.859 Vali Acc: 0.697 Test Loss: 0.859 Test Acc: 0.697
Validation loss decreased (-0.690780 --> -0.697360).  Saving model ...
Epoch: 11 cost time: 2.3257992267608643
Epoch: 11, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.831 Vali Acc: 0.717 Test Loss: 0.831 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717097).  Saving model ...
Epoch: 12 cost time: 2.4805569648742676
Epoch: 12, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.813 Vali Acc: 0.711 Test Loss: 0.813 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.364187240600586
Epoch: 13, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.779 Vali Acc: 0.717 Test Loss: 0.779 Test Acc: 0.717
Validation loss decreased (-0.717097 --> -0.717097).  Saving model ...
Epoch: 14 cost time: 2.2112879753112793
Epoch: 14, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.745 Vali Acc: 0.730 Test Loss: 0.745 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 1.8918254375457764
Epoch: 15, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.715 Vali Acc: 0.750 Test Loss: 0.715 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 2.2586748600006104
Epoch: 16, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.685 Vali Acc: 0.750 Test Loss: 0.685 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 17 cost time: 2.146538734436035
Epoch: 17, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.666 Vali Acc: 0.763 Test Loss: 0.666 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 18 cost time: 2.221987247467041
Epoch: 18, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.649 Vali Acc: 0.763 Test Loss: 0.649 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 19 cost time: 2.4535109996795654
Epoch: 19, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.627 Vali Acc: 0.776 Test Loss: 0.627 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 2.3133442401885986
Epoch: 20, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.620 Vali Acc: 0.776 Test Loss: 0.620 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 21 cost time: 2.3490514755249023
Epoch: 21, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.611 Vali Acc: 0.776 Test Loss: 0.611 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 22 cost time: 2.5243213176727295
Epoch: 22, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2797038555145264
Epoch: 23, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.617 Vali Acc: 0.776 Test Loss: 0.617 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2556018829345703
Epoch: 24, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 25 cost time: 2.1445233821868896
Epoch: 25, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 26 cost time: 2.126492500305176
Epoch: 26, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.633 Vali Acc: 0.789 Test Loss: 0.633 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3294036388397217
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.645 Vali Acc: 0.783 Test Loss: 0.645 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.469902276992798
Epoch: 28, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.336049795150757
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.328673839569092
Epoch: 30, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.664 Vali Acc: 0.803 Test Loss: 0.664 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 31 cost time: 2.6777865886688232
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.670 Vali Acc: 0.789 Test Loss: 0.670 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.6547577381134033
Epoch: 32, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.677 Vali Acc: 0.783 Test Loss: 0.677 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.2724995613098145
Epoch: 33, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.688 Vali Acc: 0.803 Test Loss: 0.688 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.2909581661224365
Epoch: 34, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.700 Vali Acc: 0.809 Test Loss: 0.700 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 35 cost time: 2.2579782009124756
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.708 Vali Acc: 0.809 Test Loss: 0.708 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.338491678237915
Epoch: 36, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.708 Vali Acc: 0.809 Test Loss: 0.708 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.3302054405212402
Epoch: 37, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.726 Vali Acc: 0.803 Test Loss: 0.726 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.0708706378936768
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.737 Vali Acc: 0.809 Test Loss: 0.737 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.318006992340088
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.749 Vali Acc: 0.809 Test Loss: 0.749 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.2716705799102783
Epoch: 40, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.760 Vali Acc: 0.809 Test Loss: 0.760 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.400225877761841
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.765 Vali Acc: 0.809 Test Loss: 0.765 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.202633857727051
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.2640249729156494
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.803 Vali Acc: 0.809 Test Loss: 0.803 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.1493349075317383
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.816 Vali Acc: 0.809 Test Loss: 0.816 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 205508
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6443071365356445
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.396 Vali Acc: 0.322 Test Loss: 1.396 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 2.094977617263794
Epoch: 2, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.345 Vali Acc: 0.368 Test Loss: 1.345 Test Acc: 0.368
Validation loss decreased (-0.322354 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 2.2127277851104736
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.283 Vali Acc: 0.428 Test Loss: 1.283 Test Acc: 0.428
Validation loss decreased (-0.368408 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 2.181236505508423
Epoch: 4, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.214 Vali Acc: 0.487 Test Loss: 1.214 Test Acc: 0.487
Validation loss decreased (-0.427619 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 2.18607759475708
Epoch: 5, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.149 Vali Acc: 0.533 Test Loss: 1.149 Test Acc: 0.533
Validation loss decreased (-0.486830 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 2.36043643951416
Epoch: 6, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.084 Vali Acc: 0.592 Test Loss: 1.084 Test Acc: 0.592
Validation loss decreased (-0.532883 --> -0.592094).  Saving model ...
Epoch: 7 cost time: 2.1861658096313477
Epoch: 7, Steps: 10 | Train Loss: 0.880 Vali Loss: 1.025 Vali Acc: 0.618 Test Loss: 1.025 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618411).  Saving model ...
Epoch: 8 cost time: 2.1959540843963623
Epoch: 8, Steps: 10 | Train Loss: 0.783 Vali Loss: 0.981 Vali Acc: 0.632 Test Loss: 0.981 Test Acc: 0.632
Validation loss decreased (-0.618411 --> -0.631569).  Saving model ...
Epoch: 9 cost time: 2.134823799133301
Epoch: 9, Steps: 10 | Train Loss: 0.686 Vali Loss: 0.937 Vali Acc: 0.638 Test Loss: 0.937 Test Acc: 0.638
Validation loss decreased (-0.631569 --> -0.638149).  Saving model ...
Epoch: 10 cost time: 2.1633572578430176
Epoch: 10, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.896 Vali Acc: 0.678 Test Loss: 0.896 Test Acc: 0.678
Validation loss decreased (-0.638149 --> -0.677623).  Saving model ...
Epoch: 11 cost time: 2.1561100482940674
Epoch: 11, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.857 Vali Acc: 0.704 Test Loss: 0.857 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703939).  Saving model ...
Epoch: 12 cost time: 2.1377038955688477
Epoch: 12, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.829 Vali Acc: 0.711 Test Loss: 0.829 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710518).  Saving model ...
Epoch: 13 cost time: 2.1571390628814697
Epoch: 13, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.787 Vali Acc: 0.711 Test Loss: 0.787 Test Acc: 0.711
Validation loss decreased (-0.710518 --> -0.710518).  Saving model ...
Epoch: 14 cost time: 2.051668167114258
Epoch: 14, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
Validation loss decreased (-0.710518 --> -0.717098).  Saving model ...
Epoch: 15 cost time: 2.043020248413086
Epoch: 15, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.722 Vali Acc: 0.743 Test Loss: 0.722 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 16 cost time: 2.0608279705047607
Epoch: 16, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.694 Vali Acc: 0.763 Test Loss: 0.694 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763151).  Saving model ...
Epoch: 17 cost time: 2.237466812133789
Epoch: 17, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.672 Vali Acc: 0.770 Test Loss: 0.672 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 18 cost time: 2.257124185562134
Epoch: 18, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.657 Vali Acc: 0.776 Test Loss: 0.657 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 19 cost time: 2.2898809909820557
Epoch: 19, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.640 Vali Acc: 0.776 Test Loss: 0.640 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776309).  Saving model ...
Epoch: 20 cost time: 2.2713308334350586
Epoch: 20, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.638 Vali Acc: 0.783 Test Loss: 0.638 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 21 cost time: 2.1869964599609375
Epoch: 21, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 1.893723487854004
Epoch: 22, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.648 Vali Acc: 0.770 Test Loss: 0.648 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0468971729278564
Epoch: 23, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.656 Vali Acc: 0.770 Test Loss: 0.656 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0703816413879395
Epoch: 24, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.663 Vali Acc: 0.770 Test Loss: 0.663 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0502710342407227
Epoch: 25, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.663 Vali Acc: 0.770 Test Loss: 0.663 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9212896823883057
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.674 Vali Acc: 0.770 Test Loss: 0.674 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.2800838947296143
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.683 Vali Acc: 0.776 Test Loss: 0.683 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.115553140640259
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.694 Vali Acc: 0.776 Test Loss: 0.694 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.1878020763397217
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.702 Vali Acc: 0.776 Test Loss: 0.702 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.2076194286346436
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.700 Vali Acc: 0.783 Test Loss: 0.700 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.2103850841522217
Epoch: 31, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 32 cost time: 2.1713647842407227
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.717 Vali Acc: 0.776 Test Loss: 0.717 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1765756607055664
Epoch: 33, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.733 Vali Acc: 0.789 Test Loss: 0.733 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.1323227882385254
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.170520305633545
Epoch: 35, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.747 Vali Acc: 0.796 Test Loss: 0.747 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 36 cost time: 2.1014206409454346
Epoch: 36, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.750 Vali Acc: 0.789 Test Loss: 0.750 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.3056273460388184
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.768 Vali Acc: 0.776 Test Loss: 0.768 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.454014301300049
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.779 Vali Acc: 0.776 Test Loss: 0.779 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.211527109146118
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.787 Vali Acc: 0.783 Test Loss: 0.787 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.2876336574554443
Epoch: 40, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.795 Vali Acc: 0.783 Test Loss: 0.795 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.1963536739349365
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.798 Vali Acc: 0.789 Test Loss: 0.798 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.0970280170440674
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.812 Vali Acc: 0.789 Test Loss: 0.812 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.156996965408325
Epoch: 43, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.824 Vali Acc: 0.783 Test Loss: 0.824 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.057732582092285
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.838 Vali Acc: 0.776 Test Loss: 0.838 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.0496766567230225
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.847 Vali Acc: 0.783 Test Loss: 0.847 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 205508
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.304684638977051
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.422 Vali Acc: 0.316 Test Loss: 1.422 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 2.487154722213745
Epoch: 2, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.387 Vali Acc: 0.303 Test Loss: 1.387 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2478537559509277
Epoch: 3, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.341 Vali Acc: 0.316 Test Loss: 1.341 Test Acc: 0.316
Validation loss decreased (-0.315775 --> -0.315776).  Saving model ...
Epoch: 4 cost time: 2.1190176010131836
Epoch: 4, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.289 Vali Acc: 0.414 Test Loss: 1.289 Test Acc: 0.414
Validation loss decreased (-0.315776 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 2.249302864074707
Epoch: 5, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.236 Vali Acc: 0.454 Test Loss: 1.236 Test Acc: 0.454
Validation loss decreased (-0.414461 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 2.0744919776916504
Epoch: 6, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
Validation loss decreased (-0.453935 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 2.314502000808716
Epoch: 7, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.121 Vali Acc: 0.559 Test Loss: 1.121 Test Acc: 0.559
Validation loss decreased (-0.499988 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 2.390612840652466
Epoch: 8, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.071 Vali Acc: 0.572 Test Loss: 1.071 Test Acc: 0.572
Validation loss decreased (-0.559199 --> -0.572358).  Saving model ...
Epoch: 9 cost time: 2.319167137145996
Epoch: 9, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.019 Vali Acc: 0.605 Test Loss: 1.019 Test Acc: 0.605
Validation loss decreased (-0.572358 --> -0.605253).  Saving model ...
Epoch: 10 cost time: 2.4261462688446045
Epoch: 10, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.966 Vali Acc: 0.632 Test Loss: 0.966 Test Acc: 0.632
Validation loss decreased (-0.605253 --> -0.631569).  Saving model ...
Epoch: 11 cost time: 2.2627487182617188
Epoch: 11, Steps: 10 | Train Loss: 0.641 Vali Loss: 0.914 Vali Acc: 0.638 Test Loss: 0.914 Test Acc: 0.638
Validation loss decreased (-0.631569 --> -0.638149).  Saving model ...
Epoch: 12 cost time: 2.0623018741607666
Epoch: 12, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.866 Vali Acc: 0.658 Test Loss: 0.866 Test Acc: 0.658
Validation loss decreased (-0.638149 --> -0.657886).  Saving model ...
Epoch: 13 cost time: 2.32792592048645
Epoch: 13, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.814 Vali Acc: 0.684 Test Loss: 0.814 Test Acc: 0.684
Validation loss decreased (-0.657886 --> -0.684202).  Saving model ...
Epoch: 14 cost time: 2.248098611831665
Epoch: 14, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.769 Vali Acc: 0.704 Test Loss: 0.769 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703940).  Saving model ...
Epoch: 15 cost time: 2.1742632389068604
Epoch: 15, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.735 Vali Acc: 0.711 Test Loss: 0.735 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 16 cost time: 1.910339117050171
Epoch: 16, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.707 Vali Acc: 0.717 Test Loss: 0.707 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 17 cost time: 2.382345199584961
Epoch: 17, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.691 Vali Acc: 0.730 Test Loss: 0.691 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 18 cost time: 2.632746696472168
Epoch: 18, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.673 Vali Acc: 0.724 Test Loss: 0.673 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.297623872756958
Epoch: 19, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.661 Vali Acc: 0.724 Test Loss: 0.661 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.585134506225586
Epoch: 20, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.654 Vali Acc: 0.730 Test Loss: 0.654 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 21 cost time: 2.5893871784210205
Epoch: 21, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.645 Vali Acc: 0.743 Test Loss: 0.645 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 22 cost time: 2.093026638031006
Epoch: 22, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749993).  Saving model ...
Epoch: 23 cost time: 2.12786865234375
Epoch: 23, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.664 Vali Acc: 0.737 Test Loss: 0.664 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.04148006439209
Epoch: 24, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.662 Vali Acc: 0.757 Test Loss: 0.662 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 25 cost time: 2.092491865158081
Epoch: 25, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.662 Vali Acc: 0.763 Test Loss: 0.662 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 26 cost time: 2.2912535667419434
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.669 Vali Acc: 0.770 Test Loss: 0.669 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 27 cost time: 2.5056869983673096
Epoch: 27, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.674 Vali Acc: 0.776 Test Loss: 0.674 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 28 cost time: 2.3056371212005615
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.685 Vali Acc: 0.763 Test Loss: 0.685 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.602569818496704
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.698 Vali Acc: 0.770 Test Loss: 0.698 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.5041730403900146
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.702 Vali Acc: 0.776 Test Loss: 0.702 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.081148624420166
Epoch: 31, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.711 Vali Acc: 0.763 Test Loss: 0.711 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.097532033920288
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.722 Vali Acc: 0.763 Test Loss: 0.722 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.2974936962127686
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.734 Vali Acc: 0.783 Test Loss: 0.734 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782887).  Saving model ...
Epoch: 34 cost time: 2.0421111583709717
Epoch: 34, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.739 Vali Acc: 0.783 Test Loss: 0.739 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.6107637882232666
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.751 Vali Acc: 0.776 Test Loss: 0.751 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.3760693073272705
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.761 Vali Acc: 0.776 Test Loss: 0.761 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.3227851390838623
Epoch: 37, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.769 Vali Acc: 0.776 Test Loss: 0.769 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.326915979385376
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.768 Vali Acc: 0.776 Test Loss: 0.768 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.268972396850586
Epoch: 39, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.767 Vali Acc: 0.789 Test Loss: 0.767 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789466).  Saving model ...
Epoch: 40 cost time: 2.539296865463257
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.786 Vali Acc: 0.776 Test Loss: 0.786 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.2734758853912354
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.797 Vali Acc: 0.770 Test Loss: 0.797 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.4783706665039062
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.809 Vali Acc: 0.776 Test Loss: 0.809 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.1520421504974365
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.818 Vali Acc: 0.776 Test Loss: 0.818 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.380260705947876
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.825 Vali Acc: 0.783 Test Loss: 0.825 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.2553603649139404
Epoch: 45, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.832 Vali Acc: 0.783 Test Loss: 0.832 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.5168564319610596
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.836 Vali Acc: 0.789 Test Loss: 0.836 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.374978542327881
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.836 Vali Acc: 0.789 Test Loss: 0.836 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.3494458198547363
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.839 Vali Acc: 0.783 Test Loss: 0.839 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.2900173664093018
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.843 Vali Acc: 0.783 Test Loss: 0.843 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 205508
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8855934143066406
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.378 Vali Acc: 0.257 Test Loss: 1.378 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.9759807586669922
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.356 Vali Acc: 0.303 Test Loss: 1.356 Test Acc: 0.303
Validation loss decreased (-0.256565 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 2.119122266769409
Epoch: 3, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.328 Vali Acc: 0.336 Test Loss: 1.328 Test Acc: 0.336
Validation loss decreased (-0.302618 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 2.2387659549713135
Epoch: 4, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.292 Vali Acc: 0.414 Test Loss: 1.292 Test Acc: 0.414
Validation loss decreased (-0.335513 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 2.137925863265991
Epoch: 5, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.257 Vali Acc: 0.434 Test Loss: 1.257 Test Acc: 0.434
Validation loss decreased (-0.414461 --> -0.434198).  Saving model ...
Epoch: 6 cost time: 2.2357308864593506
Epoch: 6, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.217 Vali Acc: 0.474 Test Loss: 1.217 Test Acc: 0.474
Validation loss decreased (-0.434198 --> -0.473672).  Saving model ...
Epoch: 7 cost time: 2.0447170734405518
Epoch: 7, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.171 Vali Acc: 0.520 Test Loss: 1.171 Test Acc: 0.520
Validation loss decreased (-0.473672 --> -0.519725).  Saving model ...
Epoch: 8 cost time: 2.058051347732544
Epoch: 8, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.125 Vali Acc: 0.559 Test Loss: 1.125 Test Acc: 0.559
Validation loss decreased (-0.519725 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 2.1209895610809326
Epoch: 9, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.076 Vali Acc: 0.539 Test Loss: 1.076 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.031362295150757
Epoch: 10, Steps: 10 | Train Loss: 0.772 Vali Loss: 1.025 Vali Acc: 0.566 Test Loss: 1.025 Test Acc: 0.566
Validation loss decreased (-0.559199 --> -0.565779).  Saving model ...
Epoch: 11 cost time: 2.076828718185425
Epoch: 11, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.969 Vali Acc: 0.579 Test Loss: 0.969 Test Acc: 0.579
Validation loss decreased (-0.565779 --> -0.578938).  Saving model ...
Epoch: 12 cost time: 2.126345157623291
Epoch: 12, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.914 Vali Acc: 0.586 Test Loss: 0.914 Test Acc: 0.586
Validation loss decreased (-0.578938 --> -0.585517).  Saving model ...
Epoch: 13 cost time: 2.4282116889953613
Epoch: 13, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.859 Vali Acc: 0.605 Test Loss: 0.859 Test Acc: 0.605
Validation loss decreased (-0.585517 --> -0.605255).  Saving model ...
Epoch: 14 cost time: 2.1611135005950928
Epoch: 14, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.803 Vali Acc: 0.625 Test Loss: 0.803 Test Acc: 0.625
Validation loss decreased (-0.605255 --> -0.624992).  Saving model ...
Epoch: 15 cost time: 2.2709548473358154
Epoch: 15, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.753 Vali Acc: 0.691 Test Loss: 0.753 Test Acc: 0.691
Validation loss decreased (-0.624992 --> -0.690782).  Saving model ...
Epoch: 16 cost time: 2.353078842163086
Epoch: 16, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.707 Vali Acc: 0.697 Test Loss: 0.707 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697361).  Saving model ...
Epoch: 17 cost time: 2.2584705352783203
Epoch: 17, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.682 Vali Acc: 0.724 Test Loss: 0.682 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 2.03359055519104
Epoch: 18, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.666 Vali Acc: 0.724 Test Loss: 0.666 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723678).  Saving model ...
Epoch: 19 cost time: 2.1411540508270264
Epoch: 19, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.652 Vali Acc: 0.743 Test Loss: 0.652 Test Acc: 0.743
Validation loss decreased (-0.723678 --> -0.743415).  Saving model ...
Epoch: 20 cost time: 2.1067066192626953
Epoch: 20, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.638 Vali Acc: 0.757 Test Loss: 0.638 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 21 cost time: 2.079345703125
Epoch: 21, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.638 Vali Acc: 0.763 Test Loss: 0.638 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 22 cost time: 2.0339739322662354
Epoch: 22, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.638 Vali Acc: 0.776 Test Loss: 0.638 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776309).  Saving model ...
Epoch: 23 cost time: 2.241612195968628
Epoch: 23, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.645 Vali Acc: 0.783 Test Loss: 0.645 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 24 cost time: 2.1669318675994873
Epoch: 24, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.643 Vali Acc: 0.783 Test Loss: 0.643 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 25 cost time: 2.1538405418395996
Epoch: 25, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.642 Vali Acc: 0.783 Test Loss: 0.642 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 26 cost time: 2.2352535724639893
Epoch: 26, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.243450880050659
Epoch: 27, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.656 Vali Acc: 0.776 Test Loss: 0.656 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.124573230743408
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.665 Vali Acc: 0.776 Test Loss: 0.665 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0439860820770264
Epoch: 29, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.667 Vali Acc: 0.776 Test Loss: 0.667 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9711823463439941
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.670 Vali Acc: 0.776 Test Loss: 0.670 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.862522840499878
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.675 Vali Acc: 0.789 Test Loss: 0.675 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 32 cost time: 2.3501861095428467
Epoch: 32, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.681 Vali Acc: 0.776 Test Loss: 0.681 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2112877368927
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.693 Vali Acc: 0.770 Test Loss: 0.693 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.3195409774780273
Epoch: 34, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.704 Vali Acc: 0.770 Test Loss: 0.704 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.5367398262023926
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.718 Vali Acc: 0.776 Test Loss: 0.718 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.5791289806365967
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.728 Vali Acc: 0.789 Test Loss: 0.728 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.1201653480529785
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.2263524532318115
Epoch: 38, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.739 Vali Acc: 0.783 Test Loss: 0.739 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.149797201156616
Epoch: 39, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.746 Vali Acc: 0.789 Test Loss: 0.746 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.1493232250213623
Epoch: 40, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.759 Vali Acc: 0.796 Test Loss: 0.759 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 41 cost time: 1.7997386455535889
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.771 Vali Acc: 0.789 Test Loss: 0.771 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.231250524520874
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.801 Vali Acc: 0.789 Test Loss: 0.801 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.2286911010742188
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.814 Vali Acc: 0.803 Test Loss: 0.814 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802623).  Saving model ...
Epoch: 44 cost time: 2.256145715713501
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.820 Vali Acc: 0.796 Test Loss: 0.820 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.166381359100342
Epoch: 45, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.823 Vali Acc: 0.796 Test Loss: 0.823 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.2904605865478516
Epoch: 46, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.822 Vali Acc: 0.796 Test Loss: 0.822 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.452474355697632
Epoch: 47, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.822 Vali Acc: 0.803 Test Loss: 0.822 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.461507558822632
Epoch: 48, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.825 Vali Acc: 0.803 Test Loss: 0.825 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.4113025665283203
Epoch: 49, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.823 Vali Acc: 0.809 Test Loss: 0.823 Test Acc: 0.809
Validation loss decreased (-0.802623 --> -0.809202).  Saving model ...
Epoch: 50 cost time: 2.2855772972106934
Epoch: 50, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.822 Vali Acc: 0.809 Test Loss: 0.822 Test Acc: 0.809
Validation loss decreased (-0.809202 --> -0.809202).  Saving model ...
Epoch: 51 cost time: 2.325307846069336
Epoch: 51, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.831 Vali Acc: 0.809 Test Loss: 0.831 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.2591452598571777
Epoch: 52, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.835 Vali Acc: 0.803 Test Loss: 0.835 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.182346820831299
Epoch: 53, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.838 Vali Acc: 0.809 Test Loss: 0.838 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.2903096675872803
Epoch: 54, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.839 Vali Acc: 0.803 Test Loss: 0.839 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.3232262134552
Epoch: 55, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.845 Vali Acc: 0.803 Test Loss: 0.845 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.418752670288086
Epoch: 56, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.853 Vali Acc: 0.803 Test Loss: 0.853 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.4469473361968994
Epoch: 57, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.860 Vali Acc: 0.803 Test Loss: 0.860 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.3761110305786133
Epoch: 58, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.868 Vali Acc: 0.803 Test Loss: 0.868 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 2.354487419128418
Epoch: 59, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.877 Vali Acc: 0.796 Test Loss: 0.877 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 2.2891366481781006
Epoch: 60, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.885 Vali Acc: 0.796 Test Loss: 0.885 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 205508
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.208692312240601
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.430 Vali Acc: 0.276 Test Loss: 1.430 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 2.3044052124023438
Epoch: 2, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.419 Vali Acc: 0.257 Test Loss: 1.419 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4061639308929443
Epoch: 3, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.405 Vali Acc: 0.296 Test Loss: 1.405 Test Acc: 0.296
Validation loss decreased (-0.276301 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 2.273475170135498
Epoch: 4, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.384 Vali Acc: 0.309 Test Loss: 1.384 Test Acc: 0.309
Validation loss decreased (-0.296039 --> -0.309197).  Saving model ...
Epoch: 5 cost time: 2.1695425510406494
Epoch: 5, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.360 Vali Acc: 0.322 Test Loss: 1.360 Test Acc: 0.322
Validation loss decreased (-0.309197 --> -0.322355).  Saving model ...
Epoch: 6 cost time: 2.069657802581787
Epoch: 6, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.323 Vali Acc: 0.355 Test Loss: 1.323 Test Acc: 0.355
Validation loss decreased (-0.322355 --> -0.355250).  Saving model ...
Epoch: 7 cost time: 2.0725784301757812
Epoch: 7, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.273 Vali Acc: 0.382 Test Loss: 1.273 Test Acc: 0.382
Validation loss decreased (-0.355250 --> -0.381566).  Saving model ...
Epoch: 8 cost time: 2.2863712310791016
Epoch: 8, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.217 Vali Acc: 0.447 Test Loss: 1.217 Test Acc: 0.447
Validation loss decreased (-0.381566 --> -0.447356).  Saving model ...
Epoch: 9 cost time: 2.2296640872955322
Epoch: 9, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
Validation loss decreased (-0.447356 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 2.3793163299560547
Epoch: 10, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.083 Vali Acc: 0.546 Test Loss: 1.083 Test Acc: 0.546
Validation loss decreased (-0.499988 --> -0.546042).  Saving model ...
Epoch: 11 cost time: 2.132949113845825
Epoch: 11, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.005 Vali Acc: 0.618 Test Loss: 1.005 Test Acc: 0.618
Validation loss decreased (-0.546042 --> -0.618411).  Saving model ...
Epoch: 12 cost time: 2.1922309398651123
Epoch: 12, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.936 Vali Acc: 0.664 Test Loss: 0.936 Test Acc: 0.664
Validation loss decreased (-0.618411 --> -0.664464).  Saving model ...
Epoch: 13 cost time: 2.027157783508301
Epoch: 13, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.874 Vali Acc: 0.671 Test Loss: 0.874 Test Acc: 0.671
Validation loss decreased (-0.664464 --> -0.671044).  Saving model ...
Epoch: 14 cost time: 2.0644373893737793
Epoch: 14, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.819 Vali Acc: 0.645 Test Loss: 0.819 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9935269355773926
Epoch: 15, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.769 Vali Acc: 0.678 Test Loss: 0.769 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677624).  Saving model ...
Epoch: 16 cost time: 2.2642264366149902
Epoch: 16, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.734 Vali Acc: 0.678 Test Loss: 0.734 Test Acc: 0.678
Validation loss decreased (-0.677624 --> -0.677624).  Saving model ...
Epoch: 17 cost time: 2.231778144836426
Epoch: 17, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.712 Vali Acc: 0.697 Test Loss: 0.712 Test Acc: 0.697
Validation loss decreased (-0.677624 --> -0.697361).  Saving model ...
Epoch: 18 cost time: 2.2554781436920166
Epoch: 18, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.685 Vali Acc: 0.730 Test Loss: 0.685 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 19 cost time: 2.2705304622650146
Epoch: 19, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 20 cost time: 2.3840155601501465
Epoch: 20, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.662 Vali Acc: 0.750 Test Loss: 0.662 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 2.2469093799591064
Epoch: 21, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.664 Vali Acc: 0.763 Test Loss: 0.664 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 22 cost time: 2.2122817039489746
Epoch: 22, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.687 Vali Acc: 0.743 Test Loss: 0.687 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.37164306640625
Epoch: 23, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.700 Vali Acc: 0.750 Test Loss: 0.700 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.5602593421936035
Epoch: 24, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.711 Vali Acc: 0.750 Test Loss: 0.711 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.258025884628296
Epoch: 25, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.721 Vali Acc: 0.737 Test Loss: 0.721 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.4492177963256836
Epoch: 26, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.723 Vali Acc: 0.737 Test Loss: 0.723 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.3798844814300537
Epoch: 27, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.3634016513824463
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.733 Vali Acc: 0.750 Test Loss: 0.733 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.363590955734253
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.755 Vali Acc: 0.763 Test Loss: 0.755 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.110994577407837
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.774 Vali Acc: 0.743 Test Loss: 0.774 Test Acc: 0.743
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.2432751655578613
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.776 Vali Acc: 0.730 Test Loss: 0.776 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 205508
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.253611087799072
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.434 Vali Acc: 0.237 Test Loss: 1.434 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 2.3537213802337646
Epoch: 2, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.418 Vali Acc: 0.243 Test Loss: 1.418 Test Acc: 0.243
Validation loss decreased (-0.236828 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 2.1107709407806396
Epoch: 3, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.400 Vali Acc: 0.270 Test Loss: 1.400 Test Acc: 0.270
Validation loss decreased (-0.243407 --> -0.269723).  Saving model ...
Epoch: 4 cost time: 2.261732816696167
Epoch: 4, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.373 Vali Acc: 0.283 Test Loss: 1.373 Test Acc: 0.283
Validation loss decreased (-0.269723 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 2.1314985752105713
Epoch: 5, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.344 Vali Acc: 0.289 Test Loss: 1.344 Test Acc: 0.289
Validation loss decreased (-0.282881 --> -0.289460).  Saving model ...
Epoch: 6 cost time: 2.323612689971924
Epoch: 6, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.306 Vali Acc: 0.342 Test Loss: 1.306 Test Acc: 0.342
Validation loss decreased (-0.289460 --> -0.342092).  Saving model ...
Epoch: 7 cost time: 2.453176498413086
Epoch: 7, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.252 Vali Acc: 0.375 Test Loss: 1.252 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 2.315789222717285
Epoch: 8, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.191 Vali Acc: 0.474 Test Loss: 1.191 Test Acc: 0.474
Validation loss decreased (-0.374987 --> -0.473672).  Saving model ...
Epoch: 9 cost time: 2.368382215499878
Epoch: 9, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.122 Vali Acc: 0.553 Test Loss: 1.122 Test Acc: 0.553
Validation loss decreased (-0.473672 --> -0.552620).  Saving model ...
Epoch: 10 cost time: 2.062992572784424
Epoch: 10, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.045 Vali Acc: 0.592 Test Loss: 1.045 Test Acc: 0.592
Validation loss decreased (-0.552620 --> -0.592095).  Saving model ...
Epoch: 11 cost time: 2.0512425899505615
Epoch: 11, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.964 Vali Acc: 0.638 Test Loss: 0.964 Test Acc: 0.638
Validation loss decreased (-0.592095 --> -0.638148).  Saving model ...
Epoch: 12 cost time: 2.1350951194763184
Epoch: 12, Steps: 10 | Train Loss: 0.651 Vali Loss: 0.889 Vali Acc: 0.684 Test Loss: 0.889 Test Acc: 0.684
Validation loss decreased (-0.638148 --> -0.684202).  Saving model ...
Epoch: 13 cost time: 2.049903392791748
Epoch: 13, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.822 Vali Acc: 0.711 Test Loss: 0.822 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710518).  Saving model ...
Epoch: 14 cost time: 2.3560895919799805
Epoch: 14, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.771 Vali Acc: 0.691 Test Loss: 0.771 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.531686544418335
Epoch: 15, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.735 Vali Acc: 0.730 Test Loss: 0.735 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 16 cost time: 2.3515968322753906
Epoch: 16, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.711 Vali Acc: 0.730 Test Loss: 0.711 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 17 cost time: 2.075974464416504
Epoch: 17, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.697 Vali Acc: 0.730 Test Loss: 0.697 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 18 cost time: 2.156557559967041
Epoch: 18, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.680 Vali Acc: 0.730 Test Loss: 0.680 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 19 cost time: 2.2887141704559326
Epoch: 19, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.661 Vali Acc: 0.750 Test Loss: 0.661 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 20 cost time: 2.4145750999450684
Epoch: 20, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.652 Vali Acc: 0.757 Test Loss: 0.652 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 21 cost time: 2.15598201751709
Epoch: 21, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.652 Vali Acc: 0.743 Test Loss: 0.652 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1888415813446045
Epoch: 22, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.668 Vali Acc: 0.743 Test Loss: 0.668 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2282803058624268
Epoch: 23, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.682 Vali Acc: 0.743 Test Loss: 0.682 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.3323898315429688
Epoch: 24, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.687 Vali Acc: 0.750 Test Loss: 0.687 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.304645299911499
Epoch: 25, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.693 Vali Acc: 0.757 Test Loss: 0.693 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.3217451572418213
Epoch: 26, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.704 Vali Acc: 0.750 Test Loss: 0.704 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.431812047958374
Epoch: 27, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.713 Vali Acc: 0.763 Test Loss: 0.713 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 28 cost time: 2.570413827896118
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.728 Vali Acc: 0.770 Test Loss: 0.728 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 29 cost time: 2.1738784313201904
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.739 Vali Acc: 0.770 Test Loss: 0.739 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.2424583435058594
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.748 Vali Acc: 0.763 Test Loss: 0.748 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.296107292175293
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.753 Vali Acc: 0.763 Test Loss: 0.753 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.095843553543091
Epoch: 32, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.750 Vali Acc: 0.770 Test Loss: 0.750 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.1933083534240723
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.759 Vali Acc: 0.776 Test Loss: 0.759 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776308).  Saving model ...
Epoch: 34 cost time: 2.5104050636291504
Epoch: 34, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.769 Vali Acc: 0.770 Test Loss: 0.769 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.2481942176818848
Epoch: 35, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.785 Vali Acc: 0.770 Test Loss: 0.785 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.354579210281372
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.794 Vali Acc: 0.770 Test Loss: 0.794 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.427894353866577
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.803 Vali Acc: 0.770 Test Loss: 0.803 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.320220947265625
Epoch: 38, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.801 Vali Acc: 0.757 Test Loss: 0.801 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.263641595840454
Epoch: 39, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.796 Vali Acc: 0.763 Test Loss: 0.796 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.3406450748443604
Epoch: 40, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.818 Vali Acc: 0.757 Test Loss: 0.818 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.2842276096343994
Epoch: 41, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.828 Vali Acc: 0.763 Test Loss: 0.828 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.490842580795288
Epoch: 42, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.838 Vali Acc: 0.757 Test Loss: 0.838 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.5218636989593506
Epoch: 43, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.849 Vali Acc: 0.757 Test Loss: 0.849 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 205508
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.034893989562988
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 2.0957627296447754
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 1.967625379562378
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 4 cost time: 2.3718910217285156
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 5 cost time: 2.3044207096099854
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 6 cost time: 2.189378261566162
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 7 cost time: 2.3698201179504395
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 8 cost time: 2.3308475017547607
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 9 cost time: 2.2175350189208984
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 10 cost time: 2.2729074954986572
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.223670 --> -0.282881).  Saving model ...
Epoch: 11 cost time: 2.2137258052825928
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 12 cost time: 2.0637736320495605
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 13 cost time: 2.278249979019165
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 2.182668685913086
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 2.2120065689086914
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.085749626159668
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9635167121887207
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 2.110624313354492
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 2.2672343254089355
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 2.5247178077697754
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 2.366142749786377
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.047374963760376
Epoch: 22, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.4051856994628906
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.371488094329834
Epoch: 24, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 2.158515691757202
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 2.2604384422302246
Epoch: 26, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.322427272796631
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.2951765060424805
Epoch: 28, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.2726006507873535
Epoch: 29, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.1809380054473877
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2268855571746826
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 2.237534523010254
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.512507200241089
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.413645029067993
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.2456576824188232
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 2.3719913959503174
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.4333510398864746
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.04496169090271
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.0270843505859375
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.026165246963501
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.2999820709228516
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.4163079261779785
Epoch: 42, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 2.2543959617614746
Epoch: 43, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.275031805038452
Epoch: 44, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 45 cost time: 2.1878185272216797
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.3056275844573975
Epoch: 46, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 2.1160268783569336
Epoch: 47, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 48 cost time: 2.07732892036438
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.3388891220092773
Epoch: 49, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.429494857788086
Epoch: 50, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.403233051300049
Epoch: 51, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 52 cost time: 2.4607746601104736
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 53 cost time: 2.2354331016540527
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 2.173308849334717
Epoch: 54, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 55 cost time: 2.287792205810547
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 56 cost time: 2.2723958492279053
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 57 cost time: 2.2221109867095947
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.292165517807007
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.080522298812866
Epoch: 59, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.3197524547576904
Epoch: 60, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 2.4392075538635254
Epoch: 61, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 2.2329492568969727
Epoch: 62, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 2.125746250152588
Epoch: 63, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 2.0002973079681396
Epoch: 64, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 2.0016229152679443
Epoch: 65, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 2.5663862228393555
Epoch: 66, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 67 cost time: 2.3315658569335938
Epoch: 67, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.236921548843384
Epoch: 68, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 2.3003647327423096
Epoch: 69, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.9929773807525635
Epoch: 70, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 2.254382848739624
Epoch: 71, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.9731991291046143
Epoch: 72, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 2.369020938873291
Epoch: 73, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 2.1887447834014893
Epoch: 74, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 2.254570960998535
Epoch: 75, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 2.2092151641845703
Epoch: 76, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 205508
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.240155458450317
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.424 Vali Acc: 0.283 Test Loss: 1.424 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 2.5250627994537354
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.356 Vali Acc: 0.296 Test Loss: 1.356 Test Acc: 0.296
Validation loss decreased (-0.282880 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 2.2113754749298096
Epoch: 3, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.273 Vali Acc: 0.382 Test Loss: 1.273 Test Acc: 0.382
Validation loss decreased (-0.296039 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 2.3628153800964355
Epoch: 4, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.187 Vali Acc: 0.526 Test Loss: 1.187 Test Acc: 0.526
Validation loss decreased (-0.381566 --> -0.526304).  Saving model ...
Epoch: 5 cost time: 2.247758388519287
Epoch: 5, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.117 Vali Acc: 0.579 Test Loss: 1.117 Test Acc: 0.579
Validation loss decreased (-0.526304 --> -0.578936).  Saving model ...
Epoch: 6 cost time: 2.285158157348633
Epoch: 6, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.048 Vali Acc: 0.625 Test Loss: 1.048 Test Acc: 0.625
Validation loss decreased (-0.578936 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 2.4175355434417725
Epoch: 7, Steps: 10 | Train Loss: 0.848 Vali Loss: 0.990 Vali Acc: 0.638 Test Loss: 0.990 Test Acc: 0.638
Validation loss decreased (-0.624990 --> -0.638148).  Saving model ...
Epoch: 8 cost time: 2.081503391265869
Epoch: 8, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.945 Vali Acc: 0.651 Test Loss: 0.945 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651306).  Saving model ...
Epoch: 9 cost time: 2.3413665294647217
Epoch: 9, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.905 Vali Acc: 0.664 Test Loss: 0.905 Test Acc: 0.664
Validation loss decreased (-0.651306 --> -0.664465).  Saving model ...
Epoch: 10 cost time: 2.425905704498291
Epoch: 10, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.868 Vali Acc: 0.678 Test Loss: 0.868 Test Acc: 0.678
Validation loss decreased (-0.664465 --> -0.677623).  Saving model ...
Epoch: 11 cost time: 2.3272078037261963
Epoch: 11, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.838 Vali Acc: 0.684 Test Loss: 0.838 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684202).  Saving model ...
Epoch: 12 cost time: 2.3693346977233887
Epoch: 12, Steps: 10 | Train Loss: 0.445 Vali Loss: 0.808 Vali Acc: 0.711 Test Loss: 0.808 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710518).  Saving model ...
Epoch: 13 cost time: 2.190194845199585
Epoch: 13, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.786 Vali Acc: 0.737 Test Loss: 0.786 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736834).  Saving model ...
Epoch: 14 cost time: 2.1607964038848877
Epoch: 14, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.762 Vali Acc: 0.730 Test Loss: 0.762 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2272911071777344
Epoch: 15, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.734 Vali Acc: 0.763 Test Loss: 0.734 Test Acc: 0.763
Validation loss decreased (-0.736834 --> -0.763151).  Saving model ...
Epoch: 16 cost time: 2.445413112640381
Epoch: 16, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.704 Vali Acc: 0.750 Test Loss: 0.704 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3584203720092773
Epoch: 17, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.683 Vali Acc: 0.763 Test Loss: 0.683 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 18 cost time: 2.6487083435058594
Epoch: 18, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.676 Vali Acc: 0.783 Test Loss: 0.676 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782888).  Saving model ...
Epoch: 19 cost time: 2.430485963821411
Epoch: 19, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 20 cost time: 2.017585277557373
Epoch: 20, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 21 cost time: 1.9501004219055176
Epoch: 21, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 22 cost time: 2.2411348819732666
Epoch: 22, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 23 cost time: 2.3629038333892822
Epoch: 23, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 24 cost time: 2.4975383281707764
Epoch: 24, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 25 cost time: 2.6295976638793945
Epoch: 25, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 26 cost time: 2.447195053100586
Epoch: 26, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3959085941314697
Epoch: 27, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.647 Vali Acc: 0.816 Test Loss: 0.647 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 28 cost time: 2.4710123538970947
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.652 Vali Acc: 0.809 Test Loss: 0.652 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1979403495788574
Epoch: 29, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.657 Vali Acc: 0.803 Test Loss: 0.657 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.4780139923095703
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.663 Vali Acc: 0.809 Test Loss: 0.663 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.4879331588745117
Epoch: 31, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.676 Vali Acc: 0.816 Test Loss: 0.676 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.4962847232818604
Epoch: 32, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.683 Vali Acc: 0.816 Test Loss: 0.683 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.428356885910034
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.678 Vali Acc: 0.816 Test Loss: 0.678 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.4798059463500977
Epoch: 34, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.686 Vali Acc: 0.816 Test Loss: 0.686 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.506135940551758
Epoch: 35, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.696 Vali Acc: 0.816 Test Loss: 0.696 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.2709012031555176
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.709 Vali Acc: 0.809 Test Loss: 0.709 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.3799421787261963
Epoch: 37, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 156356
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6474392414093018
Epoch: 1, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.408 Vali Acc: 0.250 Test Loss: 1.408 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.951155424118042
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.354 Vali Acc: 0.270 Test Loss: 1.354 Test Acc: 0.270
Validation loss decreased (-0.249986 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 2.0902860164642334
Epoch: 3, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.287 Vali Acc: 0.368 Test Loss: 1.287 Test Acc: 0.368
Validation loss decreased (-0.269723 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 2.0629992485046387
Epoch: 4, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
Validation loss decreased (-0.368408 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.9588909149169922
Epoch: 5, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.155 Vali Acc: 0.520 Test Loss: 1.155 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519725).  Saving model ...
Epoch: 6 cost time: 2.1217856407165527
Epoch: 6, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.093 Vali Acc: 0.579 Test Loss: 1.093 Test Acc: 0.579
Validation loss decreased (-0.519725 --> -0.578936).  Saving model ...
Epoch: 7 cost time: 2.0734493732452393
Epoch: 7, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.038 Vali Acc: 0.599 Test Loss: 1.038 Test Acc: 0.599
Validation loss decreased (-0.578936 --> -0.598674).  Saving model ...
Epoch: 8 cost time: 2.0797882080078125
Epoch: 8, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.990 Vali Acc: 0.612 Test Loss: 0.990 Test Acc: 0.612
Validation loss decreased (-0.598674 --> -0.611832).  Saving model ...
Epoch: 9 cost time: 2.111118793487549
Epoch: 9, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.948 Vali Acc: 0.632 Test Loss: 0.948 Test Acc: 0.632
Validation loss decreased (-0.611832 --> -0.631569).  Saving model ...
Epoch: 10 cost time: 2.058529853820801
Epoch: 10, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.909 Vali Acc: 0.658 Test Loss: 0.909 Test Acc: 0.658
Validation loss decreased (-0.631569 --> -0.657886).  Saving model ...
Epoch: 11 cost time: 2.1138858795166016
Epoch: 11, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.872 Vali Acc: 0.691 Test Loss: 0.872 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690781).  Saving model ...
Epoch: 12 cost time: 2.024184465408325
Epoch: 12, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.836 Vali Acc: 0.697 Test Loss: 0.836 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697360).  Saving model ...
Epoch: 13 cost time: 2.079765558242798
Epoch: 13, Steps: 10 | Train Loss: 0.445 Vali Loss: 0.806 Vali Acc: 0.717 Test Loss: 0.806 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717097).  Saving model ...
Epoch: 14 cost time: 2.1212503910064697
Epoch: 14, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.771 Vali Acc: 0.730 Test Loss: 0.771 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730255).  Saving model ...
Epoch: 15 cost time: 2.4028947353363037
Epoch: 15, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.733 Vali Acc: 0.743 Test Loss: 0.733 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743414).  Saving model ...
Epoch: 16 cost time: 2.2588186264038086
Epoch: 16, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.696 Vali Acc: 0.776 Test Loss: 0.696 Test Acc: 0.776
Validation loss decreased (-0.743414 --> -0.776309).  Saving model ...
Epoch: 17 cost time: 2.2553629875183105
Epoch: 17, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.670 Vali Acc: 0.783 Test Loss: 0.670 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 18 cost time: 2.3202764987945557
Epoch: 18, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.658 Vali Acc: 0.776 Test Loss: 0.658 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2981979846954346
Epoch: 19, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.643 Vali Acc: 0.796 Test Loss: 0.643 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796046).  Saving model ...
Epoch: 20 cost time: 2.2414326667785645
Epoch: 20, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.632 Vali Acc: 0.796 Test Loss: 0.632 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796046).  Saving model ...
Epoch: 21 cost time: 2.247849941253662
Epoch: 21, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1139323711395264
Epoch: 22, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.620 Vali Acc: 0.789 Test Loss: 0.620 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2851173877716064
Epoch: 23, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.622 Vali Acc: 0.796 Test Loss: 0.622 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796046).  Saving model ...
Epoch: 24 cost time: 2.2159852981567383
Epoch: 24, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.628 Vali Acc: 0.809 Test Loss: 0.628 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809204).  Saving model ...
Epoch: 25 cost time: 2.2858550548553467
Epoch: 25, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.628 Vali Acc: 0.796 Test Loss: 0.628 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.382770299911499
Epoch: 26, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.638 Vali Acc: 0.796 Test Loss: 0.638 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.145671844482422
Epoch: 27, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.648 Vali Acc: 0.796 Test Loss: 0.648 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.173224449157715
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.1446433067321777
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.663 Vali Acc: 0.809 Test Loss: 0.663 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.199324369430542
Epoch: 30, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.670 Vali Acc: 0.789 Test Loss: 0.670 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.104921579360962
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.682 Vali Acc: 0.809 Test Loss: 0.682 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.100956916809082
Epoch: 32, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.688 Vali Acc: 0.809 Test Loss: 0.688 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.361618757247925
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.683 Vali Acc: 0.796 Test Loss: 0.683 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.234076499938965
Epoch: 34, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.691 Vali Acc: 0.809 Test Loss: 0.691 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 156356
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.070636749267578
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.429 Vali Acc: 0.237 Test Loss: 1.429 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 2.330758571624756
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
Validation loss decreased (-0.236828 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 2.1862380504608154
Epoch: 3, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.346 Vali Acc: 0.309 Test Loss: 1.346 Test Acc: 0.309
Validation loss decreased (-0.269723 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 2.540409803390503
Epoch: 4, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.292 Vali Acc: 0.395 Test Loss: 1.292 Test Acc: 0.395
Validation loss decreased (-0.309197 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 2.307263135910034
Epoch: 5, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.243 Vali Acc: 0.434 Test Loss: 1.243 Test Acc: 0.434
Validation loss decreased (-0.394724 --> -0.434198).  Saving model ...
Epoch: 6 cost time: 2.1432666778564453
Epoch: 6, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.434198 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 2.044020414352417
Epoch: 7, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.131 Vali Acc: 0.553 Test Loss: 1.131 Test Acc: 0.553
Validation loss decreased (-0.499988 --> -0.552620).  Saving model ...
Epoch: 8 cost time: 2.0919084548950195
Epoch: 8, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.080 Vali Acc: 0.566 Test Loss: 1.080 Test Acc: 0.566
Validation loss decreased (-0.552620 --> -0.565779).  Saving model ...
Epoch: 9 cost time: 2.1358439922332764
Epoch: 9, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.028 Vali Acc: 0.572 Test Loss: 1.028 Test Acc: 0.572
Validation loss decreased (-0.565779 --> -0.572358).  Saving model ...
Epoch: 10 cost time: 2.130514144897461
Epoch: 10, Steps: 10 | Train Loss: 0.771 Vali Loss: 0.977 Vali Acc: 0.586 Test Loss: 0.977 Test Acc: 0.586
Validation loss decreased (-0.572358 --> -0.585517).  Saving model ...
Epoch: 11 cost time: 2.4505672454833984
Epoch: 11, Steps: 10 | Train Loss: 0.646 Vali Loss: 0.922 Vali Acc: 0.625 Test Loss: 0.922 Test Acc: 0.625
Validation loss decreased (-0.585517 --> -0.624991).  Saving model ...
Epoch: 12 cost time: 2.359312057495117
Epoch: 12, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.868 Vali Acc: 0.645 Test Loss: 0.868 Test Acc: 0.645
Validation loss decreased (-0.624991 --> -0.644728).  Saving model ...
Epoch: 13 cost time: 2.1867430210113525
Epoch: 13, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.820 Vali Acc: 0.658 Test Loss: 0.820 Test Acc: 0.658
Validation loss decreased (-0.644728 --> -0.657887).  Saving model ...
Epoch: 14 cost time: 2.2321770191192627
Epoch: 14, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.772 Vali Acc: 0.684 Test Loss: 0.772 Test Acc: 0.684
Validation loss decreased (-0.657887 --> -0.684203).  Saving model ...
Epoch: 15 cost time: 2.337001085281372
Epoch: 15, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.732 Vali Acc: 0.697 Test Loss: 0.732 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 16 cost time: 2.203421115875244
Epoch: 16, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.699 Vali Acc: 0.691 Test Loss: 0.699 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.194577932357788
Epoch: 17, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.673 Vali Acc: 0.704 Test Loss: 0.673 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703941).  Saving model ...
Epoch: 18 cost time: 2.225625514984131
Epoch: 18, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.662 Vali Acc: 0.711 Test Loss: 0.662 Test Acc: 0.711
Validation loss decreased (-0.703941 --> -0.710520).  Saving model ...
Epoch: 19 cost time: 2.2882754802703857
Epoch: 19, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.644 Vali Acc: 0.737 Test Loss: 0.644 Test Acc: 0.737
Validation loss decreased (-0.710520 --> -0.736836).  Saving model ...
Epoch: 20 cost time: 2.3287904262542725
Epoch: 20, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.637 Vali Acc: 0.737 Test Loss: 0.637 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 21 cost time: 2.487396717071533
Epoch: 21, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 22 cost time: 2.265942096710205
Epoch: 22, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.627 Vali Acc: 0.763 Test Loss: 0.627 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 2.275707244873047
Epoch: 23, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.631 Vali Acc: 0.763 Test Loss: 0.631 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6451895236968994
Epoch: 24, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.194145441055298
Epoch: 25, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.635 Vali Acc: 0.770 Test Loss: 0.635 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769730).  Saving model ...
Epoch: 26 cost time: 2.2259457111358643
Epoch: 26, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.645 Vali Acc: 0.770 Test Loss: 0.645 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.256214141845703
Epoch: 27, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.653 Vali Acc: 0.770 Test Loss: 0.653 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.165074586868286
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.660 Vali Acc: 0.770 Test Loss: 0.660 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.123502731323242
Epoch: 29, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.670 Vali Acc: 0.776 Test Loss: 0.670 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 30 cost time: 2.211745262145996
Epoch: 30, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.679 Vali Acc: 0.770 Test Loss: 0.679 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0543627738952637
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.686 Vali Acc: 0.776 Test Loss: 0.686 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1632070541381836
Epoch: 32, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.690 Vali Acc: 0.770 Test Loss: 0.690 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.2660887241363525
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.691 Vali Acc: 0.763 Test Loss: 0.691 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.4390203952789307
Epoch: 34, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.696 Vali Acc: 0.770 Test Loss: 0.696 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.223510980606079
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.708 Vali Acc: 0.763 Test Loss: 0.708 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.2806317806243896
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.720 Vali Acc: 0.776 Test Loss: 0.720 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.9635894298553467
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.729 Vali Acc: 0.763 Test Loss: 0.729 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.2195358276367188
Epoch: 38, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.738 Vali Acc: 0.763 Test Loss: 0.738 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.3508858680725098
Epoch: 39, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.749 Vali Acc: 0.757 Test Loss: 0.749 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 156356
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.740356683731079
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.450 Vali Acc: 0.276 Test Loss: 1.450 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 2.2262024879455566
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.425 Vali Acc: 0.283 Test Loss: 1.425 Test Acc: 0.283
Validation loss decreased (-0.276301 --> -0.282880).  Saving model ...
Epoch: 3 cost time: 2.317629337310791
Epoch: 3, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.390 Vali Acc: 0.296 Test Loss: 1.390 Test Acc: 0.296
Validation loss decreased (-0.282880 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 2.2684175968170166
Epoch: 4, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.346 Vali Acc: 0.349 Test Loss: 1.346 Test Acc: 0.349
Validation loss decreased (-0.296039 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 2.1601202487945557
Epoch: 5, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.310 Vali Acc: 0.382 Test Loss: 1.310 Test Acc: 0.382
Validation loss decreased (-0.348671 --> -0.381566).  Saving model ...
Epoch: 6 cost time: 2.154680013656616
Epoch: 6, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.263 Vali Acc: 0.447 Test Loss: 1.263 Test Acc: 0.447
Validation loss decreased (-0.381566 --> -0.447356).  Saving model ...
Epoch: 7 cost time: 2.0243568420410156
Epoch: 7, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.212 Vali Acc: 0.461 Test Loss: 1.212 Test Acc: 0.461
Validation loss decreased (-0.447356 --> -0.460514).  Saving model ...
Epoch: 8 cost time: 2.0946309566497803
Epoch: 8, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.164 Vali Acc: 0.480 Test Loss: 1.164 Test Acc: 0.480
Validation loss decreased (-0.460514 --> -0.480252).  Saving model ...
Epoch: 9 cost time: 2.2330129146575928
Epoch: 9, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.109 Vali Acc: 0.493 Test Loss: 1.109 Test Acc: 0.493
Validation loss decreased (-0.480252 --> -0.493410).  Saving model ...
Epoch: 10 cost time: 2.2583725452423096
Epoch: 10, Steps: 10 | Train Loss: 0.805 Vali Loss: 1.051 Vali Acc: 0.553 Test Loss: 1.051 Test Acc: 0.553
Validation loss decreased (-0.493410 --> -0.552621).  Saving model ...
Epoch: 11 cost time: 2.323920965194702
Epoch: 11, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.985 Vali Acc: 0.599 Test Loss: 0.985 Test Acc: 0.599
Validation loss decreased (-0.552621 --> -0.598674).  Saving model ...
Epoch: 12 cost time: 2.213263511657715
Epoch: 12, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.920 Vali Acc: 0.638 Test Loss: 0.920 Test Acc: 0.638
Validation loss decreased (-0.598674 --> -0.638149).  Saving model ...
Epoch: 13 cost time: 2.1901779174804688
Epoch: 13, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.861 Vali Acc: 0.625 Test Loss: 0.861 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1271700859069824
Epoch: 14, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.800 Vali Acc: 0.638 Test Loss: 0.800 Test Acc: 0.638
Validation loss decreased (-0.638149 --> -0.638150).  Saving model ...
Epoch: 15 cost time: 2.106809616088867
Epoch: 15, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.751 Vali Acc: 0.651 Test Loss: 0.751 Test Acc: 0.651
Validation loss decreased (-0.638150 --> -0.651308).  Saving model ...
Epoch: 16 cost time: 2.0178065299987793
Epoch: 16, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.717 Vali Acc: 0.697 Test Loss: 0.717 Test Acc: 0.697
Validation loss decreased (-0.651308 --> -0.697361).  Saving model ...
Epoch: 17 cost time: 2.0173466205596924
Epoch: 17, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.686 Vali Acc: 0.730 Test Loss: 0.686 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 18 cost time: 2.1899850368499756
Epoch: 18, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.667 Vali Acc: 0.743 Test Loss: 0.667 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 19 cost time: 2.184307813644409
Epoch: 19, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.653 Vali Acc: 0.724 Test Loss: 0.653 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1700031757354736
Epoch: 20, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.646 Vali Acc: 0.743 Test Loss: 0.646 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 21 cost time: 2.1742587089538574
Epoch: 21, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.634 Vali Acc: 0.757 Test Loss: 0.634 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 22 cost time: 2.369361162185669
Epoch: 22, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.634 Vali Acc: 0.750 Test Loss: 0.634 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1245276927948
Epoch: 23, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.630 Vali Acc: 0.743 Test Loss: 0.630 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1247355937957764
Epoch: 24, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.635 Vali Acc: 0.743 Test Loss: 0.635 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2428903579711914
Epoch: 25, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.633 Vali Acc: 0.757 Test Loss: 0.633 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 26 cost time: 1.8640844821929932
Epoch: 26, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.641 Vali Acc: 0.763 Test Loss: 0.641 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763151).  Saving model ...
Epoch: 27 cost time: 1.9727611541748047
Epoch: 27, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.238511085510254
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.649 Vali Acc: 0.743 Test Loss: 0.649 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0015769004821777
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.658 Vali Acc: 0.763 Test Loss: 0.658 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9473297595977783
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 31 cost time: 2.148102283477783
Epoch: 31, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.675 Vali Acc: 0.776 Test Loss: 0.675 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9918971061706543
Epoch: 32, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.674 Vali Acc: 0.770 Test Loss: 0.674 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.2439446449279785
Epoch: 33, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.676 Vali Acc: 0.776 Test Loss: 0.676 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.3378589153289795
Epoch: 34, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 35 cost time: 2.182774543762207
Epoch: 35, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.691 Vali Acc: 0.796 Test Loss: 0.691 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796046).  Saving model ...
Epoch: 36 cost time: 2.271310567855835
Epoch: 36, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.697 Vali Acc: 0.789 Test Loss: 0.697 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.1608901023864746
Epoch: 37, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.700 Vali Acc: 0.796 Test Loss: 0.700 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.1737875938415527
Epoch: 38, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.715 Vali Acc: 0.789 Test Loss: 0.715 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.4207043647766113
Epoch: 39, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.729 Vali Acc: 0.783 Test Loss: 0.729 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.2485451698303223
Epoch: 40, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.733 Vali Acc: 0.789 Test Loss: 0.733 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.1665337085723877
Epoch: 41, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.2042510509490967
Epoch: 42, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.756 Vali Acc: 0.796 Test Loss: 0.756 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.0410680770874023
Epoch: 43, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.759 Vali Acc: 0.776 Test Loss: 0.759 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.328813076019287
Epoch: 44, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.766 Vali Acc: 0.776 Test Loss: 0.766 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.2058157920837402
Epoch: 45, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.771 Vali Acc: 0.783 Test Loss: 0.771 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 156356
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.983693838119507
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.423 Vali Acc: 0.257 Test Loss: 1.423 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 2.0046048164367676
Epoch: 2, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.406 Vali Acc: 0.263 Test Loss: 1.406 Test Acc: 0.263
Validation loss decreased (-0.256565 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 1.8654506206512451
Epoch: 3, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.384 Vali Acc: 0.296 Test Loss: 1.384 Test Acc: 0.296
Validation loss decreased (-0.263144 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 2.081712245941162
Epoch: 4, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.353 Vali Acc: 0.316 Test Loss: 1.353 Test Acc: 0.316
Validation loss decreased (-0.296039 --> -0.315776).  Saving model ...
Epoch: 5 cost time: 1.9019081592559814
Epoch: 5, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.322 Vali Acc: 0.329 Test Loss: 1.322 Test Acc: 0.329
Validation loss decreased (-0.315776 --> -0.328934).  Saving model ...
Epoch: 6 cost time: 2.044644355773926
Epoch: 6, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.285 Vali Acc: 0.408 Test Loss: 1.285 Test Acc: 0.408
Validation loss decreased (-0.328934 --> -0.407882).  Saving model ...
Epoch: 7 cost time: 2.1022913455963135
Epoch: 7, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.241 Vali Acc: 0.414 Test Loss: 1.241 Test Acc: 0.414
Validation loss decreased (-0.407882 --> -0.414461).  Saving model ...
Epoch: 8 cost time: 1.9622087478637695
Epoch: 8, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.193 Vali Acc: 0.441 Test Loss: 1.193 Test Acc: 0.441
Validation loss decreased (-0.414461 --> -0.440778).  Saving model ...
Epoch: 9 cost time: 2.015878438949585
Epoch: 9, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.134 Vali Acc: 0.513 Test Loss: 1.134 Test Acc: 0.513
Validation loss decreased (-0.440778 --> -0.513147).  Saving model ...
Epoch: 10 cost time: 2.258399248123169
Epoch: 10, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.071 Vali Acc: 0.539 Test Loss: 1.071 Test Acc: 0.539
Validation loss decreased (-0.513147 --> -0.539463).  Saving model ...
Epoch: 11 cost time: 1.9722864627838135
Epoch: 11, Steps: 10 | Train Loss: 0.830 Vali Loss: 0.993 Vali Acc: 0.605 Test Loss: 0.993 Test Acc: 0.605
Validation loss decreased (-0.539463 --> -0.605253).  Saving model ...
Epoch: 12 cost time: 1.953967809677124
Epoch: 12, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.927 Vali Acc: 0.632 Test Loss: 0.927 Test Acc: 0.632
Validation loss decreased (-0.605253 --> -0.631570).  Saving model ...
Epoch: 13 cost time: 2.147592782974243
Epoch: 13, Steps: 10 | Train Loss: 0.634 Vali Loss: 0.868 Vali Acc: 0.645 Test Loss: 0.868 Test Acc: 0.645
Validation loss decreased (-0.631570 --> -0.644728).  Saving model ...
Epoch: 14 cost time: 2.1679184436798096
Epoch: 14, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.808 Vali Acc: 0.664 Test Loss: 0.808 Test Acc: 0.664
Validation loss decreased (-0.644728 --> -0.664466).  Saving model ...
Epoch: 15 cost time: 2.2731735706329346
Epoch: 15, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.768 Vali Acc: 0.684 Test Loss: 0.768 Test Acc: 0.684
Validation loss decreased (-0.664466 --> -0.684203).  Saving model ...
Epoch: 16 cost time: 2.247438907623291
Epoch: 16, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.733 Vali Acc: 0.684 Test Loss: 0.733 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684203).  Saving model ...
Epoch: 17 cost time: 2.210123300552368
Epoch: 17, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.702 Vali Acc: 0.691 Test Loss: 0.702 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 18 cost time: 2.292696714401245
Epoch: 18, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.692 Vali Acc: 0.711 Test Loss: 0.692 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710519).  Saving model ...
Epoch: 19 cost time: 2.1777796745300293
Epoch: 19, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.669 Vali Acc: 0.704 Test Loss: 0.669 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.210655450820923
Epoch: 20, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.674 Vali Acc: 0.717 Test Loss: 0.674 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717099).  Saving model ...
Epoch: 21 cost time: 2.283348321914673
Epoch: 21, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.679 Vali Acc: 0.737 Test Loss: 0.679 Test Acc: 0.737
Validation loss decreased (-0.717099 --> -0.736835).  Saving model ...
Epoch: 22 cost time: 1.978416919708252
Epoch: 22, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.677 Vali Acc: 0.743 Test Loss: 0.677 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 23 cost time: 1.9411778450012207
Epoch: 23, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.688 Vali Acc: 0.737 Test Loss: 0.688 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.017211437225342
Epoch: 24, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.710 Vali Acc: 0.737 Test Loss: 0.710 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8436126708984375
Epoch: 25, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.704 Vali Acc: 0.743 Test Loss: 0.704 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.989091396331787
Epoch: 26, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.718 Vali Acc: 0.743 Test Loss: 0.718 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.032179355621338
Epoch: 27, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.736 Vali Acc: 0.743 Test Loss: 0.736 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9668385982513428
Epoch: 28, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.749 Vali Acc: 0.750 Test Loss: 0.749 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 29 cost time: 2.0918264389038086
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.753 Vali Acc: 0.743 Test Loss: 0.753 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0115647315979004
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.763 Vali Acc: 0.743 Test Loss: 0.763 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.008129358291626
Epoch: 31, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.780 Vali Acc: 0.730 Test Loss: 0.780 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9492390155792236
Epoch: 32, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.9118669033050537
Epoch: 33, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.791 Vali Acc: 0.743 Test Loss: 0.791 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.0471906661987305
Epoch: 34, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.796 Vali Acc: 0.743 Test Loss: 0.796 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.9456357955932617
Epoch: 35, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.800 Vali Acc: 0.757 Test Loss: 0.800 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756571).  Saving model ...
Epoch: 36 cost time: 2.068068265914917
Epoch: 36, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.153428554534912
Epoch: 37, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.0923972129821777
Epoch: 38, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.830 Vali Acc: 0.757 Test Loss: 0.830 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.1274280548095703
Epoch: 39, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.829 Vali Acc: 0.757 Test Loss: 0.829 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.303417205810547
Epoch: 40, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.849 Vali Acc: 0.763 Test Loss: 0.849 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763149).  Saving model ...
Epoch: 41 cost time: 2.0818748474121094
Epoch: 41, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.861 Vali Acc: 0.763 Test Loss: 0.861 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.15078067779541
Epoch: 42, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.867 Vali Acc: 0.757 Test Loss: 0.867 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.3069069385528564
Epoch: 43, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.1362767219543457
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.220900058746338
Epoch: 45, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.0255045890808105
Epoch: 46, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.877 Vali Acc: 0.757 Test Loss: 0.877 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.9327948093414307
Epoch: 47, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.886 Vali Acc: 0.763 Test Loss: 0.886 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.3000636100769043
Epoch: 48, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.908 Vali Acc: 0.757 Test Loss: 0.908 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.0427091121673584
Epoch: 49, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.918 Vali Acc: 0.757 Test Loss: 0.918 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.0274457931518555
Epoch: 50, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.922 Vali Acc: 0.757 Test Loss: 0.922 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 156356
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8303112983703613
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.434 Vali Acc: 0.263 Test Loss: 1.434 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.0707924365997314
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.417 Vali Acc: 0.270 Test Loss: 1.417 Test Acc: 0.270
Validation loss decreased (-0.263144 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.9302077293395996
Epoch: 3, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.391 Vali Acc: 0.289 Test Loss: 1.391 Test Acc: 0.289
Validation loss decreased (-0.269723 --> -0.289460).  Saving model ...
Epoch: 4 cost time: 2.010150194168091
Epoch: 4, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.357 Vali Acc: 0.322 Test Loss: 1.357 Test Acc: 0.322
Validation loss decreased (-0.289460 --> -0.322355).  Saving model ...
Epoch: 5 cost time: 2.2879345417022705
Epoch: 5, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.327 Vali Acc: 0.336 Test Loss: 1.327 Test Acc: 0.336
Validation loss decreased (-0.322355 --> -0.335513).  Saving model ...
Epoch: 6 cost time: 2.194437265396118
Epoch: 6, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.283 Vali Acc: 0.388 Test Loss: 1.283 Test Acc: 0.388
Validation loss decreased (-0.335513 --> -0.388145).  Saving model ...
Epoch: 7 cost time: 2.26794171333313
Epoch: 7, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.232 Vali Acc: 0.467 Test Loss: 1.232 Test Acc: 0.467
Validation loss decreased (-0.388145 --> -0.467093).  Saving model ...
Epoch: 8 cost time: 2.2376153469085693
Epoch: 8, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.179 Vali Acc: 0.520 Test Loss: 1.179 Test Acc: 0.520
Validation loss decreased (-0.467093 --> -0.519725).  Saving model ...
Epoch: 9 cost time: 2.1963045597076416
Epoch: 9, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.120 Vali Acc: 0.539 Test Loss: 1.120 Test Acc: 0.539
Validation loss decreased (-0.519725 --> -0.539462).  Saving model ...
Epoch: 10 cost time: 2.1833484172821045
Epoch: 10, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.055 Vali Acc: 0.612 Test Loss: 1.055 Test Acc: 0.612
Validation loss decreased (-0.539462 --> -0.611832).  Saving model ...
Epoch: 11 cost time: 2.29958438873291
Epoch: 11, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.980 Vali Acc: 0.651 Test Loss: 0.980 Test Acc: 0.651
Validation loss decreased (-0.611832 --> -0.651306).  Saving model ...
Epoch: 12 cost time: 2.340718984603882
Epoch: 12, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.917 Vali Acc: 0.684 Test Loss: 0.917 Test Acc: 0.684
Validation loss decreased (-0.651306 --> -0.684201).  Saving model ...
Epoch: 13 cost time: 2.360668659210205
Epoch: 13, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.865 Vali Acc: 0.671 Test Loss: 0.865 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.393073320388794
Epoch: 14, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.805 Vali Acc: 0.684 Test Loss: 0.805 Test Acc: 0.684
Validation loss decreased (-0.684201 --> -0.684202).  Saving model ...
Epoch: 15 cost time: 2.275944709777832
Epoch: 15, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.763 Vali Acc: 0.691 Test Loss: 0.763 Test Acc: 0.691
Validation loss decreased (-0.684202 --> -0.690782).  Saving model ...
Epoch: 16 cost time: 2.204305410385132
Epoch: 16, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.737 Vali Acc: 0.691 Test Loss: 0.737 Test Acc: 0.691
Validation loss decreased (-0.690782 --> -0.690782).  Saving model ...
Epoch: 17 cost time: 2.0801775455474854
Epoch: 17, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.717 Vali Acc: 0.704 Test Loss: 0.717 Test Acc: 0.704
Validation loss decreased (-0.690782 --> -0.703940).  Saving model ...
Epoch: 18 cost time: 2.2297916412353516
Epoch: 18, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.711 Vali Acc: 0.717 Test Loss: 0.711 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 19 cost time: 1.8804223537445068
Epoch: 19, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.688 Vali Acc: 0.724 Test Loss: 0.688 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 20 cost time: 2.155959367752075
Epoch: 20, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.679 Vali Acc: 0.743 Test Loss: 0.679 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 21 cost time: 2.0771379470825195
Epoch: 21, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.669 Vali Acc: 0.743 Test Loss: 0.669 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 22 cost time: 2.1074819564819336
Epoch: 22, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.666 Vali Acc: 0.757 Test Loss: 0.666 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 23 cost time: 2.2303884029388428
Epoch: 23, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.668 Vali Acc: 0.757 Test Loss: 0.668 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.052229404449463
Epoch: 24, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.675 Vali Acc: 0.763 Test Loss: 0.675 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 25 cost time: 2.3171815872192383
Epoch: 25, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.673 Vali Acc: 0.763 Test Loss: 0.673 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 26 cost time: 2.04016375541687
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.685 Vali Acc: 0.763 Test Loss: 0.685 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.137253999710083
Epoch: 27, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.701 Vali Acc: 0.763 Test Loss: 0.701 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.077280282974243
Epoch: 28, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.215089797973633
Epoch: 29, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.707 Vali Acc: 0.763 Test Loss: 0.707 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.318690299987793
Epoch: 30, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.719 Vali Acc: 0.757 Test Loss: 0.719 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.1369307041168213
Epoch: 31, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.735 Vali Acc: 0.763 Test Loss: 0.735 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.327561616897583
Epoch: 32, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.746 Vali Acc: 0.770 Test Loss: 0.746 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769729).  Saving model ...
Epoch: 33 cost time: 2.246478319168091
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.747 Vali Acc: 0.770 Test Loss: 0.747 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.3625271320343018
Epoch: 34, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.750 Vali Acc: 0.770 Test Loss: 0.750 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.3169000148773193
Epoch: 35, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.758 Vali Acc: 0.770 Test Loss: 0.758 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.225492000579834
Epoch: 36, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.775 Vali Acc: 0.776 Test Loss: 0.775 Test Acc: 0.776
Validation loss decreased (-0.769729 --> -0.776308).  Saving model ...
Epoch: 37 cost time: 2.095029354095459
Epoch: 37, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.793 Vali Acc: 0.776 Test Loss: 0.793 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.2509803771972656
Epoch: 38, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.800 Vali Acc: 0.776 Test Loss: 0.800 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.112947702407837
Epoch: 39, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.801 Vali Acc: 0.776 Test Loss: 0.801 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.2852783203125
Epoch: 40, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.811 Vali Acc: 0.770 Test Loss: 0.811 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.2417008876800537
Epoch: 41, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.825 Vali Acc: 0.776 Test Loss: 0.825 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.248737096786499
Epoch: 42, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.837 Vali Acc: 0.776 Test Loss: 0.837 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.0691823959350586
Epoch: 43, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.833 Vali Acc: 0.776 Test Loss: 0.833 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.267437219619751
Epoch: 44, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.835 Vali Acc: 0.783 Test Loss: 0.835 Test Acc: 0.783
Validation loss decreased (-0.776308 --> -0.782886).  Saving model ...
Epoch: 45 cost time: 2.018531560897827
Epoch: 45, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.838 Vali Acc: 0.783 Test Loss: 0.838 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.0783843994140625
Epoch: 46, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.844 Vali Acc: 0.783 Test Loss: 0.844 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.2529587745666504
Epoch: 47, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.855 Vali Acc: 0.783 Test Loss: 0.855 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.0953142642974854
Epoch: 48, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.872 Vali Acc: 0.776 Test Loss: 0.872 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.1746721267700195
Epoch: 49, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.878 Vali Acc: 0.776 Test Loss: 0.878 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.3800928592681885
Epoch: 50, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.879 Vali Acc: 0.776 Test Loss: 0.879 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.326996326446533
Epoch: 51, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.885 Vali Acc: 0.776 Test Loss: 0.885 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.1894545555114746
Epoch: 52, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.890 Vali Acc: 0.776 Test Loss: 0.890 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.392422914505005
Epoch: 53, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.899 Vali Acc: 0.776 Test Loss: 0.899 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.35896897315979
Epoch: 54, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.907 Vali Acc: 0.770 Test Loss: 0.907 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 156356
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8472065925598145
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 2.0502312183380127
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 2.0960161685943604
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 2.1763720512390137
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 2.173311471939087
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 6 cost time: 2.0965707302093506
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 7 cost time: 2.1503982543945312
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 8 cost time: 1.9155864715576172
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 9 cost time: 2.087881326675415
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 10 cost time: 2.020911693572998
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 11 cost time: 2.2868385314941406
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 12 cost time: 2.0946290493011475
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 13 cost time: 2.1032423973083496
Epoch: 13, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 2.101148843765259
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 1.9182429313659668
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 1.9640226364135742
Epoch: 16, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 1.9965732097625732
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 2.0796406269073486
Epoch: 18, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 2.0840044021606445
Epoch: 19, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 2.1383256912231445
Epoch: 20, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 1.9096388816833496
Epoch: 21, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 1.9527604579925537
Epoch: 22, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 1.8244640827178955
Epoch: 23, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 1.9764297008514404
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 1.8969438076019287
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 2.0738842487335205
Epoch: 26, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 1.9286322593688965
Epoch: 27, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.041879177093506
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.070852756500244
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.053373336791992
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 1.9223637580871582
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 2.039383888244629
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8516464233398438
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.179818630218506
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.0612330436706543
Epoch: 35, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 2.2021830081939697
Epoch: 36, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.0281965732574463
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.0979976654052734
Epoch: 38, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.054957389831543
Epoch: 39, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.0213797092437744
Epoch: 40, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 2.3520681858062744
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.0211758613586426
Epoch: 42, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 2.0196707248687744
Epoch: 43, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.090259075164795
Epoch: 44, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 45 cost time: 2.045309543609619
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.9110383987426758
Epoch: 46, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 2.111668348312378
Epoch: 47, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 48 cost time: 2.127732753753662
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.0879948139190674
Epoch: 49, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.080598831176758
Epoch: 50, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.9937140941619873
Epoch: 51, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.1435112953186035
Epoch: 52, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 53 cost time: 2.1632320880889893
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.128753900527954
Epoch: 54, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.2387301921844482
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 2.3219943046569824
Epoch: 56, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 2.233125686645508
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.3835930824279785
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 2.2421772480010986
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 2.384442090988159
Epoch: 60, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 2.2839066982269287
Epoch: 61, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 2.355153799057007
Epoch: 62, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 156356
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.026841878890991
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.407 Vali Acc: 0.309 Test Loss: 1.407 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 1.9249050617218018
Epoch: 2, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.325 Vali Acc: 0.382 Test Loss: 1.325 Test Acc: 0.382
Validation loss decreased (-0.309196 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 2.105830192565918
Epoch: 3, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.237 Vali Acc: 0.526 Test Loss: 1.237 Test Acc: 0.526
Validation loss decreased (-0.381566 --> -0.526303).  Saving model ...
Epoch: 4 cost time: 2.063770055770874
Epoch: 4, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.160 Vali Acc: 0.586 Test Loss: 1.160 Test Acc: 0.586
Validation loss decreased (-0.526303 --> -0.585515).  Saving model ...
Epoch: 5 cost time: 2.2091095447540283
Epoch: 5, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.094 Vali Acc: 0.645 Test Loss: 1.094 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644726).  Saving model ...
Epoch: 6 cost time: 1.9896364212036133
Epoch: 6, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.035 Vali Acc: 0.651 Test Loss: 1.035 Test Acc: 0.651
Validation loss decreased (-0.644726 --> -0.651305).  Saving model ...
Epoch: 7 cost time: 2.139841318130493
Epoch: 7, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.977 Vali Acc: 0.678 Test Loss: 0.977 Test Acc: 0.678
Validation loss decreased (-0.651305 --> -0.677622).  Saving model ...
Epoch: 8 cost time: 2.013076066970825
Epoch: 8, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.933 Vali Acc: 0.691 Test Loss: 0.933 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690780).  Saving model ...
Epoch: 9 cost time: 2.136644124984741
Epoch: 9, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.898 Vali Acc: 0.717 Test Loss: 0.898 Test Acc: 0.717
Validation loss decreased (-0.690780 --> -0.717096).  Saving model ...
Epoch: 10 cost time: 1.993647575378418
Epoch: 10, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.862 Vali Acc: 0.697 Test Loss: 0.862 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.187211513519287
Epoch: 11, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.826 Vali Acc: 0.704 Test Loss: 0.826 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9816093444824219
Epoch: 12, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.803 Vali Acc: 0.724 Test Loss: 0.803 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723676).  Saving model ...
Epoch: 13 cost time: 2.11985182762146
Epoch: 13, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.778 Vali Acc: 0.737 Test Loss: 0.778 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736834).  Saving model ...
Epoch: 14 cost time: 1.889279842376709
Epoch: 14, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.747 Vali Acc: 0.743 Test Loss: 0.747 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743414).  Saving model ...
Epoch: 15 cost time: 2.262450933456421
Epoch: 15, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.724 Vali Acc: 0.730 Test Loss: 0.724 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9871842861175537
Epoch: 16, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.705 Vali Acc: 0.763 Test Loss: 0.705 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763151).  Saving model ...
Epoch: 17 cost time: 2.5781915187835693
Epoch: 17, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.695 Vali Acc: 0.757 Test Loss: 0.695 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.43404221534729
Epoch: 18, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.672 Vali Acc: 0.757 Test Loss: 0.672 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6246252059936523
Epoch: 19, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.650 Vali Acc: 0.763 Test Loss: 0.650 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 20 cost time: 2.363316774368286
Epoch: 20, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.635 Vali Acc: 0.776 Test Loss: 0.635 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 21 cost time: 2.5546786785125732
Epoch: 21, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.618 Vali Acc: 0.770 Test Loss: 0.618 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.429111957550049
Epoch: 22, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 2.6889615058898926
Epoch: 23, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.600 Vali Acc: 0.796 Test Loss: 0.600 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 24 cost time: 2.465726613998413
Epoch: 24, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815783).  Saving model ...
Epoch: 25 cost time: 2.4917638301849365
Epoch: 25, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.374566078186035
Epoch: 26, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.600 Vali Acc: 0.816 Test Loss: 0.600 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4527714252471924
Epoch: 27, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2326138019561768
Epoch: 28, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.590 Vali Acc: 0.796 Test Loss: 0.590 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.0971808433532715
Epoch: 29, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.219256639480591
Epoch: 30, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.100987434387207
Epoch: 31, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 32 cost time: 2.1037726402282715
Epoch: 32, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.621 Vali Acc: 0.816 Test Loss: 0.621 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.131913661956787
Epoch: 33, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.091423749923706
Epoch: 34, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.614 Vali Acc: 0.829 Test Loss: 0.614 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828941).  Saving model ...
Epoch: 35 cost time: 2.3026905059814453
Epoch: 35, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0931293964385986
Epoch: 36, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.081451177597046
Epoch: 37, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.646 Vali Acc: 0.822 Test Loss: 0.646 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.139268636703491
Epoch: 38, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.652 Vali Acc: 0.829 Test Loss: 0.652 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.1864237785339355
Epoch: 39, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.666 Vali Acc: 0.822 Test Loss: 0.666 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.295201539993286
Epoch: 40, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.206793785095215
Epoch: 41, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.667 Vali Acc: 0.829 Test Loss: 0.667 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.2053520679473877
Epoch: 42, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.684 Vali Acc: 0.816 Test Loss: 0.684 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.2259154319763184
Epoch: 43, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.672 Vali Acc: 0.816 Test Loss: 0.672 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.0838444232940674
Epoch: 44, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.681 Vali Acc: 0.816 Test Loss: 0.681 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 423012
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7371299266815186
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.432 Vali Acc: 0.289 Test Loss: 1.432 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 2.0050909519195557
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.355 Vali Acc: 0.362 Test Loss: 1.355 Test Acc: 0.362
Validation loss decreased (-0.289459 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 2.142430305480957
Epoch: 3, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.272 Vali Acc: 0.480 Test Loss: 1.272 Test Acc: 0.480
Validation loss decreased (-0.361829 --> -0.480250).  Saving model ...
Epoch: 4 cost time: 1.9985103607177734
Epoch: 4, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.197 Vali Acc: 0.526 Test Loss: 1.197 Test Acc: 0.526
Validation loss decreased (-0.480250 --> -0.526304).  Saving model ...
Epoch: 5 cost time: 1.8959670066833496
Epoch: 5, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.130 Vali Acc: 0.546 Test Loss: 1.130 Test Acc: 0.546
Validation loss decreased (-0.526304 --> -0.546041).  Saving model ...
Epoch: 6 cost time: 2.1200613975524902
Epoch: 6, Steps: 10 | Train Loss: 0.886 Vali Loss: 1.079 Vali Acc: 0.579 Test Loss: 1.079 Test Acc: 0.579
Validation loss decreased (-0.546041 --> -0.578937).  Saving model ...
Epoch: 7 cost time: 1.8849310874938965
Epoch: 7, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.030 Vali Acc: 0.605 Test Loss: 1.030 Test Acc: 0.605
Validation loss decreased (-0.578937 --> -0.605253).  Saving model ...
Epoch: 8 cost time: 2.2022387981414795
Epoch: 8, Steps: 10 | Train Loss: 0.789 Vali Loss: 0.995 Vali Acc: 0.605 Test Loss: 0.995 Test Acc: 0.605
Validation loss decreased (-0.605253 --> -0.605253).  Saving model ...
Epoch: 9 cost time: 2.0944416522979736
Epoch: 9, Steps: 10 | Train Loss: 0.705 Vali Loss: 0.962 Vali Acc: 0.658 Test Loss: 0.962 Test Acc: 0.658
Validation loss decreased (-0.605253 --> -0.657885).  Saving model ...
Epoch: 10 cost time: 1.9948232173919678
Epoch: 10, Steps: 10 | Train Loss: 0.648 Vali Loss: 0.926 Vali Acc: 0.645 Test Loss: 0.926 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.140354871749878
Epoch: 11, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.891 Vali Acc: 0.671 Test Loss: 0.891 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671044).  Saving model ...
Epoch: 12 cost time: 2.1290602684020996
Epoch: 12, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.865 Vali Acc: 0.684 Test Loss: 0.865 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684202).  Saving model ...
Epoch: 13 cost time: 2.1382064819335938
Epoch: 13, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.835 Vali Acc: 0.711 Test Loss: 0.835 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710518).  Saving model ...
Epoch: 14 cost time: 2.148888349533081
Epoch: 14, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.799 Vali Acc: 0.737 Test Loss: 0.799 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736834).  Saving model ...
Epoch: 15 cost time: 1.8148841857910156
Epoch: 15, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.781 Vali Acc: 0.737 Test Loss: 0.781 Test Acc: 0.737
Validation loss decreased (-0.736834 --> -0.736834).  Saving model ...
Epoch: 16 cost time: 1.893026351928711
Epoch: 16, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9589426517486572
Epoch: 17, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.746 Vali Acc: 0.757 Test Loss: 0.746 Test Acc: 0.757
Validation loss decreased (-0.736834 --> -0.756571).  Saving model ...
Epoch: 18 cost time: 1.9622914791107178
Epoch: 18, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.727 Vali Acc: 0.743 Test Loss: 0.727 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0777106285095215
Epoch: 19, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.712 Vali Acc: 0.743 Test Loss: 0.712 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.035766124725342
Epoch: 20, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.693 Vali Acc: 0.770 Test Loss: 0.693 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769730).  Saving model ...
Epoch: 21 cost time: 2.0515546798706055
Epoch: 21, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.685 Vali Acc: 0.770 Test Loss: 0.685 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 22 cost time: 2.2381319999694824
Epoch: 22, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.670 Vali Acc: 0.757 Test Loss: 0.670 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0903260707855225
Epoch: 23, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789467).  Saving model ...
Epoch: 24 cost time: 2.1564218997955322
Epoch: 24, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1582775115966797
Epoch: 25, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.634 Vali Acc: 0.776 Test Loss: 0.634 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1807727813720703
Epoch: 26, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.636 Vali Acc: 0.783 Test Loss: 0.636 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.276759386062622
Epoch: 27, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.142180919647217
Epoch: 28, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.618 Vali Acc: 0.789 Test Loss: 0.618 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 29 cost time: 2.137437343597412
Epoch: 29, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802625).  Saving model ...
Epoch: 30 cost time: 2.0901899337768555
Epoch: 30, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.621 Vali Acc: 0.796 Test Loss: 0.621 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2248637676239014
Epoch: 31, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.636 Vali Acc: 0.809 Test Loss: 0.636 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 32 cost time: 2.127112865447998
Epoch: 32, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1408772468566895
Epoch: 33, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.632 Vali Acc: 0.803 Test Loss: 0.632 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.1194968223571777
Epoch: 34, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.627 Vali Acc: 0.803 Test Loss: 0.627 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.9934351444244385
Epoch: 35, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.631 Vali Acc: 0.803 Test Loss: 0.631 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.113956928253174
Epoch: 36, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.639 Vali Acc: 0.803 Test Loss: 0.639 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.9999704360961914
Epoch: 37, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.989245891571045
Epoch: 38, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.654 Vali Acc: 0.816 Test Loss: 0.654 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 39 cost time: 2.0314061641693115
Epoch: 39, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.668 Vali Acc: 0.822 Test Loss: 0.668 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 40 cost time: 1.8859405517578125
Epoch: 40, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.678 Vali Acc: 0.816 Test Loss: 0.678 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.1349825859069824
Epoch: 41, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.668 Vali Acc: 0.816 Test Loss: 0.668 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.9758756160736084
Epoch: 42, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.675 Vali Acc: 0.816 Test Loss: 0.675 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.992177963256836
Epoch: 43, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.672 Vali Acc: 0.816 Test Loss: 0.672 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.0515480041503906
Epoch: 44, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.682 Vali Acc: 0.816 Test Loss: 0.682 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.0890300273895264
Epoch: 45, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.705 Vali Acc: 0.809 Test Loss: 0.705 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.1407699584960938
Epoch: 46, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.707 Vali Acc: 0.816 Test Loss: 0.707 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.1450254917144775
Epoch: 47, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.712 Vali Acc: 0.809 Test Loss: 0.712 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.2286229133605957
Epoch: 48, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.720 Vali Acc: 0.809 Test Loss: 0.720 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.1842432022094727
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.726 Vali Acc: 0.809 Test Loss: 0.726 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 423012
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4521484375
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.438 Vali Acc: 0.224 Test Loss: 1.438 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 2.20198392868042
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.380 Vali Acc: 0.296 Test Loss: 1.380 Test Acc: 0.296
Validation loss decreased (-0.223670 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 2.095738410949707
Epoch: 3, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.313 Vali Acc: 0.342 Test Loss: 1.313 Test Acc: 0.342
Validation loss decreased (-0.296039 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 2.1131908893585205
Epoch: 4, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.253 Vali Acc: 0.434 Test Loss: 1.253 Test Acc: 0.434
Validation loss decreased (-0.342092 --> -0.434198).  Saving model ...
Epoch: 5 cost time: 2.1174542903900146
Epoch: 5, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.193 Vali Acc: 0.493 Test Loss: 1.193 Test Acc: 0.493
Validation loss decreased (-0.434198 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 2.1458840370178223
Epoch: 6, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.144 Vali Acc: 0.539 Test Loss: 1.144 Test Acc: 0.539
Validation loss decreased (-0.493409 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 2.2202720642089844
Epoch: 7, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.093 Vali Acc: 0.559 Test Loss: 1.093 Test Acc: 0.559
Validation loss decreased (-0.539462 --> -0.559200).  Saving model ...
Epoch: 8 cost time: 2.0362884998321533
Epoch: 8, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.053 Vali Acc: 0.586 Test Loss: 1.053 Test Acc: 0.586
Validation loss decreased (-0.559200 --> -0.585516).  Saving model ...
Epoch: 9 cost time: 1.9675562381744385
Epoch: 9, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.021 Vali Acc: 0.618 Test Loss: 1.021 Test Acc: 0.618
Validation loss decreased (-0.585516 --> -0.618411).  Saving model ...
Epoch: 10 cost time: 1.9265451431274414
Epoch: 10, Steps: 10 | Train Loss: 0.753 Vali Loss: 0.980 Vali Acc: 0.638 Test Loss: 0.980 Test Acc: 0.638
Validation loss decreased (-0.618411 --> -0.638148).  Saving model ...
Epoch: 11 cost time: 2.093367099761963
Epoch: 11, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.948 Vali Acc: 0.658 Test Loss: 0.948 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657885).  Saving model ...
Epoch: 12 cost time: 2.0175256729125977
Epoch: 12, Steps: 10 | Train Loss: 0.634 Vali Loss: 0.919 Vali Acc: 0.664 Test Loss: 0.919 Test Acc: 0.664
Validation loss decreased (-0.657885 --> -0.664464).  Saving model ...
Epoch: 13 cost time: 2.053257465362549
Epoch: 13, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.891 Vali Acc: 0.684 Test Loss: 0.891 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684202).  Saving model ...
Epoch: 14 cost time: 2.1111092567443848
Epoch: 14, Steps: 10 | Train Loss: 0.564 Vali Loss: 0.859 Vali Acc: 0.658 Test Loss: 0.859 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.125271797180176
Epoch: 15, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.827 Vali Acc: 0.671 Test Loss: 0.827 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.127175807952881
Epoch: 16, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.796 Vali Acc: 0.717 Test Loss: 0.796 Test Acc: 0.717
Validation loss decreased (-0.684202 --> -0.717097).  Saving model ...
Epoch: 17 cost time: 1.975210189819336
Epoch: 17, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.765 Vali Acc: 0.737 Test Loss: 0.765 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736834).  Saving model ...
Epoch: 18 cost time: 2.065107822418213
Epoch: 18, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.742 Vali Acc: 0.763 Test Loss: 0.742 Test Acc: 0.763
Validation loss decreased (-0.736834 --> -0.763150).  Saving model ...
Epoch: 19 cost time: 2.073819160461426
Epoch: 19, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.708 Vali Acc: 0.750 Test Loss: 0.708 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1121363639831543
Epoch: 20, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.679 Vali Acc: 0.711 Test Loss: 0.679 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0577027797698975
Epoch: 21, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.644 Vali Acc: 0.750 Test Loss: 0.644 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0149145126342773
Epoch: 22, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.624 Vali Acc: 0.757 Test Loss: 0.624 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9928996562957764
Epoch: 23, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.595 Vali Acc: 0.763 Test Loss: 0.595 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 2.0362768173217773
Epoch: 24, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 25 cost time: 2.1193442344665527
Epoch: 25, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.566 Vali Acc: 0.770 Test Loss: 0.566 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1783695220947266
Epoch: 26, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0650389194488525
Epoch: 27, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 28 cost time: 2.1015360355377197
Epoch: 28, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.125617742538452
Epoch: 29, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.2651708126068115
Epoch: 30, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.2375688552856445
Epoch: 31, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 32 cost time: 2.2666268348693848
Epoch: 32, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 33 cost time: 2.2362558841705322
Epoch: 33, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.16949200630188
Epoch: 34, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.1151819229125977
Epoch: 35, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 36 cost time: 2.1973178386688232
Epoch: 36, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.545 Vali Acc: 0.816 Test Loss: 0.545 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.180351972579956
Epoch: 37, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.2878148555755615
Epoch: 38, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.081244468688965
Epoch: 39, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.0589776039123535
Epoch: 40, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.248913288116455
Epoch: 41, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.1441431045532227
Epoch: 42, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.0640616416931152
Epoch: 43, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.1058130264282227
Epoch: 44, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.558 Vali Acc: 0.803 Test Loss: 0.558 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.1557610034942627
Epoch: 45, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 423012
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.175351619720459
Epoch: 1, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.381 Vali Acc: 0.309 Test Loss: 1.381 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 2.1989352703094482
Epoch: 2, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.341 Vali Acc: 0.336 Test Loss: 1.341 Test Acc: 0.336
Validation loss decreased (-0.309197 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 2.0509033203125
Epoch: 3, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.302 Vali Acc: 0.362 Test Loss: 1.302 Test Acc: 0.362
Validation loss decreased (-0.335513 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 2.296048402786255
Epoch: 4, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.260 Vali Acc: 0.414 Test Loss: 1.260 Test Acc: 0.414
Validation loss decreased (-0.361829 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 2.384007215499878
Epoch: 5, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.220 Vali Acc: 0.454 Test Loss: 1.220 Test Acc: 0.454
Validation loss decreased (-0.414461 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 2.2537569999694824
Epoch: 6, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.188 Vali Acc: 0.480 Test Loss: 1.188 Test Acc: 0.480
Validation loss decreased (-0.453935 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 2.414682626724243
Epoch: 7, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.158 Vali Acc: 0.507 Test Loss: 1.158 Test Acc: 0.507
Validation loss decreased (-0.480251 --> -0.506567).  Saving model ...
Epoch: 8 cost time: 2.3386857509613037
Epoch: 8, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.133 Vali Acc: 0.513 Test Loss: 1.133 Test Acc: 0.513
Validation loss decreased (-0.506567 --> -0.513147).  Saving model ...
Epoch: 9 cost time: 2.1431145668029785
Epoch: 9, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.112 Vali Acc: 0.520 Test Loss: 1.112 Test Acc: 0.520
Validation loss decreased (-0.513147 --> -0.519726).  Saving model ...
Epoch: 10 cost time: 1.9914355278015137
Epoch: 10, Steps: 10 | Train Loss: 0.800 Vali Loss: 1.085 Vali Acc: 0.553 Test Loss: 1.085 Test Acc: 0.553
Validation loss decreased (-0.519726 --> -0.552621).  Saving model ...
Epoch: 11 cost time: 2.2036774158477783
Epoch: 11, Steps: 10 | Train Loss: 0.781 Vali Loss: 1.061 Vali Acc: 0.546 Test Loss: 1.061 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1439461708068848
Epoch: 12, Steps: 10 | Train Loss: 0.693 Vali Loss: 1.031 Vali Acc: 0.566 Test Loss: 1.031 Test Acc: 0.566
Validation loss decreased (-0.552621 --> -0.565779).  Saving model ...
Epoch: 13 cost time: 2.0296471118927
Epoch: 13, Steps: 10 | Train Loss: 0.662 Vali Loss: 1.005 Vali Acc: 0.572 Test Loss: 1.005 Test Acc: 0.572
Validation loss decreased (-0.565779 --> -0.572358).  Saving model ...
Epoch: 14 cost time: 2.040046215057373
Epoch: 14, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.976 Vali Acc: 0.605 Test Loss: 0.976 Test Acc: 0.605
Validation loss decreased (-0.572358 --> -0.605253).  Saving model ...
Epoch: 15 cost time: 2.234726905822754
Epoch: 15, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.941 Vali Acc: 0.605 Test Loss: 0.941 Test Acc: 0.605
Validation loss decreased (-0.605253 --> -0.605254).  Saving model ...
Epoch: 16 cost time: 1.8581321239471436
Epoch: 16, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.909 Vali Acc: 0.625 Test Loss: 0.909 Test Acc: 0.625
Validation loss decreased (-0.605254 --> -0.624991).  Saving model ...
Epoch: 17 cost time: 2.03890061378479
Epoch: 17, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.867 Vali Acc: 0.658 Test Loss: 0.867 Test Acc: 0.658
Validation loss decreased (-0.624991 --> -0.657886).  Saving model ...
Epoch: 18 cost time: 1.9315996170043945
Epoch: 18, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.828 Vali Acc: 0.664 Test Loss: 0.828 Test Acc: 0.664
Validation loss decreased (-0.657886 --> -0.664465).  Saving model ...
Epoch: 19 cost time: 2.5556681156158447
Epoch: 19, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.788 Vali Acc: 0.678 Test Loss: 0.788 Test Acc: 0.678
Validation loss decreased (-0.664465 --> -0.677624).  Saving model ...
Epoch: 20 cost time: 2.138493776321411
Epoch: 20, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.754 Vali Acc: 0.684 Test Loss: 0.754 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 21 cost time: 2.3307583332061768
Epoch: 21, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.726 Vali Acc: 0.711 Test Loss: 0.726 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710519).  Saving model ...
Epoch: 22 cost time: 2.139364242553711
Epoch: 22, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.684 Vali Acc: 0.743 Test Loss: 0.684 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743414).  Saving model ...
Epoch: 23 cost time: 2.0699539184570312
Epoch: 23, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.296881675720215
Epoch: 24, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.634 Vali Acc: 0.737 Test Loss: 0.634 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1350104808807373
Epoch: 25, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.216042995452881
Epoch: 26, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 27 cost time: 2.1598317623138428
Epoch: 27, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.571 Vali Acc: 0.757 Test Loss: 0.571 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.1421468257904053
Epoch: 28, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.074705123901367
Epoch: 29, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 30 cost time: 2.343930721282959
Epoch: 30, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 31 cost time: 2.2731456756591797
Epoch: 31, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.1806933879852295
Epoch: 32, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.564 Vali Acc: 0.776 Test Loss: 0.564 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0124869346618652
Epoch: 33, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.2506673336029053
Epoch: 34, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 35 cost time: 2.0130152702331543
Epoch: 35, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.562 Vali Acc: 0.809 Test Loss: 0.562 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 36 cost time: 1.834829330444336
Epoch: 36, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.4674789905548096
Epoch: 37, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.302473783493042
Epoch: 38, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 39 cost time: 2.081238269805908
Epoch: 39, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 40 cost time: 2.053377151489258
Epoch: 40, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.286888837814331
Epoch: 41, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.571 Vali Acc: 0.829 Test Loss: 0.571 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 42 cost time: 2.140841484069824
Epoch: 42, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.105480194091797
Epoch: 43, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.0124285221099854
Epoch: 44, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.583 Vali Acc: 0.836 Test Loss: 0.583 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835520).  Saving model ...
Epoch: 45 cost time: 2.10976243019104
Epoch: 45, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.848332405090332
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.607 Vali Acc: 0.816 Test Loss: 0.607 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.0849227905273438
Epoch: 47, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.610 Vali Acc: 0.829 Test Loss: 0.610 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.194441795349121
Epoch: 48, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.609 Vali Acc: 0.836 Test Loss: 0.609 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.1484456062316895
Epoch: 49, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.611 Vali Acc: 0.842 Test Loss: 0.611 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842099).  Saving model ...
Epoch: 50 cost time: 2.1677167415618896
Epoch: 50, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.621 Vali Acc: 0.842 Test Loss: 0.621 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.057546377182007
Epoch: 51, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.631 Vali Acc: 0.842 Test Loss: 0.631 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.0094001293182373
Epoch: 52, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.634 Vali Acc: 0.842 Test Loss: 0.634 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 2.2484774589538574
Epoch: 53, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.637 Vali Acc: 0.836 Test Loss: 0.637 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.0401108264923096
Epoch: 54, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.637 Vali Acc: 0.836 Test Loss: 0.637 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 2.1474788188934326
Epoch: 55, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.635 Vali Acc: 0.842 Test Loss: 0.635 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 2.590550661087036
Epoch: 56, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.640 Vali Acc: 0.842 Test Loss: 0.640 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 2.242008924484253
Epoch: 57, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.648 Vali Acc: 0.842 Test Loss: 0.648 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 2.173482656478882
Epoch: 58, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.656 Vali Acc: 0.842 Test Loss: 0.656 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 2.394439935684204
Epoch: 59, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.656 Vali Acc: 0.842 Test Loss: 0.656 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 423012
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7381787300109863
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.406 Vali Acc: 0.263 Test Loss: 1.406 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.139087677001953
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.263144 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.9497449398040771
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.362 Vali Acc: 0.309 Test Loss: 1.362 Test Acc: 0.309
Validation loss decreased (-0.282881 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 2.2663986682891846
Epoch: 4, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.342 Vali Acc: 0.309 Test Loss: 1.342 Test Acc: 0.309
Validation loss decreased (-0.309197 --> -0.309197).  Saving model ...
Epoch: 5 cost time: 2.4802112579345703
Epoch: 5, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.323 Vali Acc: 0.355 Test Loss: 1.323 Test Acc: 0.355
Validation loss decreased (-0.309197 --> -0.355250).  Saving model ...
Epoch: 6 cost time: 1.985661506652832
Epoch: 6, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.305 Vali Acc: 0.322 Test Loss: 1.305 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0242760181427
Epoch: 7, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.287 Vali Acc: 0.342 Test Loss: 1.287 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.468667507171631
Epoch: 8, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.273 Vali Acc: 0.362 Test Loss: 1.273 Test Acc: 0.362
Validation loss decreased (-0.355250 --> -0.361829).  Saving model ...
Epoch: 9 cost time: 2.12507963180542
Epoch: 9, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.255 Vali Acc: 0.401 Test Loss: 1.255 Test Acc: 0.401
Validation loss decreased (-0.361829 --> -0.401303).  Saving model ...
Epoch: 10 cost time: 2.207048177719116
Epoch: 10, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.234 Vali Acc: 0.408 Test Loss: 1.234 Test Acc: 0.408
Validation loss decreased (-0.401303 --> -0.407882).  Saving model ...
Epoch: 11 cost time: 2.297016143798828
Epoch: 11, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.204 Vali Acc: 0.467 Test Loss: 1.204 Test Acc: 0.467
Validation loss decreased (-0.407882 --> -0.467093).  Saving model ...
Epoch: 12 cost time: 2.302095413208008
Epoch: 12, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.167 Vali Acc: 0.487 Test Loss: 1.167 Test Acc: 0.487
Validation loss decreased (-0.467093 --> -0.486830).  Saving model ...
Epoch: 13 cost time: 2.1170194149017334
Epoch: 13, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.120 Vali Acc: 0.553 Test Loss: 1.120 Test Acc: 0.553
Validation loss decreased (-0.486830 --> -0.552620).  Saving model ...
Epoch: 14 cost time: 2.438941717147827
Epoch: 14, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.080 Vali Acc: 0.553 Test Loss: 1.080 Test Acc: 0.553
Validation loss decreased (-0.552620 --> -0.552621).  Saving model ...
Epoch: 15 cost time: 2.2207281589508057
Epoch: 15, Steps: 10 | Train Loss: 0.781 Vali Loss: 1.026 Vali Acc: 0.592 Test Loss: 1.026 Test Acc: 0.592
Validation loss decreased (-0.552621 --> -0.592095).  Saving model ...
Epoch: 16 cost time: 2.2722275257110596
Epoch: 16, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.975 Vali Acc: 0.599 Test Loss: 0.975 Test Acc: 0.599
Validation loss decreased (-0.592095 --> -0.598674).  Saving model ...
Epoch: 17 cost time: 2.1761515140533447
Epoch: 17, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.923 Vali Acc: 0.618 Test Loss: 0.923 Test Acc: 0.618
Validation loss decreased (-0.598674 --> -0.618412).  Saving model ...
Epoch: 18 cost time: 2.024386167526245
Epoch: 18, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.868 Vali Acc: 0.651 Test Loss: 0.868 Test Acc: 0.651
Validation loss decreased (-0.618412 --> -0.651307).  Saving model ...
Epoch: 19 cost time: 1.976468563079834
Epoch: 19, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.809 Vali Acc: 0.664 Test Loss: 0.809 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664466).  Saving model ...
Epoch: 20 cost time: 2.178945302963257
Epoch: 20, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.775 Vali Acc: 0.691 Test Loss: 0.775 Test Acc: 0.691
Validation loss decreased (-0.664466 --> -0.690782).  Saving model ...
Epoch: 21 cost time: 2.174184799194336
Epoch: 21, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.742 Vali Acc: 0.697 Test Loss: 0.742 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697361).  Saving model ...
Epoch: 22 cost time: 2.0769917964935303
Epoch: 22, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 23 cost time: 2.1647989749908447
Epoch: 23, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.667 Vali Acc: 0.743 Test Loss: 0.667 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 24 cost time: 2.0497546195983887
Epoch: 24, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.644 Vali Acc: 0.757 Test Loss: 0.644 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 25 cost time: 2.0957283973693848
Epoch: 25, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.620 Vali Acc: 0.757 Test Loss: 0.620 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 26 cost time: 2.209787607192993
Epoch: 26, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.608 Vali Acc: 0.770 Test Loss: 0.608 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 2.2355871200561523
Epoch: 27, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.605 Vali Acc: 0.776 Test Loss: 0.605 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 2.239816665649414
Epoch: 28, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 29 cost time: 2.248589277267456
Epoch: 29, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 30 cost time: 2.2273478507995605
Epoch: 30, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 31 cost time: 2.31205677986145
Epoch: 31, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.3332161903381348
Epoch: 32, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 33 cost time: 2.3514349460601807
Epoch: 33, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.3953306674957275
Epoch: 34, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.32882022857666
Epoch: 35, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 36 cost time: 1.9436869621276855
Epoch: 36, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.9966762065887451
Epoch: 37, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.1472549438476562
Epoch: 38, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.589 Vali Acc: 0.796 Test Loss: 0.589 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.0350594520568848
Epoch: 39, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.621 Vali Acc: 0.796 Test Loss: 0.621 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.9823238849639893
Epoch: 40, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.009622097015381
Epoch: 41, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.604 Vali Acc: 0.796 Test Loss: 0.604 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.948218822479248
Epoch: 42, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.1025235652923584
Epoch: 43, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.581 Vali Acc: 0.803 Test Loss: 0.581 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 44 cost time: 2.0541813373565674
Epoch: 44, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.108908176422119
Epoch: 45, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.618 Vali Acc: 0.789 Test Loss: 0.618 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.0439131259918213
Epoch: 46, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.413073778152466
Epoch: 47, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.209014654159546
Epoch: 48, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.620 Vali Acc: 0.796 Test Loss: 0.620 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.264411211013794
Epoch: 49, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.4379541873931885
Epoch: 50, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.651 Vali Acc: 0.789 Test Loss: 0.651 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.379459857940674
Epoch: 51, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.671 Vali Acc: 0.796 Test Loss: 0.671 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.1584653854370117
Epoch: 52, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 2.32804274559021
Epoch: 53, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.669 Vali Acc: 0.789 Test Loss: 0.669 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 423012
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.134209632873535
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.410 Vali Acc: 0.263 Test Loss: 1.410 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.115464687347412
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.385 Vali Acc: 0.289 Test Loss: 1.385 Test Acc: 0.289
Validation loss decreased (-0.263144 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 2.3820602893829346
Epoch: 3, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.356 Vali Acc: 0.342 Test Loss: 1.356 Test Acc: 0.342
Validation loss decreased (-0.289460 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 2.178511142730713
Epoch: 4, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.330 Vali Acc: 0.382 Test Loss: 1.330 Test Acc: 0.382
Validation loss decreased (-0.342092 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 2.2207581996917725
Epoch: 5, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.304 Vali Acc: 0.388 Test Loss: 1.304 Test Acc: 0.388
Validation loss decreased (-0.381566 --> -0.388145).  Saving model ...
Epoch: 6 cost time: 2.1004414558410645
Epoch: 6, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.278 Vali Acc: 0.447 Test Loss: 1.278 Test Acc: 0.447
Validation loss decreased (-0.388145 --> -0.447356).  Saving model ...
Epoch: 7 cost time: 2.1402587890625
Epoch: 7, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.251 Vali Acc: 0.474 Test Loss: 1.251 Test Acc: 0.474
Validation loss decreased (-0.447356 --> -0.473672).  Saving model ...
Epoch: 8 cost time: 2.2804675102233887
Epoch: 8, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.224 Vali Acc: 0.487 Test Loss: 1.224 Test Acc: 0.487
Validation loss decreased (-0.473672 --> -0.486830).  Saving model ...
Epoch: 9 cost time: 2.34860897064209
Epoch: 9, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.195 Vali Acc: 0.520 Test Loss: 1.195 Test Acc: 0.520
Validation loss decreased (-0.486830 --> -0.519725).  Saving model ...
Epoch: 10 cost time: 2.556389331817627
Epoch: 10, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.170 Vali Acc: 0.559 Test Loss: 1.170 Test Acc: 0.559
Validation loss decreased (-0.519725 --> -0.559199).  Saving model ...
Epoch: 11 cost time: 2.34194016456604
Epoch: 11, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.138 Vali Acc: 0.592 Test Loss: 1.138 Test Acc: 0.592
Validation loss decreased (-0.559199 --> -0.592094).  Saving model ...
Epoch: 12 cost time: 2.2787976264953613
Epoch: 12, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.107 Vali Acc: 0.592 Test Loss: 1.107 Test Acc: 0.592
Validation loss decreased (-0.592094 --> -0.592094).  Saving model ...
Epoch: 13 cost time: 2.245626449584961
Epoch: 13, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.059 Vali Acc: 0.618 Test Loss: 1.059 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618410).  Saving model ...
Epoch: 14 cost time: 2.5934088230133057
Epoch: 14, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.013 Vali Acc: 0.632 Test Loss: 1.013 Test Acc: 0.632
Validation loss decreased (-0.618410 --> -0.631569).  Saving model ...
Epoch: 15 cost time: 2.417635202407837
Epoch: 15, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.971 Vali Acc: 0.671 Test Loss: 0.971 Test Acc: 0.671
Validation loss decreased (-0.631569 --> -0.671043).  Saving model ...
Epoch: 16 cost time: 2.1021342277526855
Epoch: 16, Steps: 10 | Train Loss: 0.703 Vali Loss: 0.931 Vali Acc: 0.658 Test Loss: 0.931 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3592240810394287
Epoch: 17, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.894 Vali Acc: 0.671 Test Loss: 0.894 Test Acc: 0.671
Validation loss decreased (-0.671043 --> -0.671044).  Saving model ...
Epoch: 18 cost time: 2.227465867996216
Epoch: 18, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.861 Vali Acc: 0.671 Test Loss: 0.861 Test Acc: 0.671
Validation loss decreased (-0.671044 --> -0.671044).  Saving model ...
Epoch: 19 cost time: 2.1799983978271484
Epoch: 19, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.814 Vali Acc: 0.664 Test Loss: 0.814 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2959094047546387
Epoch: 20, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.770 Vali Acc: 0.684 Test Loss: 0.770 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684203).  Saving model ...
Epoch: 21 cost time: 2.1209871768951416
Epoch: 21, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.719 Vali Acc: 0.711 Test Loss: 0.719 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710519).  Saving model ...
Epoch: 22 cost time: 2.2488653659820557
Epoch: 22, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.677 Vali Acc: 0.697 Test Loss: 0.677 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.410839557647705
Epoch: 23, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.645 Vali Acc: 0.737 Test Loss: 0.645 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736836).  Saving model ...
Epoch: 24 cost time: 2.254634380340576
Epoch: 24, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.622 Vali Acc: 0.757 Test Loss: 0.622 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 25 cost time: 2.4078874588012695
Epoch: 25, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.594 Vali Acc: 0.763 Test Loss: 0.594 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 26 cost time: 2.111391067504883
Epoch: 26, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.570 Vali Acc: 0.743 Test Loss: 0.570 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9960284233093262
Epoch: 27, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 28 cost time: 1.9678664207458496
Epoch: 28, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 29 cost time: 2.2207741737365723
Epoch: 29, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.2693960666656494
Epoch: 30, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 31 cost time: 2.23115873336792
Epoch: 31, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.319391965866089
Epoch: 32, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.3260581493377686
Epoch: 33, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.556 Vali Acc: 0.763 Test Loss: 0.556 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.283496379852295
Epoch: 34, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.3743865489959717
Epoch: 35, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 36 cost time: 2.4379355907440186
Epoch: 36, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 37 cost time: 2.2925050258636475
Epoch: 37, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.397947072982788
Epoch: 38, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.557 Vali Acc: 0.770 Test Loss: 0.557 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.187241315841675
Epoch: 39, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.5211141109466553
Epoch: 40, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.564 Vali Acc: 0.770 Test Loss: 0.564 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.2246248722076416
Epoch: 41, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.113333225250244
Epoch: 42, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.317392110824585
Epoch: 43, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.382878303527832
Epoch: 44, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.564 Vali Acc: 0.776 Test Loss: 0.564 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.445087194442749
Epoch: 45, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.1671459674835205
Epoch: 46, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 423012
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.101800203323364
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 2.3041634559631348
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 2.151259660720825
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 2.0901739597320557
Epoch: 4, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 2.037088632583618
Epoch: 5, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 6 cost time: 2.240513324737549
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 7 cost time: 2.0011188983917236
Epoch: 7, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 8 cost time: 2.0030102729797363
Epoch: 8, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 9 cost time: 2.1742730140686035
Epoch: 9, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 10 cost time: 2.199092149734497
Epoch: 10, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 11 cost time: 2.2960596084594727
Epoch: 11, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 12 cost time: 2.249107599258423
Epoch: 12, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 13 cost time: 2.382096529006958
Epoch: 13, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 2.12849760055542
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.547273635864258
Epoch: 15, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 2.570709466934204
Epoch: 16, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 2.517681121826172
Epoch: 17, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 2.4607748985290527
Epoch: 18, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 2.1622440814971924
Epoch: 19, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 2.3145670890808105
Epoch: 20, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 2.198941230773926
Epoch: 21, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.106515645980835
Epoch: 22, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 2.1502373218536377
Epoch: 23, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 2.1548328399658203
Epoch: 24, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 2.2730817794799805
Epoch: 25, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 2.1948599815368652
Epoch: 26, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.4956417083740234
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.2424159049987793
Epoch: 28, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.531980276107788
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.464526653289795
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.3353371620178223
Epoch: 31, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.2677862644195557
Epoch: 32, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.337672233581543
Epoch: 33, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.246126174926758
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.4460980892181396
Epoch: 35, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.078988790512085
Epoch: 36, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.4169178009033203
Epoch: 37, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.3298628330230713
Epoch: 38, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.308166027069092
Epoch: 39, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.3347091674804688
Epoch: 40, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.4717321395874023
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 2.326362371444702
Epoch: 42, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.3449318408966064
Epoch: 43, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.464940071105957
Epoch: 44, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.346949577331543
Epoch: 45, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.4653422832489014
Epoch: 46, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.031337261199951
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.9197587966918945
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.0261707305908203
Epoch: 49, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.2290267944335938
Epoch: 50, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.8734335899353027
Epoch: 51, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.073380947113037
Epoch: 52, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 2.3931381702423096
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 423012
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.347037076950073
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.472 Vali Acc: 0.289 Test Loss: 1.472 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 2.2618179321289062
Epoch: 2, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.413 Vali Acc: 0.309 Test Loss: 1.413 Test Acc: 0.309
Validation loss decreased (-0.289459 --> -0.309196).  Saving model ...
Epoch: 3 cost time: 2.31005859375
Epoch: 3, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.337 Vali Acc: 0.388 Test Loss: 1.337 Test Acc: 0.388
Validation loss decreased (-0.309196 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 2.359186887741089
Epoch: 4, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.259 Vali Acc: 0.428 Test Loss: 1.259 Test Acc: 0.428
Validation loss decreased (-0.388145 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 2.374824285507202
Epoch: 5, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
Validation loss decreased (-0.427619 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 2.2883412837982178
Epoch: 6, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.116 Vali Acc: 0.572 Test Loss: 1.116 Test Acc: 0.572
Validation loss decreased (-0.532883 --> -0.572357).  Saving model ...
Epoch: 7 cost time: 2.3362834453582764
Epoch: 7, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.056 Vali Acc: 0.618 Test Loss: 1.056 Test Acc: 0.618
Validation loss decreased (-0.572357 --> -0.618410).  Saving model ...
Epoch: 8 cost time: 2.2093567848205566
Epoch: 8, Steps: 10 | Train Loss: 0.823 Vali Loss: 0.998 Vali Acc: 0.645 Test Loss: 0.998 Test Acc: 0.645
Validation loss decreased (-0.618410 --> -0.644727).  Saving model ...
Epoch: 9 cost time: 2.2787044048309326
Epoch: 9, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.950 Vali Acc: 0.671 Test Loss: 0.950 Test Acc: 0.671
Validation loss decreased (-0.644727 --> -0.671043).  Saving model ...
Epoch: 10 cost time: 2.2971956729888916
Epoch: 10, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.909 Vali Acc: 0.678 Test Loss: 0.909 Test Acc: 0.678
Validation loss decreased (-0.671043 --> -0.677622).  Saving model ...
Epoch: 11 cost time: 2.2586584091186523
Epoch: 11, Steps: 10 | Train Loss: 0.629 Vali Loss: 0.870 Vali Acc: 0.684 Test Loss: 0.870 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684202).  Saving model ...
Epoch: 12 cost time: 2.2913475036621094
Epoch: 12, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.835 Vali Acc: 0.704 Test Loss: 0.835 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703939).  Saving model ...
Epoch: 13 cost time: 2.1019225120544434
Epoch: 13, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.808 Vali Acc: 0.691 Test Loss: 0.808 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2024478912353516
Epoch: 14, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.789 Vali Acc: 0.704 Test Loss: 0.789 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703939).  Saving model ...
Epoch: 15 cost time: 2.2166178226470947
Epoch: 15, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.768 Vali Acc: 0.724 Test Loss: 0.768 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723677).  Saving model ...
Epoch: 16 cost time: 2.2563133239746094
Epoch: 16, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.742 Vali Acc: 0.737 Test Loss: 0.742 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 17 cost time: 2.291231155395508
Epoch: 17, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.719 Vali Acc: 0.737 Test Loss: 0.719 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 18 cost time: 2.397691011428833
Epoch: 18, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.699 Vali Acc: 0.730 Test Loss: 0.699 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.408534049987793
Epoch: 19, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 20 cost time: 2.4897689819335938
Epoch: 20, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.683 Vali Acc: 0.763 Test Loss: 0.683 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 21 cost time: 2.3678762912750244
Epoch: 21, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.671 Vali Acc: 0.757 Test Loss: 0.671 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9177467823028564
Epoch: 22, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.982964277267456
Epoch: 23, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.626 Vali Acc: 0.763 Test Loss: 0.626 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 2.1416568756103516
Epoch: 24, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 25 cost time: 2.2926032543182373
Epoch: 25, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 26 cost time: 2.1481986045837402
Epoch: 26, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.602 Vali Acc: 0.789 Test Loss: 0.602 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 2.145801305770874
Epoch: 27, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 28 cost time: 2.421403646469116
Epoch: 28, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.587 Vali Acc: 0.796 Test Loss: 0.587 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 29 cost time: 2.406277894973755
Epoch: 29, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5714502334594727
Epoch: 30, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.354032278060913
Epoch: 31, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 32 cost time: 2.4342541694641113
Epoch: 32, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 33 cost time: 2.4281277656555176
Epoch: 33, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.361180305480957
Epoch: 34, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.494387149810791
Epoch: 35, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.629584789276123
Epoch: 36, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 37 cost time: 2.31599497795105
Epoch: 37, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.139894485473633
Epoch: 38, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.629 Vali Acc: 0.809 Test Loss: 0.629 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.092986583709717
Epoch: 39, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.480431318283081
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.349828004837036
Epoch: 41, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.653 Vali Acc: 0.809 Test Loss: 0.653 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.1263022422790527
Epoch: 42, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.168747663497925
Epoch: 43, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.1060802936553955
Epoch: 44, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.002652883529663
Epoch: 45, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.672 Vali Acc: 0.809 Test Loss: 0.672 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.3584063053131104
Epoch: 46, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.681 Vali Acc: 0.816 Test Loss: 0.681 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 47 cost time: 2.570756435394287
Epoch: 47, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.691 Vali Acc: 0.816 Test Loss: 0.691 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.406447172164917
Epoch: 48, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.691 Vali Acc: 0.816 Test Loss: 0.691 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.4570229053497314
Epoch: 49, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.693 Vali Acc: 0.816 Test Loss: 0.693 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.6183078289031982
Epoch: 50, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.695 Vali Acc: 0.809 Test Loss: 0.695 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.318438768386841
Epoch: 51, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.704 Vali Acc: 0.816 Test Loss: 0.704 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.4472815990448
Epoch: 52, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.718 Vali Acc: 0.803 Test Loss: 0.718 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.492037057876587
Epoch: 53, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.739 Vali Acc: 0.809 Test Loss: 0.739 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 2.4085638523101807
Epoch: 54, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.738 Vali Acc: 0.803 Test Loss: 0.738 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 2.121534824371338
Epoch: 55, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.723 Vali Acc: 0.789 Test Loss: 0.723 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.998171329498291
Epoch: 56, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.729 Vali Acc: 0.803 Test Loss: 0.729 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 226404
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.907410144805908
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.453 Vali Acc: 0.316 Test Loss: 1.453 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 2.1203699111938477
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.398 Vali Acc: 0.336 Test Loss: 1.398 Test Acc: 0.336
Validation loss decreased (-0.315775 --> -0.335512).  Saving model ...
Epoch: 3 cost time: 2.1928775310516357
Epoch: 3, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.328 Vali Acc: 0.388 Test Loss: 1.328 Test Acc: 0.388
Validation loss decreased (-0.335512 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 2.0936481952667236
Epoch: 4, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.261 Vali Acc: 0.441 Test Loss: 1.261 Test Acc: 0.441
Validation loss decreased (-0.388145 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 2.252324342727661
Epoch: 5, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
Validation loss decreased (-0.440777 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 2.073615312576294
Epoch: 6, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.143 Vali Acc: 0.572 Test Loss: 1.143 Test Acc: 0.572
Validation loss decreased (-0.499988 --> -0.572357).  Saving model ...
Epoch: 7 cost time: 2.1326122283935547
Epoch: 7, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.095 Vali Acc: 0.605 Test Loss: 1.095 Test Acc: 0.605
Validation loss decreased (-0.572357 --> -0.605252).  Saving model ...
Epoch: 8 cost time: 2.0479907989501953
Epoch: 8, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.051 Vali Acc: 0.612 Test Loss: 1.051 Test Acc: 0.612
Validation loss decreased (-0.605252 --> -0.611832).  Saving model ...
Epoch: 9 cost time: 2.076430082321167
Epoch: 9, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.014 Vali Acc: 0.625 Test Loss: 1.014 Test Acc: 0.625
Validation loss decreased (-0.611832 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 2.137932777404785
Epoch: 10, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.976 Vali Acc: 0.651 Test Loss: 0.976 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 1.8528289794921875
Epoch: 11, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.941 Vali Acc: 0.697 Test Loss: 0.941 Test Acc: 0.697
Validation loss decreased (-0.651306 --> -0.697359).  Saving model ...
Epoch: 12 cost time: 1.8052687644958496
Epoch: 12, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.910 Vali Acc: 0.697 Test Loss: 0.910 Test Acc: 0.697
Validation loss decreased (-0.697359 --> -0.697359).  Saving model ...
Epoch: 13 cost time: 2.008857488632202
Epoch: 13, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.884 Vali Acc: 0.711 Test Loss: 0.884 Test Acc: 0.711
Validation loss decreased (-0.697359 --> -0.710517).  Saving model ...
Epoch: 14 cost time: 2.05130934715271
Epoch: 14, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.864 Vali Acc: 0.711 Test Loss: 0.864 Test Acc: 0.711
Validation loss decreased (-0.710517 --> -0.710518).  Saving model ...
Epoch: 15 cost time: 2.0375583171844482
Epoch: 15, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.836 Vali Acc: 0.730 Test Loss: 0.836 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730255).  Saving model ...
Epoch: 16 cost time: 2.0707550048828125
Epoch: 16, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.804 Vali Acc: 0.743 Test Loss: 0.804 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743413).  Saving model ...
Epoch: 17 cost time: 2.042712450027466
Epoch: 17, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.771 Vali Acc: 0.757 Test Loss: 0.771 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756571).  Saving model ...
Epoch: 18 cost time: 2.142730712890625
Epoch: 18, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.745 Vali Acc: 0.763 Test Loss: 0.745 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763150).  Saving model ...
Epoch: 19 cost time: 2.2066853046417236
Epoch: 19, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.737 Vali Acc: 0.770 Test Loss: 0.737 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769729).  Saving model ...
Epoch: 20 cost time: 2.0392982959747314
Epoch: 20, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.714 Vali Acc: 0.770 Test Loss: 0.714 Test Acc: 0.770
Validation loss decreased (-0.769729 --> -0.769730).  Saving model ...
Epoch: 21 cost time: 2.3802170753479004
Epoch: 21, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.706 Vali Acc: 0.776 Test Loss: 0.706 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 22 cost time: 2.2701313495635986
Epoch: 22, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.682 Vali Acc: 0.783 Test Loss: 0.682 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 23 cost time: 2.166330337524414
Epoch: 23, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.666 Vali Acc: 0.796 Test Loss: 0.666 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796046).  Saving model ...
Epoch: 24 cost time: 2.176395893096924
Epoch: 24, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.655 Vali Acc: 0.796 Test Loss: 0.655 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796046).  Saving model ...
Epoch: 25 cost time: 2.232163667678833
Epoch: 25, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1440229415893555
Epoch: 26, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1699299812316895
Epoch: 27, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2821996212005615
Epoch: 28, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.607 Vali Acc: 0.796 Test Loss: 0.607 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796047).  Saving model ...
Epoch: 29 cost time: 2.2381598949432373
Epoch: 29, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.598 Vali Acc: 0.803 Test Loss: 0.598 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 2.0110793113708496
Epoch: 30, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.1633408069610596
Epoch: 31, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.610 Vali Acc: 0.783 Test Loss: 0.610 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9862101078033447
Epoch: 32, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.0565268993377686
Epoch: 33, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.164477586746216
Epoch: 34, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.610 Vali Acc: 0.776 Test Loss: 0.610 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.0391623973846436
Epoch: 35, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.0682404041290283
Epoch: 36, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.628 Vali Acc: 0.783 Test Loss: 0.628 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.0422818660736084
Epoch: 37, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.628 Vali Acc: 0.783 Test Loss: 0.628 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.0720207691192627
Epoch: 38, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.159385919570923
Epoch: 39, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 226404
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.259136438369751
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.455 Vali Acc: 0.296 Test Loss: 1.455 Test Acc: 0.296
Validation loss decreased (inf --> -0.296038).  Saving model ...
Epoch: 2 cost time: 2.3517396450042725
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.418 Vali Acc: 0.303 Test Loss: 1.418 Test Acc: 0.303
Validation loss decreased (-0.296038 --> -0.302617).  Saving model ...
Epoch: 3 cost time: 2.411874532699585
Epoch: 3, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.370 Vali Acc: 0.322 Test Loss: 1.370 Test Acc: 0.322
Validation loss decreased (-0.302617 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 2.4700980186462402
Epoch: 4, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.323 Vali Acc: 0.388 Test Loss: 1.323 Test Acc: 0.388
Validation loss decreased (-0.322355 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 2.233325242996216
Epoch: 5, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.273 Vali Acc: 0.428 Test Loss: 1.273 Test Acc: 0.428
Validation loss decreased (-0.388145 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 2.314964532852173
Epoch: 6, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.226 Vali Acc: 0.474 Test Loss: 1.226 Test Acc: 0.474
Validation loss decreased (-0.427619 --> -0.473672).  Saving model ...
Epoch: 7 cost time: 2.001746416091919
Epoch: 7, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.184 Vali Acc: 0.493 Test Loss: 1.184 Test Acc: 0.493
Validation loss decreased (-0.473672 --> -0.493409).  Saving model ...
Epoch: 8 cost time: 2.2573044300079346
Epoch: 8, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.140 Vali Acc: 0.513 Test Loss: 1.140 Test Acc: 0.513
Validation loss decreased (-0.493409 --> -0.513146).  Saving model ...
Epoch: 9 cost time: 2.1568548679351807
Epoch: 9, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
Validation loss decreased (-0.513146 --> -0.532884).  Saving model ...
Epoch: 10 cost time: 2.2437660694122314
Epoch: 10, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.070 Vali Acc: 0.566 Test Loss: 1.070 Test Acc: 0.566
Validation loss decreased (-0.532884 --> -0.565779).  Saving model ...
Epoch: 11 cost time: 2.084341287612915
Epoch: 11, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.036 Vali Acc: 0.579 Test Loss: 1.036 Test Acc: 0.579
Validation loss decreased (-0.565779 --> -0.578937).  Saving model ...
Epoch: 12 cost time: 2.36216139793396
Epoch: 12, Steps: 10 | Train Loss: 0.768 Vali Loss: 1.000 Vali Acc: 0.612 Test Loss: 1.000 Test Acc: 0.612
Validation loss decreased (-0.578937 --> -0.611832).  Saving model ...
Epoch: 13 cost time: 2.2172083854675293
Epoch: 13, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.967 Vali Acc: 0.632 Test Loss: 0.967 Test Acc: 0.632
Validation loss decreased (-0.611832 --> -0.631569).  Saving model ...
Epoch: 14 cost time: 2.251328468322754
Epoch: 14, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.939 Vali Acc: 0.671 Test Loss: 0.939 Test Acc: 0.671
Validation loss decreased (-0.631569 --> -0.671043).  Saving model ...
Epoch: 15 cost time: 2.2168354988098145
Epoch: 15, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.907 Vali Acc: 0.678 Test Loss: 0.907 Test Acc: 0.678
Validation loss decreased (-0.671043 --> -0.677623).  Saving model ...
Epoch: 16 cost time: 2.344167947769165
Epoch: 16, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.871 Vali Acc: 0.684 Test Loss: 0.871 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684202).  Saving model ...
Epoch: 17 cost time: 2.3344779014587402
Epoch: 17, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.831 Vali Acc: 0.711 Test Loss: 0.831 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710518).  Saving model ...
Epoch: 18 cost time: 2.3916752338409424
Epoch: 18, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.795 Vali Acc: 0.711 Test Loss: 0.795 Test Acc: 0.711
Validation loss decreased (-0.710518 --> -0.710518).  Saving model ...
Epoch: 19 cost time: 2.3543639183044434
Epoch: 19, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.765 Vali Acc: 0.724 Test Loss: 0.765 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723677).  Saving model ...
Epoch: 20 cost time: 2.202310562133789
Epoch: 20, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.728 Vali Acc: 0.737 Test Loss: 0.728 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 21 cost time: 2.1114656925201416
Epoch: 21, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.702 Vali Acc: 0.743 Test Loss: 0.702 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 22 cost time: 2.1239938735961914
Epoch: 22, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.682 Vali Acc: 0.737 Test Loss: 0.682 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.06929087638855
Epoch: 23, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.655 Vali Acc: 0.763 Test Loss: 0.655 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763151).  Saving model ...
Epoch: 24 cost time: 2.058809995651245
Epoch: 24, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.632 Vali Acc: 0.770 Test Loss: 0.632 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 25 cost time: 2.0583553314208984
Epoch: 25, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.617 Vali Acc: 0.776 Test Loss: 0.617 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 26 cost time: 2.338768243789673
Epoch: 26, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.600 Vali Acc: 0.776 Test Loss: 0.600 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 27 cost time: 2.0220260620117188
Epoch: 27, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.031628131866455
Epoch: 28, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.053490161895752
Epoch: 29, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0856740474700928
Epoch: 30, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 31 cost time: 2.0554285049438477
Epoch: 31, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 32 cost time: 2.179750919342041
Epoch: 32, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2879831790924072
Epoch: 33, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.394491672515869
Epoch: 34, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.1013970375061035
Epoch: 35, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.2281906604766846
Epoch: 36, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.1432557106018066
Epoch: 37, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.41679310798645
Epoch: 38, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.562 Vali Acc: 0.796 Test Loss: 0.562 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.3722832202911377
Epoch: 39, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.315406084060669
Epoch: 40, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 41 cost time: 2.040811538696289
Epoch: 41, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 42 cost time: 2.07896089553833
Epoch: 42, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.567 Vali Acc: 0.789 Test Loss: 0.567 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.1521098613739014
Epoch: 43, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.574 Vali Acc: 0.803 Test Loss: 0.574 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.2840576171875
Epoch: 44, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.575 Vali Acc: 0.796 Test Loss: 0.575 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.9426941871643066
Epoch: 45, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.9679527282714844
Epoch: 46, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.139817476272583
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.0862278938293457
Epoch: 48, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.594 Vali Acc: 0.796 Test Loss: 0.594 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.350330114364624
Epoch: 49, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.600 Vali Acc: 0.796 Test Loss: 0.600 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.198465585708618
Epoch: 50, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.162702798843384
Epoch: 51, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.614 Vali Acc: 0.803 Test Loss: 0.614 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 226404
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7941248416900635
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.431 Vali Acc: 0.309 Test Loss: 1.431 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 2.1802403926849365
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.409 Vali Acc: 0.303 Test Loss: 1.409 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4295713901519775
Epoch: 3, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.382 Vali Acc: 0.316 Test Loss: 1.382 Test Acc: 0.316
Validation loss decreased (-0.309196 --> -0.315776).  Saving model ...
Epoch: 4 cost time: 1.9218900203704834
Epoch: 4, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.353 Vali Acc: 0.329 Test Loss: 1.353 Test Acc: 0.329
Validation loss decreased (-0.315776 --> -0.328934).  Saving model ...
Epoch: 5 cost time: 2.0208730697631836
Epoch: 5, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.322 Vali Acc: 0.355 Test Loss: 1.322 Test Acc: 0.355
Validation loss decreased (-0.328934 --> -0.355250).  Saving model ...
Epoch: 6 cost time: 2.113408088684082
Epoch: 6, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.290 Vali Acc: 0.414 Test Loss: 1.290 Test Acc: 0.414
Validation loss decreased (-0.355250 --> -0.414461).  Saving model ...
Epoch: 7 cost time: 2.2433509826660156
Epoch: 7, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.259 Vali Acc: 0.428 Test Loss: 1.259 Test Acc: 0.428
Validation loss decreased (-0.414461 --> -0.427619).  Saving model ...
Epoch: 8 cost time: 2.332868814468384
Epoch: 8, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.225 Vali Acc: 0.441 Test Loss: 1.225 Test Acc: 0.441
Validation loss decreased (-0.427619 --> -0.440777).  Saving model ...
Epoch: 9 cost time: 2.124574661254883
Epoch: 9, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.190 Vali Acc: 0.441 Test Loss: 1.190 Test Acc: 0.441
Validation loss decreased (-0.440777 --> -0.440778).  Saving model ...
Epoch: 10 cost time: 2.189659595489502
Epoch: 10, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.159 Vali Acc: 0.474 Test Loss: 1.159 Test Acc: 0.474
Validation loss decreased (-0.440778 --> -0.473673).  Saving model ...
Epoch: 11 cost time: 2.0847318172454834
Epoch: 11, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.128 Vali Acc: 0.507 Test Loss: 1.128 Test Acc: 0.507
Validation loss decreased (-0.473673 --> -0.506568).  Saving model ...
Epoch: 12 cost time: 2.202949047088623
Epoch: 12, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.506568 --> -0.532884).  Saving model ...
Epoch: 13 cost time: 2.1419825553894043
Epoch: 13, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.064 Vali Acc: 0.546 Test Loss: 1.064 Test Acc: 0.546
Validation loss decreased (-0.532884 --> -0.546042).  Saving model ...
Epoch: 14 cost time: 2.160444974899292
Epoch: 14, Steps: 10 | Train Loss: 0.742 Vali Loss: 1.032 Vali Acc: 0.553 Test Loss: 1.032 Test Acc: 0.553
Validation loss decreased (-0.546042 --> -0.552621).  Saving model ...
Epoch: 15 cost time: 2.097533941268921
Epoch: 15, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.995 Vali Acc: 0.559 Test Loss: 0.995 Test Acc: 0.559
Validation loss decreased (-0.552621 --> -0.559201).  Saving model ...
Epoch: 16 cost time: 2.2503464221954346
Epoch: 16, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.957 Vali Acc: 0.592 Test Loss: 0.957 Test Acc: 0.592
Validation loss decreased (-0.559201 --> -0.592096).  Saving model ...
Epoch: 17 cost time: 2.2509191036224365
Epoch: 17, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.920 Vali Acc: 0.612 Test Loss: 0.920 Test Acc: 0.612
Validation loss decreased (-0.592096 --> -0.611833).  Saving model ...
Epoch: 18 cost time: 2.008960723876953
Epoch: 18, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.877 Vali Acc: 0.632 Test Loss: 0.877 Test Acc: 0.632
Validation loss decreased (-0.611833 --> -0.631570).  Saving model ...
Epoch: 19 cost time: 2.0826833248138428
Epoch: 19, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.832 Vali Acc: 0.678 Test Loss: 0.832 Test Acc: 0.678
Validation loss decreased (-0.631570 --> -0.677623).  Saving model ...
Epoch: 20 cost time: 1.8846461772918701
Epoch: 20, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.791 Vali Acc: 0.671 Test Loss: 0.791 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1626527309417725
Epoch: 21, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.750 Vali Acc: 0.691 Test Loss: 0.750 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690782).  Saving model ...
Epoch: 22 cost time: 1.9338359832763672
Epoch: 22, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.715 Vali Acc: 0.724 Test Loss: 0.715 Test Acc: 0.724
Validation loss decreased (-0.690782 --> -0.723677).  Saving model ...
Epoch: 23 cost time: 2.1727755069732666
Epoch: 23, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.675 Vali Acc: 0.737 Test Loss: 0.675 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 24 cost time: 2.233613967895508
Epoch: 24, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.645 Vali Acc: 0.743 Test Loss: 0.645 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 25 cost time: 2.4137978553771973
Epoch: 25, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.615 Vali Acc: 0.730 Test Loss: 0.615 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2196013927459717
Epoch: 26, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.584 Vali Acc: 0.770 Test Loss: 0.584 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 2.387212038040161
Epoch: 27, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 28 cost time: 2.3293752670288086
Epoch: 28, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 29 cost time: 2.3215198516845703
Epoch: 29, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.534 Vali Acc: 0.783 Test Loss: 0.534 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 30 cost time: 2.4398610591888428
Epoch: 30, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 31 cost time: 2.264164686203003
Epoch: 31, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.3767871856689453
Epoch: 32, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.3832528591156006
Epoch: 33, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.262385606765747
Epoch: 34, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
Validation loss decreased (-0.802626 --> -0.822363).  Saving model ...
Epoch: 35 cost time: 2.421862840652466
Epoch: 35, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 36 cost time: 1.9482440948486328
Epoch: 36, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.3372111320495605
Epoch: 37, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.1055498123168945
Epoch: 38, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.158670425415039
Epoch: 39, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.1779701709747314
Epoch: 40, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.242114782333374
Epoch: 41, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.521 Vali Acc: 0.829 Test Loss: 0.521 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 42 cost time: 2.122174024581909
Epoch: 42, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.522 Vali Acc: 0.836 Test Loss: 0.522 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 43 cost time: 2.2271318435668945
Epoch: 43, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.522 Vali Acc: 0.836 Test Loss: 0.522 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.9305338859558105
Epoch: 44, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.526 Vali Acc: 0.829 Test Loss: 0.526 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.0442399978637695
Epoch: 45, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.525 Vali Acc: 0.842 Test Loss: 0.525 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 46 cost time: 2.0328147411346436
Epoch: 46, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.532 Vali Acc: 0.836 Test Loss: 0.532 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.2100656032562256
Epoch: 47, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.537 Vali Acc: 0.836 Test Loss: 0.537 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.392188787460327
Epoch: 48, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.543 Vali Acc: 0.836 Test Loss: 0.543 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.342435359954834
Epoch: 49, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.542 Vali Acc: 0.842 Test Loss: 0.542 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.290027379989624
Epoch: 50, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.541 Vali Acc: 0.829 Test Loss: 0.541 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.321012258529663
Epoch: 51, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.547 Vali Acc: 0.829 Test Loss: 0.547 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.376217842102051
Epoch: 52, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.551 Vali Acc: 0.836 Test Loss: 0.551 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 2.397887706756592
Epoch: 53, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.552 Vali Acc: 0.829 Test Loss: 0.552 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 2.21235990524292
Epoch: 54, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.551 Vali Acc: 0.849 Test Loss: 0.551 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848679).  Saving model ...
Epoch: 55 cost time: 2.280590534210205
Epoch: 55, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.553 Vali Acc: 0.842 Test Loss: 0.553 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.072496175765991
Epoch: 56, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.564 Vali Acc: 0.842 Test Loss: 0.564 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.1613988876342773
Epoch: 57, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.580 Vali Acc: 0.836 Test Loss: 0.580 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.190901517868042
Epoch: 58, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.592 Vali Acc: 0.836 Test Loss: 0.592 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.026597023010254
Epoch: 59, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.592 Vali Acc: 0.836 Test Loss: 0.592 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.302885055541992
Epoch: 60, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.595 Vali Acc: 0.836 Test Loss: 0.595 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 2.1583311557769775
Epoch: 61, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.603 Vali Acc: 0.829 Test Loss: 0.603 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.2010605335235596
Epoch: 62, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.605 Vali Acc: 0.836 Test Loss: 0.605 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 2.3653838634490967
Epoch: 63, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 2.3127825260162354
Epoch: 64, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.610 Vali Acc: 0.829 Test Loss: 0.610 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 226404
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6595101356506348
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.428 Vali Acc: 0.237 Test Loss: 1.428 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.9193236827850342
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.418 Vali Acc: 0.230 Test Loss: 1.418 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8773322105407715
Epoch: 3, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.402 Vali Acc: 0.263 Test Loss: 1.402 Test Acc: 0.263
Validation loss decreased (-0.236828 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 2.0443432331085205
Epoch: 4, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
Validation loss decreased (-0.263144 --> -0.269723).  Saving model ...
Epoch: 5 cost time: 2.1333203315734863
Epoch: 5, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.372 Vali Acc: 0.303 Test Loss: 1.372 Test Acc: 0.303
Validation loss decreased (-0.269723 --> -0.302618).  Saving model ...
Epoch: 6 cost time: 2.002305507659912
Epoch: 6, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.353 Vali Acc: 0.303 Test Loss: 1.353 Test Acc: 0.303
Validation loss decreased (-0.302618 --> -0.302618).  Saving model ...
Epoch: 7 cost time: 2.1657748222351074
Epoch: 7, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.333 Vali Acc: 0.329 Test Loss: 1.333 Test Acc: 0.329
Validation loss decreased (-0.302618 --> -0.328934).  Saving model ...
Epoch: 8 cost time: 2.0947725772857666
Epoch: 8, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.313 Vali Acc: 0.362 Test Loss: 1.313 Test Acc: 0.362
Validation loss decreased (-0.328934 --> -0.361829).  Saving model ...
Epoch: 9 cost time: 2.0575649738311768
Epoch: 9, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.288 Vali Acc: 0.362 Test Loss: 1.288 Test Acc: 0.362
Validation loss decreased (-0.361829 --> -0.361829).  Saving model ...
Epoch: 10 cost time: 2.0883166790008545
Epoch: 10, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.263 Vali Acc: 0.349 Test Loss: 1.263 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0606918334960938
Epoch: 11, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.228 Vali Acc: 0.428 Test Loss: 1.228 Test Acc: 0.428
Validation loss decreased (-0.361829 --> -0.427619).  Saving model ...
Epoch: 12 cost time: 2.045607328414917
Epoch: 12, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.193 Vali Acc: 0.428 Test Loss: 1.193 Test Acc: 0.428
Validation loss decreased (-0.427619 --> -0.427620).  Saving model ...
Epoch: 13 cost time: 1.9595921039581299
Epoch: 13, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.148 Vali Acc: 0.487 Test Loss: 1.148 Test Acc: 0.487
Validation loss decreased (-0.427620 --> -0.486831).  Saving model ...
Epoch: 14 cost time: 1.9953620433807373
Epoch: 14, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.092 Vali Acc: 0.526 Test Loss: 1.092 Test Acc: 0.526
Validation loss decreased (-0.486831 --> -0.526305).  Saving model ...
Epoch: 15 cost time: 1.9599511623382568
Epoch: 15, Steps: 10 | Train Loss: 0.859 Vali Loss: 1.029 Vali Acc: 0.572 Test Loss: 1.029 Test Acc: 0.572
Validation loss decreased (-0.526305 --> -0.572358).  Saving model ...
Epoch: 16 cost time: 2.0211758613586426
Epoch: 16, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.969 Vali Acc: 0.605 Test Loss: 0.969 Test Acc: 0.605
Validation loss decreased (-0.572358 --> -0.605253).  Saving model ...
Epoch: 17 cost time: 2.055842876434326
Epoch: 17, Steps: 10 | Train Loss: 0.720 Vali Loss: 0.906 Vali Acc: 0.645 Test Loss: 0.906 Test Acc: 0.645
Validation loss decreased (-0.605253 --> -0.644728).  Saving model ...
Epoch: 18 cost time: 2.133319854736328
Epoch: 18, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.839 Vali Acc: 0.664 Test Loss: 0.839 Test Acc: 0.664
Validation loss decreased (-0.644728 --> -0.664465).  Saving model ...
Epoch: 19 cost time: 2.0494799613952637
Epoch: 19, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.781 Vali Acc: 0.697 Test Loss: 0.781 Test Acc: 0.697
Validation loss decreased (-0.664465 --> -0.697361).  Saving model ...
Epoch: 20 cost time: 2.2688658237457275
Epoch: 20, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.725 Vali Acc: 0.724 Test Loss: 0.725 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723677).  Saving model ...
Epoch: 21 cost time: 2.0803160667419434
Epoch: 21, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 22 cost time: 2.1047215461730957
Epoch: 22, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.624 Vali Acc: 0.750 Test Loss: 0.624 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 23 cost time: 2.210501194000244
Epoch: 23, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.590 Vali Acc: 0.757 Test Loss: 0.590 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 24 cost time: 2.2478389739990234
Epoch: 24, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 25 cost time: 1.9966115951538086
Epoch: 25, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.544 Vali Acc: 0.770 Test Loss: 0.544 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.919912576675415
Epoch: 26, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 2.0175421237945557
Epoch: 27, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0698413848876953
Epoch: 28, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1220245361328125
Epoch: 29, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.491 Vali Acc: 0.763 Test Loss: 0.491 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.029370069503784
Epoch: 30, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.482 Vali Acc: 0.770 Test Loss: 0.482 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.077033042907715
Epoch: 31, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.479 Vali Acc: 0.776 Test Loss: 0.479 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.2307541370391846
Epoch: 32, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.492 Vali Acc: 0.776 Test Loss: 0.492 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.216610908508301
Epoch: 33, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.2148096561431885
Epoch: 34, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.484 Vali Acc: 0.763 Test Loss: 0.484 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.0726354122161865
Epoch: 35, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.491 Vali Acc: 0.770 Test Loss: 0.491 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.2840020656585693
Epoch: 36, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.493 Vali Acc: 0.770 Test Loss: 0.493 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 226404
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9859187602996826
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.467 Vali Acc: 0.243 Test Loss: 1.467 Test Acc: 0.243
Validation loss decreased (inf --> -0.243406).  Saving model ...
Epoch: 2 cost time: 2.109180450439453
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.455 Vali Acc: 0.257 Test Loss: 1.455 Test Acc: 0.257
Validation loss decreased (-0.243406 --> -0.256564).  Saving model ...
Epoch: 3 cost time: 2.0531487464904785
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.437 Vali Acc: 0.263 Test Loss: 1.437 Test Acc: 0.263
Validation loss decreased (-0.256564 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 1.90744948387146
Epoch: 4, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.418 Vali Acc: 0.276 Test Loss: 1.418 Test Acc: 0.276
Validation loss decreased (-0.263144 --> -0.276302).  Saving model ...
Epoch: 5 cost time: 2.156609535217285
Epoch: 5, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.399 Vali Acc: 0.289 Test Loss: 1.399 Test Acc: 0.289
Validation loss decreased (-0.276302 --> -0.289460).  Saving model ...
Epoch: 6 cost time: 1.9880692958831787
Epoch: 6, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.377 Vali Acc: 0.296 Test Loss: 1.377 Test Acc: 0.296
Validation loss decreased (-0.289460 --> -0.296039).  Saving model ...
Epoch: 7 cost time: 2.28946590423584
Epoch: 7, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.351 Vali Acc: 0.329 Test Loss: 1.351 Test Acc: 0.329
Validation loss decreased (-0.296039 --> -0.328934).  Saving model ...
Epoch: 8 cost time: 2.0659096240997314
Epoch: 8, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.324 Vali Acc: 0.382 Test Loss: 1.324 Test Acc: 0.382
Validation loss decreased (-0.328934 --> -0.381566).  Saving model ...
Epoch: 9 cost time: 2.2853801250457764
Epoch: 9, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.292 Vali Acc: 0.414 Test Loss: 1.292 Test Acc: 0.414
Validation loss decreased (-0.381566 --> -0.414461).  Saving model ...
Epoch: 10 cost time: 2.147059202194214
Epoch: 10, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.266 Vali Acc: 0.414 Test Loss: 1.266 Test Acc: 0.414
Validation loss decreased (-0.414461 --> -0.414461).  Saving model ...
Epoch: 11 cost time: 2.176567792892456
Epoch: 11, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.232 Vali Acc: 0.454 Test Loss: 1.232 Test Acc: 0.454
Validation loss decreased (-0.414461 --> -0.453935).  Saving model ...
Epoch: 12 cost time: 1.9214651584625244
Epoch: 12, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.203 Vali Acc: 0.467 Test Loss: 1.203 Test Acc: 0.467
Validation loss decreased (-0.453935 --> -0.467093).  Saving model ...
Epoch: 13 cost time: 2.034013509750366
Epoch: 13, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.164 Vali Acc: 0.507 Test Loss: 1.164 Test Acc: 0.507
Validation loss decreased (-0.467093 --> -0.506567).  Saving model ...
Epoch: 14 cost time: 1.9893629550933838
Epoch: 14, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
Validation loss decreased (-0.506567 --> -0.532884).  Saving model ...
Epoch: 15 cost time: 1.9395053386688232
Epoch: 15, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.072 Vali Acc: 0.546 Test Loss: 1.072 Test Acc: 0.546
Validation loss decreased (-0.532884 --> -0.546042).  Saving model ...
Epoch: 16 cost time: 1.9977664947509766
Epoch: 16, Steps: 10 | Train Loss: 0.741 Vali Loss: 1.016 Vali Acc: 0.625 Test Loss: 1.016 Test Acc: 0.625
Validation loss decreased (-0.546042 --> -0.624990).  Saving model ...
Epoch: 17 cost time: 2.0774309635162354
Epoch: 17, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.958 Vali Acc: 0.625 Test Loss: 0.958 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 2.067591428756714
Epoch: 18, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.895 Vali Acc: 0.638 Test Loss: 0.895 Test Acc: 0.638
Validation loss decreased (-0.624990 --> -0.638149).  Saving model ...
Epoch: 19 cost time: 2.1361546516418457
Epoch: 19, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.837 Vali Acc: 0.658 Test Loss: 0.837 Test Acc: 0.658
Validation loss decreased (-0.638149 --> -0.657886).  Saving model ...
Epoch: 20 cost time: 2.1501574516296387
Epoch: 20, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.783 Vali Acc: 0.684 Test Loss: 0.783 Test Acc: 0.684
Validation loss decreased (-0.657886 --> -0.684203).  Saving model ...
Epoch: 21 cost time: 2.0961673259735107
Epoch: 21, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.732 Vali Acc: 0.691 Test Loss: 0.732 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 22 cost time: 2.216921091079712
Epoch: 22, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.693 Vali Acc: 0.730 Test Loss: 0.693 Test Acc: 0.730
Validation loss decreased (-0.690782 --> -0.730256).  Saving model ...
Epoch: 23 cost time: 2.172076940536499
Epoch: 23, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.652 Vali Acc: 0.743 Test Loss: 0.652 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 24 cost time: 2.1933493614196777
Epoch: 24, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.622 Vali Acc: 0.743 Test Loss: 0.622 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 25 cost time: 2.120034694671631
Epoch: 25, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 26 cost time: 2.118227958679199
Epoch: 26, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 27 cost time: 1.9825387001037598
Epoch: 27, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 28 cost time: 2.015000581741333
Epoch: 28, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 29 cost time: 2.1787333488464355
Epoch: 29, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.111391305923462
Epoch: 30, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8918955326080322
Epoch: 31, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9060492515563965
Epoch: 32, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.0677974224090576
Epoch: 33, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 34 cost time: 2.084506034851074
Epoch: 34, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.523 Vali Acc: 0.776 Test Loss: 0.523 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.06614089012146
Epoch: 35, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.9845597743988037
Epoch: 36, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.219404935836792
Epoch: 37, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.2021217346191406
Epoch: 38, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.0388717651367188
Epoch: 39, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.0854878425598145
Epoch: 40, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.9907491207122803
Epoch: 41, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.113724708557129
Epoch: 42, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.182681083679199
Epoch: 43, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 226404
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.219688653945923
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 2.1153202056884766
Epoch: 2, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 2.108945608139038
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 4 cost time: 2.1435465812683105
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2088398933410645
Epoch: 5, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 6 cost time: 2.1606223583221436
Epoch: 6, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 7 cost time: 2.015928030014038
Epoch: 7, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 8 cost time: 2.1945855617523193
Epoch: 8, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 9 cost time: 2.094700813293457
Epoch: 9, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 10 cost time: 2.0201449394226074
Epoch: 10, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 11 cost time: 1.9914882183074951
Epoch: 11, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 12 cost time: 2.0508334636688232
Epoch: 12, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 13 cost time: 2.1357007026672363
Epoch: 13, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 14 cost time: 2.23234224319458
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 15 cost time: 2.2470340728759766
Epoch: 15, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 16 cost time: 2.201770305633545
Epoch: 16, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 17 cost time: 2.1844894886016846
Epoch: 17, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 18 cost time: 2.2067391872406006
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 19 cost time: 2.2137818336486816
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 20 cost time: 2.0507397651672363
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 21 cost time: 2.1308655738830566
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 22 cost time: 2.3516201972961426
Epoch: 22, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 23 cost time: 2.2132303714752197
Epoch: 23, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 24 cost time: 2.0977914333343506
Epoch: 24, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 25 cost time: 2.155834436416626
Epoch: 25, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.224 Test Loss: 1.385 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3674097061157227
Epoch: 26, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.223670 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.325605630874634
Epoch: 27, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.3242011070251465
Epoch: 28, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.537424087524414
Epoch: 29, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.4938628673553467
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.5249810218811035
Epoch: 31, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 2.3307268619537354
Epoch: 32, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.4050686359405518
Epoch: 33, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.249229907989502
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.018744945526123
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.146989583969116
Epoch: 36, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.3165693283081055
Epoch: 37, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.1157453060150146
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.2844436168670654
Epoch: 39, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.1899051666259766
Epoch: 40, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.2865006923675537
Epoch: 41, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 2.476311445236206
Epoch: 42, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 2.20584774017334
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.1541495323181152
Epoch: 44, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.255990743637085
Epoch: 45, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.237457752227783
Epoch: 46, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 2.1943843364715576
Epoch: 47, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.3204405307769775
Epoch: 48, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.3195102214813232
Epoch: 49, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.351795196533203
Epoch: 50, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.3972339630126953
Epoch: 51, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.4368958473205566
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 53 cost time: 2.460134983062744
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 2.4807181358337402
Epoch: 54, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.348766803741455
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.2069168090820312
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 57 cost time: 2.3826401233673096
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 58 cost time: 2.18845796585083
Epoch: 58, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 59 cost time: 2.200673818588257
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 60 cost time: 2.255721092224121
Epoch: 60, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.037052631378174
Epoch: 61, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 2.2579760551452637
Epoch: 62, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 2.405019760131836
Epoch: 63, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 2.373584032058716
Epoch: 64, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 2.335880756378174
Epoch: 65, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 2.5234375
Epoch: 66, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 2.4699180126190186
Epoch: 67, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 2.2361505031585693
Epoch: 68, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 2.0119833946228027
Epoch: 69, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 226404
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.997957229614258
Epoch: 1, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.414 Vali Acc: 0.276 Test Loss: 1.414 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 2.0361642837524414
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.360 Vali Acc: 0.303 Test Loss: 1.360 Test Acc: 0.303
Validation loss decreased (-0.276302 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 2.252668857574463
Epoch: 3, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.298 Vali Acc: 0.401 Test Loss: 1.298 Test Acc: 0.401
Validation loss decreased (-0.302618 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 2.270084857940674
Epoch: 4, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.228 Vali Acc: 0.539 Test Loss: 1.228 Test Acc: 0.539
Validation loss decreased (-0.401303 --> -0.539461).  Saving model ...
Epoch: 5 cost time: 2.1599113941192627
Epoch: 5, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.166 Vali Acc: 0.618 Test Loss: 1.166 Test Acc: 0.618
Validation loss decreased (-0.539461 --> -0.618409).  Saving model ...
Epoch: 6 cost time: 2.1355650424957275
Epoch: 6, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.104 Vali Acc: 0.632 Test Loss: 1.104 Test Acc: 0.632
Validation loss decreased (-0.618409 --> -0.631568).  Saving model ...
Epoch: 7 cost time: 2.1890952587127686
Epoch: 7, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.051 Vali Acc: 0.651 Test Loss: 1.051 Test Acc: 0.651
Validation loss decreased (-0.631568 --> -0.651305).  Saving model ...
Epoch: 8 cost time: 2.284842014312744
Epoch: 8, Steps: 10 | Train Loss: 0.855 Vali Loss: 0.999 Vali Acc: 0.678 Test Loss: 0.999 Test Acc: 0.678
Validation loss decreased (-0.651305 --> -0.677622).  Saving model ...
Epoch: 9 cost time: 2.2270851135253906
Epoch: 9, Steps: 10 | Train Loss: 0.811 Vali Loss: 0.956 Vali Acc: 0.678 Test Loss: 0.956 Test Acc: 0.678
Validation loss decreased (-0.677622 --> -0.677622).  Saving model ...
Epoch: 10 cost time: 2.2471606731414795
Epoch: 10, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.916 Vali Acc: 0.691 Test Loss: 0.916 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690780).  Saving model ...
Epoch: 11 cost time: 2.1553244590759277
Epoch: 11, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.881 Vali Acc: 0.704 Test Loss: 0.881 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703939).  Saving model ...
Epoch: 12 cost time: 2.2136616706848145
Epoch: 12, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.846 Vali Acc: 0.711 Test Loss: 0.846 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710518).  Saving model ...
Epoch: 13 cost time: 2.072828531265259
Epoch: 13, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.819 Vali Acc: 0.711 Test Loss: 0.819 Test Acc: 0.711
Validation loss decreased (-0.710518 --> -0.710518).  Saving model ...
Epoch: 14 cost time: 1.969590663909912
Epoch: 14, Steps: 10 | Train Loss: 0.546 Vali Loss: 0.788 Vali Acc: 0.724 Test Loss: 0.788 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723676).  Saving model ...
Epoch: 15 cost time: 2.059619426727295
Epoch: 15, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.760 Vali Acc: 0.737 Test Loss: 0.760 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736835).  Saving model ...
Epoch: 16 cost time: 2.182765007019043
Epoch: 16, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.737 Vali Acc: 0.737 Test Loss: 0.737 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 17 cost time: 2.1256182193756104
Epoch: 17, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.720 Vali Acc: 0.730 Test Loss: 0.720 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1101505756378174
Epoch: 18, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.695 Vali Acc: 0.743 Test Loss: 0.695 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 19 cost time: 2.2940845489501953
Epoch: 19, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.672 Vali Acc: 0.750 Test Loss: 0.672 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 20 cost time: 2.1969077587127686
Epoch: 20, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.653 Vali Acc: 0.757 Test Loss: 0.653 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 21 cost time: 2.193460464477539
Epoch: 21, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.640 Vali Acc: 0.757 Test Loss: 0.640 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 22 cost time: 2.320592164993286
Epoch: 22, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.629 Vali Acc: 0.770 Test Loss: 0.629 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 23 cost time: 2.201024055480957
Epoch: 23, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.612 Vali Acc: 0.763 Test Loss: 0.612 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.051486015319824
Epoch: 24, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.601 Vali Acc: 0.776 Test Loss: 0.601 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 25 cost time: 2.1530120372772217
Epoch: 25, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.591 Vali Acc: 0.783 Test Loss: 0.591 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 2.0502943992614746
Epoch: 26, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 2.147745132446289
Epoch: 27, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.172389030456543
Epoch: 28, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 29 cost time: 2.2005703449249268
Epoch: 29, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 30 cost time: 2.0911524295806885
Epoch: 30, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0514028072357178
Epoch: 31, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 32 cost time: 2.022550344467163
Epoch: 32, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.533 Vali Acc: 0.803 Test Loss: 0.533 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 33 cost time: 2.092421054840088
Epoch: 33, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 34 cost time: 2.119868278503418
Epoch: 34, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.109064817428589
Epoch: 35, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.06432843208313
Epoch: 36, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 37 cost time: 2.1884407997131348
Epoch: 37, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8795571327209473
Epoch: 38, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.0100817680358887
Epoch: 39, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.3558530807495117
Epoch: 40, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.207381010055542
Epoch: 41, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.485166311264038
Epoch: 42, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.4171552658081055
Epoch: 43, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.572 Vali Acc: 0.803 Test Loss: 0.572 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.1849136352539062
Epoch: 44, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.2107977867126465
Epoch: 45, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.9519472122192383
Epoch: 46, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 128100
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.194740533828735
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.417 Vali Acc: 0.263 Test Loss: 1.417 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.182011604309082
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.371 Vali Acc: 0.283 Test Loss: 1.371 Test Acc: 0.283
Validation loss decreased (-0.263144 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 2.1442248821258545
Epoch: 3, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.318 Vali Acc: 0.375 Test Loss: 1.318 Test Acc: 0.375
Validation loss decreased (-0.282881 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 2.3781800270080566
Epoch: 4, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.258 Vali Acc: 0.467 Test Loss: 1.258 Test Acc: 0.467
Validation loss decreased (-0.374987 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 2.23270320892334
Epoch: 5, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.203 Vali Acc: 0.526 Test Loss: 1.203 Test Acc: 0.526
Validation loss decreased (-0.467093 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 2.1494619846343994
Epoch: 6, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.152 Vali Acc: 0.572 Test Loss: 1.152 Test Acc: 0.572
Validation loss decreased (-0.526304 --> -0.572357).  Saving model ...
Epoch: 7 cost time: 2.205033302307129
Epoch: 7, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.106 Vali Acc: 0.586 Test Loss: 1.106 Test Acc: 0.586
Validation loss decreased (-0.572357 --> -0.585515).  Saving model ...
Epoch: 8 cost time: 2.270437240600586
Epoch: 8, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.059 Vali Acc: 0.645 Test Loss: 1.059 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644726).  Saving model ...
Epoch: 9 cost time: 2.1120264530181885
Epoch: 9, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.024 Vali Acc: 0.658 Test Loss: 1.024 Test Acc: 0.658
Validation loss decreased (-0.644726 --> -0.657884).  Saving model ...
Epoch: 10 cost time: 1.9823329448699951
Epoch: 10, Steps: 10 | Train Loss: 0.798 Vali Loss: 0.990 Vali Acc: 0.632 Test Loss: 0.990 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0842297077178955
Epoch: 11, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.956 Vali Acc: 0.678 Test Loss: 0.956 Test Acc: 0.678
Validation loss decreased (-0.657884 --> -0.677622).  Saving model ...
Epoch: 12 cost time: 2.1910293102264404
Epoch: 12, Steps: 10 | Train Loss: 0.705 Vali Loss: 0.922 Vali Acc: 0.671 Test Loss: 0.922 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.367255210876465
Epoch: 13, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.893 Vali Acc: 0.684 Test Loss: 0.893 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684202).  Saving model ...
Epoch: 14 cost time: 2.1589040756225586
Epoch: 14, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.862 Vali Acc: 0.697 Test Loss: 0.862 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697360).  Saving model ...
Epoch: 15 cost time: 2.338332176208496
Epoch: 15, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.835 Vali Acc: 0.684 Test Loss: 0.835 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2964229583740234
Epoch: 16, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.810 Vali Acc: 0.691 Test Loss: 0.810 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.124931812286377
Epoch: 17, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.784 Vali Acc: 0.717 Test Loss: 0.784 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717097).  Saving model ...
Epoch: 18 cost time: 2.225757122039795
Epoch: 18, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.753 Vali Acc: 0.730 Test Loss: 0.753 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 19 cost time: 2.0697989463806152
Epoch: 19, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.726 Vali Acc: 0.757 Test Loss: 0.726 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756572).  Saving model ...
Epoch: 20 cost time: 2.255092144012451
Epoch: 20, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.702 Vali Acc: 0.763 Test Loss: 0.702 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 21 cost time: 1.9981780052185059
Epoch: 21, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.682 Vali Acc: 0.770 Test Loss: 0.682 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 22 cost time: 2.343996524810791
Epoch: 22, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.663 Vali Acc: 0.763 Test Loss: 0.663 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2387752532958984
Epoch: 23, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 24 cost time: 2.476884126663208
Epoch: 24, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 25 cost time: 2.202411651611328
Epoch: 25, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 26 cost time: 2.049450397491455
Epoch: 26, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2377264499664307
Epoch: 27, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.405662775039673
Epoch: 28, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 29 cost time: 2.1340343952178955
Epoch: 29, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 2.1706385612487793
Epoch: 30, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 31 cost time: 2.439067840576172
Epoch: 31, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 32 cost time: 2.033555746078491
Epoch: 32, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.307164430618286
Epoch: 33, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.444770336151123
Epoch: 34, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.412273406982422
Epoch: 35, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.554 Vali Acc: 0.803 Test Loss: 0.554 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.4997050762176514
Epoch: 36, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.3572516441345215
Epoch: 37, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.367018938064575
Epoch: 38, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.4449331760406494
Epoch: 39, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.251291036605835
Epoch: 40, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.160223960876465
Epoch: 41, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 128100
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5662729740142822
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.426 Vali Acc: 0.217 Test Loss: 1.426 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 2.2584123611450195
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.394 Vali Acc: 0.289 Test Loss: 1.394 Test Acc: 0.289
Validation loss decreased (-0.217091 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 2.0897393226623535
Epoch: 3, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.355 Vali Acc: 0.303 Test Loss: 1.355 Test Acc: 0.303
Validation loss decreased (-0.289460 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 2.099369525909424
Epoch: 4, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.314 Vali Acc: 0.375 Test Loss: 1.314 Test Acc: 0.375
Validation loss decreased (-0.302618 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 2.0478322505950928
Epoch: 5, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.274 Vali Acc: 0.408 Test Loss: 1.274 Test Acc: 0.408
Validation loss decreased (-0.374987 --> -0.407882).  Saving model ...
Epoch: 6 cost time: 2.1822714805603027
Epoch: 6, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.234 Vali Acc: 0.474 Test Loss: 1.234 Test Acc: 0.474
Validation loss decreased (-0.407882 --> -0.473672).  Saving model ...
Epoch: 7 cost time: 1.8346564769744873
Epoch: 7, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.194 Vali Acc: 0.507 Test Loss: 1.194 Test Acc: 0.507
Validation loss decreased (-0.473672 --> -0.506567).  Saving model ...
Epoch: 8 cost time: 1.9981276988983154
Epoch: 8, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0942776203155518
Epoch: 9, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.119 Vali Acc: 0.553 Test Loss: 1.119 Test Acc: 0.553
Validation loss decreased (-0.506567 --> -0.552620).  Saving model ...
Epoch: 10 cost time: 2.003676414489746
Epoch: 10, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.083 Vali Acc: 0.579 Test Loss: 1.083 Test Acc: 0.579
Validation loss decreased (-0.552620 --> -0.578937).  Saving model ...
Epoch: 11 cost time: 2.0632381439208984
Epoch: 11, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.047 Vali Acc: 0.625 Test Loss: 1.047 Test Acc: 0.625
Validation loss decreased (-0.578937 --> -0.624990).  Saving model ...
Epoch: 12 cost time: 2.043048620223999
Epoch: 12, Steps: 10 | Train Loss: 0.797 Vali Loss: 1.013 Vali Acc: 0.645 Test Loss: 1.013 Test Acc: 0.645
Validation loss decreased (-0.624990 --> -0.644727).  Saving model ...
Epoch: 13 cost time: 2.1910243034362793
Epoch: 13, Steps: 10 | Train Loss: 0.750 Vali Loss: 0.982 Vali Acc: 0.638 Test Loss: 0.982 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1734979152679443
Epoch: 14, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.948 Vali Acc: 0.664 Test Loss: 0.948 Test Acc: 0.664
Validation loss decreased (-0.644727 --> -0.664464).  Saving model ...
Epoch: 15 cost time: 2.2832725048065186
Epoch: 15, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.919 Vali Acc: 0.684 Test Loss: 0.919 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 16 cost time: 2.27048397064209
Epoch: 16, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.887 Vali Acc: 0.684 Test Loss: 0.887 Test Acc: 0.684
Validation loss decreased (-0.684201 --> -0.684202).  Saving model ...
Epoch: 17 cost time: 2.1162853240966797
Epoch: 17, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.851 Vali Acc: 0.684 Test Loss: 0.851 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684202).  Saving model ...
Epoch: 18 cost time: 2.278815269470215
Epoch: 18, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.816 Vali Acc: 0.678 Test Loss: 0.816 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.052103042602539
Epoch: 19, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.781 Vali Acc: 0.697 Test Loss: 0.781 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697361).  Saving model ...
Epoch: 20 cost time: 2.0070276260375977
Epoch: 20, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.750 Vali Acc: 0.717 Test Loss: 0.750 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 21 cost time: 2.0285861492156982
Epoch: 21, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.721 Vali Acc: 0.711 Test Loss: 0.721 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0486512184143066
Epoch: 22, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.698 Vali Acc: 0.717 Test Loss: 0.698 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717098).  Saving model ...
Epoch: 23 cost time: 2.112177610397339
Epoch: 23, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.667 Vali Acc: 0.711 Test Loss: 0.667 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9109530448913574
Epoch: 24, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.642 Vali Acc: 0.730 Test Loss: 0.642 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 25 cost time: 2.167512893676758
Epoch: 25, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.617 Vali Acc: 0.737 Test Loss: 0.617 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 26 cost time: 2.302804470062256
Epoch: 26, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 27 cost time: 2.1966898441314697
Epoch: 27, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.577 Vali Acc: 0.743 Test Loss: 0.577 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 28 cost time: 2.3479690551757812
Epoch: 28, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.563 Vali Acc: 0.750 Test Loss: 0.563 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 29 cost time: 2.3301069736480713
Epoch: 29, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.546 Vali Acc: 0.757 Test Loss: 0.546 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 30 cost time: 2.2662534713745117
Epoch: 30, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.536 Vali Acc: 0.757 Test Loss: 0.536 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 31 cost time: 2.051992177963257
Epoch: 31, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.527 Vali Acc: 0.763 Test Loss: 0.527 Test Acc: 0.763
Validation loss decreased (-0.756574 --> -0.763153).  Saving model ...
Epoch: 32 cost time: 1.9813013076782227
Epoch: 32, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.526 Vali Acc: 0.763 Test Loss: 0.526 Test Acc: 0.763
Validation loss decreased (-0.763153 --> -0.763153).  Saving model ...
Epoch: 33 cost time: 2.148756742477417
Epoch: 33, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776311).  Saving model ...
Epoch: 34 cost time: 1.965822696685791
Epoch: 34, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.527 Vali Acc: 0.763 Test Loss: 0.527 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.1250624656677246
Epoch: 35, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.530 Vali Acc: 0.770 Test Loss: 0.530 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.034151315689087
Epoch: 36, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.529 Vali Acc: 0.776 Test Loss: 0.529 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.0683016777038574
Epoch: 37, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789468).  Saving model ...
Epoch: 38 cost time: 2.247919797897339
Epoch: 38, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.2523341178894043
Epoch: 39, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.3258471488952637
Epoch: 40, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.1743621826171875
Epoch: 41, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.517 Vali Acc: 0.776 Test Loss: 0.517 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.249533176422119
Epoch: 42, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.1697020530700684
Epoch: 43, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.1113152503967285
Epoch: 44, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.066786766052246
Epoch: 45, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.18923020362854
Epoch: 46, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.0038301944732666
Epoch: 47, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 128100
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.140433311462402
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.438 Vali Acc: 0.230 Test Loss: 1.438 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 2.1542043685913086
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.421 Vali Acc: 0.243 Test Loss: 1.421 Test Acc: 0.243
Validation loss decreased (-0.230249 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 2.140291690826416
Epoch: 3, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.399 Vali Acc: 0.283 Test Loss: 1.399 Test Acc: 0.283
Validation loss decreased (-0.243407 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 2.2411611080169678
Epoch: 4, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.374 Vali Acc: 0.283 Test Loss: 1.374 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 1.9752261638641357
Epoch: 5, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.348 Vali Acc: 0.303 Test Loss: 1.348 Test Acc: 0.303
Validation loss decreased (-0.282881 --> -0.302618).  Saving model ...
Epoch: 6 cost time: 2.147916793823242
Epoch: 6, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.322 Vali Acc: 0.316 Test Loss: 1.322 Test Acc: 0.316
Validation loss decreased (-0.302618 --> -0.315776).  Saving model ...
Epoch: 7 cost time: 2.048017978668213
Epoch: 7, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.296 Vali Acc: 0.375 Test Loss: 1.296 Test Acc: 0.375
Validation loss decreased (-0.315776 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 2.114171266555786
Epoch: 8, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.266 Vali Acc: 0.388 Test Loss: 1.266 Test Acc: 0.388
Validation loss decreased (-0.374987 --> -0.388145).  Saving model ...
Epoch: 9 cost time: 2.0053367614746094
Epoch: 9, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.240 Vali Acc: 0.408 Test Loss: 1.240 Test Acc: 0.408
Validation loss decreased (-0.388145 --> -0.407882).  Saving model ...
Epoch: 10 cost time: 2.00264310836792
Epoch: 10, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.210 Vali Acc: 0.447 Test Loss: 1.210 Test Acc: 0.447
Validation loss decreased (-0.407882 --> -0.447356).  Saving model ...
Epoch: 11 cost time: 2.0528347492218018
Epoch: 11, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.179 Vali Acc: 0.480 Test Loss: 1.179 Test Acc: 0.480
Validation loss decreased (-0.447356 --> -0.480251).  Saving model ...
Epoch: 12 cost time: 2.1502766609191895
Epoch: 12, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
Validation loss decreased (-0.480251 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 2.19073748588562
Epoch: 13, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.121 Vali Acc: 0.507 Test Loss: 1.121 Test Acc: 0.507
Validation loss decreased (-0.499989 --> -0.506568).  Saving model ...
Epoch: 14 cost time: 2.1498632431030273
Epoch: 14, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
Validation loss decreased (-0.506568 --> -0.532884).  Saving model ...
Epoch: 15 cost time: 2.165642023086548
Epoch: 15, Steps: 10 | Train Loss: 0.746 Vali Loss: 1.053 Vali Acc: 0.566 Test Loss: 1.053 Test Acc: 0.566
Validation loss decreased (-0.532884 --> -0.565779).  Saving model ...
Epoch: 16 cost time: 2.3780574798583984
Epoch: 16, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.014 Vali Acc: 0.579 Test Loss: 1.014 Test Acc: 0.579
Validation loss decreased (-0.565779 --> -0.578937).  Saving model ...
Epoch: 17 cost time: 2.247792959213257
Epoch: 17, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.978 Vali Acc: 0.599 Test Loss: 0.978 Test Acc: 0.599
Validation loss decreased (-0.578937 --> -0.598674).  Saving model ...
Epoch: 18 cost time: 2.094688653945923
Epoch: 18, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.941 Vali Acc: 0.605 Test Loss: 0.941 Test Acc: 0.605
Validation loss decreased (-0.598674 --> -0.605254).  Saving model ...
Epoch: 19 cost time: 2.0921902656555176
Epoch: 19, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.898 Vali Acc: 0.605 Test Loss: 0.898 Test Acc: 0.605
Validation loss decreased (-0.605254 --> -0.605254).  Saving model ...
Epoch: 20 cost time: 2.110733985900879
Epoch: 20, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.863 Vali Acc: 0.638 Test Loss: 0.863 Test Acc: 0.638
Validation loss decreased (-0.605254 --> -0.638149).  Saving model ...
Epoch: 21 cost time: 1.9442639350891113
Epoch: 21, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.826 Vali Acc: 0.664 Test Loss: 0.826 Test Acc: 0.664
Validation loss decreased (-0.638149 --> -0.664465).  Saving model ...
Epoch: 22 cost time: 2.117804527282715
Epoch: 22, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.794 Vali Acc: 0.671 Test Loss: 0.794 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671045).  Saving model ...
Epoch: 23 cost time: 2.038731336593628
Epoch: 23, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.764 Vali Acc: 0.664 Test Loss: 0.764 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.244699478149414
Epoch: 24, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.737 Vali Acc: 0.671 Test Loss: 0.737 Test Acc: 0.671
Validation loss decreased (-0.671045 --> -0.671045).  Saving model ...
Epoch: 25 cost time: 2.242969512939453
Epoch: 25, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.712 Vali Acc: 0.691 Test Loss: 0.712 Test Acc: 0.691
Validation loss decreased (-0.671045 --> -0.690782).  Saving model ...
Epoch: 26 cost time: 2.321624755859375
Epoch: 26, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.682 Vali Acc: 0.697 Test Loss: 0.682 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697362).  Saving model ...
Epoch: 27 cost time: 2.1151630878448486
Epoch: 27, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.658 Vali Acc: 0.704 Test Loss: 0.658 Test Acc: 0.704
Validation loss decreased (-0.697362 --> -0.703941).  Saving model ...
Epoch: 28 cost time: 2.193894147872925
Epoch: 28, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.634 Vali Acc: 0.717 Test Loss: 0.634 Test Acc: 0.717
Validation loss decreased (-0.703941 --> -0.717099).  Saving model ...
Epoch: 29 cost time: 2.2352144718170166
Epoch: 29, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.614 Vali Acc: 0.743 Test Loss: 0.614 Test Acc: 0.743
Validation loss decreased (-0.717099 --> -0.743415).  Saving model ...
Epoch: 30 cost time: 1.8849639892578125
Epoch: 30, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0679128170013428
Epoch: 31, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.594 Vali Acc: 0.737 Test Loss: 0.594 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8666400909423828
Epoch: 32, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.590 Vali Acc: 0.730 Test Loss: 0.590 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.054330348968506
Epoch: 33, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.1019725799560547
Epoch: 34, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.583 Vali Acc: 0.730 Test Loss: 0.583 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.026383399963379
Epoch: 35, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.583 Vali Acc: 0.757 Test Loss: 0.583 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 36 cost time: 2.169884443283081
Epoch: 36, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.580 Vali Acc: 0.743 Test Loss: 0.580 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.0785889625549316
Epoch: 37, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.567 Vali Acc: 0.750 Test Loss: 0.567 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.382181406021118
Epoch: 38, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 39 cost time: 2.229527473449707
Epoch: 39, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 40 cost time: 2.1588706970214844
Epoch: 40, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 41 cost time: 2.34298038482666
Epoch: 41, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.0206549167633057
Epoch: 42, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.569 Vali Acc: 0.763 Test Loss: 0.569 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.070828914642334
Epoch: 43, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 44 cost time: 2.001589775085449
Epoch: 44, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.023921012878418
Epoch: 45, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.580 Vali Acc: 0.770 Test Loss: 0.580 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.1768081188201904
Epoch: 46, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.0169663429260254
Epoch: 47, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.580 Vali Acc: 0.776 Test Loss: 0.580 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.1467649936676025
Epoch: 48, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.284843683242798
Epoch: 49, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.963918685913086
Epoch: 50, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 51 cost time: 2.217423439025879
Epoch: 51, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.020223617553711
Epoch: 52, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.023547649383545
Epoch: 53, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.054593086242676
Epoch: 54, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.588 Vali Acc: 0.796 Test Loss: 0.588 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.9645302295684814
Epoch: 55, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.590 Vali Acc: 0.796 Test Loss: 0.590 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.220823287963867
Epoch: 56, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.28078293800354
Epoch: 57, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.603 Vali Acc: 0.796 Test Loss: 0.603 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.1571414470672607
Epoch: 58, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.607 Vali Acc: 0.796 Test Loss: 0.607 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 2.3286688327789307
Epoch: 59, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 2.2417209148406982
Epoch: 60, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.604 Vali Acc: 0.789 Test Loss: 0.604 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 128100
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8594789505004883
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.475 Vali Acc: 0.230 Test Loss: 1.475 Test Acc: 0.230
Validation loss decreased (inf --> -0.230248).  Saving model ...
Epoch: 2 cost time: 2.0561439990997314
Epoch: 2, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.464 Vali Acc: 0.230 Test Loss: 1.464 Test Acc: 0.230
Validation loss decreased (-0.230248 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 2.410917282104492
Epoch: 3, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.451 Vali Acc: 0.250 Test Loss: 1.451 Test Acc: 0.250
Validation loss decreased (-0.230249 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 2.2640540599823
Epoch: 4, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.438 Vali Acc: 0.250 Test Loss: 1.438 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 2.357832670211792
Epoch: 5, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.423 Vali Acc: 0.250 Test Loss: 1.423 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 2.067478895187378
Epoch: 6, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.407 Vali Acc: 0.250 Test Loss: 1.407 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 2.2438344955444336
Epoch: 7, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.249986 --> -0.263144).  Saving model ...
Epoch: 8 cost time: 2.133281946182251
Epoch: 8, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.364 Vali Acc: 0.276 Test Loss: 1.364 Test Acc: 0.276
Validation loss decreased (-0.263144 --> -0.276302).  Saving model ...
Epoch: 9 cost time: 2.186396360397339
Epoch: 9, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.344 Vali Acc: 0.270 Test Loss: 1.344 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.155139684677124
Epoch: 10, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.317 Vali Acc: 0.355 Test Loss: 1.317 Test Acc: 0.355
Validation loss decreased (-0.276302 --> -0.355250).  Saving model ...
Epoch: 11 cost time: 2.3095881938934326
Epoch: 11, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.289 Vali Acc: 0.382 Test Loss: 1.289 Test Acc: 0.382
Validation loss decreased (-0.355250 --> -0.381566).  Saving model ...
Epoch: 12 cost time: 2.1436190605163574
Epoch: 12, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.255 Vali Acc: 0.401 Test Loss: 1.255 Test Acc: 0.401
Validation loss decreased (-0.381566 --> -0.401303).  Saving model ...
Epoch: 13 cost time: 2.014033079147339
Epoch: 13, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.217 Vali Acc: 0.447 Test Loss: 1.217 Test Acc: 0.447
Validation loss decreased (-0.401303 --> -0.447356).  Saving model ...
Epoch: 14 cost time: 2.1468019485473633
Epoch: 14, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.175 Vali Acc: 0.487 Test Loss: 1.175 Test Acc: 0.487
Validation loss decreased (-0.447356 --> -0.486830).  Saving model ...
Epoch: 15 cost time: 2.4631271362304688
Epoch: 15, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.129 Vali Acc: 0.493 Test Loss: 1.129 Test Acc: 0.493
Validation loss decreased (-0.486830 --> -0.493410).  Saving model ...
Epoch: 16 cost time: 2.389150619506836
Epoch: 16, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.078 Vali Acc: 0.539 Test Loss: 1.078 Test Acc: 0.539
Validation loss decreased (-0.493410 --> -0.539463).  Saving model ...
Epoch: 17 cost time: 2.559373617172241
Epoch: 17, Steps: 10 | Train Loss: 0.834 Vali Loss: 1.020 Vali Acc: 0.572 Test Loss: 1.020 Test Acc: 0.572
Validation loss decreased (-0.539463 --> -0.572358).  Saving model ...
Epoch: 18 cost time: 2.4607508182525635
Epoch: 18, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.963 Vali Acc: 0.586 Test Loss: 0.963 Test Acc: 0.586
Validation loss decreased (-0.572358 --> -0.585517).  Saving model ...
Epoch: 19 cost time: 2.378787040710449
Epoch: 19, Steps: 10 | Train Loss: 0.651 Vali Loss: 0.900 Vali Acc: 0.632 Test Loss: 0.900 Test Acc: 0.632
Validation loss decreased (-0.585517 --> -0.631570).  Saving model ...
Epoch: 20 cost time: 2.242840051651001
Epoch: 20, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.850 Vali Acc: 0.638 Test Loss: 0.850 Test Acc: 0.638
Validation loss decreased (-0.631570 --> -0.638149).  Saving model ...
Epoch: 21 cost time: 2.269050359725952
Epoch: 21, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.795 Vali Acc: 0.664 Test Loss: 0.795 Test Acc: 0.664
Validation loss decreased (-0.638149 --> -0.664466).  Saving model ...
Epoch: 22 cost time: 2.0704996585845947
Epoch: 22, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.753 Vali Acc: 0.697 Test Loss: 0.753 Test Acc: 0.697
Validation loss decreased (-0.664466 --> -0.697361).  Saving model ...
Epoch: 23 cost time: 2.1461575031280518
Epoch: 23, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.711 Vali Acc: 0.704 Test Loss: 0.711 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 24 cost time: 2.137967109680176
Epoch: 24, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.679 Vali Acc: 0.717 Test Loss: 0.679 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 25 cost time: 2.2629506587982178
Epoch: 25, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.649 Vali Acc: 0.730 Test Loss: 0.649 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 26 cost time: 2.3627805709838867
Epoch: 26, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.628 Vali Acc: 0.737 Test Loss: 0.628 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 27 cost time: 2.34999418258667
Epoch: 27, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 28 cost time: 2.4386587142944336
Epoch: 28, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.582 Vali Acc: 0.730 Test Loss: 0.582 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.418243169784546
Epoch: 29, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.566 Vali Acc: 0.743 Test Loss: 0.566 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 30 cost time: 2.181396722793579
Epoch: 30, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.559 Vali Acc: 0.743 Test Loss: 0.559 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 31 cost time: 2.375828981399536
Epoch: 31, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.556 Vali Acc: 0.743 Test Loss: 0.556 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 32 cost time: 2.1498947143554688
Epoch: 32, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.558 Vali Acc: 0.750 Test Loss: 0.558 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 33 cost time: 2.2341578006744385
Epoch: 33, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.556 Vali Acc: 0.750 Test Loss: 0.556 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 34 cost time: 2.3009185791015625
Epoch: 34, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.551 Vali Acc: 0.757 Test Loss: 0.551 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 35 cost time: 2.319760322570801
Epoch: 35, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.563 Vali Acc: 0.757 Test Loss: 0.563 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.42828106880188
Epoch: 36, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 37 cost time: 2.440617322921753
Epoch: 37, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.555 Vali Acc: 0.750 Test Loss: 0.555 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.557417154312134
Epoch: 38, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.557 Vali Acc: 0.743 Test Loss: 0.557 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.3737592697143555
Epoch: 39, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.566 Vali Acc: 0.743 Test Loss: 0.566 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.0553972721099854
Epoch: 40, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.567 Vali Acc: 0.750 Test Loss: 0.567 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.227112054824829
Epoch: 41, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.561 Vali Acc: 0.770 Test Loss: 0.561 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 42 cost time: 2.006887674331665
Epoch: 42, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.564 Vali Acc: 0.770 Test Loss: 0.564 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.9679419994354248
Epoch: 43, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.2211966514587402
Epoch: 44, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.4102678298950195
Epoch: 45, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.581 Vali Acc: 0.763 Test Loss: 0.581 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.349001169204712
Epoch: 46, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.586 Vali Acc: 0.763 Test Loss: 0.586 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.4572954177856445
Epoch: 47, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.599 Vali Acc: 0.770 Test Loss: 0.599 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.414193868637085
Epoch: 48, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.602 Vali Acc: 0.770 Test Loss: 0.602 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.142399311065674
Epoch: 49, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.610 Vali Acc: 0.763 Test Loss: 0.610 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.2017600536346436
Epoch: 50, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.618 Vali Acc: 0.763 Test Loss: 0.618 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.012739658355713
Epoch: 51, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.632 Vali Acc: 0.763 Test Loss: 0.632 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 128100
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.036967039108276
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.432 Vali Acc: 0.263 Test Loss: 1.432 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.2917873859405518
Epoch: 2, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.418 Vali Acc: 0.270 Test Loss: 1.418 Test Acc: 0.270
Validation loss decreased (-0.263144 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 2.1244161128997803
Epoch: 3, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.402 Vali Acc: 0.263 Test Loss: 1.402 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0972492694854736
Epoch: 4, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.385 Vali Acc: 0.276 Test Loss: 1.385 Test Acc: 0.276
Validation loss decreased (-0.269723 --> -0.276302).  Saving model ...
Epoch: 5 cost time: 1.9985382556915283
Epoch: 5, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.365 Vali Acc: 0.276 Test Loss: 1.365 Test Acc: 0.276
Validation loss decreased (-0.276302 --> -0.276302).  Saving model ...
Epoch: 6 cost time: 2.0503573417663574
Epoch: 6, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.345 Vali Acc: 0.276 Test Loss: 1.345 Test Acc: 0.276
Validation loss decreased (-0.276302 --> -0.276302).  Saving model ...
Epoch: 7 cost time: 2.1047399044036865
Epoch: 7, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.322 Vali Acc: 0.322 Test Loss: 1.322 Test Acc: 0.322
Validation loss decreased (-0.276302 --> -0.322355).  Saving model ...
Epoch: 8 cost time: 2.102792263031006
Epoch: 8, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.296 Vali Acc: 0.322 Test Loss: 1.296 Test Acc: 0.322
Validation loss decreased (-0.322355 --> -0.322355).  Saving model ...
Epoch: 9 cost time: 2.1588172912597656
Epoch: 9, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.271 Vali Acc: 0.329 Test Loss: 1.271 Test Acc: 0.329
Validation loss decreased (-0.322355 --> -0.328935).  Saving model ...
Epoch: 10 cost time: 2.1246094703674316
Epoch: 10, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.244 Vali Acc: 0.362 Test Loss: 1.244 Test Acc: 0.362
Validation loss decreased (-0.328935 --> -0.361830).  Saving model ...
Epoch: 11 cost time: 2.0891454219818115
Epoch: 11, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.214 Vali Acc: 0.401 Test Loss: 1.214 Test Acc: 0.401
Validation loss decreased (-0.361830 --> -0.401304).  Saving model ...
Epoch: 12 cost time: 2.0588908195495605
Epoch: 12, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.180 Vali Acc: 0.447 Test Loss: 1.180 Test Acc: 0.447
Validation loss decreased (-0.401304 --> -0.447357).  Saving model ...
Epoch: 13 cost time: 2.2495768070220947
Epoch: 13, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.146 Vali Acc: 0.474 Test Loss: 1.146 Test Acc: 0.474
Validation loss decreased (-0.447357 --> -0.473673).  Saving model ...
Epoch: 14 cost time: 1.9974853992462158
Epoch: 14, Steps: 10 | Train Loss: 0.944 Vali Loss: 1.114 Vali Acc: 0.507 Test Loss: 1.114 Test Acc: 0.507
Validation loss decreased (-0.473673 --> -0.506568).  Saving model ...
Epoch: 15 cost time: 1.8436613082885742
Epoch: 15, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.506568 --> -0.532884).  Saving model ...
Epoch: 16 cost time: 1.9053833484649658
Epoch: 16, Steps: 10 | Train Loss: 0.804 Vali Loss: 1.036 Vali Acc: 0.520 Test Loss: 1.036 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9234533309936523
Epoch: 17, Steps: 10 | Train Loss: 0.754 Vali Loss: 0.999 Vali Acc: 0.546 Test Loss: 0.999 Test Acc: 0.546
Validation loss decreased (-0.532884 --> -0.546043).  Saving model ...
Epoch: 18 cost time: 1.90384840965271
Epoch: 18, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.959 Vali Acc: 0.559 Test Loss: 0.959 Test Acc: 0.559
Validation loss decreased (-0.546043 --> -0.559201).  Saving model ...
Epoch: 19 cost time: 2.370877981185913
Epoch: 19, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.916 Vali Acc: 0.586 Test Loss: 0.916 Test Acc: 0.586
Validation loss decreased (-0.559201 --> -0.585517).  Saving model ...
Epoch: 20 cost time: 2.1141886711120605
Epoch: 20, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.877 Vali Acc: 0.599 Test Loss: 0.877 Test Acc: 0.599
Validation loss decreased (-0.585517 --> -0.598675).  Saving model ...
Epoch: 21 cost time: 2.1448850631713867
Epoch: 21, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.839 Vali Acc: 0.638 Test Loss: 0.839 Test Acc: 0.638
Validation loss decreased (-0.598675 --> -0.638150).  Saving model ...
Epoch: 22 cost time: 2.1625611782073975
Epoch: 22, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.807 Vali Acc: 0.651 Test Loss: 0.807 Test Acc: 0.651
Validation loss decreased (-0.638150 --> -0.651308).  Saving model ...
Epoch: 23 cost time: 2.1567842960357666
Epoch: 23, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.772 Vali Acc: 0.684 Test Loss: 0.772 Test Acc: 0.684
Validation loss decreased (-0.651308 --> -0.684203).  Saving model ...
Epoch: 24 cost time: 2.1596310138702393
Epoch: 24, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.746 Vali Acc: 0.684 Test Loss: 0.746 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684203).  Saving model ...
Epoch: 25 cost time: 2.044947624206543
Epoch: 25, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.721 Vali Acc: 0.697 Test Loss: 0.721 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 26 cost time: 2.021286725997925
Epoch: 26, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.700 Vali Acc: 0.684 Test Loss: 0.700 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9047214984893799
Epoch: 27, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.679 Vali Acc: 0.704 Test Loss: 0.679 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703941).  Saving model ...
Epoch: 28 cost time: 2.1370558738708496
Epoch: 28, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.658 Vali Acc: 0.697 Test Loss: 0.658 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.138251304626465
Epoch: 29, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.644 Vali Acc: 0.711 Test Loss: 0.644 Test Acc: 0.711
Validation loss decreased (-0.703941 --> -0.710520).  Saving model ...
Epoch: 30 cost time: 2.100437641143799
Epoch: 30, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.633 Vali Acc: 0.711 Test Loss: 0.633 Test Acc: 0.711
Validation loss decreased (-0.710520 --> -0.710520).  Saving model ...
Epoch: 31 cost time: 2.0982115268707275
Epoch: 31, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.622 Vali Acc: 0.730 Test Loss: 0.622 Test Acc: 0.730
Validation loss decreased (-0.710520 --> -0.730257).  Saving model ...
Epoch: 32 cost time: 2.1361637115478516
Epoch: 32, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.615 Vali Acc: 0.730 Test Loss: 0.615 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 33 cost time: 2.2172653675079346
Epoch: 33, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.610 Vali Acc: 0.730 Test Loss: 0.610 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 34 cost time: 2.2857022285461426
Epoch: 34, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.599 Vali Acc: 0.724 Test Loss: 0.599 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9819509983062744
Epoch: 35, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.596 Vali Acc: 0.743 Test Loss: 0.596 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 36 cost time: 2.013132333755493
Epoch: 36, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.597 Vali Acc: 0.757 Test Loss: 0.597 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 37 cost time: 1.9054231643676758
Epoch: 37, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.597 Vali Acc: 0.770 Test Loss: 0.597 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 38 cost time: 2.094050884246826
Epoch: 38, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.595 Vali Acc: 0.763 Test Loss: 0.595 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.046356201171875
Epoch: 39, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.594 Vali Acc: 0.763 Test Loss: 0.594 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.051098108291626
Epoch: 40, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.590 Vali Acc: 0.757 Test Loss: 0.590 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.133991003036499
Epoch: 41, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.304054021835327
Epoch: 42, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.2192747592926025
Epoch: 43, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.600 Vali Acc: 0.763 Test Loss: 0.600 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.2292847633361816
Epoch: 44, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.600 Vali Acc: 0.757 Test Loss: 0.600 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.2370142936706543
Epoch: 45, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.264526844024658
Epoch: 46, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.0925371646881104
Epoch: 47, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.612 Vali Acc: 0.770 Test Loss: 0.612 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 128100
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.002575874328613
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.189457654953003
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 2.277456521987915
Epoch: 3, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 2.01739764213562
Epoch: 4, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 5 cost time: 2.181752920150757
Epoch: 5, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 6 cost time: 2.1915578842163086
Epoch: 6, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 7 cost time: 2.1229543685913086
Epoch: 7, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 8 cost time: 1.9337267875671387
Epoch: 8, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 9 cost time: 2.065546751022339
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 10 cost time: 2.071197032928467
Epoch: 10, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 11 cost time: 1.9425458908081055
Epoch: 11, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 12 cost time: 2.270448923110962
Epoch: 12, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 13 cost time: 2.3394641876220703
Epoch: 13, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1993227005004883
Epoch: 14, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.264129877090454
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 16 cost time: 2.46658992767334
Epoch: 16, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 17 cost time: 2.458162307739258
Epoch: 17, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 18 cost time: 2.2201077938079834
Epoch: 18, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2283213138580322
Epoch: 19, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (-0.263144 --> -0.263144).  Saving model ...
Epoch: 20 cost time: 2.379312038421631
Epoch: 20, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.263144 --> -0.282881).  Saving model ...
Epoch: 21 cost time: 2.2705729007720947
Epoch: 21, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.18705415725708
Epoch: 22, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 2.4894354343414307
Epoch: 23, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 2.1915996074676514
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 25 cost time: 2.1420834064483643
Epoch: 25, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 2.1880135536193848
Epoch: 26, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.2204177379608154
Epoch: 27, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 1.925227165222168
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.0551156997680664
Epoch: 29, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1685097217559814
Epoch: 30, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1008212566375732
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.0512211322784424
Epoch: 32, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.200676679611206
Epoch: 33, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.207200765609741
Epoch: 34, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.204326868057251
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 2.2610268592834473
Epoch: 36, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.342834949493408
Epoch: 37, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.443249225616455
Epoch: 38, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.270034074783325
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.132178783416748
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 2.161546468734741
Epoch: 41, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.1354141235351562
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 2.1611990928649902
Epoch: 43, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.068715810775757
Epoch: 44, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.082289457321167
Epoch: 45, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.0760037899017334
Epoch: 46, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 2.4678502082824707
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.2721760272979736
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.2184953689575195
Epoch: 49, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.275939702987671
Epoch: 50, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.2519266605377197
Epoch: 51, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 52 cost time: 2.188842535018921
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.0320560932159424
Epoch: 53, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 2.0655934810638428
Epoch: 54, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 55 cost time: 2.1338112354278564
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.194521188735962
Epoch: 56, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.4068894386291504
Epoch: 57, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.2024388313293457
Epoch: 58, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.0787127017974854
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 60 cost time: 2.1619722843170166
Epoch: 60, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 61 cost time: 2.067702293395996
Epoch: 61, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 62 cost time: 2.2975339889526367
Epoch: 62, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.230530023574829
Epoch: 63, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.086519241333008
Epoch: 64, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.2700178623199463
Epoch: 65, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 2.2978944778442383
Epoch: 66, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 2.1877548694610596
Epoch: 67, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 2.3534016609191895
Epoch: 68, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 2.217593193054199
Epoch: 69, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 2.33015775680542
Epoch: 70, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 2.1043336391448975
Epoch: 71, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 128100
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.094095468521118
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.431 Vali Acc: 0.283 Test Loss: 1.431 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 2.0520567893981934
Epoch: 2, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.389 Vali Acc: 0.296 Test Loss: 1.389 Test Acc: 0.296
Validation loss decreased (-0.282880 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 2.1371467113494873
Epoch: 3, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.333 Vali Acc: 0.368 Test Loss: 1.333 Test Acc: 0.368
Validation loss decreased (-0.296039 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 2.111814022064209
Epoch: 4, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.278 Vali Acc: 0.474 Test Loss: 1.278 Test Acc: 0.474
Validation loss decreased (-0.368408 --> -0.473671).  Saving model ...
Epoch: 5 cost time: 1.988523006439209
Epoch: 5, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.221 Vali Acc: 0.566 Test Loss: 1.221 Test Acc: 0.566
Validation loss decreased (-0.473671 --> -0.565777).  Saving model ...
Epoch: 6 cost time: 2.009366273880005
Epoch: 6, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.167 Vali Acc: 0.572 Test Loss: 1.167 Test Acc: 0.572
Validation loss decreased (-0.565777 --> -0.572357).  Saving model ...
Epoch: 7 cost time: 2.0494883060455322
Epoch: 7, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.112 Vali Acc: 0.572 Test Loss: 1.112 Test Acc: 0.572
Validation loss decreased (-0.572357 --> -0.572357).  Saving model ...
Epoch: 8 cost time: 2.0256664752960205
Epoch: 8, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.065 Vali Acc: 0.599 Test Loss: 1.065 Test Acc: 0.599
Validation loss decreased (-0.572357 --> -0.598674).  Saving model ...
Epoch: 9 cost time: 2.1673717498779297
Epoch: 9, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.022 Vali Acc: 0.638 Test Loss: 1.022 Test Acc: 0.638
Validation loss decreased (-0.598674 --> -0.638148).  Saving model ...
Epoch: 10 cost time: 2.2211155891418457
Epoch: 10, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.982 Vali Acc: 0.651 Test Loss: 0.982 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 2.158892869949341
Epoch: 11, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.948 Vali Acc: 0.664 Test Loss: 0.948 Test Acc: 0.664
Validation loss decreased (-0.651306 --> -0.664464).  Saving model ...
Epoch: 12 cost time: 2.140714168548584
Epoch: 12, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.920 Vali Acc: 0.684 Test Loss: 0.920 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 13 cost time: 1.9384922981262207
Epoch: 13, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.895 Vali Acc: 0.678 Test Loss: 0.895 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.973785638809204
Epoch: 14, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.866 Vali Acc: 0.704 Test Loss: 0.866 Test Acc: 0.704
Validation loss decreased (-0.684201 --> -0.703939).  Saving model ...
Epoch: 15 cost time: 2.1550018787384033
Epoch: 15, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.842 Vali Acc: 0.704 Test Loss: 0.842 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703939).  Saving model ...
Epoch: 16 cost time: 2.210115432739258
Epoch: 16, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.820 Vali Acc: 0.697 Test Loss: 0.820 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3231494426727295
Epoch: 17, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.797 Vali Acc: 0.704 Test Loss: 0.797 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703939).  Saving model ...
Epoch: 18 cost time: 2.123476505279541
Epoch: 18, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.776 Vali Acc: 0.711 Test Loss: 0.776 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710519).  Saving model ...
Epoch: 19 cost time: 2.157571315765381
Epoch: 19, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.759 Vali Acc: 0.711 Test Loss: 0.759 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 20 cost time: 2.378283739089966
Epoch: 20, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.740 Vali Acc: 0.717 Test Loss: 0.740 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 21 cost time: 2.0342864990234375
Epoch: 21, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.725 Vali Acc: 0.724 Test Loss: 0.725 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 22 cost time: 1.9977564811706543
Epoch: 22, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.710 Vali Acc: 0.730 Test Loss: 0.710 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 23 cost time: 1.9315109252929688
Epoch: 23, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.695 Vali Acc: 0.737 Test Loss: 0.695 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 24 cost time: 2.0792932510375977
Epoch: 24, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.675 Vali Acc: 0.757 Test Loss: 0.675 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 25 cost time: 2.110381603240967
Epoch: 25, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.656 Vali Acc: 0.763 Test Loss: 0.656 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 26 cost time: 2.0642364025115967
Epoch: 26, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.642 Vali Acc: 0.763 Test Loss: 0.642 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 27 cost time: 2.0573294162750244
Epoch: 27, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782888).  Saving model ...
Epoch: 28 cost time: 2.0606822967529297
Epoch: 28, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.621 Vali Acc: 0.789 Test Loss: 0.621 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 29 cost time: 2.0591094493865967
Epoch: 29, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.615 Vali Acc: 0.789 Test Loss: 0.615 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 30 cost time: 2.040112257003784
Epoch: 30, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.617 Vali Acc: 0.796 Test Loss: 0.617 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 31 cost time: 1.8796906471252441
Epoch: 31, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 32 cost time: 2.0554275512695312
Epoch: 32, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 33 cost time: 2.001331329345703
Epoch: 33, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809204).  Saving model ...
Epoch: 34 cost time: 2.31624698638916
Epoch: 34, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 35 cost time: 2.293139934539795
Epoch: 35, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.605 Vali Acc: 0.816 Test Loss: 0.605 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.077916383743286
Epoch: 36, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.607 Vali Acc: 0.816 Test Loss: 0.607 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.171161413192749
Epoch: 37, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 38 cost time: 2.296597480773926
Epoch: 38, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.176077127456665
Epoch: 39, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.615 Vali Acc: 0.822 Test Loss: 0.615 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.239804983139038
Epoch: 40, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.615 Vali Acc: 0.822 Test Loss: 0.615 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.104499101638794
Epoch: 41, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.618 Vali Acc: 0.816 Test Loss: 0.618 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.120882987976074
Epoch: 42, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.625 Vali Acc: 0.816 Test Loss: 0.625 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.385694980621338
Epoch: 43, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.628 Vali Acc: 0.816 Test Loss: 0.628 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.2566466331481934
Epoch: 44, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.628 Vali Acc: 0.816 Test Loss: 0.628 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.2631309032440186
Epoch: 45, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.632 Vali Acc: 0.816 Test Loss: 0.632 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.238447666168213
Epoch: 46, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.631 Vali Acc: 0.816 Test Loss: 0.631 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.3649497032165527
Epoch: 47, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.635 Vali Acc: 0.816 Test Loss: 0.635 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 78948
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9272665977478027
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.405 Vali Acc: 0.309 Test Loss: 1.405 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 2.263613224029541
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.372 Vali Acc: 0.349 Test Loss: 1.372 Test Acc: 0.349
Validation loss decreased (-0.309196 --> -0.348670).  Saving model ...
Epoch: 3 cost time: 2.072313070297241
Epoch: 3, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.328 Vali Acc: 0.382 Test Loss: 1.328 Test Acc: 0.382
Validation loss decreased (-0.348670 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 2.1342532634735107
Epoch: 4, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.283 Vali Acc: 0.454 Test Loss: 1.283 Test Acc: 0.454
Validation loss decreased (-0.381566 --> -0.453935).  Saving model ...
Epoch: 5 cost time: 2.085752010345459
Epoch: 5, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.236 Vali Acc: 0.520 Test Loss: 1.236 Test Acc: 0.520
Validation loss decreased (-0.453935 --> -0.519724).  Saving model ...
Epoch: 6 cost time: 2.0935497283935547
Epoch: 6, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.190 Vali Acc: 0.533 Test Loss: 1.190 Test Acc: 0.533
Validation loss decreased (-0.519724 --> -0.532883).  Saving model ...
Epoch: 7 cost time: 1.991380214691162
Epoch: 7, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.145 Vali Acc: 0.579 Test Loss: 1.145 Test Acc: 0.579
Validation loss decreased (-0.532883 --> -0.578936).  Saving model ...
Epoch: 8 cost time: 1.9683804512023926
Epoch: 8, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.108 Vali Acc: 0.605 Test Loss: 1.108 Test Acc: 0.605
Validation loss decreased (-0.578936 --> -0.605252).  Saving model ...
Epoch: 9 cost time: 2.1098875999450684
Epoch: 9, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.072 Vali Acc: 0.618 Test Loss: 1.072 Test Acc: 0.618
Validation loss decreased (-0.605252 --> -0.618410).  Saving model ...
Epoch: 10 cost time: 2.277310371398926
Epoch: 10, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.038 Vali Acc: 0.612 Test Loss: 1.038 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2018861770629883
Epoch: 11, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.007 Vali Acc: 0.638 Test Loss: 1.007 Test Acc: 0.638
Validation loss decreased (-0.618410 --> -0.638148).  Saving model ...
Epoch: 12 cost time: 2.1895751953125
Epoch: 12, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.981 Vali Acc: 0.638 Test Loss: 0.981 Test Acc: 0.638
Validation loss decreased (-0.638148 --> -0.638148).  Saving model ...
Epoch: 13 cost time: 2.0999534130096436
Epoch: 13, Steps: 10 | Train Loss: 0.684 Vali Loss: 0.956 Vali Acc: 0.645 Test Loss: 0.956 Test Acc: 0.645
Validation loss decreased (-0.638148 --> -0.644727).  Saving model ...
Epoch: 14 cost time: 2.1983802318573
Epoch: 14, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.927 Vali Acc: 0.658 Test Loss: 0.927 Test Acc: 0.658
Validation loss decreased (-0.644727 --> -0.657885).  Saving model ...
Epoch: 15 cost time: 2.356797218322754
Epoch: 15, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.904 Vali Acc: 0.651 Test Loss: 0.904 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1389427185058594
Epoch: 16, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.881 Vali Acc: 0.691 Test Loss: 0.881 Test Acc: 0.691
Validation loss decreased (-0.657885 --> -0.690781).  Saving model ...
Epoch: 17 cost time: 1.9496383666992188
Epoch: 17, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.854 Vali Acc: 0.704 Test Loss: 0.854 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703939).  Saving model ...
Epoch: 18 cost time: 2.0438151359558105
Epoch: 18, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.834 Vali Acc: 0.704 Test Loss: 0.834 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703939).  Saving model ...
Epoch: 19 cost time: 1.9775135517120361
Epoch: 19, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.818 Vali Acc: 0.717 Test Loss: 0.818 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717097).  Saving model ...
Epoch: 20 cost time: 2.1373231410980225
Epoch: 20, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.792 Vali Acc: 0.737 Test Loss: 0.792 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736834).  Saving model ...
Epoch: 21 cost time: 2.108879804611206
Epoch: 21, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.769 Vali Acc: 0.743 Test Loss: 0.769 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743413).  Saving model ...
Epoch: 22 cost time: 2.362017869949341
Epoch: 22, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.747 Vali Acc: 0.750 Test Loss: 0.747 Test Acc: 0.750
Validation loss decreased (-0.743413 --> -0.749993).  Saving model ...
Epoch: 23 cost time: 2.264841318130493
Epoch: 23, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.728 Vali Acc: 0.757 Test Loss: 0.728 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 24 cost time: 2.2269554138183594
Epoch: 24, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.707 Vali Acc: 0.776 Test Loss: 0.707 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 25 cost time: 2.204096794128418
Epoch: 25, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.686 Vali Acc: 0.770 Test Loss: 0.686 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0758419036865234
Epoch: 26, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.667 Vali Acc: 0.770 Test Loss: 0.667 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0440564155578613
Epoch: 27, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 28 cost time: 2.1730551719665527
Epoch: 28, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.639 Vali Acc: 0.789 Test Loss: 0.639 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 29 cost time: 1.9063422679901123
Epoch: 29, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.631 Vali Acc: 0.789 Test Loss: 0.631 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 30 cost time: 2.273822546005249
Epoch: 30, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.629 Vali Acc: 0.796 Test Loss: 0.629 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 31 cost time: 2.2894067764282227
Epoch: 31, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 32 cost time: 2.2516286373138428
Epoch: 32, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.615 Vali Acc: 0.796 Test Loss: 0.615 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.145655870437622
Epoch: 33, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9122681617736816
Epoch: 34, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.604 Vali Acc: 0.796 Test Loss: 0.604 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8637876510620117
Epoch: 35, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.600 Vali Acc: 0.789 Test Loss: 0.600 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.1674187183380127
Epoch: 36, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.603 Vali Acc: 0.796 Test Loss: 0.603 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.9958407878875732
Epoch: 37, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.605 Vali Acc: 0.809 Test Loss: 0.605 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 38 cost time: 2.1584837436676025
Epoch: 38, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.131692409515381
Epoch: 39, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0784337520599365
Epoch: 40, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.602 Vali Acc: 0.803 Test Loss: 0.602 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.108786106109619
Epoch: 41, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.281080484390259
Epoch: 42, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.073188066482544
Epoch: 43, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.029402256011963
Epoch: 44, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.086406946182251
Epoch: 45, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.1245107650756836
Epoch: 46, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.1702938079833984
Epoch: 47, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.621 Vali Acc: 0.789 Test Loss: 0.621 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 78948
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.011322021484375
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.462 Vali Acc: 0.178 Test Loss: 1.462 Test Acc: 0.178
Validation loss decreased (inf --> -0.177617).  Saving model ...
Epoch: 2 cost time: 2.073319911956787
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.438 Vali Acc: 0.191 Test Loss: 1.438 Test Acc: 0.191
Validation loss decreased (-0.177617 --> -0.190775).  Saving model ...
Epoch: 3 cost time: 2.283682107925415
Epoch: 3, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.406 Vali Acc: 0.224 Test Loss: 1.406 Test Acc: 0.224
Validation loss decreased (-0.190775 --> -0.223670).  Saving model ...
Epoch: 4 cost time: 2.0991930961608887
Epoch: 4, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.373 Vali Acc: 0.250 Test Loss: 1.373 Test Acc: 0.250
Validation loss decreased (-0.223670 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 2.1138250827789307
Epoch: 5, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.338 Vali Acc: 0.296 Test Loss: 1.338 Test Acc: 0.296
Validation loss decreased (-0.249986 --> -0.296039).  Saving model ...
Epoch: 6 cost time: 2.092407464981079
Epoch: 6, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.302 Vali Acc: 0.342 Test Loss: 1.302 Test Acc: 0.342
Validation loss decreased (-0.296039 --> -0.342092).  Saving model ...
Epoch: 7 cost time: 2.0998196601867676
Epoch: 7, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.262 Vali Acc: 0.401 Test Loss: 1.262 Test Acc: 0.401
Validation loss decreased (-0.342092 --> -0.401303).  Saving model ...
Epoch: 8 cost time: 2.088411808013916
Epoch: 8, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.227 Vali Acc: 0.474 Test Loss: 1.227 Test Acc: 0.474
Validation loss decreased (-0.401303 --> -0.473672).  Saving model ...
Epoch: 9 cost time: 2.1618165969848633
Epoch: 9, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.192 Vali Acc: 0.520 Test Loss: 1.192 Test Acc: 0.520
Validation loss decreased (-0.473672 --> -0.519725).  Saving model ...
Epoch: 10 cost time: 2.04998517036438
Epoch: 10, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.156 Vali Acc: 0.533 Test Loss: 1.156 Test Acc: 0.533
Validation loss decreased (-0.519725 --> -0.532883).  Saving model ...
Epoch: 11 cost time: 2.1692302227020264
Epoch: 11, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.120 Vali Acc: 0.566 Test Loss: 1.120 Test Acc: 0.566
Validation loss decreased (-0.532883 --> -0.565778).  Saving model ...
Epoch: 12 cost time: 2.0540318489074707
Epoch: 12, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.088 Vali Acc: 0.579 Test Loss: 1.088 Test Acc: 0.579
Validation loss decreased (-0.565778 --> -0.578936).  Saving model ...
Epoch: 13 cost time: 1.928164005279541
Epoch: 13, Steps: 10 | Train Loss: 0.832 Vali Loss: 1.053 Vali Acc: 0.625 Test Loss: 1.053 Test Acc: 0.625
Validation loss decreased (-0.578936 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 1.7650401592254639
Epoch: 14, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.016 Vali Acc: 0.645 Test Loss: 1.016 Test Acc: 0.645
Validation loss decreased (-0.624989 --> -0.644727).  Saving model ...
Epoch: 15 cost time: 2.0812387466430664
Epoch: 15, Steps: 10 | Train Loss: 0.728 Vali Loss: 0.983 Vali Acc: 0.664 Test Loss: 0.983 Test Acc: 0.664
Validation loss decreased (-0.644727 --> -0.664464).  Saving model ...
Epoch: 16 cost time: 1.8520352840423584
Epoch: 16, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.948 Vali Acc: 0.664 Test Loss: 0.948 Test Acc: 0.664
Validation loss decreased (-0.664464 --> -0.664464).  Saving model ...
Epoch: 17 cost time: 1.9353342056274414
Epoch: 17, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.913 Vali Acc: 0.697 Test Loss: 0.913 Test Acc: 0.697
Validation loss decreased (-0.664464 --> -0.697359).  Saving model ...
Epoch: 18 cost time: 2.0151991844177246
Epoch: 18, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.880 Vali Acc: 0.704 Test Loss: 0.880 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703939).  Saving model ...
Epoch: 19 cost time: 2.1065673828125
Epoch: 19, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.849 Vali Acc: 0.711 Test Loss: 0.849 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710518).  Saving model ...
Epoch: 20 cost time: 2.1800272464752197
Epoch: 20, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.818 Vali Acc: 0.711 Test Loss: 0.818 Test Acc: 0.711
Validation loss decreased (-0.710518 --> -0.710518).  Saving model ...
Epoch: 21 cost time: 2.3374571800231934
Epoch: 21, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.789 Vali Acc: 0.737 Test Loss: 0.789 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736834).  Saving model ...
Epoch: 22 cost time: 2.358811616897583
Epoch: 22, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.759 Vali Acc: 0.743 Test Loss: 0.759 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743413).  Saving model ...
Epoch: 23 cost time: 2.261751413345337
Epoch: 23, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.733 Vali Acc: 0.743 Test Loss: 0.733 Test Acc: 0.743
Validation loss decreased (-0.743413 --> -0.743414).  Saving model ...
Epoch: 24 cost time: 2.27300763130188
Epoch: 24, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.705 Vali Acc: 0.743 Test Loss: 0.705 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 25 cost time: 2.2323408126831055
Epoch: 25, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.680 Vali Acc: 0.750 Test Loss: 0.680 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 26 cost time: 2.1586251258850098
Epoch: 26, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 27 cost time: 2.117959499359131
Epoch: 27, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.638 Vali Acc: 0.757 Test Loss: 0.638 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 28 cost time: 2.1033577919006348
Epoch: 28, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.624 Vali Acc: 0.757 Test Loss: 0.624 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 29 cost time: 2.3911664485931396
Epoch: 29, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.615 Vali Acc: 0.770 Test Loss: 0.615 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 30 cost time: 2.3447234630584717
Epoch: 30, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.608 Vali Acc: 0.776 Test Loss: 0.608 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 31 cost time: 2.3504559993743896
Epoch: 31, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 32 cost time: 2.214899778366089
Epoch: 32, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 33 cost time: 2.2225706577301025
Epoch: 33, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 34 cost time: 1.9266765117645264
Epoch: 34, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.584 Vali Acc: 0.783 Test Loss: 0.584 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 35 cost time: 1.9799456596374512
Epoch: 35, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 36 cost time: 2.009394884109497
Epoch: 36, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.1783437728881836
Epoch: 37, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.213942527770996
Epoch: 38, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.2569262981414795
Epoch: 39, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 40 cost time: 2.1818294525146484
Epoch: 40, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 41 cost time: 2.09926438331604
Epoch: 41, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.593 Vali Acc: 0.796 Test Loss: 0.593 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.9169502258300781
Epoch: 42, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.598 Vali Acc: 0.803 Test Loss: 0.598 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.9650962352752686
Epoch: 43, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.1550683975219727
Epoch: 44, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 45 cost time: 2.287325382232666
Epoch: 45, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.160261392593384
Epoch: 46, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.622 Vali Acc: 0.796 Test Loss: 0.622 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.173607587814331
Epoch: 47, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.622 Vali Acc: 0.796 Test Loss: 0.622 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.4089455604553223
Epoch: 48, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.626 Vali Acc: 0.796 Test Loss: 0.626 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.170872688293457
Epoch: 49, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.629 Vali Acc: 0.796 Test Loss: 0.629 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.9926891326904297
Epoch: 50, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.9898734092712402
Epoch: 51, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.0911166667938232
Epoch: 52, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.653 Vali Acc: 0.803 Test Loss: 0.653 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.233419418334961
Epoch: 53, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.657 Vali Acc: 0.803 Test Loss: 0.657 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.3166630268096924
Epoch: 54, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 78948
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9778225421905518
Epoch: 1, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.515 Vali Acc: 0.211 Test Loss: 1.515 Test Acc: 0.211
Validation loss decreased (inf --> -0.210511).  Saving model ...
Epoch: 2 cost time: 2.208925485610962
Epoch: 2, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.494 Vali Acc: 0.211 Test Loss: 1.494 Test Acc: 0.211
Validation loss decreased (-0.210511 --> -0.210511).  Saving model ...
Epoch: 3 cost time: 2.1467201709747314
Epoch: 3, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.466 Vali Acc: 0.257 Test Loss: 1.466 Test Acc: 0.257
Validation loss decreased (-0.210511 --> -0.256564).  Saving model ...
Epoch: 4 cost time: 2.3677656650543213
Epoch: 4, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.439 Vali Acc: 0.283 Test Loss: 1.439 Test Acc: 0.283
Validation loss decreased (-0.256564 --> -0.282880).  Saving model ...
Epoch: 5 cost time: 2.257920503616333
Epoch: 5, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.410 Vali Acc: 0.263 Test Loss: 1.410 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.442843198776245
Epoch: 6, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.381 Vali Acc: 0.270 Test Loss: 1.381 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.051722288131714
Epoch: 7, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.350 Vali Acc: 0.289 Test Loss: 1.350 Test Acc: 0.289
Validation loss decreased (-0.282880 --> -0.289460).  Saving model ...
Epoch: 8 cost time: 2.119288921356201
Epoch: 8, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.322 Vali Acc: 0.329 Test Loss: 1.322 Test Acc: 0.329
Validation loss decreased (-0.289460 --> -0.328934).  Saving model ...
Epoch: 9 cost time: 1.978499174118042
Epoch: 9, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.293 Vali Acc: 0.336 Test Loss: 1.293 Test Acc: 0.336
Validation loss decreased (-0.328934 --> -0.335513).  Saving model ...
Epoch: 10 cost time: 1.9582765102386475
Epoch: 10, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.261 Vali Acc: 0.382 Test Loss: 1.261 Test Acc: 0.382
Validation loss decreased (-0.335513 --> -0.381566).  Saving model ...
Epoch: 11 cost time: 2.350694179534912
Epoch: 11, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.228 Vali Acc: 0.401 Test Loss: 1.228 Test Acc: 0.401
Validation loss decreased (-0.381566 --> -0.401304).  Saving model ...
Epoch: 12 cost time: 2.147589921951294
Epoch: 12, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.200 Vali Acc: 0.428 Test Loss: 1.200 Test Acc: 0.428
Validation loss decreased (-0.401304 --> -0.427620).  Saving model ...
Epoch: 13 cost time: 2.245272397994995
Epoch: 13, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.169 Vali Acc: 0.447 Test Loss: 1.169 Test Acc: 0.447
Validation loss decreased (-0.427620 --> -0.447357).  Saving model ...
Epoch: 14 cost time: 2.224783182144165
Epoch: 14, Steps: 10 | Train Loss: 0.886 Vali Loss: 1.135 Vali Acc: 0.474 Test Loss: 1.135 Test Acc: 0.474
Validation loss decreased (-0.447357 --> -0.473673).  Saving model ...
Epoch: 15 cost time: 2.2616662979125977
Epoch: 15, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
Validation loss decreased (-0.473673 --> -0.499989).  Saving model ...
Epoch: 16 cost time: 2.1872336864471436
Epoch: 16, Steps: 10 | Train Loss: 0.754 Vali Loss: 1.070 Vali Acc: 0.507 Test Loss: 1.070 Test Acc: 0.507
Validation loss decreased (-0.499989 --> -0.506568).  Saving model ...
Epoch: 17 cost time: 2.1472878456115723
Epoch: 17, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.032 Vali Acc: 0.513 Test Loss: 1.032 Test Acc: 0.513
Validation loss decreased (-0.506568 --> -0.513148).  Saving model ...
Epoch: 18 cost time: 2.1849257946014404
Epoch: 18, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.997 Vali Acc: 0.553 Test Loss: 0.997 Test Acc: 0.553
Validation loss decreased (-0.513148 --> -0.552622).  Saving model ...
Epoch: 19 cost time: 2.580810785293579
Epoch: 19, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.958 Vali Acc: 0.592 Test Loss: 0.958 Test Acc: 0.592
Validation loss decreased (-0.552622 --> -0.592096).  Saving model ...
Epoch: 20 cost time: 2.506696939468384
Epoch: 20, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.921 Vali Acc: 0.586 Test Loss: 0.921 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.374469041824341
Epoch: 21, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.881 Vali Acc: 0.599 Test Loss: 0.881 Test Acc: 0.599
Validation loss decreased (-0.592096 --> -0.598675).  Saving model ...
Epoch: 22 cost time: 2.4375691413879395
Epoch: 22, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.844 Vali Acc: 0.618 Test Loss: 0.844 Test Acc: 0.618
Validation loss decreased (-0.598675 --> -0.618413).  Saving model ...
Epoch: 23 cost time: 2.5114126205444336
Epoch: 23, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.803 Vali Acc: 0.618 Test Loss: 0.803 Test Acc: 0.618
Validation loss decreased (-0.618413 --> -0.618413).  Saving model ...
Epoch: 24 cost time: 2.25661039352417
Epoch: 24, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.765 Vali Acc: 0.632 Test Loss: 0.765 Test Acc: 0.632
Validation loss decreased (-0.618413 --> -0.631571).  Saving model ...
Epoch: 25 cost time: 2.1441638469696045
Epoch: 25, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.730 Vali Acc: 0.651 Test Loss: 0.730 Test Acc: 0.651
Validation loss decreased (-0.631571 --> -0.651308).  Saving model ...
Epoch: 26 cost time: 2.128965139389038
Epoch: 26, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.698 Vali Acc: 0.664 Test Loss: 0.698 Test Acc: 0.664
Validation loss decreased (-0.651308 --> -0.664467).  Saving model ...
Epoch: 27 cost time: 2.275214672088623
Epoch: 27, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.668 Vali Acc: 0.697 Test Loss: 0.668 Test Acc: 0.697
Validation loss decreased (-0.664467 --> -0.697362).  Saving model ...
Epoch: 28 cost time: 2.6035327911376953
Epoch: 28, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.646 Vali Acc: 0.704 Test Loss: 0.646 Test Acc: 0.704
Validation loss decreased (-0.697362 --> -0.703941).  Saving model ...
Epoch: 29 cost time: 2.34627628326416
Epoch: 29, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.628 Vali Acc: 0.717 Test Loss: 0.628 Test Acc: 0.717
Validation loss decreased (-0.703941 --> -0.717099).  Saving model ...
Epoch: 30 cost time: 2.5266940593719482
Epoch: 30, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.611 Vali Acc: 0.750 Test Loss: 0.611 Test Acc: 0.750
Validation loss decreased (-0.717099 --> -0.749994).  Saving model ...
Epoch: 31 cost time: 2.4853692054748535
Epoch: 31, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.597 Vali Acc: 0.757 Test Loss: 0.597 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 32 cost time: 2.152080774307251
Epoch: 32, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.584 Vali Acc: 0.770 Test Loss: 0.584 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 33 cost time: 2.2589712142944336
Epoch: 33, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 34 cost time: 2.1620850563049316
Epoch: 34, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 35 cost time: 2.3130407333374023
Epoch: 35, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.560 Vali Acc: 0.770 Test Loss: 0.560 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.3853213787078857
Epoch: 36, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.3477911949157715
Epoch: 37, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.4362595081329346
Epoch: 38, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.554 Vali Acc: 0.763 Test Loss: 0.554 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.562154531478882
Epoch: 39, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 40 cost time: 2.125694513320923
Epoch: 40, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 41 cost time: 2.016511917114258
Epoch: 41, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.541 Vali Acc: 0.770 Test Loss: 0.541 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.2097620964050293
Epoch: 42, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.543 Vali Acc: 0.770 Test Loss: 0.543 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.4107162952423096
Epoch: 43, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 44 cost time: 2.4073691368103027
Epoch: 44, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 45 cost time: 2.3294246196746826
Epoch: 45, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.5968246459960938
Epoch: 46, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.4903252124786377
Epoch: 47, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 48 cost time: 2.117534637451172
Epoch: 48, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.285370111465454
Epoch: 49, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.470327138900757
Epoch: 50, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.578 Vali Acc: 0.809 Test Loss: 0.578 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 51 cost time: 2.3809664249420166
Epoch: 51, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.615306854248047
Epoch: 52, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 53 cost time: 2.2417781352996826
Epoch: 53, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.578 Vali Acc: 0.829 Test Loss: 0.578 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 54 cost time: 2.4893743991851807
Epoch: 54, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.575 Vali Acc: 0.836 Test Loss: 0.575 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 55 cost time: 2.2362821102142334
Epoch: 55, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.2189626693725586
Epoch: 56, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.0861258506774902
Epoch: 57, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.037285089492798
Epoch: 58, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.17730450630188
Epoch: 59, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.607 Vali Acc: 0.816 Test Loss: 0.607 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.35807204246521
Epoch: 60, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 2.3911490440368652
Epoch: 61, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.624 Vali Acc: 0.816 Test Loss: 0.624 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.4033701419830322
Epoch: 62, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.622 Vali Acc: 0.809 Test Loss: 0.622 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 2.202934503555298
Epoch: 63, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.624 Vali Acc: 0.816 Test Loss: 0.624 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 2.0107505321502686
Epoch: 64, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.630 Vali Acc: 0.816 Test Loss: 0.630 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 78948
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.100697040557861
Epoch: 1, Steps: 10 | Train Loss: 1.510 Vali Loss: 1.466 Vali Acc: 0.230 Test Loss: 1.466 Test Acc: 0.230
Validation loss decreased (inf --> -0.230248).  Saving model ...
Epoch: 2 cost time: 2.28407621383667
Epoch: 2, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.446 Vali Acc: 0.243 Test Loss: 1.446 Test Acc: 0.243
Validation loss decreased (-0.230248 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 2.2117836475372314
Epoch: 3, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.421 Vali Acc: 0.250 Test Loss: 1.421 Test Acc: 0.250
Validation loss decreased (-0.243407 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 2.1748263835906982
Epoch: 4, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.400 Vali Acc: 0.296 Test Loss: 1.400 Test Acc: 0.296
Validation loss decreased (-0.249986 --> -0.296039).  Saving model ...
Epoch: 5 cost time: 2.036036968231201
Epoch: 5, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.381 Vali Acc: 0.329 Test Loss: 1.381 Test Acc: 0.329
Validation loss decreased (-0.296039 --> -0.328934).  Saving model ...
Epoch: 6 cost time: 2.0765187740325928
Epoch: 6, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.363 Vali Acc: 0.355 Test Loss: 1.363 Test Acc: 0.355
Validation loss decreased (-0.328934 --> -0.355250).  Saving model ...
Epoch: 7 cost time: 2.303846597671509
Epoch: 7, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.345 Vali Acc: 0.395 Test Loss: 1.345 Test Acc: 0.395
Validation loss decreased (-0.355250 --> -0.394723).  Saving model ...
Epoch: 8 cost time: 2.2890982627868652
Epoch: 8, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.327 Vali Acc: 0.414 Test Loss: 1.327 Test Acc: 0.414
Validation loss decreased (-0.394723 --> -0.414460).  Saving model ...
Epoch: 9 cost time: 2.2614705562591553
Epoch: 9, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.304 Vali Acc: 0.441 Test Loss: 1.304 Test Acc: 0.441
Validation loss decreased (-0.414460 --> -0.440776).  Saving model ...
Epoch: 10 cost time: 2.1807870864868164
Epoch: 10, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.282 Vali Acc: 0.421 Test Loss: 1.282 Test Acc: 0.421
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2505991458892822
Epoch: 11, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.252 Vali Acc: 0.434 Test Loss: 1.252 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.199472188949585
Epoch: 12, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.223 Vali Acc: 0.461 Test Loss: 1.223 Test Acc: 0.461
Validation loss decreased (-0.440776 --> -0.460514).  Saving model ...
Epoch: 13 cost time: 1.936598777770996
Epoch: 13, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
Validation loss decreased (-0.460514 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 2.0975191593170166
Epoch: 14, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.153 Vali Acc: 0.539 Test Loss: 1.153 Test Acc: 0.539
Validation loss decreased (-0.499988 --> -0.539462).  Saving model ...
Epoch: 15 cost time: 2.0601236820220947
Epoch: 15, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.107 Vali Acc: 0.592 Test Loss: 1.107 Test Acc: 0.592
Validation loss decreased (-0.539462 --> -0.592094).  Saving model ...
Epoch: 16 cost time: 2.052375078201294
Epoch: 16, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.062 Vali Acc: 0.612 Test Loss: 1.062 Test Acc: 0.612
Validation loss decreased (-0.592094 --> -0.611831).  Saving model ...
Epoch: 17 cost time: 2.186485767364502
Epoch: 17, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.012 Vali Acc: 0.618 Test Loss: 1.012 Test Acc: 0.618
Validation loss decreased (-0.611831 --> -0.618411).  Saving model ...
Epoch: 18 cost time: 2.2514989376068115
Epoch: 18, Steps: 10 | Train Loss: 0.759 Vali Loss: 0.959 Vali Acc: 0.638 Test Loss: 0.959 Test Acc: 0.638
Validation loss decreased (-0.618411 --> -0.638148).  Saving model ...
Epoch: 19 cost time: 2.2388439178466797
Epoch: 19, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.901 Vali Acc: 0.651 Test Loss: 0.901 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651307).  Saving model ...
Epoch: 20 cost time: 2.212458610534668
Epoch: 20, Steps: 10 | Train Loss: 0.643 Vali Loss: 0.847 Vali Acc: 0.651 Test Loss: 0.847 Test Acc: 0.651
Validation loss decreased (-0.651307 --> -0.651307).  Saving model ...
Epoch: 21 cost time: 2.113882303237915
Epoch: 21, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.789 Vali Acc: 0.664 Test Loss: 0.789 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664466).  Saving model ...
Epoch: 22 cost time: 2.034083843231201
Epoch: 22, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.738 Vali Acc: 0.697 Test Loss: 0.738 Test Acc: 0.697
Validation loss decreased (-0.664466 --> -0.697361).  Saving model ...
Epoch: 23 cost time: 2.0883891582489014
Epoch: 23, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.683 Vali Acc: 0.704 Test Loss: 0.683 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703941).  Saving model ...
Epoch: 24 cost time: 2.0070419311523438
Epoch: 24, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.639 Vali Acc: 0.730 Test Loss: 0.639 Test Acc: 0.730
Validation loss decreased (-0.703941 --> -0.730257).  Saving model ...
Epoch: 25 cost time: 2.0198605060577393
Epoch: 25, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 26 cost time: 2.234436511993408
Epoch: 26, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.568 Vali Acc: 0.730 Test Loss: 0.568 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1145167350769043
Epoch: 27, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 28 cost time: 1.957019329071045
Epoch: 28, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.540 Vali Acc: 0.763 Test Loss: 0.540 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 29 cost time: 2.1433908939361572
Epoch: 29, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.537 Vali Acc: 0.750 Test Loss: 0.537 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9629607200622559
Epoch: 30, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.530 Vali Acc: 0.750 Test Loss: 0.530 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.170705556869507
Epoch: 31, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.529 Vali Acc: 0.757 Test Loss: 0.529 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.0684149265289307
Epoch: 32, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.528 Vali Acc: 0.770 Test Loss: 0.528 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769732).  Saving model ...
Epoch: 33 cost time: 2.1514499187469482
Epoch: 33, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.527 Vali Acc: 0.770 Test Loss: 0.527 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 34 cost time: 2.111488103866577
Epoch: 34, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.519 Vali Acc: 0.770 Test Loss: 0.519 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 35 cost time: 2.0869204998016357
Epoch: 35, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 36 cost time: 2.162601947784424
Epoch: 36, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 37 cost time: 2.017224073410034
Epoch: 37, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 38 cost time: 2.1010947227478027
Epoch: 38, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.535 Vali Acc: 0.776 Test Loss: 0.535 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.9839763641357422
Epoch: 39, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.9464004039764404
Epoch: 40, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.1074483394622803
Epoch: 41, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.0134146213531494
Epoch: 42, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.0767905712127686
Epoch: 43, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.0133605003356934
Epoch: 44, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.135171890258789
Epoch: 45, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.206118106842041
Epoch: 46, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.144994020462036
Epoch: 47, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 78948
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.757080078125
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.428 Vali Acc: 0.224 Test Loss: 1.428 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 2.2834861278533936
Epoch: 2, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.410 Vali Acc: 0.230 Test Loss: 1.410 Test Acc: 0.230
Validation loss decreased (-0.223670 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 2.364065647125244
Epoch: 3, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
Validation loss decreased (-0.230249 --> -0.269723).  Saving model ...
Epoch: 4 cost time: 2.2226390838623047
Epoch: 4, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.365 Vali Acc: 0.303 Test Loss: 1.365 Test Acc: 0.303
Validation loss decreased (-0.269723 --> -0.302618).  Saving model ...
Epoch: 5 cost time: 2.1220803260803223
Epoch: 5, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.346 Vali Acc: 0.355 Test Loss: 1.346 Test Acc: 0.355
Validation loss decreased (-0.302618 --> -0.355250).  Saving model ...
Epoch: 6 cost time: 2.1105642318725586
Epoch: 6, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.326 Vali Acc: 0.408 Test Loss: 1.326 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407881).  Saving model ...
Epoch: 7 cost time: 1.9684786796569824
Epoch: 7, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.306 Vali Acc: 0.441 Test Loss: 1.306 Test Acc: 0.441
Validation loss decreased (-0.407881 --> -0.440776).  Saving model ...
Epoch: 8 cost time: 2.2104249000549316
Epoch: 8, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.288 Vali Acc: 0.441 Test Loss: 1.288 Test Acc: 0.441
Validation loss decreased (-0.440776 --> -0.440777).  Saving model ...
Epoch: 9 cost time: 1.9984560012817383
Epoch: 9, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.265 Vali Acc: 0.454 Test Loss: 1.265 Test Acc: 0.454
Validation loss decreased (-0.440777 --> -0.453935).  Saving model ...
Epoch: 10 cost time: 2.278348445892334
Epoch: 10, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.453935 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 2.160618543624878
Epoch: 11, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.211 Vali Acc: 0.526 Test Loss: 1.211 Test Acc: 0.526
Validation loss decreased (-0.499988 --> -0.526304).  Saving model ...
Epoch: 12 cost time: 2.3162484169006348
Epoch: 12, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.182 Vali Acc: 0.526 Test Loss: 1.182 Test Acc: 0.526
Validation loss decreased (-0.526304 --> -0.526304).  Saving model ...
Epoch: 13 cost time: 2.20403790473938
Epoch: 13, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.152 Vali Acc: 0.566 Test Loss: 1.152 Test Acc: 0.566
Validation loss decreased (-0.526304 --> -0.565778).  Saving model ...
Epoch: 14 cost time: 2.0904576778411865
Epoch: 14, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.114 Vali Acc: 0.566 Test Loss: 1.114 Test Acc: 0.566
Validation loss decreased (-0.565778 --> -0.565778).  Saving model ...
Epoch: 15 cost time: 2.196129083633423
Epoch: 15, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.070 Vali Acc: 0.572 Test Loss: 1.070 Test Acc: 0.572
Validation loss decreased (-0.565778 --> -0.572358).  Saving model ...
Epoch: 16 cost time: 2.0586984157562256
Epoch: 16, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.027 Vali Acc: 0.579 Test Loss: 1.027 Test Acc: 0.579
Validation loss decreased (-0.572358 --> -0.578937).  Saving model ...
Epoch: 17 cost time: 2.153339385986328
Epoch: 17, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.977 Vali Acc: 0.599 Test Loss: 0.977 Test Acc: 0.599
Validation loss decreased (-0.578937 --> -0.598674).  Saving model ...
Epoch: 18 cost time: 2.0986647605895996
Epoch: 18, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.928 Vali Acc: 0.625 Test Loss: 0.928 Test Acc: 0.625
Validation loss decreased (-0.598674 --> -0.624991).  Saving model ...
Epoch: 19 cost time: 2.096679925918579
Epoch: 19, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.876 Vali Acc: 0.632 Test Loss: 0.876 Test Acc: 0.632
Validation loss decreased (-0.624991 --> -0.631570).  Saving model ...
Epoch: 20 cost time: 2.134077548980713
Epoch: 20, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.824 Vali Acc: 0.678 Test Loss: 0.824 Test Acc: 0.678
Validation loss decreased (-0.631570 --> -0.677623).  Saving model ...
Epoch: 21 cost time: 2.400308847427368
Epoch: 21, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.768 Vali Acc: 0.691 Test Loss: 0.768 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690782).  Saving model ...
Epoch: 22 cost time: 2.0397238731384277
Epoch: 22, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.716 Vali Acc: 0.717 Test Loss: 0.716 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 23 cost time: 2.349440336227417
Epoch: 23, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.660 Vali Acc: 0.743 Test Loss: 0.660 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 24 cost time: 1.9262983798980713
Epoch: 24, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
Validation loss decreased (-0.743414 --> -0.782889).  Saving model ...
Epoch: 25 cost time: 2.1343512535095215
Epoch: 25, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 26 cost time: 2.205221652984619
Epoch: 26, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.173916816711426
Epoch: 27, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 28 cost time: 2.0864412784576416
Epoch: 28, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.152449369430542
Epoch: 29, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 2.207304000854492
Epoch: 30, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2029268741607666
Epoch: 31, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1731796264648438
Epoch: 32, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.272134780883789
Epoch: 33, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.493 Vali Acc: 0.783 Test Loss: 0.493 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.3730528354644775
Epoch: 34, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.486 Vali Acc: 0.789 Test Loss: 0.486 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.2742412090301514
Epoch: 35, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.487 Vali Acc: 0.796 Test Loss: 0.487 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.099491596221924
Epoch: 36, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.491 Vali Acc: 0.796 Test Loss: 0.491 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.279045581817627
Epoch: 37, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.490 Vali Acc: 0.776 Test Loss: 0.490 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.311548948287964
Epoch: 38, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.493 Vali Acc: 0.770 Test Loss: 0.493 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.555610418319702
Epoch: 39, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 78948
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.1351377964019775
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 2.174137830734253
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.9118096828460693
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 2.1827874183654785
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 2.1993908882141113
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 6 cost time: 2.1306378841400146
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 7 cost time: 1.8932216167449951
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 8 cost time: 2.1548478603363037
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 9 cost time: 2.1642723083496094
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 10 cost time: 2.124514102935791
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 11 cost time: 2.467069149017334
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 12 cost time: 2.320128917694092
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 13 cost time: 2.3146283626556396
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 14 cost time: 2.2032573223114014
Epoch: 14, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 15 cost time: 2.2316970825195312
Epoch: 15, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 16 cost time: 2.276200771331787
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 17 cost time: 2.149428129196167
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 18 cost time: 2.1666643619537354
Epoch: 18, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 19 cost time: 2.117219924926758
Epoch: 19, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 20 cost time: 2.436464786529541
Epoch: 20, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3564136028289795
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 22 cost time: 2.269002914428711
Epoch: 22, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 23 cost time: 1.9720475673675537
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 24 cost time: 1.828195333480835
Epoch: 24, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9474925994873047
Epoch: 25, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 26 cost time: 2.1970956325531006
Epoch: 26, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.008267402648926
Epoch: 27, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.0490529537200928
Epoch: 28, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 1.899303913116455
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.131789207458496
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 1.8777778148651123
Epoch: 31, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 2.0347509384155273
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 1.9698235988616943
Epoch: 33, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.14266037940979
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.3740224838256836
Epoch: 35, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 2.3296303749084473
Epoch: 36, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 37 cost time: 2.2880287170410156
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.372546434402466
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.1534690856933594
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.3828375339508057
Epoch: 40, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 2.2567505836486816
Epoch: 41, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 2.257600784301758
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 2.1100234985351562
Epoch: 43, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.06847882270813
Epoch: 44, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.226961374282837
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.0738747119903564
Epoch: 46, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.0977723598480225
Epoch: 47, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.002290964126587
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.013894557952881
Epoch: 49, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.2130110263824463
Epoch: 50, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.072131395339966
Epoch: 51, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 52 cost time: 2.045079231262207
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 53 cost time: 2.145364284515381
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 54 cost time: 2.205275297164917
Epoch: 54, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 55 cost time: 2.0671658515930176
Epoch: 55, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.2458436489105225
Epoch: 56, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 57 cost time: 2.2234272956848145
Epoch: 57, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 58 cost time: 2.186978816986084
Epoch: 58, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.2633442878723145
Epoch: 59, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.5471794605255127
Epoch: 60, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.2171435356140137
Epoch: 61, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 2.2019317150115967
Epoch: 62, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 2.3815088272094727
Epoch: 63, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 2.2710914611816406
Epoch: 64, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 2.1227517127990723
Epoch: 65, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 2.1136786937713623
Epoch: 66, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 2.337489128112793
Epoch: 67, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 68 cost time: 2.1560561656951904
Epoch: 68, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 69 cost time: 2.276829957962036
Epoch: 69, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 70 cost time: 2.193556785583496
Epoch: 70, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 2.3099241256713867
Epoch: 71, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 2.2104697227478027
Epoch: 72, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 2.2016239166259766
Epoch: 73, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 2.230900764465332
Epoch: 74, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 2.2648353576660156
Epoch: 75, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 2.014913320541382
Epoch: 76, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 2.2495477199554443
Epoch: 77, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 2.3553755283355713
Epoch: 78, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 2.208202362060547
Epoch: 79, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 78948
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.304877758026123
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.453 Vali Acc: 0.250 Test Loss: 1.453 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 2.286362648010254
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.415 Vali Acc: 0.270 Test Loss: 1.415 Test Acc: 0.270
Validation loss decreased (-0.249985 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 2.1812546253204346
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.368 Vali Acc: 0.322 Test Loss: 1.368 Test Acc: 0.322
Validation loss decreased (-0.269723 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 2.120342254638672
Epoch: 4, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.319 Vali Acc: 0.342 Test Loss: 1.319 Test Acc: 0.342
Validation loss decreased (-0.322355 --> -0.342092).  Saving model ...
Epoch: 5 cost time: 2.1416893005371094
Epoch: 5, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.267 Vali Acc: 0.454 Test Loss: 1.267 Test Acc: 0.454
Validation loss decreased (-0.342092 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 2.1990981101989746
Epoch: 6, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.219 Vali Acc: 0.480 Test Loss: 1.219 Test Acc: 0.480
Validation loss decreased (-0.453935 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 2.1097569465637207
Epoch: 7, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.170 Vali Acc: 0.513 Test Loss: 1.170 Test Acc: 0.513
Validation loss decreased (-0.480251 --> -0.513146).  Saving model ...
Epoch: 8 cost time: 2.3954384326934814
Epoch: 8, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.121 Vali Acc: 0.539 Test Loss: 1.121 Test Acc: 0.539
Validation loss decreased (-0.513146 --> -0.539462).  Saving model ...
Epoch: 9 cost time: 2.1894354820251465
Epoch: 9, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.081 Vali Acc: 0.559 Test Loss: 1.081 Test Acc: 0.559
Validation loss decreased (-0.539462 --> -0.559200).  Saving model ...
Epoch: 10 cost time: 2.10917329788208
Epoch: 10, Steps: 10 | Train Loss: 0.870 Vali Loss: 1.039 Vali Acc: 0.579 Test Loss: 1.039 Test Acc: 0.579
Validation loss decreased (-0.559200 --> -0.578937).  Saving model ...
Epoch: 11 cost time: 2.1246063709259033
Epoch: 11, Steps: 10 | Train Loss: 0.795 Vali Loss: 1.005 Vali Acc: 0.605 Test Loss: 1.005 Test Acc: 0.605
Validation loss decreased (-0.578937 --> -0.605253).  Saving model ...
Epoch: 12 cost time: 2.296442747116089
Epoch: 12, Steps: 10 | Train Loss: 0.734 Vali Loss: 0.972 Vali Acc: 0.605 Test Loss: 0.972 Test Acc: 0.605
Validation loss decreased (-0.605253 --> -0.605253).  Saving model ...
Epoch: 13 cost time: 2.195906162261963
Epoch: 13, Steps: 10 | Train Loss: 0.685 Vali Loss: 0.939 Vali Acc: 0.638 Test Loss: 0.939 Test Acc: 0.638
Validation loss decreased (-0.605253 --> -0.638149).  Saving model ...
Epoch: 14 cost time: 2.175215482711792
Epoch: 14, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.912 Vali Acc: 0.638 Test Loss: 0.912 Test Acc: 0.638
Validation loss decreased (-0.638149 --> -0.638149).  Saving model ...
Epoch: 15 cost time: 2.287177801132202
Epoch: 15, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.885 Vali Acc: 0.632 Test Loss: 0.885 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0438880920410156
Epoch: 16, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.862 Vali Acc: 0.632 Test Loss: 0.862 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1768784523010254
Epoch: 17, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.840 Vali Acc: 0.645 Test Loss: 0.840 Test Acc: 0.645
Validation loss decreased (-0.638149 --> -0.644728).  Saving model ...
Epoch: 18 cost time: 2.238309383392334
Epoch: 18, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.818 Vali Acc: 0.671 Test Loss: 0.818 Test Acc: 0.671
Validation loss decreased (-0.644728 --> -0.671044).  Saving model ...
Epoch: 19 cost time: 2.096623659133911
Epoch: 19, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.794 Vali Acc: 0.684 Test Loss: 0.794 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684203).  Saving model ...
Epoch: 20 cost time: 2.2131519317626953
Epoch: 20, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.773 Vali Acc: 0.704 Test Loss: 0.773 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703940).  Saving model ...
Epoch: 21 cost time: 2.109569787979126
Epoch: 21, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.752 Vali Acc: 0.704 Test Loss: 0.752 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703940).  Saving model ...
Epoch: 22 cost time: 2.137157678604126
Epoch: 22, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.735 Vali Acc: 0.697 Test Loss: 0.735 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1753950119018555
Epoch: 23, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.721 Vali Acc: 0.704 Test Loss: 0.721 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703940).  Saving model ...
Epoch: 24 cost time: 2.214324951171875
Epoch: 24, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.706 Vali Acc: 0.711 Test Loss: 0.706 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 25 cost time: 2.2294416427612305
Epoch: 25, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.690 Vali Acc: 0.724 Test Loss: 0.690 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 26 cost time: 2.097032070159912
Epoch: 26, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.673 Vali Acc: 0.743 Test Loss: 0.673 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 27 cost time: 2.1280417442321777
Epoch: 27, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.656 Vali Acc: 0.750 Test Loss: 0.656 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 28 cost time: 2.218449592590332
Epoch: 28, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 29 cost time: 2.1152889728546143
Epoch: 29, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.624 Vali Acc: 0.763 Test Loss: 0.624 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 30 cost time: 2.187028169631958
Epoch: 30, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.613 Vali Acc: 0.757 Test Loss: 0.613 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.199820041656494
Epoch: 31, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.601 Vali Acc: 0.770 Test Loss: 0.601 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 32 cost time: 2.2758681774139404
Epoch: 32, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.594 Vali Acc: 0.776 Test Loss: 0.594 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 2.217662811279297
Epoch: 33, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 34 cost time: 2.27535080909729
Epoch: 34, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.582 Vali Acc: 0.796 Test Loss: 0.582 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 35 cost time: 1.9480669498443604
Epoch: 35, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.2783892154693604
Epoch: 36, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.188814401626587
Epoch: 37, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 38 cost time: 2.3924143314361572
Epoch: 38, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 39 cost time: 2.514636993408203
Epoch: 39, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.2810776233673096
Epoch: 40, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.574 Vali Acc: 0.796 Test Loss: 0.574 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.3425002098083496
Epoch: 41, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.2995967864990234
Epoch: 42, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.386775493621826
Epoch: 43, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.193420648574829
Epoch: 44, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.254660129547119
Epoch: 45, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.527763843536377
Epoch: 46, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.592 Vali Acc: 0.796 Test Loss: 0.592 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.1509838104248047
Epoch: 47, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.600 Vali Acc: 0.796 Test Loss: 0.600 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.368252754211426
Epoch: 48, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.595 Vali Acc: 0.789 Test Loss: 0.595 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 54372
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.943934679031372
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.459 Vali Acc: 0.211 Test Loss: 1.459 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 2.156545400619507
Epoch: 2, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.424 Vali Acc: 0.217 Test Loss: 1.424 Test Acc: 0.217
Validation loss decreased (-0.210512 --> -0.217091).  Saving model ...
Epoch: 3 cost time: 2.0424435138702393
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.381 Vali Acc: 0.289 Test Loss: 1.381 Test Acc: 0.289
Validation loss decreased (-0.217091 --> -0.289460).  Saving model ...
Epoch: 4 cost time: 2.081641674041748
Epoch: 4, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.335 Vali Acc: 0.355 Test Loss: 1.335 Test Acc: 0.355
Validation loss decreased (-0.289460 --> -0.355250).  Saving model ...
Epoch: 5 cost time: 2.0461184978485107
Epoch: 5, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.287 Vali Acc: 0.441 Test Loss: 1.287 Test Acc: 0.441
Validation loss decreased (-0.355250 --> -0.440777).  Saving model ...
Epoch: 6 cost time: 1.967777967453003
Epoch: 6, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.241 Vali Acc: 0.454 Test Loss: 1.241 Test Acc: 0.454
Validation loss decreased (-0.440777 --> -0.453935).  Saving model ...
Epoch: 7 cost time: 2.036327600479126
Epoch: 7, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.195 Vali Acc: 0.507 Test Loss: 1.195 Test Acc: 0.507
Validation loss decreased (-0.453935 --> -0.506567).  Saving model ...
Epoch: 8 cost time: 2.120750904083252
Epoch: 8, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.149 Vali Acc: 0.553 Test Loss: 1.149 Test Acc: 0.553
Validation loss decreased (-0.506567 --> -0.552620).  Saving model ...
Epoch: 9 cost time: 2.219930648803711
Epoch: 9, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.108 Vali Acc: 0.625 Test Loss: 1.108 Test Acc: 0.625
Validation loss decreased (-0.552620 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 2.134861469268799
Epoch: 10, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.067 Vali Acc: 0.645 Test Loss: 1.067 Test Acc: 0.645
Validation loss decreased (-0.624989 --> -0.644726).  Saving model ...
Epoch: 11 cost time: 2.1209967136383057
Epoch: 11, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.033 Vali Acc: 0.645 Test Loss: 1.033 Test Acc: 0.645
Validation loss decreased (-0.644726 --> -0.644727).  Saving model ...
Epoch: 12 cost time: 2.355329990386963
Epoch: 12, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.002 Vali Acc: 0.658 Test Loss: 1.002 Test Acc: 0.658
Validation loss decreased (-0.644727 --> -0.657885).  Saving model ...
Epoch: 13 cost time: 2.220458745956421
Epoch: 13, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.969 Vali Acc: 0.671 Test Loss: 0.969 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671043).  Saving model ...
Epoch: 14 cost time: 2.0267159938812256
Epoch: 14, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.941 Vali Acc: 0.684 Test Loss: 0.941 Test Acc: 0.684
Validation loss decreased (-0.671043 --> -0.684201).  Saving model ...
Epoch: 15 cost time: 2.047285556793213
Epoch: 15, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.913 Vali Acc: 0.664 Test Loss: 0.913 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0092368125915527
Epoch: 16, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.889 Vali Acc: 0.697 Test Loss: 0.889 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697360).  Saving model ...
Epoch: 17 cost time: 2.1467909812927246
Epoch: 17, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.864 Vali Acc: 0.691 Test Loss: 0.864 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1092448234558105
Epoch: 18, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.840 Vali Acc: 0.711 Test Loss: 0.840 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710518).  Saving model ...
Epoch: 19 cost time: 2.0507137775421143
Epoch: 19, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.812 Vali Acc: 0.724 Test Loss: 0.812 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723676).  Saving model ...
Epoch: 20 cost time: 1.978353500366211
Epoch: 20, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.786 Vali Acc: 0.730 Test Loss: 0.786 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730255).  Saving model ...
Epoch: 21 cost time: 2.039696216583252
Epoch: 21, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.763 Vali Acc: 0.737 Test Loss: 0.763 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736834).  Saving model ...
Epoch: 22 cost time: 2.0729153156280518
Epoch: 22, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.745 Vali Acc: 0.743 Test Loss: 0.745 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743414).  Saving model ...
Epoch: 23 cost time: 1.9812767505645752
Epoch: 23, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.726 Vali Acc: 0.743 Test Loss: 0.726 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 24 cost time: 2.0177955627441406
Epoch: 24, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.707 Vali Acc: 0.743 Test Loss: 0.707 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 25 cost time: 2.1836109161376953
Epoch: 25, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.690 Vali Acc: 0.743 Test Loss: 0.690 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 26 cost time: 2.0525481700897217
Epoch: 26, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.669 Vali Acc: 0.763 Test Loss: 0.669 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763151).  Saving model ...
Epoch: 27 cost time: 2.1336240768432617
Epoch: 27, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.650 Vali Acc: 0.763 Test Loss: 0.650 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 28 cost time: 1.8965141773223877
Epoch: 28, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.634 Vali Acc: 0.770 Test Loss: 0.634 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 2.073683261871338
Epoch: 29, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 30 cost time: 1.941972017288208
Epoch: 30, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 31 cost time: 2.1093497276306152
Epoch: 31, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.595 Vali Acc: 0.776 Test Loss: 0.595 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 32 cost time: 2.1722795963287354
Epoch: 32, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.592 Vali Acc: 0.783 Test Loss: 0.592 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 33 cost time: 2.133683443069458
Epoch: 33, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 34 cost time: 2.2859580516815186
Epoch: 34, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 35 cost time: 2.107898235321045
Epoch: 35, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 36 cost time: 2.173292398452759
Epoch: 36, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 37 cost time: 2.03902268409729
Epoch: 37, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.579 Vali Acc: 0.803 Test Loss: 0.579 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 38 cost time: 2.0915660858154297
Epoch: 38, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.579 Vali Acc: 0.803 Test Loss: 0.579 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 39 cost time: 2.2418270111083984
Epoch: 39, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 40 cost time: 2.2168569564819336
Epoch: 40, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.588 Vali Acc: 0.809 Test Loss: 0.588 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.1206653118133545
Epoch: 41, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.589 Vali Acc: 0.809 Test Loss: 0.589 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.0672125816345215
Epoch: 42, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.1860828399658203
Epoch: 43, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.9276738166809082
Epoch: 44, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.0220224857330322
Epoch: 45, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.0959508419036865
Epoch: 46, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.609 Vali Acc: 0.809 Test Loss: 0.609 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.176461935043335
Epoch: 47, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815783).  Saving model ...
Epoch: 48 cost time: 1.967616319656372
Epoch: 48, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.0747861862182617
Epoch: 49, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.614 Vali Acc: 0.803 Test Loss: 0.614 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.1006107330322266
Epoch: 50, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.620 Vali Acc: 0.809 Test Loss: 0.620 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.0662717819213867
Epoch: 51, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.2552802562713623
Epoch: 52, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.634 Vali Acc: 0.816 Test Loss: 0.634 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.014082193374634
Epoch: 53, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 54 cost time: 1.9750549793243408
Epoch: 54, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.651 Vali Acc: 0.822 Test Loss: 0.651 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.1660921573638916
Epoch: 55, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.648 Vali Acc: 0.809 Test Loss: 0.648 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.1901838779449463
Epoch: 56, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.1917481422424316
Epoch: 57, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.651 Vali Acc: 0.816 Test Loss: 0.651 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.1136715412139893
Epoch: 58, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.657 Vali Acc: 0.816 Test Loss: 0.657 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.9953351020812988
Epoch: 59, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.667 Vali Acc: 0.816 Test Loss: 0.667 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 2.2418181896209717
Epoch: 60, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.671 Vali Acc: 0.816 Test Loss: 0.671 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 2.106285810470581
Epoch: 61, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 2.3477773666381836
Epoch: 62, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 2.220275402069092
Epoch: 63, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 54372
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.992267370223999
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.475 Vali Acc: 0.204 Test Loss: 1.475 Test Acc: 0.204
Validation loss decreased (inf --> -0.203933).  Saving model ...
Epoch: 2 cost time: 2.095475912094116
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.448 Vali Acc: 0.230 Test Loss: 1.448 Test Acc: 0.230
Validation loss decreased (-0.203933 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 2.110151767730713
Epoch: 3, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.417 Vali Acc: 0.230 Test Loss: 1.417 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 4 cost time: 2.076188325881958
Epoch: 4, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.382 Vali Acc: 0.283 Test Loss: 1.382 Test Acc: 0.283
Validation loss decreased (-0.230249 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 1.9755542278289795
Epoch: 5, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.343 Vali Acc: 0.342 Test Loss: 1.343 Test Acc: 0.342
Validation loss decreased (-0.282881 --> -0.342092).  Saving model ...
Epoch: 6 cost time: 1.9315619468688965
Epoch: 6, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.305 Vali Acc: 0.401 Test Loss: 1.305 Test Acc: 0.401
Validation loss decreased (-0.342092 --> -0.401303).  Saving model ...
Epoch: 7 cost time: 1.993053913116455
Epoch: 7, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.270 Vali Acc: 0.421 Test Loss: 1.270 Test Acc: 0.421
Validation loss decreased (-0.401303 --> -0.421040).  Saving model ...
Epoch: 8 cost time: 1.9934735298156738
Epoch: 8, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.232 Vali Acc: 0.461 Test Loss: 1.232 Test Acc: 0.461
Validation loss decreased (-0.421040 --> -0.460514).  Saving model ...
Epoch: 9 cost time: 2.085268259048462
Epoch: 9, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.194 Vali Acc: 0.487 Test Loss: 1.194 Test Acc: 0.487
Validation loss decreased (-0.460514 --> -0.486830).  Saving model ...
Epoch: 10 cost time: 2.0184457302093506
Epoch: 10, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.157 Vali Acc: 0.520 Test Loss: 1.157 Test Acc: 0.520
Validation loss decreased (-0.486830 --> -0.519725).  Saving model ...
Epoch: 11 cost time: 2.1021833419799805
Epoch: 11, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.123 Vali Acc: 0.539 Test Loss: 1.123 Test Acc: 0.539
Validation loss decreased (-0.519725 --> -0.539462).  Saving model ...
Epoch: 12 cost time: 2.1897575855255127
Epoch: 12, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.091 Vali Acc: 0.572 Test Loss: 1.091 Test Acc: 0.572
Validation loss decreased (-0.539462 --> -0.572358).  Saving model ...
Epoch: 13 cost time: 2.0794928073883057
Epoch: 13, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.054 Vali Acc: 0.592 Test Loss: 1.054 Test Acc: 0.592
Validation loss decreased (-0.572358 --> -0.592095).  Saving model ...
Epoch: 14 cost time: 2.1676926612854004
Epoch: 14, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.023 Vali Acc: 0.618 Test Loss: 1.023 Test Acc: 0.618
Validation loss decreased (-0.592095 --> -0.618411).  Saving model ...
Epoch: 15 cost time: 2.128154754638672
Epoch: 15, Steps: 10 | Train Loss: 0.796 Vali Loss: 0.991 Vali Acc: 0.632 Test Loss: 0.991 Test Acc: 0.632
Validation loss decreased (-0.618411 --> -0.631569).  Saving model ...
Epoch: 16 cost time: 2.1342015266418457
Epoch: 16, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.961 Vali Acc: 0.638 Test Loss: 0.961 Test Acc: 0.638
Validation loss decreased (-0.631569 --> -0.638148).  Saving model ...
Epoch: 17 cost time: 1.9934039115905762
Epoch: 17, Steps: 10 | Train Loss: 0.656 Vali Loss: 0.928 Vali Acc: 0.645 Test Loss: 0.928 Test Acc: 0.645
Validation loss decreased (-0.638148 --> -0.644728).  Saving model ...
Epoch: 18 cost time: 2.132085084915161
Epoch: 18, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.897 Vali Acc: 0.658 Test Loss: 0.897 Test Acc: 0.658
Validation loss decreased (-0.644728 --> -0.657886).  Saving model ...
Epoch: 19 cost time: 2.1928279399871826
Epoch: 19, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.865 Vali Acc: 0.664 Test Loss: 0.865 Test Acc: 0.664
Validation loss decreased (-0.657886 --> -0.664465).  Saving model ...
Epoch: 20 cost time: 2.122373580932617
Epoch: 20, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.834 Vali Acc: 0.671 Test Loss: 0.834 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671044).  Saving model ...
Epoch: 21 cost time: 2.152831792831421
Epoch: 21, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.804 Vali Acc: 0.678 Test Loss: 0.804 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677624).  Saving model ...
Epoch: 22 cost time: 2.06282114982605
Epoch: 22, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.776 Vali Acc: 0.684 Test Loss: 0.776 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 23 cost time: 2.094712257385254
Epoch: 23, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.747 Vali Acc: 0.711 Test Loss: 0.747 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710519).  Saving model ...
Epoch: 24 cost time: 2.1301300525665283
Epoch: 24, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.721 Vali Acc: 0.724 Test Loss: 0.721 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 25 cost time: 1.9884495735168457
Epoch: 25, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.699 Vali Acc: 0.724 Test Loss: 0.699 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 26 cost time: 1.9388842582702637
Epoch: 26, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.674 Vali Acc: 0.724 Test Loss: 0.674 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 27 cost time: 1.9140913486480713
Epoch: 27, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 28 cost time: 2.0906243324279785
Epoch: 28, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.629 Vali Acc: 0.757 Test Loss: 0.629 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 29 cost time: 1.9054217338562012
Epoch: 29, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 30 cost time: 1.9549894332885742
Epoch: 30, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.596 Vali Acc: 0.770 Test Loss: 0.596 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 31 cost time: 2.145491600036621
Epoch: 31, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 32 cost time: 1.9574494361877441
Epoch: 32, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 33 cost time: 1.9831759929656982
Epoch: 33, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9355926513671875
Epoch: 34, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.563 Vali Acc: 0.789 Test Loss: 0.563 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 35 cost time: 2.1552133560180664
Epoch: 35, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 36 cost time: 2.122457981109619
Epoch: 36, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.560 Vali Acc: 0.796 Test Loss: 0.560 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.1349546909332275
Epoch: 37, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.2252585887908936
Epoch: 38, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.561 Vali Acc: 0.789 Test Loss: 0.561 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.9982166290283203
Epoch: 39, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.569 Vali Acc: 0.796 Test Loss: 0.569 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.210463523864746
Epoch: 40, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.578 Vali Acc: 0.796 Test Loss: 0.578 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.192192316055298
Epoch: 41, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.582 Vali Acc: 0.796 Test Loss: 0.582 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.3169960975646973
Epoch: 42, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.0814359188079834
Epoch: 43, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.0737972259521484
Epoch: 44, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.580 Vali Acc: 0.803 Test Loss: 0.580 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.1662423610687256
Epoch: 45, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 54372
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9496116638183594
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.515 Vali Acc: 0.112 Test Loss: 1.515 Test Acc: 0.112
Validation loss decreased (inf --> -0.111827).  Saving model ...
Epoch: 2 cost time: 2.3198134899139404
Epoch: 2, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.495 Vali Acc: 0.132 Test Loss: 1.495 Test Acc: 0.132
Validation loss decreased (-0.111827 --> -0.131564).  Saving model ...
Epoch: 3 cost time: 2.0654966831207275
Epoch: 3, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.473 Vali Acc: 0.138 Test Loss: 1.473 Test Acc: 0.138
Validation loss decreased (-0.131564 --> -0.138143).  Saving model ...
Epoch: 4 cost time: 1.9916038513183594
Epoch: 4, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.447 Vali Acc: 0.178 Test Loss: 1.447 Test Acc: 0.178
Validation loss decreased (-0.138143 --> -0.177617).  Saving model ...
Epoch: 5 cost time: 2.067410707473755
Epoch: 5, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.418 Vali Acc: 0.217 Test Loss: 1.418 Test Acc: 0.217
Validation loss decreased (-0.177617 --> -0.217091).  Saving model ...
Epoch: 6 cost time: 1.9892702102661133
Epoch: 6, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.390 Vali Acc: 0.257 Test Loss: 1.390 Test Acc: 0.257
Validation loss decreased (-0.217091 --> -0.256565).  Saving model ...
Epoch: 7 cost time: 1.9392542839050293
Epoch: 7, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.363 Vali Acc: 0.303 Test Loss: 1.363 Test Acc: 0.303
Validation loss decreased (-0.256565 --> -0.302618).  Saving model ...
Epoch: 8 cost time: 2.003120183944702
Epoch: 8, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.331 Vali Acc: 0.322 Test Loss: 1.331 Test Acc: 0.322
Validation loss decreased (-0.302618 --> -0.322355).  Saving model ...
Epoch: 9 cost time: 1.9738328456878662
Epoch: 9, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.301 Vali Acc: 0.408 Test Loss: 1.301 Test Acc: 0.408
Validation loss decreased (-0.322355 --> -0.407882).  Saving model ...
Epoch: 10 cost time: 1.891923427581787
Epoch: 10, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.268 Vali Acc: 0.434 Test Loss: 1.268 Test Acc: 0.434
Validation loss decreased (-0.407882 --> -0.434198).  Saving model ...
Epoch: 11 cost time: 1.9313626289367676
Epoch: 11, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.234 Vali Acc: 0.447 Test Loss: 1.234 Test Acc: 0.447
Validation loss decreased (-0.434198 --> -0.447356).  Saving model ...
Epoch: 12 cost time: 2.091127634048462
Epoch: 12, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.204 Vali Acc: 0.441 Test Loss: 1.204 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9076411724090576
Epoch: 13, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.167 Vali Acc: 0.480 Test Loss: 1.167 Test Acc: 0.480
Validation loss decreased (-0.447356 --> -0.480251).  Saving model ...
Epoch: 14 cost time: 2.179598331451416
Epoch: 14, Steps: 10 | Train Loss: 0.919 Vali Loss: 1.131 Vali Acc: 0.480 Test Loss: 1.131 Test Acc: 0.480
Validation loss decreased (-0.480251 --> -0.480252).  Saving model ...
Epoch: 15 cost time: 2.100663900375366
Epoch: 15, Steps: 10 | Train Loss: 0.854 Vali Loss: 1.095 Vali Acc: 0.493 Test Loss: 1.095 Test Acc: 0.493
Validation loss decreased (-0.480252 --> -0.493410).  Saving model ...
Epoch: 16 cost time: 2.250856876373291
Epoch: 16, Steps: 10 | Train Loss: 0.770 Vali Loss: 1.051 Vali Acc: 0.546 Test Loss: 1.051 Test Acc: 0.546
Validation loss decreased (-0.493410 --> -0.546042).  Saving model ...
Epoch: 17 cost time: 2.208815336227417
Epoch: 17, Steps: 10 | Train Loss: 0.737 Vali Loss: 1.012 Vali Acc: 0.566 Test Loss: 1.012 Test Acc: 0.566
Validation loss decreased (-0.546042 --> -0.565779).  Saving model ...
Epoch: 18 cost time: 2.251706123352051
Epoch: 18, Steps: 10 | Train Loss: 0.659 Vali Loss: 0.974 Vali Acc: 0.579 Test Loss: 0.974 Test Acc: 0.579
Validation loss decreased (-0.565779 --> -0.578938).  Saving model ...
Epoch: 19 cost time: 2.2342052459716797
Epoch: 19, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.935 Vali Acc: 0.605 Test Loss: 0.935 Test Acc: 0.605
Validation loss decreased (-0.578938 --> -0.605254).  Saving model ...
Epoch: 20 cost time: 2.1930594444274902
Epoch: 20, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.898 Vali Acc: 0.625 Test Loss: 0.898 Test Acc: 0.625
Validation loss decreased (-0.605254 --> -0.624991).  Saving model ...
Epoch: 21 cost time: 2.194042205810547
Epoch: 21, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.863 Vali Acc: 0.625 Test Loss: 0.863 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 22 cost time: 2.140702247619629
Epoch: 22, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.828 Vali Acc: 0.638 Test Loss: 0.828 Test Acc: 0.638
Validation loss decreased (-0.624991 --> -0.638150).  Saving model ...
Epoch: 23 cost time: 2.278578042984009
Epoch: 23, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.796 Vali Acc: 0.638 Test Loss: 0.796 Test Acc: 0.638
Validation loss decreased (-0.638150 --> -0.638150).  Saving model ...
Epoch: 24 cost time: 2.135648488998413
Epoch: 24, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.766 Vali Acc: 0.645 Test Loss: 0.766 Test Acc: 0.645
Validation loss decreased (-0.638150 --> -0.644729).  Saving model ...
Epoch: 25 cost time: 1.9432158470153809
Epoch: 25, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.739 Vali Acc: 0.664 Test Loss: 0.739 Test Acc: 0.664
Validation loss decreased (-0.644729 --> -0.664466).  Saving model ...
Epoch: 26 cost time: 1.956617832183838
Epoch: 26, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.710 Vali Acc: 0.697 Test Loss: 0.710 Test Acc: 0.697
Validation loss decreased (-0.664466 --> -0.697361).  Saving model ...
Epoch: 27 cost time: 2.0988821983337402
Epoch: 27, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.684 Vali Acc: 0.737 Test Loss: 0.684 Test Acc: 0.737
Validation loss decreased (-0.697361 --> -0.736835).  Saving model ...
Epoch: 28 cost time: 1.9677789211273193
Epoch: 28, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.662 Vali Acc: 0.724 Test Loss: 0.662 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9446122646331787
Epoch: 29, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 30 cost time: 1.8966515064239502
Epoch: 30, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 31 cost time: 2.0255961418151855
Epoch: 31, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.615 Vali Acc: 0.757 Test Loss: 0.615 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 32 cost time: 2.0882272720336914
Epoch: 32, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.607 Vali Acc: 0.763 Test Loss: 0.607 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 33 cost time: 1.8977110385894775
Epoch: 33, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.600 Vali Acc: 0.757 Test Loss: 0.600 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9184846878051758
Epoch: 34, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.589 Vali Acc: 0.776 Test Loss: 0.589 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 35 cost time: 1.970536708831787
Epoch: 35, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.584 Vali Acc: 0.776 Test Loss: 0.584 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 36 cost time: 2.038173198699951
Epoch: 36, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.577 Vali Acc: 0.776 Test Loss: 0.577 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 37 cost time: 2.1575262546539307
Epoch: 37, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.569 Vali Acc: 0.789 Test Loss: 0.569 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 38 cost time: 2.0884504318237305
Epoch: 38, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.562 Vali Acc: 0.796 Test Loss: 0.562 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 39 cost time: 1.9860379695892334
Epoch: 39, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 40 cost time: 2.1242010593414307
Epoch: 40, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 41 cost time: 2.0990076065063477
Epoch: 41, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 42 cost time: 2.061283826828003
Epoch: 42, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.056666135787964
Epoch: 43, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.9848532676696777
Epoch: 44, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.559 Vali Acc: 0.803 Test Loss: 0.559 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.8966388702392578
Epoch: 45, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.0535454750061035
Epoch: 46, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.01532244682312
Epoch: 47, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.8376305103302002
Epoch: 48, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.877634048461914
Epoch: 49, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.563 Vali Acc: 0.809 Test Loss: 0.563 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.0530622005462646
Epoch: 50, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.0502007007598877
Epoch: 51, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 54372
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.881429672241211
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.457 Vali Acc: 0.230 Test Loss: 1.457 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 2.1899373531341553
Epoch: 2, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.442 Vali Acc: 0.230 Test Loss: 1.442 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 2.396221160888672
Epoch: 3, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.425 Vali Acc: 0.217 Test Loss: 1.425 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3053534030914307
Epoch: 4, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.408 Vali Acc: 0.237 Test Loss: 1.408 Test Acc: 0.237
Validation loss decreased (-0.230249 --> -0.236828).  Saving model ...
Epoch: 5 cost time: 2.2526557445526123
Epoch: 5, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.390 Vali Acc: 0.263 Test Loss: 1.390 Test Acc: 0.263
Validation loss decreased (-0.236828 --> -0.263144).  Saving model ...
Epoch: 6 cost time: 2.2926793098449707
Epoch: 6, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.372 Vali Acc: 0.296 Test Loss: 1.372 Test Acc: 0.296
Validation loss decreased (-0.263144 --> -0.296039).  Saving model ...
Epoch: 7 cost time: 2.1723382472991943
Epoch: 7, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.355 Vali Acc: 0.283 Test Loss: 1.355 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.162104606628418
Epoch: 8, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.338 Vali Acc: 0.329 Test Loss: 1.338 Test Acc: 0.329
Validation loss decreased (-0.296039 --> -0.328934).  Saving model ...
Epoch: 9 cost time: 2.1355130672454834
Epoch: 9, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.316 Vali Acc: 0.349 Test Loss: 1.316 Test Acc: 0.349
Validation loss decreased (-0.328934 --> -0.348671).  Saving model ...
Epoch: 10 cost time: 1.9941051006317139
Epoch: 10, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.294 Vali Acc: 0.382 Test Loss: 1.294 Test Acc: 0.382
Validation loss decreased (-0.348671 --> -0.381566).  Saving model ...
Epoch: 11 cost time: 2.1033761501312256
Epoch: 11, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.265 Vali Acc: 0.414 Test Loss: 1.265 Test Acc: 0.414
Validation loss decreased (-0.381566 --> -0.414461).  Saving model ...
Epoch: 12 cost time: 2.1599280834198
Epoch: 12, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.236 Vali Acc: 0.441 Test Loss: 1.236 Test Acc: 0.441
Validation loss decreased (-0.414461 --> -0.440777).  Saving model ...
Epoch: 13 cost time: 2.106917142868042
Epoch: 13, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.198 Vali Acc: 0.467 Test Loss: 1.198 Test Acc: 0.467
Validation loss decreased (-0.440777 --> -0.467093).  Saving model ...
Epoch: 14 cost time: 2.1172664165496826
Epoch: 14, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.155 Vali Acc: 0.513 Test Loss: 1.155 Test Acc: 0.513
Validation loss decreased (-0.467093 --> -0.513146).  Saving model ...
Epoch: 15 cost time: 2.0062079429626465
Epoch: 15, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
Validation loss decreased (-0.513146 --> -0.532884).  Saving model ...
Epoch: 16 cost time: 2.3115432262420654
Epoch: 16, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.058 Vali Acc: 0.572 Test Loss: 1.058 Test Acc: 0.572
Validation loss decreased (-0.532884 --> -0.572358).  Saving model ...
Epoch: 17 cost time: 2.1146106719970703
Epoch: 17, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.007 Vali Acc: 0.605 Test Loss: 1.007 Test Acc: 0.605
Validation loss decreased (-0.572358 --> -0.605253).  Saving model ...
Epoch: 18 cost time: 2.152117967605591
Epoch: 18, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.953 Vali Acc: 0.625 Test Loss: 0.953 Test Acc: 0.625
Validation loss decreased (-0.605253 --> -0.624990).  Saving model ...
Epoch: 19 cost time: 2.2700440883636475
Epoch: 19, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.891 Vali Acc: 0.671 Test Loss: 0.891 Test Acc: 0.671
Validation loss decreased (-0.624990 --> -0.671044).  Saving model ...
Epoch: 20 cost time: 2.209413766860962
Epoch: 20, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.838 Vali Acc: 0.678 Test Loss: 0.838 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677623).  Saving model ...
Epoch: 21 cost time: 2.187307119369507
Epoch: 21, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.785 Vali Acc: 0.691 Test Loss: 0.785 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690782).  Saving model ...
Epoch: 22 cost time: 2.3574612140655518
Epoch: 22, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.743 Vali Acc: 0.717 Test Loss: 0.743 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 23 cost time: 2.507930040359497
Epoch: 23, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.705 Vali Acc: 0.711 Test Loss: 0.705 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4089832305908203
Epoch: 24, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.678 Vali Acc: 0.737 Test Loss: 0.678 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 25 cost time: 2.1866745948791504
Epoch: 25, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 26 cost time: 2.231701612472534
Epoch: 26, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.641 Vali Acc: 0.717 Test Loss: 0.641 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2166590690612793
Epoch: 27, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.625 Vali Acc: 0.730 Test Loss: 0.625 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.079665184020996
Epoch: 28, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 29 cost time: 2.3586533069610596
Epoch: 29, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 30 cost time: 2.0399019718170166
Epoch: 30, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.591 Vali Acc: 0.743 Test Loss: 0.591 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8904757499694824
Epoch: 31, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.589 Vali Acc: 0.743 Test Loss: 0.589 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1370723247528076
Epoch: 32, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.592 Vali Acc: 0.743 Test Loss: 0.592 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.0295910835266113
Epoch: 33, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.597 Vali Acc: 0.743 Test Loss: 0.597 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.0908281803131104
Epoch: 34, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.2398531436920166
Epoch: 35, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.591 Vali Acc: 0.743 Test Loss: 0.591 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.106171131134033
Epoch: 36, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.588 Vali Acc: 0.743 Test Loss: 0.588 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.9048328399658203
Epoch: 37, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.597 Vali Acc: 0.750 Test Loss: 0.597 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.051753520965576
Epoch: 38, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.236555576324463
Epoch: 39, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.603 Vali Acc: 0.757 Test Loss: 0.603 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 40 cost time: 2.256258010864258
Epoch: 40, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.610 Vali Acc: 0.763 Test Loss: 0.610 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 41 cost time: 2.31447696685791
Epoch: 41, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.613 Vali Acc: 0.763 Test Loss: 0.613 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.389115333557129
Epoch: 42, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.621 Vali Acc: 0.763 Test Loss: 0.621 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.313141107559204
Epoch: 43, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.628 Vali Acc: 0.763 Test Loss: 0.628 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.3932478427886963
Epoch: 44, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.627 Vali Acc: 0.770 Test Loss: 0.627 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 45 cost time: 2.513759136199951
Epoch: 45, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.633 Vali Acc: 0.770 Test Loss: 0.633 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.3754265308380127
Epoch: 46, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.646 Vali Acc: 0.770 Test Loss: 0.646 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.2445380687713623
Epoch: 47, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.654 Vali Acc: 0.770 Test Loss: 0.654 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.9956912994384766
Epoch: 48, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.646 Vali Acc: 0.770 Test Loss: 0.646 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.0703697204589844
Epoch: 49, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.646 Vali Acc: 0.770 Test Loss: 0.646 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.1967265605926514
Epoch: 50, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.661 Vali Acc: 0.770 Test Loss: 0.661 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.1292178630828857
Epoch: 51, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.678 Vali Acc: 0.763 Test Loss: 0.678 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.128194808959961
Epoch: 52, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.688 Vali Acc: 0.763 Test Loss: 0.688 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.1317596435546875
Epoch: 53, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.677 Vali Acc: 0.770 Test Loss: 0.677 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.133543014526367
Epoch: 54, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.677 Vali Acc: 0.776 Test Loss: 0.677 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776309).  Saving model ...
Epoch: 55 cost time: 2.1844873428344727
Epoch: 55, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.685 Vali Acc: 0.776 Test Loss: 0.685 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.2400848865509033
Epoch: 56, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.694 Vali Acc: 0.770 Test Loss: 0.694 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.9938263893127441
Epoch: 57, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.716 Vali Acc: 0.770 Test Loss: 0.716 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.0421993732452393
Epoch: 58, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.725 Vali Acc: 0.770 Test Loss: 0.725 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.25785231590271
Epoch: 59, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.729 Vali Acc: 0.770 Test Loss: 0.729 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.2034738063812256
Epoch: 60, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.727 Vali Acc: 0.770 Test Loss: 0.727 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 2.1995158195495605
Epoch: 61, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.738 Vali Acc: 0.770 Test Loss: 0.738 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.138195753097534
Epoch: 62, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.754 Vali Acc: 0.770 Test Loss: 0.754 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 2.0054659843444824
Epoch: 63, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.743 Vali Acc: 0.770 Test Loss: 0.743 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 2.092278242111206
Epoch: 64, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.747 Vali Acc: 0.770 Test Loss: 0.747 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 54372
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.884648084640503
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.474 Vali Acc: 0.243 Test Loss: 1.474 Test Acc: 0.243
Validation loss decreased (inf --> -0.243406).  Saving model ...
Epoch: 2 cost time: 2.0503592491149902
Epoch: 2, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.460 Vali Acc: 0.250 Test Loss: 1.460 Test Acc: 0.250
Validation loss decreased (-0.243406 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 2.04752779006958
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.443 Vali Acc: 0.250 Test Loss: 1.443 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 2.2632670402526855
Epoch: 4, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.425 Vali Acc: 0.263 Test Loss: 1.425 Test Acc: 0.263
Validation loss decreased (-0.249986 --> -0.263144).  Saving model ...
Epoch: 5 cost time: 1.9243664741516113
Epoch: 5, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.405 Vali Acc: 0.276 Test Loss: 1.405 Test Acc: 0.276
Validation loss decreased (-0.263144 --> -0.276302).  Saving model ...
Epoch: 6 cost time: 2.023141860961914
Epoch: 6, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.384 Vali Acc: 0.283 Test Loss: 1.384 Test Acc: 0.283
Validation loss decreased (-0.276302 --> -0.282881).  Saving model ...
Epoch: 7 cost time: 1.9723691940307617
Epoch: 7, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.365 Vali Acc: 0.309 Test Loss: 1.365 Test Acc: 0.309
Validation loss decreased (-0.282881 --> -0.309197).  Saving model ...
Epoch: 8 cost time: 2.049180269241333
Epoch: 8, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.343 Vali Acc: 0.362 Test Loss: 1.343 Test Acc: 0.362
Validation loss decreased (-0.309197 --> -0.361829).  Saving model ...
Epoch: 9 cost time: 1.9216904640197754
Epoch: 9, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.316 Vali Acc: 0.355 Test Loss: 1.316 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.004621744155884
Epoch: 10, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.289 Vali Acc: 0.382 Test Loss: 1.289 Test Acc: 0.382
Validation loss decreased (-0.361829 --> -0.381566).  Saving model ...
Epoch: 11 cost time: 2.1145033836364746
Epoch: 11, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.255 Vali Acc: 0.414 Test Loss: 1.255 Test Acc: 0.414
Validation loss decreased (-0.381566 --> -0.414461).  Saving model ...
Epoch: 12 cost time: 2.085449457168579
Epoch: 12, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.221 Vali Acc: 0.441 Test Loss: 1.221 Test Acc: 0.441
Validation loss decreased (-0.414461 --> -0.440777).  Saving model ...
Epoch: 13 cost time: 2.242724657058716
Epoch: 13, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.178 Vali Acc: 0.507 Test Loss: 1.178 Test Acc: 0.507
Validation loss decreased (-0.440777 --> -0.506567).  Saving model ...
Epoch: 14 cost time: 2.0372586250305176
Epoch: 14, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.136 Vali Acc: 0.546 Test Loss: 1.136 Test Acc: 0.546
Validation loss decreased (-0.506567 --> -0.546041).  Saving model ...
Epoch: 15 cost time: 2.0397791862487793
Epoch: 15, Steps: 10 | Train Loss: 0.948 Vali Loss: 1.092 Vali Acc: 0.572 Test Loss: 1.092 Test Acc: 0.572
Validation loss decreased (-0.546041 --> -0.572357).  Saving model ...
Epoch: 16 cost time: 2.1861960887908936
Epoch: 16, Steps: 10 | Train Loss: 0.834 Vali Loss: 1.041 Vali Acc: 0.605 Test Loss: 1.041 Test Acc: 0.605
Validation loss decreased (-0.572357 --> -0.605253).  Saving model ...
Epoch: 17 cost time: 2.097731590270996
Epoch: 17, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.993 Vali Acc: 0.625 Test Loss: 0.993 Test Acc: 0.625
Validation loss decreased (-0.605253 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 2.051766872406006
Epoch: 18, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.945 Vali Acc: 0.618 Test Loss: 0.945 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.169154167175293
Epoch: 19, Steps: 10 | Train Loss: 0.651 Vali Loss: 0.890 Vali Acc: 0.658 Test Loss: 0.890 Test Acc: 0.658
Validation loss decreased (-0.624990 --> -0.657886).  Saving model ...
Epoch: 20 cost time: 2.0849897861480713
Epoch: 20, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.839 Vali Acc: 0.678 Test Loss: 0.839 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677623).  Saving model ...
Epoch: 21 cost time: 2.174018144607544
Epoch: 21, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.786 Vali Acc: 0.711 Test Loss: 0.786 Test Acc: 0.711
Validation loss decreased (-0.677623 --> -0.710518).  Saving model ...
Epoch: 22 cost time: 1.947394609451294
Epoch: 22, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.743 Vali Acc: 0.717 Test Loss: 0.743 Test Acc: 0.717
Validation loss decreased (-0.710518 --> -0.717098).  Saving model ...
Epoch: 23 cost time: 2.1159675121307373
Epoch: 23, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.705 Vali Acc: 0.697 Test Loss: 0.705 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.954322099685669
Epoch: 24, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.670 Vali Acc: 0.743 Test Loss: 0.670 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 25 cost time: 2.1515986919403076
Epoch: 25, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.641 Vali Acc: 0.757 Test Loss: 0.641 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 26 cost time: 2.0195858478546143
Epoch: 26, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 2.036468744277954
Epoch: 27, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 28 cost time: 2.0399811267852783
Epoch: 28, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.995401382446289
Epoch: 29, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 30 cost time: 1.9567322731018066
Epoch: 30, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.028005838394165
Epoch: 31, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 32 cost time: 1.9303770065307617
Epoch: 32, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 33 cost time: 2.0563137531280518
Epoch: 33, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 34 cost time: 2.0771546363830566
Epoch: 34, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.0526375770568848
Epoch: 35, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 36 cost time: 2.160883665084839
Epoch: 36, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 37 cost time: 2.2150864601135254
Epoch: 37, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.4050581455230713
Epoch: 38, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 39 cost time: 2.1610913276672363
Epoch: 39, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.141519069671631
Epoch: 40, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.2307288646698
Epoch: 41, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.2060351371765137
Epoch: 42, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.273449659347534
Epoch: 43, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.2426769733428955
Epoch: 44, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.155042886734009
Epoch: 45, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 46 cost time: 2.091047525405884
Epoch: 46, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.111753463745117
Epoch: 47, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.8279128074645996
Epoch: 48, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.8896498680114746
Epoch: 49, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.7704708576202393
Epoch: 50, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.046175003051758
Epoch: 51, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.8514623641967773
Epoch: 52, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 2.0572669506073
Epoch: 53, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 2.0131773948669434
Epoch: 54, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.595 Vali Acc: 0.789 Test Loss: 0.595 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.9841454029083252
Epoch: 55, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 54372
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=15, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
>>>>>>>start training : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.74819278717041
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 2.4155526161193848
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 2.093198537826538
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 4 cost time: 2.3209569454193115
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 5 cost time: 2.296081304550171
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 6 cost time: 2.3040242195129395
Epoch: 6, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 7 cost time: 2.299724578857422
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 8 cost time: 2.1870322227478027
Epoch: 8, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 9 cost time: 2.102342128753662
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 10 cost time: 2.1683170795440674
Epoch: 10, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 11 cost time: 2.1696760654449463
Epoch: 11, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 12 cost time: 2.198272705078125
Epoch: 12, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 13 cost time: 2.164005994796753
Epoch: 13, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.230 Test Loss: 1.388 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 14 cost time: 2.1385130882263184
Epoch: 14, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 15 cost time: 2.117361068725586
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 16 cost time: 2.2282142639160156
Epoch: 16, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 17 cost time: 2.063284158706665
Epoch: 17, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 18 cost time: 2.050663471221924
Epoch: 18, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 19 cost time: 2.1756181716918945
Epoch: 19, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 20 cost time: 2.3094708919525146
Epoch: 20, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 21 cost time: 2.22289776802063
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 22 cost time: 2.2034687995910645
Epoch: 22, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 23 cost time: 2.09724497795105
Epoch: 23, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 24 cost time: 2.210347890853882
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 25 cost time: 2.2494215965270996
Epoch: 25, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (-0.230249 --> -0.230249).  Saving model ...
Epoch: 26 cost time: 2.31455135345459
Epoch: 26, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.230249 --> -0.282881).  Saving model ...
Epoch: 27 cost time: 2.3320934772491455
Epoch: 27, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 28 cost time: 2.310227155685425
Epoch: 28, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 29 cost time: 2.2863857746124268
Epoch: 29, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 30 cost time: 2.2646849155426025
Epoch: 30, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 31 cost time: 2.191566228866577
Epoch: 31, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 32 cost time: 2.162709951400757
Epoch: 32, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 33 cost time: 2.2199811935424805
Epoch: 33, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 34 cost time: 2.23683762550354
Epoch: 34, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 35 cost time: 2.189643144607544
Epoch: 35, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 36 cost time: 2.3245959281921387
Epoch: 36, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.3185319900512695
Epoch: 37, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 38 cost time: 2.4965457916259766
Epoch: 38, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 39 cost time: 2.4378435611724854
Epoch: 39, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 40 cost time: 2.3315207958221436
Epoch: 40, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 41 cost time: 2.335536003112793
Epoch: 41, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 42 cost time: 2.4120895862579346
Epoch: 42, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 43 cost time: 2.1554698944091797
Epoch: 43, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 44 cost time: 2.140692710876465
Epoch: 44, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.1011292934417725
Epoch: 45, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 46 cost time: 2.243152618408203
Epoch: 46, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 47 cost time: 2.1394712924957275
Epoch: 47, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 48 cost time: 2.305957794189453
Epoch: 48, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 49 cost time: 2.1202433109283447
Epoch: 49, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 50 cost time: 2.244000196456909
Epoch: 50, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 51 cost time: 2.090144395828247
Epoch: 51, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 52 cost time: 2.4452192783355713
Epoch: 52, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 53 cost time: 2.1944735050201416
Epoch: 53, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.490497350692749
Epoch: 54, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.2779390811920166
Epoch: 55, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 56 cost time: 2.2172911167144775
Epoch: 56, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 57 cost time: 2.454392433166504
Epoch: 57, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 58 cost time: 2.463059425354004
Epoch: 58, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 59 cost time: 2.3891897201538086
Epoch: 59, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.564192056655884
Epoch: 60, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.3325283527374268
Epoch: 61, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 62 cost time: 2.3115344047546387
Epoch: 62, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 63 cost time: 2.3005893230438232
Epoch: 63, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 64 cost time: 2.4100959300994873
Epoch: 64, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 65 cost time: 2.1702773571014404
Epoch: 65, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 66 cost time: 2.134059190750122
Epoch: 66, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 67 cost time: 2.1280746459960938
Epoch: 67, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.1131443977355957
Epoch: 68, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 69 cost time: 1.9605209827423096
Epoch: 69, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 70 cost time: 1.9902539253234863
Epoch: 70, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 2.1032555103302
Epoch: 71, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 2.027237892150879
Epoch: 72, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 73 cost time: 2.123530149459839
Epoch: 73, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.2096335887908936
Epoch: 74, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 75 cost time: 2.163656234741211
Epoch: 75, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 2.112725257873535
Epoch: 76, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 77 cost time: 2.247882127761841
Epoch: 77, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 78 cost time: 2.148249387741089
Epoch: 78, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 79 cost time: 2.2234137058258057
Epoch: 79, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 80 cost time: 2.435516595840454
Epoch: 80, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (-0.282881 --> -0.282881).  Saving model ...
Epoch: 81 cost time: 2.0989480018615723
Epoch: 81, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 2.087611198425293
Epoch: 82, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 2.2910678386688232
Epoch: 83, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.9944117069244385
Epoch: 84, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 2.2319443225860596
Epoch: 85, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 2.1206862926483154
Epoch: 86, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 2.12117862701416
Epoch: 87, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 2.108093500137329
Epoch: 88, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 2.2032980918884277
Epoch: 89, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 2.143009662628174
Epoch: 90, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_FEDformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.28289473684210525
model parameter : 54372
model size : 1.45MB
