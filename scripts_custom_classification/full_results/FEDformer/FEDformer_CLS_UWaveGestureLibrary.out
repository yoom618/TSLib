Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.820641994476318
Epoch: 1, Steps: 8 | Train Loss: 2.021 Vali Loss: 1.178 Vali Acc: 0.666 Test Loss: 1.178 Test Acc: 0.666
Validation loss decreased (inf --> -0.665613).  Saving model ...
Epoch: 2 cost time: 4.623688697814941
Epoch: 2, Steps: 8 | Train Loss: 0.756 Vali Loss: 0.738 Vali Acc: 0.762 Test Loss: 0.738 Test Acc: 0.762
Validation loss decreased (-0.665613 --> -0.762493).  Saving model ...
Epoch: 3 cost time: 4.655154705047607
Epoch: 3, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.933 Vali Acc: 0.738 Test Loss: 0.933 Test Acc: 0.738
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8679370880126953
Epoch: 4, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.221 Vali Acc: 0.728 Test Loss: 1.221 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.550936460494995
Epoch: 5, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.426 Vali Acc: 0.716 Test Loss: 1.426 Test Acc: 0.716
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.544916868209839
Epoch: 6, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.908 Vali Acc: 0.684 Test Loss: 1.908 Test Acc: 0.684
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.787893772125244
Epoch: 7, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.935 Vali Acc: 0.703 Test Loss: 1.935 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.182091951370239
Epoch: 8, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.670 Vali Acc: 0.750 Test Loss: 1.670 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.080729007720947
Epoch: 9, Steps: 8 | Train Loss: 0.097 Vali Loss: 2.185 Vali Acc: 0.725 Test Loss: 2.185 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.967332363128662
Epoch: 10, Steps: 8 | Train Loss: 0.156 Vali Loss: 2.423 Vali Acc: 0.753 Test Loss: 2.423 Test Acc: 0.753
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.765371084213257
Epoch: 11, Steps: 8 | Train Loss: 0.291 Vali Loss: 2.234 Vali Acc: 0.741 Test Loss: 2.234 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.9018099308013916
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.552 Vali Acc: 0.716 Test Loss: 2.552 Test Acc: 0.716
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7625
model parameter : 18097160
model size : 88.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.599513292312622
Epoch: 1, Steps: 8 | Train Loss: 1.997 Vali Loss: 1.373 Vali Acc: 0.578 Test Loss: 1.373 Test Acc: 0.578
Validation loss decreased (inf --> -0.578111).  Saving model ...
Epoch: 2 cost time: 4.351461887359619
Epoch: 2, Steps: 8 | Train Loss: 0.864 Vali Loss: 1.109 Vali Acc: 0.653 Test Loss: 1.109 Test Acc: 0.653
Validation loss decreased (-0.578111 --> -0.653114).  Saving model ...
Epoch: 3 cost time: 3.9458792209625244
Epoch: 3, Steps: 8 | Train Loss: 0.422 Vali Loss: 1.309 Vali Acc: 0.656 Test Loss: 1.309 Test Acc: 0.656
Validation loss decreased (-0.653114 --> -0.656237).  Saving model ...
Epoch: 4 cost time: 3.2937800884246826
Epoch: 4, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.485 Vali Acc: 0.637 Test Loss: 1.485 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4235005378723145
Epoch: 5, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.794 Vali Acc: 0.647 Test Loss: 1.794 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5695278644561768
Epoch: 6, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.946 Vali Acc: 0.659 Test Loss: 1.946 Test Acc: 0.659
Validation loss decreased (-0.656237 --> -0.659356).  Saving model ...
Epoch: 7 cost time: 3.7483837604522705
Epoch: 7, Steps: 8 | Train Loss: 0.042 Vali Loss: 2.157 Vali Acc: 0.644 Test Loss: 2.157 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.994023561477661
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.288 Vali Acc: 0.653 Test Loss: 2.288 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.387988090515137
Epoch: 9, Steps: 8 | Train Loss: 0.056 Vali Loss: 2.889 Vali Acc: 0.609 Test Loss: 2.889 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.7280004024505615
Epoch: 10, Steps: 8 | Train Loss: 0.071 Vali Loss: 2.528 Vali Acc: 0.669 Test Loss: 2.528 Test Acc: 0.669
Validation loss decreased (-0.659356 --> -0.668725).  Saving model ...
Epoch: 11 cost time: 4.347473621368408
Epoch: 11, Steps: 8 | Train Loss: 0.104 Vali Loss: 2.818 Vali Acc: 0.669 Test Loss: 2.818 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.427513837814331
Epoch: 12, Steps: 8 | Train Loss: 0.098 Vali Loss: 3.906 Vali Acc: 0.644 Test Loss: 3.906 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.532336235046387
Epoch: 13, Steps: 8 | Train Loss: 0.139 Vali Loss: 3.840 Vali Acc: 0.644 Test Loss: 3.840 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.534396409988403
Epoch: 14, Steps: 8 | Train Loss: 0.304 Vali Loss: 3.621 Vali Acc: 0.678 Test Loss: 3.621 Test Acc: 0.678
Validation loss decreased (-0.668725 --> -0.678089).  Saving model ...
Epoch: 15 cost time: 4.241050958633423
Epoch: 15, Steps: 8 | Train Loss: 0.248 Vali Loss: 4.612 Vali Acc: 0.628 Test Loss: 4.612 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3053596019744873
Epoch: 16, Steps: 8 | Train Loss: 0.073 Vali Loss: 3.827 Vali Acc: 0.653 Test Loss: 3.827 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3399524688720703
Epoch: 17, Steps: 8 | Train Loss: 0.189 Vali Loss: 3.782 Vali Acc: 0.653 Test Loss: 3.782 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.5840864181518555
Epoch: 18, Steps: 8 | Train Loss: 0.259 Vali Loss: 6.012 Vali Acc: 0.634 Test Loss: 6.012 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.269408941268921
Epoch: 19, Steps: 8 | Train Loss: 0.214 Vali Loss: 4.879 Vali Acc: 0.637 Test Loss: 4.879 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.997767210006714
Epoch: 20, Steps: 8 | Train Loss: 0.250 Vali Loss: 5.618 Vali Acc: 0.631 Test Loss: 5.618 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.480871677398682
Epoch: 21, Steps: 8 | Train Loss: 0.272 Vali Loss: 5.832 Vali Acc: 0.662 Test Loss: 5.832 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.165440559387207
Epoch: 22, Steps: 8 | Train Loss: 0.560 Vali Loss: 5.972 Vali Acc: 0.656 Test Loss: 5.972 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.48564076423645
Epoch: 23, Steps: 8 | Train Loss: 0.219 Vali Loss: 5.095 Vali Acc: 0.706 Test Loss: 5.095 Test Acc: 0.706
Validation loss decreased (-0.678089 --> -0.706199).  Saving model ...
Epoch: 24 cost time: 4.588732481002808
Epoch: 24, Steps: 8 | Train Loss: 0.125 Vali Loss: 6.780 Vali Acc: 0.662 Test Loss: 6.780 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.49732232093811
Epoch: 25, Steps: 8 | Train Loss: 0.352 Vali Loss: 6.811 Vali Acc: 0.647 Test Loss: 6.811 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.1361753940582275
Epoch: 26, Steps: 8 | Train Loss: 0.142 Vali Loss: 6.488 Vali Acc: 0.681 Test Loss: 6.488 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.190842628479004
Epoch: 27, Steps: 8 | Train Loss: 0.406 Vali Loss: 5.583 Vali Acc: 0.706 Test Loss: 5.583 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.913163185119629
Epoch: 28, Steps: 8 | Train Loss: 0.166 Vali Loss: 7.896 Vali Acc: 0.631 Test Loss: 7.896 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.3426523208618164
Epoch: 29, Steps: 8 | Train Loss: 0.263 Vali Loss: 6.634 Vali Acc: 0.713 Test Loss: 6.634 Test Acc: 0.713
Validation loss decreased (-0.706199 --> -0.712434).  Saving model ...
Epoch: 30 cost time: 3.662061929702759
Epoch: 30, Steps: 8 | Train Loss: 0.205 Vali Loss: 7.446 Vali Acc: 0.659 Test Loss: 7.446 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.7070677280426025
Epoch: 31, Steps: 8 | Train Loss: 0.336 Vali Loss: 8.143 Vali Acc: 0.656 Test Loss: 8.143 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.1154913902282715
Epoch: 32, Steps: 8 | Train Loss: 0.018 Vali Loss: 10.696 Vali Acc: 0.606 Test Loss: 10.696 Test Acc: 0.606
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.039906740188599
Epoch: 33, Steps: 8 | Train Loss: 0.234 Vali Loss: 10.434 Vali Acc: 0.616 Test Loss: 10.434 Test Acc: 0.616
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.187292814254761
Epoch: 34, Steps: 8 | Train Loss: 0.288 Vali Loss: 6.317 Vali Acc: 0.697 Test Loss: 6.317 Test Acc: 0.697
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.35886812210083
Epoch: 35, Steps: 8 | Train Loss: 0.181 Vali Loss: 6.922 Vali Acc: 0.662 Test Loss: 6.922 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.717902660369873
Epoch: 36, Steps: 8 | Train Loss: 0.055 Vali Loss: 8.288 Vali Acc: 0.659 Test Loss: 8.288 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.186481952667236
Epoch: 37, Steps: 8 | Train Loss: 0.074 Vali Loss: 8.964 Vali Acc: 0.650 Test Loss: 8.964 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.838865280151367
Epoch: 38, Steps: 8 | Train Loss: 0.274 Vali Loss: 8.200 Vali Acc: 0.691 Test Loss: 8.200 Test Acc: 0.691
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.257484197616577
Epoch: 39, Steps: 8 | Train Loss: 0.151 Vali Loss: 9.882 Vali Acc: 0.634 Test Loss: 9.882 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7125
model parameter : 18097160
model size : 88.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.376862287521362
Epoch: 1, Steps: 8 | Train Loss: 2.049 Vali Loss: 1.542 Vali Acc: 0.475 Test Loss: 1.542 Test Acc: 0.475
Validation loss decreased (inf --> -0.474985).  Saving model ...
Epoch: 2 cost time: 3.0737998485565186
Epoch: 2, Steps: 8 | Train Loss: 1.046 Vali Loss: 1.325 Vali Acc: 0.581 Test Loss: 1.325 Test Acc: 0.581
Validation loss decreased (-0.474985 --> -0.581237).  Saving model ...
Epoch: 3 cost time: 3.6127278804779053
Epoch: 3, Steps: 8 | Train Loss: 0.547 Vali Loss: 1.192 Vali Acc: 0.622 Test Loss: 1.192 Test Acc: 0.622
Validation loss decreased (-0.581237 --> -0.621863).  Saving model ...
Epoch: 4 cost time: 3.860196113586426
Epoch: 4, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.327 Vali Acc: 0.600 Test Loss: 1.327 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5058748722076416
Epoch: 5, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.518 Vali Acc: 0.603 Test Loss: 1.518 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9333817958831787
Epoch: 6, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.988 Vali Acc: 0.600 Test Loss: 1.988 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.8161556720733643
Epoch: 7, Steps: 8 | Train Loss: 0.047 Vali Loss: 2.293 Vali Acc: 0.616 Test Loss: 2.293 Test Acc: 0.616
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.744427442550659
Epoch: 8, Steps: 8 | Train Loss: 0.096 Vali Loss: 2.082 Vali Acc: 0.672 Test Loss: 2.082 Test Acc: 0.672
Validation loss decreased (-0.621863 --> -0.671854).  Saving model ...
Epoch: 9 cost time: 3.7975316047668457
Epoch: 9, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.234 Vali Acc: 0.672 Test Loss: 2.234 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.787398099899292
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.388 Vali Acc: 0.650 Test Loss: 2.388 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.186584949493408
Epoch: 11, Steps: 8 | Train Loss: 0.011 Vali Loss: 3.243 Vali Acc: 0.609 Test Loss: 3.243 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.311986923217773
Epoch: 12, Steps: 8 | Train Loss: 0.114 Vali Loss: 2.913 Vali Acc: 0.644 Test Loss: 2.913 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.315916299819946
Epoch: 13, Steps: 8 | Train Loss: 0.117 Vali Loss: 2.863 Vali Acc: 0.662 Test Loss: 2.863 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.9113454818725586
Epoch: 14, Steps: 8 | Train Loss: 0.035 Vali Loss: 2.829 Vali Acc: 0.653 Test Loss: 2.829 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3356316089630127
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 2.953 Vali Acc: 0.672 Test Loss: 2.953 Test Acc: 0.672
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.344412326812744
Epoch: 16, Steps: 8 | Train Loss: 0.035 Vali Loss: 3.193 Vali Acc: 0.662 Test Loss: 3.193 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.641179323196411
Epoch: 17, Steps: 8 | Train Loss: 0.076 Vali Loss: 3.561 Vali Acc: 0.656 Test Loss: 3.561 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.093191862106323
Epoch: 18, Steps: 8 | Train Loss: 0.128 Vali Loss: 3.353 Vali Acc: 0.678 Test Loss: 3.353 Test Acc: 0.678
Validation loss decreased (-0.671854 --> -0.678091).  Saving model ...
Epoch: 19 cost time: 3.590353488922119
Epoch: 19, Steps: 8 | Train Loss: 0.023 Vali Loss: 4.792 Vali Acc: 0.622 Test Loss: 4.792 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8834996223449707
Epoch: 20, Steps: 8 | Train Loss: 0.201 Vali Loss: 4.257 Vali Acc: 0.606 Test Loss: 4.257 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.796471357345581
Epoch: 21, Steps: 8 | Train Loss: 0.098 Vali Loss: 4.549 Vali Acc: 0.656 Test Loss: 4.549 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.572077512741089
Epoch: 22, Steps: 8 | Train Loss: 0.196 Vali Loss: 5.458 Vali Acc: 0.609 Test Loss: 5.458 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.045753002166748
Epoch: 23, Steps: 8 | Train Loss: 0.155 Vali Loss: 5.530 Vali Acc: 0.594 Test Loss: 5.530 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.9050896167755127
Epoch: 24, Steps: 8 | Train Loss: 0.500 Vali Loss: 6.062 Vali Acc: 0.606 Test Loss: 6.062 Test Acc: 0.606
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.9760615825653076
Epoch: 25, Steps: 8 | Train Loss: 0.693 Vali Loss: 5.104 Vali Acc: 0.675 Test Loss: 5.104 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.095643997192383
Epoch: 26, Steps: 8 | Train Loss: 0.376 Vali Loss: 4.483 Vali Acc: 0.703 Test Loss: 4.483 Test Acc: 0.703
Validation loss decreased (-0.678091 --> -0.703080).  Saving model ...
Epoch: 27 cost time: 3.7011969089508057
Epoch: 27, Steps: 8 | Train Loss: 0.170 Vali Loss: 4.872 Vali Acc: 0.656 Test Loss: 4.872 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.818091869354248
Epoch: 28, Steps: 8 | Train Loss: 0.059 Vali Loss: 6.305 Vali Acc: 0.622 Test Loss: 6.305 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.992061138153076
Epoch: 29, Steps: 8 | Train Loss: 0.487 Vali Loss: 6.020 Vali Acc: 0.650 Test Loss: 6.020 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.5911693572998047
Epoch: 30, Steps: 8 | Train Loss: 0.081 Vali Loss: 6.602 Vali Acc: 0.653 Test Loss: 6.602 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.263554334640503
Epoch: 31, Steps: 8 | Train Loss: 0.134 Vali Loss: 7.133 Vali Acc: 0.656 Test Loss: 7.133 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.2590973377227783
Epoch: 32, Steps: 8 | Train Loss: 0.105 Vali Loss: 7.204 Vali Acc: 0.653 Test Loss: 7.204 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.878969430923462
Epoch: 33, Steps: 8 | Train Loss: 0.140 Vali Loss: 6.803 Vali Acc: 0.653 Test Loss: 6.803 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.020589113235474
Epoch: 34, Steps: 8 | Train Loss: 0.087 Vali Loss: 6.458 Vali Acc: 0.650 Test Loss: 6.458 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.330823183059692
Epoch: 35, Steps: 8 | Train Loss: 0.040 Vali Loss: 7.929 Vali Acc: 0.606 Test Loss: 7.929 Test Acc: 0.606
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.228515386581421
Epoch: 36, Steps: 8 | Train Loss: 0.310 Vali Loss: 7.862 Vali Acc: 0.634 Test Loss: 7.862 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.703125
model parameter : 18097160
model size : 88.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.326148271560669
Epoch: 1, Steps: 8 | Train Loss: 2.097 Vali Loss: 1.734 Vali Acc: 0.381 Test Loss: 1.734 Test Acc: 0.381
Validation loss decreased (inf --> -0.381233).  Saving model ...
Epoch: 2 cost time: 3.770334482192993
Epoch: 2, Steps: 8 | Train Loss: 1.287 Vali Loss: 1.463 Vali Acc: 0.531 Test Loss: 1.463 Test Acc: 0.531
Validation loss decreased (-0.381233 --> -0.531235).  Saving model ...
Epoch: 3 cost time: 3.279606819152832
Epoch: 3, Steps: 8 | Train Loss: 0.664 Vali Loss: 1.254 Vali Acc: 0.578 Test Loss: 1.254 Test Acc: 0.578
Validation loss decreased (-0.531235 --> -0.578112).  Saving model ...
Epoch: 4 cost time: 3.331711769104004
Epoch: 4, Steps: 8 | Train Loss: 0.344 Vali Loss: 1.577 Vali Acc: 0.534 Test Loss: 1.577 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5636510848999023
Epoch: 5, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.772 Vali Acc: 0.550 Test Loss: 1.772 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6724817752838135
Epoch: 6, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.551 Vali Acc: 0.609 Test Loss: 1.551 Test Acc: 0.609
Validation loss decreased (-0.578112 --> -0.609359).  Saving model ...
Epoch: 7 cost time: 3.632993221282959
Epoch: 7, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.829 Vali Acc: 0.616 Test Loss: 1.829 Test Acc: 0.616
Validation loss decreased (-0.609359 --> -0.615607).  Saving model ...
Epoch: 8 cost time: 4.002337217330933
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 2.162 Vali Acc: 0.556 Test Loss: 2.162 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.401472091674805
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.833 Vali Acc: 0.647 Test Loss: 1.833 Test Acc: 0.647
Validation loss decreased (-0.615607 --> -0.646857).  Saving model ...
Epoch: 10 cost time: 4.154977321624756
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.077 Vali Acc: 0.641 Test Loss: 2.077 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.3760271072387695
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.265 Vali Acc: 0.613 Test Loss: 2.265 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.28136420249939
Epoch: 12, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.428 Vali Acc: 0.613 Test Loss: 2.428 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.077793598175049
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.643 Vali Acc: 0.603 Test Loss: 2.643 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.2606892585754395
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.801 Vali Acc: 0.569 Test Loss: 2.801 Test Acc: 0.569
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.3016557693481445
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 4.103 Vali Acc: 0.519 Test Loss: 4.103 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.0046820640563965
Epoch: 16, Steps: 8 | Train Loss: 0.098 Vali Loss: 4.470 Vali Acc: 0.522 Test Loss: 4.470 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.86098051071167
Epoch: 17, Steps: 8 | Train Loss: 0.213 Vali Loss: 5.547 Vali Acc: 0.516 Test Loss: 5.547 Test Acc: 0.516
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.742703914642334
Epoch: 18, Steps: 8 | Train Loss: 0.288 Vali Loss: 3.207 Vali Acc: 0.606 Test Loss: 3.207 Test Acc: 0.606
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.717397928237915
Epoch: 19, Steps: 8 | Train Loss: 0.477 Vali Loss: 3.992 Vali Acc: 0.588 Test Loss: 3.992 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.646875
model parameter : 18097160
model size : 88.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.396108627319336
Epoch: 1, Steps: 8 | Train Loss: 2.110 Vali Loss: 1.925 Vali Acc: 0.228 Test Loss: 1.925 Test Acc: 0.228
Validation loss decreased (inf --> -0.228106).  Saving model ...
Epoch: 2 cost time: 3.8900959491729736
Epoch: 2, Steps: 8 | Train Loss: 1.502 Vali Loss: 1.688 Vali Acc: 0.397 Test Loss: 1.688 Test Acc: 0.397
Validation loss decreased (-0.228106 --> -0.396858).  Saving model ...
Epoch: 3 cost time: 3.661090850830078
Epoch: 3, Steps: 8 | Train Loss: 0.825 Vali Loss: 1.662 Vali Acc: 0.444 Test Loss: 1.662 Test Acc: 0.444
Validation loss decreased (-0.396858 --> -0.443733).  Saving model ...
Epoch: 4 cost time: 4.2962141036987305
Epoch: 4, Steps: 8 | Train Loss: 0.491 Vali Loss: 2.048 Vali Acc: 0.422 Test Loss: 2.048 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.765930652618408
Epoch: 5, Steps: 8 | Train Loss: 0.319 Vali Loss: 1.935 Vali Acc: 0.475 Test Loss: 1.935 Test Acc: 0.475
Validation loss decreased (-0.443733 --> -0.474981).  Saving model ...
Epoch: 6 cost time: 3.492422580718994
Epoch: 6, Steps: 8 | Train Loss: 0.128 Vali Loss: 2.058 Vali Acc: 0.487 Test Loss: 2.058 Test Acc: 0.487
Validation loss decreased (-0.474981 --> -0.487479).  Saving model ...
Epoch: 7 cost time: 3.5342061519622803
Epoch: 7, Steps: 8 | Train Loss: 0.089 Vali Loss: 2.493 Vali Acc: 0.397 Test Loss: 2.493 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.303835153579712
Epoch: 8, Steps: 8 | Train Loss: 0.062 Vali Loss: 3.091 Vali Acc: 0.431 Test Loss: 3.091 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.819061279296875
Epoch: 9, Steps: 8 | Train Loss: 0.112 Vali Loss: 2.268 Vali Acc: 0.509 Test Loss: 2.268 Test Acc: 0.509
Validation loss decreased (-0.487479 --> -0.509352).  Saving model ...
Epoch: 10 cost time: 3.5586836338043213
Epoch: 10, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.603 Vali Acc: 0.506 Test Loss: 2.603 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3629331588745117
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.971 Vali Acc: 0.469 Test Loss: 2.971 Test Acc: 0.469
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5366334915161133
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 2.199 Vali Acc: 0.575 Test Loss: 2.199 Test Acc: 0.575
Validation loss decreased (-0.509352 --> -0.574978).  Saving model ...
Epoch: 13 cost time: 3.4423842430114746
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 3.043 Vali Acc: 0.503 Test Loss: 3.043 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.375185966491699
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 3.330 Vali Acc: 0.506 Test Loss: 3.330 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8233842849731445
Epoch: 15, Steps: 8 | Train Loss: 0.056 Vali Loss: 2.678 Vali Acc: 0.550 Test Loss: 2.678 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.078541040420532
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 3.820 Vali Acc: 0.506 Test Loss: 3.820 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.9514081478118896
Epoch: 17, Steps: 8 | Train Loss: 0.098 Vali Loss: 4.653 Vali Acc: 0.431 Test Loss: 4.653 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.0130555629730225
Epoch: 18, Steps: 8 | Train Loss: 0.245 Vali Loss: 7.986 Vali Acc: 0.412 Test Loss: 7.986 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.107729434967041
Epoch: 19, Steps: 8 | Train Loss: 0.843 Vali Loss: 3.494 Vali Acc: 0.562 Test Loss: 3.494 Test Acc: 0.562
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.96090030670166
Epoch: 20, Steps: 8 | Train Loss: 0.461 Vali Loss: 5.527 Vali Acc: 0.422 Test Loss: 5.527 Test Acc: 0.422
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.676720142364502
Epoch: 21, Steps: 8 | Train Loss: 0.136 Vali Loss: 4.241 Vali Acc: 0.512 Test Loss: 4.241 Test Acc: 0.512
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.373493194580078
Epoch: 22, Steps: 8 | Train Loss: 0.287 Vali Loss: 5.717 Vali Acc: 0.472 Test Loss: 5.717 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.575
model parameter : 18097160
model size : 88.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.226445913314819
Epoch: 1, Steps: 8 | Train Loss: 2.131 Vali Loss: 1.992 Vali Acc: 0.141 Test Loss: 1.992 Test Acc: 0.141
Validation loss decreased (inf --> -0.140605).  Saving model ...
Epoch: 2 cost time: 3.2404110431671143
Epoch: 2, Steps: 8 | Train Loss: 1.658 Vali Loss: 1.784 Vali Acc: 0.344 Test Loss: 1.784 Test Acc: 0.344
Validation loss decreased (-0.140605 --> -0.343732).  Saving model ...
Epoch: 3 cost time: 3.3653981685638428
Epoch: 3, Steps: 8 | Train Loss: 0.907 Vali Loss: 1.752 Vali Acc: 0.356 Test Loss: 1.752 Test Acc: 0.356
Validation loss decreased (-0.343732 --> -0.356232).  Saving model ...
Epoch: 4 cost time: 3.3731656074523926
Epoch: 4, Steps: 8 | Train Loss: 0.617 Vali Loss: 1.742 Vali Acc: 0.397 Test Loss: 1.742 Test Acc: 0.397
Validation loss decreased (-0.356232 --> -0.396858).  Saving model ...
Epoch: 5 cost time: 3.4849345684051514
Epoch: 5, Steps: 8 | Train Loss: 0.386 Vali Loss: 1.412 Vali Acc: 0.444 Test Loss: 1.412 Test Acc: 0.444
Validation loss decreased (-0.396858 --> -0.443736).  Saving model ...
Epoch: 6 cost time: 3.7961318492889404
Epoch: 6, Steps: 8 | Train Loss: 0.216 Vali Loss: 2.148 Vali Acc: 0.397 Test Loss: 2.148 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.848217248916626
Epoch: 7, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.963 Vali Acc: 0.341 Test Loss: 1.963 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.128254175186157
Epoch: 8, Steps: 8 | Train Loss: 0.073 Vali Loss: 3.562 Vali Acc: 0.269 Test Loss: 3.562 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.060627222061157
Epoch: 9, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.873 Vali Acc: 0.400 Test Loss: 1.873 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.076863527297974
Epoch: 10, Steps: 8 | Train Loss: 0.032 Vali Loss: 2.096 Vali Acc: 0.422 Test Loss: 2.096 Test Acc: 0.422
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.120604991912842
Epoch: 11, Steps: 8 | Train Loss: 0.158 Vali Loss: 4.107 Vali Acc: 0.281 Test Loss: 4.107 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.348320960998535
Epoch: 12, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.999 Vali Acc: 0.509 Test Loss: 1.999 Test Acc: 0.509
Validation loss decreased (-0.443736 --> -0.509355).  Saving model ...
Epoch: 13 cost time: 3.421215295791626
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.723 Vali Acc: 0.388 Test Loss: 2.723 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.628101348876953
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.153 Vali Acc: 0.525 Test Loss: 2.153 Test Acc: 0.525
Validation loss decreased (-0.509355 --> -0.524978).  Saving model ...
Epoch: 15 cost time: 3.454495906829834
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.524 Vali Acc: 0.384 Test Loss: 2.524 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9098010063171387
Epoch: 16, Steps: 8 | Train Loss: 0.035 Vali Loss: 3.462 Vali Acc: 0.397 Test Loss: 3.462 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8216583728790283
Epoch: 17, Steps: 8 | Train Loss: 0.045 Vali Loss: 3.911 Vali Acc: 0.322 Test Loss: 3.911 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.765166997909546
Epoch: 18, Steps: 8 | Train Loss: 0.085 Vali Loss: 3.489 Vali Acc: 0.434 Test Loss: 3.489 Test Acc: 0.434
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.8311986923217773
Epoch: 19, Steps: 8 | Train Loss: 0.053 Vali Loss: 3.181 Vali Acc: 0.434 Test Loss: 3.181 Test Acc: 0.434
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.075032949447632
Epoch: 20, Steps: 8 | Train Loss: 0.058 Vali Loss: 4.268 Vali Acc: 0.325 Test Loss: 4.268 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.0956690311431885
Epoch: 21, Steps: 8 | Train Loss: 0.022 Vali Loss: 2.601 Vali Acc: 0.525 Test Loss: 2.601 Test Acc: 0.525
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.9206907749176025
Epoch: 22, Steps: 8 | Train Loss: 0.152 Vali Loss: 3.581 Vali Acc: 0.469 Test Loss: 3.581 Test Acc: 0.469
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.1718223094940186
Epoch: 23, Steps: 8 | Train Loss: 0.033 Vali Loss: 7.383 Vali Acc: 0.338 Test Loss: 7.383 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.4507579803466797
Epoch: 24, Steps: 8 | Train Loss: 0.022 Vali Loss: 4.936 Vali Acc: 0.372 Test Loss: 4.936 Test Acc: 0.372
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.525
model parameter : 18097160
model size : 88.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.2180140018463135
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 2.014 Vali Acc: 0.169 Test Loss: 2.014 Test Acc: 0.169
Validation loss decreased (inf --> -0.168730).  Saving model ...
Epoch: 2 cost time: 3.622540235519409
Epoch: 2, Steps: 8 | Train Loss: 1.647 Vali Loss: 1.799 Vali Acc: 0.334 Test Loss: 1.799 Test Acc: 0.334
Validation loss decreased (-0.168730 --> -0.334357).  Saving model ...
Epoch: 3 cost time: 3.5911366939544678
Epoch: 3, Steps: 8 | Train Loss: 0.937 Vali Loss: 1.643 Vali Acc: 0.375 Test Loss: 1.643 Test Acc: 0.375
Validation loss decreased (-0.334357 --> -0.374984).  Saving model ...
Epoch: 4 cost time: 3.992035150527954
Epoch: 4, Steps: 8 | Train Loss: 0.551 Vali Loss: 1.474 Vali Acc: 0.441 Test Loss: 1.474 Test Acc: 0.441
Validation loss decreased (-0.374984 --> -0.440610).  Saving model ...
Epoch: 5 cost time: 3.861248254776001
Epoch: 5, Steps: 8 | Train Loss: 0.361 Vali Loss: 1.474 Vali Acc: 0.438 Test Loss: 1.474 Test Acc: 0.438
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.801914930343628
Epoch: 6, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.721 Vali Acc: 0.431 Test Loss: 1.721 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.491445779800415
Epoch: 7, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.958 Vali Acc: 0.325 Test Loss: 1.958 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.474465847015381
Epoch: 8, Steps: 8 | Train Loss: 0.079 Vali Loss: 3.273 Vali Acc: 0.297 Test Loss: 3.273 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.5529062747955322
Epoch: 9, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.781 Vali Acc: 0.447 Test Loss: 1.781 Test Acc: 0.447
Validation loss decreased (-0.440610 --> -0.446857).  Saving model ...
Epoch: 10 cost time: 3.3466224670410156
Epoch: 10, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.461 Vali Acc: 0.491 Test Loss: 1.461 Test Acc: 0.491
Validation loss decreased (-0.446857 --> -0.490610).  Saving model ...
Epoch: 11 cost time: 3.186640501022339
Epoch: 11, Steps: 8 | Train Loss: 0.062 Vali Loss: 3.143 Vali Acc: 0.334 Test Loss: 3.143 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.065703868865967
Epoch: 12, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.664 Vali Acc: 0.484 Test Loss: 1.664 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.072003126144409
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.161 Vali Acc: 0.425 Test Loss: 2.161 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.4692585468292236
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.942 Vali Acc: 0.453 Test Loss: 1.942 Test Acc: 0.453
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.751643419265747
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.392 Vali Acc: 0.584 Test Loss: 1.392 Test Acc: 0.584
Validation loss decreased (-0.490610 --> -0.584361).  Saving model ...
Epoch: 16 cost time: 3.613250255584717
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.663 Vali Acc: 0.422 Test Loss: 2.663 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.006385803222656
Epoch: 17, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.014 Vali Acc: 0.453 Test Loss: 2.014 Test Acc: 0.453
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8920774459838867
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.707 Vali Acc: 0.531 Test Loss: 1.707 Test Acc: 0.531
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6475179195404053
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.005 Vali Acc: 0.500 Test Loss: 2.005 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.812710762023926
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.803 Vali Acc: 0.537 Test Loss: 1.803 Test Acc: 0.537
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.5381577014923096
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.832 Vali Acc: 0.409 Test Loss: 2.832 Test Acc: 0.409
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.2651772499084473
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.454 Vali Acc: 0.441 Test Loss: 2.454 Test Acc: 0.441
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.941119432449341
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.797 Vali Acc: 0.416 Test Loss: 2.797 Test Acc: 0.416
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.6693332195281982
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.350 Vali Acc: 0.447 Test Loss: 2.350 Test Acc: 0.447
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.4623403549194336
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.908 Vali Acc: 0.544 Test Loss: 1.908 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.584375
model parameter : 18097160
model size : 88.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.731470823287964
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 2.030 Vali Acc: 0.194 Test Loss: 2.030 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 3.3491969108581543
Epoch: 2, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.764 Vali Acc: 0.400 Test Loss: 1.764 Test Acc: 0.400
Validation loss decreased (-0.193730 --> -0.399982).  Saving model ...
Epoch: 3 cost time: 3.6862690448760986
Epoch: 3, Steps: 8 | Train Loss: 0.825 Vali Loss: 1.473 Vali Acc: 0.453 Test Loss: 1.473 Test Acc: 0.453
Validation loss decreased (-0.399982 --> -0.453110).  Saving model ...
Epoch: 4 cost time: 3.54378604888916
Epoch: 4, Steps: 8 | Train Loss: 0.437 Vali Loss: 1.350 Vali Acc: 0.531 Test Loss: 1.350 Test Acc: 0.531
Validation loss decreased (-0.453110 --> -0.531237).  Saving model ...
Epoch: 5 cost time: 3.4592597484588623
Epoch: 5, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.357 Vali Acc: 0.466 Test Loss: 1.357 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2015268802642822
Epoch: 6, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.552 Vali Acc: 0.447 Test Loss: 1.552 Test Acc: 0.447
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.910278081893921
Epoch: 7, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.918 Vali Acc: 0.422 Test Loss: 1.918 Test Acc: 0.422
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.896977663040161
Epoch: 8, Steps: 8 | Train Loss: 0.058 Vali Loss: 3.135 Vali Acc: 0.319 Test Loss: 3.135 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.216926336288452
Epoch: 9, Steps: 8 | Train Loss: 0.071 Vali Loss: 2.074 Vali Acc: 0.484 Test Loss: 2.074 Test Acc: 0.484
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.8711259365081787
Epoch: 10, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.976 Vali Acc: 0.497 Test Loss: 1.976 Test Acc: 0.497
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.7449049949645996
Epoch: 11, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.854 Vali Acc: 0.366 Test Loss: 2.854 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.283421277999878
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.417 Vali Acc: 0.478 Test Loss: 2.417 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.334139347076416
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.689 Vali Acc: 0.406 Test Loss: 2.689 Test Acc: 0.406
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.882772445678711
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.574 Vali Acc: 0.403 Test Loss: 2.574 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.53125
model parameter : 18097160
model size : 88.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.971670627593994
Epoch: 1, Steps: 8 | Train Loss: 2.078 Vali Loss: 1.991 Vali Acc: 0.197 Test Loss: 1.991 Test Acc: 0.197
Validation loss decreased (inf --> -0.196855).  Saving model ...
Epoch: 2 cost time: 3.3633296489715576
Epoch: 2, Steps: 8 | Train Loss: 1.599 Vali Loss: 1.455 Vali Acc: 0.481 Test Loss: 1.455 Test Acc: 0.481
Validation loss decreased (-0.196855 --> -0.481235).  Saving model ...
Epoch: 3 cost time: 3.6808364391326904
Epoch: 3, Steps: 8 | Train Loss: 0.873 Vali Loss: 1.232 Vali Acc: 0.559 Test Loss: 1.232 Test Acc: 0.559
Validation loss decreased (-0.481235 --> -0.559363).  Saving model ...
Epoch: 4 cost time: 4.123567581176758
Epoch: 4, Steps: 8 | Train Loss: 0.439 Vali Loss: 1.453 Vali Acc: 0.531 Test Loss: 1.453 Test Acc: 0.531
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8584892749786377
Epoch: 5, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.718 Vali Acc: 0.506 Test Loss: 1.718 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.131205081939697
Epoch: 6, Steps: 8 | Train Loss: 0.162 Vali Loss: 2.550 Vali Acc: 0.403 Test Loss: 2.550 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.026283264160156
Epoch: 7, Steps: 8 | Train Loss: 0.092 Vali Loss: 2.994 Vali Acc: 0.400 Test Loss: 2.994 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.21142315864563
Epoch: 8, Steps: 8 | Train Loss: 0.066 Vali Loss: 3.480 Vali Acc: 0.388 Test Loss: 3.480 Test Acc: 0.388
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.3337597846984863
Epoch: 9, Steps: 8 | Train Loss: 0.038 Vali Loss: 3.932 Vali Acc: 0.397 Test Loss: 3.932 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.6449294090270996
Epoch: 10, Steps: 8 | Train Loss: 0.017 Vali Loss: 3.079 Vali Acc: 0.425 Test Loss: 3.079 Test Acc: 0.425
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.6324033737182617
Epoch: 11, Steps: 8 | Train Loss: 0.034 Vali Loss: 4.039 Vali Acc: 0.375 Test Loss: 4.039 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.6529157161712646
Epoch: 12, Steps: 8 | Train Loss: 0.016 Vali Loss: 3.991 Vali Acc: 0.403 Test Loss: 3.991 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.640423059463501
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 3.867 Vali Acc: 0.406 Test Loss: 3.867 Test Acc: 0.406
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.559375
model parameter : 18097160
model size : 88.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.567965745925903
Epoch: 1, Steps: 8 | Train Loss: 2.173 Vali Loss: 1.964 Vali Acc: 0.303 Test Loss: 1.964 Test Acc: 0.303
Validation loss decreased (inf --> -0.303105).  Saving model ...
Epoch: 2 cost time: 3.551255702972412
Epoch: 2, Steps: 8 | Train Loss: 1.660 Vali Loss: 1.427 Vali Acc: 0.475 Test Loss: 1.427 Test Acc: 0.475
Validation loss decreased (-0.303105 --> -0.474986).  Saving model ...
Epoch: 3 cost time: 3.760321617126465
Epoch: 3, Steps: 8 | Train Loss: 0.982 Vali Loss: 1.333 Vali Acc: 0.478 Test Loss: 1.333 Test Acc: 0.478
Validation loss decreased (-0.474986 --> -0.478112).  Saving model ...
Epoch: 4 cost time: 3.6705121994018555
Epoch: 4, Steps: 8 | Train Loss: 0.521 Vali Loss: 1.651 Vali Acc: 0.491 Test Loss: 1.651 Test Acc: 0.491
Validation loss decreased (-0.478112 --> -0.490608).  Saving model ...
Epoch: 5 cost time: 3.2759029865264893
Epoch: 5, Steps: 8 | Train Loss: 0.310 Vali Loss: 1.960 Vali Acc: 0.466 Test Loss: 1.960 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8289706707000732
Epoch: 6, Steps: 8 | Train Loss: 0.173 Vali Loss: 2.656 Vali Acc: 0.397 Test Loss: 2.656 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.118910551071167
Epoch: 7, Steps: 8 | Train Loss: 0.107 Vali Loss: 3.181 Vali Acc: 0.381 Test Loss: 3.181 Test Acc: 0.381
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.11551308631897
Epoch: 8, Steps: 8 | Train Loss: 0.086 Vali Loss: 3.792 Vali Acc: 0.322 Test Loss: 3.792 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.635982036590576
Epoch: 9, Steps: 8 | Train Loss: 0.056 Vali Loss: 4.255 Vali Acc: 0.322 Test Loss: 4.255 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.0795912742614746
Epoch: 10, Steps: 8 | Train Loss: 0.020 Vali Loss: 3.306 Vali Acc: 0.406 Test Loss: 3.306 Test Acc: 0.406
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.293553352355957
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 4.135 Vali Acc: 0.409 Test Loss: 4.135 Test Acc: 0.409
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.3370447158813477
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 3.937 Vali Acc: 0.459 Test Loss: 3.937 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.794506072998047
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 4.357 Vali Acc: 0.394 Test Loss: 4.357 Test Acc: 0.394
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.019113540649414
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 3.915 Vali Acc: 0.428 Test Loss: 3.915 Test Acc: 0.428
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.490625
model parameter : 18097160
model size : 88.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.540860414505005
Epoch: 1, Steps: 8 | Train Loss: 1.981 Vali Loss: 1.169 Vali Acc: 0.666 Test Loss: 1.169 Test Acc: 0.666
Validation loss decreased (inf --> -0.665613).  Saving model ...
Epoch: 2 cost time: 3.9908440113067627
Epoch: 2, Steps: 8 | Train Loss: 0.707 Vali Loss: 0.910 Vali Acc: 0.709 Test Loss: 0.910 Test Acc: 0.709
Validation loss decreased (-0.665613 --> -0.709366).  Saving model ...
Epoch: 3 cost time: 4.447919845581055
Epoch: 3, Steps: 8 | Train Loss: 0.428 Vali Loss: 1.041 Vali Acc: 0.753 Test Loss: 1.041 Test Acc: 0.753
Validation loss decreased (-0.709366 --> -0.753115).  Saving model ...
Epoch: 4 cost time: 3.774346113204956
Epoch: 4, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.196 Vali Acc: 0.747 Test Loss: 1.196 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.1684229373931885
Epoch: 5, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.330 Vali Acc: 0.725 Test Loss: 1.330 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7511465549468994
Epoch: 6, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.563 Vali Acc: 0.741 Test Loss: 1.563 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.16513991355896
Epoch: 7, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.999 Vali Acc: 0.691 Test Loss: 1.999 Test Acc: 0.691
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.1834716796875
Epoch: 8, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.998 Vali Acc: 0.688 Test Loss: 1.998 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.183803081512451
Epoch: 9, Steps: 8 | Train Loss: 0.076 Vali Loss: 2.354 Vali Acc: 0.738 Test Loss: 2.354 Test Acc: 0.738
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.825653076171875
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 2.239 Vali Acc: 0.694 Test Loss: 2.239 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.35626220703125
Epoch: 11, Steps: 8 | Train Loss: 0.023 Vali Loss: 2.662 Vali Acc: 0.697 Test Loss: 2.662 Test Acc: 0.697
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.427170515060425
Epoch: 12, Steps: 8 | Train Loss: 0.083 Vali Loss: 2.297 Vali Acc: 0.719 Test Loss: 2.297 Test Acc: 0.719
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.7167768478393555
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 2.247 Vali Acc: 0.719 Test Loss: 2.247 Test Acc: 0.719
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.753125
model parameter : 14951432
model size : 76.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.43789267539978
Epoch: 1, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.386 Vali Acc: 0.537 Test Loss: 1.386 Test Acc: 0.537
Validation loss decreased (inf --> -0.537486).  Saving model ...
Epoch: 2 cost time: 4.038895845413208
Epoch: 2, Steps: 8 | Train Loss: 0.810 Vali Loss: 1.122 Vali Acc: 0.644 Test Loss: 1.122 Test Acc: 0.644
Validation loss decreased (-0.537486 --> -0.643739).  Saving model ...
Epoch: 3 cost time: 4.245480298995972
Epoch: 3, Steps: 8 | Train Loss: 0.451 Vali Loss: 1.336 Vali Acc: 0.647 Test Loss: 1.336 Test Acc: 0.647
Validation loss decreased (-0.643739 --> -0.646862).  Saving model ...
Epoch: 4 cost time: 3.974336624145508
Epoch: 4, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.748 Vali Acc: 0.622 Test Loss: 1.748 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5915889739990234
Epoch: 5, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.896 Vali Acc: 0.634 Test Loss: 1.896 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1774091720581055
Epoch: 6, Steps: 8 | Train Loss: 0.307 Vali Loss: 2.712 Vali Acc: 0.597 Test Loss: 2.712 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.1174848079681396
Epoch: 7, Steps: 8 | Train Loss: 0.189 Vali Loss: 2.274 Vali Acc: 0.644 Test Loss: 2.274 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.459213972091675
Epoch: 8, Steps: 8 | Train Loss: 0.112 Vali Loss: 2.138 Vali Acc: 0.666 Test Loss: 2.138 Test Acc: 0.666
Validation loss decreased (-0.646862 --> -0.665604).  Saving model ...
Epoch: 9 cost time: 3.454110860824585
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.411 Vali Acc: 0.666 Test Loss: 2.411 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.461848735809326
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 2.136 Vali Acc: 0.694 Test Loss: 2.136 Test Acc: 0.694
Validation loss decreased (-0.665604 --> -0.693729).  Saving model ...
Epoch: 11 cost time: 3.8290083408355713
Epoch: 11, Steps: 8 | Train Loss: 0.229 Vali Loss: 2.639 Vali Acc: 0.678 Test Loss: 2.639 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.263921499252319
Epoch: 12, Steps: 8 | Train Loss: 0.093 Vali Loss: 2.231 Vali Acc: 0.703 Test Loss: 2.231 Test Acc: 0.703
Validation loss decreased (-0.693729 --> -0.703103).  Saving model ...
Epoch: 13 cost time: 3.301839828491211
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 3.043 Vali Acc: 0.662 Test Loss: 3.043 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1563851833343506
Epoch: 14, Steps: 8 | Train Loss: 0.068 Vali Loss: 3.146 Vali Acc: 0.697 Test Loss: 3.146 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.400144338607788
Epoch: 15, Steps: 8 | Train Loss: 0.054 Vali Loss: 3.316 Vali Acc: 0.675 Test Loss: 3.316 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6580440998077393
Epoch: 16, Steps: 8 | Train Loss: 0.033 Vali Loss: 4.380 Vali Acc: 0.659 Test Loss: 4.380 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.5923233032226562
Epoch: 17, Steps: 8 | Train Loss: 0.096 Vali Loss: 4.303 Vali Acc: 0.669 Test Loss: 4.303 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.463782548904419
Epoch: 18, Steps: 8 | Train Loss: 0.135 Vali Loss: 4.699 Vali Acc: 0.656 Test Loss: 4.699 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.093080043792725
Epoch: 19, Steps: 8 | Train Loss: 0.078 Vali Loss: 5.152 Vali Acc: 0.650 Test Loss: 5.152 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.136685132980347
Epoch: 20, Steps: 8 | Train Loss: 0.404 Vali Loss: 5.137 Vali Acc: 0.656 Test Loss: 5.137 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.9560441970825195
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 4.690 Vali Acc: 0.659 Test Loss: 4.690 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.632854700088501
Epoch: 22, Steps: 8 | Train Loss: 0.029 Vali Loss: 4.617 Vali Acc: 0.694 Test Loss: 4.617 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.703125
model parameter : 14951432
model size : 76.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.172189712524414
Epoch: 1, Steps: 8 | Train Loss: 2.077 Vali Loss: 1.534 Vali Acc: 0.450 Test Loss: 1.534 Test Acc: 0.450
Validation loss decreased (inf --> -0.449985).  Saving model ...
Epoch: 2 cost time: 4.090031385421753
Epoch: 2, Steps: 8 | Train Loss: 0.915 Vali Loss: 1.189 Vali Acc: 0.628 Test Loss: 1.189 Test Acc: 0.628
Validation loss decreased (-0.449985 --> -0.628113).  Saving model ...
Epoch: 3 cost time: 3.816767692565918
Epoch: 3, Steps: 8 | Train Loss: 0.510 Vali Loss: 1.641 Vali Acc: 0.588 Test Loss: 1.641 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9003725051879883
Epoch: 4, Steps: 8 | Train Loss: 0.401 Vali Loss: 1.871 Vali Acc: 0.575 Test Loss: 1.871 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8317508697509766
Epoch: 5, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.752 Vali Acc: 0.619 Test Loss: 1.752 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.920799970626831
Epoch: 6, Steps: 8 | Train Loss: 0.129 Vali Loss: 2.177 Vali Acc: 0.600 Test Loss: 2.177 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.590190887451172
Epoch: 7, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.988 Vali Acc: 0.600 Test Loss: 1.988 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0243451595306396
Epoch: 8, Steps: 8 | Train Loss: 0.118 Vali Loss: 3.215 Vali Acc: 0.534 Test Loss: 3.215 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.4135935306549072
Epoch: 9, Steps: 8 | Train Loss: 0.218 Vali Loss: 2.591 Vali Acc: 0.628 Test Loss: 2.591 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.6202332973480225
Epoch: 10, Steps: 8 | Train Loss: 0.250 Vali Loss: 2.380 Vali Acc: 0.625 Test Loss: 2.380 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.994898557662964
Epoch: 11, Steps: 8 | Train Loss: 0.128 Vali Loss: 3.142 Vali Acc: 0.634 Test Loss: 3.142 Test Acc: 0.634
Validation loss decreased (-0.628113 --> -0.634344).  Saving model ...
Epoch: 12 cost time: 3.7983477115631104
Epoch: 12, Steps: 8 | Train Loss: 0.118 Vali Loss: 3.817 Vali Acc: 0.606 Test Loss: 3.817 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.186748743057251
Epoch: 13, Steps: 8 | Train Loss: 0.115 Vali Loss: 3.087 Vali Acc: 0.619 Test Loss: 3.087 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.517169713973999
Epoch: 14, Steps: 8 | Train Loss: 0.064 Vali Loss: 3.618 Vali Acc: 0.672 Test Loss: 3.618 Test Acc: 0.672
Validation loss decreased (-0.634344 --> -0.671839).  Saving model ...
Epoch: 15 cost time: 3.334474802017212
Epoch: 15, Steps: 8 | Train Loss: 0.178 Vali Loss: 3.568 Vali Acc: 0.650 Test Loss: 3.568 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.527249574661255
Epoch: 16, Steps: 8 | Train Loss: 0.072 Vali Loss: 3.534 Vali Acc: 0.669 Test Loss: 3.534 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.483321189880371
Epoch: 17, Steps: 8 | Train Loss: 0.090 Vali Loss: 3.507 Vali Acc: 0.666 Test Loss: 3.507 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.560927391052246
Epoch: 18, Steps: 8 | Train Loss: 0.083 Vali Loss: 4.445 Vali Acc: 0.619 Test Loss: 4.445 Test Acc: 0.619
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.8186631202697754
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 5.251 Vali Acc: 0.588 Test Loss: 5.251 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.800224781036377
Epoch: 20, Steps: 8 | Train Loss: 0.130 Vali Loss: 4.938 Vali Acc: 0.637 Test Loss: 4.938 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.2416188716888428
Epoch: 21, Steps: 8 | Train Loss: 0.067 Vali Loss: 4.772 Vali Acc: 0.619 Test Loss: 4.772 Test Acc: 0.619
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.1571733951568604
Epoch: 22, Steps: 8 | Train Loss: 0.058 Vali Loss: 5.399 Vali Acc: 0.600 Test Loss: 5.399 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.4336166381835938
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 5.204 Vali Acc: 0.634 Test Loss: 5.204 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.5333445072174072
Epoch: 24, Steps: 8 | Train Loss: 0.029 Vali Loss: 4.804 Vali Acc: 0.631 Test Loss: 4.804 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.671875
model parameter : 14951432
model size : 76.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.635937929153442
Epoch: 1, Steps: 8 | Train Loss: 2.157 Vali Loss: 1.763 Vali Acc: 0.325 Test Loss: 1.763 Test Acc: 0.325
Validation loss decreased (inf --> -0.324982).  Saving model ...
Epoch: 2 cost time: 3.3952412605285645
Epoch: 2, Steps: 8 | Train Loss: 1.184 Vali Loss: 1.347 Vali Acc: 0.537 Test Loss: 1.347 Test Acc: 0.537
Validation loss decreased (-0.324982 --> -0.537487).  Saving model ...
Epoch: 3 cost time: 3.6896233558654785
Epoch: 3, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.782 Vali Acc: 0.522 Test Loss: 1.782 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.946016311645508
Epoch: 4, Steps: 8 | Train Loss: 0.459 Vali Loss: 1.330 Vali Acc: 0.575 Test Loss: 1.330 Test Acc: 0.575
Validation loss decreased (-0.537487 --> -0.574987).  Saving model ...
Epoch: 5 cost time: 3.7959983348846436
Epoch: 5, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.595 Vali Acc: 0.603 Test Loss: 1.595 Test Acc: 0.603
Validation loss decreased (-0.574987 --> -0.603109).  Saving model ...
Epoch: 6 cost time: 3.828993320465088
Epoch: 6, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.795 Vali Acc: 0.544 Test Loss: 1.795 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9484052658081055
Epoch: 7, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.931 Vali Acc: 0.603 Test Loss: 1.931 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6239612102508545
Epoch: 8, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.656 Vali Acc: 0.672 Test Loss: 1.656 Test Acc: 0.672
Validation loss decreased (-0.603109 --> -0.671858).  Saving model ...
Epoch: 9 cost time: 3.769016742706299
Epoch: 9, Steps: 8 | Train Loss: 0.043 Vali Loss: 2.421 Vali Acc: 0.566 Test Loss: 2.421 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.126169204711914
Epoch: 10, Steps: 8 | Train Loss: 0.060 Vali Loss: 2.600 Vali Acc: 0.613 Test Loss: 2.600 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1081652641296387
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.326 Vali Acc: 0.606 Test Loss: 2.326 Test Acc: 0.606
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0376548767089844
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.649 Vali Acc: 0.606 Test Loss: 2.649 Test Acc: 0.606
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.575082540512085
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.453 Vali Acc: 0.628 Test Loss: 2.453 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.5822489261627197
Epoch: 14, Steps: 8 | Train Loss: 0.130 Vali Loss: 3.419 Vali Acc: 0.581 Test Loss: 3.419 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.351400852203369
Epoch: 15, Steps: 8 | Train Loss: 0.084 Vali Loss: 4.181 Vali Acc: 0.569 Test Loss: 4.181 Test Acc: 0.569
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.3405022621154785
Epoch: 16, Steps: 8 | Train Loss: 0.028 Vali Loss: 3.633 Vali Acc: 0.631 Test Loss: 3.633 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.524991989135742
Epoch: 17, Steps: 8 | Train Loss: 0.058 Vali Loss: 3.853 Vali Acc: 0.619 Test Loss: 3.853 Test Acc: 0.619
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.824847459793091
Epoch: 18, Steps: 8 | Train Loss: 0.058 Vali Loss: 3.856 Vali Acc: 0.616 Test Loss: 3.856 Test Acc: 0.616
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.671875
model parameter : 14951432
model size : 76.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.806839227676392
Epoch: 1, Steps: 8 | Train Loss: 2.190 Vali Loss: 1.925 Vali Acc: 0.275 Test Loss: 1.925 Test Acc: 0.275
Validation loss decreased (inf --> -0.274981).  Saving model ...
Epoch: 2 cost time: 3.4895622730255127
Epoch: 2, Steps: 8 | Train Loss: 1.436 Vali Loss: 1.544 Vali Acc: 0.456 Test Loss: 1.544 Test Acc: 0.456
Validation loss decreased (-0.274981 --> -0.456235).  Saving model ...
Epoch: 3 cost time: 3.7304136753082275
Epoch: 3, Steps: 8 | Train Loss: 0.775 Vali Loss: 1.921 Vali Acc: 0.406 Test Loss: 1.921 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.629580020904541
Epoch: 4, Steps: 8 | Train Loss: 0.542 Vali Loss: 1.766 Vali Acc: 0.412 Test Loss: 1.766 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.391324996948242
Epoch: 5, Steps: 8 | Train Loss: 0.283 Vali Loss: 2.081 Vali Acc: 0.428 Test Loss: 2.081 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.401641607284546
Epoch: 6, Steps: 8 | Train Loss: 0.165 Vali Loss: 2.738 Vali Acc: 0.362 Test Loss: 2.738 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.4757091999053955
Epoch: 7, Steps: 8 | Train Loss: 0.117 Vali Loss: 2.573 Vali Acc: 0.453 Test Loss: 2.573 Test Acc: 0.453
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1653525829315186
Epoch: 8, Steps: 8 | Train Loss: 0.127 Vali Loss: 2.716 Vali Acc: 0.403 Test Loss: 2.716 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.44408917427063
Epoch: 9, Steps: 8 | Train Loss: 0.046 Vali Loss: 3.531 Vali Acc: 0.366 Test Loss: 3.531 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3408043384552
Epoch: 10, Steps: 8 | Train Loss: 0.100 Vali Loss: 3.040 Vali Acc: 0.459 Test Loss: 3.040 Test Acc: 0.459
Validation loss decreased (-0.456235 --> -0.459345).  Saving model ...
Epoch: 11 cost time: 3.4843149185180664
Epoch: 11, Steps: 8 | Train Loss: 0.113 Vali Loss: 4.270 Vali Acc: 0.359 Test Loss: 4.270 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9034688472747803
Epoch: 12, Steps: 8 | Train Loss: 0.077 Vali Loss: 2.305 Vali Acc: 0.531 Test Loss: 2.305 Test Acc: 0.531
Validation loss decreased (-0.459345 --> -0.531227).  Saving model ...
Epoch: 13 cost time: 3.636709690093994
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 3.269 Vali Acc: 0.481 Test Loss: 3.269 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.904606580734253
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 3.498 Vali Acc: 0.409 Test Loss: 3.498 Test Acc: 0.409
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3573479652404785
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 3.053 Vali Acc: 0.491 Test Loss: 3.053 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.5305676460266113
Epoch: 16, Steps: 8 | Train Loss: 0.090 Vali Loss: 3.715 Vali Acc: 0.487 Test Loss: 3.715 Test Acc: 0.487
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.464134454727173
Epoch: 17, Steps: 8 | Train Loss: 0.036 Vali Loss: 3.775 Vali Acc: 0.475 Test Loss: 3.775 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.6249353885650635
Epoch: 18, Steps: 8 | Train Loss: 0.108 Vali Loss: 4.617 Vali Acc: 0.487 Test Loss: 4.617 Test Acc: 0.487
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.647648334503174
Epoch: 19, Steps: 8 | Train Loss: 0.165 Vali Loss: 4.079 Vali Acc: 0.475 Test Loss: 4.079 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.6875457763671875
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 3.397 Vali Acc: 0.559 Test Loss: 3.397 Test Acc: 0.559
Validation loss decreased (-0.531227 --> -0.559341).  Saving model ...
Epoch: 21 cost time: 3.5962796211242676
Epoch: 21, Steps: 8 | Train Loss: 0.137 Vali Loss: 5.276 Vali Acc: 0.466 Test Loss: 5.276 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.366896390914917
Epoch: 22, Steps: 8 | Train Loss: 0.132 Vali Loss: 5.945 Vali Acc: 0.484 Test Loss: 5.945 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.185626983642578
Epoch: 23, Steps: 8 | Train Loss: 0.155 Vali Loss: 5.100 Vali Acc: 0.469 Test Loss: 5.100 Test Acc: 0.469
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.504861354827881
Epoch: 24, Steps: 8 | Train Loss: 0.097 Vali Loss: 4.031 Vali Acc: 0.559 Test Loss: 4.031 Test Acc: 0.559
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.459181070327759
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 5.012 Vali Acc: 0.519 Test Loss: 5.012 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.644284248352051
Epoch: 26, Steps: 8 | Train Loss: 0.095 Vali Loss: 4.285 Vali Acc: 0.556 Test Loss: 4.285 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.2687690258026123
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 9.201 Vali Acc: 0.397 Test Loss: 9.201 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.8945350646972656
Epoch: 28, Steps: 8 | Train Loss: 0.308 Vali Loss: 5.619 Vali Acc: 0.497 Test Loss: 5.619 Test Acc: 0.497
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.3487601280212402
Epoch: 29, Steps: 8 | Train Loss: 0.083 Vali Loss: 5.538 Vali Acc: 0.475 Test Loss: 5.538 Test Acc: 0.475
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.9410619735717773
Epoch: 30, Steps: 8 | Train Loss: 0.022 Vali Loss: 4.394 Vali Acc: 0.544 Test Loss: 4.394 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.559375
model parameter : 14951432
model size : 76.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.348758697509766
Epoch: 1, Steps: 8 | Train Loss: 2.128 Vali Loss: 1.988 Vali Acc: 0.200 Test Loss: 1.988 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 3.397942543029785
Epoch: 2, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.767 Vali Acc: 0.356 Test Loss: 1.767 Test Acc: 0.356
Validation loss decreased (-0.199980 --> -0.356232).  Saving model ...
Epoch: 3 cost time: 3.5124926567077637
Epoch: 3, Steps: 8 | Train Loss: 0.901 Vali Loss: 1.987 Vali Acc: 0.344 Test Loss: 1.987 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5817322731018066
Epoch: 4, Steps: 8 | Train Loss: 0.632 Vali Loss: 1.909 Vali Acc: 0.331 Test Loss: 1.909 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5999343395233154
Epoch: 5, Steps: 8 | Train Loss: 0.375 Vali Loss: 2.033 Vali Acc: 0.362 Test Loss: 2.033 Test Acc: 0.362
Validation loss decreased (-0.356232 --> -0.362480).  Saving model ...
Epoch: 6 cost time: 3.7993526458740234
Epoch: 6, Steps: 8 | Train Loss: 0.254 Vali Loss: 2.375 Vali Acc: 0.256 Test Loss: 2.375 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.281137228012085
Epoch: 7, Steps: 8 | Train Loss: 0.143 Vali Loss: 2.019 Vali Acc: 0.428 Test Loss: 2.019 Test Acc: 0.428
Validation loss decreased (-0.362480 --> -0.428105).  Saving model ...
Epoch: 8 cost time: 3.4972500801086426
Epoch: 8, Steps: 8 | Train Loss: 0.101 Vali Loss: 2.289 Vali Acc: 0.344 Test Loss: 2.289 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3403491973876953
Epoch: 9, Steps: 8 | Train Loss: 0.044 Vali Loss: 2.763 Vali Acc: 0.347 Test Loss: 2.763 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5799736976623535
Epoch: 10, Steps: 8 | Train Loss: 0.047 Vali Loss: 2.248 Vali Acc: 0.409 Test Loss: 2.248 Test Acc: 0.409
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2342138290405273
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 2.635 Vali Acc: 0.419 Test Loss: 2.635 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.537482976913452
Epoch: 12, Steps: 8 | Train Loss: 0.039 Vali Loss: 2.145 Vali Acc: 0.531 Test Loss: 2.145 Test Acc: 0.531
Validation loss decreased (-0.428105 --> -0.531229).  Saving model ...
Epoch: 13 cost time: 3.747497320175171
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.050 Vali Acc: 0.500 Test Loss: 2.050 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5859439373016357
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.612 Vali Acc: 0.412 Test Loss: 2.612 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8199291229248047
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.454 Vali Acc: 0.478 Test Loss: 2.454 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8546667098999023
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 3.270 Vali Acc: 0.362 Test Loss: 3.270 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.0282490253448486
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 3.241 Vali Acc: 0.397 Test Loss: 3.241 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.347386360168457
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.272 Vali Acc: 0.512 Test Loss: 2.272 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.0110809803009033
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 3.173 Vali Acc: 0.350 Test Loss: 3.173 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.180011749267578
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 3.230 Vali Acc: 0.419 Test Loss: 3.230 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.527435302734375
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 3.422 Vali Acc: 0.359 Test Loss: 3.422 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.606275796890259
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 3.098 Vali Acc: 0.416 Test Loss: 3.098 Test Acc: 0.416
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.53125
model parameter : 14951432
model size : 76.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.296970367431641
Epoch: 1, Steps: 8 | Train Loss: 2.133 Vali Loss: 1.999 Vali Acc: 0.188 Test Loss: 1.999 Test Acc: 0.188
Validation loss decreased (inf --> -0.187480).  Saving model ...
Epoch: 2 cost time: 3.79276180267334
Epoch: 2, Steps: 8 | Train Loss: 1.599 Vali Loss: 1.814 Vali Acc: 0.341 Test Loss: 1.814 Test Acc: 0.341
Validation loss decreased (-0.187480 --> -0.340607).  Saving model ...
Epoch: 3 cost time: 3.6629226207733154
Epoch: 3, Steps: 8 | Train Loss: 0.897 Vali Loss: 1.764 Vali Acc: 0.328 Test Loss: 1.764 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8349592685699463
Epoch: 4, Steps: 8 | Train Loss: 0.609 Vali Loss: 1.690 Vali Acc: 0.341 Test Loss: 1.690 Test Acc: 0.341
Validation loss decreased (-0.340607 --> -0.340608).  Saving model ...
Epoch: 5 cost time: 3.4649362564086914
Epoch: 5, Steps: 8 | Train Loss: 0.397 Vali Loss: 1.730 Vali Acc: 0.381 Test Loss: 1.730 Test Acc: 0.381
Validation loss decreased (-0.340608 --> -0.381233).  Saving model ...
Epoch: 6 cost time: 3.2644119262695312
Epoch: 6, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.619 Vali Acc: 0.375 Test Loss: 1.619 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.974440813064575
Epoch: 7, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.795 Vali Acc: 0.438 Test Loss: 1.795 Test Acc: 0.438
Validation loss decreased (-0.381233 --> -0.437482).  Saving model ...
Epoch: 8 cost time: 3.1919589042663574
Epoch: 8, Steps: 8 | Train Loss: 0.125 Vali Loss: 2.189 Vali Acc: 0.372 Test Loss: 2.189 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.13533353805542
Epoch: 9, Steps: 8 | Train Loss: 0.060 Vali Loss: 2.368 Vali Acc: 0.334 Test Loss: 2.368 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.55281925201416
Epoch: 10, Steps: 8 | Train Loss: 0.066 Vali Loss: 2.061 Vali Acc: 0.362 Test Loss: 2.061 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.624804735183716
Epoch: 11, Steps: 8 | Train Loss: 0.019 Vali Loss: 3.096 Vali Acc: 0.291 Test Loss: 3.096 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.6110875606536865
Epoch: 12, Steps: 8 | Train Loss: 0.066 Vali Loss: 2.084 Vali Acc: 0.412 Test Loss: 2.084 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.759326934814453
Epoch: 13, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.772 Vali Acc: 0.459 Test Loss: 1.772 Test Acc: 0.459
Validation loss decreased (-0.437482 --> -0.459357).  Saving model ...
Epoch: 14 cost time: 3.811593532562256
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 4.136 Vali Acc: 0.281 Test Loss: 4.136 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.662245512008667
Epoch: 15, Steps: 8 | Train Loss: 0.036 Vali Loss: 2.223 Vali Acc: 0.459 Test Loss: 2.223 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.561411142349243
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 5.096 Vali Acc: 0.253 Test Loss: 5.096 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.7464423179626465
Epoch: 17, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.991 Vali Acc: 0.491 Test Loss: 1.991 Test Acc: 0.491
Validation loss decreased (-0.459357 --> -0.490605).  Saving model ...
Epoch: 18 cost time: 3.5184285640716553
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.251 Vali Acc: 0.475 Test Loss: 2.251 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.249762535095215
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.768 Vali Acc: 0.384 Test Loss: 2.768 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.199643135070801
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 4.308 Vali Acc: 0.297 Test Loss: 4.308 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.129248857498169
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 3.327 Vali Acc: 0.350 Test Loss: 3.327 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.3305063247680664
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.672 Vali Acc: 0.403 Test Loss: 2.672 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.474186420440674
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.631 Vali Acc: 0.406 Test Loss: 2.631 Test Acc: 0.406
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.739022731781006
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.581 Vali Acc: 0.419 Test Loss: 2.581 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.754885673522949
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.683 Vali Acc: 0.384 Test Loss: 2.683 Test Acc: 0.384
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.381970167160034
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.621 Vali Acc: 0.403 Test Loss: 2.621 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.1962389945983887
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 3.464 Vali Acc: 0.369 Test Loss: 3.464 Test Acc: 0.369
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.490625
model parameter : 14951432
model size : 76.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.1060638427734375
Epoch: 1, Steps: 8 | Train Loss: 2.114 Vali Loss: 2.010 Vali Acc: 0.178 Test Loss: 2.010 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 3.759591817855835
Epoch: 2, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.737 Vali Acc: 0.362 Test Loss: 1.737 Test Acc: 0.362
Validation loss decreased (-0.178105 --> -0.362483).  Saving model ...
Epoch: 3 cost time: 3.5823557376861572
Epoch: 3, Steps: 8 | Train Loss: 0.832 Vali Loss: 1.549 Vali Acc: 0.444 Test Loss: 1.549 Test Acc: 0.444
Validation loss decreased (-0.362483 --> -0.443735).  Saving model ...
Epoch: 4 cost time: 3.3093390464782715
Epoch: 4, Steps: 8 | Train Loss: 0.526 Vali Loss: 1.411 Vali Acc: 0.384 Test Loss: 1.411 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.523268461227417
Epoch: 5, Steps: 8 | Train Loss: 0.310 Vali Loss: 1.527 Vali Acc: 0.487 Test Loss: 1.527 Test Acc: 0.487
Validation loss decreased (-0.443735 --> -0.487485).  Saving model ...
Epoch: 6 cost time: 3.3171803951263428
Epoch: 6, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.655 Vali Acc: 0.438 Test Loss: 1.655 Test Acc: 0.438
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1446340084075928
Epoch: 7, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.886 Vali Acc: 0.450 Test Loss: 1.886 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.016331911087036
Epoch: 8, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.938 Vali Acc: 0.438 Test Loss: 1.938 Test Acc: 0.438
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0069332122802734
Epoch: 9, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.939 Vali Acc: 0.463 Test Loss: 1.939 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8999202251434326
Epoch: 10, Steps: 8 | Train Loss: 0.028 Vali Loss: 2.941 Vali Acc: 0.353 Test Loss: 2.941 Test Acc: 0.353
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4622888565063477
Epoch: 11, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.742 Vali Acc: 0.391 Test Loss: 2.742 Test Acc: 0.391
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.806626081466675
Epoch: 12, Steps: 8 | Train Loss: 0.011 Vali Loss: 3.283 Vali Acc: 0.353 Test Loss: 3.283 Test Acc: 0.353
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.495711088180542
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.509 Vali Acc: 0.453 Test Loss: 2.509 Test Acc: 0.453
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.398371458053589
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.442 Vali Acc: 0.447 Test Loss: 2.442 Test Acc: 0.447
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.3034050464630127
Epoch: 15, Steps: 8 | Train Loss: 0.085 Vali Loss: 3.086 Vali Acc: 0.422 Test Loss: 3.086 Test Acc: 0.422
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.4875
model parameter : 14951432
model size : 76.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.968471050262451
Epoch: 1, Steps: 8 | Train Loss: 2.128 Vali Loss: 1.998 Vali Acc: 0.194 Test Loss: 1.998 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 3.1650145053863525
Epoch: 2, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.465 Vali Acc: 0.491 Test Loss: 1.465 Test Acc: 0.491
Validation loss decreased (-0.193730 --> -0.490610).  Saving model ...
Epoch: 3 cost time: 3.039703607559204
Epoch: 3, Steps: 8 | Train Loss: 0.921 Vali Loss: 1.267 Vali Acc: 0.578 Test Loss: 1.267 Test Acc: 0.578
Validation loss decreased (-0.490610 --> -0.578112).  Saving model ...
Epoch: 4 cost time: 2.8749732971191406
Epoch: 4, Steps: 8 | Train Loss: 0.544 Vali Loss: 1.737 Vali Acc: 0.450 Test Loss: 1.737 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.952920913696289
Epoch: 5, Steps: 8 | Train Loss: 0.297 Vali Loss: 2.169 Vali Acc: 0.472 Test Loss: 2.169 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.203476667404175
Epoch: 6, Steps: 8 | Train Loss: 0.181 Vali Loss: 2.564 Vali Acc: 0.400 Test Loss: 2.564 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.325228214263916
Epoch: 7, Steps: 8 | Train Loss: 0.089 Vali Loss: 2.978 Vali Acc: 0.394 Test Loss: 2.978 Test Acc: 0.394
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.936281204223633
Epoch: 8, Steps: 8 | Train Loss: 0.100 Vali Loss: 3.454 Vali Acc: 0.362 Test Loss: 3.454 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.573585271835327
Epoch: 9, Steps: 8 | Train Loss: 0.049 Vali Loss: 2.903 Vali Acc: 0.394 Test Loss: 2.903 Test Acc: 0.394
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.7747721672058105
Epoch: 10, Steps: 8 | Train Loss: 0.021 Vali Loss: 5.016 Vali Acc: 0.319 Test Loss: 5.016 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.817195415496826
Epoch: 11, Steps: 8 | Train Loss: 0.012 Vali Loss: 4.710 Vali Acc: 0.341 Test Loss: 4.710 Test Acc: 0.341
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.612781047821045
Epoch: 12, Steps: 8 | Train Loss: 0.019 Vali Loss: 5.128 Vali Acc: 0.350 Test Loss: 5.128 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.2232913970947266
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 4.393 Vali Acc: 0.388 Test Loss: 4.393 Test Acc: 0.388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.578125
model parameter : 14951432
model size : 76.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.480328321456909
Epoch: 1, Steps: 8 | Train Loss: 2.149 Vali Loss: 1.943 Vali Acc: 0.266 Test Loss: 1.943 Test Acc: 0.266
Validation loss decreased (inf --> -0.265606).  Saving model ...
Epoch: 2 cost time: 3.3448290824890137
Epoch: 2, Steps: 8 | Train Loss: 1.714 Vali Loss: 1.356 Vali Acc: 0.562 Test Loss: 1.356 Test Acc: 0.562
Validation loss decreased (-0.265606 --> -0.562486).  Saving model ...
Epoch: 3 cost time: 3.206735134124756
Epoch: 3, Steps: 8 | Train Loss: 1.030 Vali Loss: 1.401 Vali Acc: 0.512 Test Loss: 1.401 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.702547550201416
Epoch: 4, Steps: 8 | Train Loss: 0.540 Vali Loss: 1.910 Vali Acc: 0.406 Test Loss: 1.910 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9380722045898438
Epoch: 5, Steps: 8 | Train Loss: 0.350 Vali Loss: 2.374 Vali Acc: 0.431 Test Loss: 2.374 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0764365196228027
Epoch: 6, Steps: 8 | Train Loss: 0.227 Vali Loss: 2.872 Vali Acc: 0.375 Test Loss: 2.872 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.488892078399658
Epoch: 7, Steps: 8 | Train Loss: 0.124 Vali Loss: 3.317 Vali Acc: 0.353 Test Loss: 3.317 Test Acc: 0.353
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.3480517864227295
Epoch: 8, Steps: 8 | Train Loss: 0.099 Vali Loss: 3.688 Vali Acc: 0.338 Test Loss: 3.688 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.8373193740844727
Epoch: 9, Steps: 8 | Train Loss: 0.048 Vali Loss: 3.430 Vali Acc: 0.375 Test Loss: 3.430 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1449804306030273
Epoch: 10, Steps: 8 | Train Loss: 0.042 Vali Loss: 3.833 Vali Acc: 0.359 Test Loss: 3.833 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.6740474700927734
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 4.190 Vali Acc: 0.356 Test Loss: 4.190 Test Acc: 0.356
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.5800790786743164
Epoch: 12, Steps: 8 | Train Loss: 0.016 Vali Loss: 4.134 Vali Acc: 0.381 Test Loss: 4.134 Test Acc: 0.381
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5625
model parameter : 14951432
model size : 76.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.0782036781311035
Epoch: 1, Steps: 8 | Train Loss: 1.975 Vali Loss: 1.252 Vali Acc: 0.619 Test Loss: 1.252 Test Acc: 0.619
Validation loss decreased (inf --> -0.618737).  Saving model ...
Epoch: 2 cost time: 3.6510627269744873
Epoch: 2, Steps: 8 | Train Loss: 0.798 Vali Loss: 0.831 Vali Acc: 0.741 Test Loss: 0.831 Test Acc: 0.741
Validation loss decreased (-0.618737 --> -0.740617).  Saving model ...
Epoch: 3 cost time: 3.47066068649292
Epoch: 3, Steps: 8 | Train Loss: 0.317 Vali Loss: 1.009 Vali Acc: 0.713 Test Loss: 1.009 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7114343643188477
Epoch: 4, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.346 Vali Acc: 0.694 Test Loss: 1.346 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9065020084381104
Epoch: 5, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.606 Vali Acc: 0.709 Test Loss: 1.606 Test Acc: 0.709
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.5261240005493164
Epoch: 6, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.488 Vali Acc: 0.734 Test Loss: 1.488 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.270145893096924
Epoch: 7, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.690 Vali Acc: 0.731 Test Loss: 1.690 Test Acc: 0.731
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.626164674758911
Epoch: 8, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.819 Vali Acc: 0.747 Test Loss: 1.819 Test Acc: 0.747
Validation loss decreased (-0.740617 --> -0.746857).  Saving model ...
Epoch: 9 cost time: 3.408355951309204
Epoch: 9, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.229 Vali Acc: 0.706 Test Loss: 2.229 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.000016450881958
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 2.580 Vali Acc: 0.688 Test Loss: 2.580 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0755984783172607
Epoch: 11, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.330 Vali Acc: 0.678 Test Loss: 2.330 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8927366733551025
Epoch: 12, Steps: 8 | Train Loss: 0.073 Vali Loss: 2.479 Vali Acc: 0.697 Test Loss: 2.479 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.8968420028686523
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.524 Vali Acc: 0.719 Test Loss: 2.524 Test Acc: 0.719
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.8938262462615967
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.616 Vali Acc: 0.738 Test Loss: 2.616 Test Acc: 0.738
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.8159515857696533
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.984 Vali Acc: 0.706 Test Loss: 2.984 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.7372560501098633
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 3.699 Vali Acc: 0.678 Test Loss: 3.699 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.5575382709503174
Epoch: 17, Steps: 8 | Train Loss: 0.151 Vali Loss: 2.966 Vali Acc: 0.703 Test Loss: 2.966 Test Acc: 0.703
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.3015899658203125
Epoch: 18, Steps: 8 | Train Loss: 0.360 Vali Loss: 3.618 Vali Acc: 0.722 Test Loss: 3.618 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.746875
model parameter : 13378568
model size : 70.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.3946027755737305
Epoch: 1, Steps: 8 | Train Loss: 2.001 Vali Loss: 1.451 Vali Acc: 0.478 Test Loss: 1.451 Test Acc: 0.478
Validation loss decreased (inf --> -0.478110).  Saving model ...
Epoch: 2 cost time: 2.987988233566284
Epoch: 2, Steps: 8 | Train Loss: 0.935 Vali Loss: 1.132 Vali Acc: 0.656 Test Loss: 1.132 Test Acc: 0.656
Validation loss decreased (-0.478110 --> -0.656239).  Saving model ...
Epoch: 3 cost time: 3.643806219100952
Epoch: 3, Steps: 8 | Train Loss: 0.427 Vali Loss: 1.116 Vali Acc: 0.669 Test Loss: 1.116 Test Acc: 0.669
Validation loss decreased (-0.656239 --> -0.668739).  Saving model ...
Epoch: 4 cost time: 3.698819398880005
Epoch: 4, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.701 Vali Acc: 0.619 Test Loss: 1.701 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6914467811584473
Epoch: 5, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.649 Vali Acc: 0.634 Test Loss: 1.649 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4768660068511963
Epoch: 6, Steps: 8 | Train Loss: 0.088 Vali Loss: 2.540 Vali Acc: 0.594 Test Loss: 2.540 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.241894006729126
Epoch: 7, Steps: 8 | Train Loss: 0.136 Vali Loss: 2.657 Vali Acc: 0.600 Test Loss: 2.657 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.345520257949829
Epoch: 8, Steps: 8 | Train Loss: 0.129 Vali Loss: 2.717 Vali Acc: 0.641 Test Loss: 2.717 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.7160069942474365
Epoch: 9, Steps: 8 | Train Loss: 0.098 Vali Loss: 3.255 Vali Acc: 0.634 Test Loss: 3.255 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.7948594093322754
Epoch: 10, Steps: 8 | Train Loss: 0.088 Vali Loss: 2.728 Vali Acc: 0.678 Test Loss: 2.728 Test Acc: 0.678
Validation loss decreased (-0.668739 --> -0.678098).  Saving model ...
Epoch: 11 cost time: 3.8480024337768555
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.543 Vali Acc: 0.678 Test Loss: 2.543 Test Acc: 0.678
Validation loss decreased (-0.678098 --> -0.678100).  Saving model ...
Epoch: 12 cost time: 3.7555880546569824
Epoch: 12, Steps: 8 | Train Loss: 0.063 Vali Loss: 2.890 Vali Acc: 0.678 Test Loss: 2.890 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.80376935005188
Epoch: 13, Steps: 8 | Train Loss: 0.053 Vali Loss: 3.646 Vali Acc: 0.650 Test Loss: 3.646 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.215808629989624
Epoch: 14, Steps: 8 | Train Loss: 0.050 Vali Loss: 3.888 Vali Acc: 0.641 Test Loss: 3.888 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3801486492156982
Epoch: 15, Steps: 8 | Train Loss: 0.036 Vali Loss: 3.482 Vali Acc: 0.669 Test Loss: 3.482 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.3129379749298096
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.991 Vali Acc: 0.713 Test Loss: 2.991 Test Acc: 0.713
Validation loss decreased (-0.678100 --> -0.712470).  Saving model ...
Epoch: 17 cost time: 3.2517600059509277
Epoch: 17, Steps: 8 | Train Loss: 0.067 Vali Loss: 2.923 Vali Acc: 0.709 Test Loss: 2.923 Test Acc: 0.709
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1770870685577393
Epoch: 18, Steps: 8 | Train Loss: 0.083 Vali Loss: 3.026 Vali Acc: 0.706 Test Loss: 3.026 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.895946741104126
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 4.755 Vali Acc: 0.650 Test Loss: 4.755 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.429412841796875
Epoch: 20, Steps: 8 | Train Loss: 0.037 Vali Loss: 3.991 Vali Acc: 0.653 Test Loss: 3.991 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.494598627090454
Epoch: 21, Steps: 8 | Train Loss: 0.152 Vali Loss: 3.789 Vali Acc: 0.662 Test Loss: 3.789 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.2906453609466553
Epoch: 22, Steps: 8 | Train Loss: 0.178 Vali Loss: 4.411 Vali Acc: 0.631 Test Loss: 4.411 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.016602516174316
Epoch: 23, Steps: 8 | Train Loss: 0.238 Vali Loss: 3.447 Vali Acc: 0.709 Test Loss: 3.447 Test Acc: 0.709
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.880580186843872
Epoch: 24, Steps: 8 | Train Loss: 0.177 Vali Loss: 6.243 Vali Acc: 0.616 Test Loss: 6.243 Test Acc: 0.616
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.5495364665985107
Epoch: 25, Steps: 8 | Train Loss: 0.277 Vali Loss: 8.170 Vali Acc: 0.619 Test Loss: 8.170 Test Acc: 0.619
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.1905713081359863
Epoch: 26, Steps: 8 | Train Loss: 0.947 Vali Loss: 7.864 Vali Acc: 0.622 Test Loss: 7.864 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7125
model parameter : 13378568
model size : 70.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.994631290435791
Epoch: 1, Steps: 8 | Train Loss: 2.074 Vali Loss: 1.616 Vali Acc: 0.431 Test Loss: 1.616 Test Acc: 0.431
Validation loss decreased (inf --> -0.431234).  Saving model ...
Epoch: 2 cost time: 3.063737630844116
Epoch: 2, Steps: 8 | Train Loss: 1.049 Vali Loss: 1.143 Vali Acc: 0.600 Test Loss: 1.143 Test Acc: 0.600
Validation loss decreased (-0.431234 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 3.1531126499176025
Epoch: 3, Steps: 8 | Train Loss: 0.468 Vali Loss: 1.204 Vali Acc: 0.634 Test Loss: 1.204 Test Acc: 0.634
Validation loss decreased (-0.599989 --> -0.634363).  Saving model ...
Epoch: 4 cost time: 3.326974868774414
Epoch: 4, Steps: 8 | Train Loss: 0.245 Vali Loss: 1.633 Vali Acc: 0.613 Test Loss: 1.633 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.795262575149536
Epoch: 5, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.785 Vali Acc: 0.578 Test Loss: 1.785 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6710896492004395
Epoch: 6, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.959 Vali Acc: 0.584 Test Loss: 1.959 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.774144411087036
Epoch: 7, Steps: 8 | Train Loss: 0.073 Vali Loss: 2.127 Vali Acc: 0.588 Test Loss: 2.127 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.4433791637420654
Epoch: 8, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.776 Vali Acc: 0.644 Test Loss: 1.776 Test Acc: 0.644
Validation loss decreased (-0.634363 --> -0.643732).  Saving model ...
Epoch: 9 cost time: 3.433025360107422
Epoch: 9, Steps: 8 | Train Loss: 0.038 Vali Loss: 2.417 Vali Acc: 0.616 Test Loss: 2.417 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4956448078155518
Epoch: 10, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.201 Vali Acc: 0.631 Test Loss: 2.201 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.599268674850464
Epoch: 11, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.699 Vali Acc: 0.594 Test Loss: 2.699 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.745469331741333
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 2.140 Vali Acc: 0.650 Test Loss: 2.140 Test Acc: 0.650
Validation loss decreased (-0.643732 --> -0.649979).  Saving model ...
Epoch: 13 cost time: 3.74513578414917
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.351 Vali Acc: 0.662 Test Loss: 2.351 Test Acc: 0.662
Validation loss decreased (-0.649979 --> -0.662476).  Saving model ...
Epoch: 14 cost time: 3.686713933944702
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.688 Vali Acc: 0.644 Test Loss: 2.688 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.996849298477173
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 3.257 Vali Acc: 0.662 Test Loss: 3.257 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3512072563171387
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 3.811 Vali Acc: 0.662 Test Loss: 3.811 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.240095853805542
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 4.317 Vali Acc: 0.606 Test Loss: 4.317 Test Acc: 0.606
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.4225523471832275
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 4.619 Vali Acc: 0.625 Test Loss: 4.619 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.667789936065674
Epoch: 19, Steps: 8 | Train Loss: 0.015 Vali Loss: 5.033 Vali Acc: 0.556 Test Loss: 5.033 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.6091880798339844
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 5.127 Vali Acc: 0.609 Test Loss: 5.127 Test Acc: 0.609
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.5260024070739746
Epoch: 21, Steps: 8 | Train Loss: 0.218 Vali Loss: 4.105 Vali Acc: 0.606 Test Loss: 4.105 Test Acc: 0.606
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.453395366668701
Epoch: 22, Steps: 8 | Train Loss: 0.291 Vali Loss: 4.565 Vali Acc: 0.606 Test Loss: 4.565 Test Acc: 0.606
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.1560187339782715
Epoch: 23, Steps: 8 | Train Loss: 0.034 Vali Loss: 5.599 Vali Acc: 0.613 Test Loss: 5.599 Test Acc: 0.613
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.6625
model parameter : 13378568
model size : 70.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.096636772155762
Epoch: 1, Steps: 8 | Train Loss: 2.176 Vali Loss: 1.829 Vali Acc: 0.322 Test Loss: 1.829 Test Acc: 0.322
Validation loss decreased (inf --> -0.321857).  Saving model ...
Epoch: 2 cost time: 3.393934488296509
Epoch: 2, Steps: 8 | Train Loss: 1.253 Vali Loss: 1.223 Vali Acc: 0.566 Test Loss: 1.223 Test Acc: 0.566
Validation loss decreased (-0.321857 --> -0.565613).  Saving model ...
Epoch: 3 cost time: 3.3679420948028564
Epoch: 3, Steps: 8 | Train Loss: 0.579 Vali Loss: 1.263 Vali Acc: 0.562 Test Loss: 1.263 Test Acc: 0.562
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1695892810821533
Epoch: 4, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.464 Vali Acc: 0.569 Test Loss: 1.464 Test Acc: 0.569
Validation loss decreased (-0.565613 --> -0.568735).  Saving model ...
Epoch: 5 cost time: 3.356177806854248
Epoch: 5, Steps: 8 | Train Loss: 0.208 Vali Loss: 1.934 Vali Acc: 0.512 Test Loss: 1.934 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4399521350860596
Epoch: 6, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.894 Vali Acc: 0.559 Test Loss: 1.894 Test Acc: 0.559
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2860219478607178
Epoch: 7, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.946 Vali Acc: 0.553 Test Loss: 1.946 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0278103351593018
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.046 Vali Acc: 0.566 Test Loss: 2.046 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.4346837997436523
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.791 Vali Acc: 0.616 Test Loss: 1.791 Test Acc: 0.616
Validation loss decreased (-0.568735 --> -0.615607).  Saving model ...
Epoch: 10 cost time: 3.4718408584594727
Epoch: 10, Steps: 8 | Train Loss: 0.048 Vali Loss: 2.198 Vali Acc: 0.591 Test Loss: 2.198 Test Acc: 0.591
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6007561683654785
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.104 Vali Acc: 0.628 Test Loss: 2.104 Test Acc: 0.628
Validation loss decreased (-0.615607 --> -0.628104).  Saving model ...
Epoch: 12 cost time: 3.7459847927093506
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.387 Vali Acc: 0.588 Test Loss: 2.387 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5932838916778564
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.976 Vali Acc: 0.578 Test Loss: 2.976 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.392857313156128
Epoch: 14, Steps: 8 | Train Loss: 0.032 Vali Loss: 2.943 Vali Acc: 0.572 Test Loss: 2.943 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3569681644439697
Epoch: 15, Steps: 8 | Train Loss: 0.054 Vali Loss: 3.343 Vali Acc: 0.578 Test Loss: 3.343 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2080838680267334
Epoch: 16, Steps: 8 | Train Loss: 0.156 Vali Loss: 4.042 Vali Acc: 0.528 Test Loss: 4.042 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.3447182178497314
Epoch: 17, Steps: 8 | Train Loss: 0.176 Vali Loss: 2.523 Vali Acc: 0.644 Test Loss: 2.523 Test Acc: 0.644
Validation loss decreased (-0.628104 --> -0.643725).  Saving model ...
Epoch: 18 cost time: 3.273101806640625
Epoch: 18, Steps: 8 | Train Loss: 0.116 Vali Loss: 4.340 Vali Acc: 0.588 Test Loss: 4.340 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1045517921447754
Epoch: 19, Steps: 8 | Train Loss: 0.098 Vali Loss: 3.891 Vali Acc: 0.600 Test Loss: 3.891 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.543739080429077
Epoch: 20, Steps: 8 | Train Loss: 0.219 Vali Loss: 3.748 Vali Acc: 0.641 Test Loss: 3.748 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.09267258644104
Epoch: 21, Steps: 8 | Train Loss: 0.075 Vali Loss: 3.874 Vali Acc: 0.641 Test Loss: 3.874 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.2926671504974365
Epoch: 22, Steps: 8 | Train Loss: 0.059 Vali Loss: 4.543 Vali Acc: 0.637 Test Loss: 4.543 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.772181510925293
Epoch: 23, Steps: 8 | Train Loss: 0.290 Vali Loss: 4.706 Vali Acc: 0.625 Test Loss: 4.706 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.692650556564331
Epoch: 24, Steps: 8 | Train Loss: 0.380 Vali Loss: 5.078 Vali Acc: 0.609 Test Loss: 5.078 Test Acc: 0.609
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.555302143096924
Epoch: 25, Steps: 8 | Train Loss: 0.131 Vali Loss: 4.817 Vali Acc: 0.656 Test Loss: 4.817 Test Acc: 0.656
Validation loss decreased (-0.643725 --> -0.656202).  Saving model ...
Epoch: 26 cost time: 3.7165589332580566
Epoch: 26, Steps: 8 | Train Loss: 0.200 Vali Loss: 5.988 Vali Acc: 0.616 Test Loss: 5.988 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.652127265930176
Epoch: 27, Steps: 8 | Train Loss: 0.052 Vali Loss: 5.191 Vali Acc: 0.647 Test Loss: 5.191 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.4682610034942627
Epoch: 28, Steps: 8 | Train Loss: 0.261 Vali Loss: 5.265 Vali Acc: 0.644 Test Loss: 5.265 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.4172067642211914
Epoch: 29, Steps: 8 | Train Loss: 0.057 Vali Loss: 5.812 Vali Acc: 0.578 Test Loss: 5.812 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.1947436332702637
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 7.220 Vali Acc: 0.575 Test Loss: 7.220 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.1362202167510986
Epoch: 31, Steps: 8 | Train Loss: 0.030 Vali Loss: 7.228 Vali Acc: 0.584 Test Loss: 7.228 Test Acc: 0.584
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.3582615852355957
Epoch: 32, Steps: 8 | Train Loss: 0.190 Vali Loss: 7.594 Vali Acc: 0.575 Test Loss: 7.594 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.0476973056793213
Epoch: 33, Steps: 8 | Train Loss: 0.018 Vali Loss: 6.888 Vali Acc: 0.622 Test Loss: 6.888 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.7823500633239746
Epoch: 34, Steps: 8 | Train Loss: 0.056 Vali Loss: 7.138 Vali Acc: 0.594 Test Loss: 7.138 Test Acc: 0.594
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.7444310188293457
Epoch: 35, Steps: 8 | Train Loss: 0.027 Vali Loss: 6.866 Vali Acc: 0.606 Test Loss: 6.866 Test Acc: 0.606
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.65625
model parameter : 13378568
model size : 70.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.740821838378906
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 1.987 Vali Acc: 0.175 Test Loss: 1.987 Test Acc: 0.175
Validation loss decreased (inf --> -0.174980).  Saving model ...
Epoch: 2 cost time: 3.519700050354004
Epoch: 2, Steps: 8 | Train Loss: 1.444 Vali Loss: 1.547 Vali Acc: 0.397 Test Loss: 1.547 Test Acc: 0.397
Validation loss decreased (-0.174980 --> -0.396860).  Saving model ...
Epoch: 3 cost time: 3.4133927822113037
Epoch: 3, Steps: 8 | Train Loss: 0.712 Vali Loss: 1.455 Vali Acc: 0.509 Test Loss: 1.455 Test Acc: 0.509
Validation loss decreased (-0.396860 --> -0.509360).  Saving model ...
Epoch: 4 cost time: 3.315476179122925
Epoch: 4, Steps: 8 | Train Loss: 0.401 Vali Loss: 1.558 Vali Acc: 0.469 Test Loss: 1.558 Test Acc: 0.469
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3334622383117676
Epoch: 5, Steps: 8 | Train Loss: 0.306 Vali Loss: 2.053 Vali Acc: 0.441 Test Loss: 2.053 Test Acc: 0.441
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1881866455078125
Epoch: 6, Steps: 8 | Train Loss: 0.149 Vali Loss: 2.105 Vali Acc: 0.434 Test Loss: 2.105 Test Acc: 0.434
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2236452102661133
Epoch: 7, Steps: 8 | Train Loss: 0.166 Vali Loss: 2.460 Vali Acc: 0.381 Test Loss: 2.460 Test Acc: 0.381
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.343507766723633
Epoch: 8, Steps: 8 | Train Loss: 0.076 Vali Loss: 2.720 Vali Acc: 0.362 Test Loss: 2.720 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.3052618503570557
Epoch: 9, Steps: 8 | Train Loss: 0.106 Vali Loss: 2.692 Vali Acc: 0.434 Test Loss: 2.692 Test Acc: 0.434
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.199800491333008
Epoch: 10, Steps: 8 | Train Loss: 0.068 Vali Loss: 2.471 Vali Acc: 0.444 Test Loss: 2.471 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.3069019317626953
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.793 Vali Acc: 0.441 Test Loss: 2.793 Test Acc: 0.441
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.040062427520752
Epoch: 12, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.518 Vali Acc: 0.463 Test Loss: 2.518 Test Acc: 0.463
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.939829111099243
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 3.362 Vali Acc: 0.478 Test Loss: 3.362 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.509375
model parameter : 13378568
model size : 70.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.734573841094971
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 2.013 Vali Acc: 0.153 Test Loss: 2.013 Test Acc: 0.153
Validation loss decreased (inf --> -0.153105).  Saving model ...
Epoch: 2 cost time: 3.5333590507507324
Epoch: 2, Steps: 8 | Train Loss: 1.578 Vali Loss: 1.699 Vali Acc: 0.319 Test Loss: 1.699 Test Acc: 0.319
Validation loss decreased (-0.153105 --> -0.318733).  Saving model ...
Epoch: 3 cost time: 3.5362608432769775
Epoch: 3, Steps: 8 | Train Loss: 0.831 Vali Loss: 1.527 Vali Acc: 0.450 Test Loss: 1.527 Test Acc: 0.450
Validation loss decreased (-0.318733 --> -0.449985).  Saving model ...
Epoch: 4 cost time: 3.2517189979553223
Epoch: 4, Steps: 8 | Train Loss: 0.473 Vali Loss: 1.624 Vali Acc: 0.431 Test Loss: 1.624 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.343104362487793
Epoch: 5, Steps: 8 | Train Loss: 0.364 Vali Loss: 1.820 Vali Acc: 0.419 Test Loss: 1.820 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5990169048309326
Epoch: 6, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.906 Vali Acc: 0.441 Test Loss: 1.906 Test Acc: 0.441
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.456186294555664
Epoch: 7, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.963 Vali Acc: 0.406 Test Loss: 1.963 Test Acc: 0.406
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2173385620117188
Epoch: 8, Steps: 8 | Train Loss: 0.097 Vali Loss: 2.906 Vali Acc: 0.287 Test Loss: 2.906 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.055114269256592
Epoch: 9, Steps: 8 | Train Loss: 0.039 Vali Loss: 2.041 Vali Acc: 0.381 Test Loss: 2.041 Test Acc: 0.381
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9783759117126465
Epoch: 10, Steps: 8 | Train Loss: 0.034 Vali Loss: 3.119 Vali Acc: 0.381 Test Loss: 3.119 Test Acc: 0.381
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.3036437034606934
Epoch: 11, Steps: 8 | Train Loss: 0.044 Vali Loss: 2.330 Vali Acc: 0.394 Test Loss: 2.330 Test Acc: 0.394
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.4430906772613525
Epoch: 12, Steps: 8 | Train Loss: 0.037 Vali Loss: 2.711 Vali Acc: 0.419 Test Loss: 2.711 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.9699554443359375
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.696 Vali Acc: 0.394 Test Loss: 2.696 Test Acc: 0.394
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.45
model parameter : 13378568
model size : 70.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.813192129135132
Epoch: 1, Steps: 8 | Train Loss: 2.146 Vali Loss: 2.038 Vali Acc: 0.206 Test Loss: 2.038 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 2.9816629886627197
Epoch: 2, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.784 Vali Acc: 0.266 Test Loss: 1.784 Test Acc: 0.266
Validation loss decreased (-0.206230 --> -0.265607).  Saving model ...
Epoch: 3 cost time: 3.0736026763916016
Epoch: 3, Steps: 8 | Train Loss: 0.836 Vali Loss: 1.533 Vali Acc: 0.472 Test Loss: 1.533 Test Acc: 0.472
Validation loss decreased (-0.265607 --> -0.471860).  Saving model ...
Epoch: 4 cost time: 3.3502750396728516
Epoch: 4, Steps: 8 | Train Loss: 0.470 Vali Loss: 1.532 Vali Acc: 0.391 Test Loss: 1.532 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.50042986869812
Epoch: 5, Steps: 8 | Train Loss: 0.334 Vali Loss: 1.544 Vali Acc: 0.472 Test Loss: 1.544 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5947184562683105
Epoch: 6, Steps: 8 | Train Loss: 0.225 Vali Loss: 1.640 Vali Acc: 0.409 Test Loss: 1.640 Test Acc: 0.409
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0942702293395996
Epoch: 7, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.684 Vali Acc: 0.419 Test Loss: 1.684 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.867603302001953
Epoch: 8, Steps: 8 | Train Loss: 0.092 Vali Loss: 2.955 Vali Acc: 0.250 Test Loss: 2.955 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.818941354751587
Epoch: 9, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.948 Vali Acc: 0.422 Test Loss: 1.948 Test Acc: 0.422
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9954476356506348
Epoch: 10, Steps: 8 | Train Loss: 0.048 Vali Loss: 2.545 Vali Acc: 0.422 Test Loss: 2.545 Test Acc: 0.422
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.220214605331421
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 2.475 Vali Acc: 0.381 Test Loss: 2.475 Test Acc: 0.381
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9214818477630615
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 2.128 Vali Acc: 0.425 Test Loss: 2.128 Test Acc: 0.425
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8711636066436768
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.256 Vali Acc: 0.416 Test Loss: 2.256 Test Acc: 0.416
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.471875
model parameter : 13378568
model size : 70.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.0863306522369385
Epoch: 1, Steps: 8 | Train Loss: 2.138 Vali Loss: 2.035 Vali Acc: 0.244 Test Loss: 2.035 Test Acc: 0.244
Validation loss decreased (inf --> -0.243730).  Saving model ...
Epoch: 2 cost time: 3.206587791442871
Epoch: 2, Steps: 8 | Train Loss: 1.537 Vali Loss: 1.736 Vali Acc: 0.422 Test Loss: 1.736 Test Acc: 0.422
Validation loss decreased (-0.243730 --> -0.421858).  Saving model ...
Epoch: 3 cost time: 3.172318458557129
Epoch: 3, Steps: 8 | Train Loss: 0.774 Vali Loss: 1.499 Vali Acc: 0.487 Test Loss: 1.499 Test Acc: 0.487
Validation loss decreased (-0.421858 --> -0.487485).  Saving model ...
Epoch: 4 cost time: 3.5065982341766357
Epoch: 4, Steps: 8 | Train Loss: 0.392 Vali Loss: 1.334 Vali Acc: 0.534 Test Loss: 1.334 Test Acc: 0.534
Validation loss decreased (-0.487485 --> -0.534362).  Saving model ...
Epoch: 5 cost time: 2.9399774074554443
Epoch: 5, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.479 Vali Acc: 0.491 Test Loss: 1.479 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3349883556365967
Epoch: 6, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.809 Vali Acc: 0.378 Test Loss: 1.809 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2728538513183594
Epoch: 7, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.995 Vali Acc: 0.475 Test Loss: 1.995 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.241654396057129
Epoch: 8, Steps: 8 | Train Loss: 0.051 Vali Loss: 2.911 Vali Acc: 0.309 Test Loss: 2.911 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.856562852859497
Epoch: 9, Steps: 8 | Train Loss: 0.022 Vali Loss: 2.105 Vali Acc: 0.425 Test Loss: 2.105 Test Acc: 0.425
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.777465581893921
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.309 Vali Acc: 0.431 Test Loss: 2.309 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.8379735946655273
Epoch: 11, Steps: 8 | Train Loss: 0.036 Vali Loss: 3.213 Vali Acc: 0.381 Test Loss: 3.213 Test Acc: 0.381
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.1289539337158203
Epoch: 12, Steps: 8 | Train Loss: 0.073 Vali Loss: 2.036 Vali Acc: 0.512 Test Loss: 2.036 Test Acc: 0.512
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.6733248233795166
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 3.151 Vali Acc: 0.366 Test Loss: 3.151 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.6319096088409424
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.131 Vali Acc: 0.506 Test Loss: 2.131 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.534375
model parameter : 13378568
model size : 70.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.523860454559326
Epoch: 1, Steps: 8 | Train Loss: 2.166 Vali Loss: 1.940 Vali Acc: 0.309 Test Loss: 1.940 Test Acc: 0.309
Validation loss decreased (inf --> -0.309356).  Saving model ...
Epoch: 2 cost time: 3.367995023727417
Epoch: 2, Steps: 8 | Train Loss: 1.541 Vali Loss: 1.382 Vali Acc: 0.541 Test Loss: 1.382 Test Acc: 0.541
Validation loss decreased (-0.309356 --> -0.540611).  Saving model ...
Epoch: 3 cost time: 3.583017349243164
Epoch: 3, Steps: 8 | Train Loss: 0.814 Vali Loss: 1.236 Vali Acc: 0.525 Test Loss: 1.236 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4490363597869873
Epoch: 4, Steps: 8 | Train Loss: 0.426 Vali Loss: 1.392 Vali Acc: 0.528 Test Loss: 1.392 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.603020668029785
Epoch: 5, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.927 Vali Acc: 0.484 Test Loss: 1.927 Test Acc: 0.484
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3321967124938965
Epoch: 6, Steps: 8 | Train Loss: 0.159 Vali Loss: 2.361 Vali Acc: 0.428 Test Loss: 2.361 Test Acc: 0.428
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.829988718032837
Epoch: 7, Steps: 8 | Train Loss: 0.094 Vali Loss: 2.809 Vali Acc: 0.397 Test Loss: 2.809 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1604433059692383
Epoch: 8, Steps: 8 | Train Loss: 0.063 Vali Loss: 3.708 Vali Acc: 0.322 Test Loss: 3.708 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.185011625289917
Epoch: 9, Steps: 8 | Train Loss: 0.028 Vali Loss: 3.314 Vali Acc: 0.341 Test Loss: 3.314 Test Acc: 0.341
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3003499507904053
Epoch: 10, Steps: 8 | Train Loss: 0.023 Vali Loss: 3.785 Vali Acc: 0.356 Test Loss: 3.785 Test Acc: 0.356
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.214737892150879
Epoch: 11, Steps: 8 | Train Loss: 0.016 Vali Loss: 4.185 Vali Acc: 0.347 Test Loss: 4.185 Test Acc: 0.347
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.4243075847625732
Epoch: 12, Steps: 8 | Train Loss: 0.016 Vali Loss: 3.386 Vali Acc: 0.469 Test Loss: 3.386 Test Acc: 0.469
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.540625
model parameter : 13378568
model size : 70.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.893386602401733
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 1.957 Vali Acc: 0.278 Test Loss: 1.957 Test Acc: 0.278
Validation loss decreased (inf --> -0.278105).  Saving model ...
Epoch: 2 cost time: 4.037820100784302
Epoch: 2, Steps: 8 | Train Loss: 1.678 Vali Loss: 1.413 Vali Acc: 0.472 Test Loss: 1.413 Test Acc: 0.472
Validation loss decreased (-0.278105 --> -0.471861).  Saving model ...
Epoch: 3 cost time: 3.5496578216552734
Epoch: 3, Steps: 8 | Train Loss: 0.968 Vali Loss: 1.260 Vali Acc: 0.509 Test Loss: 1.260 Test Acc: 0.509
Validation loss decreased (-0.471861 --> -0.509362).  Saving model ...
Epoch: 4 cost time: 3.3975296020507812
Epoch: 4, Steps: 8 | Train Loss: 0.496 Vali Loss: 1.688 Vali Acc: 0.484 Test Loss: 1.688 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4174678325653076
Epoch: 5, Steps: 8 | Train Loss: 0.313 Vali Loss: 1.970 Vali Acc: 0.456 Test Loss: 1.970 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.53472900390625
Epoch: 6, Steps: 8 | Train Loss: 0.211 Vali Loss: 2.879 Vali Acc: 0.378 Test Loss: 2.879 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8748862743377686
Epoch: 7, Steps: 8 | Train Loss: 0.127 Vali Loss: 3.078 Vali Acc: 0.375 Test Loss: 3.078 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0757040977478027
Epoch: 8, Steps: 8 | Train Loss: 0.071 Vali Loss: 4.118 Vali Acc: 0.322 Test Loss: 4.118 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.685549259185791
Epoch: 9, Steps: 8 | Train Loss: 0.061 Vali Loss: 3.761 Vali Acc: 0.359 Test Loss: 3.761 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.12416672706604
Epoch: 10, Steps: 8 | Train Loss: 0.032 Vali Loss: 3.193 Vali Acc: 0.453 Test Loss: 3.193 Test Acc: 0.453
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1293938159942627
Epoch: 11, Steps: 8 | Train Loss: 0.019 Vali Loss: 4.722 Vali Acc: 0.378 Test Loss: 4.722 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9613840579986572
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 4.000 Vali Acc: 0.459 Test Loss: 4.000 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.315586805343628
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 4.787 Vali Acc: 0.384 Test Loss: 4.787 Test Acc: 0.384
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.509375
model parameter : 13378568
model size : 70.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.64017915725708
Epoch: 1, Steps: 8 | Train Loss: 1.941 Vali Loss: 1.230 Vali Acc: 0.634 Test Loss: 1.230 Test Acc: 0.634
Validation loss decreased (inf --> -0.634363).  Saving model ...
Epoch: 2 cost time: 3.173844337463379
Epoch: 2, Steps: 8 | Train Loss: 0.755 Vali Loss: 0.794 Vali Acc: 0.719 Test Loss: 0.794 Test Acc: 0.719
Validation loss decreased (-0.634363 --> -0.718742).  Saving model ...
Epoch: 3 cost time: 3.657468318939209
Epoch: 3, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.915 Vali Acc: 0.747 Test Loss: 0.915 Test Acc: 0.747
Validation loss decreased (-0.718742 --> -0.746866).  Saving model ...
Epoch: 4 cost time: 3.6748454570770264
Epoch: 4, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.117 Vali Acc: 0.725 Test Loss: 1.117 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4091317653656006
Epoch: 5, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.236 Vali Acc: 0.738 Test Loss: 1.236 Test Acc: 0.738
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0206634998321533
Epoch: 6, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.562 Vali Acc: 0.716 Test Loss: 1.562 Test Acc: 0.716
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.272153615951538
Epoch: 7, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.617 Vali Acc: 0.741 Test Loss: 1.617 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.721251964569092
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.952 Vali Acc: 0.694 Test Loss: 1.952 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.4640634059906006
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.765 Vali Acc: 0.734 Test Loss: 1.765 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.2829296588897705
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.993 Vali Acc: 0.716 Test Loss: 1.993 Test Acc: 0.716
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.2214226722717285
Epoch: 11, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.023 Vali Acc: 0.750 Test Loss: 2.023 Test Acc: 0.750
Validation loss decreased (-0.746866 --> -0.749980).  Saving model ...
Epoch: 12 cost time: 3.3259623050689697
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.916 Vali Acc: 0.697 Test Loss: 2.916 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5247678756713867
Epoch: 13, Steps: 8 | Train Loss: 0.027 Vali Loss: 2.740 Vali Acc: 0.719 Test Loss: 2.740 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.5835983753204346
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.474 Vali Acc: 0.722 Test Loss: 2.474 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.6349246501922607
Epoch: 15, Steps: 8 | Train Loss: 0.140 Vali Loss: 2.773 Vali Acc: 0.750 Test Loss: 2.773 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0601580142974854
Epoch: 16, Steps: 8 | Train Loss: 0.104 Vali Loss: 3.161 Vali Acc: 0.716 Test Loss: 3.161 Test Acc: 0.716
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0860202312469482
Epoch: 17, Steps: 8 | Train Loss: 0.099 Vali Loss: 3.064 Vali Acc: 0.722 Test Loss: 3.064 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.6921820640563965
Epoch: 18, Steps: 8 | Train Loss: 0.252 Vali Loss: 4.143 Vali Acc: 0.678 Test Loss: 4.143 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.834857702255249
Epoch: 19, Steps: 8 | Train Loss: 0.064 Vali Loss: 3.901 Vali Acc: 0.713 Test Loss: 3.901 Test Acc: 0.713
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.2573325634002686
Epoch: 20, Steps: 8 | Train Loss: 0.193 Vali Loss: 3.560 Vali Acc: 0.747 Test Loss: 3.560 Test Acc: 0.747
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.3565216064453125
Epoch: 21, Steps: 8 | Train Loss: 0.162 Vali Loss: 3.852 Vali Acc: 0.750 Test Loss: 3.852 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.75
model parameter : 12592136
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.80651068687439
Epoch: 1, Steps: 8 | Train Loss: 2.001 Vali Loss: 1.440 Vali Acc: 0.534 Test Loss: 1.440 Test Acc: 0.534
Validation loss decreased (inf --> -0.534361).  Saving model ...
Epoch: 2 cost time: 3.7164087295532227
Epoch: 2, Steps: 8 | Train Loss: 0.896 Vali Loss: 1.005 Vali Acc: 0.678 Test Loss: 1.005 Test Acc: 0.678
Validation loss decreased (-0.534361 --> -0.678115).  Saving model ...
Epoch: 3 cost time: 3.6847832202911377
Epoch: 3, Steps: 8 | Train Loss: 0.399 Vali Loss: 1.264 Vali Acc: 0.650 Test Loss: 1.264 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.577888011932373
Epoch: 4, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.289 Vali Acc: 0.653 Test Loss: 1.289 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.435213327407837
Epoch: 5, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.667 Vali Acc: 0.656 Test Loss: 1.667 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.393845558166504
Epoch: 6, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.898 Vali Acc: 0.650 Test Loss: 1.898 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3945157527923584
Epoch: 7, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.983 Vali Acc: 0.656 Test Loss: 1.983 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.226973295211792
Epoch: 8, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.894 Vali Acc: 0.678 Test Loss: 1.894 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.67253041267395
Epoch: 9, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.451 Vali Acc: 0.672 Test Loss: 2.451 Test Acc: 0.672
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.7408134937286377
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.144 Vali Acc: 0.694 Test Loss: 2.144 Test Acc: 0.694
Validation loss decreased (-0.678115 --> -0.693729).  Saving model ...
Epoch: 11 cost time: 3.384033679962158
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.223 Vali Acc: 0.675 Test Loss: 2.223 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.194178819656372
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.396 Vali Acc: 0.659 Test Loss: 2.396 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2817463874816895
Epoch: 13, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.681 Vali Acc: 0.653 Test Loss: 2.681 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1808626651763916
Epoch: 14, Steps: 8 | Train Loss: 0.011 Vali Loss: 3.003 Vali Acc: 0.653 Test Loss: 3.003 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7951302528381348
Epoch: 15, Steps: 8 | Train Loss: 0.174 Vali Loss: 3.765 Vali Acc: 0.594 Test Loss: 3.765 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.606689929962158
Epoch: 16, Steps: 8 | Train Loss: 0.074 Vali Loss: 3.147 Vali Acc: 0.653 Test Loss: 3.147 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.734123468399048
Epoch: 17, Steps: 8 | Train Loss: 0.058 Vali Loss: 3.821 Vali Acc: 0.641 Test Loss: 3.821 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.4853570461273193
Epoch: 18, Steps: 8 | Train Loss: 0.229 Vali Loss: 3.394 Vali Acc: 0.675 Test Loss: 3.394 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.200782299041748
Epoch: 19, Steps: 8 | Train Loss: 0.248 Vali Loss: 4.143 Vali Acc: 0.650 Test Loss: 4.143 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.2239396572113037
Epoch: 20, Steps: 8 | Train Loss: 0.203 Vali Loss: 3.428 Vali Acc: 0.700 Test Loss: 3.428 Test Acc: 0.700
Validation loss decreased (-0.693729 --> -0.699966).  Saving model ...
Epoch: 21 cost time: 3.4052562713623047
Epoch: 21, Steps: 8 | Train Loss: 0.213 Vali Loss: 4.496 Vali Acc: 0.653 Test Loss: 4.496 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.907464027404785
Epoch: 22, Steps: 8 | Train Loss: 0.143 Vali Loss: 5.545 Vali Acc: 0.637 Test Loss: 5.545 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5431885719299316
Epoch: 23, Steps: 8 | Train Loss: 0.076 Vali Loss: 5.104 Vali Acc: 0.666 Test Loss: 5.104 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.5980734825134277
Epoch: 24, Steps: 8 | Train Loss: 0.083 Vali Loss: 5.832 Vali Acc: 0.681 Test Loss: 5.832 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.0282599925994873
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 6.417 Vali Acc: 0.650 Test Loss: 6.417 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.2885658740997314
Epoch: 26, Steps: 8 | Train Loss: 0.058 Vali Loss: 5.581 Vali Acc: 0.684 Test Loss: 5.581 Test Acc: 0.684
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.4249727725982666
Epoch: 27, Steps: 8 | Train Loss: 0.182 Vali Loss: 5.404 Vali Acc: 0.684 Test Loss: 5.404 Test Acc: 0.684
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.2490310668945312
Epoch: 28, Steps: 8 | Train Loss: 0.164 Vali Loss: 7.392 Vali Acc: 0.672 Test Loss: 7.392 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.1125149726867676
Epoch: 29, Steps: 8 | Train Loss: 0.103 Vali Loss: 6.717 Vali Acc: 0.644 Test Loss: 6.717 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.195486068725586
Epoch: 30, Steps: 8 | Train Loss: 0.056 Vali Loss: 6.489 Vali Acc: 0.678 Test Loss: 6.489 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7
model parameter : 12592136
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.464264392852783
Epoch: 1, Steps: 8 | Train Loss: 2.069 Vali Loss: 1.648 Vali Acc: 0.444 Test Loss: 1.648 Test Acc: 0.444
Validation loss decreased (inf --> -0.443734).  Saving model ...
Epoch: 2 cost time: 3.1564009189605713
Epoch: 2, Steps: 8 | Train Loss: 1.063 Vali Loss: 1.125 Vali Acc: 0.597 Test Loss: 1.125 Test Acc: 0.597
Validation loss decreased (-0.443734 --> -0.596864).  Saving model ...
Epoch: 3 cost time: 3.4787683486938477
Epoch: 3, Steps: 8 | Train Loss: 0.505 Vali Loss: 1.324 Vali Acc: 0.628 Test Loss: 1.324 Test Acc: 0.628
Validation loss decreased (-0.596864 --> -0.628112).  Saving model ...
Epoch: 4 cost time: 3.6236636638641357
Epoch: 4, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.251 Vali Acc: 0.628 Test Loss: 1.251 Test Acc: 0.628
Validation loss decreased (-0.628112 --> -0.628112).  Saving model ...
Epoch: 5 cost time: 3.580512523651123
Epoch: 5, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.434 Vali Acc: 0.656 Test Loss: 1.434 Test Acc: 0.656
Validation loss decreased (-0.628112 --> -0.656236).  Saving model ...
Epoch: 6 cost time: 3.583611488342285
Epoch: 6, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.660 Vali Acc: 0.641 Test Loss: 1.660 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.305164098739624
Epoch: 7, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.728 Vali Acc: 0.625 Test Loss: 1.728 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.076415538787842
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.735 Vali Acc: 0.650 Test Loss: 1.735 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.139462471008301
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.147 Vali Acc: 0.628 Test Loss: 2.147 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.285151243209839
Epoch: 10, Steps: 8 | Train Loss: 0.044 Vali Loss: 2.028 Vali Acc: 0.647 Test Loss: 2.028 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4399425983428955
Epoch: 11, Steps: 8 | Train Loss: 0.022 Vali Loss: 2.194 Vali Acc: 0.653 Test Loss: 2.194 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.414393901824951
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 2.471 Vali Acc: 0.637 Test Loss: 2.471 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.8614392280578613
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 2.962 Vali Acc: 0.594 Test Loss: 2.962 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.181997537612915
Epoch: 14, Steps: 8 | Train Loss: 0.172 Vali Loss: 3.069 Vali Acc: 0.644 Test Loss: 3.069 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.0872271060943604
Epoch: 15, Steps: 8 | Train Loss: 0.154 Vali Loss: 3.260 Vali Acc: 0.650 Test Loss: 3.260 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.65625
model parameter : 12592136
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.062647819519043
Epoch: 1, Steps: 8 | Train Loss: 2.103 Vali Loss: 1.861 Vali Acc: 0.375 Test Loss: 1.861 Test Acc: 0.375
Validation loss decreased (inf --> -0.374981).  Saving model ...
Epoch: 2 cost time: 3.598128080368042
Epoch: 2, Steps: 8 | Train Loss: 1.261 Vali Loss: 1.293 Vali Acc: 0.487 Test Loss: 1.293 Test Acc: 0.487
Validation loss decreased (-0.374981 --> -0.487487).  Saving model ...
Epoch: 3 cost time: 3.374683380126953
Epoch: 3, Steps: 8 | Train Loss: 0.685 Vali Loss: 1.496 Vali Acc: 0.516 Test Loss: 1.496 Test Acc: 0.516
Validation loss decreased (-0.487487 --> -0.515610).  Saving model ...
Epoch: 4 cost time: 3.252000570297241
Epoch: 4, Steps: 8 | Train Loss: 0.383 Vali Loss: 1.368 Vali Acc: 0.600 Test Loss: 1.368 Test Acc: 0.600
Validation loss decreased (-0.515610 --> -0.599986).  Saving model ...
Epoch: 5 cost time: 2.708460569381714
Epoch: 5, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.765 Vali Acc: 0.509 Test Loss: 1.765 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2975454330444336
Epoch: 6, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.981 Vali Acc: 0.541 Test Loss: 1.981 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.007171154022217
Epoch: 7, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.768 Vali Acc: 0.569 Test Loss: 1.768 Test Acc: 0.569
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.140791416168213
Epoch: 8, Steps: 8 | Train Loss: 0.075 Vali Loss: 2.321 Vali Acc: 0.562 Test Loss: 2.321 Test Acc: 0.562
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2383809089660645
Epoch: 9, Steps: 8 | Train Loss: 0.083 Vali Loss: 2.129 Vali Acc: 0.584 Test Loss: 2.129 Test Acc: 0.584
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.522881507873535
Epoch: 10, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.206 Vali Acc: 0.594 Test Loss: 2.206 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.230319023132324
Epoch: 11, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.122 Vali Acc: 0.634 Test Loss: 2.122 Test Acc: 0.634
Validation loss decreased (-0.599986 --> -0.634354).  Saving model ...
Epoch: 12 cost time: 3.2376420497894287
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.456 Vali Acc: 0.591 Test Loss: 2.456 Test Acc: 0.591
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.111286163330078
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 2.742 Vali Acc: 0.584 Test Loss: 2.742 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3308300971984863
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 3.015 Vali Acc: 0.550 Test Loss: 3.015 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.516584634780884
Epoch: 15, Steps: 8 | Train Loss: 0.036 Vali Loss: 2.785 Vali Acc: 0.619 Test Loss: 2.785 Test Acc: 0.619
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.509413242340088
Epoch: 16, Steps: 8 | Train Loss: 0.130 Vali Loss: 3.789 Vali Acc: 0.562 Test Loss: 3.789 Test Acc: 0.562
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.51666522026062
Epoch: 17, Steps: 8 | Train Loss: 0.171 Vali Loss: 2.686 Vali Acc: 0.644 Test Loss: 2.686 Test Acc: 0.644
Validation loss decreased (-0.634354 --> -0.643723).  Saving model ...
Epoch: 18 cost time: 3.3918297290802
Epoch: 18, Steps: 8 | Train Loss: 0.032 Vali Loss: 3.441 Vali Acc: 0.600 Test Loss: 3.441 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1467936038970947
Epoch: 19, Steps: 8 | Train Loss: 0.124 Vali Loss: 3.603 Vali Acc: 0.591 Test Loss: 3.603 Test Acc: 0.591
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.0256121158599854
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 3.838 Vali Acc: 0.559 Test Loss: 3.838 Test Acc: 0.559
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.026932716369629
Epoch: 21, Steps: 8 | Train Loss: 0.080 Vali Loss: 3.114 Vali Acc: 0.631 Test Loss: 3.114 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.137906789779663
Epoch: 22, Steps: 8 | Train Loss: 0.146 Vali Loss: 3.896 Vali Acc: 0.619 Test Loss: 3.896 Test Acc: 0.619
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.2306041717529297
Epoch: 23, Steps: 8 | Train Loss: 0.076 Vali Loss: 6.162 Vali Acc: 0.522 Test Loss: 6.162 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.161762237548828
Epoch: 24, Steps: 8 | Train Loss: 0.150 Vali Loss: 4.354 Vali Acc: 0.578 Test Loss: 4.354 Test Acc: 0.578
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.2278642654418945
Epoch: 25, Steps: 8 | Train Loss: 0.316 Vali Loss: 4.887 Vali Acc: 0.588 Test Loss: 4.887 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.8333687782287598
Epoch: 26, Steps: 8 | Train Loss: 0.193 Vali Loss: 4.016 Vali Acc: 0.647 Test Loss: 4.016 Test Acc: 0.647
Validation loss decreased (-0.643723 --> -0.646835).  Saving model ...
Epoch: 27 cost time: 3.3649253845214844
Epoch: 27, Steps: 8 | Train Loss: 0.014 Vali Loss: 4.547 Vali Acc: 0.641 Test Loss: 4.547 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0700109004974365
Epoch: 28, Steps: 8 | Train Loss: 0.191 Vali Loss: 4.755 Vali Acc: 0.619 Test Loss: 4.755 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.570159912109375
Epoch: 29, Steps: 8 | Train Loss: 0.074 Vali Loss: 5.255 Vali Acc: 0.641 Test Loss: 5.255 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.847806930541992
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 5.806 Vali Acc: 0.631 Test Loss: 5.806 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.601949453353882
Epoch: 31, Steps: 8 | Train Loss: 0.069 Vali Loss: 5.548 Vali Acc: 0.641 Test Loss: 5.548 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.0600972175598145
Epoch: 32, Steps: 8 | Train Loss: 0.032 Vali Loss: 6.672 Vali Acc: 0.581 Test Loss: 6.672 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.810534715652466
Epoch: 33, Steps: 8 | Train Loss: 0.101 Vali Loss: 6.047 Vali Acc: 0.594 Test Loss: 6.047 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.142605781555176
Epoch: 34, Steps: 8 | Train Loss: 0.162 Vali Loss: 7.651 Vali Acc: 0.566 Test Loss: 7.651 Test Acc: 0.566
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.435131788253784
Epoch: 35, Steps: 8 | Train Loss: 0.325 Vali Loss: 7.591 Vali Acc: 0.613 Test Loss: 7.591 Test Acc: 0.613
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.2780215740203857
Epoch: 36, Steps: 8 | Train Loss: 0.119 Vali Loss: 6.636 Vali Acc: 0.622 Test Loss: 6.636 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.646875
model parameter : 12592136
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.714382171630859
Epoch: 1, Steps: 8 | Train Loss: 2.128 Vali Loss: 2.030 Vali Acc: 0.312 Test Loss: 2.030 Test Acc: 0.312
Validation loss decreased (inf --> -0.312480).  Saving model ...
Epoch: 2 cost time: 3.2385761737823486
Epoch: 2, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.506 Vali Acc: 0.369 Test Loss: 1.506 Test Acc: 0.369
Validation loss decreased (-0.312480 --> -0.368735).  Saving model ...
Epoch: 3 cost time: 3.276095151901245
Epoch: 3, Steps: 8 | Train Loss: 0.810 Vali Loss: 1.613 Vali Acc: 0.472 Test Loss: 1.613 Test Acc: 0.472
Validation loss decreased (-0.368735 --> -0.471859).  Saving model ...
Epoch: 4 cost time: 3.160996198654175
Epoch: 4, Steps: 8 | Train Loss: 0.474 Vali Loss: 1.421 Vali Acc: 0.472 Test Loss: 1.421 Test Acc: 0.472
Validation loss decreased (-0.471859 --> -0.471861).  Saving model ...
Epoch: 5 cost time: 2.9949660301208496
Epoch: 5, Steps: 8 | Train Loss: 0.337 Vali Loss: 2.184 Vali Acc: 0.406 Test Loss: 2.184 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9336979389190674
Epoch: 6, Steps: 8 | Train Loss: 0.230 Vali Loss: 2.166 Vali Acc: 0.366 Test Loss: 2.166 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8949334621429443
Epoch: 7, Steps: 8 | Train Loss: 0.120 Vali Loss: 2.558 Vali Acc: 0.378 Test Loss: 2.558 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.28147554397583
Epoch: 8, Steps: 8 | Train Loss: 0.098 Vali Loss: 2.423 Vali Acc: 0.456 Test Loss: 2.423 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9849538803100586
Epoch: 9, Steps: 8 | Train Loss: 0.054 Vali Loss: 2.443 Vali Acc: 0.416 Test Loss: 2.443 Test Acc: 0.416
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.3055496215820312
Epoch: 10, Steps: 8 | Train Loss: 0.028 Vali Loss: 2.580 Vali Acc: 0.447 Test Loss: 2.580 Test Acc: 0.447
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.0037894248962402
Epoch: 11, Steps: 8 | Train Loss: 0.070 Vali Loss: 2.150 Vali Acc: 0.503 Test Loss: 2.150 Test Acc: 0.503
Validation loss decreased (-0.471861 --> -0.503103).  Saving model ...
Epoch: 12 cost time: 3.108734607696533
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 3.070 Vali Acc: 0.378 Test Loss: 3.070 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.378952980041504
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.830 Vali Acc: 0.425 Test Loss: 2.830 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3303635120391846
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 3.268 Vali Acc: 0.425 Test Loss: 3.268 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3015596866607666
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 3.001 Vali Acc: 0.431 Test Loss: 3.001 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.296426296234131
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 3.148 Vali Acc: 0.466 Test Loss: 3.148 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.1960484981536865
Epoch: 17, Steps: 8 | Train Loss: 0.050 Vali Loss: 3.312 Vali Acc: 0.487 Test Loss: 3.312 Test Acc: 0.487
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.2595202922821045
Epoch: 18, Steps: 8 | Train Loss: 0.084 Vali Loss: 4.585 Vali Acc: 0.391 Test Loss: 4.585 Test Acc: 0.391
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.4104726314544678
Epoch: 19, Steps: 8 | Train Loss: 0.327 Vali Loss: 5.173 Vali Acc: 0.428 Test Loss: 5.173 Test Acc: 0.428
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.207101821899414
Epoch: 20, Steps: 8 | Train Loss: 0.169 Vali Loss: 5.306 Vali Acc: 0.434 Test Loss: 5.306 Test Acc: 0.434
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.1764936447143555
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 4.047 Vali Acc: 0.481 Test Loss: 4.047 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.503125
model parameter : 12592136
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.653527021408081
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 2.071 Vali Acc: 0.309 Test Loss: 2.071 Test Acc: 0.309
Validation loss decreased (inf --> -0.309354).  Saving model ...
Epoch: 2 cost time: 3.5404627323150635
Epoch: 2, Steps: 8 | Train Loss: 1.588 Vali Loss: 1.681 Vali Acc: 0.406 Test Loss: 1.681 Test Acc: 0.406
Validation loss decreased (-0.309354 --> -0.406233).  Saving model ...
Epoch: 3 cost time: 3.348172187805176
Epoch: 3, Steps: 8 | Train Loss: 0.950 Vali Loss: 1.863 Vali Acc: 0.388 Test Loss: 1.863 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2374396324157715
Epoch: 4, Steps: 8 | Train Loss: 0.616 Vali Loss: 1.402 Vali Acc: 0.422 Test Loss: 1.402 Test Acc: 0.422
Validation loss decreased (-0.406233 --> -0.421861).  Saving model ...
Epoch: 5 cost time: 3.1947033405303955
Epoch: 5, Steps: 8 | Train Loss: 0.384 Vali Loss: 1.853 Vali Acc: 0.425 Test Loss: 1.853 Test Acc: 0.425
Validation loss decreased (-0.421861 --> -0.424981).  Saving model ...
Epoch: 6 cost time: 2.9818103313446045
Epoch: 6, Steps: 8 | Train Loss: 0.279 Vali Loss: 2.568 Vali Acc: 0.194 Test Loss: 2.568 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3518285751342773
Epoch: 7, Steps: 8 | Train Loss: 0.188 Vali Loss: 2.321 Vali Acc: 0.419 Test Loss: 2.321 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.435492515563965
Epoch: 8, Steps: 8 | Train Loss: 0.104 Vali Loss: 2.484 Vali Acc: 0.278 Test Loss: 2.484 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.922682523727417
Epoch: 9, Steps: 8 | Train Loss: 0.087 Vali Loss: 2.614 Vali Acc: 0.300 Test Loss: 2.614 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0303502082824707
Epoch: 10, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.973 Vali Acc: 0.400 Test Loss: 1.973 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2039544582366943
Epoch: 11, Steps: 8 | Train Loss: 0.046 Vali Loss: 2.145 Vali Acc: 0.466 Test Loss: 2.145 Test Acc: 0.466
Validation loss decreased (-0.424981 --> -0.465604).  Saving model ...
Epoch: 12 cost time: 3.2778382301330566
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 2.765 Vali Acc: 0.325 Test Loss: 2.765 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.421445369720459
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.391 Vali Acc: 0.403 Test Loss: 2.391 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4549803733825684
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.821 Vali Acc: 0.331 Test Loss: 2.821 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.4873592853546143
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.313 Vali Acc: 0.428 Test Loss: 2.313 Test Acc: 0.428
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.238407850265503
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 3.706 Vali Acc: 0.253 Test Loss: 3.706 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.1579818725585938
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.050 Vali Acc: 0.497 Test Loss: 2.050 Test Acc: 0.497
Validation loss decreased (-0.465604 --> -0.496854).  Saving model ...
Epoch: 18 cost time: 3.320586681365967
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 3.690 Vali Acc: 0.334 Test Loss: 3.690 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1544318199157715
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.294 Vali Acc: 0.444 Test Loss: 2.294 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9869701862335205
Epoch: 20, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.448 Vali Acc: 0.431 Test Loss: 2.448 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.1668317317962646
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 3.158 Vali Acc: 0.394 Test Loss: 3.158 Test Acc: 0.394
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.1740221977233887
Epoch: 22, Steps: 8 | Train Loss: 0.031 Vali Loss: 2.672 Vali Acc: 0.459 Test Loss: 2.672 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.370039701461792
Epoch: 23, Steps: 8 | Train Loss: 0.050 Vali Loss: 3.478 Vali Acc: 0.400 Test Loss: 3.478 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.436415672302246
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 3.033 Vali Acc: 0.481 Test Loss: 3.033 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.3748245239257812
Epoch: 25, Steps: 8 | Train Loss: 0.034 Vali Loss: 4.112 Vali Acc: 0.353 Test Loss: 4.112 Test Acc: 0.353
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.337185859680176
Epoch: 26, Steps: 8 | Train Loss: 0.008 Vali Loss: 4.569 Vali Acc: 0.338 Test Loss: 4.569 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.388629198074341
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 3.325 Vali Acc: 0.397 Test Loss: 3.325 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.496875
model parameter : 12592136
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.545476198196411
Epoch: 1, Steps: 8 | Train Loss: 2.136 Vali Loss: 2.080 Vali Acc: 0.188 Test Loss: 2.080 Test Acc: 0.188
Validation loss decreased (inf --> -0.187479).  Saving model ...
Epoch: 2 cost time: 3.2747890949249268
Epoch: 2, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.793 Vali Acc: 0.319 Test Loss: 1.793 Test Acc: 0.319
Validation loss decreased (-0.187479 --> -0.318732).  Saving model ...
Epoch: 3 cost time: 2.84232497215271
Epoch: 3, Steps: 8 | Train Loss: 0.958 Vali Loss: 1.789 Vali Acc: 0.341 Test Loss: 1.789 Test Acc: 0.341
Validation loss decreased (-0.318732 --> -0.340607).  Saving model ...
Epoch: 4 cost time: 3.1766772270202637
Epoch: 4, Steps: 8 | Train Loss: 0.592 Vali Loss: 1.392 Vali Acc: 0.497 Test Loss: 1.392 Test Acc: 0.497
Validation loss decreased (-0.340607 --> -0.496861).  Saving model ...
Epoch: 5 cost time: 2.809135913848877
Epoch: 5, Steps: 8 | Train Loss: 0.333 Vali Loss: 1.504 Vali Acc: 0.447 Test Loss: 1.504 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.093069553375244
Epoch: 6, Steps: 8 | Train Loss: 0.273 Vali Loss: 2.318 Vali Acc: 0.228 Test Loss: 2.318 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1262691020965576
Epoch: 7, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.955 Vali Acc: 0.412 Test Loss: 1.955 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.195266008377075
Epoch: 8, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.891 Vali Acc: 0.378 Test Loss: 1.891 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2007646560668945
Epoch: 9, Steps: 8 | Train Loss: 0.074 Vali Loss: 2.456 Vali Acc: 0.272 Test Loss: 2.456 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.4181697368621826
Epoch: 10, Steps: 8 | Train Loss: 0.028 Vali Loss: 2.167 Vali Acc: 0.391 Test Loss: 2.167 Test Acc: 0.391
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.197483777999878
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 2.082 Vali Acc: 0.469 Test Loss: 2.082 Test Acc: 0.469
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.4017457962036133
Epoch: 12, Steps: 8 | Train Loss: 0.035 Vali Loss: 2.841 Vali Acc: 0.316 Test Loss: 2.841 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.2058253288269043
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.889 Vali Acc: 0.441 Test Loss: 1.889 Test Acc: 0.441
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.083246946334839
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.765 Vali Acc: 0.331 Test Loss: 2.765 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.496875
model parameter : 12592136
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.1775062084198
Epoch: 1, Steps: 8 | Train Loss: 2.114 Vali Loss: 2.223 Vali Acc: 0.178 Test Loss: 2.223 Test Acc: 0.178
Validation loss decreased (inf --> -0.178103).  Saving model ...
Epoch: 2 cost time: 3.054832696914673
Epoch: 2, Steps: 8 | Train Loss: 1.550 Vali Loss: 1.909 Vali Acc: 0.259 Test Loss: 1.909 Test Acc: 0.259
Validation loss decreased (-0.178103 --> -0.259356).  Saving model ...
Epoch: 3 cost time: 3.145031690597534
Epoch: 3, Steps: 8 | Train Loss: 0.847 Vali Loss: 1.774 Vali Acc: 0.350 Test Loss: 1.774 Test Acc: 0.350
Validation loss decreased (-0.259356 --> -0.349982).  Saving model ...
Epoch: 4 cost time: 3.419888973236084
Epoch: 4, Steps: 8 | Train Loss: 0.464 Vali Loss: 1.386 Vali Acc: 0.531 Test Loss: 1.386 Test Acc: 0.531
Validation loss decreased (-0.349982 --> -0.531236).  Saving model ...
Epoch: 5 cost time: 2.9304845333099365
Epoch: 5, Steps: 8 | Train Loss: 0.287 Vali Loss: 1.584 Vali Acc: 0.450 Test Loss: 1.584 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9139323234558105
Epoch: 6, Steps: 8 | Train Loss: 0.224 Vali Loss: 2.287 Vali Acc: 0.338 Test Loss: 2.287 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.499394178390503
Epoch: 7, Steps: 8 | Train Loss: 0.140 Vali Loss: 2.372 Vali Acc: 0.312 Test Loss: 2.372 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.213613748550415
Epoch: 8, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.978 Vali Acc: 0.400 Test Loss: 1.978 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.20686411857605
Epoch: 9, Steps: 8 | Train Loss: 0.037 Vali Loss: 2.012 Vali Acc: 0.416 Test Loss: 2.012 Test Acc: 0.416
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.083951950073242
Epoch: 10, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.690 Vali Acc: 0.512 Test Loss: 1.690 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2984189987182617
Epoch: 11, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.523 Vali Acc: 0.372 Test Loss: 2.523 Test Acc: 0.372
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.5691823959350586
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.777 Vali Acc: 0.391 Test Loss: 2.777 Test Acc: 0.391
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.237060785293579
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.813 Vali Acc: 0.388 Test Loss: 2.813 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.9151058197021484
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 3.544 Vali Acc: 0.362 Test Loss: 3.544 Test Acc: 0.362
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.53125
model parameter : 12592136
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.205931186676025
Epoch: 1, Steps: 8 | Train Loss: 2.116 Vali Loss: 2.011 Vali Acc: 0.144 Test Loss: 2.011 Test Acc: 0.144
Validation loss decreased (inf --> -0.143730).  Saving model ...
Epoch: 2 cost time: 2.9559133052825928
Epoch: 2, Steps: 8 | Train Loss: 1.592 Vali Loss: 1.463 Vali Acc: 0.491 Test Loss: 1.463 Test Acc: 0.491
Validation loss decreased (-0.143730 --> -0.490610).  Saving model ...
Epoch: 3 cost time: 3.0521936416625977
Epoch: 3, Steps: 8 | Train Loss: 0.895 Vali Loss: 1.179 Vali Acc: 0.541 Test Loss: 1.179 Test Acc: 0.541
Validation loss decreased (-0.490610 --> -0.540613).  Saving model ...
Epoch: 4 cost time: 3.206028699874878
Epoch: 4, Steps: 8 | Train Loss: 0.472 Vali Loss: 1.546 Vali Acc: 0.478 Test Loss: 1.546 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1603546142578125
Epoch: 5, Steps: 8 | Train Loss: 0.294 Vali Loss: 2.178 Vali Acc: 0.438 Test Loss: 2.178 Test Acc: 0.438
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.502425193786621
Epoch: 6, Steps: 8 | Train Loss: 0.204 Vali Loss: 2.669 Vali Acc: 0.444 Test Loss: 2.669 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6343276500701904
Epoch: 7, Steps: 8 | Train Loss: 0.124 Vali Loss: 3.243 Vali Acc: 0.309 Test Loss: 3.243 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.614633798599243
Epoch: 8, Steps: 8 | Train Loss: 0.065 Vali Loss: 2.876 Vali Acc: 0.388 Test Loss: 2.876 Test Acc: 0.388
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.4445266723632812
Epoch: 9, Steps: 8 | Train Loss: 0.032 Vali Loss: 4.012 Vali Acc: 0.341 Test Loss: 4.012 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.236950397491455
Epoch: 10, Steps: 8 | Train Loss: 0.021 Vali Loss: 3.005 Vali Acc: 0.434 Test Loss: 3.005 Test Acc: 0.434
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.3411848545074463
Epoch: 11, Steps: 8 | Train Loss: 0.016 Vali Loss: 3.838 Vali Acc: 0.375 Test Loss: 3.838 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.0381662845611572
Epoch: 12, Steps: 8 | Train Loss: 0.011 Vali Loss: 3.628 Vali Acc: 0.394 Test Loss: 3.628 Test Acc: 0.394
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.959693193435669
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 3.602 Vali Acc: 0.456 Test Loss: 3.602 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.540625
model parameter : 12592136
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.341280221939087
Epoch: 1, Steps: 8 | Train Loss: 2.163 Vali Loss: 1.990 Vali Acc: 0.263 Test Loss: 1.990 Test Acc: 0.263
Validation loss decreased (inf --> -0.262480).  Saving model ...
Epoch: 2 cost time: 3.308271646499634
Epoch: 2, Steps: 8 | Train Loss: 1.683 Vali Loss: 1.444 Vali Acc: 0.481 Test Loss: 1.444 Test Acc: 0.481
Validation loss decreased (-0.262480 --> -0.481236).  Saving model ...
Epoch: 3 cost time: 3.2623238563537598
Epoch: 3, Steps: 8 | Train Loss: 0.963 Vali Loss: 1.282 Vali Acc: 0.503 Test Loss: 1.282 Test Acc: 0.503
Validation loss decreased (-0.481236 --> -0.503112).  Saving model ...
Epoch: 4 cost time: 3.1136744022369385
Epoch: 4, Steps: 8 | Train Loss: 0.522 Vali Loss: 1.631 Vali Acc: 0.506 Test Loss: 1.631 Test Acc: 0.506
Validation loss decreased (-0.503112 --> -0.506234).  Saving model ...
Epoch: 5 cost time: 3.2725272178649902
Epoch: 5, Steps: 8 | Train Loss: 0.384 Vali Loss: 2.437 Vali Acc: 0.416 Test Loss: 2.437 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7082390785217285
Epoch: 6, Steps: 8 | Train Loss: 0.227 Vali Loss: 3.134 Vali Acc: 0.378 Test Loss: 3.134 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4675917625427246
Epoch: 7, Steps: 8 | Train Loss: 0.129 Vali Loss: 3.529 Vali Acc: 0.297 Test Loss: 3.529 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9752023220062256
Epoch: 8, Steps: 8 | Train Loss: 0.069 Vali Loss: 3.076 Vali Acc: 0.428 Test Loss: 3.076 Test Acc: 0.428
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.34285831451416
Epoch: 9, Steps: 8 | Train Loss: 0.047 Vali Loss: 3.675 Vali Acc: 0.338 Test Loss: 3.675 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.0271430015563965
Epoch: 10, Steps: 8 | Train Loss: 0.026 Vali Loss: 3.974 Vali Acc: 0.425 Test Loss: 3.974 Test Acc: 0.425
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.3160645961761475
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 5.066 Vali Acc: 0.331 Test Loss: 5.066 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9798424243927
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 4.343 Vali Acc: 0.372 Test Loss: 4.343 Test Acc: 0.372
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.026641845703125
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 4.946 Vali Acc: 0.359 Test Loss: 4.946 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8807454109191895
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 4.030 Vali Acc: 0.444 Test Loss: 4.030 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.50625
model parameter : 12592136
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.307153224945068
Epoch: 1, Steps: 8 | Train Loss: 2.040 Vali Loss: 1.249 Vali Acc: 0.603 Test Loss: 1.249 Test Acc: 0.603
Validation loss decreased (inf --> -0.603113).  Saving model ...
Epoch: 2 cost time: 3.189849853515625
Epoch: 2, Steps: 8 | Train Loss: 0.866 Vali Loss: 0.902 Vali Acc: 0.716 Test Loss: 0.902 Test Acc: 0.716
Validation loss decreased (-0.603113 --> -0.715616).  Saving model ...
Epoch: 3 cost time: 3.3363375663757324
Epoch: 3, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.895 Vali Acc: 0.728 Test Loss: 0.895 Test Acc: 0.728
Validation loss decreased (-0.715616 --> -0.728116).  Saving model ...
Epoch: 4 cost time: 3.684098958969116
Epoch: 4, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.463 Vali Acc: 0.719 Test Loss: 1.463 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.743543863296509
Epoch: 5, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.431 Vali Acc: 0.700 Test Loss: 1.431 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.174931287765503
Epoch: 6, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.517 Vali Acc: 0.725 Test Loss: 1.517 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9398179054260254
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.722 Vali Acc: 0.694 Test Loss: 1.722 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.3611021041870117
Epoch: 8, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.782 Vali Acc: 0.716 Test Loss: 1.782 Test Acc: 0.716
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.8903162479400635
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.955 Vali Acc: 0.722 Test Loss: 1.955 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.075872182846069
Epoch: 10, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.909 Vali Acc: 0.731 Test Loss: 1.909 Test Acc: 0.731
Validation loss decreased (-0.728116 --> -0.731231).  Saving model ...
Epoch: 11 cost time: 3.4734740257263184
Epoch: 11, Steps: 8 | Train Loss: 0.066 Vali Loss: 2.181 Vali Acc: 0.734 Test Loss: 2.181 Test Acc: 0.734
Validation loss decreased (-0.731231 --> -0.734353).  Saving model ...
Epoch: 12 cost time: 3.3433361053466797
Epoch: 12, Steps: 8 | Train Loss: 0.039 Vali Loss: 2.017 Vali Acc: 0.728 Test Loss: 2.017 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.255014657974243
Epoch: 13, Steps: 8 | Train Loss: 0.056 Vali Loss: 2.077 Vali Acc: 0.719 Test Loss: 2.077 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.94828724861145
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.763 Vali Acc: 0.662 Test Loss: 2.763 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3119401931762695
Epoch: 15, Steps: 8 | Train Loss: 0.048 Vali Loss: 3.242 Vali Acc: 0.637 Test Loss: 3.242 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.7196567058563232
Epoch: 16, Steps: 8 | Train Loss: 0.058 Vali Loss: 3.250 Vali Acc: 0.713 Test Loss: 3.250 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.047838926315308
Epoch: 17, Steps: 8 | Train Loss: 0.181 Vali Loss: 3.608 Vali Acc: 0.709 Test Loss: 3.608 Test Acc: 0.709
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.57582950592041
Epoch: 18, Steps: 8 | Train Loss: 0.260 Vali Loss: 3.840 Vali Acc: 0.703 Test Loss: 3.840 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.2982327938079834
Epoch: 19, Steps: 8 | Train Loss: 0.115 Vali Loss: 3.779 Vali Acc: 0.706 Test Loss: 3.779 Test Acc: 0.706
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.630284309387207
Epoch: 20, Steps: 8 | Train Loss: 0.073 Vali Loss: 3.951 Vali Acc: 0.716 Test Loss: 3.951 Test Acc: 0.716
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.6742708683013916
Epoch: 21, Steps: 8 | Train Loss: 0.284 Vali Loss: 3.662 Vali Acc: 0.766 Test Loss: 3.662 Test Acc: 0.766
Validation loss decreased (-0.734353 --> -0.765588).  Saving model ...
Epoch: 22 cost time: 3.4159228801727295
Epoch: 22, Steps: 8 | Train Loss: 0.197 Vali Loss: 3.565 Vali Acc: 0.772 Test Loss: 3.565 Test Acc: 0.772
Validation loss decreased (-0.765588 --> -0.771839).  Saving model ...
Epoch: 23 cost time: 3.657470226287842
Epoch: 23, Steps: 8 | Train Loss: 0.086 Vali Loss: 4.267 Vali Acc: 0.719 Test Loss: 4.267 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.5406293869018555
Epoch: 24, Steps: 8 | Train Loss: 0.075 Vali Loss: 4.835 Vali Acc: 0.691 Test Loss: 4.835 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.6080820560455322
Epoch: 25, Steps: 8 | Train Loss: 0.272 Vali Loss: 4.865 Vali Acc: 0.716 Test Loss: 4.865 Test Acc: 0.716
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.845022439956665
Epoch: 26, Steps: 8 | Train Loss: 0.024 Vali Loss: 4.658 Vali Acc: 0.713 Test Loss: 4.658 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.552887201309204
Epoch: 27, Steps: 8 | Train Loss: 0.072 Vali Loss: 5.567 Vali Acc: 0.713 Test Loss: 5.567 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.374901533126831
Epoch: 28, Steps: 8 | Train Loss: 0.404 Vali Loss: 6.522 Vali Acc: 0.722 Test Loss: 6.522 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.2559802532196045
Epoch: 29, Steps: 8 | Train Loss: 0.380 Vali Loss: 5.919 Vali Acc: 0.706 Test Loss: 5.919 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.6349217891693115
Epoch: 30, Steps: 8 | Train Loss: 0.032 Vali Loss: 7.141 Vali Acc: 0.713 Test Loss: 7.141 Test Acc: 0.713
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.879678726196289
Epoch: 31, Steps: 8 | Train Loss: 0.098 Vali Loss: 5.866 Vali Acc: 0.728 Test Loss: 5.866 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.2410738468170166
Epoch: 32, Steps: 8 | Train Loss: 0.218 Vali Loss: 6.006 Vali Acc: 0.734 Test Loss: 6.006 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.771875
model parameter : 12198920
model size : 66.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.355688571929932
Epoch: 1, Steps: 8 | Train Loss: 2.067 Vali Loss: 1.428 Vali Acc: 0.497 Test Loss: 1.428 Test Acc: 0.497
Validation loss decreased (inf --> -0.496861).  Saving model ...
Epoch: 2 cost time: 3.5525012016296387
Epoch: 2, Steps: 8 | Train Loss: 1.028 Vali Loss: 1.233 Vali Acc: 0.619 Test Loss: 1.233 Test Acc: 0.619
Validation loss decreased (-0.496861 --> -0.618738).  Saving model ...
Epoch: 3 cost time: 3.0393967628479004
Epoch: 3, Steps: 8 | Train Loss: 0.474 Vali Loss: 1.063 Vali Acc: 0.688 Test Loss: 1.063 Test Acc: 0.688
Validation loss decreased (-0.618738 --> -0.687489).  Saving model ...
Epoch: 4 cost time: 2.7994933128356934
Epoch: 4, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.715 Vali Acc: 0.622 Test Loss: 1.715 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.189528703689575
Epoch: 5, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.502 Vali Acc: 0.672 Test Loss: 1.502 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5761430263519287
Epoch: 6, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.767 Vali Acc: 0.644 Test Loss: 1.767 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.346665620803833
Epoch: 7, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.874 Vali Acc: 0.662 Test Loss: 1.874 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.1008009910583496
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.009 Vali Acc: 0.653 Test Loss: 2.009 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.1161746978759766
Epoch: 9, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.855 Vali Acc: 0.691 Test Loss: 1.855 Test Acc: 0.691
Validation loss decreased (-0.687489 --> -0.690606).  Saving model ...
Epoch: 10 cost time: 3.3305892944335938
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.439 Vali Acc: 0.647 Test Loss: 2.439 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.538022518157959
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.514 Vali Acc: 0.637 Test Loss: 2.514 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7074272632598877
Epoch: 12, Steps: 8 | Train Loss: 0.083 Vali Loss: 3.372 Vali Acc: 0.613 Test Loss: 3.372 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.627558469772339
Epoch: 13, Steps: 8 | Train Loss: 0.067 Vali Loss: 2.521 Vali Acc: 0.709 Test Loss: 2.521 Test Acc: 0.709
Validation loss decreased (-0.690606 --> -0.709350).  Saving model ...
Epoch: 14 cost time: 3.5511021614074707
Epoch: 14, Steps: 8 | Train Loss: 0.086 Vali Loss: 2.879 Vali Acc: 0.672 Test Loss: 2.879 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7230350971221924
Epoch: 15, Steps: 8 | Train Loss: 0.273 Vali Loss: 4.458 Vali Acc: 0.613 Test Loss: 4.458 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.60727858543396
Epoch: 16, Steps: 8 | Train Loss: 0.226 Vali Loss: 4.577 Vali Acc: 0.631 Test Loss: 4.577 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.347057342529297
Epoch: 17, Steps: 8 | Train Loss: 0.129 Vali Loss: 4.514 Vali Acc: 0.597 Test Loss: 4.514 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.347231864929199
Epoch: 18, Steps: 8 | Train Loss: 0.299 Vali Loss: 4.517 Vali Acc: 0.669 Test Loss: 4.517 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.371678113937378
Epoch: 19, Steps: 8 | Train Loss: 0.527 Vali Loss: 3.775 Vali Acc: 0.703 Test Loss: 3.775 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.35050892829895
Epoch: 20, Steps: 8 | Train Loss: 0.262 Vali Loss: 4.187 Vali Acc: 0.675 Test Loss: 4.187 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.108376979827881
Epoch: 21, Steps: 8 | Train Loss: 0.151 Vali Loss: 4.241 Vali Acc: 0.719 Test Loss: 4.241 Test Acc: 0.719
Validation loss decreased (-0.709350 --> -0.718708).  Saving model ...
Epoch: 22 cost time: 3.2218596935272217
Epoch: 22, Steps: 8 | Train Loss: 0.066 Vali Loss: 4.061 Vali Acc: 0.675 Test Loss: 4.061 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1090760231018066
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 5.534 Vali Acc: 0.619 Test Loss: 5.534 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.798516035079956
Epoch: 24, Steps: 8 | Train Loss: 0.120 Vali Loss: 5.675 Vali Acc: 0.644 Test Loss: 5.675 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.4187920093536377
Epoch: 25, Steps: 8 | Train Loss: 0.064 Vali Loss: 6.190 Vali Acc: 0.666 Test Loss: 6.190 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.3562421798706055
Epoch: 26, Steps: 8 | Train Loss: 0.074 Vali Loss: 6.812 Vali Acc: 0.625 Test Loss: 6.812 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.1925339698791504
Epoch: 27, Steps: 8 | Train Loss: 0.217 Vali Loss: 5.934 Vali Acc: 0.647 Test Loss: 5.934 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.6503779888153076
Epoch: 28, Steps: 8 | Train Loss: 0.106 Vali Loss: 6.778 Vali Acc: 0.694 Test Loss: 6.778 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.8649752140045166
Epoch: 29, Steps: 8 | Train Loss: 0.285 Vali Loss: 6.401 Vali Acc: 0.672 Test Loss: 6.401 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.7203919887542725
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 6.470 Vali Acc: 0.662 Test Loss: 6.470 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.5325753688812256
Epoch: 31, Steps: 8 | Train Loss: 0.113 Vali Loss: 6.467 Vali Acc: 0.669 Test Loss: 6.467 Test Acc: 0.669
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.71875
model parameter : 12198920
model size : 66.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.355177402496338
Epoch: 1, Steps: 8 | Train Loss: 2.135 Vali Loss: 1.562 Vali Acc: 0.487 Test Loss: 1.562 Test Acc: 0.487
Validation loss decreased (inf --> -0.487484).  Saving model ...
Epoch: 2 cost time: 3.5252459049224854
Epoch: 2, Steps: 8 | Train Loss: 1.140 Vali Loss: 1.246 Vali Acc: 0.556 Test Loss: 1.246 Test Acc: 0.556
Validation loss decreased (-0.487484 --> -0.556238).  Saving model ...
Epoch: 3 cost time: 3.18560528755188
Epoch: 3, Steps: 8 | Train Loss: 0.537 Vali Loss: 1.191 Vali Acc: 0.625 Test Loss: 1.191 Test Acc: 0.625
Validation loss decreased (-0.556238 --> -0.624988).  Saving model ...
Epoch: 4 cost time: 3.11185359954834
Epoch: 4, Steps: 8 | Train Loss: 0.277 Vali Loss: 1.680 Vali Acc: 0.600 Test Loss: 1.680 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.262451648712158
Epoch: 5, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.521 Vali Acc: 0.588 Test Loss: 1.521 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1856892108917236
Epoch: 6, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.742 Vali Acc: 0.606 Test Loss: 1.742 Test Acc: 0.606
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.5483899116516113
Epoch: 7, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.676 Vali Acc: 0.641 Test Loss: 1.676 Test Acc: 0.641
Validation loss decreased (-0.624988 --> -0.640608).  Saving model ...
Epoch: 8 cost time: 3.496215343475342
Epoch: 8, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.837 Vali Acc: 0.628 Test Loss: 1.837 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.734306573867798
Epoch: 9, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.862 Vali Acc: 0.653 Test Loss: 1.862 Test Acc: 0.653
Validation loss decreased (-0.640608 --> -0.653106).  Saving model ...
Epoch: 10 cost time: 3.4738903045654297
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.326 Vali Acc: 0.625 Test Loss: 2.326 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6988091468811035
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 2.285 Vali Acc: 0.616 Test Loss: 2.285 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.688262462615967
Epoch: 12, Steps: 8 | Train Loss: 0.028 Vali Loss: 2.468 Vali Acc: 0.594 Test Loss: 2.468 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1968746185302734
Epoch: 13, Steps: 8 | Train Loss: 0.086 Vali Loss: 2.962 Vali Acc: 0.559 Test Loss: 2.962 Test Acc: 0.559
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0340750217437744
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.381 Vali Acc: 0.631 Test Loss: 2.381 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2038626670837402
Epoch: 15, Steps: 8 | Train Loss: 0.033 Vali Loss: 3.043 Vali Acc: 0.603 Test Loss: 3.043 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2002272605895996
Epoch: 16, Steps: 8 | Train Loss: 0.161 Vali Loss: 4.067 Vali Acc: 0.622 Test Loss: 4.067 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.3872921466827393
Epoch: 17, Steps: 8 | Train Loss: 0.114 Vali Loss: 2.966 Vali Acc: 0.631 Test Loss: 2.966 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.568425416946411
Epoch: 18, Steps: 8 | Train Loss: 0.029 Vali Loss: 3.205 Vali Acc: 0.628 Test Loss: 3.205 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.923689365386963
Epoch: 19, Steps: 8 | Train Loss: 0.031 Vali Loss: 3.401 Vali Acc: 0.675 Test Loss: 3.401 Test Acc: 0.675
Validation loss decreased (-0.653106 --> -0.674966).  Saving model ...
Epoch: 20 cost time: 3.5302131175994873
Epoch: 20, Steps: 8 | Train Loss: 0.075 Vali Loss: 3.646 Vali Acc: 0.684 Test Loss: 3.646 Test Acc: 0.684
Validation loss decreased (-0.674966 --> -0.684339).  Saving model ...
Epoch: 21 cost time: 3.976778030395508
Epoch: 21, Steps: 8 | Train Loss: 0.040 Vali Loss: 3.764 Vali Acc: 0.681 Test Loss: 3.764 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8437631130218506
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 3.969 Vali Acc: 0.637 Test Loss: 3.969 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3774912357330322
Epoch: 23, Steps: 8 | Train Loss: 0.055 Vali Loss: 3.947 Vali Acc: 0.675 Test Loss: 3.947 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.3295836448669434
Epoch: 24, Steps: 8 | Train Loss: 0.031 Vali Loss: 4.149 Vali Acc: 0.666 Test Loss: 4.149 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.4016764163970947
Epoch: 25, Steps: 8 | Train Loss: 0.089 Vali Loss: 4.268 Vali Acc: 0.647 Test Loss: 4.268 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.544107675552368
Epoch: 26, Steps: 8 | Train Loss: 0.024 Vali Loss: 4.618 Vali Acc: 0.650 Test Loss: 4.618 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.2264187335968018
Epoch: 27, Steps: 8 | Train Loss: 0.251 Vali Loss: 4.540 Vali Acc: 0.622 Test Loss: 4.540 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.3649539947509766
Epoch: 28, Steps: 8 | Train Loss: 0.202 Vali Loss: 4.247 Vali Acc: 0.706 Test Loss: 4.247 Test Acc: 0.706
Validation loss decreased (-0.684339 --> -0.706208).  Saving model ...
Epoch: 29 cost time: 3.5528926849365234
Epoch: 29, Steps: 8 | Train Loss: 0.061 Vali Loss: 6.005 Vali Acc: 0.650 Test Loss: 6.005 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.343749523162842
Epoch: 30, Steps: 8 | Train Loss: 0.099 Vali Loss: 5.776 Vali Acc: 0.691 Test Loss: 5.776 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.560699939727783
Epoch: 31, Steps: 8 | Train Loss: 0.118 Vali Loss: 6.658 Vali Acc: 0.678 Test Loss: 6.658 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.694103240966797
Epoch: 32, Steps: 8 | Train Loss: 0.086 Vali Loss: 6.064 Vali Acc: 0.641 Test Loss: 6.064 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.346048593521118
Epoch: 33, Steps: 8 | Train Loss: 0.187 Vali Loss: 5.802 Vali Acc: 0.647 Test Loss: 5.802 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.650317430496216
Epoch: 34, Steps: 8 | Train Loss: 0.242 Vali Loss: 7.909 Vali Acc: 0.594 Test Loss: 7.909 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.368091344833374
Epoch: 35, Steps: 8 | Train Loss: 0.160 Vali Loss: 8.480 Vali Acc: 0.647 Test Loss: 8.480 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.8661577701568604
Epoch: 36, Steps: 8 | Train Loss: 0.125 Vali Loss: 7.583 Vali Acc: 0.622 Test Loss: 7.583 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.037952423095703
Epoch: 37, Steps: 8 | Train Loss: 0.099 Vali Loss: 8.093 Vali Acc: 0.644 Test Loss: 8.093 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.3386051654815674
Epoch: 38, Steps: 8 | Train Loss: 0.217 Vali Loss: 9.432 Vali Acc: 0.566 Test Loss: 9.432 Test Acc: 0.566
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.70625
model parameter : 12198920
model size : 66.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.663571119308472
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 1.773 Vali Acc: 0.350 Test Loss: 1.773 Test Acc: 0.350
Validation loss decreased (inf --> -0.349982).  Saving model ...
Epoch: 2 cost time: 3.215256690979004
Epoch: 2, Steps: 8 | Train Loss: 1.317 Vali Loss: 1.385 Vali Acc: 0.487 Test Loss: 1.385 Test Acc: 0.487
Validation loss decreased (-0.349982 --> -0.487486).  Saving model ...
Epoch: 3 cost time: 2.8696794509887695
Epoch: 3, Steps: 8 | Train Loss: 0.665 Vali Loss: 1.303 Vali Acc: 0.581 Test Loss: 1.303 Test Acc: 0.581
Validation loss decreased (-0.487486 --> -0.581237).  Saving model ...
Epoch: 4 cost time: 3.009697914123535
Epoch: 4, Steps: 8 | Train Loss: 0.434 Vali Loss: 1.561 Vali Acc: 0.572 Test Loss: 1.561 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.644105911254883
Epoch: 5, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.886 Vali Acc: 0.484 Test Loss: 1.886 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.120581865310669
Epoch: 6, Steps: 8 | Train Loss: 0.170 Vali Loss: 2.252 Vali Acc: 0.547 Test Loss: 2.252 Test Acc: 0.547
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.5801637172698975
Epoch: 7, Steps: 8 | Train Loss: 0.145 Vali Loss: 2.168 Vali Acc: 0.525 Test Loss: 2.168 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.502734661102295
Epoch: 8, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.907 Vali Acc: 0.597 Test Loss: 1.907 Test Acc: 0.597
Validation loss decreased (-0.581237 --> -0.596856).  Saving model ...
Epoch: 9 cost time: 3.65500545501709
Epoch: 9, Steps: 8 | Train Loss: 0.223 Vali Loss: 2.076 Vali Acc: 0.613 Test Loss: 2.076 Test Acc: 0.613
Validation loss decreased (-0.596856 --> -0.612479).  Saving model ...
Epoch: 10 cost time: 3.489449977874756
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 2.240 Vali Acc: 0.616 Test Loss: 2.240 Test Acc: 0.616
Validation loss decreased (-0.612479 --> -0.615603).  Saving model ...
Epoch: 11 cost time: 3.6844701766967773
Epoch: 11, Steps: 8 | Train Loss: 0.285 Vali Loss: 2.346 Vali Acc: 0.625 Test Loss: 2.346 Test Acc: 0.625
Validation loss decreased (-0.615603 --> -0.624977).  Saving model ...
Epoch: 12 cost time: 3.649235486984253
Epoch: 12, Steps: 8 | Train Loss: 0.054 Vali Loss: 2.359 Vali Acc: 0.609 Test Loss: 2.359 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3715715408325195
Epoch: 13, Steps: 8 | Train Loss: 0.057 Vali Loss: 2.291 Vali Acc: 0.606 Test Loss: 2.291 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.227055072784424
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 3.053 Vali Acc: 0.544 Test Loss: 3.053 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0178675651550293
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.774 Vali Acc: 0.566 Test Loss: 2.774 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2135305404663086
Epoch: 16, Steps: 8 | Train Loss: 0.027 Vali Loss: 2.559 Vali Acc: 0.588 Test Loss: 2.559 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.3900773525238037
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 3.350 Vali Acc: 0.547 Test Loss: 3.350 Test Acc: 0.547
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.094078302383423
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 2.471 Vali Acc: 0.656 Test Loss: 2.471 Test Acc: 0.656
Validation loss decreased (-0.624977 --> -0.656225).  Saving model ...
Epoch: 19 cost time: 3.517320156097412
Epoch: 19, Steps: 8 | Train Loss: 0.524 Vali Loss: 3.474 Vali Acc: 0.591 Test Loss: 3.474 Test Acc: 0.591
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.960705518722534
Epoch: 20, Steps: 8 | Train Loss: 0.124 Vali Loss: 4.526 Vali Acc: 0.544 Test Loss: 4.526 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.199131488800049
Epoch: 21, Steps: 8 | Train Loss: 0.139 Vali Loss: 4.135 Vali Acc: 0.547 Test Loss: 4.135 Test Acc: 0.547
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.083467483520508
Epoch: 22, Steps: 8 | Train Loss: 0.153 Vali Loss: 4.009 Vali Acc: 0.584 Test Loss: 4.009 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0503218173980713
Epoch: 23, Steps: 8 | Train Loss: 0.081 Vali Loss: 4.814 Vali Acc: 0.534 Test Loss: 4.814 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.191279649734497
Epoch: 24, Steps: 8 | Train Loss: 0.089 Vali Loss: 6.650 Vali Acc: 0.487 Test Loss: 6.650 Test Acc: 0.487
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1628379821777344
Epoch: 25, Steps: 8 | Train Loss: 0.080 Vali Loss: 7.296 Vali Acc: 0.566 Test Loss: 7.296 Test Acc: 0.566
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.534389019012451
Epoch: 26, Steps: 8 | Train Loss: 0.477 Vali Loss: 4.624 Vali Acc: 0.594 Test Loss: 4.624 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.6979715824127197
Epoch: 27, Steps: 8 | Train Loss: 0.077 Vali Loss: 5.510 Vali Acc: 0.588 Test Loss: 5.510 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.660220146179199
Epoch: 28, Steps: 8 | Train Loss: 0.023 Vali Loss: 5.964 Vali Acc: 0.562 Test Loss: 5.964 Test Acc: 0.562
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.65625
model parameter : 12198920
model size : 66.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.041750907897949
Epoch: 1, Steps: 8 | Train Loss: 2.158 Vali Loss: 1.932 Vali Acc: 0.256 Test Loss: 1.932 Test Acc: 0.256
Validation loss decreased (inf --> -0.256231).  Saving model ...
Epoch: 2 cost time: 3.1858069896698
Epoch: 2, Steps: 8 | Train Loss: 1.537 Vali Loss: 1.807 Vali Acc: 0.322 Test Loss: 1.807 Test Acc: 0.322
Validation loss decreased (-0.256231 --> -0.321857).  Saving model ...
Epoch: 3 cost time: 3.220935344696045
Epoch: 3, Steps: 8 | Train Loss: 0.859 Vali Loss: 1.542 Vali Acc: 0.400 Test Loss: 1.542 Test Acc: 0.400
Validation loss decreased (-0.321857 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 3.196953058242798
Epoch: 4, Steps: 8 | Train Loss: 0.495 Vali Loss: 1.725 Vali Acc: 0.466 Test Loss: 1.725 Test Acc: 0.466
Validation loss decreased (-0.399985 --> -0.465608).  Saving model ...
Epoch: 5 cost time: 3.450317621231079
Epoch: 5, Steps: 8 | Train Loss: 0.223 Vali Loss: 2.107 Vali Acc: 0.384 Test Loss: 2.107 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0515239238739014
Epoch: 6, Steps: 8 | Train Loss: 0.245 Vali Loss: 3.223 Vali Acc: 0.331 Test Loss: 3.223 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9191205501556396
Epoch: 7, Steps: 8 | Train Loss: 0.287 Vali Loss: 2.955 Vali Acc: 0.347 Test Loss: 2.955 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9477789402008057
Epoch: 8, Steps: 8 | Train Loss: 0.159 Vali Loss: 2.925 Vali Acc: 0.369 Test Loss: 2.925 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9119138717651367
Epoch: 9, Steps: 8 | Train Loss: 0.213 Vali Loss: 3.342 Vali Acc: 0.366 Test Loss: 3.342 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.568044662475586
Epoch: 10, Steps: 8 | Train Loss: 0.146 Vali Loss: 2.848 Vali Acc: 0.453 Test Loss: 2.848 Test Acc: 0.453
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.456974983215332
Epoch: 11, Steps: 8 | Train Loss: 0.113 Vali Loss: 2.394 Vali Acc: 0.509 Test Loss: 2.394 Test Acc: 0.509
Validation loss decreased (-0.465608 --> -0.509351).  Saving model ...
Epoch: 12 cost time: 3.584076404571533
Epoch: 12, Steps: 8 | Train Loss: 0.067 Vali Loss: 2.455 Vali Acc: 0.494 Test Loss: 2.455 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2450265884399414
Epoch: 13, Steps: 8 | Train Loss: 0.140 Vali Loss: 2.703 Vali Acc: 0.512 Test Loss: 2.703 Test Acc: 0.512
Validation loss decreased (-0.509351 --> -0.512473).  Saving model ...
Epoch: 14 cost time: 3.237964630126953
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 3.154 Vali Acc: 0.453 Test Loss: 3.154 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1176211833953857
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 3.056 Vali Acc: 0.453 Test Loss: 3.056 Test Acc: 0.453
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.676400899887085
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.825 Vali Acc: 0.491 Test Loss: 2.825 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.6242475509643555
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.842 Vali Acc: 0.494 Test Loss: 2.842 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0872087478637695
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 3.885 Vali Acc: 0.394 Test Loss: 3.885 Test Acc: 0.394
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.042752981185913
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 3.419 Vali Acc: 0.412 Test Loss: 3.419 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.125786066055298
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.850 Vali Acc: 0.512 Test Loss: 2.850 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.2679803371429443
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 3.129 Vali Acc: 0.447 Test Loss: 3.129 Test Acc: 0.447
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.3152079582214355
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.384 Vali Acc: 0.425 Test Loss: 3.384 Test Acc: 0.425
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.5870702266693115
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.159 Vali Acc: 0.453 Test Loss: 3.159 Test Acc: 0.453
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5125
model parameter : 12198920
model size : 66.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.910718202590942
Epoch: 1, Steps: 8 | Train Loss: 2.198 Vali Loss: 2.022 Vali Acc: 0.197 Test Loss: 2.022 Test Acc: 0.197
Validation loss decreased (inf --> -0.196855).  Saving model ...
Epoch: 2 cost time: 3.3369925022125244
Epoch: 2, Steps: 8 | Train Loss: 1.705 Vali Loss: 1.922 Vali Acc: 0.250 Test Loss: 1.922 Test Acc: 0.250
Validation loss decreased (-0.196855 --> -0.249981).  Saving model ...
Epoch: 3 cost time: 3.3618266582489014
Epoch: 3, Steps: 8 | Train Loss: 0.969 Vali Loss: 1.552 Vali Acc: 0.347 Test Loss: 1.552 Test Acc: 0.347
Validation loss decreased (-0.249981 --> -0.346859).  Saving model ...
Epoch: 4 cost time: 3.46121883392334
Epoch: 4, Steps: 8 | Train Loss: 0.539 Vali Loss: 1.516 Vali Acc: 0.478 Test Loss: 1.516 Test Acc: 0.478
Validation loss decreased (-0.346859 --> -0.478110).  Saving model ...
Epoch: 5 cost time: 3.2197206020355225
Epoch: 5, Steps: 8 | Train Loss: 0.305 Vali Loss: 2.533 Vali Acc: 0.253 Test Loss: 2.533 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9981887340545654
Epoch: 6, Steps: 8 | Train Loss: 0.330 Vali Loss: 2.820 Vali Acc: 0.278 Test Loss: 2.820 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2855539321899414
Epoch: 7, Steps: 8 | Train Loss: 0.252 Vali Loss: 2.167 Vali Acc: 0.353 Test Loss: 2.167 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8605804443359375
Epoch: 8, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.826 Vali Acc: 0.447 Test Loss: 1.826 Test Acc: 0.447
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.934403419494629
Epoch: 9, Steps: 8 | Train Loss: 0.050 Vali Loss: 3.254 Vali Acc: 0.278 Test Loss: 3.254 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8489937782287598
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 2.161 Vali Acc: 0.406 Test Loss: 2.161 Test Acc: 0.406
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.102895736694336
Epoch: 11, Steps: 8 | Train Loss: 0.024 Vali Loss: 2.980 Vali Acc: 0.384 Test Loss: 2.980 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0684516429901123
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.263 Vali Acc: 0.362 Test Loss: 2.263 Test Acc: 0.362
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1260015964508057
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.498 Vali Acc: 0.366 Test Loss: 2.498 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.4443318843841553
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 3.266 Vali Acc: 0.291 Test Loss: 3.266 Test Acc: 0.291
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.478125
model parameter : 12198920
model size : 66.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.7545154094696045
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 2.044 Vali Acc: 0.219 Test Loss: 2.044 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 3.0973212718963623
Epoch: 2, Steps: 8 | Train Loss: 1.677 Vali Loss: 1.880 Vali Acc: 0.175 Test Loss: 1.880 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1214630603790283
Epoch: 3, Steps: 8 | Train Loss: 0.952 Vali Loss: 1.602 Vali Acc: 0.381 Test Loss: 1.602 Test Acc: 0.381
Validation loss decreased (-0.218730 --> -0.381234).  Saving model ...
Epoch: 4 cost time: 3.1228771209716797
Epoch: 4, Steps: 8 | Train Loss: 0.527 Vali Loss: 1.411 Vali Acc: 0.494 Test Loss: 1.411 Test Acc: 0.494
Validation loss decreased (-0.381234 --> -0.493736).  Saving model ...
Epoch: 5 cost time: 3.185283660888672
Epoch: 5, Steps: 8 | Train Loss: 0.281 Vali Loss: 2.121 Vali Acc: 0.275 Test Loss: 2.121 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1995725631713867
Epoch: 6, Steps: 8 | Train Loss: 0.246 Vali Loss: 2.519 Vali Acc: 0.244 Test Loss: 2.519 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1187245845794678
Epoch: 7, Steps: 8 | Train Loss: 0.242 Vali Loss: 2.583 Vali Acc: 0.312 Test Loss: 2.583 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2070181369781494
Epoch: 8, Steps: 8 | Train Loss: 0.119 Vali Loss: 2.157 Vali Acc: 0.316 Test Loss: 2.157 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2679903507232666
Epoch: 9, Steps: 8 | Train Loss: 0.092 Vali Loss: 2.892 Vali Acc: 0.359 Test Loss: 2.892 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.5911478996276855
Epoch: 10, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.639 Vali Acc: 0.487 Test Loss: 1.639 Test Acc: 0.487
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.223947525024414
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 3.330 Vali Acc: 0.353 Test Loss: 3.330 Test Acc: 0.353
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.631241321563721
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 2.034 Vali Acc: 0.481 Test Loss: 2.034 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.320258378982544
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 2.338 Vali Acc: 0.384 Test Loss: 2.338 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.195105314254761
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 3.435 Vali Acc: 0.266 Test Loss: 3.435 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.49375
model parameter : 12198920
model size : 66.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.9742302894592285
Epoch: 1, Steps: 8 | Train Loss: 2.184 Vali Loss: 2.055 Vali Acc: 0.206 Test Loss: 2.055 Test Acc: 0.206
Validation loss decreased (inf --> -0.206229).  Saving model ...
Epoch: 2 cost time: 3.9246230125427246
Epoch: 2, Steps: 8 | Train Loss: 1.653 Vali Loss: 1.756 Vali Acc: 0.281 Test Loss: 1.756 Test Acc: 0.281
Validation loss decreased (-0.206229 --> -0.281232).  Saving model ...
Epoch: 3 cost time: 3.246116876602173
Epoch: 3, Steps: 8 | Train Loss: 0.795 Vali Loss: 1.516 Vali Acc: 0.419 Test Loss: 1.516 Test Acc: 0.419
Validation loss decreased (-0.281232 --> -0.418735).  Saving model ...
Epoch: 4 cost time: 4.263936281204224
Epoch: 4, Steps: 8 | Train Loss: 0.452 Vali Loss: 1.270 Vali Acc: 0.616 Test Loss: 1.270 Test Acc: 0.616
Validation loss decreased (-0.418735 --> -0.615612).  Saving model ...
Epoch: 5 cost time: 4.093395709991455
Epoch: 5, Steps: 8 | Train Loss: 0.277 Vali Loss: 1.792 Vali Acc: 0.378 Test Loss: 1.792 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.314196348190308
Epoch: 6, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.866 Vali Acc: 0.403 Test Loss: 1.866 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.799583673477173
Epoch: 7, Steps: 8 | Train Loss: 0.123 Vali Loss: 2.542 Vali Acc: 0.362 Test Loss: 2.542 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.9617185592651367
Epoch: 8, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.974 Vali Acc: 0.459 Test Loss: 1.974 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.105886459350586
Epoch: 9, Steps: 8 | Train Loss: 0.037 Vali Loss: 2.751 Vali Acc: 0.388 Test Loss: 2.751 Test Acc: 0.388
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.224299430847168
Epoch: 10, Steps: 8 | Train Loss: 0.029 Vali Loss: 2.203 Vali Acc: 0.459 Test Loss: 2.203 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.17509651184082
Epoch: 11, Steps: 8 | Train Loss: 0.029 Vali Loss: 3.932 Vali Acc: 0.381 Test Loss: 3.932 Test Acc: 0.381
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.246706008911133
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.840 Vali Acc: 0.438 Test Loss: 2.840 Test Acc: 0.438
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.359950304031372
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 3.050 Vali Acc: 0.409 Test Loss: 3.050 Test Acc: 0.409
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.197403907775879
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 3.181 Vali Acc: 0.428 Test Loss: 3.181 Test Acc: 0.428
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.615625
model parameter : 12198920
model size : 66.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.135998487472534
Epoch: 1, Steps: 8 | Train Loss: 2.160 Vali Loss: 2.034 Vali Acc: 0.291 Test Loss: 2.034 Test Acc: 0.291
Validation loss decreased (inf --> -0.290605).  Saving model ...
Epoch: 2 cost time: 3.9021496772766113
Epoch: 2, Steps: 8 | Train Loss: 1.702 Vali Loss: 1.424 Vali Acc: 0.516 Test Loss: 1.424 Test Acc: 0.516
Validation loss decreased (-0.290605 --> -0.515611).  Saving model ...
Epoch: 3 cost time: 3.8588740825653076
Epoch: 3, Steps: 8 | Train Loss: 0.868 Vali Loss: 1.221 Vali Acc: 0.559 Test Loss: 1.221 Test Acc: 0.559
Validation loss decreased (-0.515611 --> -0.559363).  Saving model ...
Epoch: 4 cost time: 3.7239601612091064
Epoch: 4, Steps: 8 | Train Loss: 0.451 Vali Loss: 1.485 Vali Acc: 0.566 Test Loss: 1.485 Test Acc: 0.566
Validation loss decreased (-0.559363 --> -0.565610).  Saving model ...
Epoch: 5 cost time: 3.874767303466797
Epoch: 5, Steps: 8 | Train Loss: 0.259 Vali Loss: 2.216 Vali Acc: 0.431 Test Loss: 2.216 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.846989154815674
Epoch: 6, Steps: 8 | Train Loss: 0.193 Vali Loss: 2.813 Vali Acc: 0.434 Test Loss: 2.813 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.4905784130096436
Epoch: 7, Steps: 8 | Train Loss: 0.129 Vali Loss: 3.266 Vali Acc: 0.375 Test Loss: 3.266 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.713762044906616
Epoch: 8, Steps: 8 | Train Loss: 0.051 Vali Loss: 2.975 Vali Acc: 0.394 Test Loss: 2.975 Test Acc: 0.394
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.26994514465332
Epoch: 9, Steps: 8 | Train Loss: 0.035 Vali Loss: 3.624 Vali Acc: 0.397 Test Loss: 3.624 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.769458055496216
Epoch: 10, Steps: 8 | Train Loss: 0.024 Vali Loss: 3.583 Vali Acc: 0.394 Test Loss: 3.583 Test Acc: 0.394
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.050434112548828
Epoch: 11, Steps: 8 | Train Loss: 0.023 Vali Loss: 4.652 Vali Acc: 0.381 Test Loss: 4.652 Test Acc: 0.381
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.51679253578186
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 3.892 Vali Acc: 0.416 Test Loss: 3.892 Test Acc: 0.416
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.281238079071045
Epoch: 13, Steps: 8 | Train Loss: 0.014 Vali Loss: 3.376 Vali Acc: 0.459 Test Loss: 3.376 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.202495098114014
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 3.796 Vali Acc: 0.416 Test Loss: 3.796 Test Acc: 0.416
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.565625
model parameter : 12198920
model size : 66.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.9624552726745605
Epoch: 1, Steps: 8 | Train Loss: 2.172 Vali Loss: 1.951 Vali Acc: 0.200 Test Loss: 1.951 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 3.8527026176452637
Epoch: 2, Steps: 8 | Train Loss: 1.747 Vali Loss: 1.413 Vali Acc: 0.525 Test Loss: 1.413 Test Acc: 0.525
Validation loss decreased (-0.199980 --> -0.524986).  Saving model ...
Epoch: 3 cost time: 4.122718334197998
Epoch: 3, Steps: 8 | Train Loss: 0.947 Vali Loss: 1.369 Vali Acc: 0.516 Test Loss: 1.369 Test Acc: 0.516
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.04422402381897
Epoch: 4, Steps: 8 | Train Loss: 0.511 Vali Loss: 1.582 Vali Acc: 0.509 Test Loss: 1.582 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.720795154571533
Epoch: 5, Steps: 8 | Train Loss: 0.338 Vali Loss: 2.497 Vali Acc: 0.406 Test Loss: 2.497 Test Acc: 0.406
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.947162628173828
Epoch: 6, Steps: 8 | Train Loss: 0.237 Vali Loss: 2.605 Vali Acc: 0.409 Test Loss: 2.605 Test Acc: 0.409
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.229132890701294
Epoch: 7, Steps: 8 | Train Loss: 0.126 Vali Loss: 3.275 Vali Acc: 0.372 Test Loss: 3.275 Test Acc: 0.372
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.705366849899292
Epoch: 8, Steps: 8 | Train Loss: 0.098 Vali Loss: 3.446 Vali Acc: 0.359 Test Loss: 3.446 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.483097553253174
Epoch: 9, Steps: 8 | Train Loss: 0.036 Vali Loss: 3.745 Vali Acc: 0.397 Test Loss: 3.745 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.448830842971802
Epoch: 10, Steps: 8 | Train Loss: 0.024 Vali Loss: 4.269 Vali Acc: 0.331 Test Loss: 4.269 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.147683382034302
Epoch: 11, Steps: 8 | Train Loss: 0.028 Vali Loss: 3.441 Vali Acc: 0.391 Test Loss: 3.441 Test Acc: 0.391
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.6662068367004395
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 4.316 Vali Acc: 0.400 Test Loss: 4.316 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.525
model parameter : 12198920
model size : 66.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.888277530670166
Epoch: 1, Steps: 8 | Train Loss: 2.099 Vali Loss: 1.531 Vali Acc: 0.572 Test Loss: 1.531 Test Acc: 0.572
Validation loss decreased (inf --> -0.571860).  Saving model ...
Epoch: 2 cost time: 2.8709022998809814
Epoch: 2, Steps: 8 | Train Loss: 1.074 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
Validation loss decreased (-0.571860 --> -0.756242).  Saving model ...
Epoch: 3 cost time: 3.0521392822265625
Epoch: 3, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.749 Vali Acc: 0.744 Test Loss: 0.749 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.875150442123413
Epoch: 4, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.869 Vali Acc: 0.753 Test Loss: 0.869 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2427525520324707
Epoch: 5, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.912 Vali Acc: 0.747 Test Loss: 0.912 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.272294521331787
Epoch: 6, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.022 Vali Acc: 0.753 Test Loss: 1.022 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.262120246887207
Epoch: 7, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.149 Vali Acc: 0.731 Test Loss: 1.149 Test Acc: 0.731
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9617631435394287
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.136 Vali Acc: 0.753 Test Loss: 1.136 Test Acc: 0.753
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.3699252605438232
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.141 Vali Acc: 0.762 Test Loss: 1.141 Test Acc: 0.762
Validation loss decreased (-0.756242 --> -0.762489).  Saving model ...
Epoch: 10 cost time: 3.1998276710510254
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.167 Vali Acc: 0.775 Test Loss: 1.167 Test Acc: 0.775
Validation loss decreased (-0.762489 --> -0.774988).  Saving model ...
Epoch: 11 cost time: 3.518834114074707
Epoch: 11, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.171 Vali Acc: 0.784 Test Loss: 1.171 Test Acc: 0.784
Validation loss decreased (-0.774988 --> -0.784363).  Saving model ...
Epoch: 12 cost time: 3.1335041522979736
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.382 Vali Acc: 0.750 Test Loss: 1.382 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.267042636871338
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.212 Vali Acc: 0.775 Test Loss: 1.212 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.169893264770508
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.200 Vali Acc: 0.762 Test Loss: 1.200 Test Acc: 0.762
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2819864749908447
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.766 Test Loss: 1.201 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.1965811252593994
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.766 Test Loss: 1.202 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9968552589416504
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.775 Test Loss: 1.206 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9930529594421387
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.778 Test Loss: 1.208 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.4221856594085693
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.775 Test Loss: 1.208 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.3379273414611816
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.772 Test Loss: 1.207 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.3215644359588623
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.772 Test Loss: 1.206 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.784375
model parameter : 6427144
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.932298183441162
Epoch: 1, Steps: 8 | Train Loss: 2.096 Vali Loss: 1.649 Vali Acc: 0.428 Test Loss: 1.649 Test Acc: 0.428
Validation loss decreased (inf --> -0.428109).  Saving model ...
Epoch: 2 cost time: 3.096578598022461
Epoch: 2, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.066 Vali Acc: 0.628 Test Loss: 1.066 Test Acc: 0.628
Validation loss decreased (-0.428109 --> -0.628114).  Saving model ...
Epoch: 3 cost time: 3.2886810302734375
Epoch: 3, Steps: 8 | Train Loss: 0.562 Vali Loss: 0.971 Vali Acc: 0.697 Test Loss: 0.971 Test Acc: 0.697
Validation loss decreased (-0.628114 --> -0.696865).  Saving model ...
Epoch: 4 cost time: 3.2601985931396484
Epoch: 4, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.109 Vali Acc: 0.691 Test Loss: 1.109 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0383338928222656
Epoch: 5, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.205 Vali Acc: 0.666 Test Loss: 1.205 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.261080741882324
Epoch: 6, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.421 Vali Acc: 0.647 Test Loss: 1.421 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.53843355178833
Epoch: 7, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.443 Vali Acc: 0.653 Test Loss: 1.443 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.404080629348755
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.380 Vali Acc: 0.691 Test Loss: 1.380 Test Acc: 0.691
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2795069217681885
Epoch: 9, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.468 Vali Acc: 0.684 Test Loss: 1.468 Test Acc: 0.684
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.06119966506958
Epoch: 10, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.506 Vali Acc: 0.694 Test Loss: 1.506 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.3542981147766113
Epoch: 11, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.574 Vali Acc: 0.684 Test Loss: 1.574 Test Acc: 0.684
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.411745548248291
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.562 Vali Acc: 0.719 Test Loss: 1.562 Test Acc: 0.719
Validation loss decreased (-0.696865 --> -0.718734).  Saving model ...
Epoch: 13 cost time: 3.4522247314453125
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.419 Vali Acc: 0.722 Test Loss: 1.419 Test Acc: 0.722
Validation loss decreased (-0.718734 --> -0.721861).  Saving model ...
Epoch: 14 cost time: 3.380159378051758
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.455 Vali Acc: 0.706 Test Loss: 1.455 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.281404733657837
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.462 Vali Acc: 0.700 Test Loss: 1.462 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0817527770996094
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.713 Test Loss: 1.462 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0809006690979004
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.716 Test Loss: 1.483 Test Acc: 0.716
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9070041179656982
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.713 Test Loss: 1.508 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.3943557739257812
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.716 Test Loss: 1.521 Test Acc: 0.716
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.091139078140259
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.709 Test Loss: 1.529 Test Acc: 0.709
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.8594183921813965
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.709 Test Loss: 1.531 Test Acc: 0.709
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.2275521755218506
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.713 Test Loss: 1.529 Test Acc: 0.713
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.277817726135254
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.713 Test Loss: 1.526 Test Acc: 0.713
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.721875
model parameter : 6427144
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.837091684341431
Epoch: 1, Steps: 8 | Train Loss: 2.075 Vali Loss: 1.736 Vali Acc: 0.400 Test Loss: 1.736 Test Acc: 0.400
Validation loss decreased (inf --> -0.399983).  Saving model ...
Epoch: 2 cost time: 3.582862377166748
Epoch: 2, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.185 Vali Acc: 0.588 Test Loss: 1.185 Test Acc: 0.588
Validation loss decreased (-0.399983 --> -0.587488).  Saving model ...
Epoch: 3 cost time: 3.450190544128418
Epoch: 3, Steps: 8 | Train Loss: 0.628 Vali Loss: 1.033 Vali Acc: 0.634 Test Loss: 1.033 Test Acc: 0.634
Validation loss decreased (-0.587488 --> -0.634365).  Saving model ...
Epoch: 4 cost time: 3.3124163150787354
Epoch: 4, Steps: 8 | Train Loss: 0.343 Vali Loss: 1.065 Vali Acc: 0.659 Test Loss: 1.065 Test Acc: 0.659
Validation loss decreased (-0.634365 --> -0.659364).  Saving model ...
Epoch: 5 cost time: 3.0728321075439453
Epoch: 5, Steps: 8 | Train Loss: 0.243 Vali Loss: 1.139 Vali Acc: 0.653 Test Loss: 1.139 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.208669900894165
Epoch: 6, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.280 Vali Acc: 0.666 Test Loss: 1.280 Test Acc: 0.666
Validation loss decreased (-0.659364 --> -0.665612).  Saving model ...
Epoch: 7 cost time: 3.3398523330688477
Epoch: 7, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.324 Vali Acc: 0.637 Test Loss: 1.324 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0809342861175537
Epoch: 8, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.416 Vali Acc: 0.650 Test Loss: 1.416 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.51076340675354
Epoch: 9, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.417 Vali Acc: 0.691 Test Loss: 1.417 Test Acc: 0.691
Validation loss decreased (-0.665612 --> -0.690611).  Saving model ...
Epoch: 10 cost time: 3.068984270095825
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.549 Vali Acc: 0.659 Test Loss: 1.549 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.212064027786255
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.532 Vali Acc: 0.662 Test Loss: 1.532 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.326032876968384
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.589 Vali Acc: 0.662 Test Loss: 1.589 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1957650184631348
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.560 Vali Acc: 0.672 Test Loss: 1.560 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2402374744415283
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.485 Vali Acc: 0.672 Test Loss: 1.485 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.232481002807617
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.675 Test Loss: 1.482 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4345200061798096
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.659 Test Loss: 1.490 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.6029398441314697
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.675 Test Loss: 1.497 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.655757427215576
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.675 Test Loss: 1.494 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.100363254547119
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.675 Test Loss: 1.476 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.690625
model parameter : 6427144
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.838215589523315
Epoch: 1, Steps: 8 | Train Loss: 2.106 Vali Loss: 1.870 Vali Acc: 0.294 Test Loss: 1.870 Test Acc: 0.294
Validation loss decreased (inf --> -0.293731).  Saving model ...
Epoch: 2 cost time: 3.206998586654663
Epoch: 2, Steps: 8 | Train Loss: 1.548 Vali Loss: 1.371 Vali Acc: 0.562 Test Loss: 1.371 Test Acc: 0.562
Validation loss decreased (-0.293731 --> -0.562486).  Saving model ...
Epoch: 3 cost time: 3.156731605529785
Epoch: 3, Steps: 8 | Train Loss: 0.832 Vali Loss: 1.137 Vali Acc: 0.562 Test Loss: 1.137 Test Acc: 0.562
Validation loss decreased (-0.562486 --> -0.562489).  Saving model ...
Epoch: 4 cost time: 3.2718663215637207
Epoch: 4, Steps: 8 | Train Loss: 0.484 Vali Loss: 1.112 Vali Acc: 0.584 Test Loss: 1.112 Test Acc: 0.584
Validation loss decreased (-0.562489 --> -0.584364).  Saving model ...
Epoch: 5 cost time: 3.083914041519165
Epoch: 5, Steps: 8 | Train Loss: 0.332 Vali Loss: 1.155 Vali Acc: 0.628 Test Loss: 1.155 Test Acc: 0.628
Validation loss decreased (-0.584364 --> -0.628113).  Saving model ...
Epoch: 6 cost time: 3.166578531265259
Epoch: 6, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.177 Vali Acc: 0.653 Test Loss: 1.177 Test Acc: 0.653
Validation loss decreased (-0.628113 --> -0.653113).  Saving model ...
Epoch: 7 cost time: 3.0985920429229736
Epoch: 7, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.337 Vali Acc: 0.625 Test Loss: 1.337 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0720131397247314
Epoch: 8, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.428 Vali Acc: 0.644 Test Loss: 1.428 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2340235710144043
Epoch: 9, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.385 Vali Acc: 0.644 Test Loss: 1.385 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7412962913513184
Epoch: 10, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.319 Vali Acc: 0.684 Test Loss: 1.319 Test Acc: 0.684
Validation loss decreased (-0.653113 --> -0.684362).  Saving model ...
Epoch: 11 cost time: 3.1994738578796387
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.753 Vali Acc: 0.622 Test Loss: 1.753 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.19755482673645
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.637 Vali Acc: 0.641 Test Loss: 1.637 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.321747064590454
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.741 Vali Acc: 0.628 Test Loss: 1.741 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.456927537918091
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.764 Vali Acc: 0.622 Test Loss: 1.764 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.288743734359741
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.580 Vali Acc: 0.656 Test Loss: 1.580 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.1985998153686523
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.542 Vali Acc: 0.662 Test Loss: 1.542 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.3486061096191406
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.678 Test Loss: 1.536 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.981353998184204
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.672 Test Loss: 1.532 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.1801156997680664
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.666 Test Loss: 1.549 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.4502217769622803
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.564 Vali Acc: 0.659 Test Loss: 1.564 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.684375
model parameter : 6427144
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.002907752990723
Epoch: 1, Steps: 8 | Train Loss: 2.123 Vali Loss: 2.001 Vali Acc: 0.134 Test Loss: 2.001 Test Acc: 0.134
Validation loss decreased (inf --> -0.134355).  Saving model ...
Epoch: 2 cost time: 2.959806442260742
Epoch: 2, Steps: 8 | Train Loss: 1.753 Vali Loss: 1.669 Vali Acc: 0.397 Test Loss: 1.669 Test Acc: 0.397
Validation loss decreased (-0.134355 --> -0.396858).  Saving model ...
Epoch: 3 cost time: 2.98944091796875
Epoch: 3, Steps: 8 | Train Loss: 1.143 Vali Loss: 1.467 Vali Acc: 0.434 Test Loss: 1.467 Test Acc: 0.434
Validation loss decreased (-0.396858 --> -0.434360).  Saving model ...
Epoch: 4 cost time: 3.226612091064453
Epoch: 4, Steps: 8 | Train Loss: 0.690 Vali Loss: 1.474 Vali Acc: 0.438 Test Loss: 1.474 Test Acc: 0.438
Validation loss decreased (-0.434360 --> -0.437485).  Saving model ...
Epoch: 5 cost time: 3.100388288497925
Epoch: 5, Steps: 8 | Train Loss: 0.502 Vali Loss: 1.537 Vali Acc: 0.459 Test Loss: 1.537 Test Acc: 0.459
Validation loss decreased (-0.437485 --> -0.459360).  Saving model ...
Epoch: 6 cost time: 3.1863715648651123
Epoch: 6, Steps: 8 | Train Loss: 0.295 Vali Loss: 1.537 Vali Acc: 0.475 Test Loss: 1.537 Test Acc: 0.475
Validation loss decreased (-0.459360 --> -0.474985).  Saving model ...
Epoch: 7 cost time: 3.3437812328338623
Epoch: 7, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.728 Vali Acc: 0.434 Test Loss: 1.728 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0787899494171143
Epoch: 8, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.723 Vali Acc: 0.500 Test Loss: 1.723 Test Acc: 0.500
Validation loss decreased (-0.474985 --> -0.499983).  Saving model ...
Epoch: 9 cost time: 3.1744163036346436
Epoch: 9, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.538 Vali Acc: 0.569 Test Loss: 1.538 Test Acc: 0.569
Validation loss decreased (-0.499983 --> -0.568735).  Saving model ...
Epoch: 10 cost time: 3.190680980682373
Epoch: 10, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.541 Vali Acc: 0.575 Test Loss: 1.541 Test Acc: 0.575
Validation loss decreased (-0.568735 --> -0.574985).  Saving model ...
Epoch: 11 cost time: 3.405088424682617
Epoch: 11, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.200 Vali Acc: 0.466 Test Loss: 2.200 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1865949630737305
Epoch: 12, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.716 Vali Acc: 0.566 Test Loss: 1.716 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5491511821746826
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.152 Vali Acc: 0.494 Test Loss: 2.152 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.52805495262146
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.760 Vali Acc: 0.588 Test Loss: 1.760 Test Acc: 0.588
Validation loss decreased (-0.574985 --> -0.587482).  Saving model ...
Epoch: 15 cost time: 3.235530138015747
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.293 Vali Acc: 0.522 Test Loss: 2.293 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1207053661346436
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.270 Vali Acc: 0.525 Test Loss: 2.270 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2026541233062744
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.109 Vali Acc: 0.569 Test Loss: 2.109 Test Acc: 0.569
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0909292697906494
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.972 Vali Acc: 0.581 Test Loss: 1.972 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.20246958732605
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.938 Vali Acc: 0.588 Test Loss: 1.938 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.164794921875
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.097 Vali Acc: 0.566 Test Loss: 2.097 Test Acc: 0.566
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.9399564266204834
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.408 Vali Acc: 0.556 Test Loss: 2.408 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.127173662185669
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.177 Vali Acc: 0.584 Test Loss: 2.177 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.059194564819336
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.544 Vali Acc: 0.531 Test Loss: 2.544 Test Acc: 0.531
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.2307000160217285
Epoch: 24, Steps: 8 | Train Loss: 0.038 Vali Loss: 2.386 Vali Acc: 0.566 Test Loss: 2.386 Test Acc: 0.566
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5875
model parameter : 6427144
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.51772141456604
Epoch: 1, Steps: 8 | Train Loss: 2.163 Vali Loss: 2.055 Vali Acc: 0.128 Test Loss: 2.055 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 2.5639994144439697
Epoch: 2, Steps: 8 | Train Loss: 1.851 Vali Loss: 1.843 Vali Acc: 0.372 Test Loss: 1.843 Test Acc: 0.372
Validation loss decreased (-0.128104 --> -0.371857).  Saving model ...
Epoch: 3 cost time: 2.7963268756866455
Epoch: 3, Steps: 8 | Train Loss: 1.322 Vali Loss: 1.692 Vali Acc: 0.319 Test Loss: 1.692 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9882307052612305
Epoch: 4, Steps: 8 | Train Loss: 0.842 Vali Loss: 1.609 Vali Acc: 0.378 Test Loss: 1.609 Test Acc: 0.378
Validation loss decreased (-0.371857 --> -0.378109).  Saving model ...
Epoch: 5 cost time: 2.9526569843292236
Epoch: 5, Steps: 8 | Train Loss: 0.601 Vali Loss: 1.535 Vali Acc: 0.338 Test Loss: 1.535 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.070117235183716
Epoch: 6, Steps: 8 | Train Loss: 0.386 Vali Loss: 1.459 Vali Acc: 0.409 Test Loss: 1.459 Test Acc: 0.409
Validation loss decreased (-0.378109 --> -0.409360).  Saving model ...
Epoch: 7 cost time: 2.900665760040283
Epoch: 7, Steps: 8 | Train Loss: 0.293 Vali Loss: 2.000 Vali Acc: 0.303 Test Loss: 2.000 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.057675838470459
Epoch: 8, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.759 Vali Acc: 0.350 Test Loss: 1.759 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.203267812728882
Epoch: 9, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.734 Vali Acc: 0.409 Test Loss: 1.734 Test Acc: 0.409
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1879591941833496
Epoch: 10, Steps: 8 | Train Loss: 0.063 Vali Loss: 2.063 Vali Acc: 0.394 Test Loss: 2.063 Test Acc: 0.394
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9636588096618652
Epoch: 11, Steps: 8 | Train Loss: 0.060 Vali Loss: 2.211 Vali Acc: 0.325 Test Loss: 2.211 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.794144868850708
Epoch: 12, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.858 Vali Acc: 0.444 Test Loss: 1.858 Test Acc: 0.444
Validation loss decreased (-0.409360 --> -0.443731).  Saving model ...
Epoch: 13 cost time: 2.704890489578247
Epoch: 13, Steps: 8 | Train Loss: 0.037 Vali Loss: 2.734 Vali Acc: 0.294 Test Loss: 2.734 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.21307373046875
Epoch: 14, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.560 Vali Acc: 0.559 Test Loss: 1.560 Test Acc: 0.559
Validation loss decreased (-0.443731 --> -0.559359).  Saving model ...
Epoch: 15 cost time: 2.7976090908050537
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.875 Vali Acc: 0.481 Test Loss: 1.875 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.815817356109619
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.822 Vali Acc: 0.356 Test Loss: 2.822 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6639931201934814
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.727 Vali Acc: 0.503 Test Loss: 1.727 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0309975147247314
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.998 Vali Acc: 0.309 Test Loss: 2.998 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1177937984466553
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.817 Vali Acc: 0.500 Test Loss: 1.817 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.0260298252105713
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.506 Vali Acc: 0.441 Test Loss: 2.506 Test Acc: 0.441
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.0433309078216553
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.040 Vali Acc: 0.500 Test Loss: 2.040 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9007339477539062
Epoch: 22, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.564 Vali Acc: 0.428 Test Loss: 2.564 Test Acc: 0.428
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.7345986366271973
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.206 Vali Acc: 0.484 Test Loss: 2.206 Test Acc: 0.484
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.863018274307251
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.186 Vali Acc: 0.456 Test Loss: 2.186 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.559375
model parameter : 6427144
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.285751581192017
Epoch: 1, Steps: 8 | Train Loss: 2.109 Vali Loss: 2.062 Vali Acc: 0.147 Test Loss: 2.062 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 2.908162832260132
Epoch: 2, Steps: 8 | Train Loss: 1.844 Vali Loss: 1.892 Vali Acc: 0.303 Test Loss: 1.892 Test Acc: 0.303
Validation loss decreased (-0.146854 --> -0.303106).  Saving model ...
Epoch: 3 cost time: 3.0128393173217773
Epoch: 3, Steps: 8 | Train Loss: 1.341 Vali Loss: 1.738 Vali Acc: 0.362 Test Loss: 1.738 Test Acc: 0.362
Validation loss decreased (-0.303106 --> -0.362483).  Saving model ...
Epoch: 4 cost time: 3.0351991653442383
Epoch: 4, Steps: 8 | Train Loss: 0.848 Vali Loss: 1.543 Vali Acc: 0.441 Test Loss: 1.543 Test Acc: 0.441
Validation loss decreased (-0.362483 --> -0.440610).  Saving model ...
Epoch: 5 cost time: 2.971299886703491
Epoch: 5, Steps: 8 | Train Loss: 0.582 Vali Loss: 1.485 Vali Acc: 0.422 Test Loss: 1.485 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.094635486602783
Epoch: 6, Steps: 8 | Train Loss: 0.380 Vali Loss: 1.440 Vali Acc: 0.409 Test Loss: 1.440 Test Acc: 0.409
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.102404832839966
Epoch: 7, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.642 Vali Acc: 0.384 Test Loss: 1.642 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.003199815750122
Epoch: 8, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.493 Vali Acc: 0.425 Test Loss: 1.493 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9639270305633545
Epoch: 9, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.727 Vali Acc: 0.369 Test Loss: 1.727 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.455183267593384
Epoch: 10, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.887 Vali Acc: 0.431 Test Loss: 1.887 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.3953490257263184
Epoch: 11, Steps: 8 | Train Loss: 0.062 Vali Loss: 2.045 Vali Acc: 0.356 Test Loss: 2.045 Test Acc: 0.356
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.178426742553711
Epoch: 12, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.655 Vali Acc: 0.487 Test Loss: 1.655 Test Acc: 0.487
Validation loss decreased (-0.440610 --> -0.487483).  Saving model ...
Epoch: 13 cost time: 3.145608425140381
Epoch: 13, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.859 Vali Acc: 0.275 Test Loss: 2.859 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.855238199234009
Epoch: 14, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.641 Vali Acc: 0.531 Test Loss: 1.641 Test Acc: 0.531
Validation loss decreased (-0.487483 --> -0.531234).  Saving model ...
Epoch: 15 cost time: 2.9433515071868896
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.293 Vali Acc: 0.425 Test Loss: 2.293 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1574339866638184
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.153 Vali Acc: 0.441 Test Loss: 2.153 Test Acc: 0.441
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2460546493530273
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.057 Vali Acc: 0.484 Test Loss: 2.057 Test Acc: 0.484
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.448350429534912
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.354 Vali Acc: 0.434 Test Loss: 2.354 Test Acc: 0.434
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.6052114963531494
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.865 Vali Acc: 0.484 Test Loss: 1.865 Test Acc: 0.484
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.3122212886810303
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.099 Vali Acc: 0.469 Test Loss: 2.099 Test Acc: 0.469
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1087043285369873
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.902 Vali Acc: 0.519 Test Loss: 1.902 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.0606772899627686
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.030 Vali Acc: 0.491 Test Loss: 2.030 Test Acc: 0.491
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.0773203372955322
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.134 Vali Acc: 0.481 Test Loss: 2.134 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.032097101211548
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.045 Vali Acc: 0.487 Test Loss: 2.045 Test Acc: 0.487
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.53125
model parameter : 6427144
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.445455312728882
Epoch: 1, Steps: 8 | Train Loss: 2.148 Vali Loss: 2.119 Vali Acc: 0.128 Test Loss: 2.119 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 2.7014806270599365
Epoch: 2, Steps: 8 | Train Loss: 1.834 Vali Loss: 1.962 Vali Acc: 0.241 Test Loss: 1.962 Test Acc: 0.241
Validation loss decreased (-0.128104 --> -0.240605).  Saving model ...
Epoch: 3 cost time: 2.877559185028076
Epoch: 3, Steps: 8 | Train Loss: 1.274 Vali Loss: 1.778 Vali Acc: 0.241 Test Loss: 1.778 Test Acc: 0.241
Validation loss decreased (-0.240605 --> -0.240607).  Saving model ...
Epoch: 4 cost time: 2.8309381008148193
Epoch: 4, Steps: 8 | Train Loss: 0.749 Vali Loss: 1.522 Vali Acc: 0.478 Test Loss: 1.522 Test Acc: 0.478
Validation loss decreased (-0.240607 --> -0.478110).  Saving model ...
Epoch: 5 cost time: 3.134927988052368
Epoch: 5, Steps: 8 | Train Loss: 0.529 Vali Loss: 1.404 Vali Acc: 0.500 Test Loss: 1.404 Test Acc: 0.500
Validation loss decreased (-0.478110 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 3.0592598915100098
Epoch: 6, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.398 Vali Acc: 0.463 Test Loss: 1.398 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1977241039276123
Epoch: 7, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.352 Vali Acc: 0.494 Test Loss: 1.352 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0227179527282715
Epoch: 8, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.560 Vali Acc: 0.463 Test Loss: 1.560 Test Acc: 0.463
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1540660858154297
Epoch: 9, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.401 Vali Acc: 0.519 Test Loss: 1.401 Test Acc: 0.519
Validation loss decreased (-0.499986 --> -0.518736).  Saving model ...
Epoch: 10 cost time: 2.954167366027832
Epoch: 10, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.753 Vali Acc: 0.487 Test Loss: 1.753 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.184838056564331
Epoch: 11, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.710 Vali Acc: 0.487 Test Loss: 1.710 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9797019958496094
Epoch: 12, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.599 Vali Acc: 0.500 Test Loss: 1.599 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9089293479919434
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.009 Vali Acc: 0.497 Test Loss: 2.009 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.847503662109375
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.894 Vali Acc: 0.500 Test Loss: 1.894 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.884265184402466
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.148 Vali Acc: 0.487 Test Loss: 2.148 Test Acc: 0.487
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.0232341289520264
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.276 Vali Acc: 0.484 Test Loss: 2.276 Test Acc: 0.484
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.9050543308258057
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.173 Vali Acc: 0.478 Test Loss: 2.173 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.927583932876587
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.211 Vali Acc: 0.484 Test Loss: 2.211 Test Acc: 0.484
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.9740641117095947
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.924 Vali Acc: 0.556 Test Loss: 1.924 Test Acc: 0.556
Validation loss decreased (-0.518736 --> -0.556231).  Saving model ...
Epoch: 20 cost time: 3.056168794631958
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.133 Vali Acc: 0.519 Test Loss: 2.133 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2057597637176514
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.387 Vali Acc: 0.494 Test Loss: 2.387 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.091359853744507
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.335 Vali Acc: 0.466 Test Loss: 2.335 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.0805912017822266
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.060 Vali Acc: 0.528 Test Loss: 2.060 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.1489923000335693
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.060 Vali Acc: 0.537 Test Loss: 2.060 Test Acc: 0.537
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.20810866355896
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.830 Vali Acc: 0.444 Test Loss: 2.830 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.1056969165802
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.455 Vali Acc: 0.491 Test Loss: 2.455 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.779315710067749
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.406 Vali Acc: 0.478 Test Loss: 2.406 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.981858015060425
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.387 Vali Acc: 0.475 Test Loss: 2.387 Test Acc: 0.475
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.192598581314087
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.395 Vali Acc: 0.491 Test Loss: 2.395 Test Acc: 0.491
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.55625
model parameter : 6427144
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.673460006713867
Epoch: 1, Steps: 8 | Train Loss: 2.140 Vali Loss: 2.042 Vali Acc: 0.147 Test Loss: 2.042 Test Acc: 0.147
Validation loss decreased (inf --> -0.146855).  Saving model ...
Epoch: 2 cost time: 2.994387626647949
Epoch: 2, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.785 Vali Acc: 0.309 Test Loss: 1.785 Test Acc: 0.309
Validation loss decreased (-0.146855 --> -0.309357).  Saving model ...
Epoch: 3 cost time: 3.237647771835327
Epoch: 3, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.447 Vali Acc: 0.497 Test Loss: 1.447 Test Acc: 0.497
Validation loss decreased (-0.309357 --> -0.496861).  Saving model ...
Epoch: 4 cost time: 3.2604868412017822
Epoch: 4, Steps: 8 | Train Loss: 0.848 Vali Loss: 1.289 Vali Acc: 0.528 Test Loss: 1.289 Test Acc: 0.528
Validation loss decreased (-0.496861 --> -0.528112).  Saving model ...
Epoch: 5 cost time: 2.8199973106384277
Epoch: 5, Steps: 8 | Train Loss: 0.551 Vali Loss: 1.272 Vali Acc: 0.519 Test Loss: 1.272 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0634799003601074
Epoch: 6, Steps: 8 | Train Loss: 0.360 Vali Loss: 1.592 Vali Acc: 0.438 Test Loss: 1.592 Test Acc: 0.438
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8604815006256104
Epoch: 7, Steps: 8 | Train Loss: 0.244 Vali Loss: 1.819 Vali Acc: 0.434 Test Loss: 1.819 Test Acc: 0.434
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0386874675750732
Epoch: 8, Steps: 8 | Train Loss: 0.186 Vali Loss: 2.072 Vali Acc: 0.412 Test Loss: 2.072 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1179721355438232
Epoch: 9, Steps: 8 | Train Loss: 0.114 Vali Loss: 2.037 Vali Acc: 0.438 Test Loss: 2.037 Test Acc: 0.438
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.160033941268921
Epoch: 10, Steps: 8 | Train Loss: 0.084 Vali Loss: 2.667 Vali Acc: 0.409 Test Loss: 2.667 Test Acc: 0.409
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.94539475440979
Epoch: 11, Steps: 8 | Train Loss: 0.069 Vali Loss: 2.285 Vali Acc: 0.475 Test Loss: 2.285 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.1301052570343018
Epoch: 12, Steps: 8 | Train Loss: 0.059 Vali Loss: 2.680 Vali Acc: 0.409 Test Loss: 2.680 Test Acc: 0.409
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.0643956661224365
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 2.949 Vali Acc: 0.412 Test Loss: 2.949 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.995147466659546
Epoch: 14, Steps: 8 | Train Loss: 0.039 Vali Loss: 3.124 Vali Acc: 0.419 Test Loss: 3.124 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.528125
model parameter : 6427144
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.832798957824707
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 2.072 Vali Acc: 0.175 Test Loss: 2.072 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 3.080413341522217
Epoch: 2, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.841 Vali Acc: 0.359 Test Loss: 1.841 Test Acc: 0.359
Validation loss decreased (-0.174979 --> -0.359357).  Saving model ...
Epoch: 3 cost time: 3.0838019847869873
Epoch: 3, Steps: 8 | Train Loss: 1.380 Vali Loss: 1.499 Vali Acc: 0.444 Test Loss: 1.499 Test Acc: 0.444
Validation loss decreased (-0.359357 --> -0.443735).  Saving model ...
Epoch: 4 cost time: 2.7946577072143555
Epoch: 4, Steps: 8 | Train Loss: 0.986 Vali Loss: 1.345 Vali Acc: 0.475 Test Loss: 1.345 Test Acc: 0.475
Validation loss decreased (-0.443735 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 2.9260916709899902
Epoch: 5, Steps: 8 | Train Loss: 0.681 Vali Loss: 1.328 Vali Acc: 0.500 Test Loss: 1.328 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 2.7572450637817383
Epoch: 6, Steps: 8 | Train Loss: 0.416 Vali Loss: 1.500 Vali Acc: 0.484 Test Loss: 1.500 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0303921699523926
Epoch: 7, Steps: 8 | Train Loss: 0.305 Vali Loss: 1.754 Vali Acc: 0.456 Test Loss: 1.754 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.228415012359619
Epoch: 8, Steps: 8 | Train Loss: 0.218 Vali Loss: 2.010 Vali Acc: 0.441 Test Loss: 2.010 Test Acc: 0.441
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9981720447540283
Epoch: 9, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.973 Vali Acc: 0.466 Test Loss: 1.973 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7815818786621094
Epoch: 10, Steps: 8 | Train Loss: 0.113 Vali Loss: 2.531 Vali Acc: 0.412 Test Loss: 2.531 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2282443046569824
Epoch: 11, Steps: 8 | Train Loss: 0.086 Vali Loss: 2.207 Vali Acc: 0.438 Test Loss: 2.207 Test Acc: 0.438
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.0029146671295166
Epoch: 12, Steps: 8 | Train Loss: 0.067 Vali Loss: 2.526 Vali Acc: 0.403 Test Loss: 2.526 Test Acc: 0.403
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.2683255672454834
Epoch: 13, Steps: 8 | Train Loss: 0.040 Vali Loss: 3.049 Vali Acc: 0.400 Test Loss: 3.049 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.921919107437134
Epoch: 14, Steps: 8 | Train Loss: 0.046 Vali Loss: 2.948 Vali Acc: 0.428 Test Loss: 2.948 Test Acc: 0.428
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.003073215484619
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 3.310 Vali Acc: 0.397 Test Loss: 3.310 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5
model parameter : 6427144
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.0696940422058105
Epoch: 1, Steps: 8 | Train Loss: 2.015 Vali Loss: 1.477 Vali Acc: 0.656 Test Loss: 1.477 Test Acc: 0.656
Validation loss decreased (inf --> -0.656235).  Saving model ...
Epoch: 2 cost time: 3.0885062217712402
Epoch: 2, Steps: 8 | Train Loss: 1.054 Vali Loss: 0.818 Vali Acc: 0.738 Test Loss: 0.818 Test Acc: 0.738
Validation loss decreased (-0.656235 --> -0.737492).  Saving model ...
Epoch: 3 cost time: 3.296882152557373
Epoch: 3, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.771 Vali Acc: 0.738 Test Loss: 0.771 Test Acc: 0.738
Validation loss decreased (-0.737492 --> -0.737492).  Saving model ...
Epoch: 4 cost time: 3.066885471343994
Epoch: 4, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.865 Vali Acc: 0.738 Test Loss: 0.865 Test Acc: 0.738
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2012476921081543
Epoch: 5, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.910 Vali Acc: 0.744 Test Loss: 0.910 Test Acc: 0.744
Validation loss decreased (-0.737492 --> -0.743741).  Saving model ...
Epoch: 6 cost time: 3.1761884689331055
Epoch: 6, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.151 Vali Acc: 0.725 Test Loss: 1.151 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.196998357772827
Epoch: 7, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.317 Vali Acc: 0.713 Test Loss: 1.317 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3828418254852295
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.164 Vali Acc: 0.753 Test Loss: 1.164 Test Acc: 0.753
Validation loss decreased (-0.743741 --> -0.753113).  Saving model ...
Epoch: 9 cost time: 3.5757062435150146
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.314 Vali Acc: 0.731 Test Loss: 1.314 Test Acc: 0.731
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.170147180557251
Epoch: 10, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.385 Vali Acc: 0.719 Test Loss: 1.385 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2039709091186523
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.250 Vali Acc: 0.753 Test Loss: 1.250 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0551273822784424
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.235 Vali Acc: 0.766 Test Loss: 1.235 Test Acc: 0.766
Validation loss decreased (-0.753113 --> -0.765613).  Saving model ...
Epoch: 13 cost time: 3.127777099609375
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.280 Vali Acc: 0.747 Test Loss: 1.280 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1528170108795166
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.279 Vali Acc: 0.750 Test Loss: 1.279 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.321110486984253
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.753 Test Loss: 1.260 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.0886785984039307
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.762 Test Loss: 1.248 Test Acc: 0.762
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.129945755004883
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.769 Test Loss: 1.241 Test Acc: 0.769
Validation loss decreased (-0.765613 --> -0.768738).  Saving model ...
Epoch: 18 cost time: 3.213482618331909
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.772 Test Loss: 1.237 Test Acc: 0.772
Validation loss decreased (-0.768738 --> -0.771863).  Saving model ...
Epoch: 19 cost time: 3.305401086807251
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.772 Test Loss: 1.234 Test Acc: 0.772
Validation loss decreased (-0.771863 --> -0.771863).  Saving model ...
Epoch: 20 cost time: 3.4373483657836914
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.775 Test Loss: 1.236 Test Acc: 0.775
Validation loss decreased (-0.771863 --> -0.774988).  Saving model ...
Epoch: 21 cost time: 3.336766004562378
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.775 Test Loss: 1.239 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4985358715057373
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.775 Test Loss: 1.242 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.457103967666626
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.772 Test Loss: 1.242 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.2100939750671387
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.778 Test Loss: 1.242 Test Acc: 0.778
Validation loss decreased (-0.774988 --> -0.778113).  Saving model ...
Epoch: 25 cost time: 3.253997325897217
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.243 Vali Acc: 0.781 Test Loss: 1.243 Test Acc: 0.781
Validation loss decreased (-0.778113 --> -0.781238).  Saving model ...
Epoch: 26 cost time: 3.0953807830810547
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.781 Test Loss: 1.244 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.066880464553833
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.778 Test Loss: 1.248 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.271111488342285
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.778 Test Loss: 1.251 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.316915988922119
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.778 Test Loss: 1.253 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.3019933700561523
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.778 Test Loss: 1.253 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.0551228523254395
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.778 Test Loss: 1.255 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.1594767570495605
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.781 Test Loss: 1.255 Test Acc: 0.781
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.4774537086486816
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.784 Test Loss: 1.256 Test Acc: 0.784
Validation loss decreased (-0.781238 --> -0.784362).  Saving model ...
Epoch: 34 cost time: 3.360349178314209
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.781 Test Loss: 1.258 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.144683361053467
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.781 Test Loss: 1.259 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.2142157554626465
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.781 Test Loss: 1.259 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.8775768280029297
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.784 Test Loss: 1.261 Test Acc: 0.784
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.0187692642211914
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.791 Test Loss: 1.262 Test Acc: 0.791
Validation loss decreased (-0.784362 --> -0.790612).  Saving model ...
Epoch: 39 cost time: 3.108886957168579
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.791 Test Loss: 1.265 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.2148361206054688
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.791 Test Loss: 1.266 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.1324496269226074
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.791 Test Loss: 1.267 Test Acc: 0.791
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.3245842456817627
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.784 Test Loss: 1.267 Test Acc: 0.784
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.1736621856689453
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.784 Test Loss: 1.268 Test Acc: 0.784
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.197132110595703
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.270 Vali Acc: 0.784 Test Loss: 1.270 Test Acc: 0.784
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.2278714179992676
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.270 Vali Acc: 0.781 Test Loss: 1.270 Test Acc: 0.781
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.4478259086608887
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.271 Vali Acc: 0.787 Test Loss: 1.271 Test Acc: 0.787
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.59253191947937
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.787 Test Loss: 1.273 Test Acc: 0.787
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.141602039337158
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.787 Test Loss: 1.274 Test Acc: 0.787
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.790625
model parameter : 4854280
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.152586460113525
Epoch: 1, Steps: 8 | Train Loss: 2.045 Vali Loss: 1.612 Vali Acc: 0.531 Test Loss: 1.612 Test Acc: 0.531
Validation loss decreased (inf --> -0.531234).  Saving model ...
Epoch: 2 cost time: 3.188993215560913
Epoch: 2, Steps: 8 | Train Loss: 1.213 Vali Loss: 1.070 Vali Acc: 0.641 Test Loss: 1.070 Test Acc: 0.641
Validation loss decreased (-0.531234 --> -0.640614).  Saving model ...
Epoch: 3 cost time: 2.983227252960205
Epoch: 3, Steps: 8 | Train Loss: 0.676 Vali Loss: 1.009 Vali Acc: 0.716 Test Loss: 1.009 Test Acc: 0.716
Validation loss decreased (-0.640614 --> -0.715615).  Saving model ...
Epoch: 4 cost time: 2.973201036453247
Epoch: 4, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.992 Vali Acc: 0.684 Test Loss: 0.992 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7025623321533203
Epoch: 5, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.131 Vali Acc: 0.666 Test Loss: 1.131 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7232885360717773
Epoch: 6, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.253 Vali Acc: 0.666 Test Loss: 1.253 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.121814727783203
Epoch: 7, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.278 Vali Acc: 0.681 Test Loss: 1.278 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.418231725692749
Epoch: 8, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.384 Vali Acc: 0.678 Test Loss: 1.384 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.10514760017395
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.531 Vali Acc: 0.653 Test Loss: 1.531 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.2647130489349365
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.709 Vali Acc: 0.641 Test Loss: 1.709 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9771268367767334
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.835 Vali Acc: 0.650 Test Loss: 1.835 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.930649995803833
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.684 Vali Acc: 0.662 Test Loss: 1.684 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.9657607078552246
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.637 Vali Acc: 0.681 Test Loss: 1.637 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.715625
model parameter : 4854280
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.865406036376953
Epoch: 1, Steps: 8 | Train Loss: 2.064 Vali Loss: 1.741 Vali Acc: 0.394 Test Loss: 1.741 Test Acc: 0.394
Validation loss decreased (inf --> -0.393733).  Saving model ...
Epoch: 2 cost time: 3.0582730770111084
Epoch: 2, Steps: 8 | Train Loss: 1.375 Vali Loss: 1.177 Vali Acc: 0.606 Test Loss: 1.177 Test Acc: 0.606
Validation loss decreased (-0.393733 --> -0.606238).  Saving model ...
Epoch: 3 cost time: 3.184596300125122
Epoch: 3, Steps: 8 | Train Loss: 0.753 Vali Loss: 1.064 Vali Acc: 0.609 Test Loss: 1.064 Test Acc: 0.609
Validation loss decreased (-0.606238 --> -0.609364).  Saving model ...
Epoch: 4 cost time: 2.910912036895752
Epoch: 4, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.990 Vali Acc: 0.647 Test Loss: 0.990 Test Acc: 0.647
Validation loss decreased (-0.609364 --> -0.646865).  Saving model ...
Epoch: 5 cost time: 3.0935604572296143
Epoch: 5, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.146 Vali Acc: 0.647 Test Loss: 1.146 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3732106685638428
Epoch: 6, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.379 Vali Acc: 0.588 Test Loss: 1.379 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.213101863861084
Epoch: 7, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.367 Vali Acc: 0.672 Test Loss: 1.367 Test Acc: 0.672
Validation loss decreased (-0.646865 --> -0.671861).  Saving model ...
Epoch: 8 cost time: 3.1265830993652344
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.285 Vali Acc: 0.662 Test Loss: 1.285 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.107579231262207
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.424 Vali Acc: 0.669 Test Loss: 1.424 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0715372562408447
Epoch: 10, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.645 Vali Acc: 0.653 Test Loss: 1.645 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7751011848449707
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.486 Vali Acc: 0.647 Test Loss: 1.486 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1080024242401123
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.422 Vali Acc: 0.662 Test Loss: 1.422 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.0476231575012207
Epoch: 13, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.737 Vali Acc: 0.666 Test Loss: 1.737 Test Acc: 0.666
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.1440534591674805
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.458 Vali Acc: 0.697 Test Loss: 1.458 Test Acc: 0.697
Validation loss decreased (-0.671861 --> -0.696860).  Saving model ...
Epoch: 15 cost time: 3.004239797592163
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.487 Vali Acc: 0.669 Test Loss: 1.487 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9097986221313477
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.548 Vali Acc: 0.666 Test Loss: 1.548 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2277684211730957
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.573 Vali Acc: 0.688 Test Loss: 1.573 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.580829620361328
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.684 Test Loss: 1.577 Test Acc: 0.684
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.3347651958465576
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.681 Test Loss: 1.566 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1103551387786865
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.681 Test Loss: 1.550 Test Acc: 0.681
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1153151988983154
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.688 Test Loss: 1.537 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.106090784072876
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.688 Test Loss: 1.525 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.2282426357269287
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.688 Test Loss: 1.515 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.922657012939453
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.688 Test Loss: 1.513 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.696875
model parameter : 4854280
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.931432008743286
Epoch: 1, Steps: 8 | Train Loss: 2.065 Vali Loss: 1.869 Vali Acc: 0.347 Test Loss: 1.869 Test Acc: 0.347
Validation loss decreased (inf --> -0.346856).  Saving model ...
Epoch: 2 cost time: 3.146956443786621
Epoch: 2, Steps: 8 | Train Loss: 1.574 Vali Loss: 1.348 Vali Acc: 0.547 Test Loss: 1.348 Test Acc: 0.547
Validation loss decreased (-0.346856 --> -0.546862).  Saving model ...
Epoch: 3 cost time: 3.2961597442626953
Epoch: 3, Steps: 8 | Train Loss: 0.922 Vali Loss: 1.178 Vali Acc: 0.581 Test Loss: 1.178 Test Acc: 0.581
Validation loss decreased (-0.546862 --> -0.581238).  Saving model ...
Epoch: 4 cost time: 3.0023083686828613
Epoch: 4, Steps: 8 | Train Loss: 0.544 Vali Loss: 1.129 Vali Acc: 0.566 Test Loss: 1.129 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.330336093902588
Epoch: 5, Steps: 8 | Train Loss: 0.283 Vali Loss: 1.247 Vali Acc: 0.578 Test Loss: 1.247 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1419296264648438
Epoch: 6, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.319 Vali Acc: 0.541 Test Loss: 1.319 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.353543519973755
Epoch: 7, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.352 Vali Acc: 0.616 Test Loss: 1.352 Test Acc: 0.616
Validation loss decreased (-0.581238 --> -0.615611).  Saving model ...
Epoch: 8 cost time: 3.2864458560943604
Epoch: 8, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.661 Vali Acc: 0.556 Test Loss: 1.661 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0116827487945557
Epoch: 9, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.431 Vali Acc: 0.650 Test Loss: 1.431 Test Acc: 0.650
Validation loss decreased (-0.615611 --> -0.649986).  Saving model ...
Epoch: 10 cost time: 3.0007050037384033
Epoch: 10, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.445 Vali Acc: 0.644 Test Loss: 1.445 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0679304599761963
Epoch: 11, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.403 Vali Acc: 0.662 Test Loss: 1.403 Test Acc: 0.662
Validation loss decreased (-0.649986 --> -0.662486).  Saving model ...
Epoch: 12 cost time: 3.2288615703582764
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.686 Vali Acc: 0.641 Test Loss: 1.686 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2155983448028564
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.467 Vali Acc: 0.694 Test Loss: 1.467 Test Acc: 0.694
Validation loss decreased (-0.662486 --> -0.693735).  Saving model ...
Epoch: 14 cost time: 3.031494140625
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.941 Vali Acc: 0.588 Test Loss: 1.941 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0575268268585205
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.260 Vali Acc: 0.572 Test Loss: 2.260 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1150457859039307
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.001 Vali Acc: 0.597 Test Loss: 2.001 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.2345361709594727
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.844 Vali Acc: 0.628 Test Loss: 1.844 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0546252727508545
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.745 Vali Acc: 0.631 Test Loss: 1.745 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.121816635131836
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.631 Test Loss: 1.734 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.0959599018096924
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.726 Vali Acc: 0.637 Test Loss: 1.726 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.214124917984009
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.641 Test Loss: 1.718 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.9397904872894287
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.713 Vali Acc: 0.644 Test Loss: 1.713 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.137176513671875
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.723 Vali Acc: 0.644 Test Loss: 1.723 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.69375
model parameter : 4854280
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.030775308609009
Epoch: 1, Steps: 8 | Train Loss: 2.110 Vali Loss: 1.974 Vali Acc: 0.294 Test Loss: 1.974 Test Acc: 0.294
Validation loss decreased (inf --> -0.293730).  Saving model ...
Epoch: 2 cost time: 2.5596210956573486
Epoch: 2, Steps: 8 | Train Loss: 1.766 Vali Loss: 1.657 Vali Acc: 0.409 Test Loss: 1.657 Test Acc: 0.409
Validation loss decreased (-0.293730 --> -0.409358).  Saving model ...
Epoch: 3 cost time: 2.7660272121429443
Epoch: 3, Steps: 8 | Train Loss: 1.207 Vali Loss: 1.424 Vali Acc: 0.481 Test Loss: 1.424 Test Acc: 0.481
Validation loss decreased (-0.409358 --> -0.481236).  Saving model ...
Epoch: 4 cost time: 2.954589366912842
Epoch: 4, Steps: 8 | Train Loss: 0.701 Vali Loss: 1.446 Vali Acc: 0.463 Test Loss: 1.446 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.085038900375366
Epoch: 5, Steps: 8 | Train Loss: 0.443 Vali Loss: 1.513 Vali Acc: 0.475 Test Loss: 1.513 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9756431579589844
Epoch: 6, Steps: 8 | Train Loss: 0.314 Vali Loss: 1.746 Vali Acc: 0.447 Test Loss: 1.746 Test Acc: 0.447
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.048583507537842
Epoch: 7, Steps: 8 | Train Loss: 0.274 Vali Loss: 1.559 Vali Acc: 0.475 Test Loss: 1.559 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.105247735977173
Epoch: 8, Steps: 8 | Train Loss: 0.185 Vali Loss: 2.128 Vali Acc: 0.444 Test Loss: 2.128 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.161632776260376
Epoch: 9, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.707 Vali Acc: 0.503 Test Loss: 1.707 Test Acc: 0.503
Validation loss decreased (-0.481236 --> -0.503108).  Saving model ...
Epoch: 10 cost time: 3.0809011459350586
Epoch: 10, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.875 Vali Acc: 0.472 Test Loss: 1.875 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9193193912506104
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 2.101 Vali Acc: 0.450 Test Loss: 2.101 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7390036582946777
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.696 Vali Acc: 0.559 Test Loss: 1.696 Test Acc: 0.559
Validation loss decreased (-0.503108 --> -0.559358).  Saving model ...
Epoch: 13 cost time: 2.793940544128418
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 2.050 Vali Acc: 0.497 Test Loss: 2.050 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8155412673950195
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.630 Vali Acc: 0.603 Test Loss: 1.630 Test Acc: 0.603
Validation loss decreased (-0.559358 --> -0.603109).  Saving model ...
Epoch: 15 cost time: 2.9776735305786133
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.885 Vali Acc: 0.575 Test Loss: 1.885 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.914945602416992
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.772 Vali Acc: 0.556 Test Loss: 1.772 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.90795636177063
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.581 Test Loss: 1.830 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8148326873779297
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.819 Vali Acc: 0.584 Test Loss: 1.819 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.0184412002563477
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.778 Vali Acc: 0.578 Test Loss: 1.778 Test Acc: 0.578
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.9148831367492676
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.761 Vali Acc: 0.575 Test Loss: 1.761 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.068582773208618
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.771 Vali Acc: 0.578 Test Loss: 1.771 Test Acc: 0.578
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.062190055847168
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.793 Vali Acc: 0.572 Test Loss: 1.793 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.394540309906006
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.789 Vali Acc: 0.572 Test Loss: 1.789 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.0285239219665527
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.777 Vali Acc: 0.572 Test Loss: 1.777 Test Acc: 0.572
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.603125
model parameter : 4854280
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.8118486404418945
Epoch: 1, Steps: 8 | Train Loss: 2.098 Vali Loss: 2.012 Vali Acc: 0.287 Test Loss: 2.012 Test Acc: 0.287
Validation loss decreased (inf --> -0.287480).  Saving model ...
Epoch: 2 cost time: 3.1285414695739746
Epoch: 2, Steps: 8 | Train Loss: 1.837 Vali Loss: 1.810 Vali Acc: 0.369 Test Loss: 1.810 Test Acc: 0.369
Validation loss decreased (-0.287480 --> -0.368732).  Saving model ...
Epoch: 3 cost time: 3.3143374919891357
Epoch: 3, Steps: 8 | Train Loss: 1.373 Vali Loss: 1.613 Vali Acc: 0.416 Test Loss: 1.613 Test Acc: 0.416
Validation loss decreased (-0.368732 --> -0.415609).  Saving model ...
Epoch: 4 cost time: 2.7470479011535645
Epoch: 4, Steps: 8 | Train Loss: 0.847 Vali Loss: 1.553 Vali Acc: 0.378 Test Loss: 1.553 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8308515548706055
Epoch: 5, Steps: 8 | Train Loss: 0.541 Vali Loss: 1.511 Vali Acc: 0.384 Test Loss: 1.511 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.000561475753784
Epoch: 6, Steps: 8 | Train Loss: 0.363 Vali Loss: 1.485 Vali Acc: 0.466 Test Loss: 1.485 Test Acc: 0.466
Validation loss decreased (-0.415609 --> -0.465610).  Saving model ...
Epoch: 7 cost time: 3.123839855194092
Epoch: 7, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.635 Vali Acc: 0.322 Test Loss: 1.635 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.354395627975464
Epoch: 8, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.873 Vali Acc: 0.391 Test Loss: 1.873 Test Acc: 0.391
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0792431831359863
Epoch: 9, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.482 Vali Acc: 0.512 Test Loss: 1.482 Test Acc: 0.512
Validation loss decreased (-0.465610 --> -0.512485).  Saving model ...
Epoch: 10 cost time: 3.129908800125122
Epoch: 10, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.991 Vali Acc: 0.362 Test Loss: 1.991 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1070690155029297
Epoch: 11, Steps: 8 | Train Loss: 0.079 Vali Loss: 2.469 Vali Acc: 0.322 Test Loss: 2.469 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0977044105529785
Epoch: 12, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.707 Vali Acc: 0.472 Test Loss: 1.707 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1200551986694336
Epoch: 13, Steps: 8 | Train Loss: 0.048 Vali Loss: 3.778 Vali Acc: 0.237 Test Loss: 3.778 Test Acc: 0.237
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.766697645187378
Epoch: 14, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.678 Vali Acc: 0.506 Test Loss: 1.678 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.983109474182129
Epoch: 15, Steps: 8 | Train Loss: 0.037 Vali Loss: 3.019 Vali Acc: 0.306 Test Loss: 3.019 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8063063621520996
Epoch: 16, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.727 Vali Acc: 0.503 Test Loss: 1.727 Test Acc: 0.503
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.19816517829895
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.576 Vali Acc: 0.338 Test Loss: 2.576 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.2164855003356934
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.841 Vali Acc: 0.438 Test Loss: 1.841 Test Acc: 0.438
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.2137348651885986
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.954 Vali Acc: 0.291 Test Loss: 2.954 Test Acc: 0.291
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5125
model parameter : 4854280
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.748703479766846
Epoch: 1, Steps: 8 | Train Loss: 2.060 Vali Loss: 2.038 Vali Acc: 0.200 Test Loss: 2.038 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 2.7755320072174072
Epoch: 2, Steps: 8 | Train Loss: 1.874 Vali Loss: 1.882 Vali Acc: 0.366 Test Loss: 1.882 Test Acc: 0.366
Validation loss decreased (-0.199980 --> -0.365606).  Saving model ...
Epoch: 3 cost time: 2.906752586364746
Epoch: 3, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.713 Vali Acc: 0.353 Test Loss: 1.713 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9167439937591553
Epoch: 4, Steps: 8 | Train Loss: 0.844 Vali Loss: 1.591 Vali Acc: 0.359 Test Loss: 1.591 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0977783203125
Epoch: 5, Steps: 8 | Train Loss: 0.544 Vali Loss: 1.493 Vali Acc: 0.416 Test Loss: 1.493 Test Acc: 0.416
Validation loss decreased (-0.365606 --> -0.415610).  Saving model ...
Epoch: 6 cost time: 3.0971083641052246
Epoch: 6, Steps: 8 | Train Loss: 0.406 Vali Loss: 1.370 Vali Acc: 0.500 Test Loss: 1.370 Test Acc: 0.500
Validation loss decreased (-0.415610 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 2.963203191757202
Epoch: 7, Steps: 8 | Train Loss: 0.354 Vali Loss: 1.701 Vali Acc: 0.347 Test Loss: 1.701 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.946274995803833
Epoch: 8, Steps: 8 | Train Loss: 0.225 Vali Loss: 1.522 Vali Acc: 0.441 Test Loss: 1.522 Test Acc: 0.441
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.927950859069824
Epoch: 9, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.625 Vali Acc: 0.469 Test Loss: 1.625 Test Acc: 0.469
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.3196609020233154
Epoch: 10, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.671 Vali Acc: 0.419 Test Loss: 1.671 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.049394369125366
Epoch: 11, Steps: 8 | Train Loss: 0.086 Vali Loss: 2.009 Vali Acc: 0.391 Test Loss: 2.009 Test Acc: 0.391
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.3018221855163574
Epoch: 12, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.498 Vali Acc: 0.466 Test Loss: 1.498 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.0503852367401123
Epoch: 13, Steps: 8 | Train Loss: 0.065 Vali Loss: 2.860 Vali Acc: 0.278 Test Loss: 2.860 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.9339001178741455
Epoch: 14, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.662 Vali Acc: 0.516 Test Loss: 1.662 Test Acc: 0.516
Validation loss decreased (-0.499986 --> -0.515608).  Saving model ...
Epoch: 15 cost time: 3.1518430709838867
Epoch: 15, Steps: 8 | Train Loss: 0.035 Vali Loss: 2.174 Vali Acc: 0.422 Test Loss: 2.174 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1035075187683105
Epoch: 16, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.701 Vali Acc: 0.506 Test Loss: 1.701 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0954949855804443
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.940 Vali Acc: 0.444 Test Loss: 1.940 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.110478401184082
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.034 Vali Acc: 0.425 Test Loss: 2.034 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.734001398086548
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.861 Vali Acc: 0.466 Test Loss: 1.861 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.029203176498413
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.439 Vali Acc: 0.419 Test Loss: 2.439 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1758811473846436
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.758 Vali Acc: 0.509 Test Loss: 1.758 Test Acc: 0.509
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.015810966491699
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.967 Vali Acc: 0.491 Test Loss: 1.967 Test Acc: 0.491
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.803957223892212
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.998 Vali Acc: 0.487 Test Loss: 1.998 Test Acc: 0.487
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.7903406620025635
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.845 Vali Acc: 0.512 Test Loss: 1.845 Test Acc: 0.512
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.515625
model parameter : 4854280
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.009606838226318
Epoch: 1, Steps: 8 | Train Loss: 2.088 Vali Loss: 2.072 Vali Acc: 0.191 Test Loss: 2.072 Test Acc: 0.191
Validation loss decreased (inf --> -0.190604).  Saving model ...
Epoch: 2 cost time: 2.7923364639282227
Epoch: 2, Steps: 8 | Train Loss: 1.856 Vali Loss: 1.906 Vali Acc: 0.400 Test Loss: 1.906 Test Acc: 0.400
Validation loss decreased (-0.190604 --> -0.399981).  Saving model ...
Epoch: 3 cost time: 2.7160911560058594
Epoch: 3, Steps: 8 | Train Loss: 1.332 Vali Loss: 1.731 Vali Acc: 0.331 Test Loss: 1.731 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.873847484588623
Epoch: 4, Steps: 8 | Train Loss: 0.778 Vali Loss: 1.611 Vali Acc: 0.366 Test Loss: 1.611 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.309669017791748
Epoch: 5, Steps: 8 | Train Loss: 0.496 Vali Loss: 1.383 Vali Acc: 0.478 Test Loss: 1.383 Test Acc: 0.478
Validation loss decreased (-0.399981 --> -0.478111).  Saving model ...
Epoch: 6 cost time: 2.958625316619873
Epoch: 6, Steps: 8 | Train Loss: 0.343 Vali Loss: 1.241 Vali Acc: 0.534 Test Loss: 1.241 Test Acc: 0.534
Validation loss decreased (-0.478111 --> -0.534363).  Saving model ...
Epoch: 7 cost time: 2.8111867904663086
Epoch: 7, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.496 Vali Acc: 0.409 Test Loss: 1.496 Test Acc: 0.409
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.858182907104492
Epoch: 8, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.677 Vali Acc: 0.422 Test Loss: 1.677 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1367504596710205
Epoch: 9, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.685 Vali Acc: 0.497 Test Loss: 1.685 Test Acc: 0.497
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.3643910884857178
Epoch: 10, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.836 Vali Acc: 0.447 Test Loss: 1.836 Test Acc: 0.447
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3855841159820557
Epoch: 11, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.929 Vali Acc: 0.412 Test Loss: 1.929 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.443535327911377
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.759 Vali Acc: 0.494 Test Loss: 1.759 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.0605571269989014
Epoch: 13, Steps: 8 | Train Loss: 0.055 Vali Loss: 2.019 Vali Acc: 0.425 Test Loss: 2.019 Test Acc: 0.425
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.0309622287750244
Epoch: 14, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.827 Vali Acc: 0.503 Test Loss: 1.827 Test Acc: 0.503
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.1948444843292236
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.121 Vali Acc: 0.478 Test Loss: 2.121 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.4030277729034424
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.919 Vali Acc: 0.491 Test Loss: 1.919 Test Acc: 0.491
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.534375
model parameter : 4854280
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.536261796951294
Epoch: 1, Steps: 8 | Train Loss: 2.077 Vali Loss: 2.034 Vali Acc: 0.172 Test Loss: 2.034 Test Acc: 0.172
Validation loss decreased (inf --> -0.171855).  Saving model ...
Epoch: 2 cost time: 2.9653947353363037
Epoch: 2, Steps: 8 | Train Loss: 1.937 Vali Loss: 1.755 Vali Acc: 0.397 Test Loss: 1.755 Test Acc: 0.397
Validation loss decreased (-0.171855 --> -0.396857).  Saving model ...
Epoch: 3 cost time: 3.217168092727661
Epoch: 3, Steps: 8 | Train Loss: 1.338 Vali Loss: 1.496 Vali Acc: 0.416 Test Loss: 1.496 Test Acc: 0.416
Validation loss decreased (-0.396857 --> -0.415610).  Saving model ...
Epoch: 4 cost time: 3.292517900466919
Epoch: 4, Steps: 8 | Train Loss: 0.830 Vali Loss: 1.309 Vali Acc: 0.506 Test Loss: 1.309 Test Acc: 0.506
Validation loss decreased (-0.415610 --> -0.506237).  Saving model ...
Epoch: 5 cost time: 2.9252736568450928
Epoch: 5, Steps: 8 | Train Loss: 0.505 Vali Loss: 1.321 Vali Acc: 0.487 Test Loss: 1.321 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8465962409973145
Epoch: 6, Steps: 8 | Train Loss: 0.362 Vali Loss: 1.418 Vali Acc: 0.475 Test Loss: 1.418 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0302250385284424
Epoch: 7, Steps: 8 | Train Loss: 0.261 Vali Loss: 1.648 Vali Acc: 0.500 Test Loss: 1.648 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.271009922027588
Epoch: 8, Steps: 8 | Train Loss: 0.172 Vali Loss: 2.110 Vali Acc: 0.372 Test Loss: 2.110 Test Acc: 0.372
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1780343055725098
Epoch: 9, Steps: 8 | Train Loss: 0.147 Vali Loss: 2.457 Vali Acc: 0.400 Test Loss: 2.457 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.9256045818328857
Epoch: 10, Steps: 8 | Train Loss: 0.090 Vali Loss: 2.435 Vali Acc: 0.384 Test Loss: 2.435 Test Acc: 0.384
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.4128966331481934
Epoch: 11, Steps: 8 | Train Loss: 0.058 Vali Loss: 2.315 Vali Acc: 0.450 Test Loss: 2.315 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.2337646484375
Epoch: 12, Steps: 8 | Train Loss: 0.051 Vali Loss: 2.647 Vali Acc: 0.422 Test Loss: 2.647 Test Acc: 0.422
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.3769936561584473
Epoch: 13, Steps: 8 | Train Loss: 0.064 Vali Loss: 2.611 Vali Acc: 0.463 Test Loss: 2.611 Test Acc: 0.463
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.582825183868408
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 2.488 Vali Acc: 0.472 Test Loss: 2.488 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.50625
model parameter : 4854280
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.4209206104278564
Epoch: 1, Steps: 8 | Train Loss: 2.083 Vali Loss: 2.070 Vali Acc: 0.175 Test Loss: 2.070 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 2.9189836978912354
Epoch: 2, Steps: 8 | Train Loss: 1.846 Vali Loss: 1.783 Vali Acc: 0.431 Test Loss: 1.783 Test Acc: 0.431
Validation loss decreased (-0.174979 --> -0.431232).  Saving model ...
Epoch: 3 cost time: 3.053690195083618
Epoch: 3, Steps: 8 | Train Loss: 1.493 Vali Loss: 1.475 Vali Acc: 0.503 Test Loss: 1.475 Test Acc: 0.503
Validation loss decreased (-0.431232 --> -0.503110).  Saving model ...
Epoch: 4 cost time: 2.9750118255615234
Epoch: 4, Steps: 8 | Train Loss: 0.970 Vali Loss: 1.346 Vali Acc: 0.500 Test Loss: 1.346 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8931918144226074
Epoch: 5, Steps: 8 | Train Loss: 0.616 Vali Loss: 1.329 Vali Acc: 0.534 Test Loss: 1.329 Test Acc: 0.534
Validation loss decreased (-0.503110 --> -0.534362).  Saving model ...
Epoch: 6 cost time: 2.743034601211548
Epoch: 6, Steps: 8 | Train Loss: 0.431 Vali Loss: 1.433 Vali Acc: 0.503 Test Loss: 1.433 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9574737548828125
Epoch: 7, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.955 Vali Acc: 0.453 Test Loss: 1.955 Test Acc: 0.453
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9770667552948
Epoch: 8, Steps: 8 | Train Loss: 0.217 Vali Loss: 2.056 Vali Acc: 0.444 Test Loss: 2.056 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8886799812316895
Epoch: 9, Steps: 8 | Train Loss: 0.190 Vali Loss: 2.759 Vali Acc: 0.409 Test Loss: 2.759 Test Acc: 0.409
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.136617660522461
Epoch: 10, Steps: 8 | Train Loss: 0.119 Vali Loss: 2.411 Vali Acc: 0.356 Test Loss: 2.411 Test Acc: 0.356
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2348172664642334
Epoch: 11, Steps: 8 | Train Loss: 0.075 Vali Loss: 2.780 Vali Acc: 0.406 Test Loss: 2.780 Test Acc: 0.406
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.0948374271392822
Epoch: 12, Steps: 8 | Train Loss: 0.066 Vali Loss: 2.663 Vali Acc: 0.450 Test Loss: 2.663 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.2051405906677246
Epoch: 13, Steps: 8 | Train Loss: 0.067 Vali Loss: 2.779 Vali Acc: 0.444 Test Loss: 2.779 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.0118560791015625
Epoch: 14, Steps: 8 | Train Loss: 0.045 Vali Loss: 3.054 Vali Acc: 0.466 Test Loss: 3.054 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.075578212738037
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 3.124 Vali Acc: 0.400 Test Loss: 3.124 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.534375
model parameter : 4854280
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.664094924926758
Epoch: 1, Steps: 8 | Train Loss: 1.998 Vali Loss: 1.467 Vali Acc: 0.647 Test Loss: 1.467 Test Acc: 0.647
Validation loss decreased (inf --> -0.646860).  Saving model ...
Epoch: 2 cost time: 3.4230921268463135
Epoch: 2, Steps: 8 | Train Loss: 1.133 Vali Loss: 0.829 Vali Acc: 0.725 Test Loss: 0.829 Test Acc: 0.725
Validation loss decreased (-0.646860 --> -0.724992).  Saving model ...
Epoch: 3 cost time: 3.759004831314087
Epoch: 3, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.744 Vali Acc: 0.750 Test Loss: 0.744 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 3.5178935527801514
Epoch: 4, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.919 Vali Acc: 0.731 Test Loss: 0.919 Test Acc: 0.731
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5579729080200195
Epoch: 5, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4396681785583496
Epoch: 6, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.937 Vali Acc: 0.750 Test Loss: 0.937 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.656064033508301
Epoch: 7, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.250 Vali Acc: 0.713 Test Loss: 1.250 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.527873992919922
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.226 Vali Acc: 0.731 Test Loss: 1.226 Test Acc: 0.731
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.8158318996429443
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.194 Vali Acc: 0.731 Test Loss: 1.194 Test Acc: 0.731
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.9959018230438232
Epoch: 10, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.497 Vali Acc: 0.703 Test Loss: 1.497 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.478545904159546
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.443 Vali Acc: 0.734 Test Loss: 1.443 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.4009642601013184
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.309 Vali Acc: 0.731 Test Loss: 1.309 Test Acc: 0.731
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.3195137977600098
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.443 Vali Acc: 0.741 Test Loss: 1.443 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.75
model parameter : 4067848
model size : 25.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.211767673492432
Epoch: 1, Steps: 8 | Train Loss: 2.026 Vali Loss: 1.599 Vali Acc: 0.556 Test Loss: 1.599 Test Acc: 0.556
Validation loss decreased (inf --> -0.556234).  Saving model ...
Epoch: 2 cost time: 3.564723253250122
Epoch: 2, Steps: 8 | Train Loss: 1.286 Vali Loss: 1.068 Vali Acc: 0.637 Test Loss: 1.068 Test Acc: 0.637
Validation loss decreased (-0.556234 --> -0.637489).  Saving model ...
Epoch: 3 cost time: 3.2606470584869385
Epoch: 3, Steps: 8 | Train Loss: 0.607 Vali Loss: 0.975 Vali Acc: 0.672 Test Loss: 0.975 Test Acc: 0.672
Validation loss decreased (-0.637489 --> -0.671865).  Saving model ...
Epoch: 4 cost time: 3.3796582221984863
Epoch: 4, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.135 Vali Acc: 0.688 Test Loss: 1.135 Test Acc: 0.688
Validation loss decreased (-0.671865 --> -0.687489).  Saving model ...
Epoch: 5 cost time: 3.2308812141418457
Epoch: 5, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.139 Vali Acc: 0.675 Test Loss: 1.139 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6466355323791504
Epoch: 6, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.113 Vali Acc: 0.694 Test Loss: 1.113 Test Acc: 0.694
Validation loss decreased (-0.687489 --> -0.693739).  Saving model ...
Epoch: 7 cost time: 3.49043345451355
Epoch: 7, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.521 Vali Acc: 0.659 Test Loss: 1.521 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3073511123657227
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.346 Vali Acc: 0.666 Test Loss: 1.346 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.895885944366455
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.654 Vali Acc: 0.659 Test Loss: 1.654 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.246413469314575
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.794 Vali Acc: 0.659 Test Loss: 1.794 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.714996814727783
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.774 Vali Acc: 0.653 Test Loss: 1.774 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.3872599601745605
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.711 Vali Acc: 0.678 Test Loss: 1.711 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.4419353008270264
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.687 Vali Acc: 0.672 Test Loss: 1.687 Test Acc: 0.672
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.587650775909424
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.671 Vali Acc: 0.678 Test Loss: 1.671 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.3643434047698975
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.683 Vali Acc: 0.691 Test Loss: 1.683 Test Acc: 0.691
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.658780574798584
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.694 Vali Acc: 0.684 Test Loss: 1.694 Test Acc: 0.684
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.69375
model parameter : 4067848
model size : 25.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.308124780654907
Epoch: 1, Steps: 8 | Train Loss: 2.064 Vali Loss: 1.742 Vali Acc: 0.484 Test Loss: 1.742 Test Acc: 0.484
Validation loss decreased (inf --> -0.484358).  Saving model ...
Epoch: 2 cost time: 3.126560926437378
Epoch: 2, Steps: 8 | Train Loss: 1.402 Vali Loss: 1.194 Vali Acc: 0.575 Test Loss: 1.194 Test Acc: 0.575
Validation loss decreased (-0.484358 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 3.198255777359009
Epoch: 3, Steps: 8 | Train Loss: 0.702 Vali Loss: 1.058 Vali Acc: 0.628 Test Loss: 1.058 Test Acc: 0.628
Validation loss decreased (-0.574988 --> -0.628114).  Saving model ...
Epoch: 4 cost time: 3.2618305683135986
Epoch: 4, Steps: 8 | Train Loss: 0.355 Vali Loss: 1.177 Vali Acc: 0.650 Test Loss: 1.177 Test Acc: 0.650
Validation loss decreased (-0.628114 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 3.357741594314575
Epoch: 5, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.183 Vali Acc: 0.631 Test Loss: 1.183 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1013717651367188
Epoch: 6, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.309 Vali Acc: 0.619 Test Loss: 1.309 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0870656967163086
Epoch: 7, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.570 Vali Acc: 0.609 Test Loss: 1.570 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.40702748298645
Epoch: 8, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.313 Vali Acc: 0.672 Test Loss: 1.313 Test Acc: 0.672
Validation loss decreased (-0.649988 --> -0.671862).  Saving model ...
Epoch: 9 cost time: 3.5033042430877686
Epoch: 9, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.272 Vali Acc: 0.678 Test Loss: 1.272 Test Acc: 0.678
Validation loss decreased (-0.671862 --> -0.678112).  Saving model ...
Epoch: 10 cost time: 3.1977903842926025
Epoch: 10, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.411 Vali Acc: 0.656 Test Loss: 1.411 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0517876148223877
Epoch: 11, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.468 Vali Acc: 0.684 Test Loss: 1.468 Test Acc: 0.684
Validation loss decreased (-0.678112 --> -0.684360).  Saving model ...
Epoch: 12 cost time: 3.448122501373291
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.554 Vali Acc: 0.684 Test Loss: 1.554 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3230724334716797
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.454 Vali Acc: 0.678 Test Loss: 1.454 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2607853412628174
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.417 Vali Acc: 0.706 Test Loss: 1.417 Test Acc: 0.706
Validation loss decreased (-0.684360 --> -0.706236).  Saving model ...
Epoch: 15 cost time: 2.871530532836914
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.706 Test Loss: 1.419 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5087947845458984
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.709 Test Loss: 1.400 Test Acc: 0.709
Validation loss decreased (-0.706236 --> -0.709361).  Saving model ...
Epoch: 17 cost time: 3.649566888809204
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.713 Test Loss: 1.392 Test Acc: 0.713
Validation loss decreased (-0.709361 --> -0.712486).  Saving model ...
Epoch: 18 cost time: 3.759843111038208
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.713 Test Loss: 1.399 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3449909687042236
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.716 Test Loss: 1.418 Test Acc: 0.716
Validation loss decreased (-0.712486 --> -0.715611).  Saving model ...
Epoch: 20 cost time: 3.3245136737823486
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.713 Test Loss: 1.428 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2884674072265625
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.709 Test Loss: 1.430 Test Acc: 0.709
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.949446678161621
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.716 Test Loss: 1.431 Test Acc: 0.716
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.6034929752349854
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.713 Test Loss: 1.434 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.5683329105377197
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.709 Test Loss: 1.435 Test Acc: 0.709
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.385366201400757
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.709 Test Loss: 1.439 Test Acc: 0.709
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.2476909160614014
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.709 Test Loss: 1.442 Test Acc: 0.709
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.2963101863861084
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.713 Test Loss: 1.442 Test Acc: 0.713
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.2474546432495117
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.713 Test Loss: 1.443 Test Acc: 0.713
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.5397748947143555
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.713 Test Loss: 1.438 Test Acc: 0.713
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.715625
model parameter : 4067848
model size : 25.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.715729236602783
Epoch: 1, Steps: 8 | Train Loss: 2.117 Vali Loss: 1.866 Vali Acc: 0.416 Test Loss: 1.866 Test Acc: 0.416
Validation loss decreased (inf --> -0.415606).  Saving model ...
Epoch: 2 cost time: 3.307985782623291
Epoch: 2, Steps: 8 | Train Loss: 1.611 Vali Loss: 1.380 Vali Acc: 0.537 Test Loss: 1.380 Test Acc: 0.537
Validation loss decreased (-0.415606 --> -0.537486).  Saving model ...
Epoch: 3 cost time: 3.330009937286377
Epoch: 3, Steps: 8 | Train Loss: 0.888 Vali Loss: 1.194 Vali Acc: 0.559 Test Loss: 1.194 Test Acc: 0.559
Validation loss decreased (-0.537486 --> -0.559363).  Saving model ...
Epoch: 4 cost time: 3.3554160594940186
Epoch: 4, Steps: 8 | Train Loss: 0.494 Vali Loss: 1.261 Vali Acc: 0.547 Test Loss: 1.261 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2220096588134766
Epoch: 5, Steps: 8 | Train Loss: 0.394 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
Validation loss decreased (-0.559363 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 3.371429681777954
Epoch: 6, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.316 Vali Acc: 0.562 Test Loss: 1.316 Test Acc: 0.562
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3374147415161133
Epoch: 7, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.191 Vali Acc: 0.631 Test Loss: 1.191 Test Acc: 0.631
Validation loss decreased (-0.599988 --> -0.631238).  Saving model ...
Epoch: 8 cost time: 3.3385186195373535
Epoch: 8, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.483 Vali Acc: 0.597 Test Loss: 1.483 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.007510185241699
Epoch: 9, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.329 Vali Acc: 0.631 Test Loss: 1.329 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.2170467376708984
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.251 Vali Acc: 0.653 Test Loss: 1.251 Test Acc: 0.653
Validation loss decreased (-0.631238 --> -0.653112).  Saving model ...
Epoch: 11 cost time: 3.364274740219116
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.404 Vali Acc: 0.619 Test Loss: 1.404 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0049781799316406
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.452 Vali Acc: 0.653 Test Loss: 1.452 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0581045150756836
Epoch: 13, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.394 Vali Acc: 0.650 Test Loss: 1.394 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.303760051727295
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.489 Vali Acc: 0.650 Test Loss: 1.489 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.152085065841675
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.395 Vali Acc: 0.675 Test Loss: 1.395 Test Acc: 0.675
Validation loss decreased (-0.653112 --> -0.674986).  Saving model ...
Epoch: 16 cost time: 2.9089620113372803
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.414 Vali Acc: 0.666 Test Loss: 1.414 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0348548889160156
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.479 Vali Acc: 0.656 Test Loss: 1.479 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3429574966430664
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.463 Vali Acc: 0.669 Test Loss: 1.463 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.304328680038452
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.669 Test Loss: 1.439 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1567938327789307
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.669 Test Loss: 1.435 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.1599297523498535
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.669 Test Loss: 1.429 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.1457653045654297
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.669 Test Loss: 1.434 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.152216672897339
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.669 Test Loss: 1.437 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.121424436569214
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.666 Test Loss: 1.446 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.2473058700561523
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.669 Test Loss: 1.454 Test Acc: 0.669
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.675
model parameter : 4067848
model size : 25.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.989013195037842
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 1.977 Vali Acc: 0.266 Test Loss: 1.977 Test Acc: 0.266
Validation loss decreased (inf --> -0.265605).  Saving model ...
Epoch: 2 cost time: 3.237901210784912
Epoch: 2, Steps: 8 | Train Loss: 1.791 Vali Loss: 1.659 Vali Acc: 0.425 Test Loss: 1.659 Test Acc: 0.425
Validation loss decreased (-0.265605 --> -0.424983).  Saving model ...
Epoch: 3 cost time: 3.185427188873291
Epoch: 3, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.509 Vali Acc: 0.419 Test Loss: 1.509 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.08828067779541
Epoch: 4, Steps: 8 | Train Loss: 0.647 Vali Loss: 1.667 Vali Acc: 0.422 Test Loss: 1.667 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.207728147506714
Epoch: 5, Steps: 8 | Train Loss: 0.599 Vali Loss: 1.594 Vali Acc: 0.428 Test Loss: 1.594 Test Acc: 0.428
Validation loss decreased (-0.424983 --> -0.428109).  Saving model ...
Epoch: 6 cost time: 3.2985541820526123
Epoch: 6, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.631 Vali Acc: 0.459 Test Loss: 1.631 Test Acc: 0.459
Validation loss decreased (-0.428109 --> -0.459359).  Saving model ...
Epoch: 7 cost time: 2.8963308334350586
Epoch: 7, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.799 Vali Acc: 0.463 Test Loss: 1.799 Test Acc: 0.463
Validation loss decreased (-0.459359 --> -0.462482).  Saving model ...
Epoch: 8 cost time: 2.8981621265411377
Epoch: 8, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.682 Vali Acc: 0.497 Test Loss: 1.682 Test Acc: 0.497
Validation loss decreased (-0.462482 --> -0.496858).  Saving model ...
Epoch: 9 cost time: 3.3056724071502686
Epoch: 9, Steps: 8 | Train Loss: 0.078 Vali Loss: 2.090 Vali Acc: 0.412 Test Loss: 2.090 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2240796089172363
Epoch: 10, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.667 Vali Acc: 0.512 Test Loss: 1.667 Test Acc: 0.512
Validation loss decreased (-0.496858 --> -0.512483).  Saving model ...
Epoch: 11 cost time: 3.054659366607666
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.992 Vali Acc: 0.475 Test Loss: 1.992 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.099778175354004
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.289 Vali Acc: 0.444 Test Loss: 2.289 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2612502574920654
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.054 Vali Acc: 0.463 Test Loss: 2.054 Test Acc: 0.463
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8988606929779053
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.682 Vali Acc: 0.575 Test Loss: 1.682 Test Acc: 0.575
Validation loss decreased (-0.512483 --> -0.574983).  Saving model ...
Epoch: 15 cost time: 3.0029616355895996
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.137 Vali Acc: 0.472 Test Loss: 2.137 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3045976161956787
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.042 Vali Acc: 0.478 Test Loss: 2.042 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1905741691589355
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.212 Vali Acc: 0.478 Test Loss: 2.212 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.9687609672546387
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.069 Vali Acc: 0.503 Test Loss: 2.069 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.0638654232025146
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.149 Vali Acc: 0.478 Test Loss: 2.149 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.020735025405884
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.864 Vali Acc: 0.541 Test Loss: 1.864 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.064767360687256
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.813 Vali Acc: 0.559 Test Loss: 1.813 Test Acc: 0.559
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.4215428829193115
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.883 Vali Acc: 0.562 Test Loss: 1.883 Test Acc: 0.562
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9560489654541016
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.958 Vali Acc: 0.537 Test Loss: 1.958 Test Acc: 0.537
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.0371575355529785
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.994 Vali Acc: 0.534 Test Loss: 1.994 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.575
model parameter : 4067848
model size : 25.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.012799501419067
Epoch: 1, Steps: 8 | Train Loss: 2.162 Vali Loss: 2.034 Vali Acc: 0.150 Test Loss: 2.034 Test Acc: 0.150
Validation loss decreased (inf --> -0.149980).  Saving model ...
Epoch: 2 cost time: 3.0959362983703613
Epoch: 2, Steps: 8 | Train Loss: 1.878 Vali Loss: 1.830 Vali Acc: 0.306 Test Loss: 1.830 Test Acc: 0.306
Validation loss decreased (-0.149980 --> -0.306232).  Saving model ...
Epoch: 3 cost time: 3.351803779602051
Epoch: 3, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.771 Vali Acc: 0.263 Test Loss: 1.771 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.140070915222168
Epoch: 4, Steps: 8 | Train Loss: 0.845 Vali Loss: 1.545 Vali Acc: 0.419 Test Loss: 1.545 Test Acc: 0.419
Validation loss decreased (-0.306232 --> -0.418735).  Saving model ...
Epoch: 5 cost time: 3.0802578926086426
Epoch: 5, Steps: 8 | Train Loss: 0.676 Vali Loss: 1.629 Vali Acc: 0.334 Test Loss: 1.629 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.18825626373291
Epoch: 6, Steps: 8 | Train Loss: 0.439 Vali Loss: 1.550 Vali Acc: 0.388 Test Loss: 1.550 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1277379989624023
Epoch: 7, Steps: 8 | Train Loss: 0.265 Vali Loss: 1.630 Vali Acc: 0.372 Test Loss: 1.630 Test Acc: 0.372
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.025668144226074
Epoch: 8, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.586 Vali Acc: 0.397 Test Loss: 1.586 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.116609573364258
Epoch: 9, Steps: 8 | Train Loss: 0.122 Vali Loss: 2.065 Vali Acc: 0.294 Test Loss: 2.065 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.5116190910339355
Epoch: 10, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.633 Vali Acc: 0.434 Test Loss: 1.633 Test Acc: 0.434
Validation loss decreased (-0.418735 --> -0.434359).  Saving model ...
Epoch: 11 cost time: 3.4249069690704346
Epoch: 11, Steps: 8 | Train Loss: 0.081 Vali Loss: 2.006 Vali Acc: 0.397 Test Loss: 2.006 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0955138206481934
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 2.099 Vali Acc: 0.453 Test Loss: 2.099 Test Acc: 0.453
Validation loss decreased (-0.434359 --> -0.453104).  Saving model ...
Epoch: 13 cost time: 3.3476622104644775
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.393 Vali Acc: 0.331 Test Loss: 2.393 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3497557640075684
Epoch: 14, Steps: 8 | Train Loss: 0.036 Vali Loss: 2.269 Vali Acc: 0.412 Test Loss: 2.269 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.286824941635132
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.511 Vali Acc: 0.344 Test Loss: 2.511 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2384936809539795
Epoch: 16, Steps: 8 | Train Loss: 0.023 Vali Loss: 2.490 Vali Acc: 0.369 Test Loss: 2.490 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.1856954097747803
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.660 Vali Acc: 0.531 Test Loss: 1.660 Test Acc: 0.531
Validation loss decreased (-0.453104 --> -0.531233).  Saving model ...
Epoch: 18 cost time: 3.1402041912078857
Epoch: 18, Steps: 8 | Train Loss: 0.019 Vali Loss: 3.181 Vali Acc: 0.325 Test Loss: 3.181 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0686686038970947
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.573 Vali Acc: 0.463 Test Loss: 2.573 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.95341420173645
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 2.806 Vali Acc: 0.381 Test Loss: 2.806 Test Acc: 0.381
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9539079666137695
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.776 Vali Acc: 0.528 Test Loss: 1.776 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.236670732498169
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.212 Vali Acc: 0.434 Test Loss: 2.212 Test Acc: 0.434
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.2770705223083496
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.879 Vali Acc: 0.353 Test Loss: 2.879 Test Acc: 0.353
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.1916112899780273
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.296 Vali Acc: 0.434 Test Loss: 2.296 Test Acc: 0.434
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.291067361831665
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.998 Vali Acc: 0.487 Test Loss: 1.998 Test Acc: 0.487
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.0448925495147705
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.011 Vali Acc: 0.487 Test Loss: 2.011 Test Acc: 0.487
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.218871593475342
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.055 Vali Acc: 0.494 Test Loss: 2.055 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.53125
model parameter : 4067848
model size : 25.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.802670955657959
Epoch: 1, Steps: 8 | Train Loss: 2.141 Vali Loss: 2.068 Vali Acc: 0.097 Test Loss: 2.068 Test Acc: 0.097
Validation loss decreased (inf --> -0.096854).  Saving model ...
Epoch: 2 cost time: 3.0718796253204346
Epoch: 2, Steps: 8 | Train Loss: 1.867 Vali Loss: 1.911 Vali Acc: 0.309 Test Loss: 1.911 Test Acc: 0.309
Validation loss decreased (-0.096854 --> -0.309356).  Saving model ...
Epoch: 3 cost time: 3.0160324573516846
Epoch: 3, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.806 Vali Acc: 0.256 Test Loss: 1.806 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2967283725738525
Epoch: 4, Steps: 8 | Train Loss: 0.877 Vali Loss: 1.591 Vali Acc: 0.441 Test Loss: 1.591 Test Acc: 0.441
Validation loss decreased (-0.309356 --> -0.440609).  Saving model ...
Epoch: 5 cost time: 3.233109712600708
Epoch: 5, Steps: 8 | Train Loss: 0.645 Vali Loss: 1.568 Vali Acc: 0.378 Test Loss: 1.568 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3299789428710938
Epoch: 6, Steps: 8 | Train Loss: 0.446 Vali Loss: 1.411 Vali Acc: 0.450 Test Loss: 1.411 Test Acc: 0.450
Validation loss decreased (-0.440609 --> -0.449986).  Saving model ...
Epoch: 7 cost time: 3.1094818115234375
Epoch: 7, Steps: 8 | Train Loss: 0.254 Vali Loss: 1.522 Vali Acc: 0.400 Test Loss: 1.522 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0561869144439697
Epoch: 8, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.405 Vali Acc: 0.497 Test Loss: 1.405 Test Acc: 0.497
Validation loss decreased (-0.449986 --> -0.496861).  Saving model ...
Epoch: 9 cost time: 2.9858365058898926
Epoch: 9, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.765 Vali Acc: 0.419 Test Loss: 1.765 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8558499813079834
Epoch: 10, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.409 Vali Acc: 0.487 Test Loss: 1.409 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0025076866149902
Epoch: 11, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.761 Vali Acc: 0.409 Test Loss: 1.761 Test Acc: 0.409
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9887280464172363
Epoch: 12, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.793 Vali Acc: 0.450 Test Loss: 1.793 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.979688882827759
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.545 Vali Acc: 0.528 Test Loss: 1.545 Test Acc: 0.528
Validation loss decreased (-0.496861 --> -0.528110).  Saving model ...
Epoch: 14 cost time: 3.135249614715576
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 2.132 Vali Acc: 0.416 Test Loss: 2.132 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7886905670166016
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.688 Vali Acc: 0.484 Test Loss: 1.688 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0210061073303223
Epoch: 16, Steps: 8 | Train Loss: 0.023 Vali Loss: 2.356 Vali Acc: 0.438 Test Loss: 2.356 Test Acc: 0.438
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.177445650100708
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.765 Vali Acc: 0.497 Test Loss: 1.765 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0763206481933594
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.353 Vali Acc: 0.400 Test Loss: 2.353 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.0365452766418457
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.983 Vali Acc: 0.481 Test Loss: 1.983 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.94598650932312
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.277 Vali Acc: 0.441 Test Loss: 2.277 Test Acc: 0.441
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.013596296310425
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.024 Vali Acc: 0.497 Test Loss: 2.024 Test Acc: 0.497
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.9272983074188232
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.837 Vali Acc: 0.522 Test Loss: 1.837 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.754256248474121
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.883 Vali Acc: 0.516 Test Loss: 1.883 Test Acc: 0.516
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.528125
model parameter : 4067848
model size : 25.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.650790691375732
Epoch: 1, Steps: 8 | Train Loss: 2.117 Vali Loss: 2.052 Vali Acc: 0.131 Test Loss: 2.052 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 3.1020431518554688
Epoch: 2, Steps: 8 | Train Loss: 1.836 Vali Loss: 1.925 Vali Acc: 0.234 Test Loss: 1.925 Test Acc: 0.234
Validation loss decreased (-0.131229 --> -0.234356).  Saving model ...
Epoch: 3 cost time: 3.0437560081481934
Epoch: 3, Steps: 8 | Train Loss: 1.319 Vali Loss: 1.713 Vali Acc: 0.434 Test Loss: 1.713 Test Acc: 0.434
Validation loss decreased (-0.234356 --> -0.434358).  Saving model ...
Epoch: 4 cost time: 2.909996271133423
Epoch: 4, Steps: 8 | Train Loss: 0.834 Vali Loss: 1.581 Vali Acc: 0.472 Test Loss: 1.581 Test Acc: 0.472
Validation loss decreased (-0.434358 --> -0.471859).  Saving model ...
Epoch: 5 cost time: 3.0507640838623047
Epoch: 5, Steps: 8 | Train Loss: 0.594 Vali Loss: 1.343 Vali Acc: 0.537 Test Loss: 1.343 Test Acc: 0.537
Validation loss decreased (-0.471859 --> -0.537487).  Saving model ...
Epoch: 6 cost time: 3.1451759338378906
Epoch: 6, Steps: 8 | Train Loss: 0.374 Vali Loss: 1.388 Vali Acc: 0.441 Test Loss: 1.388 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.898216485977173
Epoch: 7, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.359 Vali Acc: 0.497 Test Loss: 1.359 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9966890811920166
Epoch: 8, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.599 Vali Acc: 0.491 Test Loss: 1.599 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.102785587310791
Epoch: 9, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.634 Vali Acc: 0.478 Test Loss: 1.634 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0687739849090576
Epoch: 10, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.501 Vali Acc: 0.509 Test Loss: 1.501 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8810603618621826
Epoch: 11, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.849 Vali Acc: 0.419 Test Loss: 1.849 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.1526284217834473
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.924 Vali Acc: 0.463 Test Loss: 1.924 Test Acc: 0.463
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.2236709594726562
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.691 Vali Acc: 0.500 Test Loss: 1.691 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.0118408203125
Epoch: 14, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.683 Vali Acc: 0.516 Test Loss: 1.683 Test Acc: 0.516
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8182437419891357
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.873 Vali Acc: 0.475 Test Loss: 1.873 Test Acc: 0.475
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5375
model parameter : 4067848
model size : 25.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.216296672821045
Epoch: 1, Steps: 8 | Train Loss: 2.155 Vali Loss: 2.079 Vali Acc: 0.194 Test Loss: 2.079 Test Acc: 0.194
Validation loss decreased (inf --> -0.193729).  Saving model ...
Epoch: 2 cost time: 3.2946364879608154
Epoch: 2, Steps: 8 | Train Loss: 1.822 Vali Loss: 1.817 Vali Acc: 0.303 Test Loss: 1.817 Test Acc: 0.303
Validation loss decreased (-0.193729 --> -0.303107).  Saving model ...
Epoch: 3 cost time: 3.570199489593506
Epoch: 3, Steps: 8 | Train Loss: 1.367 Vali Loss: 1.469 Vali Acc: 0.491 Test Loss: 1.469 Test Acc: 0.491
Validation loss decreased (-0.303107 --> -0.490610).  Saving model ...
Epoch: 4 cost time: 3.621304750442505
Epoch: 4, Steps: 8 | Train Loss: 0.901 Vali Loss: 1.295 Vali Acc: 0.550 Test Loss: 1.295 Test Acc: 0.550
Validation loss decreased (-0.490610 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 3.145941972732544
Epoch: 5, Steps: 8 | Train Loss: 0.620 Vali Loss: 1.257 Vali Acc: 0.528 Test Loss: 1.257 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.215700387954712
Epoch: 6, Steps: 8 | Train Loss: 0.378 Vali Loss: 1.506 Vali Acc: 0.478 Test Loss: 1.506 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.110522508621216
Epoch: 7, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.656 Vali Acc: 0.500 Test Loss: 1.656 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.146270513534546
Epoch: 8, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.911 Vali Acc: 0.494 Test Loss: 1.911 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.062047243118286
Epoch: 9, Steps: 8 | Train Loss: 0.118 Vali Loss: 2.349 Vali Acc: 0.422 Test Loss: 2.349 Test Acc: 0.422
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.2377543449401855
Epoch: 10, Steps: 8 | Train Loss: 0.094 Vali Loss: 2.341 Vali Acc: 0.406 Test Loss: 2.341 Test Acc: 0.406
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2967329025268555
Epoch: 11, Steps: 8 | Train Loss: 0.077 Vali Loss: 2.632 Vali Acc: 0.419 Test Loss: 2.632 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.3356473445892334
Epoch: 12, Steps: 8 | Train Loss: 0.037 Vali Loss: 2.850 Vali Acc: 0.431 Test Loss: 2.850 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.188204288482666
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 2.599 Vali Acc: 0.450 Test Loss: 2.599 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.1264660358428955
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.738 Vali Acc: 0.456 Test Loss: 2.738 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.55
model parameter : 4067848
model size : 25.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.8938233852386475
Epoch: 1, Steps: 8 | Train Loss: 2.117 Vali Loss: 2.062 Vali Acc: 0.128 Test Loss: 2.062 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 2.983165979385376
Epoch: 2, Steps: 8 | Train Loss: 1.947 Vali Loss: 1.799 Vali Acc: 0.353 Test Loss: 1.799 Test Acc: 0.353
Validation loss decreased (-0.128104 --> -0.353107).  Saving model ...
Epoch: 3 cost time: 2.9221832752227783
Epoch: 3, Steps: 8 | Train Loss: 1.455 Vali Loss: 1.465 Vali Acc: 0.509 Test Loss: 1.465 Test Acc: 0.509
Validation loss decreased (-0.353107 --> -0.509360).  Saving model ...
Epoch: 4 cost time: 2.924232006072998
Epoch: 4, Steps: 8 | Train Loss: 0.994 Vali Loss: 1.296 Vali Acc: 0.566 Test Loss: 1.296 Test Acc: 0.566
Validation loss decreased (-0.509360 --> -0.565612).  Saving model ...
Epoch: 5 cost time: 3.0633223056793213
Epoch: 5, Steps: 8 | Train Loss: 0.688 Vali Loss: 1.289 Vali Acc: 0.509 Test Loss: 1.289 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0485103130340576
Epoch: 6, Steps: 8 | Train Loss: 0.437 Vali Loss: 1.603 Vali Acc: 0.444 Test Loss: 1.603 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0691771507263184
Epoch: 7, Steps: 8 | Train Loss: 0.297 Vali Loss: 1.637 Vali Acc: 0.484 Test Loss: 1.637 Test Acc: 0.484
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2817468643188477
Epoch: 8, Steps: 8 | Train Loss: 0.206 Vali Loss: 2.257 Vali Acc: 0.400 Test Loss: 2.257 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.468524694442749
Epoch: 9, Steps: 8 | Train Loss: 0.152 Vali Loss: 2.116 Vali Acc: 0.450 Test Loss: 2.116 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.3974990844726562
Epoch: 10, Steps: 8 | Train Loss: 0.118 Vali Loss: 2.440 Vali Acc: 0.400 Test Loss: 2.440 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.3109560012817383
Epoch: 11, Steps: 8 | Train Loss: 0.096 Vali Loss: 2.990 Vali Acc: 0.400 Test Loss: 2.990 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.302234411239624
Epoch: 12, Steps: 8 | Train Loss: 0.059 Vali Loss: 3.197 Vali Acc: 0.403 Test Loss: 3.197 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.107222557067871
Epoch: 13, Steps: 8 | Train Loss: 0.037 Vali Loss: 2.822 Vali Acc: 0.450 Test Loss: 2.822 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.1982333660125732
Epoch: 14, Steps: 8 | Train Loss: 0.028 Vali Loss: 3.298 Vali Acc: 0.375 Test Loss: 3.298 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.565625
model parameter : 4067848
model size : 25.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.038043260574341
Epoch: 1, Steps: 8 | Train Loss: 2.042 Vali Loss: 1.560 Vali Acc: 0.566 Test Loss: 1.560 Test Acc: 0.566
Validation loss decreased (inf --> -0.565609).  Saving model ...
Epoch: 2 cost time: 3.0939724445343018
Epoch: 2, Steps: 8 | Train Loss: 1.155 Vali Loss: 0.871 Vali Acc: 0.722 Test Loss: 0.871 Test Acc: 0.722
Validation loss decreased (-0.565609 --> -0.721866).  Saving model ...
Epoch: 3 cost time: 3.405283212661743
Epoch: 3, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.745 Vali Acc: 0.747 Test Loss: 0.745 Test Acc: 0.747
Validation loss decreased (-0.721866 --> -0.746868).  Saving model ...
Epoch: 4 cost time: 3.49596905708313
Epoch: 4, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.849 Vali Acc: 0.731 Test Loss: 0.849 Test Acc: 0.731
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4647209644317627
Epoch: 5, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.917 Vali Acc: 0.734 Test Loss: 0.917 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2282004356384277
Epoch: 6, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.009 Vali Acc: 0.744 Test Loss: 1.009 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.757052183151245
Epoch: 7, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.998 Vali Acc: 0.762 Test Loss: 0.998 Test Acc: 0.762
Validation loss decreased (-0.746868 --> -0.762490).  Saving model ...
Epoch: 8 cost time: 3.660297393798828
Epoch: 8, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.163 Vali Acc: 0.744 Test Loss: 1.163 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.445356607437134
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.324 Vali Acc: 0.716 Test Loss: 1.324 Test Acc: 0.716
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.442052125930786
Epoch: 10, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.433 Vali Acc: 0.709 Test Loss: 1.433 Test Acc: 0.709
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.4179728031158447
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.308 Vali Acc: 0.759 Test Loss: 1.308 Test Acc: 0.759
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.456010341644287
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.750 Test Loss: 1.330 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.430921792984009
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.344 Vali Acc: 0.750 Test Loss: 1.344 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.4278032779693604
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.305 Vali Acc: 0.753 Test Loss: 1.305 Test Acc: 0.753
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.4019975662231445
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.756 Test Loss: 1.296 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.4975693225860596
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.762 Test Loss: 1.297 Test Acc: 0.762
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.3614377975463867
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.307 Vali Acc: 0.759 Test Loss: 1.307 Test Acc: 0.759
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7625
model parameter : 3674632
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.55845046043396
Epoch: 1, Steps: 8 | Train Loss: 2.067 Vali Loss: 1.682 Vali Acc: 0.469 Test Loss: 1.682 Test Acc: 0.469
Validation loss decreased (inf --> -0.468733).  Saving model ...
Epoch: 2 cost time: 3.2407894134521484
Epoch: 2, Steps: 8 | Train Loss: 1.258 Vali Loss: 1.125 Vali Acc: 0.625 Test Loss: 1.125 Test Acc: 0.625
Validation loss decreased (-0.468733 --> -0.624989).  Saving model ...
Epoch: 3 cost time: 3.405761957168579
Epoch: 3, Steps: 8 | Train Loss: 0.585 Vali Loss: 0.964 Vali Acc: 0.691 Test Loss: 0.964 Test Acc: 0.691
Validation loss decreased (-0.624989 --> -0.690615).  Saving model ...
Epoch: 4 cost time: 3.170248031616211
Epoch: 4, Steps: 8 | Train Loss: 0.355 Vali Loss: 1.084 Vali Acc: 0.662 Test Loss: 1.084 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.319420576095581
Epoch: 5, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.209 Vali Acc: 0.666 Test Loss: 1.209 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0783605575561523
Epoch: 6, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.208 Vali Acc: 0.684 Test Loss: 1.208 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.358316659927368
Epoch: 7, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.340 Vali Acc: 0.678 Test Loss: 1.340 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.3249847888946533
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.425 Vali Acc: 0.684 Test Loss: 1.425 Test Acc: 0.684
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.187269926071167
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.485 Vali Acc: 0.697 Test Loss: 1.485 Test Acc: 0.697
Validation loss decreased (-0.690615 --> -0.696860).  Saving model ...
Epoch: 10 cost time: 3.1381711959838867
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.534 Vali Acc: 0.688 Test Loss: 1.534 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3290722370147705
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.506 Vali Acc: 0.688 Test Loss: 1.506 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2418971061706543
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.616 Vali Acc: 0.669 Test Loss: 1.616 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2066173553466797
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.572 Vali Acc: 0.669 Test Loss: 1.572 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.896425247192383
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.566 Vali Acc: 0.688 Test Loss: 1.566 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.0893478393554688
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.626 Vali Acc: 0.688 Test Loss: 1.626 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.494088888168335
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.648 Vali Acc: 0.688 Test Loss: 1.648 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.1174793243408203
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.688 Test Loss: 1.641 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.165766477584839
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.688 Test Loss: 1.617 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.306779384613037
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.688 Test Loss: 1.592 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.696875
model parameter : 3674632
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.6989617347717285
Epoch: 1, Steps: 8 | Train Loss: 2.116 Vali Loss: 1.801 Vali Acc: 0.388 Test Loss: 1.801 Test Acc: 0.388
Validation loss decreased (inf --> -0.387482).  Saving model ...
Epoch: 2 cost time: 2.956439256668091
Epoch: 2, Steps: 8 | Train Loss: 1.381 Vali Loss: 1.218 Vali Acc: 0.572 Test Loss: 1.218 Test Acc: 0.572
Validation loss decreased (-0.387482 --> -0.571863).  Saving model ...
Epoch: 3 cost time: 3.0555758476257324
Epoch: 3, Steps: 8 | Train Loss: 0.657 Vali Loss: 1.022 Vali Acc: 0.641 Test Loss: 1.022 Test Acc: 0.641
Validation loss decreased (-0.571863 --> -0.640615).  Saving model ...
Epoch: 4 cost time: 3.3287341594696045
Epoch: 4, Steps: 8 | Train Loss: 0.413 Vali Loss: 1.122 Vali Acc: 0.634 Test Loss: 1.122 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0693089962005615
Epoch: 5, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.165 Vali Acc: 0.641 Test Loss: 1.165 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.143740177154541
Epoch: 6, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.360 Vali Acc: 0.606 Test Loss: 1.360 Test Acc: 0.606
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.416896343231201
Epoch: 7, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.348 Vali Acc: 0.634 Test Loss: 1.348 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.456134080886841
Epoch: 8, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.373 Vali Acc: 0.653 Test Loss: 1.373 Test Acc: 0.653
Validation loss decreased (-0.640615 --> -0.653111).  Saving model ...
Epoch: 9 cost time: 3.4235799312591553
Epoch: 9, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.251 Vali Acc: 0.637 Test Loss: 1.251 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6791303157806396
Epoch: 10, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.642 Vali Acc: 0.650 Test Loss: 1.642 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2896034717559814
Epoch: 11, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.494 Vali Acc: 0.669 Test Loss: 1.494 Test Acc: 0.669
Validation loss decreased (-0.653111 --> -0.668735).  Saving model ...
Epoch: 12 cost time: 3.4797115325927734
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.476 Vali Acc: 0.666 Test Loss: 1.476 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6535496711730957
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.415 Vali Acc: 0.669 Test Loss: 1.415 Test Acc: 0.669
Validation loss decreased (-0.668735 --> -0.668736).  Saving model ...
Epoch: 14 cost time: 3.424083709716797
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.486 Vali Acc: 0.662 Test Loss: 1.486 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3118362426757812
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.536 Vali Acc: 0.691 Test Loss: 1.536 Test Acc: 0.691
Validation loss decreased (-0.668736 --> -0.690610).  Saving model ...
Epoch: 16 cost time: 3.4903664588928223
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.544 Vali Acc: 0.666 Test Loss: 1.544 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.567687749862671
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.589 Vali Acc: 0.672 Test Loss: 1.589 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.624488115310669
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.862 Vali Acc: 0.662 Test Loss: 1.862 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.4034740924835205
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.648 Vali Acc: 0.656 Test Loss: 1.648 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.416227102279663
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.694 Vali Acc: 0.647 Test Loss: 1.694 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.554577350616455
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.707 Vali Acc: 0.662 Test Loss: 1.707 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.281641960144043
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.661 Vali Acc: 0.675 Test Loss: 1.661 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.243013620376587
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.672 Test Loss: 1.644 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.5652408599853516
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.675 Test Loss: 1.640 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.454871416091919
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.678 Test Loss: 1.628 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.690625
model parameter : 3674632
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.812731742858887
Epoch: 1, Steps: 8 | Train Loss: 2.160 Vali Loss: 1.913 Vali Acc: 0.309 Test Loss: 1.913 Test Acc: 0.309
Validation loss decreased (inf --> -0.309356).  Saving model ...
Epoch: 2 cost time: 3.241715669631958
Epoch: 2, Steps: 8 | Train Loss: 1.608 Vali Loss: 1.403 Vali Acc: 0.509 Test Loss: 1.403 Test Acc: 0.509
Validation loss decreased (-0.309356 --> -0.509361).  Saving model ...
Epoch: 3 cost time: 3.3257768154144287
Epoch: 3, Steps: 8 | Train Loss: 0.885 Vali Loss: 1.142 Vali Acc: 0.581 Test Loss: 1.142 Test Acc: 0.581
Validation loss decreased (-0.509361 --> -0.581239).  Saving model ...
Epoch: 4 cost time: 3.1754233837127686
Epoch: 4, Steps: 8 | Train Loss: 0.544 Vali Loss: 1.164 Vali Acc: 0.609 Test Loss: 1.164 Test Acc: 0.609
Validation loss decreased (-0.581239 --> -0.609363).  Saving model ...
Epoch: 5 cost time: 2.9220499992370605
Epoch: 5, Steps: 8 | Train Loss: 0.305 Vali Loss: 1.229 Vali Acc: 0.581 Test Loss: 1.229 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2552402019500732
Epoch: 6, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.374 Vali Acc: 0.594 Test Loss: 1.374 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2948501110076904
Epoch: 7, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.451 Vali Acc: 0.566 Test Loss: 1.451 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.236318588256836
Epoch: 8, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.353 Vali Acc: 0.609 Test Loss: 1.353 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2402780055999756
Epoch: 9, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.340 Vali Acc: 0.634 Test Loss: 1.340 Test Acc: 0.634
Validation loss decreased (-0.609363 --> -0.634362).  Saving model ...
Epoch: 10 cost time: 3.2255280017852783
Epoch: 10, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.811 Vali Acc: 0.584 Test Loss: 1.811 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.308621883392334
Epoch: 11, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.488 Vali Acc: 0.634 Test Loss: 1.488 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3342480659484863
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.510 Vali Acc: 0.634 Test Loss: 1.510 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1532323360443115
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.593 Vali Acc: 0.603 Test Loss: 1.593 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.6956820487976074
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.711 Vali Acc: 0.609 Test Loss: 1.711 Test Acc: 0.609
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2723004817962646
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.604 Vali Acc: 0.659 Test Loss: 1.604 Test Acc: 0.659
Validation loss decreased (-0.634362 --> -0.659359).  Saving model ...
Epoch: 16 cost time: 3.2740707397460938
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.436 Vali Acc: 0.672 Test Loss: 1.436 Test Acc: 0.672
Validation loss decreased (-0.659359 --> -0.671861).  Saving model ...
Epoch: 17 cost time: 3.4679837226867676
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.514 Vali Acc: 0.653 Test Loss: 1.514 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.26692271232605
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.650 Test Loss: 1.529 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.270524263381958
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.500 Vali Acc: 0.666 Test Loss: 1.500 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8559999465942383
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.662 Test Loss: 1.505 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.939976692199707
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.656 Test Loss: 1.524 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.439610481262207
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.656 Test Loss: 1.531 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.1436169147491455
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.653 Test Loss: 1.533 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.194883346557617
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.653 Test Loss: 1.531 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.3838589191436768
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.653 Test Loss: 1.526 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.3345930576324463
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.656 Test Loss: 1.523 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.671875
model parameter : 3674632
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.4857494831085205
Epoch: 1, Steps: 8 | Train Loss: 2.158 Vali Loss: 1.979 Vali Acc: 0.269 Test Loss: 1.979 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 3.003868818283081
Epoch: 2, Steps: 8 | Train Loss: 1.750 Vali Loss: 1.681 Vali Acc: 0.391 Test Loss: 1.681 Test Acc: 0.391
Validation loss decreased (-0.268730 --> -0.390608).  Saving model ...
Epoch: 3 cost time: 3.154282331466675
Epoch: 3, Steps: 8 | Train Loss: 1.154 Vali Loss: 1.420 Vali Acc: 0.481 Test Loss: 1.420 Test Acc: 0.481
Validation loss decreased (-0.390608 --> -0.481236).  Saving model ...
Epoch: 4 cost time: 3.1450884342193604
Epoch: 4, Steps: 8 | Train Loss: 0.718 Vali Loss: 1.446 Vali Acc: 0.497 Test Loss: 1.446 Test Acc: 0.497
Validation loss decreased (-0.481236 --> -0.496861).  Saving model ...
Epoch: 5 cost time: 3.2892744541168213
Epoch: 5, Steps: 8 | Train Loss: 0.472 Vali Loss: 1.615 Vali Acc: 0.422 Test Loss: 1.615 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.235912561416626
Epoch: 6, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.759 Vali Acc: 0.450 Test Loss: 1.759 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2401833534240723
Epoch: 7, Steps: 8 | Train Loss: 0.225 Vali Loss: 1.602 Vali Acc: 0.469 Test Loss: 1.602 Test Acc: 0.469
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.187140941619873
Epoch: 8, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.720 Vali Acc: 0.497 Test Loss: 1.720 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2467384338378906
Epoch: 9, Steps: 8 | Train Loss: 0.177 Vali Loss: 2.188 Vali Acc: 0.444 Test Loss: 2.188 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.0468931198120117
Epoch: 10, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.792 Vali Acc: 0.509 Test Loss: 1.792 Test Acc: 0.509
Validation loss decreased (-0.496861 --> -0.509357).  Saving model ...
Epoch: 11 cost time: 3.22892165184021
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 2.373 Vali Acc: 0.384 Test Loss: 2.373 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.063439130783081
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.979 Vali Acc: 0.447 Test Loss: 1.979 Test Acc: 0.447
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.174708366394043
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.705 Vali Acc: 0.388 Test Loss: 2.705 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.2098686695098877
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 2.190 Vali Acc: 0.459 Test Loss: 2.190 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.2137746810913086
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.307 Vali Acc: 0.450 Test Loss: 2.307 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.1611101627349854
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.221 Vali Acc: 0.447 Test Loss: 2.221 Test Acc: 0.447
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.2150707244873047
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.029 Vali Acc: 0.497 Test Loss: 2.029 Test Acc: 0.497
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1428658962249756
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.323 Vali Acc: 0.450 Test Loss: 2.323 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.072366952896118
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.242 Vali Acc: 0.466 Test Loss: 2.242 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.0405004024505615
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.036 Vali Acc: 0.484 Test Loss: 2.036 Test Acc: 0.484
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.509375
model parameter : 3674632
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.099790334701538
Epoch: 1, Steps: 8 | Train Loss: 2.141 Vali Loss: 2.036 Vali Acc: 0.163 Test Loss: 2.036 Test Acc: 0.163
Validation loss decreased (inf --> -0.162480).  Saving model ...
Epoch: 2 cost time: 3.2761282920837402
Epoch: 2, Steps: 8 | Train Loss: 1.838 Vali Loss: 1.830 Vali Acc: 0.334 Test Loss: 1.830 Test Acc: 0.334
Validation loss decreased (-0.162480 --> -0.334357).  Saving model ...
Epoch: 3 cost time: 3.207551956176758
Epoch: 3, Steps: 8 | Train Loss: 1.311 Vali Loss: 1.645 Vali Acc: 0.397 Test Loss: 1.645 Test Acc: 0.397
Validation loss decreased (-0.334357 --> -0.396859).  Saving model ...
Epoch: 4 cost time: 3.170475482940674
Epoch: 4, Steps: 8 | Train Loss: 0.877 Vali Loss: 1.511 Vali Acc: 0.469 Test Loss: 1.511 Test Acc: 0.469
Validation loss decreased (-0.396859 --> -0.468735).  Saving model ...
Epoch: 5 cost time: 2.996947765350342
Epoch: 5, Steps: 8 | Train Loss: 0.592 Vali Loss: 1.637 Vali Acc: 0.344 Test Loss: 1.637 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0172951221466064
Epoch: 6, Steps: 8 | Train Loss: 0.384 Vali Loss: 1.612 Vali Acc: 0.378 Test Loss: 1.612 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.791339874267578
Epoch: 7, Steps: 8 | Train Loss: 0.280 Vali Loss: 1.516 Vali Acc: 0.434 Test Loss: 1.516 Test Acc: 0.434
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.314528226852417
Epoch: 8, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.483 Vali Acc: 0.419 Test Loss: 1.483 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1042137145996094
Epoch: 9, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.942 Vali Acc: 0.359 Test Loss: 1.942 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.25620698928833
Epoch: 10, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.883 Vali Acc: 0.403 Test Loss: 1.883 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2554550170898438
Epoch: 11, Steps: 8 | Train Loss: 0.076 Vali Loss: 2.082 Vali Acc: 0.391 Test Loss: 2.082 Test Acc: 0.391
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.157451868057251
Epoch: 12, Steps: 8 | Train Loss: 0.055 Vali Loss: 2.252 Vali Acc: 0.416 Test Loss: 2.252 Test Acc: 0.416
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8411858081817627
Epoch: 13, Steps: 8 | Train Loss: 0.049 Vali Loss: 2.412 Vali Acc: 0.356 Test Loss: 2.412 Test Acc: 0.356
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.02791166305542
Epoch: 14, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.749 Vali Acc: 0.497 Test Loss: 1.749 Test Acc: 0.497
Validation loss decreased (-0.468735 --> -0.496858).  Saving model ...
Epoch: 15 cost time: 2.7325611114501953
Epoch: 15, Steps: 8 | Train Loss: 0.032 Vali Loss: 2.657 Vali Acc: 0.309 Test Loss: 2.657 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.768914222717285
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.986 Vali Acc: 0.497 Test Loss: 1.986 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9361412525177
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 3.095 Vali Acc: 0.316 Test Loss: 3.095 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1511449813842773
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.958 Vali Acc: 0.503 Test Loss: 1.958 Test Acc: 0.503
Validation loss decreased (-0.496858 --> -0.503105).  Saving model ...
Epoch: 19 cost time: 3.1070709228515625
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.472 Vali Acc: 0.388 Test Loss: 2.472 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.152031660079956
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.095 Vali Acc: 0.438 Test Loss: 2.095 Test Acc: 0.438
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.139103651046753
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.999 Vali Acc: 0.459 Test Loss: 1.999 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.041720151901245
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.892 Vali Acc: 0.491 Test Loss: 1.892 Test Acc: 0.491
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.852832794189453
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.075 Vali Acc: 0.456 Test Loss: 2.075 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.131110429763794
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.024 Vali Acc: 0.491 Test Loss: 2.024 Test Acc: 0.491
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.9010088443756104
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.918 Vali Acc: 0.500 Test Loss: 1.918 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.309816360473633
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.911 Vali Acc: 0.512 Test Loss: 1.911 Test Acc: 0.512
Validation loss decreased (-0.503105 --> -0.512481).  Saving model ...
Epoch: 27 cost time: 3.218661308288574
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.919 Vali Acc: 0.509 Test Loss: 1.919 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2742419242858887
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.945 Vali Acc: 0.506 Test Loss: 1.945 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.054220199584961
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.845 Vali Acc: 0.537 Test Loss: 1.845 Test Acc: 0.537
Validation loss decreased (-0.512481 --> -0.537482).  Saving model ...
Epoch: 30 cost time: 3.294612169265747
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.889 Vali Acc: 0.531 Test Loss: 1.889 Test Acc: 0.531
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.249163866043091
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.966 Vali Acc: 0.509 Test Loss: 1.966 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.125243663787842
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.943 Vali Acc: 0.512 Test Loss: 1.943 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.063993453979492
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.906 Vali Acc: 0.522 Test Loss: 1.906 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.376718759536743
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.528 Test Loss: 1.901 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.3206443786621094
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.899 Vali Acc: 0.537 Test Loss: 1.899 Test Acc: 0.537
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.691683769226074
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.902 Vali Acc: 0.531 Test Loss: 1.902 Test Acc: 0.531
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.333252429962158
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.900 Vali Acc: 0.537 Test Loss: 1.900 Test Acc: 0.537
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.3706629276275635
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.953 Vali Acc: 0.512 Test Loss: 1.953 Test Acc: 0.512
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.191527843475342
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.925 Vali Acc: 0.525 Test Loss: 1.925 Test Acc: 0.525
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5375
model parameter : 3674632
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.826455593109131
Epoch: 1, Steps: 8 | Train Loss: 2.172 Vali Loss: 2.082 Vali Acc: 0.128 Test Loss: 2.082 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 3.0930068492889404
Epoch: 2, Steps: 8 | Train Loss: 1.879 Vali Loss: 1.931 Vali Acc: 0.209 Test Loss: 1.931 Test Acc: 0.209
Validation loss decreased (-0.128104 --> -0.209356).  Saving model ...
Epoch: 3 cost time: 3.127694606781006
Epoch: 3, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.741 Vali Acc: 0.372 Test Loss: 1.741 Test Acc: 0.372
Validation loss decreased (-0.209356 --> -0.371858).  Saving model ...
Epoch: 4 cost time: 3.047616720199585
Epoch: 4, Steps: 8 | Train Loss: 0.869 Vali Loss: 1.568 Vali Acc: 0.428 Test Loss: 1.568 Test Acc: 0.428
Validation loss decreased (-0.371858 --> -0.428109).  Saving model ...
Epoch: 5 cost time: 3.264458179473877
Epoch: 5, Steps: 8 | Train Loss: 0.596 Vali Loss: 1.572 Vali Acc: 0.397 Test Loss: 1.572 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.317918300628662
Epoch: 6, Steps: 8 | Train Loss: 0.378 Vali Loss: 1.504 Vali Acc: 0.450 Test Loss: 1.504 Test Acc: 0.450
Validation loss decreased (-0.428109 --> -0.449985).  Saving model ...
Epoch: 7 cost time: 3.6595258712768555
Epoch: 7, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.411 Vali Acc: 0.466 Test Loss: 1.411 Test Acc: 0.466
Validation loss decreased (-0.449985 --> -0.465611).  Saving model ...
Epoch: 8 cost time: 2.853641986846924
Epoch: 8, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.563 Vali Acc: 0.466 Test Loss: 1.563 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1959218978881836
Epoch: 9, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.686 Vali Acc: 0.384 Test Loss: 1.686 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.970059871673584
Epoch: 10, Steps: 8 | Train Loss: 0.093 Vali Loss: 2.071 Vali Acc: 0.378 Test Loss: 2.071 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.123953342437744
Epoch: 11, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.742 Vali Acc: 0.412 Test Loss: 1.742 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.122124195098877
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.891 Vali Acc: 0.406 Test Loss: 1.891 Test Acc: 0.406
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.094785213470459
Epoch: 13, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.825 Vali Acc: 0.419 Test Loss: 1.825 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.144672393798828
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.902 Vali Acc: 0.422 Test Loss: 1.902 Test Acc: 0.422
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.1105284690856934
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.031 Vali Acc: 0.378 Test Loss: 2.031 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.785855293273926
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.772 Vali Acc: 0.494 Test Loss: 1.772 Test Acc: 0.494
Validation loss decreased (-0.465611 --> -0.493732).  Saving model ...
Epoch: 17 cost time: 3.1276395320892334
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.606 Vali Acc: 0.347 Test Loss: 2.606 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3266868591308594
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.453 Vali Acc: 0.547 Test Loss: 1.453 Test Acc: 0.547
Validation loss decreased (-0.493732 --> -0.546860).  Saving model ...
Epoch: 19 cost time: 3.2496769428253174
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.452 Vali Acc: 0.381 Test Loss: 2.452 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0654423236846924
Epoch: 20, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.991 Vali Acc: 0.434 Test Loss: 1.991 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1150410175323486
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.676 Vali Acc: 0.503 Test Loss: 1.676 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.109931707382202
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.884 Vali Acc: 0.481 Test Loss: 1.884 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.111527442932129
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.916 Vali Acc: 0.509 Test Loss: 1.916 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.991119384765625
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.021 Vali Acc: 0.484 Test Loss: 2.021 Test Acc: 0.484
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.8795206546783447
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.069 Vali Acc: 0.463 Test Loss: 2.069 Test Acc: 0.463
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.2188520431518555
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.781 Vali Acc: 0.522 Test Loss: 1.781 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.2536563873291016
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.747 Vali Acc: 0.541 Test Loss: 1.747 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.180156707763672
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.827 Vali Acc: 0.531 Test Loss: 1.827 Test Acc: 0.531
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.546875
model parameter : 3674632
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.6542041301727295
Epoch: 1, Steps: 8 | Train Loss: 2.139 Vali Loss: 2.084 Vali Acc: 0.141 Test Loss: 2.084 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 2.8188631534576416
Epoch: 2, Steps: 8 | Train Loss: 1.854 Vali Loss: 1.958 Vali Acc: 0.284 Test Loss: 1.958 Test Acc: 0.284
Validation loss decreased (-0.140604 --> -0.284355).  Saving model ...
Epoch: 3 cost time: 3.061173677444458
Epoch: 3, Steps: 8 | Train Loss: 1.299 Vali Loss: 1.748 Vali Acc: 0.434 Test Loss: 1.748 Test Acc: 0.434
Validation loss decreased (-0.284355 --> -0.434358).  Saving model ...
Epoch: 4 cost time: 2.8164029121398926
Epoch: 4, Steps: 8 | Train Loss: 0.809 Vali Loss: 1.569 Vali Acc: 0.456 Test Loss: 1.569 Test Acc: 0.456
Validation loss decreased (-0.434358 --> -0.456234).  Saving model ...
Epoch: 5 cost time: 3.2021913528442383
Epoch: 5, Steps: 8 | Train Loss: 0.519 Vali Loss: 1.503 Vali Acc: 0.431 Test Loss: 1.503 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.617908239364624
Epoch: 6, Steps: 8 | Train Loss: 0.341 Vali Loss: 1.415 Vali Acc: 0.469 Test Loss: 1.415 Test Acc: 0.469
Validation loss decreased (-0.456234 --> -0.468736).  Saving model ...
Epoch: 7 cost time: 2.9269750118255615
Epoch: 7, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.394 Vali Acc: 0.528 Test Loss: 1.394 Test Acc: 0.528
Validation loss decreased (-0.468736 --> -0.528111).  Saving model ...
Epoch: 8 cost time: 2.8426272869110107
Epoch: 8, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.685 Vali Acc: 0.428 Test Loss: 1.685 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.930619239807129
Epoch: 9, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.534 Vali Acc: 0.503 Test Loss: 1.534 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9143714904785156
Epoch: 10, Steps: 8 | Train Loss: 0.070 Vali Loss: 2.001 Vali Acc: 0.425 Test Loss: 2.001 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.162978410720825
Epoch: 11, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.492 Vali Acc: 0.544 Test Loss: 1.492 Test Acc: 0.544
Validation loss decreased (-0.528111 --> -0.543735).  Saving model ...
Epoch: 12 cost time: 2.994368314743042
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 2.079 Vali Acc: 0.425 Test Loss: 2.079 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3386127948760986
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.544 Vali Acc: 0.537 Test Loss: 1.544 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.472883462905884
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.882 Vali Acc: 0.478 Test Loss: 1.882 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.5464751720428467
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.765 Vali Acc: 0.494 Test Loss: 1.765 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.985124349594116
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.061 Vali Acc: 0.475 Test Loss: 2.061 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.122119665145874
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.791 Vali Acc: 0.531 Test Loss: 1.791 Test Acc: 0.531
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.972879648208618
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.877 Vali Acc: 0.559 Test Loss: 1.877 Test Acc: 0.559
Validation loss decreased (-0.543735 --> -0.559356).  Saving model ...
Epoch: 19 cost time: 3.0843896865844727
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.806 Vali Acc: 0.534 Test Loss: 1.806 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1406161785125732
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.012 Vali Acc: 0.506 Test Loss: 2.012 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0661349296569824
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.082 Vali Acc: 0.509 Test Loss: 2.082 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.1650888919830322
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.144 Vali Acc: 0.497 Test Loss: 2.144 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.2874584197998047
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.043 Vali Acc: 0.506 Test Loss: 2.043 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.0672428607940674
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.006 Vali Acc: 0.509 Test Loss: 2.006 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.986544132232666
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.020 Vali Acc: 0.525 Test Loss: 2.020 Test Acc: 0.525
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.102423667907715
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.990 Vali Acc: 0.553 Test Loss: 1.990 Test Acc: 0.553
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.0572314262390137
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.898 Vali Acc: 0.550 Test Loss: 1.898 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.252605438232422
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.911 Vali Acc: 0.544 Test Loss: 1.911 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.559375
model parameter : 3674632
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.08457350730896
Epoch: 1, Steps: 8 | Train Loss: 2.095 Vali Loss: 2.134 Vali Acc: 0.134 Test Loss: 2.134 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 3.065124273300171
Epoch: 2, Steps: 8 | Train Loss: 1.901 Vali Loss: 1.874 Vali Acc: 0.263 Test Loss: 1.874 Test Acc: 0.263
Validation loss decreased (-0.134354 --> -0.262481).  Saving model ...
Epoch: 3 cost time: 3.1481926441192627
Epoch: 3, Steps: 8 | Train Loss: 1.327 Vali Loss: 1.546 Vali Acc: 0.397 Test Loss: 1.546 Test Acc: 0.397
Validation loss decreased (-0.262481 --> -0.396860).  Saving model ...
Epoch: 4 cost time: 2.988604784011841
Epoch: 4, Steps: 8 | Train Loss: 0.853 Vali Loss: 1.334 Vali Acc: 0.522 Test Loss: 1.334 Test Acc: 0.522
Validation loss decreased (-0.396860 --> -0.521862).  Saving model ...
Epoch: 5 cost time: 3.1184749603271484
Epoch: 5, Steps: 8 | Train Loss: 0.575 Vali Loss: 1.306 Vali Acc: 0.534 Test Loss: 1.306 Test Acc: 0.534
Validation loss decreased (-0.521862 --> -0.534362).  Saving model ...
Epoch: 6 cost time: 3.1589298248291016
Epoch: 6, Steps: 8 | Train Loss: 0.374 Vali Loss: 1.469 Vali Acc: 0.481 Test Loss: 1.469 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.10457181930542
Epoch: 7, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.613 Vali Acc: 0.494 Test Loss: 1.613 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.128796100616455
Epoch: 8, Steps: 8 | Train Loss: 0.185 Vali Loss: 2.002 Vali Acc: 0.447 Test Loss: 2.002 Test Acc: 0.447
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1677968502044678
Epoch: 9, Steps: 8 | Train Loss: 0.113 Vali Loss: 2.206 Vali Acc: 0.431 Test Loss: 2.206 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.115586996078491
Epoch: 10, Steps: 8 | Train Loss: 0.076 Vali Loss: 2.554 Vali Acc: 0.416 Test Loss: 2.554 Test Acc: 0.416
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1443188190460205
Epoch: 11, Steps: 8 | Train Loss: 0.070 Vali Loss: 2.535 Vali Acc: 0.416 Test Loss: 2.535 Test Acc: 0.416
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.0095174312591553
Epoch: 12, Steps: 8 | Train Loss: 0.041 Vali Loss: 2.725 Vali Acc: 0.425 Test Loss: 2.725 Test Acc: 0.425
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.7348320484161377
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 2.806 Vali Acc: 0.456 Test Loss: 2.806 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.7350611686706543
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 3.244 Vali Acc: 0.422 Test Loss: 3.244 Test Acc: 0.422
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.0163609981536865
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.813 Vali Acc: 0.456 Test Loss: 2.813 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.534375
model parameter : 3674632
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.274728298187256
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 2.025 Vali Acc: 0.184 Test Loss: 2.025 Test Acc: 0.184
Validation loss decreased (inf --> -0.184355).  Saving model ...
Epoch: 2 cost time: 3.014958620071411
Epoch: 2, Steps: 8 | Train Loss: 1.878 Vali Loss: 1.759 Vali Acc: 0.400 Test Loss: 1.759 Test Acc: 0.400
Validation loss decreased (-0.184355 --> -0.399982).  Saving model ...
Epoch: 3 cost time: 2.9280078411102295
Epoch: 3, Steps: 8 | Train Loss: 1.425 Vali Loss: 1.437 Vali Acc: 0.525 Test Loss: 1.437 Test Acc: 0.525
Validation loss decreased (-0.399982 --> -0.524986).  Saving model ...
Epoch: 4 cost time: 2.96110463142395
Epoch: 4, Steps: 8 | Train Loss: 0.964 Vali Loss: 1.261 Vali Acc: 0.522 Test Loss: 1.261 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.151160955429077
Epoch: 5, Steps: 8 | Train Loss: 0.617 Vali Loss: 1.272 Vali Acc: 0.547 Test Loss: 1.272 Test Acc: 0.547
Validation loss decreased (-0.524986 --> -0.546862).  Saving model ...
Epoch: 6 cost time: 3.8782341480255127
Epoch: 6, Steps: 8 | Train Loss: 0.400 Vali Loss: 1.564 Vali Acc: 0.469 Test Loss: 1.564 Test Acc: 0.469
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.276454448699951
Epoch: 7, Steps: 8 | Train Loss: 0.290 Vali Loss: 1.946 Vali Acc: 0.422 Test Loss: 1.946 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1745617389678955
Epoch: 8, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.844 Vali Acc: 0.491 Test Loss: 1.844 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0289113521575928
Epoch: 9, Steps: 8 | Train Loss: 0.154 Vali Loss: 2.631 Vali Acc: 0.381 Test Loss: 2.631 Test Acc: 0.381
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.13472056388855
Epoch: 10, Steps: 8 | Train Loss: 0.131 Vali Loss: 2.614 Vali Acc: 0.384 Test Loss: 2.614 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.223947525024414
Epoch: 11, Steps: 8 | Train Loss: 0.084 Vali Loss: 3.396 Vali Acc: 0.369 Test Loss: 3.396 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2412705421447754
Epoch: 12, Steps: 8 | Train Loss: 0.066 Vali Loss: 2.792 Vali Acc: 0.400 Test Loss: 2.792 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.296494483947754
Epoch: 13, Steps: 8 | Train Loss: 0.051 Vali Loss: 3.172 Vali Acc: 0.388 Test Loss: 3.172 Test Acc: 0.388
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.1693217754364014
Epoch: 14, Steps: 8 | Train Loss: 0.036 Vali Loss: 3.509 Vali Acc: 0.366 Test Loss: 3.509 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.5189759731292725
Epoch: 15, Steps: 8 | Train Loss: 0.040 Vali Loss: 3.008 Vali Acc: 0.400 Test Loss: 3.008 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.546875
model parameter : 3674632
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.922392129898071
Epoch: 1, Steps: 8 | Train Loss: 2.173 Vali Loss: 1.576 Vali Acc: 0.569 Test Loss: 1.576 Test Acc: 0.569
Validation loss decreased (inf --> -0.568734).  Saving model ...
Epoch: 2 cost time: 3.4898548126220703
Epoch: 2, Steps: 8 | Train Loss: 1.160 Vali Loss: 0.855 Vali Acc: 0.731 Test Loss: 0.855 Test Acc: 0.731
Validation loss decreased (-0.568734 --> -0.731241).  Saving model ...
Epoch: 3 cost time: 3.0876822471618652
Epoch: 3, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.745 Vali Acc: 0.756 Test Loss: 0.745 Test Acc: 0.756
Validation loss decreased (-0.731241 --> -0.756243).  Saving model ...
Epoch: 4 cost time: 3.3282997608184814
Epoch: 4, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.792 Vali Acc: 0.759 Test Loss: 0.792 Test Acc: 0.759
Validation loss decreased (-0.756243 --> -0.759367).  Saving model ...
Epoch: 5 cost time: 3.0853428840637207
Epoch: 5, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.852 Vali Acc: 0.753 Test Loss: 0.852 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1258349418640137
Epoch: 6, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.092 Vali Acc: 0.756 Test Loss: 1.092 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.177333116531372
Epoch: 7, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.163 Vali Acc: 0.709 Test Loss: 1.163 Test Acc: 0.709
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.368736982345581
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.258 Vali Acc: 0.728 Test Loss: 1.258 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3070595264434814
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.472 Vali Acc: 0.741 Test Loss: 1.472 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.3890397548675537
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.264 Vali Acc: 0.734 Test Loss: 1.264 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.460833787918091
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.318 Vali Acc: 0.722 Test Loss: 1.318 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.475750684738159
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.467 Vali Acc: 0.741 Test Loss: 1.467 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.7517292499542236
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.449 Vali Acc: 0.741 Test Loss: 1.449 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.427450656890869
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.464 Vali Acc: 0.725 Test Loss: 1.464 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.759375
model parameter : 3478024
model size : 23.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.821171045303345
Epoch: 1, Steps: 8 | Train Loss: 2.141 Vali Loss: 1.657 Vali Acc: 0.466 Test Loss: 1.657 Test Acc: 0.466
Validation loss decreased (inf --> -0.465608).  Saving model ...
Epoch: 2 cost time: 3.3006608486175537
Epoch: 2, Steps: 8 | Train Loss: 1.273 Vali Loss: 1.103 Vali Acc: 0.628 Test Loss: 1.103 Test Acc: 0.628
Validation loss decreased (-0.465608 --> -0.628114).  Saving model ...
Epoch: 3 cost time: 3.5189242362976074
Epoch: 3, Steps: 8 | Train Loss: 0.605 Vali Loss: 1.038 Vali Acc: 0.653 Test Loss: 1.038 Test Acc: 0.653
Validation loss decreased (-0.628114 --> -0.653115).  Saving model ...
Epoch: 4 cost time: 3.2927401065826416
Epoch: 4, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.978 Vali Acc: 0.703 Test Loss: 0.978 Test Acc: 0.703
Validation loss decreased (-0.653115 --> -0.703115).  Saving model ...
Epoch: 5 cost time: 3.152615785598755
Epoch: 5, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.114 Vali Acc: 0.688 Test Loss: 1.114 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.205296039581299
Epoch: 6, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.495 Vali Acc: 0.644 Test Loss: 1.495 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6267309188842773
Epoch: 7, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.459 Vali Acc: 0.641 Test Loss: 1.459 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.332813024520874
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.435 Vali Acc: 0.672 Test Loss: 1.435 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.4489574432373047
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.579 Vali Acc: 0.656 Test Loss: 1.579 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.1821587085723877
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.549 Vali Acc: 0.669 Test Loss: 1.549 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.5878143310546875
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.653 Vali Acc: 0.662 Test Loss: 1.653 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.3434183597564697
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.637 Vali Acc: 0.675 Test Loss: 1.637 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.255892753601074
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.620 Vali Acc: 0.675 Test Loss: 1.620 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.3779454231262207
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.678 Test Loss: 1.606 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.703125
model parameter : 3478024
model size : 23.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.960162401199341
Epoch: 1, Steps: 8 | Train Loss: 2.129 Vali Loss: 1.761 Vali Acc: 0.409 Test Loss: 1.761 Test Acc: 0.409
Validation loss decreased (inf --> -0.409357).  Saving model ...
Epoch: 2 cost time: 3.6001980304718018
Epoch: 2, Steps: 8 | Train Loss: 1.421 Vali Loss: 1.215 Vali Acc: 0.572 Test Loss: 1.215 Test Acc: 0.572
Validation loss decreased (-0.409357 --> -0.571863).  Saving model ...
Epoch: 3 cost time: 3.50350022315979
Epoch: 3, Steps: 8 | Train Loss: 0.705 Vali Loss: 1.086 Vali Acc: 0.622 Test Loss: 1.086 Test Acc: 0.622
Validation loss decreased (-0.571863 --> -0.621864).  Saving model ...
Epoch: 4 cost time: 3.5114691257476807
Epoch: 4, Steps: 8 | Train Loss: 0.356 Vali Loss: 1.022 Vali Acc: 0.659 Test Loss: 1.022 Test Acc: 0.659
Validation loss decreased (-0.621864 --> -0.659365).  Saving model ...
Epoch: 5 cost time: 3.399477243423462
Epoch: 5, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.054 Vali Acc: 0.656 Test Loss: 1.054 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1831071376800537
Epoch: 6, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.428 Vali Acc: 0.628 Test Loss: 1.428 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2971861362457275
Epoch: 7, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.364 Vali Acc: 0.637 Test Loss: 1.364 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.088141918182373
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.256 Vali Acc: 0.672 Test Loss: 1.256 Test Acc: 0.672
Validation loss decreased (-0.659365 --> -0.671862).  Saving model ...
Epoch: 9 cost time: 3.2899951934814453
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.224 Vali Acc: 0.656 Test Loss: 1.224 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.405101776123047
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.257 Vali Acc: 0.675 Test Loss: 1.257 Test Acc: 0.675
Validation loss decreased (-0.671862 --> -0.674987).  Saving model ...
Epoch: 11 cost time: 3.5748560428619385
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.383 Vali Acc: 0.666 Test Loss: 1.383 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6328978538513184
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.346 Vali Acc: 0.672 Test Loss: 1.346 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4352941513061523
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.273 Vali Acc: 0.684 Test Loss: 1.273 Test Acc: 0.684
Validation loss decreased (-0.674987 --> -0.684362).  Saving model ...
Epoch: 14 cost time: 3.4435479640960693
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.259 Vali Acc: 0.691 Test Loss: 1.259 Test Acc: 0.691
Validation loss decreased (-0.684362 --> -0.690612).  Saving model ...
Epoch: 15 cost time: 3.2505202293395996
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.264 Vali Acc: 0.688 Test Loss: 1.264 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5216152667999268
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.278 Vali Acc: 0.691 Test Loss: 1.278 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.323606014251709
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.278 Vali Acc: 0.691 Test Loss: 1.278 Test Acc: 0.691
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0659596920013428
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.279 Vali Acc: 0.694 Test Loss: 1.279 Test Acc: 0.694
Validation loss decreased (-0.690612 --> -0.693737).  Saving model ...
Epoch: 19 cost time: 3.386518716812134
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.688 Test Loss: 1.284 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.144904851913452
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.697 Test Loss: 1.276 Test Acc: 0.697
Validation loss decreased (-0.693737 --> -0.696862).  Saving model ...
Epoch: 21 cost time: 3.287665367126465
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.703 Test Loss: 1.275 Test Acc: 0.703
Validation loss decreased (-0.696862 --> -0.703112).  Saving model ...
Epoch: 22 cost time: 3.4908499717712402
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.272 Vali Acc: 0.709 Test Loss: 1.272 Test Acc: 0.709
Validation loss decreased (-0.703112 --> -0.709362).  Saving model ...
Epoch: 23 cost time: 3.372960090637207
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.269 Vali Acc: 0.700 Test Loss: 1.269 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.242844820022583
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.706 Test Loss: 1.273 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.919039487838745
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.280 Vali Acc: 0.706 Test Loss: 1.280 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.458773374557495
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.290 Vali Acc: 0.703 Test Loss: 1.290 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.54247784614563
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.293 Vali Acc: 0.703 Test Loss: 1.293 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.4891672134399414
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.706 Test Loss: 1.297 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.384337902069092
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.700 Test Loss: 1.297 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.113959789276123
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.289 Vali Acc: 0.709 Test Loss: 1.289 Test Acc: 0.709
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.4740025997161865
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.289 Vali Acc: 0.713 Test Loss: 1.289 Test Acc: 0.713
Validation loss decreased (-0.709362 --> -0.712487).  Saving model ...
Epoch: 32 cost time: 3.20310115814209
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.291 Vali Acc: 0.713 Test Loss: 1.291 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.2800817489624023
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.700 Test Loss: 1.297 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.4519965648651123
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.303 Vali Acc: 0.694 Test Loss: 1.303 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.4489808082580566
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.697 Test Loss: 1.301 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.3953347206115723
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.706 Test Loss: 1.299 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.5968024730682373
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.706 Test Loss: 1.298 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.4896819591522217
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.706 Test Loss: 1.299 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.33290433883667
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.713 Test Loss: 1.299 Test Acc: 0.713
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.3402605056762695
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.305 Vali Acc: 0.709 Test Loss: 1.305 Test Acc: 0.709
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.8544270992279053
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.306 Vali Acc: 0.709 Test Loss: 1.306 Test Acc: 0.709
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7125
model parameter : 3478024
model size : 23.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.950992584228516
Epoch: 1, Steps: 8 | Train Loss: 2.133 Vali Loss: 1.875 Vali Acc: 0.322 Test Loss: 1.875 Test Acc: 0.322
Validation loss decreased (inf --> -0.321856).  Saving model ...
Epoch: 2 cost time: 3.185889482498169
Epoch: 2, Steps: 8 | Train Loss: 1.610 Vali Loss: 1.390 Vali Acc: 0.525 Test Loss: 1.390 Test Acc: 0.525
Validation loss decreased (-0.321856 --> -0.524986).  Saving model ...
Epoch: 3 cost time: 3.6231303215026855
Epoch: 3, Steps: 8 | Train Loss: 0.889 Vali Loss: 1.253 Vali Acc: 0.547 Test Loss: 1.253 Test Acc: 0.547
Validation loss decreased (-0.524986 --> -0.546862).  Saving model ...
Epoch: 4 cost time: 3.28847074508667
Epoch: 4, Steps: 8 | Train Loss: 0.523 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
Validation loss decreased (-0.546862 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 3.2899203300476074
Epoch: 5, Steps: 8 | Train Loss: 0.368 Vali Loss: 1.089 Vali Acc: 0.628 Test Loss: 1.089 Test Acc: 0.628
Validation loss decreased (-0.599989 --> -0.628114).  Saving model ...
Epoch: 6 cost time: 3.441753625869751
Epoch: 6, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.288 Vali Acc: 0.594 Test Loss: 1.288 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.475527048110962
Epoch: 7, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.466 Vali Acc: 0.519 Test Loss: 1.466 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4316136837005615
Epoch: 8, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.227 Vali Acc: 0.616 Test Loss: 1.227 Test Acc: 0.616
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.306942939758301
Epoch: 9, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.564 Vali Acc: 0.569 Test Loss: 1.564 Test Acc: 0.569
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4091975688934326
Epoch: 10, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.505 Vali Acc: 0.606 Test Loss: 1.505 Test Acc: 0.606
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.7202582359313965
Epoch: 11, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.813 Vali Acc: 0.569 Test Loss: 1.813 Test Acc: 0.569
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.3004446029663086
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.375 Vali Acc: 0.637 Test Loss: 1.375 Test Acc: 0.637
Validation loss decreased (-0.628114 --> -0.637486).  Saving model ...
Epoch: 13 cost time: 2.8408539295196533
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.343 Vali Acc: 0.669 Test Loss: 1.343 Test Acc: 0.669
Validation loss decreased (-0.637486 --> -0.668737).  Saving model ...
Epoch: 14 cost time: 3.0616822242736816
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.880 Vali Acc: 0.603 Test Loss: 1.880 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3523495197296143
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.624 Vali Acc: 0.644 Test Loss: 1.624 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4066624641418457
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.563 Vali Acc: 0.656 Test Loss: 1.563 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.443450450897217
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.542 Vali Acc: 0.656 Test Loss: 1.542 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.374586582183838
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.550 Vali Acc: 0.647 Test Loss: 1.550 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.32435941696167
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.573 Vali Acc: 0.641 Test Loss: 1.573 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.617110013961792
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.650 Test Loss: 1.574 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.1884994506835938
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.662 Test Loss: 1.558 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.4539244174957275
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.666 Test Loss: 1.541 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.1137466430664062
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.659 Test Loss: 1.541 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.66875
model parameter : 3478024
model size : 23.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.852349519729614
Epoch: 1, Steps: 8 | Train Loss: 2.164 Vali Loss: 1.983 Vali Acc: 0.203 Test Loss: 1.983 Test Acc: 0.203
Validation loss decreased (inf --> -0.203105).  Saving model ...
Epoch: 2 cost time: 3.220224142074585
Epoch: 2, Steps: 8 | Train Loss: 1.780 Vali Loss: 1.678 Vali Acc: 0.369 Test Loss: 1.678 Test Acc: 0.369
Validation loss decreased (-0.203105 --> -0.368733).  Saving model ...
Epoch: 3 cost time: 3.5560128688812256
Epoch: 3, Steps: 8 | Train Loss: 1.144 Vali Loss: 1.534 Vali Acc: 0.425 Test Loss: 1.534 Test Acc: 0.425
Validation loss decreased (-0.368733 --> -0.424985).  Saving model ...
Epoch: 4 cost time: 3.4293477535247803
Epoch: 4, Steps: 8 | Train Loss: 0.713 Vali Loss: 1.452 Vali Acc: 0.409 Test Loss: 1.452 Test Acc: 0.409
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.807964563369751
Epoch: 5, Steps: 8 | Train Loss: 0.512 Vali Loss: 1.582 Vali Acc: 0.425 Test Loss: 1.582 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5630643367767334
Epoch: 6, Steps: 8 | Train Loss: 0.389 Vali Loss: 1.609 Vali Acc: 0.463 Test Loss: 1.609 Test Acc: 0.463
Validation loss decreased (-0.424985 --> -0.462484).  Saving model ...
Epoch: 7 cost time: 3.1211721897125244
Epoch: 7, Steps: 8 | Train Loss: 0.238 Vali Loss: 1.741 Vali Acc: 0.434 Test Loss: 1.741 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2740819454193115
Epoch: 8, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.736 Vali Acc: 0.453 Test Loss: 1.736 Test Acc: 0.453
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.285449981689453
Epoch: 9, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.691 Vali Acc: 0.472 Test Loss: 1.691 Test Acc: 0.472
Validation loss decreased (-0.462484 --> -0.471858).  Saving model ...
Epoch: 10 cost time: 3.2907779216766357
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.973 Vali Acc: 0.478 Test Loss: 1.973 Test Acc: 0.478
Validation loss decreased (-0.471858 --> -0.478105).  Saving model ...
Epoch: 11 cost time: 3.6158359050750732
Epoch: 11, Steps: 8 | Train Loss: 0.093 Vali Loss: 2.074 Vali Acc: 0.406 Test Loss: 2.074 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.900981903076172
Epoch: 12, Steps: 8 | Train Loss: 0.034 Vali Loss: 2.257 Vali Acc: 0.431 Test Loss: 2.257 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.386138916015625
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 2.099 Vali Acc: 0.494 Test Loss: 2.099 Test Acc: 0.494
Validation loss decreased (-0.478105 --> -0.493729).  Saving model ...
Epoch: 14 cost time: 2.9981017112731934
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.409 Vali Acc: 0.388 Test Loss: 2.409 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.524768590927124
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.911 Vali Acc: 0.519 Test Loss: 1.911 Test Acc: 0.519
Validation loss decreased (-0.493729 --> -0.518731).  Saving model ...
Epoch: 16 cost time: 3.6193435192108154
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.040 Vali Acc: 0.484 Test Loss: 2.040 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4335429668426514
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.657 Vali Acc: 0.391 Test Loss: 2.657 Test Acc: 0.391
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1547460556030273
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.024 Vali Acc: 0.503 Test Loss: 2.024 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.339468479156494
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.030 Vali Acc: 0.506 Test Loss: 2.030 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.291239023208618
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.031 Vali Acc: 0.503 Test Loss: 2.031 Test Acc: 0.503
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.3513989448547363
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.541 Test Loss: 1.917 Test Acc: 0.541
Validation loss decreased (-0.518731 --> -0.540606).  Saving model ...
Epoch: 22 cost time: 3.280538320541382
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.995 Vali Acc: 0.522 Test Loss: 1.995 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1274337768554688
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.101 Vali Acc: 0.509 Test Loss: 2.101 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.237748622894287
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.041 Vali Acc: 0.519 Test Loss: 2.041 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.223806142807007
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.936 Vali Acc: 0.534 Test Loss: 1.936 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.1311349868774414
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.035 Vali Acc: 0.522 Test Loss: 2.035 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.2082443237304688
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.094 Vali Acc: 0.525 Test Loss: 2.094 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.3695907592773438
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.908 Vali Acc: 0.547 Test Loss: 1.908 Test Acc: 0.547
Validation loss decreased (-0.540606 --> -0.546856).  Saving model ...
Epoch: 29 cost time: 3.310561180114746
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.924 Vali Acc: 0.541 Test Loss: 1.924 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4235904216766357
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.534 Test Loss: 1.982 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.4377622604370117
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.995 Vali Acc: 0.537 Test Loss: 1.995 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.3570828437805176
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.537 Test Loss: 1.975 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.2441325187683105
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.940 Vali Acc: 0.544 Test Loss: 1.940 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.0066471099853516
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.927 Vali Acc: 0.547 Test Loss: 1.927 Test Acc: 0.547
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.506767988204956
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.964 Vali Acc: 0.541 Test Loss: 1.964 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.3881583213806152
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.983 Vali Acc: 0.544 Test Loss: 1.983 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.2428221702575684
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.547 Test Loss: 1.956 Test Acc: 0.547
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.5416042804718018
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.923 Vali Acc: 0.550 Test Loss: 1.923 Test Acc: 0.550
Validation loss decreased (-0.546856 --> -0.549981).  Saving model ...
Epoch: 39 cost time: 3.1724445819854736
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.910 Vali Acc: 0.553 Test Loss: 1.910 Test Acc: 0.553
Validation loss decreased (-0.549981 --> -0.553106).  Saving model ...
Epoch: 40 cost time: 3.3145716190338135
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.544 Test Loss: 2.012 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.545821189880371
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.023 Vali Acc: 0.541 Test Loss: 2.023 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.5667471885681152
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.957 Vali Acc: 0.553 Test Loss: 1.957 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.4241738319396973
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.936 Vali Acc: 0.562 Test Loss: 1.936 Test Acc: 0.562
Validation loss decreased (-0.553106 --> -0.562481).  Saving model ...
Epoch: 44 cost time: 3.0917975902557373
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.929 Vali Acc: 0.566 Test Loss: 1.929 Test Acc: 0.566
Validation loss decreased (-0.562481 --> -0.565606).  Saving model ...
Epoch: 45 cost time: 3.4327878952026367
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.922 Vali Acc: 0.566 Test Loss: 1.922 Test Acc: 0.566
Validation loss decreased (-0.565606 --> -0.565606).  Saving model ...
Epoch: 46 cost time: 3.38991641998291
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.902 Vali Acc: 0.562 Test Loss: 1.902 Test Acc: 0.562
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.2276034355163574
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.974 Vali Acc: 0.559 Test Loss: 1.974 Test Acc: 0.559
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.0961852073669434
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.992 Vali Acc: 0.562 Test Loss: 1.992 Test Acc: 0.562
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.3073432445526123
Epoch: 49, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.951 Vali Acc: 0.562 Test Loss: 1.951 Test Acc: 0.562
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.3185503482818604
Epoch: 50, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.936 Vali Acc: 0.566 Test Loss: 1.936 Test Acc: 0.566
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.518106460571289
Epoch: 51, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.955 Vali Acc: 0.562 Test Loss: 1.955 Test Acc: 0.562
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.5638270378112793
Epoch: 52, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.958 Vali Acc: 0.569 Test Loss: 1.958 Test Acc: 0.569
Validation loss decreased (-0.565606 --> -0.568730).  Saving model ...
Epoch: 53 cost time: 3.2495405673980713
Epoch: 53, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.566 Test Loss: 1.968 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.2421443462371826
Epoch: 54, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.569 Test Loss: 1.973 Test Acc: 0.569
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.3600680828094482
Epoch: 55, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.566 Test Loss: 1.973 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.6682088375091553
Epoch: 56, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.994 Vali Acc: 0.566 Test Loss: 1.994 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.6056532859802246
Epoch: 57, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.004 Vali Acc: 0.559 Test Loss: 2.004 Test Acc: 0.559
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.3710765838623047
Epoch: 58, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.999 Vali Acc: 0.566 Test Loss: 1.999 Test Acc: 0.566
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.0539252758026123
Epoch: 59, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.945 Vali Acc: 0.569 Test Loss: 1.945 Test Acc: 0.569
Validation loss decreased (-0.568730 --> -0.568731).  Saving model ...
Epoch: 60 cost time: 3.544665813446045
Epoch: 60, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.918 Vali Acc: 0.572 Test Loss: 1.918 Test Acc: 0.572
Validation loss decreased (-0.568731 --> -0.571856).  Saving model ...
Epoch: 61 cost time: 3.5498759746551514
Epoch: 61, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.572 Test Loss: 1.956 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.589172601699829
Epoch: 62, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.986 Vali Acc: 0.575 Test Loss: 1.986 Test Acc: 0.575
Validation loss decreased (-0.571856 --> -0.574980).  Saving model ...
Epoch: 63 cost time: 3.330968141555786
Epoch: 63, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.575 Test Loss: 1.973 Test Acc: 0.575
Validation loss decreased (-0.574980 --> -0.574980).  Saving model ...
Epoch: 64 cost time: 3.3643016815185547
Epoch: 64, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.951 Vali Acc: 0.581 Test Loss: 1.951 Test Acc: 0.581
Validation loss decreased (-0.574980 --> -0.581230).  Saving model ...
Epoch: 65 cost time: 3.5546398162841797
Epoch: 65, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.954 Vali Acc: 0.578 Test Loss: 1.954 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.425236940383911
Epoch: 66, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.983 Vali Acc: 0.575 Test Loss: 1.983 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 3.2120397090911865
Epoch: 67, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.578 Test Loss: 1.967 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 3.0029404163360596
Epoch: 68, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.951 Vali Acc: 0.578 Test Loss: 1.951 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.9550158977508545
Epoch: 69, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.581 Test Loss: 1.960 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 3.17498517036438
Epoch: 70, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.965 Vali Acc: 0.578 Test Loss: 1.965 Test Acc: 0.578
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 3.190016031265259
Epoch: 71, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.575 Test Loss: 1.982 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 3.1482937335968018
Epoch: 72, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.971 Vali Acc: 0.581 Test Loss: 1.971 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 3.05941104888916
Epoch: 73, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.979 Vali Acc: 0.584 Test Loss: 1.979 Test Acc: 0.584
Validation loss decreased (-0.581230 --> -0.584355).  Saving model ...
Epoch: 74 cost time: 3.148322820663452
Epoch: 74, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.991 Vali Acc: 0.584 Test Loss: 1.991 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 3.296708822250366
Epoch: 75, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.034 Vali Acc: 0.581 Test Loss: 2.034 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 3.243990898132324
Epoch: 76, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.991 Vali Acc: 0.584 Test Loss: 1.991 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 3.4328901767730713
Epoch: 77, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.947 Vali Acc: 0.597 Test Loss: 1.947 Test Acc: 0.597
Validation loss decreased (-0.584355 --> -0.596856).  Saving model ...
Epoch: 78 cost time: 3.166607618331909
Epoch: 78, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.945 Vali Acc: 0.594 Test Loss: 1.945 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 3.192268133163452
Epoch: 79, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.948 Vali Acc: 0.594 Test Loss: 1.948 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 3.4323525428771973
Epoch: 80, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.962 Vali Acc: 0.584 Test Loss: 1.962 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 3.3900887966156006
Epoch: 81, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.986 Vali Acc: 0.581 Test Loss: 1.986 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 3.4406790733337402
Epoch: 82, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.026 Vali Acc: 0.578 Test Loss: 2.026 Test Acc: 0.578
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 3.2736945152282715
Epoch: 83, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.581 Test Loss: 2.016 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 3.4970808029174805
Epoch: 84, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.984 Vali Acc: 0.588 Test Loss: 1.984 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 3.4038424491882324
Epoch: 85, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.986 Vali Acc: 0.588 Test Loss: 1.986 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 3.4135286808013916
Epoch: 86, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.989 Vali Acc: 0.584 Test Loss: 1.989 Test Acc: 0.584
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 3.4657528400421143
Epoch: 87, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.987 Vali Acc: 0.584 Test Loss: 1.987 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.596875
model parameter : 3478024
model size : 23.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.0251991748809814
Epoch: 1, Steps: 8 | Train Loss: 2.199 Vali Loss: 2.041 Vali Acc: 0.169 Test Loss: 2.041 Test Acc: 0.169
Validation loss decreased (inf --> -0.168730).  Saving model ...
Epoch: 2 cost time: 3.3791730403900146
Epoch: 2, Steps: 8 | Train Loss: 1.854 Vali Loss: 1.856 Vali Acc: 0.375 Test Loss: 1.856 Test Acc: 0.375
Validation loss decreased (-0.168730 --> -0.374981).  Saving model ...
Epoch: 3 cost time: 3.201185464859009
Epoch: 3, Steps: 8 | Train Loss: 1.331 Vali Loss: 1.703 Vali Acc: 0.359 Test Loss: 1.703 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2244768142700195
Epoch: 4, Steps: 8 | Train Loss: 0.891 Vali Loss: 1.607 Vali Acc: 0.362 Test Loss: 1.607 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.178680658340454
Epoch: 5, Steps: 8 | Train Loss: 0.624 Vali Loss: 1.676 Vali Acc: 0.316 Test Loss: 1.676 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.351321220397949
Epoch: 6, Steps: 8 | Train Loss: 0.472 Vali Loss: 1.537 Vali Acc: 0.397 Test Loss: 1.537 Test Acc: 0.397
Validation loss decreased (-0.374981 --> -0.396860).  Saving model ...
Epoch: 7 cost time: 2.9425554275512695
Epoch: 7, Steps: 8 | Train Loss: 0.299 Vali Loss: 1.858 Vali Acc: 0.272 Test Loss: 1.858 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.110008478164673
Epoch: 8, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.585 Vali Acc: 0.344 Test Loss: 1.585 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1311044692993164
Epoch: 9, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.667 Vali Acc: 0.381 Test Loss: 1.667 Test Acc: 0.381
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.95462703704834
Epoch: 10, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.569 Vali Acc: 0.478 Test Loss: 1.569 Test Acc: 0.478
Validation loss decreased (-0.396860 --> -0.478109).  Saving model ...
Epoch: 11 cost time: 2.9955546855926514
Epoch: 11, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.970 Vali Acc: 0.353 Test Loss: 1.970 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.836418867111206
Epoch: 12, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.931 Vali Acc: 0.447 Test Loss: 1.931 Test Acc: 0.447
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.293820381164551
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.609 Vali Acc: 0.466 Test Loss: 1.609 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1290500164031982
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 2.597 Vali Acc: 0.300 Test Loss: 2.597 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.246131658554077
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.720 Vali Acc: 0.500 Test Loss: 1.720 Test Acc: 0.500
Validation loss decreased (-0.478109 --> -0.499983).  Saving model ...
Epoch: 16 cost time: 3.375532865524292
Epoch: 16, Steps: 8 | Train Loss: 0.024 Vali Loss: 3.492 Vali Acc: 0.300 Test Loss: 3.492 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.251081705093384
Epoch: 17, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.948 Vali Acc: 0.484 Test Loss: 1.948 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3788750171661377
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.251 Vali Acc: 0.388 Test Loss: 2.251 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.316920280456543
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.905 Vali Acc: 0.472 Test Loss: 1.905 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.487548351287842
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.146 Vali Acc: 0.463 Test Loss: 2.146 Test Acc: 0.463
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.4566493034362793
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.922 Vali Acc: 0.484 Test Loss: 1.922 Test Acc: 0.484
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.365523099899292
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.060 Vali Acc: 0.463 Test Loss: 2.060 Test Acc: 0.463
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.3529789447784424
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.071 Vali Acc: 0.463 Test Loss: 2.071 Test Acc: 0.463
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.1989340782165527
Epoch: 24, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.058 Vali Acc: 0.456 Test Loss: 2.058 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.5065574645996094
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.235 Vali Acc: 0.434 Test Loss: 2.235 Test Acc: 0.434
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5
model parameter : 3478024
model size : 23.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.163273334503174
Epoch: 1, Steps: 8 | Train Loss: 2.176 Vali Loss: 2.057 Vali Acc: 0.278 Test Loss: 2.057 Test Acc: 0.278
Validation loss decreased (inf --> -0.278104).  Saving model ...
Epoch: 2 cost time: 3.222839593887329
Epoch: 2, Steps: 8 | Train Loss: 1.857 Vali Loss: 1.911 Vali Acc: 0.319 Test Loss: 1.911 Test Acc: 0.319
Validation loss decreased (-0.278104 --> -0.318731).  Saving model ...
Epoch: 3 cost time: 3.5190742015838623
Epoch: 3, Steps: 8 | Train Loss: 1.321 Vali Loss: 1.772 Vali Acc: 0.359 Test Loss: 1.772 Test Acc: 0.359
Validation loss decreased (-0.318731 --> -0.359357).  Saving model ...
Epoch: 4 cost time: 3.4540605545043945
Epoch: 4, Steps: 8 | Train Loss: 0.895 Vali Loss: 1.618 Vali Acc: 0.366 Test Loss: 1.618 Test Acc: 0.366
Validation loss decreased (-0.359357 --> -0.365609).  Saving model ...
Epoch: 5 cost time: 3.1869592666625977
Epoch: 5, Steps: 8 | Train Loss: 0.622 Vali Loss: 1.542 Vali Acc: 0.378 Test Loss: 1.542 Test Acc: 0.378
Validation loss decreased (-0.365609 --> -0.378110).  Saving model ...
Epoch: 6 cost time: 3.3051915168762207
Epoch: 6, Steps: 8 | Train Loss: 0.485 Vali Loss: 1.419 Vali Acc: 0.494 Test Loss: 1.419 Test Acc: 0.494
Validation loss decreased (-0.378110 --> -0.493736).  Saving model ...
Epoch: 7 cost time: 3.326425313949585
Epoch: 7, Steps: 8 | Train Loss: 0.282 Vali Loss: 1.459 Vali Acc: 0.412 Test Loss: 1.459 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.421508550643921
Epoch: 8, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.337 Vali Acc: 0.497 Test Loss: 1.337 Test Acc: 0.497
Validation loss decreased (-0.493736 --> -0.496862).  Saving model ...
Epoch: 9 cost time: 3.271294593811035
Epoch: 9, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.450 Vali Acc: 0.500 Test Loss: 1.450 Test Acc: 0.500
Validation loss decreased (-0.496862 --> -0.499985).  Saving model ...
Epoch: 10 cost time: 3.07926607131958
Epoch: 10, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.596 Vali Acc: 0.481 Test Loss: 1.596 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.293245553970337
Epoch: 11, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.633 Vali Acc: 0.466 Test Loss: 1.633 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3594980239868164
Epoch: 12, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.659 Vali Acc: 0.481 Test Loss: 1.659 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.424207925796509
Epoch: 13, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.514 Vali Acc: 0.522 Test Loss: 1.514 Test Acc: 0.522
Validation loss decreased (-0.499985 --> -0.521860).  Saving model ...
Epoch: 14 cost time: 3.3649682998657227
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.939 Vali Acc: 0.453 Test Loss: 1.939 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1163456439971924
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.584 Vali Acc: 0.512 Test Loss: 1.584 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.568417549133301
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.879 Vali Acc: 0.459 Test Loss: 1.879 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5272412300109863
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.768 Vali Acc: 0.522 Test Loss: 1.768 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.5744423866271973
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.044 Vali Acc: 0.453 Test Loss: 2.044 Test Acc: 0.453
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.075897693634033
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.945 Vali Acc: 0.487 Test Loss: 1.945 Test Acc: 0.487
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.0560100078582764
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.169 Vali Acc: 0.453 Test Loss: 2.169 Test Acc: 0.453
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.474482774734497
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.768 Vali Acc: 0.512 Test Loss: 1.768 Test Acc: 0.512
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.466594934463501
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.878 Vali Acc: 0.537 Test Loss: 1.878 Test Acc: 0.537
Validation loss decreased (-0.521860 --> -0.537481).  Saving model ...
Epoch: 23 cost time: 3.293562173843384
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.065 Vali Acc: 0.512 Test Loss: 2.065 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0961618423461914
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.065 Vali Acc: 0.534 Test Loss: 2.065 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.116877794265747
Epoch: 25, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.920 Vali Acc: 0.553 Test Loss: 1.920 Test Acc: 0.553
Validation loss decreased (-0.537481 --> -0.553106).  Saving model ...
Epoch: 26 cost time: 3.5297677516937256
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.006 Vali Acc: 0.503 Test Loss: 2.006 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5579354763031006
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.066 Vali Acc: 0.528 Test Loss: 2.066 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.4419612884521484
Epoch: 28, Steps: 8 | Train Loss: 0.009 Vali Loss: 3.211 Vali Acc: 0.425 Test Loss: 3.211 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2683019638061523
Epoch: 29, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.982 Vali Acc: 0.516 Test Loss: 1.982 Test Acc: 0.516
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.1958038806915283
Epoch: 30, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.894 Vali Acc: 0.381 Test Loss: 2.894 Test Acc: 0.381
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.5738894939422607
Epoch: 31, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.382 Vali Acc: 0.491 Test Loss: 2.382 Test Acc: 0.491
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.6146016120910645
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.496 Vali Acc: 0.456 Test Loss: 2.496 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.3831627368927
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.699 Vali Acc: 0.434 Test Loss: 2.699 Test Acc: 0.434
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.3809139728546143
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.208 Vali Acc: 0.481 Test Loss: 2.208 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.2055776119232178
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.021 Vali Acc: 0.500 Test Loss: 2.021 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.553125
model parameter : 3478024
model size : 23.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.764642238616943
Epoch: 1, Steps: 8 | Train Loss: 2.149 Vali Loss: 2.069 Vali Acc: 0.234 Test Loss: 2.069 Test Acc: 0.234
Validation loss decreased (inf --> -0.234354).  Saving model ...
Epoch: 2 cost time: 3.071427583694458
Epoch: 2, Steps: 8 | Train Loss: 1.796 Vali Loss: 1.920 Vali Acc: 0.309 Test Loss: 1.920 Test Acc: 0.309
Validation loss decreased (-0.234354 --> -0.309356).  Saving model ...
Epoch: 3 cost time: 3.3679628372192383
Epoch: 3, Steps: 8 | Train Loss: 1.277 Vali Loss: 1.748 Vali Acc: 0.450 Test Loss: 1.748 Test Acc: 0.450
Validation loss decreased (-0.309356 --> -0.449983).  Saving model ...
Epoch: 4 cost time: 3.5310215950012207
Epoch: 4, Steps: 8 | Train Loss: 0.819 Vali Loss: 1.578 Vali Acc: 0.475 Test Loss: 1.578 Test Acc: 0.475
Validation loss decreased (-0.449983 --> -0.474984).  Saving model ...
Epoch: 5 cost time: 3.3696658611297607
Epoch: 5, Steps: 8 | Train Loss: 0.565 Vali Loss: 1.391 Vali Acc: 0.475 Test Loss: 1.391 Test Acc: 0.475
Validation loss decreased (-0.474984 --> -0.474986).  Saving model ...
Epoch: 6 cost time: 3.0659759044647217
Epoch: 6, Steps: 8 | Train Loss: 0.416 Vali Loss: 1.326 Vali Acc: 0.544 Test Loss: 1.326 Test Acc: 0.544
Validation loss decreased (-0.474986 --> -0.543737).  Saving model ...
Epoch: 7 cost time: 3.35099196434021
Epoch: 7, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.331 Vali Acc: 0.516 Test Loss: 1.331 Test Acc: 0.516
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3662705421447754
Epoch: 8, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.468 Vali Acc: 0.491 Test Loss: 1.468 Test Acc: 0.491
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9345202445983887
Epoch: 9, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.608 Vali Acc: 0.494 Test Loss: 1.608 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.422792434692383
Epoch: 10, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.848 Vali Acc: 0.472 Test Loss: 1.848 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.128286600112915
Epoch: 11, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.930 Vali Acc: 0.450 Test Loss: 1.930 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1770925521850586
Epoch: 12, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.638 Vali Acc: 0.519 Test Loss: 1.638 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.2072560787200928
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.721 Vali Acc: 0.522 Test Loss: 1.721 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.238741636276245
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.669 Vali Acc: 0.525 Test Loss: 1.669 Test Acc: 0.525
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.5168209075927734
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.889 Vali Acc: 0.522 Test Loss: 1.889 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.1494014263153076
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.985 Vali Acc: 0.516 Test Loss: 1.985 Test Acc: 0.516
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.54375
model parameter : 3478024
model size : 23.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.904071569442749
Epoch: 1, Steps: 8 | Train Loss: 2.213 Vali Loss: 2.114 Vali Acc: 0.178 Test Loss: 2.114 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 3.3028805255889893
Epoch: 2, Steps: 8 | Train Loss: 1.865 Vali Loss: 1.817 Vali Acc: 0.328 Test Loss: 1.817 Test Acc: 0.328
Validation loss decreased (-0.178104 --> -0.328107).  Saving model ...
Epoch: 3 cost time: 3.140814781188965
Epoch: 3, Steps: 8 | Train Loss: 1.333 Vali Loss: 1.533 Vali Acc: 0.453 Test Loss: 1.533 Test Acc: 0.453
Validation loss decreased (-0.328107 --> -0.453110).  Saving model ...
Epoch: 4 cost time: 3.275543212890625
Epoch: 4, Steps: 8 | Train Loss: 0.871 Vali Loss: 1.284 Vali Acc: 0.578 Test Loss: 1.284 Test Acc: 0.578
Validation loss decreased (-0.453110 --> -0.578112).  Saving model ...
Epoch: 5 cost time: 3.142335891723633
Epoch: 5, Steps: 8 | Train Loss: 0.588 Vali Loss: 1.250 Vali Acc: 0.525 Test Loss: 1.250 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.152677059173584
Epoch: 6, Steps: 8 | Train Loss: 0.417 Vali Loss: 1.325 Vali Acc: 0.522 Test Loss: 1.325 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.199605941772461
Epoch: 7, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.485 Vali Acc: 0.478 Test Loss: 1.485 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2439780235290527
Epoch: 8, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.741 Vali Acc: 0.497 Test Loss: 1.741 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1503117084503174
Epoch: 9, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.859 Vali Acc: 0.456 Test Loss: 1.859 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.2430226802825928
Epoch: 10, Steps: 8 | Train Loss: 0.081 Vali Loss: 2.190 Vali Acc: 0.456 Test Loss: 2.190 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2541558742523193
Epoch: 11, Steps: 8 | Train Loss: 0.081 Vali Loss: 2.310 Vali Acc: 0.419 Test Loss: 2.310 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.1149394512176514
Epoch: 12, Steps: 8 | Train Loss: 0.046 Vali Loss: 2.385 Vali Acc: 0.422 Test Loss: 2.385 Test Acc: 0.422
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.2099664211273193
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.670 Vali Acc: 0.441 Test Loss: 2.670 Test Acc: 0.441
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.0976152420043945
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.909 Vali Acc: 0.434 Test Loss: 2.909 Test Acc: 0.434
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.578125
model parameter : 3478024
model size : 23.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.156348943710327
Epoch: 1, Steps: 8 | Train Loss: 2.109 Vali Loss: 2.076 Vali Acc: 0.128 Test Loss: 2.076 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 2.992607593536377
Epoch: 2, Steps: 8 | Train Loss: 1.954 Vali Loss: 1.839 Vali Acc: 0.197 Test Loss: 1.839 Test Acc: 0.197
Validation loss decreased (-0.128104 --> -0.196857).  Saving model ...
Epoch: 3 cost time: 3.1190149784088135
Epoch: 3, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.531 Vali Acc: 0.416 Test Loss: 1.531 Test Acc: 0.416
Validation loss decreased (-0.196857 --> -0.415610).  Saving model ...
Epoch: 4 cost time: 3.1179966926574707
Epoch: 4, Steps: 8 | Train Loss: 0.985 Vali Loss: 1.369 Vali Acc: 0.481 Test Loss: 1.369 Test Acc: 0.481
Validation loss decreased (-0.415610 --> -0.481236).  Saving model ...
Epoch: 5 cost time: 3.181027889251709
Epoch: 5, Steps: 8 | Train Loss: 0.723 Vali Loss: 1.423 Vali Acc: 0.466 Test Loss: 1.423 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.920790195465088
Epoch: 6, Steps: 8 | Train Loss: 0.470 Vali Loss: 1.490 Vali Acc: 0.484 Test Loss: 1.490 Test Acc: 0.484
Validation loss decreased (-0.481236 --> -0.484360).  Saving model ...
Epoch: 7 cost time: 3.141957998275757
Epoch: 7, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.759 Vali Acc: 0.459 Test Loss: 1.759 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1099064350128174
Epoch: 8, Steps: 8 | Train Loss: 0.234 Vali Loss: 2.080 Vali Acc: 0.416 Test Loss: 2.080 Test Acc: 0.416
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.203310012817383
Epoch: 9, Steps: 8 | Train Loss: 0.155 Vali Loss: 2.212 Vali Acc: 0.425 Test Loss: 2.212 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1923582553863525
Epoch: 10, Steps: 8 | Train Loss: 0.102 Vali Loss: 2.345 Vali Acc: 0.444 Test Loss: 2.345 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.930415391921997
Epoch: 11, Steps: 8 | Train Loss: 0.079 Vali Loss: 2.623 Vali Acc: 0.409 Test Loss: 2.623 Test Acc: 0.409
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.486083507537842
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 2.397 Vali Acc: 0.500 Test Loss: 2.397 Test Acc: 0.500
Validation loss decreased (-0.484360 --> -0.499976).  Saving model ...
Epoch: 13 cost time: 3.3005220890045166
Epoch: 13, Steps: 8 | Train Loss: 0.060 Vali Loss: 2.987 Vali Acc: 0.444 Test Loss: 2.987 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2118170261383057
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 3.233 Vali Acc: 0.375 Test Loss: 3.233 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2347562313079834
Epoch: 15, Steps: 8 | Train Loss: 0.024 Vali Loss: 2.706 Vali Acc: 0.441 Test Loss: 2.706 Test Acc: 0.441
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2940361499786377
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 3.078 Vali Acc: 0.441 Test Loss: 3.078 Test Acc: 0.441
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.34161376953125
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 3.846 Vali Acc: 0.409 Test Loss: 3.846 Test Acc: 0.409
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.921633243560791
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 3.161 Vali Acc: 0.438 Test Loss: 3.161 Test Acc: 0.438
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.945168972015381
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 3.034 Vali Acc: 0.459 Test Loss: 3.034 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.286473512649536
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 3.537 Vali Acc: 0.425 Test Loss: 3.537 Test Acc: 0.425
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.2603096961975098
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 3.513 Vali Acc: 0.450 Test Loss: 3.513 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.1669256687164307
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 3.509 Vali Acc: 0.444 Test Loss: 3.509 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5
model parameter : 3478024
model size : 23.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.10460901260376
Epoch: 1, Steps: 8 | Train Loss: 2.092 Vali Loss: 1.755 Vali Acc: 0.453 Test Loss: 1.755 Test Acc: 0.453
Validation loss decreased (inf --> -0.453107).  Saving model ...
Epoch: 2 cost time: 3.7057180404663086
Epoch: 2, Steps: 8 | Train Loss: 1.404 Vali Loss: 1.064 Vali Acc: 0.703 Test Loss: 1.064 Test Acc: 0.703
Validation loss decreased (-0.453107 --> -0.703114).  Saving model ...
Epoch: 3 cost time: 3.3716864585876465
Epoch: 3, Steps: 8 | Train Loss: 0.722 Vali Loss: 0.783 Vali Acc: 0.738 Test Loss: 0.783 Test Acc: 0.738
Validation loss decreased (-0.703114 --> -0.737492).  Saving model ...
Epoch: 4 cost time: 3.4720969200134277
Epoch: 4, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.719 Vali Acc: 0.747 Test Loss: 0.719 Test Acc: 0.747
Validation loss decreased (-0.737492 --> -0.746868).  Saving model ...
Epoch: 5 cost time: 3.0956051349639893
Epoch: 5, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.726 Vali Acc: 0.753 Test Loss: 0.726 Test Acc: 0.753
Validation loss decreased (-0.746868 --> -0.753118).  Saving model ...
Epoch: 6 cost time: 3.5122907161712646
Epoch: 6, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.759 Vali Acc: 0.769 Test Loss: 0.759 Test Acc: 0.769
Validation loss decreased (-0.753118 --> -0.768742).  Saving model ...
Epoch: 7 cost time: 3.770392894744873
Epoch: 7, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.815 Vali Acc: 0.756 Test Loss: 0.815 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.31386399269104
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.811 Vali Acc: 0.769 Test Loss: 0.811 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3019914627075195
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.921 Vali Acc: 0.741 Test Loss: 0.921 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.594461679458618
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.913 Vali Acc: 0.772 Test Loss: 0.913 Test Acc: 0.772
Validation loss decreased (-0.768742 --> -0.771866).  Saving model ...
Epoch: 11 cost time: 3.6183271408081055
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.934 Vali Acc: 0.775 Test Loss: 0.934 Test Acc: 0.775
Validation loss decreased (-0.771866 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 3.314023733139038
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.944 Vali Acc: 0.762 Test Loss: 0.944 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2527079582214355
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.951 Vali Acc: 0.778 Test Loss: 0.951 Test Acc: 0.778
Validation loss decreased (-0.774991 --> -0.778115).  Saving model ...
Epoch: 14 cost time: 3.5607492923736572
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.943 Vali Acc: 0.778 Test Loss: 0.943 Test Acc: 0.778
Validation loss decreased (-0.778115 --> -0.778116).  Saving model ...
Epoch: 15 cost time: 3.408125400543213
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.937 Vali Acc: 0.781 Test Loss: 0.937 Test Acc: 0.781
Validation loss decreased (-0.778116 --> -0.781241).  Saving model ...
Epoch: 16 cost time: 3.557126998901367
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.784 Test Loss: 0.936 Test Acc: 0.784
Validation loss decreased (-0.781241 --> -0.784366).  Saving model ...
Epoch: 17 cost time: 3.5271012783050537
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.787 Test Loss: 0.936 Test Acc: 0.787
Validation loss decreased (-0.784366 --> -0.787491).  Saving model ...
Epoch: 18 cost time: 3.2280113697052
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.938 Vali Acc: 0.784 Test Loss: 0.938 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.328561544418335
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.937 Vali Acc: 0.784 Test Loss: 0.937 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4817724227905273
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.781 Test Loss: 0.943 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.5023887157440186
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.947 Vali Acc: 0.778 Test Loss: 0.947 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.5631277561187744
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.952 Vali Acc: 0.778 Test Loss: 0.952 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.4886138439178467
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.778 Test Loss: 0.957 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.261094570159912
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.963 Vali Acc: 0.778 Test Loss: 0.963 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.5943355560302734
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.968 Vali Acc: 0.781 Test Loss: 0.968 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.275893449783325
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.971 Vali Acc: 0.781 Test Loss: 0.971 Test Acc: 0.781
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.290364980697632
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.973 Vali Acc: 0.781 Test Loss: 0.973 Test Acc: 0.781
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7875
model parameter : 2558216
model size : 14.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.26160740852356
Epoch: 1, Steps: 8 | Train Loss: 2.044 Vali Loss: 1.795 Vali Acc: 0.438 Test Loss: 1.795 Test Acc: 0.438
Validation loss decreased (inf --> -0.437482).  Saving model ...
Epoch: 2 cost time: 2.8390910625457764
Epoch: 2, Steps: 8 | Train Loss: 1.498 Vali Loss: 1.272 Vali Acc: 0.588 Test Loss: 1.272 Test Acc: 0.588
Validation loss decreased (-0.437482 --> -0.587487).  Saving model ...
Epoch: 3 cost time: 2.9723265171051025
Epoch: 3, Steps: 8 | Train Loss: 0.848 Vali Loss: 1.035 Vali Acc: 0.666 Test Loss: 1.035 Test Acc: 0.666
Validation loss decreased (-0.587487 --> -0.665615).  Saving model ...
Epoch: 4 cost time: 3.254690170288086
Epoch: 4, Steps: 8 | Train Loss: 0.493 Vali Loss: 0.915 Vali Acc: 0.703 Test Loss: 0.915 Test Acc: 0.703
Validation loss decreased (-0.665615 --> -0.703116).  Saving model ...
Epoch: 5 cost time: 3.2368407249450684
Epoch: 5, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.928 Vali Acc: 0.697 Test Loss: 0.928 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9409096240997314
Epoch: 6, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.957 Vali Acc: 0.688 Test Loss: 0.957 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.13472843170166
Epoch: 7, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.014 Vali Acc: 0.694 Test Loss: 1.014 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.379167318344116
Epoch: 8, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.103 Vali Acc: 0.688 Test Loss: 1.103 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3349039554595947
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.168 Vali Acc: 0.681 Test Loss: 1.168 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8928186893463135
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.263 Vali Acc: 0.678 Test Loss: 1.263 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.1455235481262207
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.226 Vali Acc: 0.681 Test Loss: 1.226 Test Acc: 0.681
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.23168683052063
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.218 Vali Acc: 0.681 Test Loss: 1.218 Test Acc: 0.681
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1301379203796387
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.251 Vali Acc: 0.678 Test Loss: 1.251 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.2685482501983643
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.274 Vali Acc: 0.678 Test Loss: 1.274 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.703125
model parameter : 2558216
model size : 14.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.342425107955933
Epoch: 1, Steps: 8 | Train Loss: 2.050 Vali Loss: 1.852 Vali Acc: 0.412 Test Loss: 1.852 Test Acc: 0.412
Validation loss decreased (inf --> -0.412481).  Saving model ...
Epoch: 2 cost time: 3.2731308937072754
Epoch: 2, Steps: 8 | Train Loss: 1.595 Vali Loss: 1.399 Vali Acc: 0.550 Test Loss: 1.399 Test Acc: 0.550
Validation loss decreased (-0.412481 --> -0.549986).  Saving model ...
Epoch: 3 cost time: 2.9008126258850098
Epoch: 3, Steps: 8 | Train Loss: 0.973 Vali Loss: 1.170 Vali Acc: 0.581 Test Loss: 1.170 Test Acc: 0.581
Validation loss decreased (-0.549986 --> -0.581238).  Saving model ...
Epoch: 4 cost time: 3.145311117172241
Epoch: 4, Steps: 8 | Train Loss: 0.572 Vali Loss: 1.034 Vali Acc: 0.622 Test Loss: 1.034 Test Acc: 0.622
Validation loss decreased (-0.581238 --> -0.621865).  Saving model ...
Epoch: 5 cost time: 2.9290668964385986
Epoch: 5, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.016 Vali Acc: 0.659 Test Loss: 1.016 Test Acc: 0.659
Validation loss decreased (-0.621865 --> -0.659365).  Saving model ...
Epoch: 6 cost time: 2.909830093383789
Epoch: 6, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.031 Vali Acc: 0.666 Test Loss: 1.031 Test Acc: 0.666
Validation loss decreased (-0.659365 --> -0.665615).  Saving model ...
Epoch: 7 cost time: 2.9523749351501465
Epoch: 7, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.024 Vali Acc: 0.644 Test Loss: 1.024 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4017937183380127
Epoch: 8, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.087 Vali Acc: 0.678 Test Loss: 1.087 Test Acc: 0.678
Validation loss decreased (-0.665615 --> -0.678114).  Saving model ...
Epoch: 9 cost time: 3.2298500537872314
Epoch: 9, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.140 Vali Acc: 0.678 Test Loss: 1.140 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8356096744537354
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.268 Vali Acc: 0.644 Test Loss: 1.268 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9403820037841797
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.213 Vali Acc: 0.672 Test Loss: 1.213 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.322740077972412
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.192 Vali Acc: 0.662 Test Loss: 1.192 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4078562259674072
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.243 Vali Acc: 0.681 Test Loss: 1.243 Test Acc: 0.681
Validation loss decreased (-0.678114 --> -0.681238).  Saving model ...
Epoch: 14 cost time: 3.0301570892333984
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.247 Vali Acc: 0.675 Test Loss: 1.247 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0831809043884277
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.236 Vali Acc: 0.681 Test Loss: 1.236 Test Acc: 0.681
Validation loss decreased (-0.681238 --> -0.681238).  Saving model ...
Epoch: 16 cost time: 3.497671604156494
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.237 Vali Acc: 0.684 Test Loss: 1.237 Test Acc: 0.684
Validation loss decreased (-0.681238 --> -0.684363).  Saving model ...
Epoch: 17 cost time: 3.2620272636413574
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.257 Vali Acc: 0.681 Test Loss: 1.257 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0205492973327637
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.261 Vali Acc: 0.684 Test Loss: 1.261 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4283688068389893
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.258 Vali Acc: 0.688 Test Loss: 1.258 Test Acc: 0.688
Validation loss decreased (-0.684363 --> -0.687487).  Saving model ...
Epoch: 20 cost time: 3.4695143699645996
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.253 Vali Acc: 0.688 Test Loss: 1.253 Test Acc: 0.688
Validation loss decreased (-0.687487 --> -0.687487).  Saving model ...
Epoch: 21 cost time: 3.301130771636963
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.255 Vali Acc: 0.688 Test Loss: 1.255 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2573063373565674
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.267 Vali Acc: 0.688 Test Loss: 1.267 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7557694911956787
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.286 Vali Acc: 0.681 Test Loss: 1.286 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.4006335735321045
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.300 Vali Acc: 0.691 Test Loss: 1.300 Test Acc: 0.691
Validation loss decreased (-0.687487 --> -0.690612).  Saving model ...
Epoch: 25 cost time: 3.3637924194335938
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.303 Vali Acc: 0.691 Test Loss: 1.303 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.069263219833374
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.302 Vali Acc: 0.691 Test Loss: 1.302 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.1862573623657227
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.297 Vali Acc: 0.691 Test Loss: 1.297 Test Acc: 0.691
Validation loss decreased (-0.690612 --> -0.690612).  Saving model ...
Epoch: 28 cost time: 3.0431313514709473
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.307 Vali Acc: 0.691 Test Loss: 1.307 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.211961269378662
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.312 Vali Acc: 0.691 Test Loss: 1.312 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.112499475479126
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.314 Vali Acc: 0.691 Test Loss: 1.314 Test Acc: 0.691
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.992976665496826
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.313 Vali Acc: 0.688 Test Loss: 1.313 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.2591168880462646
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.684 Test Loss: 1.316 Test Acc: 0.684
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.037113666534424
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.691 Test Loss: 1.317 Test Acc: 0.691
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.160991668701172
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.688 Test Loss: 1.326 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.2565500736236572
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.681 Test Loss: 1.330 Test Acc: 0.681
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.3684351444244385
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.678 Test Loss: 1.332 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.2646608352661133
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.684 Test Loss: 1.328 Test Acc: 0.684
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.690625
model parameter : 2558216
model size : 14.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.194697618484497
Epoch: 1, Steps: 8 | Train Loss: 2.115 Vali Loss: 1.955 Vali Acc: 0.287 Test Loss: 1.955 Test Acc: 0.287
Validation loss decreased (inf --> -0.287480).  Saving model ...
Epoch: 2 cost time: 2.861517906188965
Epoch: 2, Steps: 8 | Train Loss: 1.792 Vali Loss: 1.616 Vali Acc: 0.478 Test Loss: 1.616 Test Acc: 0.478
Validation loss decreased (-0.287480 --> -0.478109).  Saving model ...
Epoch: 3 cost time: 2.890383720397949
Epoch: 3, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.364 Vali Acc: 0.531 Test Loss: 1.364 Test Acc: 0.531
Validation loss decreased (-0.478109 --> -0.531236).  Saving model ...
Epoch: 4 cost time: 2.9349260330200195
Epoch: 4, Steps: 8 | Train Loss: 0.822 Vali Loss: 1.162 Vali Acc: 0.575 Test Loss: 1.162 Test Acc: 0.575
Validation loss decreased (-0.531236 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 3.17132306098938
Epoch: 5, Steps: 8 | Train Loss: 0.535 Vali Loss: 1.151 Vali Acc: 0.600 Test Loss: 1.151 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 3.318425178527832
Epoch: 6, Steps: 8 | Train Loss: 0.357 Vali Loss: 1.029 Vali Acc: 0.631 Test Loss: 1.029 Test Acc: 0.631
Validation loss decreased (-0.599988 --> -0.631240).  Saving model ...
Epoch: 7 cost time: 3.314602851867676
Epoch: 7, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.121 Vali Acc: 0.606 Test Loss: 1.121 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.181128978729248
Epoch: 8, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.130 Vali Acc: 0.613 Test Loss: 1.130 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2807509899139404
Epoch: 9, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.267 Vali Acc: 0.600 Test Loss: 1.267 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1098272800445557
Epoch: 10, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.209 Vali Acc: 0.631 Test Loss: 1.209 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.144822120666504
Epoch: 11, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.269 Vali Acc: 0.634 Test Loss: 1.269 Test Acc: 0.634
Validation loss decreased (-0.631240 --> -0.634362).  Saving model ...
Epoch: 12 cost time: 2.8921384811401367
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.259 Vali Acc: 0.641 Test Loss: 1.259 Test Acc: 0.641
Validation loss decreased (-0.634362 --> -0.640612).  Saving model ...
Epoch: 13 cost time: 3.0452401638031006
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.277 Vali Acc: 0.628 Test Loss: 1.277 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9455089569091797
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.360 Vali Acc: 0.641 Test Loss: 1.360 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.94258975982666
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.384 Vali Acc: 0.634 Test Loss: 1.384 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9289608001708984
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.309 Vali Acc: 0.631 Test Loss: 1.309 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.331977367401123
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.333 Vali Acc: 0.641 Test Loss: 1.333 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.3149006366729736
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.350 Vali Acc: 0.637 Test Loss: 1.350 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.428042411804199
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.319 Vali Acc: 0.644 Test Loss: 1.319 Test Acc: 0.644
Validation loss decreased (-0.640612 --> -0.643737).  Saving model ...
Epoch: 20 cost time: 3.1872565746307373
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.320 Vali Acc: 0.656 Test Loss: 1.320 Test Acc: 0.656
Validation loss decreased (-0.643737 --> -0.656237).  Saving model ...
Epoch: 21 cost time: 3.0692152976989746
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.316 Vali Acc: 0.650 Test Loss: 1.316 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2193944454193115
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.320 Vali Acc: 0.659 Test Loss: 1.320 Test Acc: 0.659
Validation loss decreased (-0.656237 --> -0.659362).  Saving model ...
Epoch: 23 cost time: 2.964217185974121
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.332 Vali Acc: 0.650 Test Loss: 1.332 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.081486940383911
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.653 Test Loss: 1.339 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.3478517532348633
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.331 Vali Acc: 0.656 Test Loss: 1.331 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.138841152191162
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.332 Vali Acc: 0.659 Test Loss: 1.332 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.1239395141601562
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.656 Test Loss: 1.330 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.284987688064575
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.329 Vali Acc: 0.659 Test Loss: 1.329 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.2679600715637207
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.325 Vali Acc: 0.666 Test Loss: 1.325 Test Acc: 0.666
Validation loss decreased (-0.659362 --> -0.665612).  Saving model ...
Epoch: 30 cost time: 2.9586915969848633
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.327 Vali Acc: 0.666 Test Loss: 1.327 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.121652126312256
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.659 Test Loss: 1.323 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.1536974906921387
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.329 Vali Acc: 0.653 Test Loss: 1.329 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.9483394622802734
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.659 Test Loss: 1.332 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.102883815765381
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.662 Test Loss: 1.339 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.4835760593414307
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.666 Test Loss: 1.334 Test Acc: 0.666
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.913320779800415
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.331 Vali Acc: 0.662 Test Loss: 1.331 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.0946600437164307
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.666 Test Loss: 1.332 Test Acc: 0.666
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.387697696685791
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.669 Test Loss: 1.339 Test Acc: 0.669
Validation loss decreased (-0.665612 --> -0.668737).  Saving model ...
Epoch: 39 cost time: 3.08139705657959
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.669 Test Loss: 1.346 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.2230722904205322
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.666 Test Loss: 1.353 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.241190195083618
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.666 Test Loss: 1.350 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.374910593032837
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.672 Test Loss: 1.350 Test Acc: 0.672
Validation loss decreased (-0.668737 --> -0.671861).  Saving model ...
Epoch: 43 cost time: 3.1926629543304443
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.669 Test Loss: 1.357 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.481977939605713
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.672 Test Loss: 1.359 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.5590736865997314
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.672 Test Loss: 1.359 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.5218465328216553
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.362 Vali Acc: 0.669 Test Loss: 1.362 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.2706573009490967
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.672 Test Loss: 1.365 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.4221558570861816
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.669 Test Loss: 1.366 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.2597432136535645
Epoch: 49, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.669 Test Loss: 1.364 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.346278429031372
Epoch: 50, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.669 Test Loss: 1.368 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.196157217025757
Epoch: 51, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.672 Test Loss: 1.372 Test Acc: 0.672
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.4227874279022217
Epoch: 52, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.669 Test Loss: 1.372 Test Acc: 0.669
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.671875
model parameter : 2558216
model size : 14.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.681883096694946
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 2.009 Vali Acc: 0.275 Test Loss: 2.009 Test Acc: 0.275
Validation loss decreased (inf --> -0.274980).  Saving model ...
Epoch: 2 cost time: 3.2780988216400146
Epoch: 2, Steps: 8 | Train Loss: 1.882 Vali Loss: 1.825 Vali Acc: 0.319 Test Loss: 1.825 Test Acc: 0.319
Validation loss decreased (-0.274980 --> -0.318732).  Saving model ...
Epoch: 3 cost time: 2.972008228302002
Epoch: 3, Steps: 8 | Train Loss: 1.503 Vali Loss: 1.651 Vali Acc: 0.384 Test Loss: 1.651 Test Acc: 0.384
Validation loss decreased (-0.318732 --> -0.384358).  Saving model ...
Epoch: 4 cost time: 2.983246088027954
Epoch: 4, Steps: 8 | Train Loss: 1.083 Vali Loss: 1.476 Vali Acc: 0.434 Test Loss: 1.476 Test Acc: 0.434
Validation loss decreased (-0.384358 --> -0.434360).  Saving model ...
Epoch: 5 cost time: 3.368950843811035
Epoch: 5, Steps: 8 | Train Loss: 0.753 Vali Loss: 1.448 Vali Acc: 0.463 Test Loss: 1.448 Test Acc: 0.463
Validation loss decreased (-0.434360 --> -0.462486).  Saving model ...
Epoch: 6 cost time: 3.605910062789917
Epoch: 6, Steps: 8 | Train Loss: 0.556 Vali Loss: 1.370 Vali Acc: 0.500 Test Loss: 1.370 Test Acc: 0.500
Validation loss decreased (-0.462486 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 3.3162953853607178
Epoch: 7, Steps: 8 | Train Loss: 0.353 Vali Loss: 1.500 Vali Acc: 0.481 Test Loss: 1.500 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.362727165222168
Epoch: 8, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.518 Vali Acc: 0.481 Test Loss: 1.518 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.43912410736084
Epoch: 9, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.513 Vali Acc: 0.509 Test Loss: 1.513 Test Acc: 0.509
Validation loss decreased (-0.499986 --> -0.509360).  Saving model ...
Epoch: 10 cost time: 3.6051504611968994
Epoch: 10, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.627 Vali Acc: 0.466 Test Loss: 1.627 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.98256254196167
Epoch: 11, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.644 Vali Acc: 0.497 Test Loss: 1.644 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9537177085876465
Epoch: 12, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.545 Vali Acc: 0.534 Test Loss: 1.545 Test Acc: 0.534
Validation loss decreased (-0.509360 --> -0.534360).  Saving model ...
Epoch: 13 cost time: 3.0546321868896484
Epoch: 13, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.865 Vali Acc: 0.478 Test Loss: 1.865 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4762144088745117
Epoch: 14, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.621 Vali Acc: 0.534 Test Loss: 1.621 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.540659189224243
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.696 Vali Acc: 0.522 Test Loss: 1.696 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.4892001152038574
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.978 Vali Acc: 0.494 Test Loss: 1.978 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2382688522338867
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.628 Vali Acc: 0.575 Test Loss: 1.628 Test Acc: 0.575
Validation loss decreased (-0.534360 --> -0.574984).  Saving model ...
Epoch: 18 cost time: 3.3414998054504395
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.688 Vali Acc: 0.562 Test Loss: 1.688 Test Acc: 0.562
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5079617500305176
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.711 Vali Acc: 0.562 Test Loss: 1.711 Test Acc: 0.562
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2689757347106934
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.739 Vali Acc: 0.572 Test Loss: 1.739 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.926870584487915
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.606 Vali Acc: 0.594 Test Loss: 1.606 Test Acc: 0.594
Validation loss decreased (-0.574984 --> -0.593734).  Saving model ...
Epoch: 22 cost time: 3.206197500228882
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.641 Vali Acc: 0.575 Test Loss: 1.641 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2414052486419678
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.642 Vali Acc: 0.594 Test Loss: 1.642 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.878967046737671
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.659 Vali Acc: 0.603 Test Loss: 1.659 Test Acc: 0.603
Validation loss decreased (-0.593734 --> -0.603108).  Saving model ...
Epoch: 25 cost time: 2.9524312019348145
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.674 Vali Acc: 0.597 Test Loss: 1.674 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.974217414855957
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.710 Vali Acc: 0.594 Test Loss: 1.710 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.443283796310425
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.651 Vali Acc: 0.609 Test Loss: 1.651 Test Acc: 0.609
Validation loss decreased (-0.603108 --> -0.609358).  Saving model ...
Epoch: 28 cost time: 3.2016689777374268
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.654 Vali Acc: 0.606 Test Loss: 1.654 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2582592964172363
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.668 Vali Acc: 0.591 Test Loss: 1.668 Test Acc: 0.591
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.0887680053710938
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.649 Vali Acc: 0.600 Test Loss: 1.649 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.343350887298584
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.651 Vali Acc: 0.597 Test Loss: 1.651 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.9885590076446533
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.619 Test Loss: 1.628 Test Acc: 0.619
Validation loss decreased (-0.609358 --> -0.618734).  Saving model ...
Epoch: 33 cost time: 3.1347432136535645
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.632 Vali Acc: 0.619 Test Loss: 1.632 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.8407320976257324
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.638 Vali Acc: 0.622 Test Loss: 1.638 Test Acc: 0.622
Validation loss decreased (-0.618734 --> -0.621859).  Saving model ...
Epoch: 35 cost time: 2.829878091812134
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.640 Vali Acc: 0.619 Test Loss: 1.640 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.2133662700653076
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.649 Vali Acc: 0.625 Test Loss: 1.649 Test Acc: 0.625
Validation loss decreased (-0.621859 --> -0.624984).  Saving model ...
Epoch: 37 cost time: 2.844588279724121
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.694 Vali Acc: 0.594 Test Loss: 1.694 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.073500871658325
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.683 Vali Acc: 0.600 Test Loss: 1.683 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.2909748554229736
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.670 Vali Acc: 0.619 Test Loss: 1.670 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.9854187965393066
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.676 Vali Acc: 0.622 Test Loss: 1.676 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.221588134765625
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.678 Vali Acc: 0.619 Test Loss: 1.678 Test Acc: 0.619
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.1768221855163574
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.667 Vali Acc: 0.625 Test Loss: 1.667 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.989177942276001
Epoch: 43, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.666 Vali Acc: 0.622 Test Loss: 1.666 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.1576623916625977
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.668 Vali Acc: 0.628 Test Loss: 1.668 Test Acc: 0.628
Validation loss decreased (-0.624984 --> -0.628108).  Saving model ...
Epoch: 45 cost time: 3.094337224960327
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.672 Vali Acc: 0.622 Test Loss: 1.672 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.144367218017578
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.678 Vali Acc: 0.625 Test Loss: 1.678 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.199970245361328
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.680 Vali Acc: 0.625 Test Loss: 1.680 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.1297788619995117
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.625 Test Loss: 1.691 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.0358903408050537
Epoch: 49, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.686 Vali Acc: 0.625 Test Loss: 1.686 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.238018751144409
Epoch: 50, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.628 Test Loss: 1.685 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.254786968231201
Epoch: 51, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.680 Vali Acc: 0.641 Test Loss: 1.680 Test Acc: 0.641
Validation loss decreased (-0.628108 --> -0.640608).  Saving model ...
Epoch: 52 cost time: 3.411860227584839
Epoch: 52, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.664 Vali Acc: 0.644 Test Loss: 1.664 Test Acc: 0.644
Validation loss decreased (-0.640608 --> -0.643733).  Saving model ...
Epoch: 53 cost time: 3.2306764125823975
Epoch: 53, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.647 Test Loss: 1.669 Test Acc: 0.647
Validation loss decreased (-0.643733 --> -0.646858).  Saving model ...
Epoch: 54 cost time: 3.181119441986084
Epoch: 54, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.634 Test Loss: 1.691 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.1262292861938477
Epoch: 55, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.679 Vali Acc: 0.644 Test Loss: 1.679 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.1831283569335938
Epoch: 56, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.683 Vali Acc: 0.641 Test Loss: 1.683 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.069939613342285
Epoch: 57, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.719 Vali Acc: 0.631 Test Loss: 1.719 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.283874034881592
Epoch: 58, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.631 Test Loss: 1.717 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.3217365741729736
Epoch: 59, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.701 Vali Acc: 0.644 Test Loss: 1.701 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.263498067855835
Epoch: 60, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.692 Vali Acc: 0.644 Test Loss: 1.692 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 3.361341714859009
Epoch: 61, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.644 Test Loss: 1.706 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 3.182158946990967
Epoch: 62, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.641 Test Loss: 1.697 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 3.0442521572113037
Epoch: 63, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.647 Test Loss: 1.696 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.646875
model parameter : 2558216
model size : 14.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.796777248382568
Epoch: 1, Steps: 8 | Train Loss: 2.125 Vali Loss: 2.067 Vali Acc: 0.166 Test Loss: 2.067 Test Acc: 0.166
Validation loss decreased (inf --> -0.165604).  Saving model ...
Epoch: 2 cost time: 2.997377634048462
Epoch: 2, Steps: 8 | Train Loss: 1.960 Vali Loss: 1.961 Vali Acc: 0.203 Test Loss: 1.961 Test Acc: 0.203
Validation loss decreased (-0.165604 --> -0.203105).  Saving model ...
Epoch: 3 cost time: 3.1424832344055176
Epoch: 3, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.820 Vali Acc: 0.338 Test Loss: 1.820 Test Acc: 0.338
Validation loss decreased (-0.203105 --> -0.337482).  Saving model ...
Epoch: 4 cost time: 2.8475325107574463
Epoch: 4, Steps: 8 | Train Loss: 1.286 Vali Loss: 1.690 Vali Acc: 0.369 Test Loss: 1.690 Test Acc: 0.369
Validation loss decreased (-0.337482 --> -0.368733).  Saving model ...
Epoch: 5 cost time: 2.9921953678131104
Epoch: 5, Steps: 8 | Train Loss: 0.968 Vali Loss: 1.633 Vali Acc: 0.362 Test Loss: 1.633 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2445337772369385
Epoch: 6, Steps: 8 | Train Loss: 0.728 Vali Loss: 1.516 Vali Acc: 0.397 Test Loss: 1.516 Test Acc: 0.397
Validation loss decreased (-0.368733 --> -0.396860).  Saving model ...
Epoch: 7 cost time: 3.074352502822876
Epoch: 7, Steps: 8 | Train Loss: 0.502 Vali Loss: 1.648 Vali Acc: 0.356 Test Loss: 1.648 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5840983390808105
Epoch: 8, Steps: 8 | Train Loss: 0.429 Vali Loss: 1.543 Vali Acc: 0.400 Test Loss: 1.543 Test Acc: 0.400
Validation loss decreased (-0.396860 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 3.1218748092651367
Epoch: 9, Steps: 8 | Train Loss: 0.294 Vali Loss: 1.906 Vali Acc: 0.272 Test Loss: 1.906 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9568161964416504
Epoch: 10, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.609 Vali Acc: 0.366 Test Loss: 1.609 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.149271011352539
Epoch: 11, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.796 Vali Acc: 0.325 Test Loss: 1.796 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.376878261566162
Epoch: 12, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.743 Vali Acc: 0.381 Test Loss: 1.743 Test Acc: 0.381
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.900416612625122
Epoch: 13, Steps: 8 | Train Loss: 0.099 Vali Loss: 2.074 Vali Acc: 0.366 Test Loss: 2.074 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7196991443634033
Epoch: 14, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.541 Vali Acc: 0.494 Test Loss: 1.541 Test Acc: 0.494
Validation loss decreased (-0.399985 --> -0.493735).  Saving model ...
Epoch: 15 cost time: 3.2279911041259766
Epoch: 15, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.924 Vali Acc: 0.391 Test Loss: 1.924 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.207516670227051
Epoch: 16, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.915 Vali Acc: 0.425 Test Loss: 1.915 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4687163829803467
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.772 Vali Acc: 0.463 Test Loss: 1.772 Test Acc: 0.463
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1498587131500244
Epoch: 18, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.774 Vali Acc: 0.497 Test Loss: 1.774 Test Acc: 0.497
Validation loss decreased (-0.493735 --> -0.496857).  Saving model ...
Epoch: 19 cost time: 3.1322531700134277
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.790 Vali Acc: 0.466 Test Loss: 1.790 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.038147211074829
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.795 Vali Acc: 0.491 Test Loss: 1.795 Test Acc: 0.491
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.99769926071167
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.732 Vali Acc: 0.522 Test Loss: 1.732 Test Acc: 0.522
Validation loss decreased (-0.496857 --> -0.521858).  Saving model ...
Epoch: 22 cost time: 3.1551120281219482
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.132 Vali Acc: 0.425 Test Loss: 2.132 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.966251850128174
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.735 Vali Acc: 0.519 Test Loss: 1.735 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.219876527786255
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.938 Vali Acc: 0.478 Test Loss: 1.938 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1851954460144043
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.896 Vali Acc: 0.506 Test Loss: 1.896 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.226816177368164
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.801 Vali Acc: 0.528 Test Loss: 1.801 Test Acc: 0.528
Validation loss decreased (-0.521858 --> -0.528107).  Saving model ...
Epoch: 27 cost time: 3.149714231491089
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.719 Vali Acc: 0.553 Test Loss: 1.719 Test Acc: 0.553
Validation loss decreased (-0.528107 --> -0.553108).  Saving model ...
Epoch: 28 cost time: 3.1441798210144043
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.811 Vali Acc: 0.559 Test Loss: 1.811 Test Acc: 0.559
Validation loss decreased (-0.553108 --> -0.559357).  Saving model ...
Epoch: 29 cost time: 3.2715890407562256
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.851 Vali Acc: 0.544 Test Loss: 1.851 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.283849000930786
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.798 Vali Acc: 0.556 Test Loss: 1.798 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.2224321365356445
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.829 Vali Acc: 0.522 Test Loss: 1.829 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.2690603733062744
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.805 Vali Acc: 0.537 Test Loss: 1.805 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.3502070903778076
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.572 Test Loss: 1.724 Test Acc: 0.572
Validation loss decreased (-0.559357 --> -0.571858).  Saving model ...
Epoch: 34 cost time: 3.1345298290252686
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.792 Vali Acc: 0.562 Test Loss: 1.792 Test Acc: 0.562
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.003866195678711
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.806 Vali Acc: 0.559 Test Loss: 1.806 Test Acc: 0.559
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.2210235595703125
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.791 Vali Acc: 0.559 Test Loss: 1.791 Test Acc: 0.559
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.968541383743286
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.790 Vali Acc: 0.559 Test Loss: 1.790 Test Acc: 0.559
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.8362691402435303
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.803 Vali Acc: 0.553 Test Loss: 1.803 Test Acc: 0.553
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.1552200317382812
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.884 Vali Acc: 0.547 Test Loss: 1.884 Test Acc: 0.547
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.1573095321655273
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.896 Vali Acc: 0.556 Test Loss: 1.896 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.483941078186035
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.878 Vali Acc: 0.556 Test Loss: 1.878 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.175942897796631
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.798 Vali Acc: 0.572 Test Loss: 1.798 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.1296603679656982
Epoch: 43, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.740 Vali Acc: 0.569 Test Loss: 1.740 Test Acc: 0.569
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.571875
model parameter : 2558216
model size : 14.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.633520603179932
Epoch: 1, Steps: 8 | Train Loss: 2.162 Vali Loss: 2.096 Vali Acc: 0.138 Test Loss: 2.096 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 3.2350802421569824
Epoch: 2, Steps: 8 | Train Loss: 1.973 Vali Loss: 2.010 Vali Acc: 0.212 Test Loss: 2.010 Test Acc: 0.212
Validation loss decreased (-0.137479 --> -0.212480).  Saving model ...
Epoch: 3 cost time: 2.89994740486145
Epoch: 3, Steps: 8 | Train Loss: 1.681 Vali Loss: 1.903 Vali Acc: 0.281 Test Loss: 1.903 Test Acc: 0.281
Validation loss decreased (-0.212480 --> -0.281231).  Saving model ...
Epoch: 4 cost time: 3.365576982498169
Epoch: 4, Steps: 8 | Train Loss: 1.355 Vali Loss: 1.784 Vali Acc: 0.431 Test Loss: 1.784 Test Acc: 0.431
Validation loss decreased (-0.281231 --> -0.431232).  Saving model ...
Epoch: 5 cost time: 3.056128740310669
Epoch: 5, Steps: 8 | Train Loss: 1.003 Vali Loss: 1.728 Vali Acc: 0.334 Test Loss: 1.728 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.08813738822937
Epoch: 6, Steps: 8 | Train Loss: 0.768 Vali Loss: 1.592 Vali Acc: 0.416 Test Loss: 1.592 Test Acc: 0.416
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0115087032318115
Epoch: 7, Steps: 8 | Train Loss: 0.517 Vali Loss: 1.664 Vali Acc: 0.356 Test Loss: 1.664 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9114906787872314
Epoch: 8, Steps: 8 | Train Loss: 0.430 Vali Loss: 1.499 Vali Acc: 0.438 Test Loss: 1.499 Test Acc: 0.438
Validation loss decreased (-0.431232 --> -0.437485).  Saving model ...
Epoch: 9 cost time: 3.0215797424316406
Epoch: 9, Steps: 8 | Train Loss: 0.310 Vali Loss: 1.738 Vali Acc: 0.306 Test Loss: 1.738 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1185953617095947
Epoch: 10, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.462 Vali Acc: 0.431 Test Loss: 1.462 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1376707553863525
Epoch: 11, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.478 Vali Acc: 0.416 Test Loss: 1.478 Test Acc: 0.416
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0886154174804688
Epoch: 12, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.585 Vali Acc: 0.388 Test Loss: 1.585 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.5282723903656006
Epoch: 13, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.675 Vali Acc: 0.450 Test Loss: 1.675 Test Acc: 0.450
Validation loss decreased (-0.437485 --> -0.449983).  Saving model ...
Epoch: 14 cost time: 3.31587815284729
Epoch: 14, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.465 Vali Acc: 0.444 Test Loss: 1.465 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.39656138420105
Epoch: 15, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.873 Vali Acc: 0.400 Test Loss: 1.873 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3882226943969727
Epoch: 16, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.605 Vali Acc: 0.541 Test Loss: 1.605 Test Acc: 0.541
Validation loss decreased (-0.449983 --> -0.540609).  Saving model ...
Epoch: 17 cost time: 3.149899482727051
Epoch: 17, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.764 Vali Acc: 0.456 Test Loss: 1.764 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.917980909347534
Epoch: 18, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.605 Vali Acc: 0.487 Test Loss: 1.605 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.012970447540283
Epoch: 19, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.502 Vali Acc: 0.522 Test Loss: 1.502 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.2941548824310303
Epoch: 20, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.063 Vali Acc: 0.422 Test Loss: 2.063 Test Acc: 0.422
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.0175538063049316
Epoch: 21, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.801 Vali Acc: 0.472 Test Loss: 1.801 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.0124850273132324
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.314 Vali Acc: 0.419 Test Loss: 2.314 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.376483917236328
Epoch: 23, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.835 Vali Acc: 0.491 Test Loss: 1.835 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.40909481048584
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.776 Vali Acc: 0.522 Test Loss: 1.776 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.0574076175689697
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.915 Vali Acc: 0.491 Test Loss: 1.915 Test Acc: 0.491
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.307640790939331
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.033 Vali Acc: 0.487 Test Loss: 2.033 Test Acc: 0.487
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.540625
model parameter : 2558216
model size : 14.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.8480002880096436
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 2.114 Vali Acc: 0.116 Test Loss: 2.114 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 2.989452600479126
Epoch: 2, Steps: 8 | Train Loss: 1.952 Vali Loss: 2.021 Vali Acc: 0.206 Test Loss: 2.021 Test Acc: 0.206
Validation loss decreased (-0.115604 --> -0.206230).  Saving model ...
Epoch: 3 cost time: 2.9420740604400635
Epoch: 3, Steps: 8 | Train Loss: 1.683 Vali Loss: 1.929 Vali Acc: 0.272 Test Loss: 1.929 Test Acc: 0.272
Validation loss decreased (-0.206230 --> -0.271856).  Saving model ...
Epoch: 4 cost time: 2.883702278137207
Epoch: 4, Steps: 8 | Train Loss: 1.292 Vali Loss: 1.803 Vali Acc: 0.312 Test Loss: 1.803 Test Acc: 0.312
Validation loss decreased (-0.271856 --> -0.312482).  Saving model ...
Epoch: 5 cost time: 3.0226709842681885
Epoch: 5, Steps: 8 | Train Loss: 0.908 Vali Loss: 1.759 Vali Acc: 0.291 Test Loss: 1.759 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.134655237197876
Epoch: 6, Steps: 8 | Train Loss: 0.726 Vali Loss: 1.615 Vali Acc: 0.388 Test Loss: 1.615 Test Acc: 0.388
Validation loss decreased (-0.312482 --> -0.387484).  Saving model ...
Epoch: 7 cost time: 3.5538065433502197
Epoch: 7, Steps: 8 | Train Loss: 0.473 Vali Loss: 1.541 Vali Acc: 0.403 Test Loss: 1.541 Test Acc: 0.403
Validation loss decreased (-0.387484 --> -0.403110).  Saving model ...
Epoch: 8 cost time: 3.050560235977173
Epoch: 8, Steps: 8 | Train Loss: 0.379 Vali Loss: 1.427 Vali Acc: 0.484 Test Loss: 1.427 Test Acc: 0.484
Validation loss decreased (-0.403110 --> -0.484361).  Saving model ...
Epoch: 9 cost time: 3.0401196479797363
Epoch: 9, Steps: 8 | Train Loss: 0.297 Vali Loss: 1.436 Vali Acc: 0.425 Test Loss: 1.436 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.072465419769287
Epoch: 10, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.363 Vali Acc: 0.450 Test Loss: 1.363 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9280872344970703
Epoch: 11, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.332 Vali Acc: 0.534 Test Loss: 1.332 Test Acc: 0.534
Validation loss decreased (-0.484361 --> -0.534362).  Saving model ...
Epoch: 12 cost time: 3.04183292388916
Epoch: 12, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.564 Vali Acc: 0.419 Test Loss: 1.564 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8896477222442627
Epoch: 13, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.529 Vali Acc: 0.475 Test Loss: 1.529 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4511117935180664
Epoch: 14, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.502 Vali Acc: 0.500 Test Loss: 1.502 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.311541795730591
Epoch: 15, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.558 Vali Acc: 0.509 Test Loss: 1.558 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.771397352218628
Epoch: 16, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.604 Vali Acc: 0.519 Test Loss: 1.604 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.161506175994873
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.552 Vali Acc: 0.534 Test Loss: 1.552 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9542574882507324
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.777 Vali Acc: 0.506 Test Loss: 1.777 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.091033458709717
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.559 Vali Acc: 0.581 Test Loss: 1.559 Test Acc: 0.581
Validation loss decreased (-0.534362 --> -0.581234).  Saving model ...
Epoch: 20 cost time: 2.993140459060669
Epoch: 20, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.820 Vali Acc: 0.516 Test Loss: 1.820 Test Acc: 0.516
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0748918056488037
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.894 Vali Acc: 0.466 Test Loss: 1.894 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.053128957748413
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.886 Vali Acc: 0.506 Test Loss: 1.886 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.4956884384155273
Epoch: 23, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.690 Vali Acc: 0.553 Test Loss: 1.690 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.2080087661743164
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.818 Vali Acc: 0.528 Test Loss: 1.818 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.2177653312683105
Epoch: 25, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.760 Vali Acc: 0.528 Test Loss: 1.760 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.5566864013671875
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.815 Vali Acc: 0.519 Test Loss: 1.815 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.1032028198242188
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.969 Vali Acc: 0.531 Test Loss: 1.969 Test Acc: 0.531
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.096221446990967
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.106 Vali Acc: 0.522 Test Loss: 2.106 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.963395833969116
Epoch: 29, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.992 Vali Acc: 0.516 Test Loss: 1.992 Test Acc: 0.516
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.58125
model parameter : 2558216
model size : 14.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.925203323364258
Epoch: 1, Steps: 8 | Train Loss: 2.127 Vali Loss: 2.207 Vali Acc: 0.125 Test Loss: 2.207 Test Acc: 0.125
Validation loss decreased (inf --> -0.124978).  Saving model ...
Epoch: 2 cost time: 3.130793571472168
Epoch: 2, Steps: 8 | Train Loss: 1.962 Vali Loss: 2.050 Vali Acc: 0.125 Test Loss: 2.050 Test Acc: 0.125
Validation loss decreased (-0.124978 --> -0.124980).  Saving model ...
Epoch: 3 cost time: 3.048175573348999
Epoch: 3, Steps: 8 | Train Loss: 1.751 Vali Loss: 1.909 Vali Acc: 0.191 Test Loss: 1.909 Test Acc: 0.191
Validation loss decreased (-0.124980 --> -0.190606).  Saving model ...
Epoch: 4 cost time: 3.1567506790161133
Epoch: 4, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.704 Vali Acc: 0.322 Test Loss: 1.704 Test Acc: 0.322
Validation loss decreased (-0.190606 --> -0.321858).  Saving model ...
Epoch: 5 cost time: 3.1187212467193604
Epoch: 5, Steps: 8 | Train Loss: 1.025 Vali Loss: 1.502 Vali Acc: 0.406 Test Loss: 1.502 Test Acc: 0.406
Validation loss decreased (-0.321858 --> -0.406235).  Saving model ...
Epoch: 6 cost time: 3.077446699142456
Epoch: 6, Steps: 8 | Train Loss: 0.778 Vali Loss: 1.362 Vali Acc: 0.481 Test Loss: 1.362 Test Acc: 0.481
Validation loss decreased (-0.406235 --> -0.481236).  Saving model ...
Epoch: 7 cost time: 3.1397786140441895
Epoch: 7, Steps: 8 | Train Loss: 0.575 Vali Loss: 1.292 Vali Acc: 0.519 Test Loss: 1.292 Test Acc: 0.519
Validation loss decreased (-0.481236 --> -0.518737).  Saving model ...
Epoch: 8 cost time: 3.113821029663086
Epoch: 8, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.336 Vali Acc: 0.509 Test Loss: 1.336 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6815075874328613
Epoch: 9, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.436 Vali Acc: 0.500 Test Loss: 1.436 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.107109546661377
Epoch: 10, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.592 Vali Acc: 0.475 Test Loss: 1.592 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.1394248008728027
Epoch: 11, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.554 Vali Acc: 0.512 Test Loss: 1.554 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1927456855773926
Epoch: 12, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.745 Vali Acc: 0.441 Test Loss: 1.745 Test Acc: 0.441
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.060227870941162
Epoch: 13, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.899 Vali Acc: 0.441 Test Loss: 1.899 Test Acc: 0.441
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.09169340133667
Epoch: 14, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.971 Vali Acc: 0.475 Test Loss: 1.971 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.842244863510132
Epoch: 15, Steps: 8 | Train Loss: 0.071 Vali Loss: 2.077 Vali Acc: 0.463 Test Loss: 2.077 Test Acc: 0.463
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.069551467895508
Epoch: 16, Steps: 8 | Train Loss: 0.044 Vali Loss: 2.180 Vali Acc: 0.459 Test Loss: 2.180 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.1189873218536377
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 2.243 Vali Acc: 0.425 Test Loss: 2.243 Test Acc: 0.425
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.51875
model parameter : 2558216
model size : 14.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.382225751876831
Epoch: 1, Steps: 8 | Train Loss: 2.193 Vali Loss: 2.086 Vali Acc: 0.109 Test Loss: 2.086 Test Acc: 0.109
Validation loss decreased (inf --> -0.109354).  Saving model ...
Epoch: 2 cost time: 3.1458356380462646
Epoch: 2, Steps: 8 | Train Loss: 2.028 Vali Loss: 1.963 Vali Acc: 0.175 Test Loss: 1.963 Test Acc: 0.175
Validation loss decreased (-0.109354 --> -0.174980).  Saving model ...
Epoch: 3 cost time: 3.339660167694092
Epoch: 3, Steps: 8 | Train Loss: 1.732 Vali Loss: 1.755 Vali Acc: 0.431 Test Loss: 1.755 Test Acc: 0.431
Validation loss decreased (-0.174980 --> -0.431232).  Saving model ...
Epoch: 4 cost time: 2.970010757446289
Epoch: 4, Steps: 8 | Train Loss: 1.466 Vali Loss: 1.564 Vali Acc: 0.497 Test Loss: 1.564 Test Acc: 0.497
Validation loss decreased (-0.431232 --> -0.496859).  Saving model ...
Epoch: 5 cost time: 2.8344006538391113
Epoch: 5, Steps: 8 | Train Loss: 1.138 Vali Loss: 1.407 Vali Acc: 0.550 Test Loss: 1.407 Test Acc: 0.550
Validation loss decreased (-0.496859 --> -0.549986).  Saving model ...
Epoch: 6 cost time: 3.021286725997925
Epoch: 6, Steps: 8 | Train Loss: 0.888 Vali Loss: 1.358 Vali Acc: 0.500 Test Loss: 1.358 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0796091556549072
Epoch: 7, Steps: 8 | Train Loss: 0.607 Vali Loss: 1.369 Vali Acc: 0.469 Test Loss: 1.369 Test Acc: 0.469
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.919039726257324
Epoch: 8, Steps: 8 | Train Loss: 0.489 Vali Loss: 1.504 Vali Acc: 0.469 Test Loss: 1.504 Test Acc: 0.469
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.169586658477783
Epoch: 9, Steps: 8 | Train Loss: 0.382 Vali Loss: 1.760 Vali Acc: 0.469 Test Loss: 1.760 Test Acc: 0.469
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.406201124191284
Epoch: 10, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.721 Vali Acc: 0.472 Test Loss: 1.721 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2522878646850586
Epoch: 11, Steps: 8 | Train Loss: 0.254 Vali Loss: 1.810 Vali Acc: 0.481 Test Loss: 1.810 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.246490001678467
Epoch: 12, Steps: 8 | Train Loss: 0.165 Vali Loss: 2.132 Vali Acc: 0.450 Test Loss: 2.132 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.163951873779297
Epoch: 13, Steps: 8 | Train Loss: 0.180 Vali Loss: 2.104 Vali Acc: 0.431 Test Loss: 2.104 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.1418657302856445
Epoch: 14, Steps: 8 | Train Loss: 0.107 Vali Loss: 2.317 Vali Acc: 0.406 Test Loss: 2.317 Test Acc: 0.406
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.335012197494507
Epoch: 15, Steps: 8 | Train Loss: 0.101 Vali Loss: 2.305 Vali Acc: 0.425 Test Loss: 2.305 Test Acc: 0.425
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.55
model parameter : 2558216
model size : 14.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.059180021286011
Epoch: 1, Steps: 8 | Train Loss: 2.074 Vali Loss: 1.806 Vali Acc: 0.428 Test Loss: 1.806 Test Acc: 0.428
Validation loss decreased (inf --> -0.428107).  Saving model ...
Epoch: 2 cost time: 3.291825771331787
Epoch: 2, Steps: 8 | Train Loss: 1.453 Vali Loss: 1.101 Vali Acc: 0.709 Test Loss: 1.101 Test Acc: 0.709
Validation loss decreased (-0.428107 --> -0.709364).  Saving model ...
Epoch: 3 cost time: 3.2985448837280273
Epoch: 3, Steps: 8 | Train Loss: 0.828 Vali Loss: 0.791 Vali Acc: 0.762 Test Loss: 0.791 Test Acc: 0.762
Validation loss decreased (-0.709364 --> -0.762492).  Saving model ...
Epoch: 4 cost time: 3.1518149375915527
Epoch: 4, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.747 Vali Acc: 0.750 Test Loss: 0.747 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3811299800872803
Epoch: 5, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.752 Vali Acc: 0.769 Test Loss: 0.752 Test Acc: 0.769
Validation loss decreased (-0.762492 --> -0.768742).  Saving model ...
Epoch: 6 cost time: 2.7030837535858154
Epoch: 6, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.805 Vali Acc: 0.753 Test Loss: 0.805 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.138103723526001
Epoch: 7, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.829 Vali Acc: 0.775 Test Loss: 0.829 Test Acc: 0.775
Validation loss decreased (-0.768742 --> -0.774992).  Saving model ...
Epoch: 8 cost time: 2.8535244464874268
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.871 Vali Acc: 0.750 Test Loss: 0.871 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0491106510162354
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.931 Vali Acc: 0.787 Test Loss: 0.931 Test Acc: 0.787
Validation loss decreased (-0.774992 --> -0.787491).  Saving model ...
Epoch: 10 cost time: 2.899512767791748
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.941 Vali Acc: 0.781 Test Loss: 0.941 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3809654712677
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.942 Vali Acc: 0.769 Test Loss: 0.942 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1472156047821045
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.947 Vali Acc: 0.769 Test Loss: 0.947 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.29445743560791
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.949 Vali Acc: 0.769 Test Loss: 0.949 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.7073769569396973
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.958 Vali Acc: 0.772 Test Loss: 0.958 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.175851345062256
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.974 Vali Acc: 0.769 Test Loss: 0.974 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2518882751464844
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.982 Vali Acc: 0.778 Test Loss: 0.982 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.1985714435577393
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.986 Vali Acc: 0.791 Test Loss: 0.986 Test Acc: 0.791
Validation loss decreased (-0.787491 --> -0.790615).  Saving model ...
Epoch: 18 cost time: 3.110405445098877
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.987 Vali Acc: 0.791 Test Loss: 0.987 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1616413593292236
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.987 Vali Acc: 0.787 Test Loss: 0.987 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4325497150421143
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.982 Vali Acc: 0.787 Test Loss: 0.982 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2404966354370117
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.787 Test Loss: 0.984 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.183692693710327
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.989 Vali Acc: 0.787 Test Loss: 0.989 Test Acc: 0.787
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.468994617462158
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.781 Test Loss: 0.995 Test Acc: 0.781
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.1719510555267334
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.781 Test Loss: 1.000 Test Acc: 0.781
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.270643949508667
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.781 Test Loss: 1.007 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.0859498977661133
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.016 Vali Acc: 0.784 Test Loss: 1.016 Test Acc: 0.784
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.6278982162475586
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.787 Test Loss: 1.017 Test Acc: 0.787
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.790625
model parameter : 1771784
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.931846857070923
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 1.884 Vali Acc: 0.353 Test Loss: 1.884 Test Acc: 0.353
Validation loss decreased (inf --> -0.353106).  Saving model ...
Epoch: 2 cost time: 2.7255187034606934
Epoch: 2, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.316 Vali Acc: 0.584 Test Loss: 1.316 Test Acc: 0.584
Validation loss decreased (-0.353106 --> -0.584362).  Saving model ...
Epoch: 3 cost time: 3.076824903488159
Epoch: 3, Steps: 8 | Train Loss: 0.963 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
Validation loss decreased (-0.584362 --> -0.674990).  Saving model ...
Epoch: 4 cost time: 3.0583693981170654
Epoch: 4, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.990 Vali Acc: 0.697 Test Loss: 0.990 Test Acc: 0.697
Validation loss decreased (-0.674990 --> -0.696865).  Saving model ...
Epoch: 5 cost time: 3.087648391723633
Epoch: 5, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.956 Vali Acc: 0.678 Test Loss: 0.956 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.904158592224121
Epoch: 6, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.985 Vali Acc: 0.681 Test Loss: 0.985 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8627400398254395
Epoch: 7, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.150 Vali Acc: 0.653 Test Loss: 1.150 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.858466863632202
Epoch: 8, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.125 Vali Acc: 0.681 Test Loss: 1.125 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2683472633361816
Epoch: 9, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.200 Vali Acc: 0.672 Test Loss: 1.200 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.171922206878662
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.267 Vali Acc: 0.659 Test Loss: 1.267 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.066359758377075
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.295 Vali Acc: 0.678 Test Loss: 1.295 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.936835527420044
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.336 Vali Acc: 0.669 Test Loss: 1.336 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1259942054748535
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.331 Vali Acc: 0.672 Test Loss: 1.331 Test Acc: 0.672
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8807015419006348
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.331 Vali Acc: 0.678 Test Loss: 1.331 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.696875
model parameter : 1771784
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.858779668807983
Epoch: 1, Steps: 8 | Train Loss: 2.123 Vali Loss: 1.946 Vali Acc: 0.269 Test Loss: 1.946 Test Acc: 0.269
Validation loss decreased (inf --> -0.268731).  Saving model ...
Epoch: 2 cost time: 3.075960397720337
Epoch: 2, Steps: 8 | Train Loss: 1.666 Vali Loss: 1.466 Vali Acc: 0.531 Test Loss: 1.466 Test Acc: 0.531
Validation loss decreased (-0.268731 --> -0.531235).  Saving model ...
Epoch: 3 cost time: 3.3292617797851562
Epoch: 3, Steps: 8 | Train Loss: 1.086 Vali Loss: 1.159 Vali Acc: 0.613 Test Loss: 1.159 Test Acc: 0.613
Validation loss decreased (-0.531235 --> -0.612488).  Saving model ...
Epoch: 4 cost time: 3.2237355709075928
Epoch: 4, Steps: 8 | Train Loss: 0.657 Vali Loss: 1.065 Vali Acc: 0.619 Test Loss: 1.065 Test Acc: 0.619
Validation loss decreased (-0.612488 --> -0.618739).  Saving model ...
Epoch: 5 cost time: 3.466928005218506
Epoch: 5, Steps: 8 | Train Loss: 0.461 Vali Loss: 1.027 Vali Acc: 0.634 Test Loss: 1.027 Test Acc: 0.634
Validation loss decreased (-0.618739 --> -0.634365).  Saving model ...
Epoch: 6 cost time: 3.210252046585083
Epoch: 6, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.069 Vali Acc: 0.619 Test Loss: 1.069 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.366114377975464
Epoch: 7, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.218 Vali Acc: 0.628 Test Loss: 1.218 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2492525577545166
Epoch: 8, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.143 Vali Acc: 0.625 Test Loss: 1.143 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.260530710220337
Epoch: 9, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.244 Vali Acc: 0.619 Test Loss: 1.244 Test Acc: 0.619
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2597460746765137
Epoch: 10, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.308 Vali Acc: 0.637 Test Loss: 1.308 Test Acc: 0.637
Validation loss decreased (-0.634365 --> -0.637487).  Saving model ...
Epoch: 11 cost time: 3.3329062461853027
Epoch: 11, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.422 Vali Acc: 0.619 Test Loss: 1.422 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.277430534362793
Epoch: 12, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.506 Vali Acc: 0.625 Test Loss: 1.506 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.201986789703369
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.353 Vali Acc: 0.647 Test Loss: 1.353 Test Acc: 0.647
Validation loss decreased (-0.637487 --> -0.646861).  Saving model ...
Epoch: 14 cost time: 3.054395914077759
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.349 Vali Acc: 0.647 Test Loss: 1.349 Test Acc: 0.647
Validation loss decreased (-0.646861 --> -0.646862).  Saving model ...
Epoch: 15 cost time: 2.994946241378784
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.383 Vali Acc: 0.647 Test Loss: 1.383 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0740344524383545
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.410 Vali Acc: 0.666 Test Loss: 1.410 Test Acc: 0.666
Validation loss decreased (-0.646862 --> -0.665611).  Saving model ...
Epoch: 17 cost time: 2.806713819503784
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.404 Vali Acc: 0.675 Test Loss: 1.404 Test Acc: 0.675
Validation loss decreased (-0.665611 --> -0.674986).  Saving model ...
Epoch: 18 cost time: 3.081289291381836
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.397 Vali Acc: 0.675 Test Loss: 1.397 Test Acc: 0.675
Validation loss decreased (-0.674986 --> -0.674986).  Saving model ...
Epoch: 19 cost time: 3.1484339237213135
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.387 Vali Acc: 0.675 Test Loss: 1.387 Test Acc: 0.675
Validation loss decreased (-0.674986 --> -0.674986).  Saving model ...
Epoch: 20 cost time: 3.257878303527832
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.378 Vali Acc: 0.675 Test Loss: 1.378 Test Acc: 0.675
Validation loss decreased (-0.674986 --> -0.674986).  Saving model ...
Epoch: 21 cost time: 3.0934712886810303
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.369 Vali Acc: 0.681 Test Loss: 1.369 Test Acc: 0.681
Validation loss decreased (-0.674986 --> -0.681236).  Saving model ...
Epoch: 22 cost time: 2.7144150733947754
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.366 Vali Acc: 0.684 Test Loss: 1.366 Test Acc: 0.684
Validation loss decreased (-0.681236 --> -0.684361).  Saving model ...
Epoch: 23 cost time: 2.964402675628662
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.363 Vali Acc: 0.684 Test Loss: 1.363 Test Acc: 0.684
Validation loss decreased (-0.684361 --> -0.684361).  Saving model ...
Epoch: 24 cost time: 2.908263921737671
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.361 Vali Acc: 0.681 Test Loss: 1.361 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.926712989807129
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.370 Vali Acc: 0.688 Test Loss: 1.370 Test Acc: 0.688
Validation loss decreased (-0.684361 --> -0.687486).  Saving model ...
Epoch: 26 cost time: 3.0791385173797607
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.377 Vali Acc: 0.694 Test Loss: 1.377 Test Acc: 0.694
Validation loss decreased (-0.687486 --> -0.693736).  Saving model ...
Epoch: 27 cost time: 3.282532215118408
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.691 Test Loss: 1.381 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.244676351547241
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.694 Test Loss: 1.379 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1360864639282227
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.380 Vali Acc: 0.694 Test Loss: 1.380 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.911210060119629
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.380 Vali Acc: 0.688 Test Loss: 1.380 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.9858295917510986
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.387 Vali Acc: 0.684 Test Loss: 1.387 Test Acc: 0.684
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.8435871601104736
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.396 Vali Acc: 0.691 Test Loss: 1.396 Test Acc: 0.691
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.7832651138305664
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.688 Test Loss: 1.407 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.889488458633423
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.684 Test Loss: 1.406 Test Acc: 0.684
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.062196969985962
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.694 Test Loss: 1.405 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.13126802444458
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.694 Test Loss: 1.407 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.69375
model parameter : 1771784
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.568825960159302
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 2.002 Vali Acc: 0.206 Test Loss: 2.002 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 2.797222137451172
Epoch: 2, Steps: 8 | Train Loss: 1.796 Vali Loss: 1.657 Vali Acc: 0.475 Test Loss: 1.657 Test Acc: 0.475
Validation loss decreased (-0.206230 --> -0.474983).  Saving model ...
Epoch: 3 cost time: 2.9469072818756104
Epoch: 3, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.366 Vali Acc: 0.556 Test Loss: 1.366 Test Acc: 0.556
Validation loss decreased (-0.474983 --> -0.556236).  Saving model ...
Epoch: 4 cost time: 3.093615770339966
Epoch: 4, Steps: 8 | Train Loss: 0.895 Vali Loss: 1.188 Vali Acc: 0.578 Test Loss: 1.188 Test Acc: 0.578
Validation loss decreased (-0.556236 --> -0.578113).  Saving model ...
Epoch: 5 cost time: 3.0453851222991943
Epoch: 5, Steps: 8 | Train Loss: 0.623 Vali Loss: 1.146 Vali Acc: 0.591 Test Loss: 1.146 Test Acc: 0.591
Validation loss decreased (-0.578113 --> -0.590614).  Saving model ...
Epoch: 6 cost time: 3.0727529525756836
Epoch: 6, Steps: 8 | Train Loss: 0.388 Vali Loss: 1.111 Vali Acc: 0.628 Test Loss: 1.111 Test Acc: 0.628
Validation loss decreased (-0.590614 --> -0.628114).  Saving model ...
Epoch: 7 cost time: 3.257274627685547
Epoch: 7, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.173 Vali Acc: 0.609 Test Loss: 1.173 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.989572048187256
Epoch: 8, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.148 Vali Acc: 0.616 Test Loss: 1.148 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8763608932495117
Epoch: 9, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.246 Vali Acc: 0.600 Test Loss: 1.246 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0477287769317627
Epoch: 10, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.314 Vali Acc: 0.600 Test Loss: 1.314 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0028750896453857
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.312 Vali Acc: 0.619 Test Loss: 1.312 Test Acc: 0.619
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.239208698272705
Epoch: 12, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.336 Vali Acc: 0.591 Test Loss: 1.336 Test Acc: 0.591
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.1775262355804443
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.396 Vali Acc: 0.609 Test Loss: 1.396 Test Acc: 0.609
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.2510733604431152
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.399 Vali Acc: 0.628 Test Loss: 1.399 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.474661350250244
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.385 Vali Acc: 0.616 Test Loss: 1.385 Test Acc: 0.616
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.44101881980896
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.340 Vali Acc: 0.616 Test Loss: 1.340 Test Acc: 0.616
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.628125
model parameter : 1771784
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.852456092834473
Epoch: 1, Steps: 8 | Train Loss: 2.169 Vali Loss: 2.059 Vali Acc: 0.163 Test Loss: 2.059 Test Acc: 0.163
Validation loss decreased (inf --> -0.162479).  Saving model ...
Epoch: 2 cost time: 2.9124090671539307
Epoch: 2, Steps: 8 | Train Loss: 1.910 Vali Loss: 1.860 Vali Acc: 0.344 Test Loss: 1.860 Test Acc: 0.344
Validation loss decreased (-0.162479 --> -0.343731).  Saving model ...
Epoch: 3 cost time: 3.004013776779175
Epoch: 3, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.638 Vali Acc: 0.409 Test Loss: 1.638 Test Acc: 0.409
Validation loss decreased (-0.343731 --> -0.409359).  Saving model ...
Epoch: 4 cost time: 2.862699508666992
Epoch: 4, Steps: 8 | Train Loss: 1.165 Vali Loss: 1.509 Vali Acc: 0.441 Test Loss: 1.509 Test Acc: 0.441
Validation loss decreased (-0.409359 --> -0.440610).  Saving model ...
Epoch: 5 cost time: 3.200981616973877
Epoch: 5, Steps: 8 | Train Loss: 0.853 Vali Loss: 1.450 Vali Acc: 0.447 Test Loss: 1.450 Test Acc: 0.447
Validation loss decreased (-0.440610 --> -0.446860).  Saving model ...
Epoch: 6 cost time: 3.1100680828094482
Epoch: 6, Steps: 8 | Train Loss: 0.594 Vali Loss: 1.424 Vali Acc: 0.438 Test Loss: 1.424 Test Acc: 0.438
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.290515899658203
Epoch: 7, Steps: 8 | Train Loss: 0.442 Vali Loss: 1.452 Vali Acc: 0.453 Test Loss: 1.452 Test Acc: 0.453
Validation loss decreased (-0.446860 --> -0.453110).  Saving model ...
Epoch: 8 cost time: 3.2927052974700928
Epoch: 8, Steps: 8 | Train Loss: 0.331 Vali Loss: 1.484 Vali Acc: 0.459 Test Loss: 1.484 Test Acc: 0.459
Validation loss decreased (-0.453110 --> -0.459360).  Saving model ...
Epoch: 9 cost time: 3.2162246704101562
Epoch: 9, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.557 Vali Acc: 0.459 Test Loss: 1.557 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0513815879821777
Epoch: 10, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.515 Vali Acc: 0.500 Test Loss: 1.515 Test Acc: 0.500
Validation loss decreased (-0.459360 --> -0.499985).  Saving model ...
Epoch: 11 cost time: 3.3461084365844727
Epoch: 11, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.520 Vali Acc: 0.506 Test Loss: 1.520 Test Acc: 0.506
Validation loss decreased (-0.499985 --> -0.506235).  Saving model ...
Epoch: 12 cost time: 3.313018798828125
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.714 Vali Acc: 0.450 Test Loss: 1.714 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6953017711639404
Epoch: 13, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.741 Vali Acc: 0.491 Test Loss: 1.741 Test Acc: 0.491
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.258244037628174
Epoch: 14, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.844 Vali Acc: 0.481 Test Loss: 1.844 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3736987113952637
Epoch: 15, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.787 Vali Acc: 0.544 Test Loss: 1.787 Test Acc: 0.544
Validation loss decreased (-0.506235 --> -0.543732).  Saving model ...
Epoch: 16 cost time: 3.515899658203125
Epoch: 16, Steps: 8 | Train Loss: 0.027 Vali Loss: 2.115 Vali Acc: 0.509 Test Loss: 2.115 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5329887866973877
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.897 Vali Acc: 0.528 Test Loss: 1.897 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0236148834228516
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.735 Vali Acc: 0.562 Test Loss: 1.735 Test Acc: 0.562
Validation loss decreased (-0.543732 --> -0.562483).  Saving model ...
Epoch: 19 cost time: 3.233177661895752
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.021 Vali Acc: 0.503 Test Loss: 2.021 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.067417621612549
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.800 Vali Acc: 0.559 Test Loss: 1.800 Test Acc: 0.559
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.2266552448272705
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.766 Vali Acc: 0.553 Test Loss: 1.766 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.8083207607269287
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.842 Vali Acc: 0.541 Test Loss: 1.842 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.273618698120117
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.809 Vali Acc: 0.553 Test Loss: 1.809 Test Acc: 0.553
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.6356828212738037
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.720 Vali Acc: 0.566 Test Loss: 1.720 Test Acc: 0.566
Validation loss decreased (-0.562483 --> -0.565608).  Saving model ...
Epoch: 25 cost time: 3.0483100414276123
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.738 Vali Acc: 0.569 Test Loss: 1.738 Test Acc: 0.569
Validation loss decreased (-0.565608 --> -0.568733).  Saving model ...
Epoch: 26 cost time: 2.983257293701172
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.753 Vali Acc: 0.553 Test Loss: 1.753 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2021312713623047
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.747 Vali Acc: 0.550 Test Loss: 1.747 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.277554988861084
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.553 Test Loss: 1.723 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.196730852127075
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.716 Vali Acc: 0.559 Test Loss: 1.716 Test Acc: 0.559
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.6355490684509277
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.566 Test Loss: 1.723 Test Acc: 0.566
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.4490065574645996
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.731 Vali Acc: 0.559 Test Loss: 1.731 Test Acc: 0.559
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.3457958698272705
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.700 Vali Acc: 0.572 Test Loss: 1.700 Test Acc: 0.572
Validation loss decreased (-0.568733 --> -0.571858).  Saving model ...
Epoch: 33 cost time: 3.3917691707611084
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.566 Test Loss: 1.723 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.910022258758545
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.758 Vali Acc: 0.553 Test Loss: 1.758 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.0349388122558594
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.742 Vali Acc: 0.559 Test Loss: 1.742 Test Acc: 0.559
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.2222654819488525
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.711 Vali Acc: 0.581 Test Loss: 1.711 Test Acc: 0.581
Validation loss decreased (-0.571858 --> -0.581233).  Saving model ...
Epoch: 37 cost time: 3.22658109664917
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.699 Vali Acc: 0.591 Test Loss: 1.699 Test Acc: 0.591
Validation loss decreased (-0.581233 --> -0.590608).  Saving model ...
Epoch: 38 cost time: 3.5448765754699707
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.716 Vali Acc: 0.578 Test Loss: 1.716 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.2848782539367676
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.764 Vali Acc: 0.572 Test Loss: 1.764 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.6303963661193848
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.758 Vali Acc: 0.572 Test Loss: 1.758 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.3657209873199463
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.733 Vali Acc: 0.584 Test Loss: 1.733 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.2016775608062744
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.597 Test Loss: 1.719 Test Acc: 0.597
Validation loss decreased (-0.590608 --> -0.596858).  Saving model ...
Epoch: 43 cost time: 2.944864511489868
Epoch: 43, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.584 Test Loss: 1.734 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.1267104148864746
Epoch: 44, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.751 Vali Acc: 0.584 Test Loss: 1.751 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.821504592895508
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.764 Vali Acc: 0.578 Test Loss: 1.764 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.8356101512908936
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.750 Vali Acc: 0.588 Test Loss: 1.750 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.0703086853027344
Epoch: 47, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.750 Vali Acc: 0.594 Test Loss: 1.750 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.914285898208618
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.745 Vali Acc: 0.594 Test Loss: 1.745 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.3488926887512207
Epoch: 49, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.732 Vali Acc: 0.597 Test Loss: 1.732 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.360215902328491
Epoch: 50, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.594 Test Loss: 1.742 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.311408519744873
Epoch: 51, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.750 Vali Acc: 0.600 Test Loss: 1.750 Test Acc: 0.600
Validation loss decreased (-0.596858 --> -0.599982).  Saving model ...
Epoch: 52 cost time: 3.1667816638946533
Epoch: 52, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.750 Vali Acc: 0.597 Test Loss: 1.750 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.1497180461883545
Epoch: 53, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.600 Test Loss: 1.767 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.290522813796997
Epoch: 54, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.609 Test Loss: 1.758 Test Acc: 0.609
Validation loss decreased (-0.599982 --> -0.609357).  Saving model ...
Epoch: 55 cost time: 3.147211790084839
Epoch: 55, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.750 Vali Acc: 0.619 Test Loss: 1.750 Test Acc: 0.619
Validation loss decreased (-0.609357 --> -0.618733).  Saving model ...
Epoch: 56 cost time: 2.922565221786499
Epoch: 56, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.726 Vali Acc: 0.622 Test Loss: 1.726 Test Acc: 0.622
Validation loss decreased (-0.618733 --> -0.621858).  Saving model ...
Epoch: 57 cost time: 3.1359448432922363
Epoch: 57, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.616 Test Loss: 1.731 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.0606746673583984
Epoch: 58, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.765 Vali Acc: 0.597 Test Loss: 1.765 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.208253860473633
Epoch: 59, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.765 Vali Acc: 0.600 Test Loss: 1.765 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.753340005874634
Epoch: 60, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.741 Vali Acc: 0.622 Test Loss: 1.741 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.1565890312194824
Epoch: 61, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.740 Vali Acc: 0.631 Test Loss: 1.740 Test Acc: 0.631
Validation loss decreased (-0.621858 --> -0.631233).  Saving model ...
Epoch: 62 cost time: 3.1798248291015625
Epoch: 62, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.740 Vali Acc: 0.631 Test Loss: 1.740 Test Acc: 0.631
Validation loss decreased (-0.631233 --> -0.631233).  Saving model ...
Epoch: 63 cost time: 3.294877052307129
Epoch: 63, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.741 Vali Acc: 0.619 Test Loss: 1.741 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.110599994659424
Epoch: 64, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.619 Test Loss: 1.749 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 3.4107725620269775
Epoch: 65, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.628 Test Loss: 1.731 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 3.1371984481811523
Epoch: 66, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.622 Test Loss: 1.706 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 3.509071111679077
Epoch: 67, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.625 Test Loss: 1.718 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 3.162710189819336
Epoch: 68, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.631 Test Loss: 1.718 Test Acc: 0.631
Validation loss decreased (-0.631233 --> -0.631233).  Saving model ...
Epoch: 69 cost time: 3.3295531272888184
Epoch: 69, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.628 Test Loss: 1.721 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 3.328070640563965
Epoch: 70, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.720 Vali Acc: 0.631 Test Loss: 1.720 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 2.9685065746307373
Epoch: 71, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.720 Vali Acc: 0.634 Test Loss: 1.720 Test Acc: 0.634
Validation loss decreased (-0.631233 --> -0.634358).  Saving model ...
Epoch: 72 cost time: 3.6187903881073
Epoch: 72, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.631 Test Loss: 1.734 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 3.0764143466949463
Epoch: 73, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.753 Vali Acc: 0.619 Test Loss: 1.753 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 3.0875895023345947
Epoch: 74, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.628 Test Loss: 1.731 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 3.104501485824585
Epoch: 75, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.719 Vali Acc: 0.634 Test Loss: 1.719 Test Acc: 0.634
Validation loss decreased (-0.634358 --> -0.634358).  Saving model ...
Epoch: 76 cost time: 3.38525390625
Epoch: 76, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.724 Vali Acc: 0.644 Test Loss: 1.724 Test Acc: 0.644
Validation loss decreased (-0.634358 --> -0.643733).  Saving model ...
Epoch: 77 cost time: 3.6312429904937744
Epoch: 77, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.745 Vali Acc: 0.644 Test Loss: 1.745 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 3.332481861114502
Epoch: 78, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.631 Test Loss: 1.760 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 3.234478235244751
Epoch: 79, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.641 Test Loss: 1.756 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 3.4136695861816406
Epoch: 80, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.748 Vali Acc: 0.641 Test Loss: 1.748 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 3.350951910018921
Epoch: 81, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.746 Vali Acc: 0.641 Test Loss: 1.746 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 3.4142098426818848
Epoch: 82, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.740 Vali Acc: 0.641 Test Loss: 1.740 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 3.152137517929077
Epoch: 83, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.740 Vali Acc: 0.637 Test Loss: 1.740 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 2.9390182495117188
Epoch: 84, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.637 Test Loss: 1.749 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 2.762105703353882
Epoch: 85, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.631 Test Loss: 1.760 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 2.8699536323547363
Epoch: 86, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.641 Test Loss: 1.760 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.64375
model parameter : 1771784
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.868749141693115
Epoch: 1, Steps: 8 | Train Loss: 2.153 Vali Loss: 2.082 Vali Acc: 0.128 Test Loss: 2.082 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 3.2079575061798096
Epoch: 2, Steps: 8 | Train Loss: 1.987 Vali Loss: 1.960 Vali Acc: 0.256 Test Loss: 1.960 Test Acc: 0.256
Validation loss decreased (-0.128104 --> -0.256230).  Saving model ...
Epoch: 3 cost time: 2.936022996902466
Epoch: 3, Steps: 8 | Train Loss: 1.758 Vali Loss: 1.847 Vali Acc: 0.275 Test Loss: 1.847 Test Acc: 0.275
Validation loss decreased (-0.256230 --> -0.274982).  Saving model ...
Epoch: 4 cost time: 2.867241382598877
Epoch: 4, Steps: 8 | Train Loss: 1.355 Vali Loss: 1.689 Vali Acc: 0.438 Test Loss: 1.689 Test Acc: 0.438
Validation loss decreased (-0.274982 --> -0.437483).  Saving model ...
Epoch: 5 cost time: 2.9032979011535645
Epoch: 5, Steps: 8 | Train Loss: 1.041 Vali Loss: 1.696 Vali Acc: 0.319 Test Loss: 1.696 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.912605047225952
Epoch: 6, Steps: 8 | Train Loss: 0.764 Vali Loss: 1.616 Vali Acc: 0.359 Test Loss: 1.616 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.241757392883301
Epoch: 7, Steps: 8 | Train Loss: 0.549 Vali Loss: 1.526 Vali Acc: 0.397 Test Loss: 1.526 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.343824863433838
Epoch: 8, Steps: 8 | Train Loss: 0.441 Vali Loss: 1.683 Vali Acc: 0.328 Test Loss: 1.683 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7416651248931885
Epoch: 9, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.590 Vali Acc: 0.341 Test Loss: 1.590 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.079522132873535
Epoch: 10, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.630 Vali Acc: 0.359 Test Loss: 1.630 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.0876924991607666
Epoch: 11, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.647 Vali Acc: 0.359 Test Loss: 1.647 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0948777198791504
Epoch: 12, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.746 Vali Acc: 0.378 Test Loss: 1.746 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.20080828666687
Epoch: 13, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.813 Vali Acc: 0.366 Test Loss: 1.813 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.206237316131592
Epoch: 14, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.792 Vali Acc: 0.388 Test Loss: 1.792 Test Acc: 0.388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.4375
model parameter : 1771784
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.78891921043396
Epoch: 1, Steps: 8 | Train Loss: 2.178 Vali Loss: 2.077 Vali Acc: 0.144 Test Loss: 2.077 Test Acc: 0.144
Validation loss decreased (inf --> -0.143729).  Saving model ...
Epoch: 2 cost time: 2.9275050163269043
Epoch: 2, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.987 Vali Acc: 0.228 Test Loss: 1.987 Test Acc: 0.228
Validation loss decreased (-0.143729 --> -0.228105).  Saving model ...
Epoch: 3 cost time: 2.9088871479034424
Epoch: 3, Steps: 8 | Train Loss: 1.745 Vali Loss: 1.910 Vali Acc: 0.188 Test Loss: 1.910 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0018417835235596
Epoch: 4, Steps: 8 | Train Loss: 1.407 Vali Loss: 1.768 Vali Acc: 0.378 Test Loss: 1.768 Test Acc: 0.378
Validation loss decreased (-0.228105 --> -0.378107).  Saving model ...
Epoch: 5 cost time: 3.163292646408081
Epoch: 5, Steps: 8 | Train Loss: 1.086 Vali Loss: 1.715 Vali Acc: 0.325 Test Loss: 1.715 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9238626956939697
Epoch: 6, Steps: 8 | Train Loss: 0.784 Vali Loss: 1.634 Vali Acc: 0.350 Test Loss: 1.634 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7876663208007812
Epoch: 7, Steps: 8 | Train Loss: 0.607 Vali Loss: 1.487 Vali Acc: 0.463 Test Loss: 1.487 Test Acc: 0.463
Validation loss decreased (-0.378107 --> -0.462485).  Saving model ...
Epoch: 8 cost time: 2.7525675296783447
Epoch: 8, Steps: 8 | Train Loss: 0.446 Vali Loss: 1.493 Vali Acc: 0.388 Test Loss: 1.493 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8366825580596924
Epoch: 9, Steps: 8 | Train Loss: 0.323 Vali Loss: 1.460 Vali Acc: 0.394 Test Loss: 1.460 Test Acc: 0.394
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.81691837310791
Epoch: 10, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.397 Vali Acc: 0.434 Test Loss: 1.397 Test Acc: 0.434
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0317344665527344
Epoch: 11, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.482 Vali Acc: 0.406 Test Loss: 1.482 Test Acc: 0.406
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.0684828758239746
Epoch: 12, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.525 Vali Acc: 0.388 Test Loss: 1.525 Test Acc: 0.388
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9704644680023193
Epoch: 13, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.576 Vali Acc: 0.428 Test Loss: 1.576 Test Acc: 0.428
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.1442577838897705
Epoch: 14, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.649 Vali Acc: 0.397 Test Loss: 1.649 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9247777462005615
Epoch: 15, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.690 Vali Acc: 0.487 Test Loss: 1.690 Test Acc: 0.487
Validation loss decreased (-0.462485 --> -0.487483).  Saving model ...
Epoch: 16 cost time: 3.106776237487793
Epoch: 16, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.843 Vali Acc: 0.388 Test Loss: 1.843 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8099658489227295
Epoch: 17, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.893 Vali Acc: 0.434 Test Loss: 1.893 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3034210205078125
Epoch: 18, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.650 Vali Acc: 0.506 Test Loss: 1.650 Test Acc: 0.506
Validation loss decreased (-0.487483 --> -0.506234).  Saving model ...
Epoch: 19 cost time: 3.1022346019744873
Epoch: 19, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.844 Vali Acc: 0.434 Test Loss: 1.844 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1156535148620605
Epoch: 20, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.888 Vali Acc: 0.491 Test Loss: 1.888 Test Acc: 0.491
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0695486068725586
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.104 Vali Acc: 0.409 Test Loss: 2.104 Test Acc: 0.409
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.139796257019043
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.774 Vali Acc: 0.500 Test Loss: 1.774 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.979180335998535
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.881 Vali Acc: 0.478 Test Loss: 1.881 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.1823973655700684
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.817 Vali Acc: 0.463 Test Loss: 1.817 Test Acc: 0.463
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.432192325592041
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.709 Vali Acc: 0.500 Test Loss: 1.709 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.311338186264038
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.900 Vali Acc: 0.475 Test Loss: 1.900 Test Acc: 0.475
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.081688404083252
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.688 Vali Acc: 0.534 Test Loss: 1.688 Test Acc: 0.534
Validation loss decreased (-0.506234 --> -0.534358).  Saving model ...
Epoch: 28 cost time: 3.415985107421875
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.689 Vali Acc: 0.534 Test Loss: 1.689 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.8665876388549805
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.812 Vali Acc: 0.500 Test Loss: 1.812 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.11149001121521
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.794 Vali Acc: 0.506 Test Loss: 1.794 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.467576503753662
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.786 Vali Acc: 0.525 Test Loss: 1.786 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.0980381965637207
Epoch: 32, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.735 Vali Acc: 0.541 Test Loss: 1.735 Test Acc: 0.541
Validation loss decreased (-0.534358 --> -0.540608).  Saving model ...
Epoch: 33 cost time: 3.4389779567718506
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.169 Vali Acc: 0.484 Test Loss: 2.169 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.039630651473999
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.206 Vali Acc: 0.472 Test Loss: 2.206 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.0055103302001953
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.907 Vali Acc: 0.509 Test Loss: 1.907 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.965517282485962
Epoch: 36, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.805 Vali Acc: 0.553 Test Loss: 1.805 Test Acc: 0.553
Validation loss decreased (-0.540608 --> -0.553107).  Saving model ...
Epoch: 37 cost time: 3.9457030296325684
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.852 Vali Acc: 0.547 Test Loss: 1.852 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.2671642303466797
Epoch: 38, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.918 Vali Acc: 0.534 Test Loss: 1.918 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.4841561317443848
Epoch: 39, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.979 Vali Acc: 0.519 Test Loss: 1.979 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.273742437362671
Epoch: 40, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.957 Vali Acc: 0.534 Test Loss: 1.957 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.9906256198883057
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.923 Vali Acc: 0.541 Test Loss: 1.923 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.206510305404663
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.915 Vali Acc: 0.544 Test Loss: 1.915 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.2847862243652344
Epoch: 43, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.931 Vali Acc: 0.541 Test Loss: 1.931 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.2256922721862793
Epoch: 44, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.977 Vali Acc: 0.531 Test Loss: 1.977 Test Acc: 0.531
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.129133939743042
Epoch: 45, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.936 Vali Acc: 0.547 Test Loss: 1.936 Test Acc: 0.547
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.0926685333251953
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.951 Vali Acc: 0.544 Test Loss: 1.951 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.553125
model parameter : 1771784
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.4488019943237305
Epoch: 1, Steps: 8 | Train Loss: 2.166 Vali Loss: 2.109 Vali Acc: 0.147 Test Loss: 2.109 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 3.265688896179199
Epoch: 2, Steps: 8 | Train Loss: 1.987 Vali Loss: 2.021 Vali Acc: 0.125 Test Loss: 2.021 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1626217365264893
Epoch: 3, Steps: 8 | Train Loss: 1.739 Vali Loss: 1.929 Vali Acc: 0.278 Test Loss: 1.929 Test Acc: 0.278
Validation loss decreased (-0.146854 --> -0.278106).  Saving model ...
Epoch: 4 cost time: 3.1968114376068115
Epoch: 4, Steps: 8 | Train Loss: 1.325 Vali Loss: 1.809 Vali Acc: 0.378 Test Loss: 1.809 Test Acc: 0.378
Validation loss decreased (-0.278106 --> -0.378107).  Saving model ...
Epoch: 5 cost time: 3.0449280738830566
Epoch: 5, Steps: 8 | Train Loss: 1.011 Vali Loss: 1.718 Vali Acc: 0.341 Test Loss: 1.718 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1262776851654053
Epoch: 6, Steps: 8 | Train Loss: 0.726 Vali Loss: 1.650 Vali Acc: 0.312 Test Loss: 1.650 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9978742599487305
Epoch: 7, Steps: 8 | Train Loss: 0.539 Vali Loss: 1.454 Vali Acc: 0.519 Test Loss: 1.454 Test Acc: 0.519
Validation loss decreased (-0.378107 --> -0.518735).  Saving model ...
Epoch: 8 cost time: 2.7229301929473877
Epoch: 8, Steps: 8 | Train Loss: 0.403 Vali Loss: 1.427 Vali Acc: 0.453 Test Loss: 1.427 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4321277141571045
Epoch: 9, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.360 Vali Acc: 0.456 Test Loss: 1.360 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3149526119232178
Epoch: 10, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.319 Vali Acc: 0.553 Test Loss: 1.319 Test Acc: 0.553
Validation loss decreased (-0.518735 --> -0.553112).  Saving model ...
Epoch: 11 cost time: 3.2308244705200195
Epoch: 11, Steps: 8 | Train Loss: 0.187 Vali Loss: 1.416 Vali Acc: 0.472 Test Loss: 1.416 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0257022380828857
Epoch: 12, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.406 Vali Acc: 0.491 Test Loss: 1.406 Test Acc: 0.491
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.938952684402466
Epoch: 13, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.528 Vali Acc: 0.484 Test Loss: 1.528 Test Acc: 0.484
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0548248291015625
Epoch: 14, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.536 Vali Acc: 0.453 Test Loss: 1.536 Test Acc: 0.453
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.5857601165771484
Epoch: 15, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.760 Vali Acc: 0.453 Test Loss: 1.760 Test Acc: 0.453
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.461782932281494
Epoch: 16, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.606 Vali Acc: 0.466 Test Loss: 1.606 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.4022867679595947
Epoch: 17, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.585 Vali Acc: 0.472 Test Loss: 1.585 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1439428329467773
Epoch: 18, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.656 Vali Acc: 0.512 Test Loss: 1.656 Test Acc: 0.512
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.0763604640960693
Epoch: 19, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.741 Vali Acc: 0.466 Test Loss: 1.741 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.0705482959747314
Epoch: 20, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.739 Vali Acc: 0.494 Test Loss: 1.739 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.553125
model parameter : 1771784
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.012330055236816
Epoch: 1, Steps: 8 | Train Loss: 2.184 Vali Loss: 2.090 Vali Acc: 0.144 Test Loss: 2.090 Test Acc: 0.144
Validation loss decreased (inf --> -0.143729).  Saving model ...
Epoch: 2 cost time: 2.99417781829834
Epoch: 2, Steps: 8 | Train Loss: 2.029 Vali Loss: 1.979 Vali Acc: 0.172 Test Loss: 1.979 Test Acc: 0.172
Validation loss decreased (-0.143729 --> -0.171855).  Saving model ...
Epoch: 3 cost time: 3.146127700805664
Epoch: 3, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.790 Vali Acc: 0.359 Test Loss: 1.790 Test Acc: 0.359
Validation loss decreased (-0.171855 --> -0.359357).  Saving model ...
Epoch: 4 cost time: 3.4005041122436523
Epoch: 4, Steps: 8 | Train Loss: 1.406 Vali Loss: 1.565 Vali Acc: 0.531 Test Loss: 1.565 Test Acc: 0.531
Validation loss decreased (-0.359357 --> -0.531234).  Saving model ...
Epoch: 5 cost time: 2.7609057426452637
Epoch: 5, Steps: 8 | Train Loss: 1.111 Vali Loss: 1.423 Vali Acc: 0.491 Test Loss: 1.423 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9164576530456543
Epoch: 6, Steps: 8 | Train Loss: 0.806 Vali Loss: 1.359 Vali Acc: 0.463 Test Loss: 1.359 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.076345205307007
Epoch: 7, Steps: 8 | Train Loss: 0.587 Vali Loss: 1.243 Vali Acc: 0.534 Test Loss: 1.243 Test Acc: 0.534
Validation loss decreased (-0.531234 --> -0.534363).  Saving model ...
Epoch: 8 cost time: 2.931232213973999
Epoch: 8, Steps: 8 | Train Loss: 0.417 Vali Loss: 1.415 Vali Acc: 0.466 Test Loss: 1.415 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9936130046844482
Epoch: 9, Steps: 8 | Train Loss: 0.307 Vali Loss: 1.587 Vali Acc: 0.453 Test Loss: 1.587 Test Acc: 0.453
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9579005241394043
Epoch: 10, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.587 Vali Acc: 0.506 Test Loss: 1.587 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.879695415496826
Epoch: 11, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.672 Vali Acc: 0.484 Test Loss: 1.672 Test Acc: 0.484
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1948940753936768
Epoch: 12, Steps: 8 | Train Loss: 0.139 Vali Loss: 2.027 Vali Acc: 0.438 Test Loss: 2.027 Test Acc: 0.438
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.2347278594970703
Epoch: 13, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.915 Vali Acc: 0.466 Test Loss: 1.915 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.001929521560669
Epoch: 14, Steps: 8 | Train Loss: 0.121 Vali Loss: 2.172 Vali Acc: 0.434 Test Loss: 2.172 Test Acc: 0.434
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9840495586395264
Epoch: 15, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.974 Vali Acc: 0.469 Test Loss: 1.974 Test Acc: 0.469
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.0099077224731445
Epoch: 16, Steps: 8 | Train Loss: 0.054 Vali Loss: 2.231 Vali Acc: 0.459 Test Loss: 2.231 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.3301584720611572
Epoch: 17, Steps: 8 | Train Loss: 0.037 Vali Loss: 2.276 Vali Acc: 0.444 Test Loss: 2.276 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.534375
model parameter : 1771784
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.880662441253662
Epoch: 1, Steps: 8 | Train Loss: 2.137 Vali Loss: 2.096 Vali Acc: 0.156 Test Loss: 2.096 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 3.0277318954467773
Epoch: 2, Steps: 8 | Train Loss: 2.026 Vali Loss: 1.956 Vali Acc: 0.250 Test Loss: 1.956 Test Acc: 0.250
Validation loss decreased (-0.156229 --> -0.249980).  Saving model ...
Epoch: 3 cost time: 2.8893589973449707
Epoch: 3, Steps: 8 | Train Loss: 1.745 Vali Loss: 1.793 Vali Acc: 0.362 Test Loss: 1.793 Test Acc: 0.362
Validation loss decreased (-0.249980 --> -0.362482).  Saving model ...
Epoch: 4 cost time: 2.9888343811035156
Epoch: 4, Steps: 8 | Train Loss: 1.478 Vali Loss: 1.554 Vali Acc: 0.509 Test Loss: 1.554 Test Acc: 0.509
Validation loss decreased (-0.362482 --> -0.509359).  Saving model ...
Epoch: 5 cost time: 3.0679447650909424
Epoch: 5, Steps: 8 | Train Loss: 1.151 Vali Loss: 1.410 Vali Acc: 0.525 Test Loss: 1.410 Test Acc: 0.525
Validation loss decreased (-0.509359 --> -0.524986).  Saving model ...
Epoch: 6 cost time: 3.0816051959991455
Epoch: 6, Steps: 8 | Train Loss: 0.866 Vali Loss: 1.351 Vali Acc: 0.484 Test Loss: 1.351 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1447389125823975
Epoch: 7, Steps: 8 | Train Loss: 0.683 Vali Loss: 1.317 Vali Acc: 0.509 Test Loss: 1.317 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.762845039367676
Epoch: 8, Steps: 8 | Train Loss: 0.534 Vali Loss: 1.457 Vali Acc: 0.444 Test Loss: 1.457 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8667829036712646
Epoch: 9, Steps: 8 | Train Loss: 0.404 Vali Loss: 1.787 Vali Acc: 0.419 Test Loss: 1.787 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0428130626678467
Epoch: 10, Steps: 8 | Train Loss: 0.297 Vali Loss: 1.739 Vali Acc: 0.475 Test Loss: 1.739 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.890178918838501
Epoch: 11, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.849 Vali Acc: 0.456 Test Loss: 1.849 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.093843936920166
Epoch: 12, Steps: 8 | Train Loss: 0.192 Vali Loss: 2.131 Vali Acc: 0.431 Test Loss: 2.131 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0799338817596436
Epoch: 13, Steps: 8 | Train Loss: 0.142 Vali Loss: 2.012 Vali Acc: 0.475 Test Loss: 2.012 Test Acc: 0.475
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.2110817432403564
Epoch: 14, Steps: 8 | Train Loss: 0.118 Vali Loss: 2.121 Vali Acc: 0.438 Test Loss: 2.121 Test Acc: 0.438
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.219602584838867
Epoch: 15, Steps: 8 | Train Loss: 0.083 Vali Loss: 2.183 Vali Acc: 0.428 Test Loss: 2.183 Test Acc: 0.428
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.525
model parameter : 1771784
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.200902462005615
Epoch: 1, Steps: 8 | Train Loss: 2.018 Vali Loss: 1.745 Vali Acc: 0.537 Test Loss: 1.745 Test Acc: 0.537
Validation loss decreased (inf --> -0.537483).  Saving model ...
Epoch: 2 cost time: 3.4011409282684326
Epoch: 2, Steps: 8 | Train Loss: 1.403 Vali Loss: 1.052 Vali Acc: 0.709 Test Loss: 1.052 Test Acc: 0.709
Validation loss decreased (-0.537483 --> -0.709364).  Saving model ...
Epoch: 3 cost time: 3.1296639442443848
Epoch: 3, Steps: 8 | Train Loss: 0.814 Vali Loss: 0.776 Vali Acc: 0.756 Test Loss: 0.776 Test Acc: 0.756
Validation loss decreased (-0.709364 --> -0.756242).  Saving model ...
Epoch: 4 cost time: 2.7206008434295654
Epoch: 4, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.726 Vali Acc: 0.756 Test Loss: 0.726 Test Acc: 0.756
Validation loss decreased (-0.756242 --> -0.756243).  Saving model ...
Epoch: 5 cost time: 2.872204542160034
Epoch: 5, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.741 Vali Acc: 0.756 Test Loss: 0.741 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2560336589813232
Epoch: 6, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.742 Vali Acc: 0.753 Test Loss: 0.742 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.244478225708008
Epoch: 7, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.857 Vali Acc: 0.738 Test Loss: 0.857 Test Acc: 0.738
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.980232000350952
Epoch: 8, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.861 Vali Acc: 0.759 Test Loss: 0.861 Test Acc: 0.759
Validation loss decreased (-0.756243 --> -0.759366).  Saving model ...
Epoch: 9 cost time: 2.918586254119873
Epoch: 9, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.933 Vali Acc: 0.747 Test Loss: 0.933 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1553242206573486
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.965 Vali Acc: 0.744 Test Loss: 0.965 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.301992177963257
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.972 Vali Acc: 0.784 Test Loss: 0.972 Test Acc: 0.784
Validation loss decreased (-0.759366 --> -0.784365).  Saving model ...
Epoch: 12 cost time: 3.110997438430786
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.970 Vali Acc: 0.791 Test Loss: 0.970 Test Acc: 0.791
Validation loss decreased (-0.784365 --> -0.790615).  Saving model ...
Epoch: 13 cost time: 3.174863815307617
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.970 Vali Acc: 0.772 Test Loss: 0.970 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1551527976989746
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.968 Vali Acc: 0.772 Test Loss: 0.968 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.135934352874756
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.971 Vali Acc: 0.772 Test Loss: 0.971 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.101931095123291
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.978 Vali Acc: 0.772 Test Loss: 0.978 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.0732529163360596
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.977 Vali Acc: 0.772 Test Loss: 0.977 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0709269046783447
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.976 Vali Acc: 0.781 Test Loss: 0.976 Test Acc: 0.781
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.957132577896118
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.778 Test Loss: 0.979 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.9678354263305664
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.781 Test Loss: 0.985 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.9069671630859375
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.989 Vali Acc: 0.781 Test Loss: 0.989 Test Acc: 0.781
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.082120895385742
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.781 Test Loss: 0.997 Test Acc: 0.781
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.790625
model parameter : 1378568
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.9225499629974365
Epoch: 1, Steps: 8 | Train Loss: 2.030 Vali Loss: 1.830 Vali Acc: 0.441 Test Loss: 1.830 Test Acc: 0.441
Validation loss decreased (inf --> -0.440607).  Saving model ...
Epoch: 2 cost time: 2.9680943489074707
Epoch: 2, Steps: 8 | Train Loss: 1.488 Vali Loss: 1.268 Vali Acc: 0.616 Test Loss: 1.268 Test Acc: 0.616
Validation loss decreased (-0.440607 --> -0.615612).  Saving model ...
Epoch: 3 cost time: 3.1137535572052
Epoch: 3, Steps: 8 | Train Loss: 0.937 Vali Loss: 1.030 Vali Acc: 0.678 Test Loss: 1.030 Test Acc: 0.678
Validation loss decreased (-0.615612 --> -0.678115).  Saving model ...
Epoch: 4 cost time: 3.020442247390747
Epoch: 4, Steps: 8 | Train Loss: 0.552 Vali Loss: 0.954 Vali Acc: 0.672 Test Loss: 0.954 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.284550428390503
Epoch: 5, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.960 Vali Acc: 0.678 Test Loss: 0.960 Test Acc: 0.678
Validation loss decreased (-0.678115 --> -0.678115).  Saving model ...
Epoch: 6 cost time: 3.1502721309661865
Epoch: 6, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.949 Vali Acc: 0.675 Test Loss: 0.949 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9925708770751953
Epoch: 7, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.057 Vali Acc: 0.666 Test Loss: 1.057 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.985544204711914
Epoch: 8, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.125 Vali Acc: 0.669 Test Loss: 1.125 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8301641941070557
Epoch: 9, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.102 Vali Acc: 0.681 Test Loss: 1.102 Test Acc: 0.681
Validation loss decreased (-0.678115 --> -0.681239).  Saving model ...
Epoch: 10 cost time: 2.996032953262329
Epoch: 10, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.155 Vali Acc: 0.688 Test Loss: 1.155 Test Acc: 0.688
Validation loss decreased (-0.681239 --> -0.687488).  Saving model ...
Epoch: 11 cost time: 2.9908995628356934
Epoch: 11, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.245 Vali Acc: 0.659 Test Loss: 1.245 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.043428421020508
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.302 Vali Acc: 0.669 Test Loss: 1.302 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2273502349853516
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.313 Vali Acc: 0.672 Test Loss: 1.313 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1620852947235107
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.301 Vali Acc: 0.681 Test Loss: 1.301 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.9738078117370605
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.298 Vali Acc: 0.681 Test Loss: 1.298 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7985353469848633
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.298 Vali Acc: 0.675 Test Loss: 1.298 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.9103424549102783
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.297 Vali Acc: 0.678 Test Loss: 1.297 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.213406801223755
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.294 Vali Acc: 0.675 Test Loss: 1.294 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.0128581523895264
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.298 Vali Acc: 0.678 Test Loss: 1.298 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.4160549640655518
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.307 Vali Acc: 0.684 Test Loss: 1.307 Test Acc: 0.684
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.6875
model parameter : 1378568
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.5340962409973145
Epoch: 1, Steps: 8 | Train Loss: 2.039 Vali Loss: 1.903 Vali Acc: 0.359 Test Loss: 1.903 Test Acc: 0.359
Validation loss decreased (inf --> -0.359356).  Saving model ...
Epoch: 2 cost time: 2.913933753967285
Epoch: 2, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.427 Vali Acc: 0.559 Test Loss: 1.427 Test Acc: 0.559
Validation loss decreased (-0.359356 --> -0.559361).  Saving model ...
Epoch: 3 cost time: 3.369133710861206
Epoch: 3, Steps: 8 | Train Loss: 1.081 Vali Loss: 1.184 Vali Acc: 0.597 Test Loss: 1.184 Test Acc: 0.597
Validation loss decreased (-0.559361 --> -0.596863).  Saving model ...
Epoch: 4 cost time: 3.3322255611419678
Epoch: 4, Steps: 8 | Train Loss: 0.657 Vali Loss: 1.061 Vali Acc: 0.628 Test Loss: 1.061 Test Acc: 0.628
Validation loss decreased (-0.596863 --> -0.628114).  Saving model ...
Epoch: 5 cost time: 2.947381019592285
Epoch: 5, Steps: 8 | Train Loss: 0.463 Vali Loss: 1.045 Vali Acc: 0.656 Test Loss: 1.045 Test Acc: 0.656
Validation loss decreased (-0.628114 --> -0.656240).  Saving model ...
Epoch: 6 cost time: 3.05265212059021
Epoch: 6, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.988 Vali Acc: 0.659 Test Loss: 0.988 Test Acc: 0.659
Validation loss decreased (-0.656240 --> -0.659365).  Saving model ...
Epoch: 7 cost time: 3.1386260986328125
Epoch: 7, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.087 Vali Acc: 0.659 Test Loss: 1.087 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.150646209716797
Epoch: 8, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.127 Vali Acc: 0.653 Test Loss: 1.127 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.143028736114502
Epoch: 9, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.113 Vali Acc: 0.650 Test Loss: 1.113 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0846569538116455
Epoch: 10, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.122 Vali Acc: 0.666 Test Loss: 1.122 Test Acc: 0.666
Validation loss decreased (-0.659365 --> -0.665614).  Saving model ...
Epoch: 11 cost time: 2.97619891166687
Epoch: 11, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.161 Vali Acc: 0.672 Test Loss: 1.161 Test Acc: 0.672
Validation loss decreased (-0.665614 --> -0.671863).  Saving model ...
Epoch: 12 cost time: 2.939539909362793
Epoch: 12, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.197 Vali Acc: 0.656 Test Loss: 1.197 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3401553630828857
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.237 Vali Acc: 0.669 Test Loss: 1.237 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4042060375213623
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.246 Vali Acc: 0.662 Test Loss: 1.246 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9512808322906494
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.247 Vali Acc: 0.672 Test Loss: 1.247 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2795653343200684
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.252 Vali Acc: 0.681 Test Loss: 1.252 Test Acc: 0.681
Validation loss decreased (-0.671863 --> -0.681237).  Saving model ...
Epoch: 17 cost time: 3.511634588241577
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.231 Vali Acc: 0.675 Test Loss: 1.231 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7082505226135254
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.233 Vali Acc: 0.678 Test Loss: 1.233 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.806684732437134
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.242 Vali Acc: 0.688 Test Loss: 1.242 Test Acc: 0.688
Validation loss decreased (-0.681237 --> -0.687488).  Saving model ...
Epoch: 20 cost time: 3.2115228176116943
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.250 Vali Acc: 0.684 Test Loss: 1.250 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9696285724639893
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.264 Vali Acc: 0.681 Test Loss: 1.264 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1681485176086426
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.269 Vali Acc: 0.672 Test Loss: 1.269 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.2803056240081787
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.281 Vali Acc: 0.675 Test Loss: 1.281 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.3974123001098633
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.269 Vali Acc: 0.681 Test Loss: 1.269 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.2150094509124756
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.266 Vali Acc: 0.681 Test Loss: 1.266 Test Acc: 0.681
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.936548948287964
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.274 Vali Acc: 0.678 Test Loss: 1.274 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.956926107406616
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.678 Test Loss: 1.288 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.1304636001586914
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.299 Vali Acc: 0.678 Test Loss: 1.299 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.009070873260498
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.308 Vali Acc: 0.681 Test Loss: 1.308 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.6875
model parameter : 1378568
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.727686405181885
Epoch: 1, Steps: 8 | Train Loss: 2.069 Vali Loss: 1.960 Vali Acc: 0.300 Test Loss: 1.960 Test Acc: 0.300
Validation loss decreased (inf --> -0.299980).  Saving model ...
Epoch: 2 cost time: 3.702868938446045
Epoch: 2, Steps: 8 | Train Loss: 1.750 Vali Loss: 1.634 Vali Acc: 0.466 Test Loss: 1.634 Test Acc: 0.466
Validation loss decreased (-0.299980 --> -0.465609).  Saving model ...
Epoch: 3 cost time: 3.2801949977874756
Epoch: 3, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.407 Vali Acc: 0.512 Test Loss: 1.407 Test Acc: 0.512
Validation loss decreased (-0.465609 --> -0.512486).  Saving model ...
Epoch: 4 cost time: 3.2944490909576416
Epoch: 4, Steps: 8 | Train Loss: 0.882 Vali Loss: 1.232 Vali Acc: 0.553 Test Loss: 1.232 Test Acc: 0.553
Validation loss decreased (-0.512486 --> -0.553113).  Saving model ...
Epoch: 5 cost time: 3.2290639877319336
Epoch: 5, Steps: 8 | Train Loss: 0.645 Vali Loss: 1.175 Vali Acc: 0.569 Test Loss: 1.175 Test Acc: 0.569
Validation loss decreased (-0.553113 --> -0.568738).  Saving model ...
Epoch: 6 cost time: 3.2678236961364746
Epoch: 6, Steps: 8 | Train Loss: 0.424 Vali Loss: 1.117 Vali Acc: 0.606 Test Loss: 1.117 Test Acc: 0.606
Validation loss decreased (-0.568738 --> -0.606239).  Saving model ...
Epoch: 7 cost time: 2.8162126541137695
Epoch: 7, Steps: 8 | Train Loss: 0.289 Vali Loss: 1.180 Vali Acc: 0.584 Test Loss: 1.180 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.240725517272949
Epoch: 8, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.220 Vali Acc: 0.603 Test Loss: 1.220 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.245225429534912
Epoch: 9, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.259 Vali Acc: 0.594 Test Loss: 1.259 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.887213706970215
Epoch: 10, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.277 Vali Acc: 0.625 Test Loss: 1.277 Test Acc: 0.625
Validation loss decreased (-0.606239 --> -0.624987).  Saving model ...
Epoch: 11 cost time: 2.724726915359497
Epoch: 11, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.352 Vali Acc: 0.584 Test Loss: 1.352 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7207202911376953
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.302 Vali Acc: 0.619 Test Loss: 1.302 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4516959190368652
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.477 Vali Acc: 0.591 Test Loss: 1.477 Test Acc: 0.591
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1677489280700684
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.424 Vali Acc: 0.609 Test Loss: 1.424 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.119079351425171
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.494 Vali Acc: 0.591 Test Loss: 1.494 Test Acc: 0.591
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.10858416557312
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.392 Vali Acc: 0.631 Test Loss: 1.392 Test Acc: 0.631
Validation loss decreased (-0.624987 --> -0.631236).  Saving model ...
Epoch: 17 cost time: 3.0182669162750244
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.405 Vali Acc: 0.628 Test Loss: 1.405 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.362928628921509
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.382 Vali Acc: 0.631 Test Loss: 1.382 Test Acc: 0.631
Validation loss decreased (-0.631236 --> -0.631236).  Saving model ...
Epoch: 19 cost time: 3.2928526401519775
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.377 Vali Acc: 0.628 Test Loss: 1.377 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.958998441696167
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.381 Vali Acc: 0.631 Test Loss: 1.381 Test Acc: 0.631
Validation loss decreased (-0.631236 --> -0.631236).  Saving model ...
Epoch: 21 cost time: 3.3704354763031006
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.373 Vali Acc: 0.637 Test Loss: 1.373 Test Acc: 0.637
Validation loss decreased (-0.631236 --> -0.637486).  Saving model ...
Epoch: 22 cost time: 3.328782558441162
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.372 Vali Acc: 0.647 Test Loss: 1.372 Test Acc: 0.647
Validation loss decreased (-0.637486 --> -0.646861).  Saving model ...
Epoch: 23 cost time: 3.1906094551086426
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.378 Vali Acc: 0.641 Test Loss: 1.378 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2745370864868164
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.637 Test Loss: 1.379 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.9829742908477783
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.641 Test Loss: 1.386 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.108642578125
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.382 Vali Acc: 0.650 Test Loss: 1.382 Test Acc: 0.650
Validation loss decreased (-0.646861 --> -0.649986).  Saving model ...
Epoch: 27 cost time: 3.0629444122314453
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.403 Vali Acc: 0.647 Test Loss: 1.403 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.21518611907959
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.644 Test Loss: 1.401 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.528096914291382
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.402 Vali Acc: 0.647 Test Loss: 1.402 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.3724136352539062
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.396 Vali Acc: 0.659 Test Loss: 1.396 Test Acc: 0.659
Validation loss decreased (-0.649986 --> -0.659361).  Saving model ...
Epoch: 31 cost time: 3.2850728034973145
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.388 Vali Acc: 0.662 Test Loss: 1.388 Test Acc: 0.662
Validation loss decreased (-0.659361 --> -0.662486).  Saving model ...
Epoch: 32 cost time: 3.079699754714966
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.656 Test Loss: 1.390 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.3557252883911133
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.650 Test Loss: 1.401 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.5372676849365234
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.414 Vali Acc: 0.653 Test Loss: 1.414 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.431351900100708
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.407 Vali Acc: 0.659 Test Loss: 1.407 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.208754777908325
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.653 Test Loss: 1.406 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.2421884536743164
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.659 Test Loss: 1.400 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.9561405181884766
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.396 Vali Acc: 0.656 Test Loss: 1.396 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.036383867263794
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.659 Test Loss: 1.396 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.965611219406128
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.395 Vali Acc: 0.662 Test Loss: 1.395 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.32181715965271
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.662 Test Loss: 1.405 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.6625
model parameter : 1378568
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.055924415588379
Epoch: 1, Steps: 8 | Train Loss: 2.099 Vali Loss: 2.043 Vali Acc: 0.203 Test Loss: 2.043 Test Acc: 0.203
Validation loss decreased (inf --> -0.203105).  Saving model ...
Epoch: 2 cost time: 2.942232608795166
Epoch: 2, Steps: 8 | Train Loss: 1.879 Vali Loss: 1.844 Vali Acc: 0.356 Test Loss: 1.844 Test Acc: 0.356
Validation loss decreased (-0.203105 --> -0.356232).  Saving model ...
Epoch: 3 cost time: 3.2154335975646973
Epoch: 3, Steps: 8 | Train Loss: 1.583 Vali Loss: 1.696 Vali Acc: 0.409 Test Loss: 1.696 Test Acc: 0.409
Validation loss decreased (-0.356232 --> -0.409358).  Saving model ...
Epoch: 4 cost time: 2.7453386783599854
Epoch: 4, Steps: 8 | Train Loss: 1.159 Vali Loss: 1.556 Vali Acc: 0.388 Test Loss: 1.556 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.746534824371338
Epoch: 5, Steps: 8 | Train Loss: 0.888 Vali Loss: 1.476 Vali Acc: 0.487 Test Loss: 1.476 Test Acc: 0.487
Validation loss decreased (-0.409358 --> -0.487485).  Saving model ...
Epoch: 6 cost time: 2.910808801651001
Epoch: 6, Steps: 8 | Train Loss: 0.638 Vali Loss: 1.404 Vali Acc: 0.497 Test Loss: 1.404 Test Acc: 0.497
Validation loss decreased (-0.487485 --> -0.496861).  Saving model ...
Epoch: 7 cost time: 3.022000312805176
Epoch: 7, Steps: 8 | Train Loss: 0.476 Vali Loss: 1.454 Vali Acc: 0.447 Test Loss: 1.454 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.078855514526367
Epoch: 8, Steps: 8 | Train Loss: 0.336 Vali Loss: 1.455 Vali Acc: 0.494 Test Loss: 1.455 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9157063961029053
Epoch: 9, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.571 Vali Acc: 0.409 Test Loss: 1.571 Test Acc: 0.409
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7743043899536133
Epoch: 10, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.551 Vali Acc: 0.475 Test Loss: 1.551 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.722064256668091
Epoch: 11, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.495 Vali Acc: 0.475 Test Loss: 1.495 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1657822132110596
Epoch: 12, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.679 Vali Acc: 0.497 Test Loss: 1.679 Test Acc: 0.497
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9064431190490723
Epoch: 13, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.741 Vali Acc: 0.450 Test Loss: 1.741 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.3612916469573975
Epoch: 14, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.572 Vali Acc: 0.531 Test Loss: 1.572 Test Acc: 0.531
Validation loss decreased (-0.496861 --> -0.531234).  Saving model ...
Epoch: 15 cost time: 3.2319397926330566
Epoch: 15, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.745 Vali Acc: 0.491 Test Loss: 1.745 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1444790363311768
Epoch: 16, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.686 Vali Acc: 0.519 Test Loss: 1.686 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3549487590789795
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.933 Vali Acc: 0.463 Test Loss: 1.933 Test Acc: 0.463
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.049731969833374
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.575 Vali Acc: 0.544 Test Loss: 1.575 Test Acc: 0.544
Validation loss decreased (-0.531234 --> -0.543734).  Saving model ...
Epoch: 19 cost time: 3.3748726844787598
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.988 Vali Acc: 0.497 Test Loss: 1.988 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4160001277923584
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.644 Vali Acc: 0.556 Test Loss: 1.644 Test Acc: 0.556
Validation loss decreased (-0.543734 --> -0.556234).  Saving model ...
Epoch: 21 cost time: 3.373262882232666
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.645 Vali Acc: 0.537 Test Loss: 1.645 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.049560308456421
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.803 Vali Acc: 0.503 Test Loss: 1.803 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0847418308258057
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.692 Vali Acc: 0.544 Test Loss: 1.692 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.9620232582092285
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.655 Vali Acc: 0.562 Test Loss: 1.655 Test Acc: 0.562
Validation loss decreased (-0.556234 --> -0.562483).  Saving model ...
Epoch: 25 cost time: 3.1193413734436035
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.728 Vali Acc: 0.544 Test Loss: 1.728 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2760210037231445
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.706 Vali Acc: 0.547 Test Loss: 1.706 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.1673836708068848
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.700 Vali Acc: 0.553 Test Loss: 1.700 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.125183343887329
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.684 Vali Acc: 0.575 Test Loss: 1.684 Test Acc: 0.575
Validation loss decreased (-0.562483 --> -0.574983).  Saving model ...
Epoch: 29 cost time: 3.36013126373291
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.748 Vali Acc: 0.541 Test Loss: 1.748 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.289797306060791
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.769 Vali Acc: 0.547 Test Loss: 1.769 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.922887086868286
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.657 Vali Acc: 0.578 Test Loss: 1.657 Test Acc: 0.578
Validation loss decreased (-0.574983 --> -0.578108).  Saving model ...
Epoch: 32 cost time: 3.460052490234375
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.650 Vali Acc: 0.588 Test Loss: 1.650 Test Acc: 0.588
Validation loss decreased (-0.578108 --> -0.587483).  Saving model ...
Epoch: 33 cost time: 3.368558406829834
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.689 Vali Acc: 0.559 Test Loss: 1.689 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.486550807952881
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.720 Vali Acc: 0.559 Test Loss: 1.720 Test Acc: 0.559
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.0978024005889893
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.711 Vali Acc: 0.569 Test Loss: 1.711 Test Acc: 0.569
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.308269739151001
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.710 Vali Acc: 0.581 Test Loss: 1.710 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.2585108280181885
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.709 Vali Acc: 0.581 Test Loss: 1.709 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.405334234237671
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.562 Test Loss: 1.719 Test Acc: 0.562
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.4101388454437256
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.727 Vali Acc: 0.569 Test Loss: 1.727 Test Acc: 0.569
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.988734483718872
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.711 Vali Acc: 0.575 Test Loss: 1.711 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.4399068355560303
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.578 Test Loss: 1.698 Test Acc: 0.578
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.2051732540130615
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.685 Vali Acc: 0.594 Test Loss: 1.685 Test Acc: 0.594
Validation loss decreased (-0.587483 --> -0.593733).  Saving model ...
Epoch: 43 cost time: 3.4270567893981934
Epoch: 43, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.588 Test Loss: 1.690 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.00260329246521
Epoch: 44, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.594 Test Loss: 1.689 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.2730824947357178
Epoch: 45, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.597 Test Loss: 1.690 Test Acc: 0.597
Validation loss decreased (-0.593733 --> -0.596858).  Saving model ...
Epoch: 46 cost time: 3.3127496242523193
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.706 Vali Acc: 0.591 Test Loss: 1.706 Test Acc: 0.591
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.4892547130584717
Epoch: 47, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.712 Vali Acc: 0.594 Test Loss: 1.712 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.248201847076416
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.594 Test Loss: 1.715 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.355044364929199
Epoch: 49, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.591 Test Loss: 1.724 Test Acc: 0.591
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.192307472229004
Epoch: 50, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.720 Vali Acc: 0.591 Test Loss: 1.720 Test Acc: 0.591
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.4047741889953613
Epoch: 51, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.708 Vali Acc: 0.600 Test Loss: 1.708 Test Acc: 0.600
Validation loss decreased (-0.596858 --> -0.599983).  Saving model ...
Epoch: 52 cost time: 3.2445871829986572
Epoch: 52, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.695 Vali Acc: 0.609 Test Loss: 1.695 Test Acc: 0.609
Validation loss decreased (-0.599983 --> -0.609358).  Saving model ...
Epoch: 53 cost time: 3.2909903526306152
Epoch: 53, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.679 Vali Acc: 0.616 Test Loss: 1.679 Test Acc: 0.616
Validation loss decreased (-0.609358 --> -0.615608).  Saving model ...
Epoch: 54 cost time: 3.847727060317993
Epoch: 54, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.613 Test Loss: 1.691 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.4712932109832764
Epoch: 55, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.613 Test Loss: 1.702 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.234997272491455
Epoch: 56, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.723 Vali Acc: 0.600 Test Loss: 1.723 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.2117133140563965
Epoch: 57, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.600 Test Loss: 1.727 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.635371208190918
Epoch: 58, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.600 Test Loss: 1.717 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.34332537651062
Epoch: 59, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.600 Test Loss: 1.717 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.1012039184570312
Epoch: 60, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.616 Test Loss: 1.731 Test Acc: 0.616
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 2.8565890789031982
Epoch: 61, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.606 Test Loss: 1.756 Test Acc: 0.606
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 3.669473171234131
Epoch: 62, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.754 Vali Acc: 0.609 Test Loss: 1.754 Test Acc: 0.609
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 3.4932618141174316
Epoch: 63, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.729 Vali Acc: 0.625 Test Loss: 1.729 Test Acc: 0.625
Validation loss decreased (-0.615608 --> -0.624983).  Saving model ...
Epoch: 64 cost time: 3.5190656185150146
Epoch: 64, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.719 Vali Acc: 0.616 Test Loss: 1.719 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 3.256364583969116
Epoch: 65, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.613 Test Loss: 1.721 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 3.070976495742798
Epoch: 66, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.719 Vali Acc: 0.606 Test Loss: 1.719 Test Acc: 0.606
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 3.475921154022217
Epoch: 67, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.709 Vali Acc: 0.622 Test Loss: 1.709 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 3.3590686321258545
Epoch: 68, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.703 Vali Acc: 0.625 Test Loss: 1.703 Test Acc: 0.625
Validation loss decreased (-0.624983 --> -0.624983).  Saving model ...
Epoch: 69 cost time: 3.466325283050537
Epoch: 69, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.698 Vali Acc: 0.631 Test Loss: 1.698 Test Acc: 0.631
Validation loss decreased (-0.624983 --> -0.631233).  Saving model ...
Epoch: 70 cost time: 3.3084161281585693
Epoch: 70, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.628 Test Loss: 1.706 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 3.4138777256011963
Epoch: 71, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.616 Test Loss: 1.727 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 3.4412176609039307
Epoch: 72, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.619 Test Loss: 1.734 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 3.0255963802337646
Epoch: 73, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.628 Test Loss: 1.718 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 3.1765663623809814
Epoch: 74, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.712 Vali Acc: 0.625 Test Loss: 1.712 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 3.471734046936035
Epoch: 75, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.710 Vali Acc: 0.634 Test Loss: 1.710 Test Acc: 0.634
Validation loss decreased (-0.631233 --> -0.634358).  Saving model ...
Epoch: 76 cost time: 3.1974050998687744
Epoch: 76, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.711 Vali Acc: 0.628 Test Loss: 1.711 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 3.548558235168457
Epoch: 77, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.723 Vali Acc: 0.628 Test Loss: 1.723 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 3.1144306659698486
Epoch: 78, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.707 Vali Acc: 0.631 Test Loss: 1.707 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 3.8860671520233154
Epoch: 79, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.690 Vali Acc: 0.641 Test Loss: 1.690 Test Acc: 0.641
Validation loss decreased (-0.634358 --> -0.640608).  Saving model ...
Epoch: 80 cost time: 3.4676496982574463
Epoch: 80, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.690 Vali Acc: 0.641 Test Loss: 1.690 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 3.543048620223999
Epoch: 81, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.698 Vali Acc: 0.634 Test Loss: 1.698 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 2.944148540496826
Epoch: 82, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.714 Vali Acc: 0.637 Test Loss: 1.714 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 3.2163283824920654
Epoch: 83, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.722 Vali Acc: 0.634 Test Loss: 1.722 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 3.6557393074035645
Epoch: 84, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.634 Test Loss: 1.725 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 3.3612165451049805
Epoch: 85, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.726 Vali Acc: 0.634 Test Loss: 1.726 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 3.1824843883514404
Epoch: 86, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.724 Vali Acc: 0.637 Test Loss: 1.724 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 3.0150132179260254
Epoch: 87, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.728 Vali Acc: 0.634 Test Loss: 1.728 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 3.28747296333313
Epoch: 88, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.631 Test Loss: 1.731 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 3.077641010284424
Epoch: 89, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.631 Test Loss: 1.731 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.640625
model parameter : 1378568
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.129452705383301
Epoch: 1, Steps: 8 | Train Loss: 2.094 Vali Loss: 2.066 Vali Acc: 0.166 Test Loss: 2.066 Test Acc: 0.166
Validation loss decreased (inf --> -0.165604).  Saving model ...
Epoch: 2 cost time: 3.157031297683716
Epoch: 2, Steps: 8 | Train Loss: 1.925 Vali Loss: 1.959 Vali Acc: 0.297 Test Loss: 1.959 Test Acc: 0.297
Validation loss decreased (-0.165604 --> -0.296855).  Saving model ...
Epoch: 3 cost time: 3.100874662399292
Epoch: 3, Steps: 8 | Train Loss: 1.721 Vali Loss: 1.845 Vali Acc: 0.369 Test Loss: 1.845 Test Acc: 0.369
Validation loss decreased (-0.296855 --> -0.368732).  Saving model ...
Epoch: 4 cost time: 3.5191164016723633
Epoch: 4, Steps: 8 | Train Loss: 1.362 Vali Loss: 1.783 Vali Acc: 0.291 Test Loss: 1.783 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.612905502319336
Epoch: 5, Steps: 8 | Train Loss: 1.072 Vali Loss: 1.658 Vali Acc: 0.359 Test Loss: 1.658 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0607352256774902
Epoch: 6, Steps: 8 | Train Loss: 0.770 Vali Loss: 1.551 Vali Acc: 0.394 Test Loss: 1.551 Test Acc: 0.394
Validation loss decreased (-0.368732 --> -0.393734).  Saving model ...
Epoch: 7 cost time: 2.9832754135131836
Epoch: 7, Steps: 8 | Train Loss: 0.603 Vali Loss: 1.631 Vali Acc: 0.341 Test Loss: 1.631 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.332258462905884
Epoch: 8, Steps: 8 | Train Loss: 0.435 Vali Loss: 1.474 Vali Acc: 0.478 Test Loss: 1.474 Test Acc: 0.478
Validation loss decreased (-0.393734 --> -0.478110).  Saving model ...
Epoch: 9 cost time: 3.1632566452026367
Epoch: 9, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.549 Vali Acc: 0.362 Test Loss: 1.549 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8776659965515137
Epoch: 10, Steps: 8 | Train Loss: 0.276 Vali Loss: 1.614 Vali Acc: 0.366 Test Loss: 1.614 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1705615520477295
Epoch: 11, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.522 Vali Acc: 0.403 Test Loss: 1.522 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.48684024810791
Epoch: 12, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.727 Vali Acc: 0.350 Test Loss: 1.727 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.304755210876465
Epoch: 13, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.845 Vali Acc: 0.375 Test Loss: 1.845 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.110489845275879
Epoch: 14, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.388 Vali Acc: 0.503 Test Loss: 1.388 Test Acc: 0.503
Validation loss decreased (-0.478110 --> -0.503111).  Saving model ...
Epoch: 15 cost time: 2.8666462898254395
Epoch: 15, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.840 Vali Acc: 0.378 Test Loss: 1.840 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3758704662323
Epoch: 16, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.920 Vali Acc: 0.397 Test Loss: 1.920 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3136658668518066
Epoch: 17, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.973 Vali Acc: 0.369 Test Loss: 1.973 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1178674697875977
Epoch: 18, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.847 Vali Acc: 0.444 Test Loss: 1.847 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.166868209838867
Epoch: 19, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.372 Vali Acc: 0.338 Test Loss: 2.372 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.2875113487243652
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.698 Vali Acc: 0.500 Test Loss: 1.698 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.2458057403564453
Epoch: 21, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.075 Vali Acc: 0.406 Test Loss: 2.075 Test Acc: 0.406
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9732444286346436
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.924 Vali Acc: 0.478 Test Loss: 1.924 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.046055555343628
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.904 Vali Acc: 0.475 Test Loss: 1.904 Test Acc: 0.475
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.179354667663574
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.910 Vali Acc: 0.491 Test Loss: 1.910 Test Acc: 0.491
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.503125
model parameter : 1378568
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.90859055519104
Epoch: 1, Steps: 8 | Train Loss: 2.109 Vali Loss: 2.079 Vali Acc: 0.128 Test Loss: 2.079 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 3.458700180053711
Epoch: 2, Steps: 8 | Train Loss: 1.939 Vali Loss: 1.983 Vali Acc: 0.275 Test Loss: 1.983 Test Acc: 0.275
Validation loss decreased (-0.128104 --> -0.274980).  Saving model ...
Epoch: 3 cost time: 3.1416051387786865
Epoch: 3, Steps: 8 | Train Loss: 1.721 Vali Loss: 1.904 Vali Acc: 0.241 Test Loss: 1.904 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5233418941497803
Epoch: 4, Steps: 8 | Train Loss: 1.416 Vali Loss: 1.811 Vali Acc: 0.312 Test Loss: 1.811 Test Acc: 0.312
Validation loss decreased (-0.274980 --> -0.312482).  Saving model ...
Epoch: 5 cost time: 3.2844319343566895
Epoch: 5, Steps: 8 | Train Loss: 1.083 Vali Loss: 1.707 Vali Acc: 0.394 Test Loss: 1.707 Test Acc: 0.394
Validation loss decreased (-0.312482 --> -0.393733).  Saving model ...
Epoch: 6 cost time: 3.128257989883423
Epoch: 6, Steps: 8 | Train Loss: 0.798 Vali Loss: 1.574 Vali Acc: 0.456 Test Loss: 1.574 Test Acc: 0.456
Validation loss decreased (-0.393733 --> -0.456234).  Saving model ...
Epoch: 7 cost time: 3.3645780086517334
Epoch: 7, Steps: 8 | Train Loss: 0.620 Vali Loss: 1.588 Vali Acc: 0.334 Test Loss: 1.588 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.30657958984375
Epoch: 8, Steps: 8 | Train Loss: 0.446 Vali Loss: 1.430 Vali Acc: 0.494 Test Loss: 1.430 Test Acc: 0.494
Validation loss decreased (-0.456234 --> -0.493736).  Saving model ...
Epoch: 9 cost time: 2.8535172939300537
Epoch: 9, Steps: 8 | Train Loss: 0.347 Vali Loss: 1.462 Vali Acc: 0.425 Test Loss: 1.462 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.122561454772949
Epoch: 10, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.376 Vali Acc: 0.434 Test Loss: 1.376 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3896961212158203
Epoch: 11, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.339 Vali Acc: 0.522 Test Loss: 1.339 Test Acc: 0.522
Validation loss decreased (-0.493736 --> -0.521862).  Saving model ...
Epoch: 12 cost time: 3.3804984092712402
Epoch: 12, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.431 Vali Acc: 0.453 Test Loss: 1.431 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.348037004470825
Epoch: 13, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.411 Vali Acc: 0.481 Test Loss: 1.411 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.889165163040161
Epoch: 14, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.248 Vali Acc: 0.534 Test Loss: 1.248 Test Acc: 0.534
Validation loss decreased (-0.521862 --> -0.534363).  Saving model ...
Epoch: 15 cost time: 3.2335801124572754
Epoch: 15, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.467 Vali Acc: 0.491 Test Loss: 1.467 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.287776470184326
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.468 Vali Acc: 0.434 Test Loss: 1.468 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.889305830001831
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.458 Vali Acc: 0.516 Test Loss: 1.458 Test Acc: 0.516
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1159534454345703
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.697 Vali Acc: 0.459 Test Loss: 1.697 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.574350118637085
Epoch: 19, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.540 Vali Acc: 0.494 Test Loss: 1.540 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.0595967769622803
Epoch: 20, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.377 Vali Acc: 0.531 Test Loss: 1.377 Test Acc: 0.531
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.317397356033325
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.660 Vali Acc: 0.491 Test Loss: 1.660 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.011615753173828
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.703 Vali Acc: 0.500 Test Loss: 1.703 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.713425397872925
Epoch: 23, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.764 Vali Acc: 0.481 Test Loss: 1.764 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.330436944961548
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.697 Vali Acc: 0.522 Test Loss: 1.697 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.534375
model parameter : 1378568
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.029268503189087
Epoch: 1, Steps: 8 | Train Loss: 2.090 Vali Loss: 2.124 Vali Acc: 0.125 Test Loss: 2.124 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 3.3052315711975098
Epoch: 2, Steps: 8 | Train Loss: 1.915 Vali Loss: 2.025 Vali Acc: 0.125 Test Loss: 2.025 Test Acc: 0.125
Validation loss decreased (-0.124979 --> -0.124980).  Saving model ...
Epoch: 3 cost time: 3.1342873573303223
Epoch: 3, Steps: 8 | Train Loss: 1.696 Vali Loss: 1.938 Vali Acc: 0.200 Test Loss: 1.938 Test Acc: 0.200
Validation loss decreased (-0.124980 --> -0.199981).  Saving model ...
Epoch: 4 cost time: 3.0700230598449707
Epoch: 4, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.826 Vali Acc: 0.341 Test Loss: 1.826 Test Acc: 0.341
Validation loss decreased (-0.199981 --> -0.340607).  Saving model ...
Epoch: 5 cost time: 3.07944393157959
Epoch: 5, Steps: 8 | Train Loss: 1.006 Vali Loss: 1.732 Vali Acc: 0.381 Test Loss: 1.732 Test Acc: 0.381
Validation loss decreased (-0.340607 --> -0.381233).  Saving model ...
Epoch: 6 cost time: 3.4348158836364746
Epoch: 6, Steps: 8 | Train Loss: 0.743 Vali Loss: 1.577 Vali Acc: 0.519 Test Loss: 1.577 Test Acc: 0.519
Validation loss decreased (-0.381233 --> -0.518734).  Saving model ...
Epoch: 7 cost time: 3.320831060409546
Epoch: 7, Steps: 8 | Train Loss: 0.562 Vali Loss: 1.524 Vali Acc: 0.412 Test Loss: 1.524 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.050196409225464
Epoch: 8, Steps: 8 | Train Loss: 0.410 Vali Loss: 1.354 Vali Acc: 0.562 Test Loss: 1.354 Test Acc: 0.562
Validation loss decreased (-0.518734 --> -0.562486).  Saving model ...
Epoch: 9 cost time: 2.9837160110473633
Epoch: 9, Steps: 8 | Train Loss: 0.308 Vali Loss: 1.411 Vali Acc: 0.475 Test Loss: 1.411 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.271311044692993
Epoch: 10, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.379 Vali Acc: 0.487 Test Loss: 1.379 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.388488292694092
Epoch: 11, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.452 Vali Acc: 0.519 Test Loss: 1.452 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2276971340179443
Epoch: 12, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.375 Vali Acc: 0.525 Test Loss: 1.375 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0715205669403076
Epoch: 13, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.421 Vali Acc: 0.519 Test Loss: 1.421 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.955354690551758
Epoch: 14, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.355 Vali Acc: 0.550 Test Loss: 1.355 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.892465829849243
Epoch: 15, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.512 Vali Acc: 0.522 Test Loss: 1.512 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.376345634460449
Epoch: 16, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.343 Vali Acc: 0.534 Test Loss: 1.343 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.661914110183716
Epoch: 17, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.498 Vali Acc: 0.506 Test Loss: 1.498 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.067387819290161
Epoch: 18, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.624 Vali Acc: 0.494 Test Loss: 1.624 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5625
model parameter : 1378568
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.530517816543579
Epoch: 1, Steps: 8 | Train Loss: 2.096 Vali Loss: 2.084 Vali Acc: 0.144 Test Loss: 2.084 Test Acc: 0.144
Validation loss decreased (inf --> -0.143729).  Saving model ...
Epoch: 2 cost time: 3.0590338706970215
Epoch: 2, Steps: 8 | Train Loss: 1.973 Vali Loss: 1.971 Vali Acc: 0.291 Test Loss: 1.971 Test Acc: 0.291
Validation loss decreased (-0.143729 --> -0.290605).  Saving model ...
Epoch: 3 cost time: 3.2742371559143066
Epoch: 3, Steps: 8 | Train Loss: 1.664 Vali Loss: 1.799 Vali Acc: 0.441 Test Loss: 1.799 Test Acc: 0.441
Validation loss decreased (-0.290605 --> -0.440607).  Saving model ...
Epoch: 4 cost time: 3.446288585662842
Epoch: 4, Steps: 8 | Train Loss: 1.410 Vali Loss: 1.634 Vali Acc: 0.466 Test Loss: 1.634 Test Acc: 0.466
Validation loss decreased (-0.440607 --> -0.465609).  Saving model ...
Epoch: 5 cost time: 3.1447150707244873
Epoch: 5, Steps: 8 | Train Loss: 1.021 Vali Loss: 1.477 Vali Acc: 0.494 Test Loss: 1.477 Test Acc: 0.494
Validation loss decreased (-0.465609 --> -0.493735).  Saving model ...
Epoch: 6 cost time: 3.1217565536499023
Epoch: 6, Steps: 8 | Train Loss: 0.759 Vali Loss: 1.371 Vali Acc: 0.481 Test Loss: 1.371 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.121851921081543
Epoch: 7, Steps: 8 | Train Loss: 0.576 Vali Loss: 1.329 Vali Acc: 0.491 Test Loss: 1.329 Test Acc: 0.491
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8955986499786377
Epoch: 8, Steps: 8 | Train Loss: 0.447 Vali Loss: 1.353 Vali Acc: 0.472 Test Loss: 1.353 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.250973701477051
Epoch: 9, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.479 Vali Acc: 0.487 Test Loss: 1.479 Test Acc: 0.487
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.17030668258667
Epoch: 10, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.498 Vali Acc: 0.506 Test Loss: 1.498 Test Acc: 0.506
Validation loss decreased (-0.493735 --> -0.506235).  Saving model ...
Epoch: 11 cost time: 2.8539867401123047
Epoch: 11, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.734 Vali Acc: 0.469 Test Loss: 1.734 Test Acc: 0.469
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.303516149520874
Epoch: 12, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.820 Vali Acc: 0.497 Test Loss: 1.820 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3346431255340576
Epoch: 13, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.884 Vali Acc: 0.453 Test Loss: 1.884 Test Acc: 0.453
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.2343361377716064
Epoch: 14, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.912 Vali Acc: 0.487 Test Loss: 1.912 Test Acc: 0.487
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.2659716606140137
Epoch: 15, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.928 Vali Acc: 0.438 Test Loss: 1.928 Test Acc: 0.438
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.03208589553833
Epoch: 16, Steps: 8 | Train Loss: 0.046 Vali Loss: 2.154 Vali Acc: 0.425 Test Loss: 2.154 Test Acc: 0.425
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.0057992935180664
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.331 Vali Acc: 0.447 Test Loss: 2.331 Test Acc: 0.447
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.006256341934204
Epoch: 18, Steps: 8 | Train Loss: 0.029 Vali Loss: 2.219 Vali Acc: 0.422 Test Loss: 2.219 Test Acc: 0.422
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8858940601348877
Epoch: 19, Steps: 8 | Train Loss: 0.027 Vali Loss: 2.295 Vali Acc: 0.438 Test Loss: 2.295 Test Acc: 0.438
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.077162981033325
Epoch: 20, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.286 Vali Acc: 0.444 Test Loss: 2.286 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.50625
model parameter : 1378568
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.882500886917114
Epoch: 1, Steps: 8 | Train Loss: 2.113 Vali Loss: 2.097 Vali Acc: 0.097 Test Loss: 2.097 Test Acc: 0.097
Validation loss decreased (inf --> -0.096854).  Saving model ...
Epoch: 2 cost time: 3.1589856147766113
Epoch: 2, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.982 Vali Acc: 0.275 Test Loss: 1.982 Test Acc: 0.275
Validation loss decreased (-0.096854 --> -0.274980).  Saving model ...
Epoch: 3 cost time: 3.0047061443328857
Epoch: 3, Steps: 8 | Train Loss: 1.763 Vali Loss: 1.809 Vali Acc: 0.416 Test Loss: 1.809 Test Acc: 0.416
Validation loss decreased (-0.274980 --> -0.415607).  Saving model ...
Epoch: 4 cost time: 3.1529011726379395
Epoch: 4, Steps: 8 | Train Loss: 1.458 Vali Loss: 1.628 Vali Acc: 0.403 Test Loss: 1.628 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.27308988571167
Epoch: 5, Steps: 8 | Train Loss: 1.146 Vali Loss: 1.472 Vali Acc: 0.506 Test Loss: 1.472 Test Acc: 0.506
Validation loss decreased (-0.415607 --> -0.506235).  Saving model ...
Epoch: 6 cost time: 3.3142709732055664
Epoch: 6, Steps: 8 | Train Loss: 0.877 Vali Loss: 1.420 Vali Acc: 0.456 Test Loss: 1.420 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.941709280014038
Epoch: 7, Steps: 8 | Train Loss: 0.693 Vali Loss: 1.430 Vali Acc: 0.472 Test Loss: 1.430 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.021505117416382
Epoch: 8, Steps: 8 | Train Loss: 0.530 Vali Loss: 1.548 Vali Acc: 0.450 Test Loss: 1.548 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.969285249710083
Epoch: 9, Steps: 8 | Train Loss: 0.365 Vali Loss: 1.784 Vali Acc: 0.478 Test Loss: 1.784 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.14089035987854
Epoch: 10, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.858 Vali Acc: 0.475 Test Loss: 1.858 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7299275398254395
Epoch: 11, Steps: 8 | Train Loss: 0.212 Vali Loss: 2.115 Vali Acc: 0.453 Test Loss: 2.115 Test Acc: 0.453
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9385361671447754
Epoch: 12, Steps: 8 | Train Loss: 0.185 Vali Loss: 2.225 Vali Acc: 0.434 Test Loss: 2.225 Test Acc: 0.434
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.416386604309082
Epoch: 13, Steps: 8 | Train Loss: 0.134 Vali Loss: 2.133 Vali Acc: 0.416 Test Loss: 2.133 Test Acc: 0.416
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.0889742374420166
Epoch: 14, Steps: 8 | Train Loss: 0.083 Vali Loss: 2.252 Vali Acc: 0.378 Test Loss: 2.252 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.229437828063965
Epoch: 15, Steps: 8 | Train Loss: 0.075 Vali Loss: 2.292 Vali Acc: 0.406 Test Loss: 2.292 Test Acc: 0.406
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.50625
model parameter : 1378568
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.367794513702393
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 1.778 Vali Acc: 0.403 Test Loss: 1.778 Test Acc: 0.403
Validation loss decreased (inf --> -0.403107).  Saving model ...
Epoch: 2 cost time: 2.7528839111328125
Epoch: 2, Steps: 8 | Train Loss: 1.482 Vali Loss: 1.117 Vali Acc: 0.681 Test Loss: 1.117 Test Acc: 0.681
Validation loss decreased (-0.403107 --> -0.681239).  Saving model ...
Epoch: 3 cost time: 2.862945318222046
Epoch: 3, Steps: 8 | Train Loss: 0.787 Vali Loss: 0.815 Vali Acc: 0.722 Test Loss: 0.815 Test Acc: 0.722
Validation loss decreased (-0.681239 --> -0.721867).  Saving model ...
Epoch: 4 cost time: 2.9616715908050537
Epoch: 4, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.748 Vali Acc: 0.728 Test Loss: 0.748 Test Acc: 0.728
Validation loss decreased (-0.721867 --> -0.728118).  Saving model ...
Epoch: 5 cost time: 2.7999632358551025
Epoch: 5, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.776 Vali Acc: 0.741 Test Loss: 0.776 Test Acc: 0.741
Validation loss decreased (-0.728118 --> -0.740617).  Saving model ...
Epoch: 6 cost time: 3.058105230331421
Epoch: 6, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.781 Vali Acc: 0.766 Test Loss: 0.781 Test Acc: 0.766
Validation loss decreased (-0.740617 --> -0.765617).  Saving model ...
Epoch: 7 cost time: 2.791590929031372
Epoch: 7, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.779 Vali Acc: 0.747 Test Loss: 0.779 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0850255489349365
Epoch: 8, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.906 Vali Acc: 0.741 Test Loss: 0.906 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1804397106170654
Epoch: 9, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.977 Vali Acc: 0.744 Test Loss: 0.977 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.958655595779419
Epoch: 10, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.981 Vali Acc: 0.741 Test Loss: 0.981 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.950828790664673
Epoch: 11, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.973 Vali Acc: 0.766 Test Loss: 0.973 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.9823403358459473
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.037 Vali Acc: 0.747 Test Loss: 1.037 Test Acc: 0.747
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.644965171813965
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.045 Vali Acc: 0.756 Test Loss: 1.045 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.1117374897003174
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.035 Vali Acc: 0.759 Test Loss: 1.035 Test Acc: 0.759
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.9905784130096436
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.030 Vali Acc: 0.769 Test Loss: 1.030 Test Acc: 0.769
Validation loss decreased (-0.765617 --> -0.768740).  Saving model ...
Epoch: 16 cost time: 2.9553487300872803
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.033 Vali Acc: 0.769 Test Loss: 1.033 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8742048740386963
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.037 Vali Acc: 0.766 Test Loss: 1.037 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7091710567474365
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.042 Vali Acc: 0.762 Test Loss: 1.042 Test Acc: 0.762
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0438120365142822
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.042 Vali Acc: 0.762 Test Loss: 1.042 Test Acc: 0.762
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.122992515563965
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.048 Vali Acc: 0.769 Test Loss: 1.048 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.3751676082611084
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.049 Vali Acc: 0.766 Test Loss: 1.049 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.550670862197876
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.048 Vali Acc: 0.766 Test Loss: 1.048 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.3398542404174805
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.051 Vali Acc: 0.772 Test Loss: 1.051 Test Acc: 0.772
Validation loss decreased (-0.768740 --> -0.771864).  Saving model ...
Epoch: 24 cost time: 3.1913986206054688
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.052 Vali Acc: 0.766 Test Loss: 1.052 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.128514528274536
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.059 Vali Acc: 0.766 Test Loss: 1.059 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.8935885429382324
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.067 Vali Acc: 0.762 Test Loss: 1.067 Test Acc: 0.762
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.9064016342163086
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.071 Vali Acc: 0.766 Test Loss: 1.071 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.0076138973236084
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.073 Vali Acc: 0.769 Test Loss: 1.073 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.055820941925049
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.769 Test Loss: 1.075 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.1315510272979736
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.769 Test Loss: 1.079 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.115936040878296
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.084 Vali Acc: 0.769 Test Loss: 1.084 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.9919273853302
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.086 Vali Acc: 0.772 Test Loss: 1.086 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.0853679180145264
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.090 Vali Acc: 0.775 Test Loss: 1.090 Test Acc: 0.775
Validation loss decreased (-0.771864 --> -0.774989).  Saving model ...
Epoch: 34 cost time: 3.108365535736084
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.093 Vali Acc: 0.781 Test Loss: 1.093 Test Acc: 0.781
Validation loss decreased (-0.774989 --> -0.781239).  Saving model ...
Epoch: 35 cost time: 3.106175422668457
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.095 Vali Acc: 0.775 Test Loss: 1.095 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.0836591720581055
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.097 Vali Acc: 0.775 Test Loss: 1.097 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.930265426635742
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.103 Vali Acc: 0.775 Test Loss: 1.103 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.9250128269195557
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.106 Vali Acc: 0.781 Test Loss: 1.106 Test Acc: 0.781
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.914794445037842
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.110 Vali Acc: 0.781 Test Loss: 1.110 Test Acc: 0.781
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.914951801300049
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.112 Vali Acc: 0.781 Test Loss: 1.112 Test Acc: 0.781
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.9890878200531006
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.112 Vali Acc: 0.781 Test Loss: 1.112 Test Acc: 0.781
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.2750742435455322
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.781 Test Loss: 1.113 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.1739423274993896
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.115 Vali Acc: 0.781 Test Loss: 1.115 Test Acc: 0.781
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.4300403594970703
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.116 Vali Acc: 0.784 Test Loss: 1.116 Test Acc: 0.784
Validation loss decreased (-0.781239 --> -0.784364).  Saving model ...
Epoch: 45 cost time: 3.332914113998413
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.117 Vali Acc: 0.781 Test Loss: 1.117 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.1614582538604736
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.116 Vali Acc: 0.781 Test Loss: 1.116 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.3102753162384033
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.781 Test Loss: 1.118 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.299077033996582
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.778 Test Loss: 1.125 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.112658977508545
Epoch: 49, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.129 Vali Acc: 0.778 Test Loss: 1.129 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.1311209201812744
Epoch: 50, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.133 Vali Acc: 0.784 Test Loss: 1.133 Test Acc: 0.784
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.1899309158325195
Epoch: 51, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.784 Test Loss: 1.134 Test Acc: 0.784
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.2080307006835938
Epoch: 52, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.135 Vali Acc: 0.781 Test Loss: 1.135 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.0956411361694336
Epoch: 53, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.135 Vali Acc: 0.781 Test Loss: 1.135 Test Acc: 0.781
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 3.3035831451416016
Epoch: 54, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.138 Vali Acc: 0.781 Test Loss: 1.138 Test Acc: 0.781
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.784375
model parameter : 1181960
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.533571004867554
Epoch: 1, Steps: 8 | Train Loss: 2.118 Vali Loss: 1.825 Vali Acc: 0.362 Test Loss: 1.825 Test Acc: 0.362
Validation loss decreased (inf --> -0.362482).  Saving model ...
Epoch: 2 cost time: 2.684807538986206
Epoch: 2, Steps: 8 | Train Loss: 1.586 Vali Loss: 1.308 Vali Acc: 0.600 Test Loss: 1.308 Test Acc: 0.600
Validation loss decreased (-0.362482 --> -0.599987).  Saving model ...
Epoch: 3 cost time: 2.7830381393432617
Epoch: 3, Steps: 8 | Train Loss: 0.951 Vali Loss: 1.047 Vali Acc: 0.669 Test Loss: 1.047 Test Acc: 0.669
Validation loss decreased (-0.599987 --> -0.668740).  Saving model ...
Epoch: 4 cost time: 2.9659311771392822
Epoch: 4, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.994 Vali Acc: 0.678 Test Loss: 0.994 Test Acc: 0.678
Validation loss decreased (-0.668740 --> -0.678115).  Saving model ...
Epoch: 5 cost time: 2.856039524078369
Epoch: 5, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.964 Vali Acc: 0.681 Test Loss: 0.964 Test Acc: 0.681
Validation loss decreased (-0.678115 --> -0.681240).  Saving model ...
Epoch: 6 cost time: 2.7547597885131836
Epoch: 6, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.969 Vali Acc: 0.703 Test Loss: 0.969 Test Acc: 0.703
Validation loss decreased (-0.681240 --> -0.703115).  Saving model ...
Epoch: 7 cost time: 3.209933280944824
Epoch: 7, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.972 Vali Acc: 0.691 Test Loss: 0.972 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.306804656982422
Epoch: 8, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.148 Vali Acc: 0.669 Test Loss: 1.148 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3335416316986084
Epoch: 9, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.129 Vali Acc: 0.669 Test Loss: 1.129 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.234039068222046
Epoch: 10, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.322 Vali Acc: 0.669 Test Loss: 1.322 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.161008834838867
Epoch: 11, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.299 Vali Acc: 0.672 Test Loss: 1.299 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.9712371826171875
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.266 Vali Acc: 0.675 Test Loss: 1.266 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.824984073638916
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.333 Vali Acc: 0.684 Test Loss: 1.333 Test Acc: 0.684
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.0403881072998047
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.360 Vali Acc: 0.672 Test Loss: 1.360 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.875980854034424
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.378 Vali Acc: 0.662 Test Loss: 1.378 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.0587100982666016
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.402 Vali Acc: 0.662 Test Loss: 1.402 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.703125
model parameter : 1181960
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.087959289550781
Epoch: 1, Steps: 8 | Train Loss: 2.110 Vali Loss: 1.885 Vali Acc: 0.344 Test Loss: 1.885 Test Acc: 0.344
Validation loss decreased (inf --> -0.343731).  Saving model ...
Epoch: 2 cost time: 3.1162829399108887
Epoch: 2, Steps: 8 | Train Loss: 1.706 Vali Loss: 1.459 Vali Acc: 0.522 Test Loss: 1.459 Test Acc: 0.522
Validation loss decreased (-0.343731 --> -0.521860).  Saving model ...
Epoch: 3 cost time: 3.017575979232788
Epoch: 3, Steps: 8 | Train Loss: 1.099 Vali Loss: 1.169 Vali Acc: 0.606 Test Loss: 1.169 Test Acc: 0.606
Validation loss decreased (-0.521860 --> -0.606238).  Saving model ...
Epoch: 4 cost time: 3.1270430088043213
Epoch: 4, Steps: 8 | Train Loss: 0.654 Vali Loss: 1.098 Vali Acc: 0.594 Test Loss: 1.098 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.919996500015259
Epoch: 5, Steps: 8 | Train Loss: 0.456 Vali Loss: 1.047 Vali Acc: 0.622 Test Loss: 1.047 Test Acc: 0.622
Validation loss decreased (-0.606238 --> -0.621865).  Saving model ...
Epoch: 6 cost time: 2.8762128353118896
Epoch: 6, Steps: 8 | Train Loss: 0.333 Vali Loss: 1.049 Vali Acc: 0.656 Test Loss: 1.049 Test Acc: 0.656
Validation loss decreased (-0.621865 --> -0.656240).  Saving model ...
Epoch: 7 cost time: 2.9632465839385986
Epoch: 7, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.110 Vali Acc: 0.634 Test Loss: 1.110 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.979860544204712
Epoch: 8, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.211 Vali Acc: 0.625 Test Loss: 1.211 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.894415855407715
Epoch: 9, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.208 Vali Acc: 0.641 Test Loss: 1.208 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.767256259918213
Epoch: 10, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.278 Vali Acc: 0.641 Test Loss: 1.278 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.189535140991211
Epoch: 11, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.309 Vali Acc: 0.644 Test Loss: 1.309 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1498055458068848
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.210 Vali Acc: 0.641 Test Loss: 1.210 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.302886962890625
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.290 Vali Acc: 0.662 Test Loss: 1.290 Test Acc: 0.662
Validation loss decreased (-0.656240 --> -0.662487).  Saving model ...
Epoch: 14 cost time: 3.1886351108551025
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.377 Vali Acc: 0.644 Test Loss: 1.377 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2870676517486572
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.384 Vali Acc: 0.647 Test Loss: 1.384 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2842295169830322
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.342 Vali Acc: 0.659 Test Loss: 1.342 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.987499237060547
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.328 Vali Acc: 0.662 Test Loss: 1.328 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.983370065689087
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.327 Vali Acc: 0.659 Test Loss: 1.327 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.81634783744812
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.329 Vali Acc: 0.659 Test Loss: 1.329 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.790971517562866
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.347 Vali Acc: 0.662 Test Loss: 1.347 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.977259397506714
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.343 Vali Acc: 0.669 Test Loss: 1.343 Test Acc: 0.669
Validation loss decreased (-0.662487 --> -0.668737).  Saving model ...
Epoch: 22 cost time: 3.2279913425445557
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.326 Vali Acc: 0.666 Test Loss: 1.326 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9312400817871094
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.326 Vali Acc: 0.669 Test Loss: 1.326 Test Acc: 0.669
Validation loss decreased (-0.668737 --> -0.668737).  Saving model ...
Epoch: 24 cost time: 3.257371664047241
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.672 Test Loss: 1.330 Test Acc: 0.672
Validation loss decreased (-0.668737 --> -0.671862).  Saving model ...
Epoch: 25 cost time: 3.152052402496338
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.338 Vali Acc: 0.672 Test Loss: 1.338 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.312453269958496
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.675 Test Loss: 1.345 Test Acc: 0.675
Validation loss decreased (-0.671862 --> -0.674987).  Saving model ...
Epoch: 27 cost time: 3.578376531600952
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.352 Vali Acc: 0.675 Test Loss: 1.352 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9583513736724854
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.358 Vali Acc: 0.675 Test Loss: 1.358 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.087087392807007
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.350 Vali Acc: 0.672 Test Loss: 1.350 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.836249828338623
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.349 Vali Acc: 0.669 Test Loss: 1.349 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.79482364654541
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.353 Vali Acc: 0.669 Test Loss: 1.353 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.9882755279541016
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.357 Vali Acc: 0.669 Test Loss: 1.357 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.9127955436706543
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.370 Vali Acc: 0.675 Test Loss: 1.370 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.9149234294891357
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.376 Vali Acc: 0.678 Test Loss: 1.376 Test Acc: 0.678
Validation loss decreased (-0.674987 --> -0.678111).  Saving model ...
Epoch: 35 cost time: 2.823593854904175
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.675 Test Loss: 1.379 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.2334249019622803
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.384 Vali Acc: 0.675 Test Loss: 1.384 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.101426362991333
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.387 Vali Acc: 0.678 Test Loss: 1.387 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.1613388061523438
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.678 Test Loss: 1.386 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.086064577102661
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.678 Test Loss: 1.390 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.2132489681243896
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.678 Test Loss: 1.398 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.9664721488952637
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.678 Test Loss: 1.398 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.984529495239258
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.675 Test Loss: 1.395 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.75756573677063
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.678 Test Loss: 1.392 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.7018351554870605
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.681 Test Loss: 1.392 Test Acc: 0.681
Validation loss decreased (-0.678111 --> -0.681236).  Saving model ...
Epoch: 45 cost time: 2.911412000656128
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.681 Test Loss: 1.396 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.961733818054199
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.678 Test Loss: 1.399 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.1502065658569336
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.678 Test Loss: 1.406 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.0333821773529053
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.678 Test Loss: 1.415 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.148345708847046
Epoch: 49, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.675 Test Loss: 1.423 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.373624324798584
Epoch: 50, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.672 Test Loss: 1.431 Test Acc: 0.672
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.40708589553833
Epoch: 51, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.675 Test Loss: 1.426 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.477341890335083
Epoch: 52, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.678 Test Loss: 1.420 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.258600950241089
Epoch: 53, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.678 Test Loss: 1.412 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 3.0975496768951416
Epoch: 54, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.678 Test Loss: 1.415 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.68125
model parameter : 1181960
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.318667888641357
Epoch: 1, Steps: 8 | Train Loss: 2.150 Vali Loss: 1.977 Vali Acc: 0.256 Test Loss: 1.977 Test Acc: 0.256
Validation loss decreased (inf --> -0.256230).  Saving model ...
Epoch: 2 cost time: 2.7876696586608887
Epoch: 2, Steps: 8 | Train Loss: 1.882 Vali Loss: 1.689 Vali Acc: 0.431 Test Loss: 1.689 Test Acc: 0.431
Validation loss decreased (-0.256230 --> -0.431233).  Saving model ...
Epoch: 3 cost time: 2.8567919731140137
Epoch: 3, Steps: 8 | Train Loss: 1.340 Vali Loss: 1.392 Vali Acc: 0.556 Test Loss: 1.392 Test Acc: 0.556
Validation loss decreased (-0.431233 --> -0.556236).  Saving model ...
Epoch: 4 cost time: 2.9855782985687256
Epoch: 4, Steps: 8 | Train Loss: 0.886 Vali Loss: 1.250 Vali Acc: 0.550 Test Loss: 1.250 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.058443784713745
Epoch: 5, Steps: 8 | Train Loss: 0.634 Vali Loss: 1.182 Vali Acc: 0.578 Test Loss: 1.182 Test Acc: 0.578
Validation loss decreased (-0.556236 --> -0.578113).  Saving model ...
Epoch: 6 cost time: 3.171097993850708
Epoch: 6, Steps: 8 | Train Loss: 0.457 Vali Loss: 1.190 Vali Acc: 0.578 Test Loss: 1.190 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.178032636642456
Epoch: 7, Steps: 8 | Train Loss: 0.337 Vali Loss: 1.193 Vali Acc: 0.562 Test Loss: 1.193 Test Acc: 0.562
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.030198574066162
Epoch: 8, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.240 Vali Acc: 0.591 Test Loss: 1.240 Test Acc: 0.591
Validation loss decreased (-0.578113 --> -0.590613).  Saving model ...
Epoch: 9 cost time: 3.217967987060547
Epoch: 9, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.266 Vali Acc: 0.569 Test Loss: 1.266 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8395729064941406
Epoch: 10, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.256 Vali Acc: 0.609 Test Loss: 1.256 Test Acc: 0.609
Validation loss decreased (-0.590613 --> -0.609362).  Saving model ...
Epoch: 11 cost time: 2.9174296855926514
Epoch: 11, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.297 Vali Acc: 0.613 Test Loss: 1.297 Test Acc: 0.613
Validation loss decreased (-0.609362 --> -0.612487).  Saving model ...
Epoch: 12 cost time: 2.924043655395508
Epoch: 12, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.369 Vali Acc: 0.606 Test Loss: 1.369 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8552498817443848
Epoch: 13, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.271 Vali Acc: 0.641 Test Loss: 1.271 Test Acc: 0.641
Validation loss decreased (-0.612487 --> -0.640612).  Saving model ...
Epoch: 14 cost time: 3.2838449478149414
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.433 Vali Acc: 0.597 Test Loss: 1.433 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1426351070404053
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.406 Vali Acc: 0.631 Test Loss: 1.406 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.976557731628418
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.404 Vali Acc: 0.631 Test Loss: 1.404 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.135390043258667
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.359 Vali Acc: 0.634 Test Loss: 1.359 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9677374362945557
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.369 Vali Acc: 0.634 Test Loss: 1.369 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.72509503364563
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.375 Vali Acc: 0.653 Test Loss: 1.375 Test Acc: 0.653
Validation loss decreased (-0.640612 --> -0.653111).  Saving model ...
Epoch: 20 cost time: 2.9094321727752686
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.401 Vali Acc: 0.650 Test Loss: 1.401 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.98103404045105
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.375 Vali Acc: 0.656 Test Loss: 1.375 Test Acc: 0.656
Validation loss decreased (-0.653111 --> -0.656236).  Saving model ...
Epoch: 22 cost time: 2.9670491218566895
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.372 Vali Acc: 0.653 Test Loss: 1.372 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0797064304351807
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.396 Vali Acc: 0.647 Test Loss: 1.396 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.000953435897827
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.396 Vali Acc: 0.644 Test Loss: 1.396 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.2240192890167236
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.384 Vali Acc: 0.653 Test Loss: 1.384 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.069589853286743
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.391 Vali Acc: 0.656 Test Loss: 1.391 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.0683600902557373
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.399 Vali Acc: 0.662 Test Loss: 1.399 Test Acc: 0.662
Validation loss decreased (-0.656236 --> -0.662486).  Saving model ...
Epoch: 28 cost time: 2.972583770751953
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.391 Vali Acc: 0.659 Test Loss: 1.391 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9121503829956055
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.383 Vali Acc: 0.656 Test Loss: 1.383 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.8350062370300293
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.372 Vali Acc: 0.659 Test Loss: 1.372 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.1180145740509033
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.373 Vali Acc: 0.669 Test Loss: 1.373 Test Acc: 0.669
Validation loss decreased (-0.662486 --> -0.668736).  Saving model ...
Epoch: 32 cost time: 2.9236185550689697
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.392 Vali Acc: 0.662 Test Loss: 1.392 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.696075916290283
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.409 Vali Acc: 0.659 Test Loss: 1.409 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.173826217651367
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.656 Test Loss: 1.410 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.1053664684295654
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.411 Vali Acc: 0.656 Test Loss: 1.411 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.5766828060150146
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.412 Vali Acc: 0.659 Test Loss: 1.412 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.322970390319824
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.411 Vali Acc: 0.662 Test Loss: 1.411 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.2196531295776367
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.413 Vali Acc: 0.666 Test Loss: 1.413 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.948713541030884
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.411 Vali Acc: 0.669 Test Loss: 1.411 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.865633010864258
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.407 Vali Acc: 0.675 Test Loss: 1.407 Test Acc: 0.675
Validation loss decreased (-0.668736 --> -0.674986).  Saving model ...
Epoch: 41 cost time: 2.9003071784973145
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.402 Vali Acc: 0.675 Test Loss: 1.402 Test Acc: 0.675
Validation loss decreased (-0.674986 --> -0.674986).  Saving model ...
Epoch: 42 cost time: 2.7053840160369873
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.404 Vali Acc: 0.669 Test Loss: 1.404 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.7321972846984863
Epoch: 43, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.403 Vali Acc: 0.666 Test Loss: 1.403 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.8890600204467773
Epoch: 44, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.411 Vali Acc: 0.669 Test Loss: 1.411 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.2752537727355957
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.666 Test Loss: 1.425 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.8224270343780518
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.666 Test Loss: 1.424 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.968308210372925
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.666 Test Loss: 1.423 Test Acc: 0.666
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.015894651412964
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.666 Test Loss: 1.418 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.773273229598999
Epoch: 49, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.421 Vali Acc: 0.669 Test Loss: 1.421 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.9640917778015137
Epoch: 50, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.421 Vali Acc: 0.669 Test Loss: 1.421 Test Acc: 0.669
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.005565643310547
Epoch: 51, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.666 Test Loss: 1.425 Test Acc: 0.666
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.675
model parameter : 1181960
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.538930892944336
Epoch: 1, Steps: 8 | Train Loss: 2.180 Vali Loss: 2.029 Vali Acc: 0.163 Test Loss: 2.029 Test Acc: 0.163
Validation loss decreased (inf --> -0.162480).  Saving model ...
Epoch: 2 cost time: 2.71974778175354
Epoch: 2, Steps: 8 | Train Loss: 1.952 Vali Loss: 1.887 Vali Acc: 0.300 Test Loss: 1.887 Test Acc: 0.300
Validation loss decreased (-0.162480 --> -0.299981).  Saving model ...
Epoch: 3 cost time: 2.9758903980255127
Epoch: 3, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.652 Vali Acc: 0.384 Test Loss: 1.652 Test Acc: 0.384
Validation loss decreased (-0.299981 --> -0.384358).  Saving model ...
Epoch: 4 cost time: 2.954240560531616
Epoch: 4, Steps: 8 | Train Loss: 1.156 Vali Loss: 1.539 Vali Acc: 0.416 Test Loss: 1.539 Test Acc: 0.416
Validation loss decreased (-0.384358 --> -0.415610).  Saving model ...
Epoch: 5 cost time: 2.9856255054473877
Epoch: 5, Steps: 8 | Train Loss: 0.853 Vali Loss: 1.449 Vali Acc: 0.434 Test Loss: 1.449 Test Acc: 0.434
Validation loss decreased (-0.415610 --> -0.434361).  Saving model ...
Epoch: 6 cost time: 2.9959917068481445
Epoch: 6, Steps: 8 | Train Loss: 0.672 Vali Loss: 1.485 Vali Acc: 0.463 Test Loss: 1.485 Test Acc: 0.463
Validation loss decreased (-0.434361 --> -0.462485).  Saving model ...
Epoch: 7 cost time: 3.0995893478393555
Epoch: 7, Steps: 8 | Train Loss: 0.499 Vali Loss: 1.443 Vali Acc: 0.441 Test Loss: 1.443 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.913783550262451
Epoch: 8, Steps: 8 | Train Loss: 0.332 Vali Loss: 1.618 Vali Acc: 0.431 Test Loss: 1.618 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8130240440368652
Epoch: 9, Steps: 8 | Train Loss: 0.252 Vali Loss: 1.546 Vali Acc: 0.441 Test Loss: 1.546 Test Acc: 0.441
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.761899471282959
Epoch: 10, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.614 Vali Acc: 0.503 Test Loss: 1.614 Test Acc: 0.503
Validation loss decreased (-0.462485 --> -0.503109).  Saving model ...
Epoch: 11 cost time: 2.710590124130249
Epoch: 11, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.739 Vali Acc: 0.466 Test Loss: 1.739 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.689584732055664
Epoch: 12, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.609 Vali Acc: 0.453 Test Loss: 1.609 Test Acc: 0.453
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8013463020324707
Epoch: 13, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.844 Vali Acc: 0.459 Test Loss: 1.844 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0312304496765137
Epoch: 14, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.706 Vali Acc: 0.487 Test Loss: 1.706 Test Acc: 0.487
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.9896652698516846
Epoch: 15, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.839 Vali Acc: 0.450 Test Loss: 1.839 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.0226902961730957
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.747 Vali Acc: 0.509 Test Loss: 1.747 Test Acc: 0.509
Validation loss decreased (-0.503109 --> -0.509358).  Saving model ...
Epoch: 17 cost time: 3.088831901550293
Epoch: 17, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.852 Vali Acc: 0.478 Test Loss: 1.852 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2647151947021484
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.789 Vali Acc: 0.522 Test Loss: 1.789 Test Acc: 0.522
Validation loss decreased (-0.509358 --> -0.521857).  Saving model ...
Epoch: 19 cost time: 2.91422963142395
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.781 Vali Acc: 0.509 Test Loss: 1.781 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0414745807647705
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.845 Vali Acc: 0.494 Test Loss: 1.845 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.836878776550293
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.869 Vali Acc: 0.484 Test Loss: 1.869 Test Acc: 0.484
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7507596015930176
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.758 Vali Acc: 0.531 Test Loss: 1.758 Test Acc: 0.531
Validation loss decreased (-0.521857 --> -0.531232).  Saving model ...
Epoch: 23 cost time: 2.6711909770965576
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.793 Vali Acc: 0.519 Test Loss: 1.793 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7075860500335693
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.778 Vali Acc: 0.522 Test Loss: 1.778 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.472949743270874
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.776 Vali Acc: 0.537 Test Loss: 1.776 Test Acc: 0.537
Validation loss decreased (-0.531232 --> -0.537482).  Saving model ...
Epoch: 26 cost time: 2.6784555912017822
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.798 Vali Acc: 0.528 Test Loss: 1.798 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.876176118850708
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.830 Vali Acc: 0.531 Test Loss: 1.830 Test Acc: 0.531
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.513552188873291
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.752 Vali Acc: 0.553 Test Loss: 1.752 Test Acc: 0.553
Validation loss decreased (-0.537482 --> -0.553107).  Saving model ...
Epoch: 29 cost time: 3.2609457969665527
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.734 Vali Acc: 0.559 Test Loss: 1.734 Test Acc: 0.559
Validation loss decreased (-0.553107 --> -0.559358).  Saving model ...
Epoch: 30 cost time: 3.3814549446105957
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.722 Vali Acc: 0.575 Test Loss: 1.722 Test Acc: 0.575
Validation loss decreased (-0.559358 --> -0.574983).  Saving model ...
Epoch: 31 cost time: 2.867135763168335
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.748 Vali Acc: 0.562 Test Loss: 1.748 Test Acc: 0.562
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.08294677734375
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.779 Vali Acc: 0.541 Test Loss: 1.779 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.8141849040985107
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.724 Vali Acc: 0.575 Test Loss: 1.724 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.106041669845581
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.742 Vali Acc: 0.572 Test Loss: 1.742 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.7463431358337402
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.730 Vali Acc: 0.569 Test Loss: 1.730 Test Acc: 0.569
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.247871160507202
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.753 Vali Acc: 0.572 Test Loss: 1.753 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.4239978790283203
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.818 Vali Acc: 0.562 Test Loss: 1.818 Test Acc: 0.562
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.1007773876190186
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.550 Test Loss: 1.830 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.853935480117798
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.745 Vali Acc: 0.578 Test Loss: 1.745 Test Acc: 0.578
Validation loss decreased (-0.574983 --> -0.578108).  Saving model ...
Epoch: 40 cost time: 2.621428966522217
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.581 Test Loss: 1.749 Test Acc: 0.581
Validation loss decreased (-0.578108 --> -0.581233).  Saving model ...
Epoch: 41 cost time: 2.9776864051818848
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.764 Vali Acc: 0.569 Test Loss: 1.764 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.7841556072235107
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.763 Vali Acc: 0.572 Test Loss: 1.763 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.6549062728881836
Epoch: 43, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.738 Vali Acc: 0.588 Test Loss: 1.738 Test Acc: 0.588
Validation loss decreased (-0.581233 --> -0.587483).  Saving model ...
Epoch: 44 cost time: 2.7388198375701904
Epoch: 44, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.742 Vali Acc: 0.588 Test Loss: 1.742 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.027683973312378
Epoch: 45, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.778 Vali Acc: 0.566 Test Loss: 1.778 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.903820514678955
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.754 Vali Acc: 0.588 Test Loss: 1.754 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.856626510620117
Epoch: 47, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.727 Vali Acc: 0.591 Test Loss: 1.727 Test Acc: 0.591
Validation loss decreased (-0.587483 --> -0.590608).  Saving model ...
Epoch: 48 cost time: 2.885833501815796
Epoch: 48, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.603 Test Loss: 1.695 Test Acc: 0.603
Validation loss decreased (-0.590608 --> -0.603108).  Saving model ...
Epoch: 49 cost time: 3.0604605674743652
Epoch: 49, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.709 Vali Acc: 0.600 Test Loss: 1.709 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.6086432933807373
Epoch: 50, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.743 Vali Acc: 0.597 Test Loss: 1.743 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.6612966060638428
Epoch: 51, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.805 Vali Acc: 0.575 Test Loss: 1.805 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.550215482711792
Epoch: 52, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.780 Vali Acc: 0.588 Test Loss: 1.780 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.697512626647949
Epoch: 53, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.733 Vali Acc: 0.606 Test Loss: 1.733 Test Acc: 0.606
Validation loss decreased (-0.603108 --> -0.606233).  Saving model ...
Epoch: 54 cost time: 2.712893009185791
Epoch: 54, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.729 Vali Acc: 0.603 Test Loss: 1.729 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.8518483638763428
Epoch: 55, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.594 Test Loss: 1.779 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.092794179916382
Epoch: 56, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.600 Test Loss: 1.796 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.132800817489624
Epoch: 57, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.781 Vali Acc: 0.600 Test Loss: 1.781 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.0512712001800537
Epoch: 58, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.759 Vali Acc: 0.597 Test Loss: 1.759 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.976680040359497
Epoch: 59, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.745 Vali Acc: 0.600 Test Loss: 1.745 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 2.719107151031494
Epoch: 60, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.600 Test Loss: 1.749 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 2.811901330947876
Epoch: 61, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.757 Vali Acc: 0.609 Test Loss: 1.757 Test Acc: 0.609
Validation loss decreased (-0.606233 --> -0.609357).  Saving model ...
Epoch: 62 cost time: 3.07418155670166
Epoch: 62, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.606 Test Loss: 1.760 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.68483829498291
Epoch: 63, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.757 Vali Acc: 0.609 Test Loss: 1.757 Test Acc: 0.609
Validation loss decreased (-0.609357 --> -0.609357).  Saving model ...
Epoch: 64 cost time: 2.8430123329162598
Epoch: 64, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.606 Test Loss: 1.760 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.8210370540618896
Epoch: 65, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.609 Test Loss: 1.749 Test Acc: 0.609
Validation loss decreased (-0.609357 --> -0.609358).  Saving model ...
Epoch: 66 cost time: 2.8626229763031006
Epoch: 66, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.606 Test Loss: 1.739 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.8281664848327637
Epoch: 67, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.606 Test Loss: 1.731 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 2.970102548599243
Epoch: 68, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.606 Test Loss: 1.744 Test Acc: 0.606
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 2.7364587783813477
Epoch: 69, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.747 Vali Acc: 0.606 Test Loss: 1.747 Test Acc: 0.606
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 2.9299471378326416
Epoch: 70, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.738 Vali Acc: 0.603 Test Loss: 1.738 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 2.646667003631592
Epoch: 71, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.738 Vali Acc: 0.609 Test Loss: 1.738 Test Acc: 0.609
Validation loss decreased (-0.609358 --> -0.609358).  Saving model ...
Epoch: 72 cost time: 2.8420722484588623
Epoch: 72, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.613 Test Loss: 1.739 Test Acc: 0.613
Validation loss decreased (-0.609358 --> -0.612483).  Saving model ...
Epoch: 73 cost time: 2.9564290046691895
Epoch: 73, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.741 Vali Acc: 0.606 Test Loss: 1.741 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.6338024139404297
Epoch: 74, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.753 Vali Acc: 0.609 Test Loss: 1.753 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 2.9126689434051514
Epoch: 75, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.776 Vali Acc: 0.609 Test Loss: 1.776 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 3.0292229652404785
Epoch: 76, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.792 Vali Acc: 0.613 Test Loss: 1.792 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 2.8991596698760986
Epoch: 77, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.600 Test Loss: 1.786 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 2.7304675579071045
Epoch: 78, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.787 Vali Acc: 0.600 Test Loss: 1.787 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 2.777346611022949
Epoch: 79, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.609 Test Loss: 1.793 Test Acc: 0.609
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 2.4619929790496826
Epoch: 80, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.792 Vali Acc: 0.603 Test Loss: 1.792 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 2.505990743637085
Epoch: 81, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.792 Vali Acc: 0.609 Test Loss: 1.792 Test Acc: 0.609
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 2.6088075637817383
Epoch: 82, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.790 Vali Acc: 0.609 Test Loss: 1.790 Test Acc: 0.609
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.6125
model parameter : 1181960
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.2022950649261475
Epoch: 1, Steps: 8 | Train Loss: 2.218 Vali Loss: 2.086 Vali Acc: 0.122 Test Loss: 2.086 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 3.090374708175659
Epoch: 2, Steps: 8 | Train Loss: 2.033 Vali Loss: 2.020 Vali Acc: 0.212 Test Loss: 2.020 Test Acc: 0.212
Validation loss decreased (-0.121854 --> -0.212480).  Saving model ...
Epoch: 3 cost time: 3.189558506011963
Epoch: 3, Steps: 8 | Train Loss: 1.750 Vali Loss: 1.856 Vali Acc: 0.350 Test Loss: 1.856 Test Acc: 0.350
Validation loss decreased (-0.212480 --> -0.349981).  Saving model ...
Epoch: 4 cost time: 3.085817813873291
Epoch: 4, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.726 Vali Acc: 0.378 Test Loss: 1.726 Test Acc: 0.378
Validation loss decreased (-0.349981 --> -0.378108).  Saving model ...
Epoch: 5 cost time: 3.372229814529419
Epoch: 5, Steps: 8 | Train Loss: 1.045 Vali Loss: 1.672 Vali Acc: 0.322 Test Loss: 1.672 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.095132350921631
Epoch: 6, Steps: 8 | Train Loss: 0.811 Vali Loss: 1.594 Vali Acc: 0.397 Test Loss: 1.594 Test Acc: 0.397
Validation loss decreased (-0.378108 --> -0.396859).  Saving model ...
Epoch: 7 cost time: 2.8034794330596924
Epoch: 7, Steps: 8 | Train Loss: 0.603 Vali Loss: 1.558 Vali Acc: 0.344 Test Loss: 1.558 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0196352005004883
Epoch: 8, Steps: 8 | Train Loss: 0.440 Vali Loss: 1.637 Vali Acc: 0.356 Test Loss: 1.637 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9364356994628906
Epoch: 9, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.702 Vali Acc: 0.287 Test Loss: 1.702 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.935467481613159
Epoch: 10, Steps: 8 | Train Loss: 0.267 Vali Loss: 1.491 Vali Acc: 0.434 Test Loss: 1.491 Test Acc: 0.434
Validation loss decreased (-0.396859 --> -0.434360).  Saving model ...
Epoch: 11 cost time: 2.937466859817505
Epoch: 11, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.584 Vali Acc: 0.403 Test Loss: 1.584 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.112534999847412
Epoch: 12, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.692 Vali Acc: 0.375 Test Loss: 1.692 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1997811794281006
Epoch: 13, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.748 Vali Acc: 0.362 Test Loss: 1.748 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.277245044708252
Epoch: 14, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.634 Vali Acc: 0.400 Test Loss: 1.634 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.207791566848755
Epoch: 15, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.630 Vali Acc: 0.406 Test Loss: 1.630 Test Acc: 0.406
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.919748544692993
Epoch: 16, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.684 Vali Acc: 0.450 Test Loss: 1.684 Test Acc: 0.450
Validation loss decreased (-0.434360 --> -0.449983).  Saving model ...
Epoch: 17 cost time: 3.087697744369507
Epoch: 17, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.932 Vali Acc: 0.359 Test Loss: 1.932 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0392520427703857
Epoch: 18, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.695 Vali Acc: 0.472 Test Loss: 1.695 Test Acc: 0.472
Validation loss decreased (-0.449983 --> -0.471858).  Saving model ...
Epoch: 19 cost time: 3.1087467670440674
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.928 Vali Acc: 0.397 Test Loss: 1.928 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7488088607788086
Epoch: 20, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.833 Vali Acc: 0.416 Test Loss: 1.833 Test Acc: 0.416
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.876936912536621
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.831 Vali Acc: 0.434 Test Loss: 1.831 Test Acc: 0.434
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.1012704372406006
Epoch: 22, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.793 Vali Acc: 0.456 Test Loss: 1.793 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.8569159507751465
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.847 Vali Acc: 0.450 Test Loss: 1.847 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.9959819316864014
Epoch: 24, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.920 Vali Acc: 0.447 Test Loss: 1.920 Test Acc: 0.447
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.901487350463867
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.027 Vali Acc: 0.428 Test Loss: 2.027 Test Acc: 0.428
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.041231155395508
Epoch: 26, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.831 Vali Acc: 0.478 Test Loss: 1.831 Test Acc: 0.478
Validation loss decreased (-0.471858 --> -0.478107).  Saving model ...
Epoch: 27 cost time: 3.094656467437744
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.807 Vali Acc: 0.484 Test Loss: 1.807 Test Acc: 0.484
Validation loss decreased (-0.478107 --> -0.484357).  Saving model ...
Epoch: 28 cost time: 3.153447151184082
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.875 Vali Acc: 0.481 Test Loss: 1.875 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.208951234817505
Epoch: 29, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.818 Vali Acc: 0.500 Test Loss: 1.818 Test Acc: 0.500
Validation loss decreased (-0.484357 --> -0.499982).  Saving model ...
Epoch: 30 cost time: 3.1581480503082275
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.836 Vali Acc: 0.500 Test Loss: 1.836 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.3770358562469482
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.864 Vali Acc: 0.497 Test Loss: 1.864 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.472104787826538
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.839 Vali Acc: 0.512 Test Loss: 1.839 Test Acc: 0.512
Validation loss decreased (-0.499982 --> -0.512482).  Saving model ...
Epoch: 33 cost time: 3.2933053970336914
Epoch: 33, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.759 Vali Acc: 0.537 Test Loss: 1.759 Test Acc: 0.537
Validation loss decreased (-0.512482 --> -0.537482).  Saving model ...
Epoch: 34 cost time: 3.018065929412842
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.914 Vali Acc: 0.491 Test Loss: 1.914 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.969611167907715
Epoch: 35, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.874 Vali Acc: 0.509 Test Loss: 1.874 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.7939138412475586
Epoch: 36, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.835 Vali Acc: 0.541 Test Loss: 1.835 Test Acc: 0.541
Validation loss decreased (-0.537482 --> -0.540607).  Saving model ...
Epoch: 37 cost time: 2.8830764293670654
Epoch: 37, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.981 Vali Acc: 0.491 Test Loss: 1.981 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.0324583053588867
Epoch: 38, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.925 Vali Acc: 0.519 Test Loss: 1.925 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.3844757080078125
Epoch: 39, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.802 Vali Acc: 0.531 Test Loss: 1.802 Test Acc: 0.531
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.6613121032714844
Epoch: 40, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.946 Vali Acc: 0.500 Test Loss: 1.946 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.2729856967926025
Epoch: 41, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.859 Vali Acc: 0.534 Test Loss: 1.859 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.321352958679199
Epoch: 42, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.819 Vali Acc: 0.537 Test Loss: 1.819 Test Acc: 0.537
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.379140615463257
Epoch: 43, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.883 Vali Acc: 0.544 Test Loss: 1.883 Test Acc: 0.544
Validation loss decreased (-0.540607 --> -0.543731).  Saving model ...
Epoch: 44 cost time: 3.2473340034484863
Epoch: 44, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.885 Vali Acc: 0.544 Test Loss: 1.885 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.3425235748291016
Epoch: 45, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.869 Vali Acc: 0.556 Test Loss: 1.869 Test Acc: 0.556
Validation loss decreased (-0.543731 --> -0.556231).  Saving model ...
Epoch: 46 cost time: 3.282909393310547
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.893 Vali Acc: 0.562 Test Loss: 1.893 Test Acc: 0.562
Validation loss decreased (-0.556231 --> -0.562481).  Saving model ...
Epoch: 47 cost time: 3.0746688842773438
Epoch: 47, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.902 Vali Acc: 0.556 Test Loss: 1.902 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.0389697551727295
Epoch: 48, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.851 Vali Acc: 0.559 Test Loss: 1.851 Test Acc: 0.559
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.2896430492401123
Epoch: 49, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.848 Vali Acc: 0.550 Test Loss: 1.848 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.3969337940216064
Epoch: 50, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.877 Vali Acc: 0.553 Test Loss: 1.877 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.3182764053344727
Epoch: 51, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.934 Vali Acc: 0.547 Test Loss: 1.934 Test Acc: 0.547
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.197025775909424
Epoch: 52, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.985 Vali Acc: 0.525 Test Loss: 1.985 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.1581621170043945
Epoch: 53, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.884 Vali Acc: 0.553 Test Loss: 1.884 Test Acc: 0.553
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 3.1972055435180664
Epoch: 54, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.850 Vali Acc: 0.569 Test Loss: 1.850 Test Acc: 0.569
Validation loss decreased (-0.562481 --> -0.568732).  Saving model ...
Epoch: 55 cost time: 3.3001577854156494
Epoch: 55, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.989 Vali Acc: 0.544 Test Loss: 1.989 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.0383894443511963
Epoch: 56, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.993 Vali Acc: 0.550 Test Loss: 1.993 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.82857346534729
Epoch: 57, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.899 Vali Acc: 0.572 Test Loss: 1.899 Test Acc: 0.572
Validation loss decreased (-0.568732 --> -0.571856).  Saving model ...
Epoch: 58 cost time: 3.1379592418670654
Epoch: 58, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.879 Vali Acc: 0.572 Test Loss: 1.879 Test Acc: 0.572
Validation loss decreased (-0.571856 --> -0.571856).  Saving model ...
Epoch: 59 cost time: 3.0591578483581543
Epoch: 59, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.867 Vali Acc: 0.584 Test Loss: 1.867 Test Acc: 0.584
Validation loss decreased (-0.571856 --> -0.584356).  Saving model ...
Epoch: 60 cost time: 2.9897475242614746
Epoch: 60, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.892 Vali Acc: 0.588 Test Loss: 1.892 Test Acc: 0.588
Validation loss decreased (-0.584356 --> -0.587481).  Saving model ...
Epoch: 61 cost time: 3.2456297874450684
Epoch: 61, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.900 Vali Acc: 0.581 Test Loss: 1.900 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.92293119430542
Epoch: 62, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.881 Vali Acc: 0.584 Test Loss: 1.881 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 2.733513832092285
Epoch: 63, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.885 Vali Acc: 0.588 Test Loss: 1.885 Test Acc: 0.588
Validation loss decreased (-0.587481 --> -0.587481).  Saving model ...
Epoch: 64 cost time: 3.3163771629333496
Epoch: 64, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.974 Vali Acc: 0.562 Test Loss: 1.974 Test Acc: 0.562
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 3.0352349281311035
Epoch: 65, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.001 Vali Acc: 0.562 Test Loss: 2.001 Test Acc: 0.562
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 3.3322176933288574
Epoch: 66, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.978 Vali Acc: 0.566 Test Loss: 1.978 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 3.562784194946289
Epoch: 67, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.933 Vali Acc: 0.584 Test Loss: 1.933 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 3.195098400115967
Epoch: 68, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.920 Vali Acc: 0.588 Test Loss: 1.920 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 3.3149948120117188
Epoch: 69, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.894 Vali Acc: 0.594 Test Loss: 1.894 Test Acc: 0.594
Validation loss decreased (-0.587481 --> -0.593731).  Saving model ...
Epoch: 70 cost time: 2.952603340148926
Epoch: 70, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.885 Vali Acc: 0.594 Test Loss: 1.885 Test Acc: 0.594
Validation loss decreased (-0.593731 --> -0.593731).  Saving model ...
Epoch: 71 cost time: 3.2764880657196045
Epoch: 71, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.937 Vali Acc: 0.581 Test Loss: 1.937 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.7914464473724365
Epoch: 72, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.940 Vali Acc: 0.581 Test Loss: 1.940 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 2.9512081146240234
Epoch: 73, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.907 Vali Acc: 0.584 Test Loss: 1.907 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 3.16375994682312
Epoch: 74, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.949 Vali Acc: 0.572 Test Loss: 1.949 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 3.083414316177368
Epoch: 75, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.986 Vali Acc: 0.572 Test Loss: 1.986 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 3.2446508407592773
Epoch: 76, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.000 Vali Acc: 0.578 Test Loss: 2.000 Test Acc: 0.578
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 3.127960205078125
Epoch: 77, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.988 Vali Acc: 0.581 Test Loss: 1.988 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 3.234884262084961
Epoch: 78, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.957 Vali Acc: 0.600 Test Loss: 1.957 Test Acc: 0.600
Validation loss decreased (-0.593731 --> -0.599980).  Saving model ...
Epoch: 79 cost time: 2.9227988719940186
Epoch: 79, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.957 Vali Acc: 0.600 Test Loss: 1.957 Test Acc: 0.600
Validation loss decreased (-0.599980 --> -0.599980).  Saving model ...
Epoch: 80 cost time: 2.9719154834747314
Epoch: 80, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.588 Test Loss: 1.960 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 3.063123941421509
Epoch: 81, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.588 Test Loss: 1.967 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 2.951716184616089
Epoch: 82, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.584 Test Loss: 1.970 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 3.159433364868164
Epoch: 83, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.969 Vali Acc: 0.597 Test Loss: 1.969 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 3.260542869567871
Epoch: 84, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.928 Vali Acc: 0.591 Test Loss: 1.928 Test Acc: 0.591
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 3.0481531620025635
Epoch: 85, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.922 Vali Acc: 0.600 Test Loss: 1.922 Test Acc: 0.600
Validation loss decreased (-0.599980 --> -0.599981).  Saving model ...
Epoch: 86 cost time: 2.945479393005371
Epoch: 86, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.597 Test Loss: 1.968 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 2.7721307277679443
Epoch: 87, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.987 Vali Acc: 0.591 Test Loss: 1.987 Test Acc: 0.591
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 2.7550110816955566
Epoch: 88, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.600 Test Loss: 1.982 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 2.7321503162384033
Epoch: 89, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.984 Vali Acc: 0.603 Test Loss: 1.984 Test Acc: 0.603
Validation loss decreased (-0.599981 --> -0.603105).  Saving model ...
Epoch: 90 cost time: 2.8585925102233887
Epoch: 90, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.963 Vali Acc: 0.603 Test Loss: 1.963 Test Acc: 0.603
Validation loss decreased (-0.603105 --> -0.603105).  Saving model ...
Epoch: 91 cost time: 2.87131929397583
Epoch: 91, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.963 Vali Acc: 0.603 Test Loss: 1.963 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 3.256222724914551
Epoch: 92, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.991 Vali Acc: 0.606 Test Loss: 1.991 Test Acc: 0.606
Validation loss decreased (-0.603105 --> -0.606230).  Saving model ...
Epoch: 93 cost time: 3.182786226272583
Epoch: 93, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.001 Vali Acc: 0.597 Test Loss: 2.001 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 3.1809074878692627
Epoch: 94, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.597 Test Loss: 1.967 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 3.14459490776062
Epoch: 95, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.948 Vali Acc: 0.606 Test Loss: 1.948 Test Acc: 0.606
Validation loss decreased (-0.606230 --> -0.606231).  Saving model ...
Epoch: 96 cost time: 2.7826101779937744
Epoch: 96, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.929 Vali Acc: 0.603 Test Loss: 1.929 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 2.9761953353881836
Epoch: 97, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.930 Vali Acc: 0.603 Test Loss: 1.930 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 2.8168816566467285
Epoch: 98, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.948 Vali Acc: 0.606 Test Loss: 1.948 Test Acc: 0.606
Validation loss decreased (-0.606231 --> -0.606231).  Saving model ...
Epoch: 99 cost time: 2.7649953365325928
Epoch: 99, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.998 Vali Acc: 0.588 Test Loss: 1.998 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 2.9181067943573
Epoch: 100, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.989 Vali Acc: 0.591 Test Loss: 1.989 Test Acc: 0.591
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.60625
model parameter : 1181960
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.507133722305298
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 2.080 Vali Acc: 0.159 Test Loss: 2.080 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 2.946770429611206
Epoch: 2, Steps: 8 | Train Loss: 2.036 Vali Loss: 2.033 Vali Acc: 0.212 Test Loss: 2.033 Test Acc: 0.212
Validation loss decreased (-0.159354 --> -0.212480).  Saving model ...
Epoch: 3 cost time: 2.914613723754883
Epoch: 3, Steps: 8 | Train Loss: 1.732 Vali Loss: 1.920 Vali Acc: 0.316 Test Loss: 1.920 Test Acc: 0.316
Validation loss decreased (-0.212480 --> -0.315606).  Saving model ...
Epoch: 4 cost time: 3.000274896621704
Epoch: 4, Steps: 8 | Train Loss: 1.396 Vali Loss: 1.801 Vali Acc: 0.338 Test Loss: 1.801 Test Acc: 0.338
Validation loss decreased (-0.315606 --> -0.337482).  Saving model ...
Epoch: 5 cost time: 2.6474146842956543
Epoch: 5, Steps: 8 | Train Loss: 1.104 Vali Loss: 1.740 Vali Acc: 0.381 Test Loss: 1.740 Test Acc: 0.381
Validation loss decreased (-0.337482 --> -0.381233).  Saving model ...
Epoch: 6 cost time: 2.891728639602661
Epoch: 6, Steps: 8 | Train Loss: 0.836 Vali Loss: 1.653 Vali Acc: 0.347 Test Loss: 1.653 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.243467092514038
Epoch: 7, Steps: 8 | Train Loss: 0.599 Vali Loss: 1.582 Vali Acc: 0.403 Test Loss: 1.582 Test Acc: 0.403
Validation loss decreased (-0.381233 --> -0.403109).  Saving model ...
Epoch: 8 cost time: 3.165315866470337
Epoch: 8, Steps: 8 | Train Loss: 0.433 Vali Loss: 1.553 Vali Acc: 0.362 Test Loss: 1.553 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.233919143676758
Epoch: 9, Steps: 8 | Train Loss: 0.320 Vali Loss: 1.568 Vali Acc: 0.366 Test Loss: 1.568 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6137959957122803
Epoch: 10, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.413 Vali Acc: 0.422 Test Loss: 1.413 Test Acc: 0.422
Validation loss decreased (-0.403109 --> -0.421861).  Saving model ...
Epoch: 11 cost time: 2.816483974456787
Epoch: 11, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.461 Vali Acc: 0.419 Test Loss: 1.461 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7330422401428223
Epoch: 12, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.590 Vali Acc: 0.409 Test Loss: 1.590 Test Acc: 0.409
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8217124938964844
Epoch: 13, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.515 Vali Acc: 0.438 Test Loss: 1.515 Test Acc: 0.438
Validation loss decreased (-0.421861 --> -0.437485).  Saving model ...
Epoch: 14 cost time: 3.108074903488159
Epoch: 14, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.491 Vali Acc: 0.412 Test Loss: 1.491 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1904759407043457
Epoch: 15, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.511 Vali Acc: 0.419 Test Loss: 1.511 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.085062026977539
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.550 Vali Acc: 0.422 Test Loss: 1.550 Test Acc: 0.422
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.21547269821167
Epoch: 17, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.731 Vali Acc: 0.416 Test Loss: 1.731 Test Acc: 0.416
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8975040912628174
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.541 Vali Acc: 0.450 Test Loss: 1.541 Test Acc: 0.450
Validation loss decreased (-0.437485 --> -0.449985).  Saving model ...
Epoch: 19 cost time: 3.0482773780822754
Epoch: 19, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.690 Vali Acc: 0.453 Test Loss: 1.690 Test Acc: 0.453
Validation loss decreased (-0.449985 --> -0.453108).  Saving model ...
Epoch: 20 cost time: 2.8206992149353027
Epoch: 20, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.554 Vali Acc: 0.497 Test Loss: 1.554 Test Acc: 0.497
Validation loss decreased (-0.453108 --> -0.496859).  Saving model ...
Epoch: 21 cost time: 2.8684401512145996
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.809 Vali Acc: 0.431 Test Loss: 1.809 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9404683113098145
Epoch: 22, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.565 Vali Acc: 0.500 Test Loss: 1.565 Test Acc: 0.500
Validation loss decreased (-0.496859 --> -0.499984).  Saving model ...
Epoch: 23 cost time: 3.0042202472686768
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.981 Vali Acc: 0.438 Test Loss: 1.981 Test Acc: 0.438
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.097522258758545
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.815 Vali Acc: 0.459 Test Loss: 1.815 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.139563798904419
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.756 Vali Acc: 0.487 Test Loss: 1.756 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.9629409313201904
Epoch: 26, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.838 Vali Acc: 0.475 Test Loss: 1.838 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.757448196411133
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.676 Vali Acc: 0.525 Test Loss: 1.676 Test Acc: 0.525
Validation loss decreased (-0.499984 --> -0.524983).  Saving model ...
Epoch: 28 cost time: 2.9655325412750244
Epoch: 28, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.742 Vali Acc: 0.516 Test Loss: 1.742 Test Acc: 0.516
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7398838996887207
Epoch: 29, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.185 Vali Acc: 0.419 Test Loss: 2.185 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.1044652462005615
Epoch: 30, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.745 Vali Acc: 0.481 Test Loss: 1.745 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.3727357387542725
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.690 Vali Acc: 0.553 Test Loss: 1.690 Test Acc: 0.553
Validation loss decreased (-0.524983 --> -0.553108).  Saving model ...
Epoch: 32 cost time: 3.2348251342773438
Epoch: 32, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.773 Vali Acc: 0.506 Test Loss: 1.773 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.9974448680877686
Epoch: 33, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.783 Vali Acc: 0.531 Test Loss: 1.783 Test Acc: 0.531
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.7915754318237305
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.859 Vali Acc: 0.509 Test Loss: 1.859 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.650719404220581
Epoch: 35, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.791 Vali Acc: 0.528 Test Loss: 1.791 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.7792088985443115
Epoch: 36, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.808 Vali Acc: 0.528 Test Loss: 1.808 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.5919387340545654
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.892 Vali Acc: 0.506 Test Loss: 1.892 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.67661714553833
Epoch: 38, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.867 Vali Acc: 0.506 Test Loss: 1.867 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.797161817550659
Epoch: 39, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.846 Vali Acc: 0.503 Test Loss: 1.846 Test Acc: 0.503
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.8220884799957275
Epoch: 40, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.860 Vali Acc: 0.512 Test Loss: 1.860 Test Acc: 0.512
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.025099754333496
Epoch: 41, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.796 Vali Acc: 0.516 Test Loss: 1.796 Test Acc: 0.516
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.553125
model parameter : 1181960
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.518904209136963
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 2.096 Vali Acc: 0.106 Test Loss: 2.096 Test Acc: 0.106
Validation loss decreased (inf --> -0.106229).  Saving model ...
Epoch: 2 cost time: 2.8451383113861084
Epoch: 2, Steps: 8 | Train Loss: 2.062 Vali Loss: 2.055 Vali Acc: 0.241 Test Loss: 2.055 Test Acc: 0.241
Validation loss decreased (-0.106229 --> -0.240604).  Saving model ...
Epoch: 3 cost time: 2.9278244972229004
Epoch: 3, Steps: 8 | Train Loss: 1.700 Vali Loss: 1.957 Vali Acc: 0.256 Test Loss: 1.957 Test Acc: 0.256
Validation loss decreased (-0.240604 --> -0.256230).  Saving model ...
Epoch: 4 cost time: 3.085935354232788
Epoch: 4, Steps: 8 | Train Loss: 1.364 Vali Loss: 1.830 Vali Acc: 0.319 Test Loss: 1.830 Test Acc: 0.319
Validation loss decreased (-0.256230 --> -0.318732).  Saving model ...
Epoch: 5 cost time: 2.8436827659606934
Epoch: 5, Steps: 8 | Train Loss: 1.018 Vali Loss: 1.751 Vali Acc: 0.394 Test Loss: 1.751 Test Acc: 0.394
Validation loss decreased (-0.318732 --> -0.393732).  Saving model ...
Epoch: 6 cost time: 2.717149257659912
Epoch: 6, Steps: 8 | Train Loss: 0.729 Vali Loss: 1.631 Vali Acc: 0.372 Test Loss: 1.631 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7884767055511475
Epoch: 7, Steps: 8 | Train Loss: 0.543 Vali Loss: 1.532 Vali Acc: 0.453 Test Loss: 1.532 Test Acc: 0.453
Validation loss decreased (-0.393732 --> -0.453110).  Saving model ...
Epoch: 8 cost time: 2.782304286956787
Epoch: 8, Steps: 8 | Train Loss: 0.392 Vali Loss: 1.458 Vali Acc: 0.422 Test Loss: 1.458 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8115742206573486
Epoch: 9, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.418 Vali Acc: 0.444 Test Loss: 1.418 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7440547943115234
Epoch: 10, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.367 Vali Acc: 0.466 Test Loss: 1.367 Test Acc: 0.466
Validation loss decreased (-0.453110 --> -0.465611).  Saving model ...
Epoch: 11 cost time: 2.6813793182373047
Epoch: 11, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.339 Vali Acc: 0.484 Test Loss: 1.339 Test Acc: 0.484
Validation loss decreased (-0.465611 --> -0.484362).  Saving model ...
Epoch: 12 cost time: 3.124598503112793
Epoch: 12, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.581 Vali Acc: 0.438 Test Loss: 1.581 Test Acc: 0.438
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.965050458908081
Epoch: 13, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.499 Vali Acc: 0.419 Test Loss: 1.499 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9861297607421875
Epoch: 14, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.542 Vali Acc: 0.469 Test Loss: 1.542 Test Acc: 0.469
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0676772594451904
Epoch: 15, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.694 Vali Acc: 0.431 Test Loss: 1.694 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9555633068084717
Epoch: 16, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.525 Vali Acc: 0.472 Test Loss: 1.525 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.187607526779175
Epoch: 17, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.584 Vali Acc: 0.506 Test Loss: 1.584 Test Acc: 0.506
Validation loss decreased (-0.484362 --> -0.506234).  Saving model ...
Epoch: 18 cost time: 3.2279396057128906
Epoch: 18, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.610 Vali Acc: 0.519 Test Loss: 1.610 Test Acc: 0.519
Validation loss decreased (-0.506234 --> -0.518734).  Saving model ...
Epoch: 19 cost time: 2.7212233543395996
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.786 Vali Acc: 0.456 Test Loss: 1.786 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.925049304962158
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.654 Vali Acc: 0.500 Test Loss: 1.654 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.126117467880249
Epoch: 21, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.696 Vali Acc: 0.494 Test Loss: 1.696 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.1215972900390625
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.633 Vali Acc: 0.500 Test Loss: 1.633 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.274958848953247
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.838 Vali Acc: 0.472 Test Loss: 1.838 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.7612059116363525
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.946 Vali Acc: 0.487 Test Loss: 1.946 Test Acc: 0.487
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.8502817153930664
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.890 Vali Acc: 0.506 Test Loss: 1.890 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.8686540126800537
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.859 Vali Acc: 0.500 Test Loss: 1.859 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.025444984436035
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.811 Vali Acc: 0.516 Test Loss: 1.811 Test Acc: 0.516
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.965212345123291
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.837 Vali Acc: 0.519 Test Loss: 1.837 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.51875
model parameter : 1181960
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.922118902206421
Epoch: 1, Steps: 8 | Train Loss: 2.194 Vali Loss: 2.115 Vali Acc: 0.131 Test Loss: 2.115 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 3.0184922218322754
Epoch: 2, Steps: 8 | Train Loss: 2.088 Vali Loss: 1.969 Vali Acc: 0.216 Test Loss: 1.969 Test Acc: 0.216
Validation loss decreased (-0.131229 --> -0.215605).  Saving model ...
Epoch: 3 cost time: 2.925219774246216
Epoch: 3, Steps: 8 | Train Loss: 1.730 Vali Loss: 1.806 Vali Acc: 0.287 Test Loss: 1.806 Test Acc: 0.287
Validation loss decreased (-0.215605 --> -0.287482).  Saving model ...
Epoch: 4 cost time: 3.005065679550171
Epoch: 4, Steps: 8 | Train Loss: 1.375 Vali Loss: 1.618 Vali Acc: 0.384 Test Loss: 1.618 Test Acc: 0.384
Validation loss decreased (-0.287482 --> -0.384359).  Saving model ...
Epoch: 5 cost time: 2.782501220703125
Epoch: 5, Steps: 8 | Train Loss: 1.079 Vali Loss: 1.464 Vali Acc: 0.516 Test Loss: 1.464 Test Acc: 0.516
Validation loss decreased (-0.384359 --> -0.515610).  Saving model ...
Epoch: 6 cost time: 2.673607110977173
Epoch: 6, Steps: 8 | Train Loss: 0.775 Vali Loss: 1.368 Vali Acc: 0.494 Test Loss: 1.368 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4497792720794678
Epoch: 7, Steps: 8 | Train Loss: 0.579 Vali Loss: 1.369 Vali Acc: 0.497 Test Loss: 1.369 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0073399543762207
Epoch: 8, Steps: 8 | Train Loss: 0.432 Vali Loss: 1.412 Vali Acc: 0.469 Test Loss: 1.412 Test Acc: 0.469
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2569878101348877
Epoch: 9, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.475 Vali Acc: 0.509 Test Loss: 1.475 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.936722993850708
Epoch: 10, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.987 Vali Acc: 0.384 Test Loss: 1.987 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8292236328125
Epoch: 11, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.713 Vali Acc: 0.456 Test Loss: 1.713 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.011265754699707
Epoch: 12, Steps: 8 | Train Loss: 0.162 Vali Loss: 2.019 Vali Acc: 0.412 Test Loss: 2.019 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.1453804969787598
Epoch: 13, Steps: 8 | Train Loss: 0.128 Vali Loss: 2.006 Vali Acc: 0.419 Test Loss: 2.006 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.349813461303711
Epoch: 14, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.984 Vali Acc: 0.466 Test Loss: 1.984 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.1141605377197266
Epoch: 15, Steps: 8 | Train Loss: 0.065 Vali Loss: 2.187 Vali Acc: 0.416 Test Loss: 2.187 Test Acc: 0.416
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.515625
model parameter : 1181960
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.468246698379517
Epoch: 1, Steps: 8 | Train Loss: 2.104 Vali Loss: 2.119 Vali Acc: 0.141 Test Loss: 2.119 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 2.955949068069458
Epoch: 2, Steps: 8 | Train Loss: 2.020 Vali Loss: 1.968 Vali Acc: 0.212 Test Loss: 1.968 Test Acc: 0.212
Validation loss decreased (-0.140604 --> -0.212480).  Saving model ...
Epoch: 3 cost time: 2.9924826622009277
Epoch: 3, Steps: 8 | Train Loss: 1.727 Vali Loss: 1.807 Vali Acc: 0.256 Test Loss: 1.807 Test Acc: 0.256
Validation loss decreased (-0.212480 --> -0.256232).  Saving model ...
Epoch: 4 cost time: 3.334406614303589
Epoch: 4, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.636 Vali Acc: 0.344 Test Loss: 1.636 Test Acc: 0.344
Validation loss decreased (-0.256232 --> -0.343734).  Saving model ...
Epoch: 5 cost time: 3.3055837154388428
Epoch: 5, Steps: 8 | Train Loss: 1.167 Vali Loss: 1.467 Vali Acc: 0.434 Test Loss: 1.467 Test Acc: 0.434
Validation loss decreased (-0.343734 --> -0.434360).  Saving model ...
Epoch: 6 cost time: 3.137026786804199
Epoch: 6, Steps: 8 | Train Loss: 0.925 Vali Loss: 1.423 Vali Acc: 0.447 Test Loss: 1.423 Test Acc: 0.447
Validation loss decreased (-0.434360 --> -0.446861).  Saving model ...
Epoch: 7 cost time: 3.280379056930542
Epoch: 7, Steps: 8 | Train Loss: 0.704 Vali Loss: 1.490 Vali Acc: 0.456 Test Loss: 1.490 Test Acc: 0.456
Validation loss decreased (-0.446861 --> -0.456235).  Saving model ...
Epoch: 8 cost time: 3.0308761596679688
Epoch: 8, Steps: 8 | Train Loss: 0.469 Vali Loss: 1.681 Vali Acc: 0.428 Test Loss: 1.681 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.775083303451538
Epoch: 9, Steps: 8 | Train Loss: 0.380 Vali Loss: 1.762 Vali Acc: 0.438 Test Loss: 1.762 Test Acc: 0.438
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.322380781173706
Epoch: 10, Steps: 8 | Train Loss: 0.324 Vali Loss: 2.126 Vali Acc: 0.391 Test Loss: 2.126 Test Acc: 0.391
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0014150142669678
Epoch: 11, Steps: 8 | Train Loss: 0.259 Vali Loss: 1.973 Vali Acc: 0.441 Test Loss: 1.973 Test Acc: 0.441
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1926043033599854
Epoch: 12, Steps: 8 | Train Loss: 0.188 Vali Loss: 2.315 Vali Acc: 0.394 Test Loss: 2.315 Test Acc: 0.394
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.918205738067627
Epoch: 13, Steps: 8 | Train Loss: 0.181 Vali Loss: 2.255 Vali Acc: 0.419 Test Loss: 2.255 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.604217529296875
Epoch: 14, Steps: 8 | Train Loss: 0.128 Vali Loss: 2.284 Vali Acc: 0.438 Test Loss: 2.284 Test Acc: 0.438
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8231613636016846
Epoch: 15, Steps: 8 | Train Loss: 0.091 Vali Loss: 2.451 Vali Acc: 0.388 Test Loss: 2.451 Test Acc: 0.388
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.6724066734313965
Epoch: 16, Steps: 8 | Train Loss: 0.060 Vali Loss: 2.454 Vali Acc: 0.384 Test Loss: 2.454 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.202162981033325
Epoch: 17, Steps: 8 | Train Loss: 0.060 Vali Loss: 2.474 Vali Acc: 0.438 Test Loss: 2.474 Test Acc: 0.438
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.45625
model parameter : 1181960
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.305084943771362
Epoch: 1, Steps: 8 | Train Loss: 2.073 Vali Loss: 1.774 Vali Acc: 0.406 Test Loss: 1.774 Test Acc: 0.406
Validation loss decreased (inf --> -0.406232).  Saving model ...
Epoch: 2 cost time: 3.003915309906006
Epoch: 2, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.104 Vali Acc: 0.694 Test Loss: 1.104 Test Acc: 0.694
Validation loss decreased (-0.406232 --> -0.693739).  Saving model ...
Epoch: 3 cost time: 2.8486292362213135
Epoch: 3, Steps: 8 | Train Loss: 0.748 Vali Loss: 0.817 Vali Acc: 0.741 Test Loss: 0.817 Test Acc: 0.741
Validation loss decreased (-0.693739 --> -0.740617).  Saving model ...
Epoch: 4 cost time: 2.6753642559051514
Epoch: 4, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.752 Vali Acc: 0.766 Test Loss: 0.752 Test Acc: 0.766
Validation loss decreased (-0.740617 --> -0.765617).  Saving model ...
Epoch: 5 cost time: 3.0067174434661865
Epoch: 5, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.761 Vali Acc: 0.741 Test Loss: 0.761 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.023745059967041
Epoch: 6, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.841 Vali Acc: 0.731 Test Loss: 0.841 Test Acc: 0.731
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.078434705734253
Epoch: 7, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.897 Vali Acc: 0.744 Test Loss: 0.897 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7562005519866943
Epoch: 8, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.890 Vali Acc: 0.750 Test Loss: 0.890 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6763079166412354
Epoch: 9, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.918 Vali Acc: 0.747 Test Loss: 0.918 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6763222217559814
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.971 Vali Acc: 0.753 Test Loss: 0.971 Test Acc: 0.753
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.5486834049224854
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.970 Vali Acc: 0.759 Test Loss: 0.970 Test Acc: 0.759
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.924808979034424
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.989 Vali Acc: 0.753 Test Loss: 0.989 Test Acc: 0.753
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1276333332061768
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.031 Vali Acc: 0.741 Test Loss: 1.031 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.1298952102661133
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.047 Vali Acc: 0.744 Test Loss: 1.047 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.765625
model parameter : 1083656
model size : 9.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.653972864151001
Epoch: 1, Steps: 8 | Train Loss: 2.113 Vali Loss: 1.843 Vali Acc: 0.388 Test Loss: 1.843 Test Acc: 0.388
Validation loss decreased (inf --> -0.387482).  Saving model ...
Epoch: 2 cost time: 3.1680314540863037
Epoch: 2, Steps: 8 | Train Loss: 1.532 Vali Loss: 1.305 Vali Acc: 0.600 Test Loss: 1.305 Test Acc: 0.600
Validation loss decreased (-0.387482 --> -0.599987).  Saving model ...
Epoch: 3 cost time: 3.2912094593048096
Epoch: 3, Steps: 8 | Train Loss: 0.911 Vali Loss: 1.049 Vali Acc: 0.666 Test Loss: 1.049 Test Acc: 0.666
Validation loss decreased (-0.599987 --> -0.665615).  Saving model ...
Epoch: 4 cost time: 3.189448833465576
Epoch: 4, Steps: 8 | Train Loss: 0.605 Vali Loss: 0.978 Vali Acc: 0.694 Test Loss: 0.978 Test Acc: 0.694
Validation loss decreased (-0.665615 --> -0.693740).  Saving model ...
Epoch: 5 cost time: 3.211092472076416
Epoch: 5, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.965 Vali Acc: 0.678 Test Loss: 0.965 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.719425678253174
Epoch: 6, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.005 Vali Acc: 0.662 Test Loss: 1.005 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9205284118652344
Epoch: 7, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.111 Vali Acc: 0.659 Test Loss: 1.111 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.730895519256592
Epoch: 8, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.089 Vali Acc: 0.688 Test Loss: 1.089 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7096550464630127
Epoch: 9, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.243 Vali Acc: 0.662 Test Loss: 1.243 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.1457784175872803
Epoch: 10, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.275 Vali Acc: 0.669 Test Loss: 1.275 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.1393370628356934
Epoch: 11, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.249 Vali Acc: 0.681 Test Loss: 1.249 Test Acc: 0.681
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.1829116344451904
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.303 Vali Acc: 0.672 Test Loss: 1.303 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.0341193675994873
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.464 Vali Acc: 0.644 Test Loss: 1.464 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8237435817718506
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.387 Vali Acc: 0.666 Test Loss: 1.387 Test Acc: 0.666
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.69375
model parameter : 1083656
model size : 9.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.462660074234009
Epoch: 1, Steps: 8 | Train Loss: 2.141 Vali Loss: 1.911 Vali Acc: 0.334 Test Loss: 1.911 Test Acc: 0.334
Validation loss decreased (inf --> -0.334356).  Saving model ...
Epoch: 2 cost time: 3.0204687118530273
Epoch: 2, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.446 Vali Acc: 0.512 Test Loss: 1.446 Test Acc: 0.512
Validation loss decreased (-0.334356 --> -0.512486).  Saving model ...
Epoch: 3 cost time: 2.897284507751465
Epoch: 3, Steps: 8 | Train Loss: 1.066 Vali Loss: 1.172 Vali Acc: 0.588 Test Loss: 1.172 Test Acc: 0.588
Validation loss decreased (-0.512486 --> -0.587488).  Saving model ...
Epoch: 4 cost time: 2.71882963180542
Epoch: 4, Steps: 8 | Train Loss: 0.726 Vali Loss: 1.078 Vali Acc: 0.622 Test Loss: 1.078 Test Acc: 0.622
Validation loss decreased (-0.587488 --> -0.621864).  Saving model ...
Epoch: 5 cost time: 2.682993173599243
Epoch: 5, Steps: 8 | Train Loss: 0.453 Vali Loss: 1.047 Vali Acc: 0.613 Test Loss: 1.047 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8963074684143066
Epoch: 6, Steps: 8 | Train Loss: 0.312 Vali Loss: 1.047 Vali Acc: 0.631 Test Loss: 1.047 Test Acc: 0.631
Validation loss decreased (-0.621864 --> -0.631240).  Saving model ...
Epoch: 7 cost time: 2.7263662815093994
Epoch: 7, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.132 Vali Acc: 0.641 Test Loss: 1.132 Test Acc: 0.641
Validation loss decreased (-0.631240 --> -0.640614).  Saving model ...
Epoch: 8 cost time: 2.8107311725616455
Epoch: 8, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.110 Vali Acc: 0.628 Test Loss: 1.110 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.833981990814209
Epoch: 9, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.278 Vali Acc: 0.641 Test Loss: 1.278 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9666848182678223
Epoch: 10, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.162 Vali Acc: 0.644 Test Loss: 1.162 Test Acc: 0.644
Validation loss decreased (-0.640614 --> -0.643738).  Saving model ...
Epoch: 11 cost time: 3.1711673736572266
Epoch: 11, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.238 Vali Acc: 0.647 Test Loss: 1.238 Test Acc: 0.647
Validation loss decreased (-0.643738 --> -0.646863).  Saving model ...
Epoch: 12 cost time: 2.9696764945983887
Epoch: 12, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.324 Vali Acc: 0.631 Test Loss: 1.324 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.694071054458618
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.309 Vali Acc: 0.647 Test Loss: 1.309 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.784813404083252
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.278 Vali Acc: 0.653 Test Loss: 1.278 Test Acc: 0.653
Validation loss decreased (-0.646863 --> -0.653112).  Saving model ...
Epoch: 15 cost time: 3.1086275577545166
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.284 Vali Acc: 0.653 Test Loss: 1.284 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0137031078338623
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.270 Vali Acc: 0.659 Test Loss: 1.270 Test Acc: 0.659
Validation loss decreased (-0.653112 --> -0.659362).  Saving model ...
Epoch: 17 cost time: 2.86332631111145
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.289 Vali Acc: 0.656 Test Loss: 1.289 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8010127544403076
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.297 Vali Acc: 0.653 Test Loss: 1.297 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.781496524810791
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.297 Vali Acc: 0.666 Test Loss: 1.297 Test Acc: 0.666
Validation loss decreased (-0.659362 --> -0.665612).  Saving model ...
Epoch: 20 cost time: 2.675225019454956
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.297 Vali Acc: 0.666 Test Loss: 1.297 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8359758853912354
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.309 Vali Acc: 0.662 Test Loss: 1.309 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.2792673110961914
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.297 Vali Acc: 0.656 Test Loss: 1.297 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.257633924484253
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.293 Vali Acc: 0.659 Test Loss: 1.293 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.3864734172821045
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.293 Vali Acc: 0.662 Test Loss: 1.293 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.188685894012451
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.669 Test Loss: 1.296 Test Acc: 0.669
Validation loss decreased (-0.665612 --> -0.668737).  Saving model ...
Epoch: 26 cost time: 3.138512134552002
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.299 Vali Acc: 0.662 Test Loss: 1.299 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0343527793884277
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.309 Vali Acc: 0.662 Test Loss: 1.309 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.33040189743042
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.306 Vali Acc: 0.675 Test Loss: 1.306 Test Acc: 0.675
Validation loss decreased (-0.668737 --> -0.674987).  Saving model ...
Epoch: 29 cost time: 3.3636584281921387
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.308 Vali Acc: 0.675 Test Loss: 1.308 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.2689061164855957
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.312 Vali Acc: 0.675 Test Loss: 1.312 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.423581838607788
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.311 Vali Acc: 0.675 Test Loss: 1.311 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.991908550262451
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.313 Vali Acc: 0.675 Test Loss: 1.313 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.0168864727020264
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.317 Vali Acc: 0.672 Test Loss: 1.317 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.8754384517669678
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.324 Vali Acc: 0.678 Test Loss: 1.324 Test Acc: 0.678
Validation loss decreased (-0.674987 --> -0.678112).  Saving model ...
Epoch: 35 cost time: 2.9691271781921387
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.326 Vali Acc: 0.678 Test Loss: 1.326 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.1968889236450195
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.678 Test Loss: 1.328 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.266845464706421
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.333 Vali Acc: 0.678 Test Loss: 1.333 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.1401593685150146
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.681 Test Loss: 1.339 Test Acc: 0.681
Validation loss decreased (-0.678112 --> -0.681237).  Saving model ...
Epoch: 39 cost time: 3.3343944549560547
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.684 Test Loss: 1.339 Test Acc: 0.684
Validation loss decreased (-0.681237 --> -0.684362).  Saving model ...
Epoch: 40 cost time: 3.1093661785125732
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.337 Vali Acc: 0.684 Test Loss: 1.337 Test Acc: 0.684
Validation loss decreased (-0.684362 --> -0.684362).  Saving model ...
Epoch: 41 cost time: 3.0934197902679443
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.342 Vali Acc: 0.688 Test Loss: 1.342 Test Acc: 0.688
Validation loss decreased (-0.684362 --> -0.687487).  Saving model ...
Epoch: 42 cost time: 3.1950578689575195
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.343 Vali Acc: 0.684 Test Loss: 1.343 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.206669330596924
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.684 Test Loss: 1.345 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.2216618061065674
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.688 Test Loss: 1.347 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.703150987625122
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.688 Test Loss: 1.345 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.7481632232666016
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.688 Test Loss: 1.346 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.908918857574463
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.688 Test Loss: 1.347 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.784601926803589
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.688 Test Loss: 1.346 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.753948211669922
Epoch: 49, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.684 Test Loss: 1.351 Test Acc: 0.684
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.1822164058685303
Epoch: 50, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.684 Test Loss: 1.350 Test Acc: 0.684
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.1606364250183105
Epoch: 51, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.688 Test Loss: 1.352 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.6875
model parameter : 1083656
model size : 9.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.7280213832855225
Epoch: 1, Steps: 8 | Train Loss: 2.169 Vali Loss: 1.969 Vali Acc: 0.269 Test Loss: 1.969 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 2.554858446121216
Epoch: 2, Steps: 8 | Train Loss: 1.791 Vali Loss: 1.637 Vali Acc: 0.481 Test Loss: 1.637 Test Acc: 0.481
Validation loss decreased (-0.268730 --> -0.481234).  Saving model ...
Epoch: 3 cost time: 2.7146670818328857
Epoch: 3, Steps: 8 | Train Loss: 1.293 Vali Loss: 1.377 Vali Acc: 0.553 Test Loss: 1.377 Test Acc: 0.553
Validation loss decreased (-0.481234 --> -0.553111).  Saving model ...
Epoch: 4 cost time: 2.4871022701263428
Epoch: 4, Steps: 8 | Train Loss: 0.959 Vali Loss: 1.228 Vali Acc: 0.572 Test Loss: 1.228 Test Acc: 0.572
Validation loss decreased (-0.553111 --> -0.571863).  Saving model ...
Epoch: 5 cost time: 2.9835667610168457
Epoch: 5, Steps: 8 | Train Loss: 0.632 Vali Loss: 1.174 Vali Acc: 0.575 Test Loss: 1.174 Test Acc: 0.575
Validation loss decreased (-0.571863 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 2.799415111541748
Epoch: 6, Steps: 8 | Train Loss: 0.419 Vali Loss: 1.174 Vali Acc: 0.581 Test Loss: 1.174 Test Acc: 0.581
Validation loss decreased (-0.574988 --> -0.581238).  Saving model ...
Epoch: 7 cost time: 2.9240429401397705
Epoch: 7, Steps: 8 | Train Loss: 0.292 Vali Loss: 1.177 Vali Acc: 0.594 Test Loss: 1.177 Test Acc: 0.594
Validation loss decreased (-0.581238 --> -0.593738).  Saving model ...
Epoch: 8 cost time: 2.5936496257781982
Epoch: 8, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.175 Vali Acc: 0.597 Test Loss: 1.175 Test Acc: 0.597
Validation loss decreased (-0.593738 --> -0.596863).  Saving model ...
Epoch: 9 cost time: 2.5802876949310303
Epoch: 9, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.292 Vali Acc: 0.588 Test Loss: 1.292 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6569106578826904
Epoch: 10, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.295 Vali Acc: 0.559 Test Loss: 1.295 Test Acc: 0.559
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0276808738708496
Epoch: 11, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.349 Vali Acc: 0.581 Test Loss: 1.349 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.064279794692993
Epoch: 12, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.342 Vali Acc: 0.578 Test Loss: 1.342 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.114030122756958
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.385 Vali Acc: 0.569 Test Loss: 1.385 Test Acc: 0.569
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7315640449523926
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.372 Vali Acc: 0.600 Test Loss: 1.372 Test Acc: 0.600
Validation loss decreased (-0.596863 --> -0.599986).  Saving model ...
Epoch: 15 cost time: 2.8475794792175293
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.422 Vali Acc: 0.594 Test Loss: 1.422 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.951909065246582
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.365 Vali Acc: 0.616 Test Loss: 1.365 Test Acc: 0.616
Validation loss decreased (-0.599986 --> -0.615611).  Saving model ...
Epoch: 17 cost time: 2.8248143196105957
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.373 Vali Acc: 0.600 Test Loss: 1.373 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8520214557647705
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.340 Vali Acc: 0.625 Test Loss: 1.340 Test Acc: 0.625
Validation loss decreased (-0.615611 --> -0.624987).  Saving model ...
Epoch: 19 cost time: 2.8130035400390625
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.339 Vali Acc: 0.619 Test Loss: 1.339 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4940247535705566
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.356 Vali Acc: 0.628 Test Loss: 1.356 Test Acc: 0.628
Validation loss decreased (-0.624987 --> -0.628111).  Saving model ...
Epoch: 21 cost time: 2.3360848426818848
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.349 Vali Acc: 0.641 Test Loss: 1.349 Test Acc: 0.641
Validation loss decreased (-0.628111 --> -0.640612).  Saving model ...
Epoch: 22 cost time: 2.517308235168457
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.351 Vali Acc: 0.637 Test Loss: 1.351 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.522878885269165
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.366 Vali Acc: 0.625 Test Loss: 1.366 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7795393466949463
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.340 Vali Acc: 0.622 Test Loss: 1.340 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.9644978046417236
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.333 Vali Acc: 0.641 Test Loss: 1.333 Test Acc: 0.641
Validation loss decreased (-0.640612 --> -0.640612).  Saving model ...
Epoch: 26 cost time: 2.7380080223083496
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.342 Vali Acc: 0.644 Test Loss: 1.342 Test Acc: 0.644
Validation loss decreased (-0.640612 --> -0.643737).  Saving model ...
Epoch: 27 cost time: 2.6776936054229736
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.378 Vali Acc: 0.631 Test Loss: 1.378 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8751657009124756
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.361 Vali Acc: 0.647 Test Loss: 1.361 Test Acc: 0.647
Validation loss decreased (-0.643737 --> -0.646861).  Saving model ...
Epoch: 29 cost time: 2.792552947998047
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.347 Vali Acc: 0.647 Test Loss: 1.347 Test Acc: 0.647
Validation loss decreased (-0.646861 --> -0.646862).  Saving model ...
Epoch: 30 cost time: 3.0272340774536133
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.340 Vali Acc: 0.647 Test Loss: 1.340 Test Acc: 0.647
Validation loss decreased (-0.646862 --> -0.646862).  Saving model ...
Epoch: 31 cost time: 3.051787853240967
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.332 Vali Acc: 0.647 Test Loss: 1.332 Test Acc: 0.647
Validation loss decreased (-0.646862 --> -0.646862).  Saving model ...
Epoch: 32 cost time: 2.5403308868408203
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.332 Vali Acc: 0.662 Test Loss: 1.332 Test Acc: 0.662
Validation loss decreased (-0.646862 --> -0.662487).  Saving model ...
Epoch: 33 cost time: 2.7170660495758057
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.343 Vali Acc: 0.662 Test Loss: 1.343 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.565014123916626
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.368 Vali Acc: 0.650 Test Loss: 1.368 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.960876941680908
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.378 Vali Acc: 0.647 Test Loss: 1.378 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.0197219848632812
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.372 Vali Acc: 0.659 Test Loss: 1.372 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.866008996963501
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.365 Vali Acc: 0.659 Test Loss: 1.365 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.7685132026672363
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.356 Vali Acc: 0.666 Test Loss: 1.356 Test Acc: 0.666
Validation loss decreased (-0.662487 --> -0.665611).  Saving model ...
Epoch: 39 cost time: 2.753567695617676
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.364 Vali Acc: 0.666 Test Loss: 1.364 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.9042882919311523
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.362 Vali Acc: 0.662 Test Loss: 1.362 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.250835418701172
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.360 Vali Acc: 0.662 Test Loss: 1.360 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.2513225078582764
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.666 Test Loss: 1.359 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.8800954818725586
Epoch: 43, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.364 Vali Acc: 0.666 Test Loss: 1.364 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.821946859359741
Epoch: 44, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.373 Vali Acc: 0.666 Test Loss: 1.373 Test Acc: 0.666
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.6150193214416504
Epoch: 45, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.384 Vali Acc: 0.659 Test Loss: 1.384 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.698021650314331
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.387 Vali Acc: 0.659 Test Loss: 1.387 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.9305360317230225
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.666 Test Loss: 1.385 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.028102159500122
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.669 Test Loss: 1.377 Test Acc: 0.669
Validation loss decreased (-0.665611 --> -0.668736).  Saving model ...
Epoch: 49 cost time: 2.5663845539093018
Epoch: 49, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.666 Test Loss: 1.382 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.7033166885375977
Epoch: 50, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.666 Test Loss: 1.388 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.766963005065918
Epoch: 51, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.666 Test Loss: 1.389 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.8830180168151855
Epoch: 52, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.669 Test Loss: 1.390 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.994678020477295
Epoch: 53, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.669 Test Loss: 1.391 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 2.9715468883514404
Epoch: 54, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.666 Test Loss: 1.386 Test Acc: 0.666
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.1073405742645264
Epoch: 55, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.672 Test Loss: 1.383 Test Acc: 0.672
Validation loss decreased (-0.668736 --> -0.671861).  Saving model ...
Epoch: 56 cost time: 2.7923996448516846
Epoch: 56, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.672 Test Loss: 1.386 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.8911919593811035
Epoch: 57, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.672 Test Loss: 1.390 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.6664676666259766
Epoch: 58, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.666 Test Loss: 1.393 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.846374750137329
Epoch: 59, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.669 Test Loss: 1.390 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 2.9041779041290283
Epoch: 60, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.675 Test Loss: 1.388 Test Acc: 0.675
Validation loss decreased (-0.671861 --> -0.674986).  Saving model ...
Epoch: 61 cost time: 2.782414197921753
Epoch: 61, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.675 Test Loss: 1.385 Test Acc: 0.675
Validation loss decreased (-0.674986 --> -0.674986).  Saving model ...
Epoch: 62 cost time: 2.424222230911255
Epoch: 62, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.675 Test Loss: 1.384 Test Acc: 0.675
Validation loss decreased (-0.674986 --> -0.674986).  Saving model ...
Epoch: 63 cost time: 2.5135161876678467
Epoch: 63, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.675 Test Loss: 1.387 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.756347417831421
Epoch: 64, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.675 Test Loss: 1.384 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.931466817855835
Epoch: 65, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.678 Test Loss: 1.393 Test Acc: 0.678
Validation loss decreased (-0.674986 --> -0.678111).  Saving model ...
Epoch: 66 cost time: 3.029139757156372
Epoch: 66, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.678 Test Loss: 1.396 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.9256374835968018
Epoch: 67, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.675 Test Loss: 1.401 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 2.8169453144073486
Epoch: 68, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.669 Test Loss: 1.401 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 2.635408639907837
Epoch: 69, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.672 Test Loss: 1.399 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 2.7178659439086914
Epoch: 70, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.672 Test Loss: 1.396 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 2.9923911094665527
Epoch: 71, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.394 Vali Acc: 0.672 Test Loss: 1.394 Test Acc: 0.672
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 2.7348544597625732
Epoch: 72, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.672 Test Loss: 1.396 Test Acc: 0.672
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 2.768373489379883
Epoch: 73, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.394 Vali Acc: 0.675 Test Loss: 1.394 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 2.5134165287017822
Epoch: 74, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.678 Test Loss: 1.396 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 2.5586321353912354
Epoch: 75, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.684 Test Loss: 1.401 Test Acc: 0.684
Validation loss decreased (-0.678111 --> -0.684361).  Saving model ...
Epoch: 76 cost time: 2.7566773891448975
Epoch: 76, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.684 Test Loss: 1.403 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 3.0859694480895996
Epoch: 77, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.684 Test Loss: 1.401 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 3.0902769565582275
Epoch: 78, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.681 Test Loss: 1.397 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 2.848493814468384
Epoch: 79, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.681 Test Loss: 1.403 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 2.9008727073669434
Epoch: 80, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.681 Test Loss: 1.409 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 2.9521543979644775
Epoch: 81, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.688 Test Loss: 1.407 Test Acc: 0.688
Validation loss decreased (-0.684361 --> -0.687486).  Saving model ...
Epoch: 82 cost time: 3.0809237957000732
Epoch: 82, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.684 Test Loss: 1.409 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 3.2202866077423096
Epoch: 83, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.684 Test Loss: 1.411 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 3.36152720451355
Epoch: 84, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.681 Test Loss: 1.414 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 2.7615387439727783
Epoch: 85, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.681 Test Loss: 1.417 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 2.704150915145874
Epoch: 86, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.684 Test Loss: 1.419 Test Acc: 0.684
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 2.820486307144165
Epoch: 87, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.684 Test Loss: 1.420 Test Acc: 0.684
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 2.664414882659912
Epoch: 88, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.684 Test Loss: 1.416 Test Acc: 0.684
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 2.693732738494873
Epoch: 89, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.688 Test Loss: 1.414 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 2.6851260662078857
Epoch: 90, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.688 Test Loss: 1.412 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 3.1136956214904785
Epoch: 91, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.691 Test Loss: 1.411 Test Acc: 0.691
Validation loss decreased (-0.687486 --> -0.690611).  Saving model ...
Epoch: 92 cost time: 3.1475205421447754
Epoch: 92, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.691 Test Loss: 1.410 Test Acc: 0.691
Validation loss decreased (-0.690611 --> -0.690611).  Saving model ...
Epoch: 93 cost time: 2.8519508838653564
Epoch: 93, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.688 Test Loss: 1.415 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 2.9865620136260986
Epoch: 94, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.688 Test Loss: 1.418 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 2.769878387451172
Epoch: 95, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.688 Test Loss: 1.419 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 2.951239824295044
Epoch: 96, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.691 Test Loss: 1.416 Test Acc: 0.691
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 2.8963735103607178
Epoch: 97, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.694 Test Loss: 1.416 Test Acc: 0.694
Validation loss decreased (-0.690611 --> -0.693736).  Saving model ...
Epoch: 98 cost time: 2.495867967605591
Epoch: 98, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.694 Test Loss: 1.417 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 2.6789710521698
Epoch: 99, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.691 Test Loss: 1.414 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 2.8038837909698486
Epoch: 100, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.691 Test Loss: 1.415 Test Acc: 0.691
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.69375
model parameter : 1083656
model size : 9.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.211527347564697
Epoch: 1, Steps: 8 | Train Loss: 2.178 Vali Loss: 2.040 Vali Acc: 0.159 Test Loss: 2.040 Test Acc: 0.159
Validation loss decreased (inf --> -0.159355).  Saving model ...
Epoch: 2 cost time: 2.848398447036743
Epoch: 2, Steps: 8 | Train Loss: 1.875 Vali Loss: 1.855 Vali Acc: 0.312 Test Loss: 1.855 Test Acc: 0.312
Validation loss decreased (-0.159355 --> -0.312481).  Saving model ...
Epoch: 3 cost time: 2.7144834995269775
Epoch: 3, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.671 Vali Acc: 0.431 Test Loss: 1.671 Test Acc: 0.431
Validation loss decreased (-0.312481 --> -0.431233).  Saving model ...
Epoch: 4 cost time: 3.431457281112671
Epoch: 4, Steps: 8 | Train Loss: 1.212 Vali Loss: 1.505 Vali Acc: 0.438 Test Loss: 1.505 Test Acc: 0.438
Validation loss decreased (-0.431233 --> -0.437485).  Saving model ...
Epoch: 5 cost time: 3.3209621906280518
Epoch: 5, Steps: 8 | Train Loss: 0.849 Vali Loss: 1.497 Vali Acc: 0.419 Test Loss: 1.497 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9170286655426025
Epoch: 6, Steps: 8 | Train Loss: 0.649 Vali Loss: 1.528 Vali Acc: 0.409 Test Loss: 1.528 Test Acc: 0.409
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.883780002593994
Epoch: 7, Steps: 8 | Train Loss: 0.448 Vali Loss: 1.440 Vali Acc: 0.478 Test Loss: 1.440 Test Acc: 0.478
Validation loss decreased (-0.437485 --> -0.478111).  Saving model ...
Epoch: 8 cost time: 3.188157320022583
Epoch: 8, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.447 Vali Acc: 0.481 Test Loss: 1.447 Test Acc: 0.481
Validation loss decreased (-0.478111 --> -0.481236).  Saving model ...
Epoch: 9 cost time: 3.1963398456573486
Epoch: 9, Steps: 8 | Train Loss: 0.295 Vali Loss: 1.628 Vali Acc: 0.434 Test Loss: 1.628 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8441100120544434
Epoch: 10, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.493 Vali Acc: 0.466 Test Loss: 1.493 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7615880966186523
Epoch: 11, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.711 Vali Acc: 0.456 Test Loss: 1.711 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.086846113204956
Epoch: 12, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.635 Vali Acc: 0.463 Test Loss: 1.635 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.09552001953125
Epoch: 13, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.744 Vali Acc: 0.438 Test Loss: 1.744 Test Acc: 0.438
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.944004774093628
Epoch: 14, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.865 Vali Acc: 0.438 Test Loss: 1.865 Test Acc: 0.438
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7830588817596436
Epoch: 15, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.686 Vali Acc: 0.497 Test Loss: 1.686 Test Acc: 0.497
Validation loss decreased (-0.481236 --> -0.496858).  Saving model ...
Epoch: 16 cost time: 2.7091917991638184
Epoch: 16, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.970 Vali Acc: 0.459 Test Loss: 1.970 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5467140674591064
Epoch: 17, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.758 Vali Acc: 0.522 Test Loss: 1.758 Test Acc: 0.522
Validation loss decreased (-0.496858 --> -0.521857).  Saving model ...
Epoch: 18 cost time: 3.4569571018218994
Epoch: 18, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.939 Vali Acc: 0.463 Test Loss: 1.939 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.406149387359619
Epoch: 19, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.817 Vali Acc: 0.487 Test Loss: 1.817 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1385445594787598
Epoch: 20, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.758 Vali Acc: 0.506 Test Loss: 1.758 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.994372844696045
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.144 Vali Acc: 0.450 Test Loss: 2.144 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.2986652851104736
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.015 Vali Acc: 0.456 Test Loss: 2.015 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.7657954692840576
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.962 Vali Acc: 0.466 Test Loss: 1.962 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.2521917819976807
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.975 Vali Acc: 0.459 Test Loss: 1.975 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8336288928985596
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.900 Vali Acc: 0.487 Test Loss: 1.900 Test Acc: 0.487
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.1661031246185303
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.979 Vali Acc: 0.484 Test Loss: 1.979 Test Acc: 0.484
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.295811414718628
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.946 Vali Acc: 0.494 Test Loss: 1.946 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.521875
model parameter : 1083656
model size : 9.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.751170635223389
Epoch: 1, Steps: 8 | Train Loss: 2.138 Vali Loss: 2.051 Vali Acc: 0.172 Test Loss: 2.051 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 3.325540781021118
Epoch: 2, Steps: 8 | Train Loss: 1.937 Vali Loss: 1.948 Vali Acc: 0.241 Test Loss: 1.948 Test Acc: 0.241
Validation loss decreased (-0.171854 --> -0.240606).  Saving model ...
Epoch: 3 cost time: 3.1589176654815674
Epoch: 3, Steps: 8 | Train Loss: 1.652 Vali Loss: 1.836 Vali Acc: 0.306 Test Loss: 1.836 Test Acc: 0.306
Validation loss decreased (-0.240606 --> -0.306232).  Saving model ...
Epoch: 4 cost time: 2.783722162246704
Epoch: 4, Steps: 8 | Train Loss: 1.366 Vali Loss: 1.690 Vali Acc: 0.419 Test Loss: 1.690 Test Acc: 0.419
Validation loss decreased (-0.306232 --> -0.418733).  Saving model ...
Epoch: 5 cost time: 2.8257036209106445
Epoch: 5, Steps: 8 | Train Loss: 1.027 Vali Loss: 1.658 Vali Acc: 0.369 Test Loss: 1.658 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8430213928222656
Epoch: 6, Steps: 8 | Train Loss: 0.792 Vali Loss: 1.703 Vali Acc: 0.228 Test Loss: 1.703 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.990178108215332
Epoch: 7, Steps: 8 | Train Loss: 0.586 Vali Loss: 1.534 Vali Acc: 0.403 Test Loss: 1.534 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.248476505279541
Epoch: 8, Steps: 8 | Train Loss: 0.483 Vali Loss: 1.525 Vali Acc: 0.394 Test Loss: 1.525 Test Acc: 0.394
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.986241340637207
Epoch: 9, Steps: 8 | Train Loss: 0.385 Vali Loss: 1.752 Vali Acc: 0.319 Test Loss: 1.752 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.813568115234375
Epoch: 10, Steps: 8 | Train Loss: 0.286 Vali Loss: 1.520 Vali Acc: 0.381 Test Loss: 1.520 Test Acc: 0.381
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2841830253601074
Epoch: 11, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.955 Vali Acc: 0.272 Test Loss: 1.955 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.012951374053955
Epoch: 12, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.411 Vali Acc: 0.494 Test Loss: 1.411 Test Acc: 0.494
Validation loss decreased (-0.418733 --> -0.493736).  Saving model ...
Epoch: 13 cost time: 3.085155963897705
Epoch: 13, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.940 Vali Acc: 0.338 Test Loss: 1.940 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.636240005493164
Epoch: 14, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.828 Vali Acc: 0.372 Test Loss: 1.828 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.631808280944824
Epoch: 15, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.597 Vali Acc: 0.438 Test Loss: 1.597 Test Acc: 0.438
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3236730098724365
Epoch: 16, Steps: 8 | Train Loss: 0.058 Vali Loss: 2.170 Vali Acc: 0.344 Test Loss: 2.170 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.103083372116089
Epoch: 17, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.628 Vali Acc: 0.475 Test Loss: 1.628 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9462733268737793
Epoch: 18, Steps: 8 | Train Loss: 0.053 Vali Loss: 2.022 Vali Acc: 0.406 Test Loss: 2.022 Test Acc: 0.406
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.7616727352142334
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.754 Vali Acc: 0.447 Test Loss: 1.754 Test Acc: 0.447
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.9028587341308594
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 2.050 Vali Acc: 0.362 Test Loss: 2.050 Test Acc: 0.362
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.879326581954956
Epoch: 21, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.206 Vali Acc: 0.347 Test Loss: 2.206 Test Acc: 0.347
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.039186954498291
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.964 Vali Acc: 0.412 Test Loss: 1.964 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.49375
model parameter : 1083656
model size : 9.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.85003662109375
Epoch: 1, Steps: 8 | Train Loss: 2.169 Vali Loss: 2.059 Vali Acc: 0.175 Test Loss: 2.059 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 2.9328205585479736
Epoch: 2, Steps: 8 | Train Loss: 1.931 Vali Loss: 1.973 Vali Acc: 0.250 Test Loss: 1.973 Test Acc: 0.250
Validation loss decreased (-0.174979 --> -0.249980).  Saving model ...
Epoch: 3 cost time: 3.0524563789367676
Epoch: 3, Steps: 8 | Train Loss: 1.694 Vali Loss: 1.875 Vali Acc: 0.338 Test Loss: 1.875 Test Acc: 0.338
Validation loss decreased (-0.249980 --> -0.337481).  Saving model ...
Epoch: 4 cost time: 3.137279987335205
Epoch: 4, Steps: 8 | Train Loss: 1.427 Vali Loss: 1.766 Vali Acc: 0.487 Test Loss: 1.766 Test Acc: 0.487
Validation loss decreased (-0.337481 --> -0.487482).  Saving model ...
Epoch: 5 cost time: 3.092745065689087
Epoch: 5, Steps: 8 | Train Loss: 1.042 Vali Loss: 1.694 Vali Acc: 0.384 Test Loss: 1.694 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8935253620147705
Epoch: 6, Steps: 8 | Train Loss: 0.804 Vali Loss: 1.632 Vali Acc: 0.344 Test Loss: 1.632 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.797044277191162
Epoch: 7, Steps: 8 | Train Loss: 0.586 Vali Loss: 1.524 Vali Acc: 0.384 Test Loss: 1.524 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1828064918518066
Epoch: 8, Steps: 8 | Train Loss: 0.487 Vali Loss: 1.416 Vali Acc: 0.541 Test Loss: 1.416 Test Acc: 0.541
Validation loss decreased (-0.487482 --> -0.540611).  Saving model ...
Epoch: 9 cost time: 3.3713743686676025
Epoch: 9, Steps: 8 | Train Loss: 0.383 Vali Loss: 1.577 Vali Acc: 0.347 Test Loss: 1.577 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.116178512573242
Epoch: 10, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.364 Vali Acc: 0.444 Test Loss: 1.364 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1347382068634033
Epoch: 11, Steps: 8 | Train Loss: 0.230 Vali Loss: 1.639 Vali Acc: 0.356 Test Loss: 1.639 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3942081928253174
Epoch: 12, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.268 Vali Acc: 0.550 Test Loss: 1.268 Test Acc: 0.550
Validation loss decreased (-0.540611 --> -0.549987).  Saving model ...
Epoch: 13 cost time: 3.3105626106262207
Epoch: 13, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.618 Vali Acc: 0.400 Test Loss: 1.618 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1571614742279053
Epoch: 14, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.324 Vali Acc: 0.503 Test Loss: 1.324 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.506929636001587
Epoch: 15, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.462 Vali Acc: 0.444 Test Loss: 1.462 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.5750298500061035
Epoch: 16, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.496 Vali Acc: 0.416 Test Loss: 1.496 Test Acc: 0.416
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.897691011428833
Epoch: 17, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.441 Vali Acc: 0.503 Test Loss: 1.441 Test Acc: 0.503
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.040534257888794
Epoch: 18, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.579 Vali Acc: 0.412 Test Loss: 1.579 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.2751030921936035
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.545 Vali Acc: 0.469 Test Loss: 1.545 Test Acc: 0.469
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.0781662464141846
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.664 Vali Acc: 0.438 Test Loss: 1.664 Test Acc: 0.438
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.8073344230651855
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.867 Vali Acc: 0.406 Test Loss: 1.867 Test Acc: 0.406
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.4790005683898926
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.521 Vali Acc: 0.497 Test Loss: 1.521 Test Acc: 0.497
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.55
model parameter : 1083656
model size : 9.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.977299451828003
Epoch: 1, Steps: 8 | Train Loss: 2.163 Vali Loss: 2.080 Vali Acc: 0.116 Test Loss: 2.080 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 3.3407905101776123
Epoch: 2, Steps: 8 | Train Loss: 1.921 Vali Loss: 2.002 Vali Acc: 0.237 Test Loss: 2.002 Test Acc: 0.237
Validation loss decreased (-0.115604 --> -0.237480).  Saving model ...
Epoch: 3 cost time: 2.9523262977600098
Epoch: 3, Steps: 8 | Train Loss: 1.674 Vali Loss: 1.905 Vali Acc: 0.334 Test Loss: 1.905 Test Acc: 0.334
Validation loss decreased (-0.237480 --> -0.334356).  Saving model ...
Epoch: 4 cost time: 3.112788677215576
Epoch: 4, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.799 Vali Acc: 0.350 Test Loss: 1.799 Test Acc: 0.350
Validation loss decreased (-0.334356 --> -0.349982).  Saving model ...
Epoch: 5 cost time: 3.0476787090301514
Epoch: 5, Steps: 8 | Train Loss: 0.944 Vali Loss: 1.705 Vali Acc: 0.431 Test Loss: 1.705 Test Acc: 0.431
Validation loss decreased (-0.349982 --> -0.431233).  Saving model ...
Epoch: 6 cost time: 3.326071262359619
Epoch: 6, Steps: 8 | Train Loss: 0.709 Vali Loss: 1.610 Vali Acc: 0.362 Test Loss: 1.610 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.172419786453247
Epoch: 7, Steps: 8 | Train Loss: 0.523 Vali Loss: 1.477 Vali Acc: 0.506 Test Loss: 1.477 Test Acc: 0.506
Validation loss decreased (-0.431233 --> -0.506235).  Saving model ...
Epoch: 8 cost time: 2.865891456604004
Epoch: 8, Steps: 8 | Train Loss: 0.439 Vali Loss: 1.355 Vali Acc: 0.512 Test Loss: 1.355 Test Acc: 0.512
Validation loss decreased (-0.506235 --> -0.512486).  Saving model ...
Epoch: 9 cost time: 2.996819257736206
Epoch: 9, Steps: 8 | Train Loss: 0.337 Vali Loss: 1.392 Vali Acc: 0.438 Test Loss: 1.392 Test Acc: 0.438
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2887938022613525
Epoch: 10, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.305 Vali Acc: 0.509 Test Loss: 1.305 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3425419330596924
Epoch: 11, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.338 Vali Acc: 0.500 Test Loss: 1.338 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.966074228286743
Epoch: 12, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.263 Vali Acc: 0.550 Test Loss: 1.263 Test Acc: 0.550
Validation loss decreased (-0.512486 --> -0.549987).  Saving model ...
Epoch: 13 cost time: 3.249702215194702
Epoch: 13, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.424 Vali Acc: 0.494 Test Loss: 1.424 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.512981414794922
Epoch: 14, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.299 Vali Acc: 0.522 Test Loss: 1.299 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4367754459381104
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.341 Vali Acc: 0.534 Test Loss: 1.341 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8732967376708984
Epoch: 16, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.628 Vali Acc: 0.431 Test Loss: 1.628 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.21907901763916
Epoch: 17, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.502 Vali Acc: 0.500 Test Loss: 1.502 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.368760108947754
Epoch: 18, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.499 Vali Acc: 0.509 Test Loss: 1.499 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.294252634048462
Epoch: 19, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.646 Vali Acc: 0.463 Test Loss: 1.646 Test Acc: 0.463
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.8243794441223145
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.675 Vali Acc: 0.481 Test Loss: 1.675 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.1462652683258057
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.602 Vali Acc: 0.534 Test Loss: 1.602 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.5343971252441406
Epoch: 22, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.567 Vali Acc: 0.528 Test Loss: 1.567 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.55
model parameter : 1083656
model size : 9.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.711183071136475
Epoch: 1, Steps: 8 | Train Loss: 2.150 Vali Loss: 2.102 Vali Acc: 0.141 Test Loss: 2.102 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 3.167153835296631
Epoch: 2, Steps: 8 | Train Loss: 1.943 Vali Loss: 1.983 Vali Acc: 0.178 Test Loss: 1.983 Test Acc: 0.178
Validation loss decreased (-0.140604 --> -0.178105).  Saving model ...
Epoch: 3 cost time: 3.4688611030578613
Epoch: 3, Steps: 8 | Train Loss: 1.741 Vali Loss: 1.801 Vali Acc: 0.362 Test Loss: 1.801 Test Acc: 0.362
Validation loss decreased (-0.178105 --> -0.362482).  Saving model ...
Epoch: 4 cost time: 2.86072039604187
Epoch: 4, Steps: 8 | Train Loss: 1.457 Vali Loss: 1.592 Vali Acc: 0.475 Test Loss: 1.592 Test Acc: 0.475
Validation loss decreased (-0.362482 --> -0.474984).  Saving model ...
Epoch: 5 cost time: 3.1047306060791016
Epoch: 5, Steps: 8 | Train Loss: 1.025 Vali Loss: 1.477 Vali Acc: 0.459 Test Loss: 1.477 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1620395183563232
Epoch: 6, Steps: 8 | Train Loss: 0.797 Vali Loss: 1.326 Vali Acc: 0.509 Test Loss: 1.326 Test Acc: 0.509
Validation loss decreased (-0.474984 --> -0.509362).  Saving model ...
Epoch: 7 cost time: 3.3538877964019775
Epoch: 7, Steps: 8 | Train Loss: 0.568 Vali Loss: 1.303 Vali Acc: 0.506 Test Loss: 1.303 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0968282222747803
Epoch: 8, Steps: 8 | Train Loss: 0.460 Vali Loss: 1.306 Vali Acc: 0.506 Test Loss: 1.306 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1566874980926514
Epoch: 9, Steps: 8 | Train Loss: 0.368 Vali Loss: 1.406 Vali Acc: 0.494 Test Loss: 1.406 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.670166254043579
Epoch: 10, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.568 Vali Acc: 0.491 Test Loss: 1.568 Test Acc: 0.491
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.951749324798584
Epoch: 11, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.602 Vali Acc: 0.503 Test Loss: 1.602 Test Acc: 0.503
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.4148454666137695
Epoch: 12, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.894 Vali Acc: 0.478 Test Loss: 1.894 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.2055134773254395
Epoch: 13, Steps: 8 | Train Loss: 0.128 Vali Loss: 2.059 Vali Acc: 0.450 Test Loss: 2.059 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8752896785736084
Epoch: 14, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.941 Vali Acc: 0.459 Test Loss: 1.941 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.738752841949463
Epoch: 15, Steps: 8 | Train Loss: 0.083 Vali Loss: 2.064 Vali Acc: 0.428 Test Loss: 2.064 Test Acc: 0.428
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.2599918842315674
Epoch: 16, Steps: 8 | Train Loss: 0.075 Vali Loss: 2.382 Vali Acc: 0.434 Test Loss: 2.382 Test Acc: 0.434
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.509375
model parameter : 1083656
model size : 9.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.945834398269653
Epoch: 1, Steps: 8 | Train Loss: 2.186 Vali Loss: 2.063 Vali Acc: 0.150 Test Loss: 2.063 Test Acc: 0.150
Validation loss decreased (inf --> -0.149979).  Saving model ...
Epoch: 2 cost time: 3.1786186695098877
Epoch: 2, Steps: 8 | Train Loss: 2.056 Vali Loss: 1.944 Vali Acc: 0.203 Test Loss: 1.944 Test Acc: 0.203
Validation loss decreased (-0.149979 --> -0.203106).  Saving model ...
Epoch: 3 cost time: 3.2531802654266357
Epoch: 3, Steps: 8 | Train Loss: 1.755 Vali Loss: 1.780 Vali Acc: 0.300 Test Loss: 1.780 Test Acc: 0.300
Validation loss decreased (-0.203106 --> -0.299982).  Saving model ...
Epoch: 4 cost time: 2.782505750656128
Epoch: 4, Steps: 8 | Train Loss: 1.493 Vali Loss: 1.576 Vali Acc: 0.519 Test Loss: 1.576 Test Acc: 0.519
Validation loss decreased (-0.299982 --> -0.518734).  Saving model ...
Epoch: 5 cost time: 2.851227045059204
Epoch: 5, Steps: 8 | Train Loss: 1.164 Vali Loss: 1.410 Vali Acc: 0.584 Test Loss: 1.410 Test Acc: 0.584
Validation loss decreased (-0.518734 --> -0.584361).  Saving model ...
Epoch: 6 cost time: 3.2379555702209473
Epoch: 6, Steps: 8 | Train Loss: 0.873 Vali Loss: 1.335 Vali Acc: 0.497 Test Loss: 1.335 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1567962169647217
Epoch: 7, Steps: 8 | Train Loss: 0.676 Vali Loss: 1.330 Vali Acc: 0.487 Test Loss: 1.330 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.962632894515991
Epoch: 8, Steps: 8 | Train Loss: 0.570 Vali Loss: 1.449 Vali Acc: 0.444 Test Loss: 1.449 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.969743013381958
Epoch: 9, Steps: 8 | Train Loss: 0.417 Vali Loss: 1.605 Vali Acc: 0.444 Test Loss: 1.605 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.014281749725342
Epoch: 10, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.673 Vali Acc: 0.491 Test Loss: 1.673 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.286747455596924
Epoch: 11, Steps: 8 | Train Loss: 0.248 Vali Loss: 1.757 Vali Acc: 0.484 Test Loss: 1.757 Test Acc: 0.484
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.946290969848633
Epoch: 12, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.922 Vali Acc: 0.494 Test Loss: 1.922 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0536158084869385
Epoch: 13, Steps: 8 | Train Loss: 0.165 Vali Loss: 2.226 Vali Acc: 0.416 Test Loss: 2.226 Test Acc: 0.416
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.403254508972168
Epoch: 14, Steps: 8 | Train Loss: 0.120 Vali Loss: 2.039 Vali Acc: 0.447 Test Loss: 2.039 Test Acc: 0.447
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.3977324962615967
Epoch: 15, Steps: 8 | Train Loss: 0.081 Vali Loss: 2.158 Vali Acc: 0.484 Test Loss: 2.158 Test Acc: 0.484
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.584375
model parameter : 1083656
model size : 9.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.55427885055542
Epoch: 1, Steps: 8 | Train Loss: 2.120 Vali Loss: 1.872 Vali Acc: 0.384 Test Loss: 1.872 Test Acc: 0.384
Validation loss decreased (inf --> -0.384356).  Saving model ...
Epoch: 2 cost time: 3.2555670738220215
Epoch: 2, Steps: 8 | Train Loss: 1.627 Vali Loss: 1.340 Vali Acc: 0.725 Test Loss: 1.340 Test Acc: 0.725
Validation loss decreased (-0.384356 --> -0.724987).  Saving model ...
Epoch: 3 cost time: 2.6626195907592773
Epoch: 3, Steps: 8 | Train Loss: 1.091 Vali Loss: 0.959 Vali Acc: 0.753 Test Loss: 0.959 Test Acc: 0.753
Validation loss decreased (-0.724987 --> -0.753115).  Saving model ...
Epoch: 4 cost time: 2.867936849594116
Epoch: 4, Steps: 8 | Train Loss: 0.718 Vali Loss: 0.779 Vali Acc: 0.769 Test Loss: 0.779 Test Acc: 0.769
Validation loss decreased (-0.753115 --> -0.768742).  Saving model ...
Epoch: 5 cost time: 2.986720561981201
Epoch: 5, Steps: 8 | Train Loss: 0.481 Vali Loss: 0.716 Vali Acc: 0.775 Test Loss: 0.716 Test Acc: 0.775
Validation loss decreased (-0.768742 --> -0.774993).  Saving model ...
Epoch: 6 cost time: 2.9643759727478027
Epoch: 6, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.640 Vali Acc: 0.797 Test Loss: 0.640 Test Acc: 0.797
Validation loss decreased (-0.774993 --> -0.796869).  Saving model ...
Epoch: 7 cost time: 2.777169942855835
Epoch: 7, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.661 Vali Acc: 0.766 Test Loss: 0.661 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4213781356811523
Epoch: 8, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.687 Vali Acc: 0.797 Test Loss: 0.687 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.231645107269287
Epoch: 9, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.703 Vali Acc: 0.784 Test Loss: 0.703 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.983570098876953
Epoch: 10, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.769 Vali Acc: 0.753 Test Loss: 0.769 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.903952121734619
Epoch: 11, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.794 Vali Acc: 0.769 Test Loss: 0.794 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.305047035217285
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.776 Vali Acc: 0.772 Test Loss: 0.776 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.685863733291626
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.775 Vali Acc: 0.769 Test Loss: 0.775 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8597910404205322
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.787 Vali Acc: 0.794 Test Loss: 0.787 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.2576606273651123
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.806 Vali Acc: 0.781 Test Loss: 0.806 Test Acc: 0.781
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.1037485599517822
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.817 Vali Acc: 0.787 Test Loss: 0.817 Test Acc: 0.787
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.796875
model parameter : 1115272
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.722777605056763
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 1.943 Vali Acc: 0.281 Test Loss: 1.943 Test Acc: 0.281
Validation loss decreased (inf --> -0.281231).  Saving model ...
Epoch: 2 cost time: 3.2658774852752686
Epoch: 2, Steps: 8 | Train Loss: 1.721 Vali Loss: 1.517 Vali Acc: 0.619 Test Loss: 1.517 Test Acc: 0.619
Validation loss decreased (-0.281231 --> -0.618735).  Saving model ...
Epoch: 3 cost time: 3.2130751609802246
Epoch: 3, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.175 Vali Acc: 0.662 Test Loss: 1.175 Test Acc: 0.662
Validation loss decreased (-0.618735 --> -0.662488).  Saving model ...
Epoch: 4 cost time: 3.0543341636657715
Epoch: 4, Steps: 8 | Train Loss: 0.861 Vali Loss: 1.017 Vali Acc: 0.694 Test Loss: 1.017 Test Acc: 0.694
Validation loss decreased (-0.662488 --> -0.693740).  Saving model ...
Epoch: 5 cost time: 3.184387683868408
Epoch: 5, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.918 Vali Acc: 0.709 Test Loss: 0.918 Test Acc: 0.709
Validation loss decreased (-0.693740 --> -0.709366).  Saving model ...
Epoch: 6 cost time: 3.2221243381500244
Epoch: 6, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.831 Vali Acc: 0.700 Test Loss: 0.831 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.986025333404541
Epoch: 7, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.833 Vali Acc: 0.713 Test Loss: 0.833 Test Acc: 0.713
Validation loss decreased (-0.709366 --> -0.712492).  Saving model ...
Epoch: 8 cost time: 3.066763401031494
Epoch: 8, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.832 Vali Acc: 0.709 Test Loss: 0.832 Test Acc: 0.709
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.971555709838867
Epoch: 9, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.900 Vali Acc: 0.709 Test Loss: 0.900 Test Acc: 0.709
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.822313070297241
Epoch: 10, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.986 Vali Acc: 0.691 Test Loss: 0.986 Test Acc: 0.691
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.662513256072998
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.009 Vali Acc: 0.694 Test Loss: 1.009 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.91980242729187
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.999 Vali Acc: 0.703 Test Loss: 0.999 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8312063217163086
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.985 Vali Acc: 0.709 Test Loss: 0.985 Test Acc: 0.709
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9013173580169678
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.994 Vali Acc: 0.734 Test Loss: 0.994 Test Acc: 0.734
Validation loss decreased (-0.712492 --> -0.734365).  Saving model ...
Epoch: 15 cost time: 2.9322311878204346
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.015 Vali Acc: 0.728 Test Loss: 1.015 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2402212619781494
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.029 Vali Acc: 0.728 Test Loss: 1.029 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.993589401245117
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.026 Vali Acc: 0.725 Test Loss: 1.026 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.188328266143799
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.029 Vali Acc: 0.722 Test Loss: 1.029 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.917402982711792
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.039 Vali Acc: 0.725 Test Loss: 1.039 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.636025905609131
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.040 Vali Acc: 0.734 Test Loss: 1.040 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.065492630004883
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.037 Vali Acc: 0.731 Test Loss: 1.037 Test Acc: 0.731
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.7417945861816406
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.044 Vali Acc: 0.725 Test Loss: 1.044 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.6719887256622314
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.056 Vali Acc: 0.722 Test Loss: 1.056 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.856869697570801
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.061 Vali Acc: 0.722 Test Loss: 1.061 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.734375
model parameter : 1115272
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.301117897033691
Epoch: 1, Steps: 8 | Train Loss: 2.146 Vali Loss: 1.975 Vali Acc: 0.200 Test Loss: 1.975 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 3.3390352725982666
Epoch: 2, Steps: 8 | Train Loss: 1.820 Vali Loss: 1.648 Vali Acc: 0.537 Test Loss: 1.648 Test Acc: 0.537
Validation loss decreased (-0.199980 --> -0.537484).  Saving model ...
Epoch: 3 cost time: 3.2395262718200684
Epoch: 3, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.322 Vali Acc: 0.622 Test Loss: 1.322 Test Acc: 0.622
Validation loss decreased (-0.537484 --> -0.621862).  Saving model ...
Epoch: 4 cost time: 2.810786008834839
Epoch: 4, Steps: 8 | Train Loss: 1.009 Vali Loss: 1.131 Vali Acc: 0.634 Test Loss: 1.131 Test Acc: 0.634
Validation loss decreased (-0.621862 --> -0.634364).  Saving model ...
Epoch: 5 cost time: 2.6265933513641357
Epoch: 5, Steps: 8 | Train Loss: 0.711 Vali Loss: 1.028 Vali Acc: 0.656 Test Loss: 1.028 Test Acc: 0.656
Validation loss decreased (-0.634364 --> -0.656240).  Saving model ...
Epoch: 6 cost time: 2.9086556434631348
Epoch: 6, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.942 Vali Acc: 0.678 Test Loss: 0.942 Test Acc: 0.678
Validation loss decreased (-0.656240 --> -0.678116).  Saving model ...
Epoch: 7 cost time: 2.878700017929077
Epoch: 7, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.940 Vali Acc: 0.662 Test Loss: 0.940 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8868558406829834
Epoch: 8, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.918 Vali Acc: 0.694 Test Loss: 0.918 Test Acc: 0.694
Validation loss decreased (-0.678116 --> -0.693741).  Saving model ...
Epoch: 9 cost time: 2.8950040340423584
Epoch: 9, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.948 Vali Acc: 0.688 Test Loss: 0.948 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.892277717590332
Epoch: 10, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.015 Vali Acc: 0.662 Test Loss: 1.015 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0756845474243164
Epoch: 11, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.058 Vali Acc: 0.691 Test Loss: 1.058 Test Acc: 0.691
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.1253135204315186
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.095 Vali Acc: 0.694 Test Loss: 1.095 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1365573406219482
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.110 Vali Acc: 0.678 Test Loss: 1.110 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2255825996398926
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.125 Vali Acc: 0.669 Test Loss: 1.125 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7979543209075928
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.128 Vali Acc: 0.694 Test Loss: 1.128 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.175354480743408
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.140 Vali Acc: 0.697 Test Loss: 1.140 Test Acc: 0.697
Validation loss decreased (-0.693741 --> -0.696864).  Saving model ...
Epoch: 17 cost time: 3.029329776763916
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.136 Vali Acc: 0.688 Test Loss: 1.136 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9470973014831543
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.147 Vali Acc: 0.681 Test Loss: 1.147 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8713464736938477
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.163 Vali Acc: 0.688 Test Loss: 1.163 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0626935958862305
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.160 Vali Acc: 0.678 Test Loss: 1.160 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.8590967655181885
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.171 Vali Acc: 0.684 Test Loss: 1.171 Test Acc: 0.684
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.959812641143799
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.184 Vali Acc: 0.684 Test Loss: 1.184 Test Acc: 0.684
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.209073543548584
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.187 Vali Acc: 0.691 Test Loss: 1.187 Test Acc: 0.691
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.34779953956604
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.181 Vali Acc: 0.694 Test Loss: 1.181 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.8179686069488525
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.183 Vali Acc: 0.691 Test Loss: 1.183 Test Acc: 0.691
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.0419867038726807
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.191 Vali Acc: 0.688 Test Loss: 1.191 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.696875
model parameter : 1115272
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.185383319854736
Epoch: 1, Steps: 8 | Train Loss: 2.144 Vali Loss: 1.987 Vali Acc: 0.206 Test Loss: 1.987 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 2.977879524230957
Epoch: 2, Steps: 8 | Train Loss: 1.922 Vali Loss: 1.782 Vali Acc: 0.403 Test Loss: 1.782 Test Acc: 0.403
Validation loss decreased (-0.206230 --> -0.403107).  Saving model ...
Epoch: 3 cost time: 3.094461679458618
Epoch: 3, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.528 Vali Acc: 0.556 Test Loss: 1.528 Test Acc: 0.556
Validation loss decreased (-0.403107 --> -0.556235).  Saving model ...
Epoch: 4 cost time: 2.8420045375823975
Epoch: 4, Steps: 8 | Train Loss: 1.292 Vali Loss: 1.328 Vali Acc: 0.619 Test Loss: 1.328 Test Acc: 0.619
Validation loss decreased (-0.556235 --> -0.618737).  Saving model ...
Epoch: 5 cost time: 2.759343385696411
Epoch: 5, Steps: 8 | Train Loss: 0.965 Vali Loss: 1.187 Vali Acc: 0.594 Test Loss: 1.187 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8397059440612793
Epoch: 6, Steps: 8 | Train Loss: 0.689 Vali Loss: 1.091 Vali Acc: 0.616 Test Loss: 1.091 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.861703872680664
Epoch: 7, Steps: 8 | Train Loss: 0.502 Vali Loss: 1.021 Vali Acc: 0.637 Test Loss: 1.021 Test Acc: 0.637
Validation loss decreased (-0.618737 --> -0.637490).  Saving model ...
Epoch: 8 cost time: 2.834169864654541
Epoch: 8, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.989 Vali Acc: 0.653 Test Loss: 0.989 Test Acc: 0.653
Validation loss decreased (-0.637490 --> -0.653115).  Saving model ...
Epoch: 9 cost time: 2.7638425827026367
Epoch: 9, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.984 Vali Acc: 0.653 Test Loss: 0.984 Test Acc: 0.653
Validation loss decreased (-0.653115 --> -0.653115).  Saving model ...
Epoch: 10 cost time: 2.919999122619629
Epoch: 10, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.054 Vali Acc: 0.613 Test Loss: 1.054 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.745915412902832
Epoch: 11, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.068 Vali Acc: 0.616 Test Loss: 1.068 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8501152992248535
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.099 Vali Acc: 0.622 Test Loss: 1.099 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9817118644714355
Epoch: 13, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.224 Vali Acc: 0.603 Test Loss: 1.224 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2614963054656982
Epoch: 14, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.199 Vali Acc: 0.619 Test Loss: 1.199 Test Acc: 0.619
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.185978889465332
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.140 Vali Acc: 0.622 Test Loss: 1.140 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.898280143737793
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.198 Vali Acc: 0.609 Test Loss: 1.198 Test Acc: 0.609
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.245309829711914
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.236 Vali Acc: 0.613 Test Loss: 1.236 Test Acc: 0.613
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.0475239753723145
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.228 Vali Acc: 0.622 Test Loss: 1.228 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.8975329399108887
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.223 Vali Acc: 0.631 Test Loss: 1.223 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.653125
model parameter : 1115272
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.620234489440918
Epoch: 1, Steps: 8 | Train Loss: 2.165 Vali Loss: 2.027 Vali Acc: 0.172 Test Loss: 2.027 Test Acc: 0.172
Validation loss decreased (inf --> -0.171855).  Saving model ...
Epoch: 2 cost time: 3.0068459510803223
Epoch: 2, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.915 Vali Acc: 0.328 Test Loss: 1.915 Test Acc: 0.328
Validation loss decreased (-0.171855 --> -0.328106).  Saving model ...
Epoch: 3 cost time: 3.006167411804199
Epoch: 3, Steps: 8 | Train Loss: 1.750 Vali Loss: 1.765 Vali Acc: 0.403 Test Loss: 1.765 Test Acc: 0.403
Validation loss decreased (-0.328106 --> -0.403107).  Saving model ...
Epoch: 4 cost time: 3.0620779991149902
Epoch: 4, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.628 Vali Acc: 0.500 Test Loss: 1.628 Test Acc: 0.500
Validation loss decreased (-0.403107 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 3.168872594833374
Epoch: 5, Steps: 8 | Train Loss: 1.267 Vali Loss: 1.534 Vali Acc: 0.428 Test Loss: 1.534 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1636011600494385
Epoch: 6, Steps: 8 | Train Loss: 0.993 Vali Loss: 1.417 Vali Acc: 0.497 Test Loss: 1.417 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.126859188079834
Epoch: 7, Steps: 8 | Train Loss: 0.754 Vali Loss: 1.364 Vali Acc: 0.519 Test Loss: 1.364 Test Acc: 0.519
Validation loss decreased (-0.499984 --> -0.518736).  Saving model ...
Epoch: 8 cost time: 2.7480757236480713
Epoch: 8, Steps: 8 | Train Loss: 0.602 Vali Loss: 1.333 Vali Acc: 0.512 Test Loss: 1.333 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7437479496002197
Epoch: 9, Steps: 8 | Train Loss: 0.480 Vali Loss: 1.384 Vali Acc: 0.487 Test Loss: 1.384 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.835536003112793
Epoch: 10, Steps: 8 | Train Loss: 0.359 Vali Loss: 1.381 Vali Acc: 0.487 Test Loss: 1.381 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8697845935821533
Epoch: 11, Steps: 8 | Train Loss: 0.257 Vali Loss: 1.379 Vali Acc: 0.500 Test Loss: 1.379 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.805868625640869
Epoch: 12, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.417 Vali Acc: 0.509 Test Loss: 1.417 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7269153594970703
Epoch: 13, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.544 Vali Acc: 0.438 Test Loss: 1.544 Test Acc: 0.438
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.929776191711426
Epoch: 14, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.456 Vali Acc: 0.512 Test Loss: 1.456 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9465019702911377
Epoch: 15, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.664 Vali Acc: 0.456 Test Loss: 1.664 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.854721784591675
Epoch: 16, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.535 Vali Acc: 0.509 Test Loss: 1.535 Test Acc: 0.509
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.907949924468994
Epoch: 17, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.613 Vali Acc: 0.497 Test Loss: 1.613 Test Acc: 0.497
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.51875
model parameter : 1115272
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.240053653717041
Epoch: 1, Steps: 8 | Train Loss: 2.141 Vali Loss: 2.075 Vali Acc: 0.175 Test Loss: 2.075 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 2.7691140174865723
Epoch: 2, Steps: 8 | Train Loss: 2.043 Vali Loss: 2.007 Vali Acc: 0.150 Test Loss: 2.007 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.690383195877075
Epoch: 3, Steps: 8 | Train Loss: 1.832 Vali Loss: 1.922 Vali Acc: 0.200 Test Loss: 1.922 Test Acc: 0.200
Validation loss decreased (-0.174979 --> -0.199981).  Saving model ...
Epoch: 4 cost time: 2.5119354724884033
Epoch: 4, Steps: 8 | Train Loss: 1.706 Vali Loss: 1.819 Vali Acc: 0.403 Test Loss: 1.819 Test Acc: 0.403
Validation loss decreased (-0.199981 --> -0.403107).  Saving model ...
Epoch: 5 cost time: 2.5000293254852295
Epoch: 5, Steps: 8 | Train Loss: 1.495 Vali Loss: 1.759 Vali Acc: 0.353 Test Loss: 1.759 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.843229055404663
Epoch: 6, Steps: 8 | Train Loss: 1.217 Vali Loss: 1.688 Vali Acc: 0.388 Test Loss: 1.688 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.269179582595825
Epoch: 7, Steps: 8 | Train Loss: 0.974 Vali Loss: 1.550 Vali Acc: 0.444 Test Loss: 1.550 Test Acc: 0.444
Validation loss decreased (-0.403107 --> -0.443734).  Saving model ...
Epoch: 8 cost time: 2.9354424476623535
Epoch: 8, Steps: 8 | Train Loss: 0.808 Vali Loss: 1.537 Vali Acc: 0.388 Test Loss: 1.537 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1195833683013916
Epoch: 9, Steps: 8 | Train Loss: 0.649 Vali Loss: 1.546 Vali Acc: 0.384 Test Loss: 1.546 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0450079441070557
Epoch: 10, Steps: 8 | Train Loss: 0.521 Vali Loss: 1.536 Vali Acc: 0.419 Test Loss: 1.536 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.836435317993164
Epoch: 11, Steps: 8 | Train Loss: 0.400 Vali Loss: 1.493 Vali Acc: 0.412 Test Loss: 1.493 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.003526449203491
Epoch: 12, Steps: 8 | Train Loss: 0.349 Vali Loss: 1.528 Vali Acc: 0.397 Test Loss: 1.528 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8572185039520264
Epoch: 13, Steps: 8 | Train Loss: 0.272 Vali Loss: 1.642 Vali Acc: 0.344 Test Loss: 1.642 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.0514113903045654
Epoch: 14, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.683 Vali Acc: 0.375 Test Loss: 1.683 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.851879119873047
Epoch: 15, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.560 Vali Acc: 0.416 Test Loss: 1.560 Test Acc: 0.416
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.0715794563293457
Epoch: 16, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.771 Vali Acc: 0.425 Test Loss: 1.771 Test Acc: 0.425
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.0526788234710693
Epoch: 17, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.696 Vali Acc: 0.444 Test Loss: 1.696 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.44375
model parameter : 1115272
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.511767387390137
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 2.097 Vali Acc: 0.159 Test Loss: 2.097 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 2.9619410037994385
Epoch: 2, Steps: 8 | Train Loss: 2.029 Vali Loss: 2.045 Vali Acc: 0.128 Test Loss: 2.045 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.885057210922241
Epoch: 3, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.986 Vali Acc: 0.163 Test Loss: 1.986 Test Acc: 0.163
Validation loss decreased (-0.159354 --> -0.162480).  Saving model ...
Epoch: 4 cost time: 2.822049140930176
Epoch: 4, Steps: 8 | Train Loss: 1.763 Vali Loss: 1.915 Vali Acc: 0.272 Test Loss: 1.915 Test Acc: 0.272
Validation loss decreased (-0.162480 --> -0.271856).  Saving model ...
Epoch: 5 cost time: 2.881272077560425
Epoch: 5, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.833 Vali Acc: 0.378 Test Loss: 1.833 Test Acc: 0.378
Validation loss decreased (-0.271856 --> -0.378107).  Saving model ...
Epoch: 6 cost time: 2.805455446243286
Epoch: 6, Steps: 8 | Train Loss: 1.279 Vali Loss: 1.803 Vali Acc: 0.281 Test Loss: 1.803 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.778032064437866
Epoch: 7, Steps: 8 | Train Loss: 1.061 Vali Loss: 1.682 Vali Acc: 0.434 Test Loss: 1.682 Test Acc: 0.434
Validation loss decreased (-0.378107 --> -0.434358).  Saving model ...
Epoch: 8 cost time: 2.960195779800415
Epoch: 8, Steps: 8 | Train Loss: 0.879 Vali Loss: 1.616 Vali Acc: 0.391 Test Loss: 1.616 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8791589736938477
Epoch: 9, Steps: 8 | Train Loss: 0.738 Vali Loss: 1.568 Vali Acc: 0.381 Test Loss: 1.568 Test Acc: 0.381
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7296836376190186
Epoch: 10, Steps: 8 | Train Loss: 0.562 Vali Loss: 1.583 Vali Acc: 0.422 Test Loss: 1.583 Test Acc: 0.422
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.805453300476074
Epoch: 11, Steps: 8 | Train Loss: 0.434 Vali Loss: 1.458 Vali Acc: 0.400 Test Loss: 1.458 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6357946395874023
Epoch: 12, Steps: 8 | Train Loss: 0.385 Vali Loss: 1.447 Vali Acc: 0.419 Test Loss: 1.447 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6836342811584473
Epoch: 13, Steps: 8 | Train Loss: 0.318 Vali Loss: 1.498 Vali Acc: 0.362 Test Loss: 1.498 Test Acc: 0.362
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6965396404266357
Epoch: 14, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.497 Vali Acc: 0.419 Test Loss: 1.497 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7910351753234863
Epoch: 15, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.357 Vali Acc: 0.478 Test Loss: 1.357 Test Acc: 0.478
Validation loss decreased (-0.434358 --> -0.478111).  Saving model ...
Epoch: 16 cost time: 2.881904125213623
Epoch: 16, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.493 Vali Acc: 0.453 Test Loss: 1.493 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.911789894104004
Epoch: 17, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.738 Vali Acc: 0.375 Test Loss: 1.738 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6587512493133545
Epoch: 18, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.466 Vali Acc: 0.491 Test Loss: 1.466 Test Acc: 0.491
Validation loss decreased (-0.478111 --> -0.490610).  Saving model ...
Epoch: 19 cost time: 2.8962061405181885
Epoch: 19, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.762 Vali Acc: 0.416 Test Loss: 1.762 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9843435287475586
Epoch: 20, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.924 Vali Acc: 0.388 Test Loss: 1.924 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0938127040863037
Epoch: 21, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.599 Vali Acc: 0.447 Test Loss: 1.599 Test Acc: 0.447
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.017702579498291
Epoch: 22, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.657 Vali Acc: 0.466 Test Loss: 1.657 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.866988182067871
Epoch: 23, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.972 Vali Acc: 0.381 Test Loss: 1.972 Test Acc: 0.381
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.7862536907196045
Epoch: 24, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.681 Vali Acc: 0.484 Test Loss: 1.681 Test Acc: 0.484
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.7142069339752197
Epoch: 25, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.716 Vali Acc: 0.481 Test Loss: 1.716 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.9936625957489014
Epoch: 26, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.826 Vali Acc: 0.447 Test Loss: 1.826 Test Acc: 0.447
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.000303030014038
Epoch: 27, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.813 Vali Acc: 0.478 Test Loss: 1.813 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.749814033508301
Epoch: 28, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.017 Vali Acc: 0.428 Test Loss: 2.017 Test Acc: 0.428
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.490625
model parameter : 1115272
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.737529993057251
Epoch: 1, Steps: 8 | Train Loss: 2.148 Vali Loss: 2.123 Vali Acc: 0.122 Test Loss: 2.123 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 3.3047282695770264
Epoch: 2, Steps: 8 | Train Loss: 2.045 Vali Loss: 2.073 Vali Acc: 0.147 Test Loss: 2.073 Test Acc: 0.147
Validation loss decreased (-0.121854 --> -0.146854).  Saving model ...
Epoch: 3 cost time: 3.1094720363616943
Epoch: 3, Steps: 8 | Train Loss: 1.849 Vali Loss: 2.017 Vali Acc: 0.203 Test Loss: 2.017 Test Acc: 0.203
Validation loss decreased (-0.146854 --> -0.203105).  Saving model ...
Epoch: 4 cost time: 3.3557326793670654
Epoch: 4, Steps: 8 | Train Loss: 1.724 Vali Loss: 1.962 Vali Acc: 0.253 Test Loss: 1.962 Test Acc: 0.253
Validation loss decreased (-0.203105 --> -0.253105).  Saving model ...
Epoch: 5 cost time: 3.476306676864624
Epoch: 5, Steps: 8 | Train Loss: 1.502 Vali Loss: 1.871 Vali Acc: 0.319 Test Loss: 1.871 Test Acc: 0.319
Validation loss decreased (-0.253105 --> -0.318731).  Saving model ...
Epoch: 6 cost time: 3.2594268321990967
Epoch: 6, Steps: 8 | Train Loss: 1.221 Vali Loss: 1.871 Vali Acc: 0.234 Test Loss: 1.871 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0005736351013184
Epoch: 7, Steps: 8 | Train Loss: 1.040 Vali Loss: 1.797 Vali Acc: 0.284 Test Loss: 1.797 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8370845317840576
Epoch: 8, Steps: 8 | Train Loss: 0.812 Vali Loss: 1.687 Vali Acc: 0.438 Test Loss: 1.687 Test Acc: 0.438
Validation loss decreased (-0.318731 --> -0.437483).  Saving model ...
Epoch: 9 cost time: 2.9369919300079346
Epoch: 9, Steps: 8 | Train Loss: 0.688 Vali Loss: 1.600 Vali Acc: 0.397 Test Loss: 1.600 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1579904556274414
Epoch: 10, Steps: 8 | Train Loss: 0.555 Vali Loss: 1.616 Vali Acc: 0.428 Test Loss: 1.616 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.873950481414795
Epoch: 11, Steps: 8 | Train Loss: 0.465 Vali Loss: 1.435 Vali Acc: 0.453 Test Loss: 1.435 Test Acc: 0.453
Validation loss decreased (-0.437483 --> -0.453111).  Saving model ...
Epoch: 12 cost time: 3.0618844032287598
Epoch: 12, Steps: 8 | Train Loss: 0.383 Vali Loss: 1.396 Vali Acc: 0.428 Test Loss: 1.396 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6800971031188965
Epoch: 13, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.434 Vali Acc: 0.425 Test Loss: 1.434 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9687070846557617
Epoch: 14, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.480 Vali Acc: 0.412 Test Loss: 1.480 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.903052806854248
Epoch: 15, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.413 Vali Acc: 0.456 Test Loss: 1.413 Test Acc: 0.456
Validation loss decreased (-0.453111 --> -0.456236).  Saving model ...
Epoch: 16 cost time: 3.0354459285736084
Epoch: 16, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.420 Vali Acc: 0.494 Test Loss: 1.420 Test Acc: 0.494
Validation loss decreased (-0.456236 --> -0.493736).  Saving model ...
Epoch: 17 cost time: 2.8671793937683105
Epoch: 17, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.948 Vali Acc: 0.331 Test Loss: 1.948 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7892680168151855
Epoch: 18, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.441 Vali Acc: 0.487 Test Loss: 1.441 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.032259464263916
Epoch: 19, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.603 Vali Acc: 0.459 Test Loss: 1.603 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0071706771850586
Epoch: 20, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.698 Vali Acc: 0.412 Test Loss: 1.698 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.1404240131378174
Epoch: 21, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.557 Vali Acc: 0.481 Test Loss: 1.557 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.9520184993743896
Epoch: 22, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.565 Vali Acc: 0.472 Test Loss: 1.565 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6658246517181396
Epoch: 23, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.744 Vali Acc: 0.466 Test Loss: 1.744 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5096075534820557
Epoch: 24, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.664 Vali Acc: 0.475 Test Loss: 1.664 Test Acc: 0.475
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.0406713485717773
Epoch: 25, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.644 Vali Acc: 0.487 Test Loss: 1.644 Test Acc: 0.487
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.8705835342407227
Epoch: 26, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.817 Vali Acc: 0.450 Test Loss: 1.817 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.49375
model parameter : 1115272
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.859658241271973
Epoch: 1, Steps: 8 | Train Loss: 2.140 Vali Loss: 2.110 Vali Acc: 0.122 Test Loss: 2.110 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 2.931436061859131
Epoch: 2, Steps: 8 | Train Loss: 2.066 Vali Loss: 2.076 Vali Acc: 0.131 Test Loss: 2.076 Test Acc: 0.131
Validation loss decreased (-0.121854 --> -0.131229).  Saving model ...
Epoch: 3 cost time: 2.9753258228302
Epoch: 3, Steps: 8 | Train Loss: 1.861 Vali Loss: 2.034 Vali Acc: 0.134 Test Loss: 2.034 Test Acc: 0.134
Validation loss decreased (-0.131229 --> -0.134355).  Saving model ...
Epoch: 4 cost time: 2.885413646697998
Epoch: 4, Steps: 8 | Train Loss: 1.740 Vali Loss: 1.951 Vali Acc: 0.234 Test Loss: 1.951 Test Acc: 0.234
Validation loss decreased (-0.134355 --> -0.234355).  Saving model ...
Epoch: 5 cost time: 3.0571749210357666
Epoch: 5, Steps: 8 | Train Loss: 1.611 Vali Loss: 1.872 Vali Acc: 0.303 Test Loss: 1.872 Test Acc: 0.303
Validation loss decreased (-0.234355 --> -0.303106).  Saving model ...
Epoch: 6 cost time: 3.115049123764038
Epoch: 6, Steps: 8 | Train Loss: 1.336 Vali Loss: 1.792 Vali Acc: 0.316 Test Loss: 1.792 Test Acc: 0.316
Validation loss decreased (-0.303106 --> -0.315607).  Saving model ...
Epoch: 7 cost time: 2.85416316986084
Epoch: 7, Steps: 8 | Train Loss: 1.082 Vali Loss: 1.681 Vali Acc: 0.403 Test Loss: 1.681 Test Acc: 0.403
Validation loss decreased (-0.315607 --> -0.403108).  Saving model ...
Epoch: 8 cost time: 3.0843241214752197
Epoch: 8, Steps: 8 | Train Loss: 0.929 Vali Loss: 1.587 Vali Acc: 0.487 Test Loss: 1.587 Test Acc: 0.487
Validation loss decreased (-0.403108 --> -0.487484).  Saving model ...
Epoch: 9 cost time: 2.878173828125
Epoch: 9, Steps: 8 | Train Loss: 0.788 Vali Loss: 1.477 Vali Acc: 0.459 Test Loss: 1.477 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0000815391540527
Epoch: 10, Steps: 8 | Train Loss: 0.635 Vali Loss: 1.469 Vali Acc: 0.422 Test Loss: 1.469 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9427192211151123
Epoch: 11, Steps: 8 | Train Loss: 0.524 Vali Loss: 1.463 Vali Acc: 0.428 Test Loss: 1.463 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.033552885055542
Epoch: 12, Steps: 8 | Train Loss: 0.436 Vali Loss: 1.387 Vali Acc: 0.434 Test Loss: 1.387 Test Acc: 0.434
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.058387041091919
Epoch: 13, Steps: 8 | Train Loss: 0.378 Vali Loss: 1.547 Vali Acc: 0.416 Test Loss: 1.547 Test Acc: 0.416
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.386752128601074
Epoch: 14, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.667 Vali Acc: 0.391 Test Loss: 1.667 Test Acc: 0.391
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.829878091812134
Epoch: 15, Steps: 8 | Train Loss: 0.269 Vali Loss: 1.546 Vali Acc: 0.459 Test Loss: 1.546 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.0854618549346924
Epoch: 16, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.636 Vali Acc: 0.459 Test Loss: 1.636 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.7573795318603516
Epoch: 17, Steps: 8 | Train Loss: 0.192 Vali Loss: 2.017 Vali Acc: 0.397 Test Loss: 2.017 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.283351421356201
Epoch: 18, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.743 Vali Acc: 0.419 Test Loss: 1.743 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.4875
model parameter : 1115272
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.474987506866455
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 2.118 Vali Acc: 0.100 Test Loss: 2.118 Test Acc: 0.100
Validation loss decreased (inf --> -0.099979).  Saving model ...
Epoch: 2 cost time: 3.037731409072876
Epoch: 2, Steps: 8 | Train Loss: 2.039 Vali Loss: 2.079 Vali Acc: 0.141 Test Loss: 2.079 Test Acc: 0.141
Validation loss decreased (-0.099979 --> -0.140604).  Saving model ...
Epoch: 3 cost time: 3.1120336055755615
Epoch: 3, Steps: 8 | Train Loss: 1.934 Vali Loss: 2.027 Vali Acc: 0.134 Test Loss: 2.027 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.974576234817505
Epoch: 4, Steps: 8 | Train Loss: 1.776 Vali Loss: 1.956 Vali Acc: 0.216 Test Loss: 1.956 Test Acc: 0.216
Validation loss decreased (-0.140604 --> -0.215605).  Saving model ...
Epoch: 5 cost time: 2.931351900100708
Epoch: 5, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.893 Vali Acc: 0.338 Test Loss: 1.893 Test Acc: 0.338
Validation loss decreased (-0.215605 --> -0.337481).  Saving model ...
Epoch: 6 cost time: 2.709479570388794
Epoch: 6, Steps: 8 | Train Loss: 1.393 Vali Loss: 1.813 Vali Acc: 0.419 Test Loss: 1.813 Test Acc: 0.419
Validation loss decreased (-0.337481 --> -0.418732).  Saving model ...
Epoch: 7 cost time: 3.3959622383117676
Epoch: 7, Steps: 8 | Train Loss: 1.242 Vali Loss: 1.714 Vali Acc: 0.431 Test Loss: 1.714 Test Acc: 0.431
Validation loss decreased (-0.418732 --> -0.431233).  Saving model ...
Epoch: 8 cost time: 3.1873292922973633
Epoch: 8, Steps: 8 | Train Loss: 1.032 Vali Loss: 1.626 Vali Acc: 0.431 Test Loss: 1.626 Test Acc: 0.431
Validation loss decreased (-0.431233 --> -0.431234).  Saving model ...
Epoch: 9 cost time: 3.2266993522644043
Epoch: 9, Steps: 8 | Train Loss: 0.932 Vali Loss: 1.560 Vali Acc: 0.431 Test Loss: 1.560 Test Acc: 0.431
Validation loss decreased (-0.431234 --> -0.431234).  Saving model ...
Epoch: 10 cost time: 2.894986152648926
Epoch: 10, Steps: 8 | Train Loss: 0.778 Vali Loss: 1.481 Vali Acc: 0.431 Test Loss: 1.481 Test Acc: 0.431
Validation loss decreased (-0.431234 --> -0.431235).  Saving model ...
Epoch: 11 cost time: 2.739074945449829
Epoch: 11, Steps: 8 | Train Loss: 0.643 Vali Loss: 1.471 Vali Acc: 0.425 Test Loss: 1.471 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.646343946456909
Epoch: 12, Steps: 8 | Train Loss: 0.551 Vali Loss: 1.439 Vali Acc: 0.453 Test Loss: 1.439 Test Acc: 0.453
Validation loss decreased (-0.431235 --> -0.453111).  Saving model ...
Epoch: 13 cost time: 2.6489124298095703
Epoch: 13, Steps: 8 | Train Loss: 0.467 Vali Loss: 1.378 Vali Acc: 0.475 Test Loss: 1.378 Test Acc: 0.475
Validation loss decreased (-0.453111 --> -0.474986).  Saving model ...
Epoch: 14 cost time: 2.9731032848358154
Epoch: 14, Steps: 8 | Train Loss: 0.383 Vali Loss: 1.430 Vali Acc: 0.456 Test Loss: 1.430 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7587907314300537
Epoch: 15, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.457 Vali Acc: 0.472 Test Loss: 1.457 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.998838424682617
Epoch: 16, Steps: 8 | Train Loss: 0.348 Vali Loss: 1.427 Vali Acc: 0.459 Test Loss: 1.427 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.2942960262298584
Epoch: 17, Steps: 8 | Train Loss: 0.243 Vali Loss: 1.677 Vali Acc: 0.441 Test Loss: 1.677 Test Acc: 0.441
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0103421211242676
Epoch: 18, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.609 Vali Acc: 0.416 Test Loss: 1.609 Test Acc: 0.416
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2073354721069336
Epoch: 19, Steps: 8 | Train Loss: 0.198 Vali Loss: 1.726 Vali Acc: 0.428 Test Loss: 1.726 Test Acc: 0.428
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.053395986557007
Epoch: 20, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.660 Vali Acc: 0.450 Test Loss: 1.660 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.8939619064331055
Epoch: 21, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.829 Vali Acc: 0.412 Test Loss: 1.829 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.816093921661377
Epoch: 22, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.891 Vali Acc: 0.422 Test Loss: 1.891 Test Acc: 0.422
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.854137897491455
Epoch: 23, Steps: 8 | Train Loss: 0.086 Vali Loss: 2.054 Vali Acc: 0.416 Test Loss: 2.054 Test Acc: 0.416
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.475
model parameter : 1115272
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.915194511413574
Epoch: 1, Steps: 8 | Train Loss: 2.076 Vali Loss: 1.861 Vali Acc: 0.350 Test Loss: 1.861 Test Acc: 0.350
Validation loss decreased (inf --> -0.349981).  Saving model ...
Epoch: 2 cost time: 2.9649100303649902
Epoch: 2, Steps: 8 | Train Loss: 1.638 Vali Loss: 1.371 Vali Acc: 0.650 Test Loss: 1.371 Test Acc: 0.650
Validation loss decreased (-0.349981 --> -0.649986).  Saving model ...
Epoch: 3 cost time: 3.403595209121704
Epoch: 3, Steps: 8 | Train Loss: 1.146 Vali Loss: 1.004 Vali Acc: 0.731 Test Loss: 1.004 Test Acc: 0.731
Validation loss decreased (-0.649986 --> -0.731240).  Saving model ...
Epoch: 4 cost time: 3.065096378326416
Epoch: 4, Steps: 8 | Train Loss: 0.771 Vali Loss: 0.826 Vali Acc: 0.747 Test Loss: 0.826 Test Acc: 0.747
Validation loss decreased (-0.731240 --> -0.746867).  Saving model ...
Epoch: 5 cost time: 3.175389051437378
Epoch: 5, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.722 Vali Acc: 0.759 Test Loss: 0.722 Test Acc: 0.759
Validation loss decreased (-0.746867 --> -0.759368).  Saving model ...
Epoch: 6 cost time: 2.810969352722168
Epoch: 6, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.698 Vali Acc: 0.769 Test Loss: 0.698 Test Acc: 0.769
Validation loss decreased (-0.759368 --> -0.768743).  Saving model ...
Epoch: 7 cost time: 3.0445003509521484
Epoch: 7, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.707 Vali Acc: 0.762 Test Loss: 0.707 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9761719703674316
Epoch: 8, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.692 Vali Acc: 0.769 Test Loss: 0.692 Test Acc: 0.769
Validation loss decreased (-0.768743 --> -0.768743).  Saving model ...
Epoch: 9 cost time: 2.826921224594116
Epoch: 9, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.699 Vali Acc: 0.769 Test Loss: 0.699 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8102381229400635
Epoch: 10, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.716 Vali Acc: 0.787 Test Loss: 0.716 Test Acc: 0.787
Validation loss decreased (-0.768743 --> -0.787493).  Saving model ...
Epoch: 11 cost time: 3.164647340774536
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.766 Vali Acc: 0.756 Test Loss: 0.766 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2488203048706055
Epoch: 12, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.781 Vali Acc: 0.766 Test Loss: 0.781 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1405222415924072
Epoch: 13, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.813 Vali Acc: 0.766 Test Loss: 0.813 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5786476135253906
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.882107973098755
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.793 Vali Acc: 0.769 Test Loss: 0.793 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9269495010375977
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.797 Vali Acc: 0.775 Test Loss: 0.797 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.8347671031951904
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.814 Vali Acc: 0.781 Test Loss: 0.814 Test Acc: 0.781
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1699583530426025
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.821 Vali Acc: 0.781 Test Loss: 0.821 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.1673688888549805
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.821 Vali Acc: 0.784 Test Loss: 0.821 Test Acc: 0.784
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.0995841026306152
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.823 Vali Acc: 0.778 Test Loss: 0.823 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7875
model parameter : 722056
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.61633563041687
Epoch: 1, Steps: 8 | Train Loss: 2.099 Vali Loss: 1.946 Vali Acc: 0.309 Test Loss: 1.946 Test Acc: 0.309
Validation loss decreased (inf --> -0.309356).  Saving model ...
Epoch: 2 cost time: 2.5171234607696533
Epoch: 2, Steps: 8 | Train Loss: 1.728 Vali Loss: 1.552 Vali Acc: 0.553 Test Loss: 1.552 Test Acc: 0.553
Validation loss decreased (-0.309356 --> -0.553109).  Saving model ...
Epoch: 3 cost time: 2.65204119682312
Epoch: 3, Steps: 8 | Train Loss: 1.285 Vali Loss: 1.241 Vali Acc: 0.666 Test Loss: 1.241 Test Acc: 0.666
Validation loss decreased (-0.553109 --> -0.665613).  Saving model ...
Epoch: 4 cost time: 2.753070831298828
Epoch: 4, Steps: 8 | Train Loss: 0.887 Vali Loss: 1.070 Vali Acc: 0.678 Test Loss: 1.070 Test Acc: 0.678
Validation loss decreased (-0.665613 --> -0.678114).  Saving model ...
Epoch: 5 cost time: 2.7329111099243164
Epoch: 5, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.961 Vali Acc: 0.675 Test Loss: 0.961 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0246317386627197
Epoch: 6, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.900 Vali Acc: 0.703 Test Loss: 0.900 Test Acc: 0.703
Validation loss decreased (-0.678114 --> -0.703116).  Saving model ...
Epoch: 7 cost time: 3.028215169906616
Epoch: 7, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.873 Vali Acc: 0.697 Test Loss: 0.873 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9611244201660156
Epoch: 8, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.856 Vali Acc: 0.700 Test Loss: 0.856 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1189706325531006
Epoch: 9, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.856 Vali Acc: 0.716 Test Loss: 0.856 Test Acc: 0.716
Validation loss decreased (-0.703116 --> -0.715616).  Saving model ...
Epoch: 10 cost time: 2.877309560775757
Epoch: 10, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.867 Vali Acc: 0.719 Test Loss: 0.867 Test Acc: 0.719
Validation loss decreased (-0.715616 --> -0.718741).  Saving model ...
Epoch: 11 cost time: 3.063934803009033
Epoch: 11, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.952 Vali Acc: 0.697 Test Loss: 0.952 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1319420337677
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.988 Vali Acc: 0.706 Test Loss: 0.988 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.562286615371704
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.011 Vali Acc: 0.719 Test Loss: 1.011 Test Acc: 0.719
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.611231565475464
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.008 Vali Acc: 0.719 Test Loss: 1.008 Test Acc: 0.719
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7595407962799072
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.023 Vali Acc: 0.709 Test Loss: 1.023 Test Acc: 0.709
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.0797529220581055
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.016 Vali Acc: 0.709 Test Loss: 1.016 Test Acc: 0.709
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.9329817295074463
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.025 Vali Acc: 0.703 Test Loss: 1.025 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.991502046585083
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.030 Vali Acc: 0.709 Test Loss: 1.030 Test Acc: 0.709
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.956137180328369
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.041 Vali Acc: 0.719 Test Loss: 1.041 Test Acc: 0.719
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.937239408493042
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.052 Vali Acc: 0.716 Test Loss: 1.052 Test Acc: 0.716
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.71875
model parameter : 722056
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.902131080627441
Epoch: 1, Steps: 8 | Train Loss: 2.109 Vali Loss: 1.974 Vali Acc: 0.263 Test Loss: 1.974 Test Acc: 0.263
Validation loss decreased (inf --> -0.262480).  Saving model ...
Epoch: 2 cost time: 2.9024600982666016
Epoch: 2, Steps: 8 | Train Loss: 1.808 Vali Loss: 1.677 Vali Acc: 0.475 Test Loss: 1.677 Test Acc: 0.475
Validation loss decreased (-0.262480 --> -0.474983).  Saving model ...
Epoch: 3 cost time: 2.9849936962127686
Epoch: 3, Steps: 8 | Train Loss: 1.434 Vali Loss: 1.391 Vali Acc: 0.584 Test Loss: 1.391 Test Acc: 0.584
Validation loss decreased (-0.474983 --> -0.584361).  Saving model ...
Epoch: 4 cost time: 3.206157684326172
Epoch: 4, Steps: 8 | Train Loss: 1.031 Vali Loss: 1.213 Vali Acc: 0.609 Test Loss: 1.213 Test Acc: 0.609
Validation loss decreased (-0.584361 --> -0.609363).  Saving model ...
Epoch: 5 cost time: 3.1277472972869873
Epoch: 5, Steps: 8 | Train Loss: 0.733 Vali Loss: 1.090 Vali Acc: 0.628 Test Loss: 1.090 Test Acc: 0.628
Validation loss decreased (-0.609363 --> -0.628114).  Saving model ...
Epoch: 6 cost time: 2.9004905223846436
Epoch: 6, Steps: 8 | Train Loss: 0.561 Vali Loss: 1.017 Vali Acc: 0.659 Test Loss: 1.017 Test Acc: 0.659
Validation loss decreased (-0.628114 --> -0.659365).  Saving model ...
Epoch: 7 cost time: 2.9194064140319824
Epoch: 7, Steps: 8 | Train Loss: 0.374 Vali Loss: 1.000 Vali Acc: 0.669 Test Loss: 1.000 Test Acc: 0.669
Validation loss decreased (-0.659365 --> -0.668740).  Saving model ...
Epoch: 8 cost time: 2.9176321029663086
Epoch: 8, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.997 Vali Acc: 0.653 Test Loss: 0.997 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8537325859069824
Epoch: 9, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.001 Vali Acc: 0.662 Test Loss: 1.001 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.000251054763794
Epoch: 10, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.015 Vali Acc: 0.659 Test Loss: 1.015 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6209123134613037
Epoch: 11, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.048 Vali Acc: 0.675 Test Loss: 1.048 Test Acc: 0.675
Validation loss decreased (-0.668740 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 3.0472919940948486
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.055 Vali Acc: 0.672 Test Loss: 1.055 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5754330158233643
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.110 Vali Acc: 0.669 Test Loss: 1.110 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.215723991394043
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.138 Vali Acc: 0.662 Test Loss: 1.138 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2165122032165527
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.140 Vali Acc: 0.666 Test Loss: 1.140 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.701937198638916
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.146 Vali Acc: 0.659 Test Loss: 1.146 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.959928274154663
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.169 Vali Acc: 0.669 Test Loss: 1.169 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.091242551803589
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.172 Vali Acc: 0.675 Test Loss: 1.172 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.8016486167907715
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.173 Vali Acc: 0.681 Test Loss: 1.173 Test Acc: 0.681
Validation loss decreased (-0.674990 --> -0.681238).  Saving model ...
Epoch: 20 cost time: 3.14522123336792
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.170 Vali Acc: 0.681 Test Loss: 1.170 Test Acc: 0.681
Validation loss decreased (-0.681238 --> -0.681238).  Saving model ...
Epoch: 21 cost time: 3.196756362915039
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.185 Vali Acc: 0.666 Test Loss: 1.185 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.304197311401367
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.191 Vali Acc: 0.672 Test Loss: 1.191 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.187253952026367
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.196 Vali Acc: 0.672 Test Loss: 1.196 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.39465069770813
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.202 Vali Acc: 0.681 Test Loss: 1.202 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.251544713973999
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.196 Vali Acc: 0.681 Test Loss: 1.196 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.959517002105713
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.203 Vali Acc: 0.675 Test Loss: 1.203 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.804370641708374
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.203 Vali Acc: 0.675 Test Loss: 1.203 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.9334161281585693
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.213 Vali Acc: 0.688 Test Loss: 1.213 Test Acc: 0.688
Validation loss decreased (-0.681238 --> -0.687488).  Saving model ...
Epoch: 29 cost time: 3.0438055992126465
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.227 Vali Acc: 0.678 Test Loss: 1.227 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.932882785797119
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.234 Vali Acc: 0.684 Test Loss: 1.234 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.941788673400879
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.241 Vali Acc: 0.678 Test Loss: 1.241 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.9296655654907227
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.235 Vali Acc: 0.688 Test Loss: 1.235 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.035080909729004
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.239 Vali Acc: 0.688 Test Loss: 1.239 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.160344123840332
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.240 Vali Acc: 0.691 Test Loss: 1.240 Test Acc: 0.691
Validation loss decreased (-0.687488 --> -0.690613).  Saving model ...
Epoch: 35 cost time: 2.7831461429595947
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.247 Vali Acc: 0.694 Test Loss: 1.247 Test Acc: 0.694
Validation loss decreased (-0.690613 --> -0.693738).  Saving model ...
Epoch: 36 cost time: 3.0722434520721436
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.243 Vali Acc: 0.700 Test Loss: 1.243 Test Acc: 0.700
Validation loss decreased (-0.693738 --> -0.699988).  Saving model ...
Epoch: 37 cost time: 3.0710270404815674
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.248 Vali Acc: 0.697 Test Loss: 1.248 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.143704891204834
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.240 Vali Acc: 0.697 Test Loss: 1.240 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.814462900161743
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.244 Vali Acc: 0.703 Test Loss: 1.244 Test Acc: 0.703
Validation loss decreased (-0.699988 --> -0.703113).  Saving model ...
Epoch: 40 cost time: 2.8380839824676514
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.254 Vali Acc: 0.700 Test Loss: 1.254 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.8806159496307373
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.261 Vali Acc: 0.694 Test Loss: 1.261 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.849289655685425
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.256 Vali Acc: 0.697 Test Loss: 1.256 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.83210825920105
Epoch: 43, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.258 Vali Acc: 0.703 Test Loss: 1.258 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.251854181289673
Epoch: 44, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.257 Vali Acc: 0.703 Test Loss: 1.257 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.3335180282592773
Epoch: 45, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.255 Vali Acc: 0.703 Test Loss: 1.255 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.148757219314575
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.255 Vali Acc: 0.703 Test Loss: 1.255 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.8294785022735596
Epoch: 47, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.261 Vali Acc: 0.700 Test Loss: 1.261 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.8871278762817383
Epoch: 48, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.268 Vali Acc: 0.697 Test Loss: 1.268 Test Acc: 0.697
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.0719306468963623
Epoch: 49, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.273 Vali Acc: 0.694 Test Loss: 1.273 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.703125
model parameter : 722056
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.495295286178589
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 1.987 Vali Acc: 0.247 Test Loss: 1.987 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 3.2665531635284424
Epoch: 2, Steps: 8 | Train Loss: 1.911 Vali Loss: 1.797 Vali Acc: 0.428 Test Loss: 1.797 Test Acc: 0.428
Validation loss decreased (-0.246855 --> -0.428107).  Saving model ...
Epoch: 3 cost time: 3.174725294113159
Epoch: 3, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.581 Vali Acc: 0.547 Test Loss: 1.581 Test Acc: 0.547
Validation loss decreased (-0.428107 --> -0.546859).  Saving model ...
Epoch: 4 cost time: 3.001291513442993
Epoch: 4, Steps: 8 | Train Loss: 1.299 Vali Loss: 1.407 Vali Acc: 0.544 Test Loss: 1.407 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9380669593811035
Epoch: 5, Steps: 8 | Train Loss: 0.995 Vali Loss: 1.249 Vali Acc: 0.562 Test Loss: 1.249 Test Acc: 0.562
Validation loss decreased (-0.546859 --> -0.562488).  Saving model ...
Epoch: 6 cost time: 2.701995611190796
Epoch: 6, Steps: 8 | Train Loss: 0.773 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
Validation loss decreased (-0.562488 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 2.849485397338867
Epoch: 7, Steps: 8 | Train Loss: 0.573 Vali Loss: 1.100 Vali Acc: 0.613 Test Loss: 1.100 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.926434278488159
Epoch: 8, Steps: 8 | Train Loss: 0.412 Vali Loss: 1.025 Vali Acc: 0.641 Test Loss: 1.025 Test Acc: 0.641
Validation loss decreased (-0.624989 --> -0.640615).  Saving model ...
Epoch: 9 cost time: 2.9766173362731934
Epoch: 9, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.993 Vali Acc: 0.644 Test Loss: 0.993 Test Acc: 0.644
Validation loss decreased (-0.640615 --> -0.643740).  Saving model ...
Epoch: 10 cost time: 3.010115385055542
Epoch: 10, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.975 Vali Acc: 0.647 Test Loss: 0.975 Test Acc: 0.647
Validation loss decreased (-0.643740 --> -0.646865).  Saving model ...
Epoch: 11 cost time: 3.0238935947418213
Epoch: 11, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.040 Vali Acc: 0.637 Test Loss: 1.040 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.136334180831909
Epoch: 12, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.019 Vali Acc: 0.634 Test Loss: 1.019 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0585923194885254
Epoch: 13, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.098 Vali Acc: 0.625 Test Loss: 1.098 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9286341667175293
Epoch: 14, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.157 Vali Acc: 0.613 Test Loss: 1.157 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.687523365020752
Epoch: 15, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.126 Vali Acc: 0.637 Test Loss: 1.126 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.865178108215332
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.079 Vali Acc: 0.644 Test Loss: 1.079 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.726574659347534
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.089 Vali Acc: 0.647 Test Loss: 1.089 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.2968249320983887
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.147 Vali Acc: 0.628 Test Loss: 1.147 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.801269292831421
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.190 Vali Acc: 0.634 Test Loss: 1.190 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.784700393676758
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.128 Vali Acc: 0.650 Test Loss: 1.128 Test Acc: 0.650
Validation loss decreased (-0.646865 --> -0.649989).  Saving model ...
Epoch: 21 cost time: 2.716204881668091
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.121 Vali Acc: 0.656 Test Loss: 1.121 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.656239).  Saving model ...
Epoch: 22 cost time: 3.2921676635742188
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.134 Vali Acc: 0.662 Test Loss: 1.134 Test Acc: 0.662
Validation loss decreased (-0.656239 --> -0.662489).  Saving model ...
Epoch: 23 cost time: 2.8166306018829346
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.147 Vali Acc: 0.666 Test Loss: 1.147 Test Acc: 0.666
Validation loss decreased (-0.662489 --> -0.665614).  Saving model ...
Epoch: 24 cost time: 2.894606828689575
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.155 Vali Acc: 0.650 Test Loss: 1.155 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.012699842453003
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.145 Vali Acc: 0.650 Test Loss: 1.145 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.283597469329834
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.137 Vali Acc: 0.659 Test Loss: 1.137 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.0658118724823
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.138 Vali Acc: 0.666 Test Loss: 1.138 Test Acc: 0.666
Validation loss decreased (-0.665614 --> -0.665614).  Saving model ...
Epoch: 28 cost time: 2.78106427192688
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.152 Vali Acc: 0.672 Test Loss: 1.152 Test Acc: 0.672
Validation loss decreased (-0.665614 --> -0.671863).  Saving model ...
Epoch: 29 cost time: 2.732450485229492
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.150 Vali Acc: 0.662 Test Loss: 1.150 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.8358147144317627
Epoch: 30, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.146 Vali Acc: 0.666 Test Loss: 1.146 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.7892770767211914
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.139 Vali Acc: 0.666 Test Loss: 1.139 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.6091551780700684
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.138 Vali Acc: 0.662 Test Loss: 1.138 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.0205187797546387
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.147 Vali Acc: 0.666 Test Loss: 1.147 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.026883602142334
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.153 Vali Acc: 0.662 Test Loss: 1.153 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.043341636657715
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.155 Vali Acc: 0.672 Test Loss: 1.155 Test Acc: 0.672
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.989659070968628
Epoch: 36, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.151 Vali Acc: 0.656 Test Loss: 1.151 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.6849546432495117
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.156 Vali Acc: 0.662 Test Loss: 1.156 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.0145771503448486
Epoch: 38, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.157 Vali Acc: 0.659 Test Loss: 1.157 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.671875
model parameter : 722056
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.114211559295654
Epoch: 1, Steps: 8 | Train Loss: 2.148 Vali Loss: 2.062 Vali Acc: 0.159 Test Loss: 2.062 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 2.924086570739746
Epoch: 2, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.948 Vali Acc: 0.281 Test Loss: 1.948 Test Acc: 0.281
Validation loss decreased (-0.159354 --> -0.281231).  Saving model ...
Epoch: 3 cost time: 2.6791422367095947
Epoch: 3, Steps: 8 | Train Loss: 1.822 Vali Loss: 1.819 Vali Acc: 0.406 Test Loss: 1.819 Test Acc: 0.406
Validation loss decreased (-0.281231 --> -0.406232).  Saving model ...
Epoch: 4 cost time: 2.886047601699829
Epoch: 4, Steps: 8 | Train Loss: 1.526 Vali Loss: 1.685 Vali Acc: 0.428 Test Loss: 1.685 Test Acc: 0.428
Validation loss decreased (-0.406232 --> -0.428108).  Saving model ...
Epoch: 5 cost time: 2.872465133666992
Epoch: 5, Steps: 8 | Train Loss: 1.298 Vali Loss: 1.553 Vali Acc: 0.459 Test Loss: 1.553 Test Acc: 0.459
Validation loss decreased (-0.428108 --> -0.459359).  Saving model ...
Epoch: 6 cost time: 2.7907063961029053
Epoch: 6, Steps: 8 | Train Loss: 1.031 Vali Loss: 1.472 Vali Acc: 0.466 Test Loss: 1.472 Test Acc: 0.466
Validation loss decreased (-0.459359 --> -0.465610).  Saving model ...
Epoch: 7 cost time: 3.144158124923706
Epoch: 7, Steps: 8 | Train Loss: 0.840 Vali Loss: 1.450 Vali Acc: 0.441 Test Loss: 1.450 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.180692195892334
Epoch: 8, Steps: 8 | Train Loss: 0.648 Vali Loss: 1.355 Vali Acc: 0.509 Test Loss: 1.355 Test Acc: 0.509
Validation loss decreased (-0.465610 --> -0.509361).  Saving model ...
Epoch: 9 cost time: 3.397860050201416
Epoch: 9, Steps: 8 | Train Loss: 0.525 Vali Loss: 1.401 Vali Acc: 0.475 Test Loss: 1.401 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.942342758178711
Epoch: 10, Steps: 8 | Train Loss: 0.436 Vali Loss: 1.321 Vali Acc: 0.503 Test Loss: 1.321 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9261972904205322
Epoch: 11, Steps: 8 | Train Loss: 0.323 Vali Loss: 1.427 Vali Acc: 0.463 Test Loss: 1.427 Test Acc: 0.463
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2922260761260986
Epoch: 12, Steps: 8 | Train Loss: 0.245 Vali Loss: 1.433 Vali Acc: 0.481 Test Loss: 1.433 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1231436729431152
Epoch: 13, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.391 Vali Acc: 0.500 Test Loss: 1.391 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7355804443359375
Epoch: 14, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.429 Vali Acc: 0.497 Test Loss: 1.429 Test Acc: 0.497
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.148500680923462
Epoch: 15, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.521 Vali Acc: 0.503 Test Loss: 1.521 Test Acc: 0.503
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.162121295928955
Epoch: 16, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.525 Vali Acc: 0.475 Test Loss: 1.525 Test Acc: 0.475
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.151684045791626
Epoch: 17, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.468 Vali Acc: 0.512 Test Loss: 1.468 Test Acc: 0.512
Validation loss decreased (-0.509361 --> -0.512485).  Saving model ...
Epoch: 18 cost time: 3.1891205310821533
Epoch: 18, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.568 Vali Acc: 0.494 Test Loss: 1.568 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.79160213470459
Epoch: 19, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.585 Vali Acc: 0.512 Test Loss: 1.585 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7179903984069824
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.453 Vali Acc: 0.528 Test Loss: 1.453 Test Acc: 0.528
Validation loss decreased (-0.512485 --> -0.528110).  Saving model ...
Epoch: 21 cost time: 2.752267599105835
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.596 Vali Acc: 0.506 Test Loss: 1.596 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.078812837600708
Epoch: 22, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.561 Vali Acc: 0.522 Test Loss: 1.561 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.23750376701355
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.536 Vali Acc: 0.547 Test Loss: 1.536 Test Acc: 0.547
Validation loss decreased (-0.528110 --> -0.546860).  Saving model ...
Epoch: 24 cost time: 3.344054698944092
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.584 Vali Acc: 0.525 Test Loss: 1.584 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7482974529266357
Epoch: 25, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.513 Vali Acc: 0.544 Test Loss: 1.513 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.903024673461914
Epoch: 26, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.505 Vali Acc: 0.544 Test Loss: 1.505 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.9366652965545654
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.467 Vali Acc: 0.559 Test Loss: 1.467 Test Acc: 0.559
Validation loss decreased (-0.546860 --> -0.559360).  Saving model ...
Epoch: 28 cost time: 2.675219774246216
Epoch: 28, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.625 Vali Acc: 0.519 Test Loss: 1.625 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.6840877532958984
Epoch: 29, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.529 Vali Acc: 0.562 Test Loss: 1.529 Test Acc: 0.562
Validation loss decreased (-0.559360 --> -0.562485).  Saving model ...
Epoch: 30 cost time: 2.996415853500366
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.539 Vali Acc: 0.572 Test Loss: 1.539 Test Acc: 0.572
Validation loss decreased (-0.562485 --> -0.571860).  Saving model ...
Epoch: 31 cost time: 3.0901663303375244
Epoch: 31, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.571 Vali Acc: 0.566 Test Loss: 1.571 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3490686416625977
Epoch: 32, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.635 Vali Acc: 0.541 Test Loss: 1.635 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.065852642059326
Epoch: 33, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.569 Vali Acc: 0.566 Test Loss: 1.569 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.9213387966156006
Epoch: 34, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.479 Vali Acc: 0.581 Test Loss: 1.479 Test Acc: 0.581
Validation loss decreased (-0.571860 --> -0.581235).  Saving model ...
Epoch: 35 cost time: 2.9514076709747314
Epoch: 35, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.461 Vali Acc: 0.588 Test Loss: 1.461 Test Acc: 0.588
Validation loss decreased (-0.581235 --> -0.587485).  Saving model ...
Epoch: 36 cost time: 2.792442560195923
Epoch: 36, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.513 Vali Acc: 0.578 Test Loss: 1.513 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.0312681198120117
Epoch: 37, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.521 Vali Acc: 0.581 Test Loss: 1.521 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.292543411254883
Epoch: 38, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.514 Vali Acc: 0.584 Test Loss: 1.514 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.353930711746216
Epoch: 39, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.580 Vali Acc: 0.562 Test Loss: 1.580 Test Acc: 0.562
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.79193115234375
Epoch: 40, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.572 Vali Acc: 0.578 Test Loss: 1.572 Test Acc: 0.578
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.860067844390869
Epoch: 41, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.546 Vali Acc: 0.578 Test Loss: 1.546 Test Acc: 0.578
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.995460033416748
Epoch: 42, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.553 Vali Acc: 0.569 Test Loss: 1.553 Test Acc: 0.569
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.130645751953125
Epoch: 43, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.561 Vali Acc: 0.578 Test Loss: 1.561 Test Acc: 0.578
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.1670050621032715
Epoch: 44, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.563 Vali Acc: 0.578 Test Loss: 1.563 Test Acc: 0.578
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.18053936958313
Epoch: 45, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.523 Vali Acc: 0.597 Test Loss: 1.523 Test Acc: 0.597
Validation loss decreased (-0.587485 --> -0.596860).  Saving model ...
Epoch: 46 cost time: 3.257197856903076
Epoch: 46, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.509 Vali Acc: 0.606 Test Loss: 1.509 Test Acc: 0.606
Validation loss decreased (-0.596860 --> -0.606235).  Saving model ...
Epoch: 47 cost time: 3.023390054702759
Epoch: 47, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.500 Vali Acc: 0.597 Test Loss: 1.500 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.9062533378601074
Epoch: 48, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.492 Vali Acc: 0.600 Test Loss: 1.492 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.9852662086486816
Epoch: 49, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.498 Vali Acc: 0.603 Test Loss: 1.498 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.6797707080841064
Epoch: 50, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.503 Vali Acc: 0.609 Test Loss: 1.503 Test Acc: 0.609
Validation loss decreased (-0.606235 --> -0.609360).  Saving model ...
Epoch: 51 cost time: 2.7425479888916016
Epoch: 51, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.563 Vali Acc: 0.591 Test Loss: 1.563 Test Acc: 0.591
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.9965295791625977
Epoch: 52, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.572 Vali Acc: 0.594 Test Loss: 1.572 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.8633077144622803
Epoch: 53, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.558 Vali Acc: 0.588 Test Loss: 1.558 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.6178886890411377
Epoch: 54, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.527 Vali Acc: 0.600 Test Loss: 1.527 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.8122408390045166
Epoch: 55, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.481 Vali Acc: 0.616 Test Loss: 1.481 Test Acc: 0.616
Validation loss decreased (-0.609360 --> -0.615610).  Saving model ...
Epoch: 56 cost time: 3.464447259902954
Epoch: 56, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.510 Vali Acc: 0.619 Test Loss: 1.510 Test Acc: 0.619
Validation loss decreased (-0.615610 --> -0.618735).  Saving model ...
Epoch: 57 cost time: 3.37013578414917
Epoch: 57, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.519 Vali Acc: 0.609 Test Loss: 1.519 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.997368097305298
Epoch: 58, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.546 Vali Acc: 0.597 Test Loss: 1.546 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.919761896133423
Epoch: 59, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.563 Vali Acc: 0.597 Test Loss: 1.563 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.035897731781006
Epoch: 60, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.616 Test Loss: 1.529 Test Acc: 0.616
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.1081860065460205
Epoch: 61, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.489 Vali Acc: 0.628 Test Loss: 1.489 Test Acc: 0.628
Validation loss decreased (-0.618735 --> -0.628110).  Saving model ...
Epoch: 62 cost time: 3.092954635620117
Epoch: 62, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.606 Test Loss: 1.544 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.1951358318328857
Epoch: 63, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.593 Vali Acc: 0.606 Test Loss: 1.593 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.769420623779297
Epoch: 64, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.603 Test Loss: 1.544 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.787889003753662
Epoch: 65, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.488 Vali Acc: 0.628 Test Loss: 1.488 Test Acc: 0.628
Validation loss decreased (-0.628110 --> -0.628110).  Saving model ...
Epoch: 66 cost time: 2.9560556411743164
Epoch: 66, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.488 Vali Acc: 0.619 Test Loss: 1.488 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.65626859664917
Epoch: 67, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.514 Vali Acc: 0.625 Test Loss: 1.514 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 3.2223241329193115
Epoch: 68, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.497 Vali Acc: 0.634 Test Loss: 1.497 Test Acc: 0.634
Validation loss decreased (-0.628110 --> -0.634360).  Saving model ...
Epoch: 69 cost time: 3.08994722366333
Epoch: 69, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.493 Vali Acc: 0.637 Test Loss: 1.493 Test Acc: 0.637
Validation loss decreased (-0.634360 --> -0.637485).  Saving model ...
Epoch: 70 cost time: 3.4097375869750977
Epoch: 70, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.505 Vali Acc: 0.625 Test Loss: 1.505 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 2.9686410427093506
Epoch: 71, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.613 Test Loss: 1.551 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 2.894893169403076
Epoch: 72, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.564 Vali Acc: 0.613 Test Loss: 1.564 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 3.0981924533843994
Epoch: 73, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.537 Vali Acc: 0.628 Test Loss: 1.537 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 3.4672152996063232
Epoch: 74, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.625 Test Loss: 1.544 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 3.0514957904815674
Epoch: 75, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.507 Vali Acc: 0.634 Test Loss: 1.507 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 3.1154625415802
Epoch: 76, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.484 Vali Acc: 0.641 Test Loss: 1.484 Test Acc: 0.641
Validation loss decreased (-0.637485 --> -0.640610).  Saving model ...
Epoch: 77 cost time: 2.7029857635498047
Epoch: 77, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.492 Vali Acc: 0.634 Test Loss: 1.492 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 2.9790868759155273
Epoch: 78, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.509 Vali Acc: 0.628 Test Loss: 1.509 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 2.976557731628418
Epoch: 79, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.625 Test Loss: 1.530 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 3.0814735889434814
Epoch: 80, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.616 Test Loss: 1.576 Test Acc: 0.616
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 3.238274335861206
Epoch: 81, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.600 Vali Acc: 0.616 Test Loss: 1.600 Test Acc: 0.616
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 3.1796135902404785
Epoch: 82, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.616 Test Loss: 1.582 Test Acc: 0.616
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 2.9709718227386475
Epoch: 83, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.553 Vali Acc: 0.625 Test Loss: 1.553 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 3.0682125091552734
Epoch: 84, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.521 Vali Acc: 0.644 Test Loss: 1.521 Test Acc: 0.644
Validation loss decreased (-0.640610 --> -0.643735).  Saving model ...
Epoch: 85 cost time: 2.8732151985168457
Epoch: 85, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.631 Test Loss: 1.541 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 3.182985305786133
Epoch: 86, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.628 Test Loss: 1.543 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 3.3263132572174072
Epoch: 87, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.650 Test Loss: 1.513 Test Acc: 0.650
Validation loss decreased (-0.643735 --> -0.649985).  Saving model ...
Epoch: 88 cost time: 3.2124462127685547
Epoch: 88, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.647 Test Loss: 1.495 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 2.9744462966918945
Epoch: 89, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.650 Test Loss: 1.513 Test Acc: 0.650
Validation loss decreased (-0.649985 --> -0.649985).  Saving model ...
Epoch: 90 cost time: 2.884065628051758
Epoch: 90, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.644 Test Loss: 1.513 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 2.771949052810669
Epoch: 91, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.514 Vali Acc: 0.647 Test Loss: 1.514 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 3.5185492038726807
Epoch: 92, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.644 Test Loss: 1.532 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 3.065779209136963
Epoch: 93, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.544 Vali Acc: 0.647 Test Loss: 1.544 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 2.868715763092041
Epoch: 94, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.544 Vali Acc: 0.644 Test Loss: 1.544 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 3.047259569168091
Epoch: 95, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.641 Test Loss: 1.535 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 2.817776679992676
Epoch: 96, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.644 Test Loss: 1.535 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 3.098423719406128
Epoch: 97, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.650 Test Loss: 1.534 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 3.072171211242676
Epoch: 98, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.647 Test Loss: 1.516 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 3.2217226028442383
Epoch: 99, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.650 Test Loss: 1.511 Test Acc: 0.650
Validation loss decreased (-0.649985 --> -0.649985).  Saving model ...
Epoch: 100 cost time: 2.903364896774292
Epoch: 100, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.656 Test Loss: 1.511 Test Acc: 0.656
Validation loss decreased (-0.649985 --> -0.656235).  Saving model ...
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.65625
model parameter : 722056
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.781903982162476
Epoch: 1, Steps: 8 | Train Loss: 2.128 Vali Loss: 2.075 Vali Acc: 0.134 Test Loss: 2.075 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 3.358943223953247
Epoch: 2, Steps: 8 | Train Loss: 2.016 Vali Loss: 2.008 Vali Acc: 0.150 Test Loss: 2.008 Test Acc: 0.150
Validation loss decreased (-0.134354 --> -0.149980).  Saving model ...
Epoch: 3 cost time: 3.0749857425689697
Epoch: 3, Steps: 8 | Train Loss: 1.909 Vali Loss: 1.941 Vali Acc: 0.287 Test Loss: 1.941 Test Acc: 0.287
Validation loss decreased (-0.149980 --> -0.287481).  Saving model ...
Epoch: 4 cost time: 3.494337320327759
Epoch: 4, Steps: 8 | Train Loss: 1.688 Vali Loss: 1.856 Vali Acc: 0.328 Test Loss: 1.856 Test Acc: 0.328
Validation loss decreased (-0.287481 --> -0.328106).  Saving model ...
Epoch: 5 cost time: 3.2864627838134766
Epoch: 5, Steps: 8 | Train Loss: 1.493 Vali Loss: 1.751 Vali Acc: 0.391 Test Loss: 1.751 Test Acc: 0.391
Validation loss decreased (-0.328106 --> -0.390607).  Saving model ...
Epoch: 6 cost time: 3.044050455093384
Epoch: 6, Steps: 8 | Train Loss: 1.248 Vali Loss: 1.706 Vali Acc: 0.372 Test Loss: 1.706 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9028618335723877
Epoch: 7, Steps: 8 | Train Loss: 1.050 Vali Loss: 1.677 Vali Acc: 0.362 Test Loss: 1.677 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2661149501800537
Epoch: 8, Steps: 8 | Train Loss: 0.878 Vali Loss: 1.530 Vali Acc: 0.403 Test Loss: 1.530 Test Acc: 0.403
Validation loss decreased (-0.390607 --> -0.403110).  Saving model ...
Epoch: 9 cost time: 3.3697824478149414
Epoch: 9, Steps: 8 | Train Loss: 0.710 Vali Loss: 1.585 Vali Acc: 0.388 Test Loss: 1.585 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5425901412963867
Epoch: 10, Steps: 8 | Train Loss: 0.569 Vali Loss: 1.481 Vali Acc: 0.394 Test Loss: 1.481 Test Acc: 0.394
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1093177795410156
Epoch: 11, Steps: 8 | Train Loss: 0.462 Vali Loss: 1.557 Vali Acc: 0.375 Test Loss: 1.557 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7185771465301514
Epoch: 12, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.515 Vali Acc: 0.397 Test Loss: 1.515 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.79282808303833
Epoch: 13, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.562 Vali Acc: 0.375 Test Loss: 1.562 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.058441638946533
Epoch: 14, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.522 Vali Acc: 0.419 Test Loss: 1.522 Test Acc: 0.419
Validation loss decreased (-0.403110 --> -0.418735).  Saving model ...
Epoch: 15 cost time: 3.2044410705566406
Epoch: 15, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.750 Vali Acc: 0.350 Test Loss: 1.750 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3916783332824707
Epoch: 16, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.616 Vali Acc: 0.403 Test Loss: 1.616 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1393442153930664
Epoch: 17, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.762 Vali Acc: 0.403 Test Loss: 1.762 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.055816411972046
Epoch: 18, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.945 Vali Acc: 0.372 Test Loss: 1.945 Test Acc: 0.372
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.10672664642334
Epoch: 19, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.908 Vali Acc: 0.375 Test Loss: 1.908 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.259592294692993
Epoch: 20, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.944 Vali Acc: 0.372 Test Loss: 1.944 Test Acc: 0.372
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.0633933544158936
Epoch: 21, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.904 Vali Acc: 0.406 Test Loss: 1.904 Test Acc: 0.406
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.1381571292877197
Epoch: 22, Steps: 8 | Train Loss: 0.044 Vali Loss: 2.002 Vali Acc: 0.403 Test Loss: 2.002 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.7643654346466064
Epoch: 23, Steps: 8 | Train Loss: 0.032 Vali Loss: 2.219 Vali Acc: 0.331 Test Loss: 2.219 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.8929543495178223
Epoch: 24, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.832 Vali Acc: 0.447 Test Loss: 1.832 Test Acc: 0.447
Validation loss decreased (-0.418735 --> -0.446857).  Saving model ...
Epoch: 25 cost time: 2.62088942527771
Epoch: 25, Steps: 8 | Train Loss: 0.023 Vali Loss: 2.013 Vali Acc: 0.425 Test Loss: 2.013 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.129253387451172
Epoch: 26, Steps: 8 | Train Loss: 0.025 Vali Loss: 2.165 Vali Acc: 0.397 Test Loss: 2.165 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.1622016429901123
Epoch: 27, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.729 Vali Acc: 0.509 Test Loss: 1.729 Test Acc: 0.509
Validation loss decreased (-0.446857 --> -0.509358).  Saving model ...
Epoch: 28 cost time: 2.9915175437927246
Epoch: 28, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.227 Vali Acc: 0.394 Test Loss: 2.227 Test Acc: 0.394
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0352232456207275
Epoch: 29, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.120 Vali Acc: 0.425 Test Loss: 2.120 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.9711124897003174
Epoch: 30, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.893 Vali Acc: 0.469 Test Loss: 1.893 Test Acc: 0.469
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.9484705924987793
Epoch: 31, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.877 Vali Acc: 0.472 Test Loss: 1.877 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.1540367603302
Epoch: 32, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.232 Vali Acc: 0.409 Test Loss: 2.232 Test Acc: 0.409
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.2211387157440186
Epoch: 33, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.962 Vali Acc: 0.484 Test Loss: 1.962 Test Acc: 0.484
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.640421152114868
Epoch: 34, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.855 Vali Acc: 0.516 Test Loss: 1.855 Test Acc: 0.516
Validation loss decreased (-0.509358 --> -0.515606).  Saving model ...
Epoch: 35 cost time: 2.7887048721313477
Epoch: 35, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.107 Vali Acc: 0.428 Test Loss: 2.107 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.7844350337982178
Epoch: 36, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.044 Vali Acc: 0.453 Test Loss: 2.044 Test Acc: 0.453
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.0213606357574463
Epoch: 37, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.905 Vali Acc: 0.500 Test Loss: 1.905 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.1919403076171875
Epoch: 38, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.160 Vali Acc: 0.444 Test Loss: 2.160 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.388387441635132
Epoch: 39, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.224 Vali Acc: 0.441 Test Loss: 2.224 Test Acc: 0.441
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.235018253326416
Epoch: 40, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.247 Vali Acc: 0.438 Test Loss: 2.247 Test Acc: 0.438
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.9488325119018555
Epoch: 41, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.934 Vali Acc: 0.503 Test Loss: 1.934 Test Acc: 0.503
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.8007898330688477
Epoch: 42, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.870 Vali Acc: 0.531 Test Loss: 1.870 Test Acc: 0.531
Validation loss decreased (-0.515606 --> -0.531231).  Saving model ...
Epoch: 43 cost time: 3.0520336627960205
Epoch: 43, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.069 Vali Acc: 0.481 Test Loss: 2.069 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.333798885345459
Epoch: 44, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.120 Vali Acc: 0.475 Test Loss: 2.120 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.248960256576538
Epoch: 45, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.853 Vali Acc: 0.534 Test Loss: 1.853 Test Acc: 0.534
Validation loss decreased (-0.531231 --> -0.534356).  Saving model ...
Epoch: 46 cost time: 3.4104042053222656
Epoch: 46, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.919 Vali Acc: 0.531 Test Loss: 1.919 Test Acc: 0.531
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.160273313522339
Epoch: 47, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.984 Vali Acc: 0.525 Test Loss: 1.984 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.9735770225524902
Epoch: 48, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.109 Vali Acc: 0.494 Test Loss: 2.109 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.1064467430114746
Epoch: 49, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.164 Vali Acc: 0.487 Test Loss: 2.164 Test Acc: 0.487
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.234755516052246
Epoch: 50, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.049 Vali Acc: 0.516 Test Loss: 2.049 Test Acc: 0.516
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.093867778778076
Epoch: 51, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.125 Vali Acc: 0.494 Test Loss: 2.125 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.2382161617279053
Epoch: 52, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.282 Vali Acc: 0.472 Test Loss: 2.282 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 2.7235100269317627
Epoch: 53, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.196 Vali Acc: 0.484 Test Loss: 2.196 Test Acc: 0.484
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 2.912107467651367
Epoch: 54, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.096 Vali Acc: 0.491 Test Loss: 2.096 Test Acc: 0.491
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 3.0633456707000732
Epoch: 55, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.987 Vali Acc: 0.525 Test Loss: 1.987 Test Acc: 0.525
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.534375
model parameter : 722056
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.796945571899414
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 2.092 Vali Acc: 0.159 Test Loss: 2.092 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 3.087653160095215
Epoch: 2, Steps: 8 | Train Loss: 2.047 Vali Loss: 2.042 Vali Acc: 0.119 Test Loss: 2.042 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8022961616516113
Epoch: 3, Steps: 8 | Train Loss: 1.934 Vali Loss: 1.998 Vali Acc: 0.138 Test Loss: 1.998 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.973104953765869
Epoch: 4, Steps: 8 | Train Loss: 1.720 Vali Loss: 1.925 Vali Acc: 0.253 Test Loss: 1.925 Test Acc: 0.253
Validation loss decreased (-0.159354 --> -0.253106).  Saving model ...
Epoch: 5 cost time: 2.650387763977051
Epoch: 5, Steps: 8 | Train Loss: 1.547 Vali Loss: 1.852 Vali Acc: 0.434 Test Loss: 1.852 Test Acc: 0.434
Validation loss decreased (-0.253106 --> -0.434356).  Saving model ...
Epoch: 6 cost time: 3.013845682144165
Epoch: 6, Steps: 8 | Train Loss: 1.334 Vali Loss: 1.795 Vali Acc: 0.350 Test Loss: 1.795 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0458173751831055
Epoch: 7, Steps: 8 | Train Loss: 1.136 Vali Loss: 1.748 Vali Acc: 0.359 Test Loss: 1.748 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2371091842651367
Epoch: 8, Steps: 8 | Train Loss: 0.947 Vali Loss: 1.644 Vali Acc: 0.419 Test Loss: 1.644 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.969172716140747
Epoch: 9, Steps: 8 | Train Loss: 0.777 Vali Loss: 1.634 Vali Acc: 0.350 Test Loss: 1.634 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.92624568939209
Epoch: 10, Steps: 8 | Train Loss: 0.630 Vali Loss: 1.503 Vali Acc: 0.406 Test Loss: 1.503 Test Acc: 0.406
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.887188196182251
Epoch: 11, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.489 Vali Acc: 0.388 Test Loss: 1.489 Test Acc: 0.388
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9705395698547363
Epoch: 12, Steps: 8 | Train Loss: 0.419 Vali Loss: 1.427 Vali Acc: 0.419 Test Loss: 1.427 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0550436973571777
Epoch: 13, Steps: 8 | Train Loss: 0.327 Vali Loss: 1.493 Vali Acc: 0.391 Test Loss: 1.493 Test Acc: 0.391
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.4982707500457764
Epoch: 14, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.369 Vali Acc: 0.481 Test Loss: 1.369 Test Acc: 0.481
Validation loss decreased (-0.434356 --> -0.481236).  Saving model ...
Epoch: 15 cost time: 3.244753122329712
Epoch: 15, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.468 Vali Acc: 0.419 Test Loss: 1.468 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.794923782348633
Epoch: 16, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.391 Vali Acc: 0.472 Test Loss: 1.391 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6646945476531982
Epoch: 17, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.519 Vali Acc: 0.434 Test Loss: 1.519 Test Acc: 0.434
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8719980716705322
Epoch: 18, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.703 Vali Acc: 0.412 Test Loss: 1.703 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.3978240489959717
Epoch: 19, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.549 Vali Acc: 0.478 Test Loss: 1.549 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.9955286979675293
Epoch: 20, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.637 Vali Acc: 0.441 Test Loss: 1.637 Test Acc: 0.441
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3301334381103516
Epoch: 21, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.617 Vali Acc: 0.487 Test Loss: 1.617 Test Acc: 0.487
Validation loss decreased (-0.481236 --> -0.487484).  Saving model ...
Epoch: 22 cost time: 3.2824947834014893
Epoch: 22, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.834 Vali Acc: 0.456 Test Loss: 1.834 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.198343515396118
Epoch: 23, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.751 Vali Acc: 0.472 Test Loss: 1.751 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.023379325866699
Epoch: 24, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.707 Vali Acc: 0.487 Test Loss: 1.707 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.2598633766174316
Epoch: 25, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.950 Vali Acc: 0.394 Test Loss: 1.950 Test Acc: 0.394
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.319903612136841
Epoch: 26, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.794 Vali Acc: 0.475 Test Loss: 1.794 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.4896631240844727
Epoch: 27, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.555 Vali Acc: 0.531 Test Loss: 1.555 Test Acc: 0.531
Validation loss decreased (-0.487484 --> -0.531234).  Saving model ...
Epoch: 28 cost time: 2.7869176864624023
Epoch: 28, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.869 Vali Acc: 0.459 Test Loss: 1.869 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2320568561553955
Epoch: 29, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.783 Vali Acc: 0.487 Test Loss: 1.783 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.8117644786834717
Epoch: 30, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.727 Vali Acc: 0.500 Test Loss: 1.727 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.0715160369873047
Epoch: 31, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.832 Vali Acc: 0.469 Test Loss: 1.832 Test Acc: 0.469
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.7902491092681885
Epoch: 32, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.936 Vali Acc: 0.484 Test Loss: 1.936 Test Acc: 0.484
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.8909735679626465
Epoch: 33, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.718 Vali Acc: 0.512 Test Loss: 1.718 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.252971649169922
Epoch: 34, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.726 Vali Acc: 0.506 Test Loss: 1.726 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.260561943054199
Epoch: 35, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.809 Vali Acc: 0.519 Test Loss: 1.809 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.5942020416259766
Epoch: 36, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.708 Vali Acc: 0.528 Test Loss: 1.708 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.9303739070892334
Epoch: 37, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.738 Vali Acc: 0.541 Test Loss: 1.738 Test Acc: 0.541
Validation loss decreased (-0.531234 --> -0.540608).  Saving model ...
Epoch: 38 cost time: 3.108386754989624
Epoch: 38, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.873 Vali Acc: 0.491 Test Loss: 1.873 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.2125415802001953
Epoch: 39, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.858 Vali Acc: 0.506 Test Loss: 1.858 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.2592179775238037
Epoch: 40, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.854 Vali Acc: 0.516 Test Loss: 1.854 Test Acc: 0.516
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.1115808486938477
Epoch: 41, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.803 Vali Acc: 0.519 Test Loss: 1.803 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.020026683807373
Epoch: 42, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.961 Vali Acc: 0.491 Test Loss: 1.961 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.9513320922851562
Epoch: 43, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.135 Vali Acc: 0.484 Test Loss: 2.135 Test Acc: 0.484
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.8424201011657715
Epoch: 44, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.796 Vali Acc: 0.512 Test Loss: 1.796 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.0775139331817627
Epoch: 45, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.761 Vali Acc: 0.522 Test Loss: 1.761 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.1419553756713867
Epoch: 46, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.974 Vali Acc: 0.497 Test Loss: 1.974 Test Acc: 0.497
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.640930652618408
Epoch: 47, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.010 Vali Acc: 0.503 Test Loss: 2.010 Test Acc: 0.503
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.540625
model parameter : 722056
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.585003614425659
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 2.091 Vali Acc: 0.159 Test Loss: 2.091 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 3.4823384284973145
Epoch: 2, Steps: 8 | Train Loss: 2.024 Vali Loss: 2.042 Vali Acc: 0.203 Test Loss: 2.042 Test Acc: 0.203
Validation loss decreased (-0.159354 --> -0.203105).  Saving model ...
Epoch: 3 cost time: 3.262617826461792
Epoch: 3, Steps: 8 | Train Loss: 1.922 Vali Loss: 2.008 Vali Acc: 0.231 Test Loss: 2.008 Test Acc: 0.231
Validation loss decreased (-0.203105 --> -0.231230).  Saving model ...
Epoch: 4 cost time: 3.175565242767334
Epoch: 4, Steps: 8 | Train Loss: 1.689 Vali Loss: 1.947 Vali Acc: 0.141 Test Loss: 1.947 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.739759683609009
Epoch: 5, Steps: 8 | Train Loss: 1.499 Vali Loss: 1.879 Vali Acc: 0.306 Test Loss: 1.879 Test Acc: 0.306
Validation loss decreased (-0.231230 --> -0.306231).  Saving model ...
Epoch: 6 cost time: 2.9774303436279297
Epoch: 6, Steps: 8 | Train Loss: 1.290 Vali Loss: 1.828 Vali Acc: 0.284 Test Loss: 1.828 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.802522897720337
Epoch: 7, Steps: 8 | Train Loss: 1.055 Vali Loss: 1.807 Vali Acc: 0.384 Test Loss: 1.807 Test Acc: 0.384
Validation loss decreased (-0.306231 --> -0.384357).  Saving model ...
Epoch: 8 cost time: 3.2391347885131836
Epoch: 8, Steps: 8 | Train Loss: 0.867 Vali Loss: 1.707 Vali Acc: 0.425 Test Loss: 1.707 Test Acc: 0.425
Validation loss decreased (-0.384357 --> -0.424983).  Saving model ...
Epoch: 9 cost time: 2.9211106300354004
Epoch: 9, Steps: 8 | Train Loss: 0.747 Vali Loss: 1.670 Vali Acc: 0.384 Test Loss: 1.670 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1008458137512207
Epoch: 10, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.567 Vali Acc: 0.416 Test Loss: 1.567 Test Acc: 0.416
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8402531147003174
Epoch: 11, Steps: 8 | Train Loss: 0.478 Vali Loss: 1.534 Vali Acc: 0.425 Test Loss: 1.534 Test Acc: 0.425
Validation loss decreased (-0.424983 --> -0.424985).  Saving model ...
Epoch: 12 cost time: 2.853041410446167
Epoch: 12, Steps: 8 | Train Loss: 0.414 Vali Loss: 1.417 Vali Acc: 0.472 Test Loss: 1.417 Test Acc: 0.472
Validation loss decreased (-0.424985 --> -0.471861).  Saving model ...
Epoch: 13 cost time: 2.9114270210266113
Epoch: 13, Steps: 8 | Train Loss: 0.321 Vali Loss: 1.505 Vali Acc: 0.438 Test Loss: 1.505 Test Acc: 0.438
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.096923589706421
Epoch: 14, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.394 Vali Acc: 0.484 Test Loss: 1.394 Test Acc: 0.484
Validation loss decreased (-0.471861 --> -0.484361).  Saving model ...
Epoch: 15 cost time: 3.049046039581299
Epoch: 15, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.497 Vali Acc: 0.456 Test Loss: 1.497 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0077226161956787
Epoch: 16, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.453 Vali Acc: 0.456 Test Loss: 1.453 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.027517557144165
Epoch: 17, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.439 Vali Acc: 0.500 Test Loss: 1.439 Test Acc: 0.500
Validation loss decreased (-0.484361 --> -0.499986).  Saving model ...
Epoch: 18 cost time: 3.1154775619506836
Epoch: 18, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.591 Vali Acc: 0.444 Test Loss: 1.591 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4223525524139404
Epoch: 19, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.505 Vali Acc: 0.481 Test Loss: 1.505 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2613487243652344
Epoch: 20, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.566 Vali Acc: 0.469 Test Loss: 1.566 Test Acc: 0.469
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.209055185317993
Epoch: 21, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.615 Vali Acc: 0.466 Test Loss: 1.615 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.1990764141082764
Epoch: 22, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.604 Vali Acc: 0.494 Test Loss: 1.604 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.7581169605255127
Epoch: 23, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.635 Vali Acc: 0.491 Test Loss: 1.635 Test Acc: 0.491
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.5987648963928223
Epoch: 24, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.694 Vali Acc: 0.475 Test Loss: 1.694 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.102672815322876
Epoch: 25, Steps: 8 | Train Loss: 0.041 Vali Loss: 2.019 Vali Acc: 0.412 Test Loss: 2.019 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.9476308822631836
Epoch: 26, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.785 Vali Acc: 0.434 Test Loss: 1.785 Test Acc: 0.434
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.17097806930542
Epoch: 27, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.534 Vali Acc: 0.516 Test Loss: 1.534 Test Acc: 0.516
Validation loss decreased (-0.499986 --> -0.515610).  Saving model ...
Epoch: 28 cost time: 2.7789101600646973
Epoch: 28, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.964 Vali Acc: 0.438 Test Loss: 1.964 Test Acc: 0.438
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.942866086959839
Epoch: 29, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.985 Vali Acc: 0.441 Test Loss: 1.985 Test Acc: 0.441
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.058943510055542
Epoch: 30, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.769 Vali Acc: 0.475 Test Loss: 1.769 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.273604154586792
Epoch: 31, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.956 Vali Acc: 0.469 Test Loss: 1.956 Test Acc: 0.469
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.4282562732696533
Epoch: 32, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.016 Vali Acc: 0.428 Test Loss: 2.016 Test Acc: 0.428
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.8597471714019775
Epoch: 33, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.957 Vali Acc: 0.478 Test Loss: 1.957 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.0526297092437744
Epoch: 34, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.839 Vali Acc: 0.512 Test Loss: 1.839 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.3510208129882812
Epoch: 35, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.765 Vali Acc: 0.506 Test Loss: 1.765 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.289977550506592
Epoch: 36, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.824 Vali Acc: 0.478 Test Loss: 1.824 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.246704578399658
Epoch: 37, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.688 Vali Acc: 0.500 Test Loss: 1.688 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.515625
model parameter : 722056
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.637112617492676
Epoch: 1, Steps: 8 | Train Loss: 2.120 Vali Loss: 2.088 Vali Acc: 0.134 Test Loss: 2.088 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 3.2922208309173584
Epoch: 2, Steps: 8 | Train Loss: 2.110 Vali Loss: 2.053 Vali Acc: 0.197 Test Loss: 2.053 Test Acc: 0.197
Validation loss decreased (-0.134354 --> -0.196854).  Saving model ...
Epoch: 3 cost time: 3.1526710987091064
Epoch: 3, Steps: 8 | Train Loss: 1.922 Vali Loss: 2.007 Vali Acc: 0.156 Test Loss: 2.007 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1647486686706543
Epoch: 4, Steps: 8 | Train Loss: 1.706 Vali Loss: 1.913 Vali Acc: 0.322 Test Loss: 1.913 Test Acc: 0.322
Validation loss decreased (-0.196854 --> -0.321856).  Saving model ...
Epoch: 5 cost time: 3.026719093322754
Epoch: 5, Steps: 8 | Train Loss: 1.519 Vali Loss: 1.821 Vali Acc: 0.397 Test Loss: 1.821 Test Acc: 0.397
Validation loss decreased (-0.321856 --> -0.396857).  Saving model ...
Epoch: 6 cost time: 3.2596495151519775
Epoch: 6, Steps: 8 | Train Loss: 1.350 Vali Loss: 1.730 Vali Acc: 0.378 Test Loss: 1.730 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.241150379180908
Epoch: 7, Steps: 8 | Train Loss: 1.169 Vali Loss: 1.639 Vali Acc: 0.372 Test Loss: 1.639 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2865161895751953
Epoch: 8, Steps: 8 | Train Loss: 0.968 Vali Loss: 1.503 Vali Acc: 0.531 Test Loss: 1.503 Test Acc: 0.531
Validation loss decreased (-0.396857 --> -0.531235).  Saving model ...
Epoch: 9 cost time: 3.4472808837890625
Epoch: 9, Steps: 8 | Train Loss: 0.814 Vali Loss: 1.421 Vali Acc: 0.525 Test Loss: 1.421 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1266398429870605
Epoch: 10, Steps: 8 | Train Loss: 0.657 Vali Loss: 1.354 Vali Acc: 0.534 Test Loss: 1.354 Test Acc: 0.534
Validation loss decreased (-0.531235 --> -0.534361).  Saving model ...
Epoch: 11 cost time: 2.8495497703552246
Epoch: 11, Steps: 8 | Train Loss: 0.533 Vali Loss: 1.323 Vali Acc: 0.512 Test Loss: 1.323 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8385093212127686
Epoch: 12, Steps: 8 | Train Loss: 0.503 Vali Loss: 1.304 Vali Acc: 0.512 Test Loss: 1.304 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1096296310424805
Epoch: 13, Steps: 8 | Train Loss: 0.381 Vali Loss: 1.394 Vali Acc: 0.487 Test Loss: 1.394 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.151362657546997
Epoch: 14, Steps: 8 | Train Loss: 0.321 Vali Loss: 1.369 Vali Acc: 0.484 Test Loss: 1.369 Test Acc: 0.484
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.9156198501586914
Epoch: 15, Steps: 8 | Train Loss: 0.267 Vali Loss: 1.457 Vali Acc: 0.475 Test Loss: 1.457 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9303572177886963
Epoch: 16, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.533 Vali Acc: 0.441 Test Loss: 1.533 Test Acc: 0.441
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.222440004348755
Epoch: 17, Steps: 8 | Train Loss: 0.187 Vali Loss: 1.612 Vali Acc: 0.419 Test Loss: 1.612 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.3303933143615723
Epoch: 18, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.924 Vali Acc: 0.384 Test Loss: 1.924 Test Acc: 0.384
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.1496047973632812
Epoch: 19, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.681 Vali Acc: 0.459 Test Loss: 1.681 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.036269187927246
Epoch: 20, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.887 Vali Acc: 0.434 Test Loss: 1.887 Test Acc: 0.434
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.534375
model parameter : 722056
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.7291154861450195
Epoch: 1, Steps: 8 | Train Loss: 2.165 Vali Loss: 2.117 Vali Acc: 0.131 Test Loss: 2.117 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 2.847736358642578
Epoch: 2, Steps: 8 | Train Loss: 2.088 Vali Loss: 2.080 Vali Acc: 0.153 Test Loss: 2.080 Test Acc: 0.153
Validation loss decreased (-0.131229 --> -0.153104).  Saving model ...
Epoch: 3 cost time: 2.747882604598999
Epoch: 3, Steps: 8 | Train Loss: 1.952 Vali Loss: 2.033 Vali Acc: 0.194 Test Loss: 2.033 Test Acc: 0.194
Validation loss decreased (-0.153104 --> -0.193730).  Saving model ...
Epoch: 4 cost time: 2.6734673976898193
Epoch: 4, Steps: 8 | Train Loss: 1.774 Vali Loss: 1.973 Vali Acc: 0.219 Test Loss: 1.973 Test Acc: 0.219
Validation loss decreased (-0.193730 --> -0.218730).  Saving model ...
Epoch: 5 cost time: 3.0864226818084717
Epoch: 5, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.910 Vali Acc: 0.216 Test Loss: 1.910 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3136720657348633
Epoch: 6, Steps: 8 | Train Loss: 1.366 Vali Loss: 1.838 Vali Acc: 0.272 Test Loss: 1.838 Test Acc: 0.272
Validation loss decreased (-0.218730 --> -0.271857).  Saving model ...
Epoch: 7 cost time: 3.13053297996521
Epoch: 7, Steps: 8 | Train Loss: 1.225 Vali Loss: 1.769 Vali Acc: 0.375 Test Loss: 1.769 Test Acc: 0.375
Validation loss decreased (-0.271857 --> -0.374982).  Saving model ...
Epoch: 8 cost time: 2.966074228286743
Epoch: 8, Steps: 8 | Train Loss: 1.070 Vali Loss: 1.685 Vali Acc: 0.384 Test Loss: 1.685 Test Acc: 0.384
Validation loss decreased (-0.374982 --> -0.384358).  Saving model ...
Epoch: 9 cost time: 3.165893316268921
Epoch: 9, Steps: 8 | Train Loss: 0.910 Vali Loss: 1.578 Vali Acc: 0.450 Test Loss: 1.578 Test Acc: 0.450
Validation loss decreased (-0.384358 --> -0.449984).  Saving model ...
Epoch: 10 cost time: 2.9823076725006104
Epoch: 10, Steps: 8 | Train Loss: 0.783 Vali Loss: 1.498 Vali Acc: 0.453 Test Loss: 1.498 Test Acc: 0.453
Validation loss decreased (-0.449984 --> -0.453110).  Saving model ...
Epoch: 11 cost time: 2.879204750061035
Epoch: 11, Steps: 8 | Train Loss: 0.664 Vali Loss: 1.466 Vali Acc: 0.441 Test Loss: 1.466 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9982962608337402
Epoch: 12, Steps: 8 | Train Loss: 0.532 Vali Loss: 1.391 Vali Acc: 0.475 Test Loss: 1.391 Test Acc: 0.475
Validation loss decreased (-0.453110 --> -0.474986).  Saving model ...
Epoch: 13 cost time: 2.9387903213500977
Epoch: 13, Steps: 8 | Train Loss: 0.471 Vali Loss: 1.426 Vali Acc: 0.450 Test Loss: 1.426 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1818788051605225
Epoch: 14, Steps: 8 | Train Loss: 0.400 Vali Loss: 1.384 Vali Acc: 0.444 Test Loss: 1.384 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.883561134338379
Epoch: 15, Steps: 8 | Train Loss: 0.342 Vali Loss: 1.453 Vali Acc: 0.438 Test Loss: 1.453 Test Acc: 0.438
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.667001247406006
Epoch: 16, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.472 Vali Acc: 0.447 Test Loss: 1.472 Test Acc: 0.447
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.585249185562134
Epoch: 17, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.459 Vali Acc: 0.475 Test Loss: 1.459 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0415258407592773
Epoch: 18, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.585 Vali Acc: 0.441 Test Loss: 1.585 Test Acc: 0.441
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.2172858715057373
Epoch: 19, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.613 Vali Acc: 0.438 Test Loss: 1.613 Test Acc: 0.438
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.087064027786255
Epoch: 20, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.756 Vali Acc: 0.409 Test Loss: 1.756 Test Acc: 0.409
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.982933521270752
Epoch: 21, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.887 Vali Acc: 0.406 Test Loss: 1.887 Test Acc: 0.406
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.8969810009002686
Epoch: 22, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.765 Vali Acc: 0.422 Test Loss: 1.765 Test Acc: 0.422
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.475
model parameter : 722056
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.879017114639282
Epoch: 1, Steps: 8 | Train Loss: 2.040 Vali Loss: 1.873 Vali Acc: 0.388 Test Loss: 1.873 Test Acc: 0.388
Validation loss decreased (inf --> -0.387481).  Saving model ...
Epoch: 2 cost time: 2.960737943649292
Epoch: 2, Steps: 8 | Train Loss: 1.663 Vali Loss: 1.401 Vali Acc: 0.603 Test Loss: 1.401 Test Acc: 0.603
Validation loss decreased (-0.387481 --> -0.603111).  Saving model ...
Epoch: 3 cost time: 2.840611219406128
Epoch: 3, Steps: 8 | Train Loss: 1.169 Vali Loss: 1.043 Vali Acc: 0.722 Test Loss: 1.043 Test Acc: 0.722
Validation loss decreased (-0.603111 --> -0.721865).  Saving model ...
Epoch: 4 cost time: 3.129443407058716
Epoch: 4, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.849 Vali Acc: 0.744 Test Loss: 0.849 Test Acc: 0.744
Validation loss decreased (-0.721865 --> -0.743742).  Saving model ...
Epoch: 5 cost time: 2.9214277267456055
Epoch: 5, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.771 Vali Acc: 0.753 Test Loss: 0.771 Test Acc: 0.753
Validation loss decreased (-0.743742 --> -0.753117).  Saving model ...
Epoch: 6 cost time: 2.6562154293060303
Epoch: 6, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.706 Vali Acc: 0.766 Test Loss: 0.706 Test Acc: 0.766
Validation loss decreased (-0.753117 --> -0.765618).  Saving model ...
Epoch: 7 cost time: 2.6742029190063477
Epoch: 7, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.686 Vali Acc: 0.781 Test Loss: 0.686 Test Acc: 0.781
Validation loss decreased (-0.765618 --> -0.781243).  Saving model ...
Epoch: 8 cost time: 2.6777546405792236
Epoch: 8, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2282049655914307
Epoch: 9, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.704 Vali Acc: 0.766 Test Loss: 0.704 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1033079624176025
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.747 Vali Acc: 0.756 Test Loss: 0.747 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.9612882137298584
Epoch: 11, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.802 Vali Acc: 0.769 Test Loss: 0.802 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.837724208831787
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.774 Vali Acc: 0.762 Test Loss: 0.774 Test Acc: 0.762
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.890883207321167
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.794 Vali Acc: 0.772 Test Loss: 0.794 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.0897271633148193
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.796 Vali Acc: 0.775 Test Loss: 0.796 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.0690176486968994
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.813 Vali Acc: 0.759 Test Loss: 0.813 Test Acc: 0.759
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.721649646759033
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.828 Vali Acc: 0.766 Test Loss: 0.828 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6487011909484863
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.842 Vali Acc: 0.766 Test Loss: 0.842 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.78125
model parameter : 525448
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.815314292907715
Epoch: 1, Steps: 8 | Train Loss: 2.055 Vali Loss: 1.902 Vali Acc: 0.362 Test Loss: 1.902 Test Acc: 0.362
Validation loss decreased (inf --> -0.362481).  Saving model ...
Epoch: 2 cost time: 2.7287604808807373
Epoch: 2, Steps: 8 | Train Loss: 1.748 Vali Loss: 1.538 Vali Acc: 0.553 Test Loss: 1.538 Test Acc: 0.553
Validation loss decreased (-0.362481 --> -0.553110).  Saving model ...
Epoch: 3 cost time: 2.9365222454071045
Epoch: 3, Steps: 8 | Train Loss: 1.296 Vali Loss: 1.256 Vali Acc: 0.625 Test Loss: 1.256 Test Acc: 0.625
Validation loss decreased (-0.553110 --> -0.624987).  Saving model ...
Epoch: 4 cost time: 3.5170774459838867
Epoch: 4, Steps: 8 | Train Loss: 0.975 Vali Loss: 1.083 Vali Acc: 0.669 Test Loss: 1.083 Test Acc: 0.669
Validation loss decreased (-0.624987 --> -0.668739).  Saving model ...
Epoch: 5 cost time: 3.0430514812469482
Epoch: 5, Steps: 8 | Train Loss: 0.668 Vali Loss: 1.004 Vali Acc: 0.688 Test Loss: 1.004 Test Acc: 0.688
Validation loss decreased (-0.668739 --> -0.687490).  Saving model ...
Epoch: 6 cost time: 3.223259210586548
Epoch: 6, Steps: 8 | Train Loss: 0.452 Vali Loss: 0.904 Vali Acc: 0.716 Test Loss: 0.904 Test Acc: 0.716
Validation loss decreased (-0.687490 --> -0.715616).  Saving model ...
Epoch: 7 cost time: 2.960723876953125
Epoch: 7, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.871 Vali Acc: 0.706 Test Loss: 0.871 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9658701419830322
Epoch: 8, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.905 Vali Acc: 0.694 Test Loss: 0.905 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.169020414352417
Epoch: 9, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.897 Vali Acc: 0.700 Test Loss: 0.897 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.289228677749634
Epoch: 10, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.974 Vali Acc: 0.688 Test Loss: 0.974 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.879936695098877
Epoch: 11, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.035 Vali Acc: 0.669 Test Loss: 1.035 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7523529529571533
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.026 Vali Acc: 0.678 Test Loss: 1.026 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.970324993133545
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.048 Vali Acc: 0.684 Test Loss: 1.048 Test Acc: 0.684
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.2182722091674805
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.077 Vali Acc: 0.694 Test Loss: 1.077 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.3908660411834717
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.076 Vali Acc: 0.672 Test Loss: 1.076 Test Acc: 0.672
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.226778507232666
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.088 Vali Acc: 0.672 Test Loss: 1.088 Test Acc: 0.672
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.715625
model parameter : 525448
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.302101373672485
Epoch: 1, Steps: 8 | Train Loss: 2.088 Vali Loss: 1.941 Vali Acc: 0.287 Test Loss: 1.941 Test Acc: 0.287
Validation loss decreased (inf --> -0.287481).  Saving model ...
Epoch: 2 cost time: 3.135695695877075
Epoch: 2, Steps: 8 | Train Loss: 1.830 Vali Loss: 1.648 Vali Acc: 0.491 Test Loss: 1.648 Test Acc: 0.491
Validation loss decreased (-0.287481 --> -0.490609).  Saving model ...
Epoch: 3 cost time: 2.8974485397338867
Epoch: 3, Steps: 8 | Train Loss: 1.442 Vali Loss: 1.387 Vali Acc: 0.537 Test Loss: 1.387 Test Acc: 0.537
Validation loss decreased (-0.490609 --> -0.537486).  Saving model ...
Epoch: 4 cost time: 3.1490862369537354
Epoch: 4, Steps: 8 | Train Loss: 1.096 Vali Loss: 1.214 Vali Acc: 0.594 Test Loss: 1.214 Test Acc: 0.594
Validation loss decreased (-0.537486 --> -0.593738).  Saving model ...
Epoch: 5 cost time: 3.0571863651275635
Epoch: 5, Steps: 8 | Train Loss: 0.761 Vali Loss: 1.127 Vali Acc: 0.622 Test Loss: 1.127 Test Acc: 0.622
Validation loss decreased (-0.593738 --> -0.621864).  Saving model ...
Epoch: 6 cost time: 3.0732688903808594
Epoch: 6, Steps: 8 | Train Loss: 0.542 Vali Loss: 1.024 Vali Acc: 0.641 Test Loss: 1.024 Test Acc: 0.641
Validation loss decreased (-0.621864 --> -0.640615).  Saving model ...
Epoch: 7 cost time: 3.1240639686584473
Epoch: 7, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.999 Vali Acc: 0.647 Test Loss: 0.999 Test Acc: 0.647
Validation loss decreased (-0.640615 --> -0.646865).  Saving model ...
Epoch: 8 cost time: 2.6646037101745605
Epoch: 8, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.017 Vali Acc: 0.644 Test Loss: 1.017 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.937633514404297
Epoch: 9, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.021 Vali Acc: 0.659 Test Loss: 1.021 Test Acc: 0.659
Validation loss decreased (-0.646865 --> -0.659365).  Saving model ...
Epoch: 10 cost time: 3.0662550926208496
Epoch: 10, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.037 Vali Acc: 0.634 Test Loss: 1.037 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9623916149139404
Epoch: 11, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.092 Vali Acc: 0.656 Test Loss: 1.092 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6654207706451416
Epoch: 12, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.096 Vali Acc: 0.666 Test Loss: 1.096 Test Acc: 0.666
Validation loss decreased (-0.659365 --> -0.665614).  Saving model ...
Epoch: 13 cost time: 2.9055862426757812
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.116 Vali Acc: 0.662 Test Loss: 1.116 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.021965980529785
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.151 Vali Acc: 0.666 Test Loss: 1.151 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.343510627746582
Epoch: 15, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.172 Vali Acc: 0.653 Test Loss: 1.172 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.4161503314971924
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.180 Vali Acc: 0.650 Test Loss: 1.180 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.1971476078033447
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.199 Vali Acc: 0.666 Test Loss: 1.199 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.761540412902832
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.208 Vali Acc: 0.669 Test Loss: 1.208 Test Acc: 0.669
Validation loss decreased (-0.665614 --> -0.668738).  Saving model ...
Epoch: 19 cost time: 2.7204487323760986
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.185 Vali Acc: 0.669 Test Loss: 1.185 Test Acc: 0.669
Validation loss decreased (-0.668738 --> -0.668738).  Saving model ...
Epoch: 20 cost time: 2.7474076747894287
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.181 Vali Acc: 0.681 Test Loss: 1.181 Test Acc: 0.681
Validation loss decreased (-0.668738 --> -0.681238).  Saving model ...
Epoch: 21 cost time: 2.6622490882873535
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.210 Vali Acc: 0.666 Test Loss: 1.210 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3331127166748047
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.217 Vali Acc: 0.672 Test Loss: 1.217 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.609724283218384
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.217 Vali Acc: 0.675 Test Loss: 1.217 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.720592498779297
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.219 Vali Acc: 0.675 Test Loss: 1.219 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.895984649658203
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.221 Vali Acc: 0.678 Test Loss: 1.221 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.2670044898986816
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.230 Vali Acc: 0.681 Test Loss: 1.230 Test Acc: 0.681
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.133871078491211
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.247 Vali Acc: 0.669 Test Loss: 1.247 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.9084677696228027
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.256 Vali Acc: 0.669 Test Loss: 1.256 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.9965569972991943
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.257 Vali Acc: 0.678 Test Loss: 1.257 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.3993630409240723
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.260 Vali Acc: 0.669 Test Loss: 1.260 Test Acc: 0.669
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.68125
model parameter : 525448
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.578732490539551
Epoch: 1, Steps: 8 | Train Loss: 2.138 Vali Loss: 2.027 Vali Acc: 0.200 Test Loss: 2.027 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 3.1473920345306396
Epoch: 2, Steps: 8 | Train Loss: 1.927 Vali Loss: 1.836 Vali Acc: 0.391 Test Loss: 1.836 Test Acc: 0.391
Validation loss decreased (-0.199980 --> -0.390607).  Saving model ...
Epoch: 3 cost time: 3.129047155380249
Epoch: 3, Steps: 8 | Train Loss: 1.648 Vali Loss: 1.631 Vali Acc: 0.478 Test Loss: 1.631 Test Acc: 0.478
Validation loss decreased (-0.390607 --> -0.478109).  Saving model ...
Epoch: 4 cost time: 2.648042678833008
Epoch: 4, Steps: 8 | Train Loss: 1.352 Vali Loss: 1.465 Vali Acc: 0.506 Test Loss: 1.465 Test Acc: 0.506
Validation loss decreased (-0.478109 --> -0.506235).  Saving model ...
Epoch: 5 cost time: 2.874885320663452
Epoch: 5, Steps: 8 | Train Loss: 1.035 Vali Loss: 1.327 Vali Acc: 0.553 Test Loss: 1.327 Test Acc: 0.553
Validation loss decreased (-0.506235 --> -0.553112).  Saving model ...
Epoch: 6 cost time: 3.1123602390289307
Epoch: 6, Steps: 8 | Train Loss: 0.771 Vali Loss: 1.215 Vali Acc: 0.541 Test Loss: 1.215 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9579882621765137
Epoch: 7, Steps: 8 | Train Loss: 0.574 Vali Loss: 1.152 Vali Acc: 0.581 Test Loss: 1.152 Test Acc: 0.581
Validation loss decreased (-0.553112 --> -0.581238).  Saving model ...
Epoch: 8 cost time: 2.9518799781799316
Epoch: 8, Steps: 8 | Train Loss: 0.436 Vali Loss: 1.089 Vali Acc: 0.600 Test Loss: 1.089 Test Acc: 0.600
Validation loss decreased (-0.581238 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 2.749420404434204
Epoch: 9, Steps: 8 | Train Loss: 0.348 Vali Loss: 1.098 Vali Acc: 0.616 Test Loss: 1.098 Test Acc: 0.616
Validation loss decreased (-0.599989 --> -0.615614).  Saving model ...
Epoch: 10 cost time: 2.933084726333618
Epoch: 10, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.082 Vali Acc: 0.619 Test Loss: 1.082 Test Acc: 0.619
Validation loss decreased (-0.615614 --> -0.618739).  Saving model ...
Epoch: 11 cost time: 2.937375783920288
Epoch: 11, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.089 Vali Acc: 0.619 Test Loss: 1.089 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0602493286132812
Epoch: 12, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.094 Vali Acc: 0.634 Test Loss: 1.094 Test Acc: 0.634
Validation loss decreased (-0.618739 --> -0.634364).  Saving model ...
Epoch: 13 cost time: 2.8238484859466553
Epoch: 13, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.145 Vali Acc: 0.641 Test Loss: 1.145 Test Acc: 0.641
Validation loss decreased (-0.634364 --> -0.640614).  Saving model ...
Epoch: 14 cost time: 2.564281940460205
Epoch: 14, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.184 Vali Acc: 0.622 Test Loss: 1.184 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.019530773162842
Epoch: 15, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.209 Vali Acc: 0.609 Test Loss: 1.209 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.070042848587036
Epoch: 16, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.185 Vali Acc: 0.631 Test Loss: 1.185 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7345972061157227
Epoch: 17, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.204 Vali Acc: 0.628 Test Loss: 1.204 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.663119316101074
Epoch: 18, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.199 Vali Acc: 0.628 Test Loss: 1.199 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.058913230895996
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.208 Vali Acc: 0.619 Test Loss: 1.208 Test Acc: 0.619
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.0246007442474365
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.191 Vali Acc: 0.634 Test Loss: 1.191 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.8000786304473877
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.221 Vali Acc: 0.641 Test Loss: 1.221 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.7584774494171143
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.222 Vali Acc: 0.637 Test Loss: 1.222 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.9578897953033447
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.230 Vali Acc: 0.637 Test Loss: 1.230 Test Acc: 0.637
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.640625
model parameter : 525448
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.752835512161255
Epoch: 1, Steps: 8 | Train Loss: 2.147 Vali Loss: 2.042 Vali Acc: 0.188 Test Loss: 2.042 Test Acc: 0.188
Validation loss decreased (inf --> -0.187480).  Saving model ...
Epoch: 2 cost time: 2.9006400108337402
Epoch: 2, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.931 Vali Acc: 0.300 Test Loss: 1.931 Test Acc: 0.300
Validation loss decreased (-0.187480 --> -0.299981).  Saving model ...
Epoch: 3 cost time: 3.1824331283569336
Epoch: 3, Steps: 8 | Train Loss: 1.805 Vali Loss: 1.809 Vali Acc: 0.375 Test Loss: 1.809 Test Acc: 0.375
Validation loss decreased (-0.299981 --> -0.374982).  Saving model ...
Epoch: 4 cost time: 2.9922468662261963
Epoch: 4, Steps: 8 | Train Loss: 1.558 Vali Loss: 1.719 Vali Acc: 0.369 Test Loss: 1.719 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7141549587249756
Epoch: 5, Steps: 8 | Train Loss: 1.270 Vali Loss: 1.611 Vali Acc: 0.434 Test Loss: 1.611 Test Acc: 0.434
Validation loss decreased (-0.374982 --> -0.434359).  Saving model ...
Epoch: 6 cost time: 2.865281581878662
Epoch: 6, Steps: 8 | Train Loss: 1.046 Vali Loss: 1.502 Vali Acc: 0.450 Test Loss: 1.502 Test Acc: 0.450
Validation loss decreased (-0.434359 --> -0.449985).  Saving model ...
Epoch: 7 cost time: 3.1094157695770264
Epoch: 7, Steps: 8 | Train Loss: 0.814 Vali Loss: 1.463 Vali Acc: 0.456 Test Loss: 1.463 Test Acc: 0.456
Validation loss decreased (-0.449985 --> -0.456235).  Saving model ...
Epoch: 8 cost time: 3.2509305477142334
Epoch: 8, Steps: 8 | Train Loss: 0.695 Vali Loss: 1.443 Vali Acc: 0.466 Test Loss: 1.443 Test Acc: 0.466
Validation loss decreased (-0.456235 --> -0.465611).  Saving model ...
Epoch: 9 cost time: 3.051119565963745
Epoch: 9, Steps: 8 | Train Loss: 0.563 Vali Loss: 1.453 Vali Acc: 0.450 Test Loss: 1.453 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0258636474609375
Epoch: 10, Steps: 8 | Train Loss: 0.443 Vali Loss: 1.486 Vali Acc: 0.456 Test Loss: 1.486 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.519275188446045
Epoch: 11, Steps: 8 | Train Loss: 0.333 Vali Loss: 1.446 Vali Acc: 0.481 Test Loss: 1.446 Test Acc: 0.481
Validation loss decreased (-0.465611 --> -0.481236).  Saving model ...
Epoch: 12 cost time: 2.990828275680542
Epoch: 12, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.484 Vali Acc: 0.475 Test Loss: 1.484 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.314544439315796
Epoch: 13, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.500 Vali Acc: 0.469 Test Loss: 1.500 Test Acc: 0.469
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0391006469726562
Epoch: 14, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.484 Vali Acc: 0.491 Test Loss: 1.484 Test Acc: 0.491
Validation loss decreased (-0.481236 --> -0.490610).  Saving model ...
Epoch: 15 cost time: 3.2410783767700195
Epoch: 15, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.556 Vali Acc: 0.472 Test Loss: 1.556 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.092278242111206
Epoch: 16, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.552 Vali Acc: 0.484 Test Loss: 1.552 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0815834999084473
Epoch: 17, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.704 Vali Acc: 0.438 Test Loss: 1.704 Test Acc: 0.438
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8307278156280518
Epoch: 18, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.692 Vali Acc: 0.459 Test Loss: 1.692 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.907686233520508
Epoch: 19, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.685 Vali Acc: 0.459 Test Loss: 1.685 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.3374922275543213
Epoch: 20, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.503 Vali Acc: 0.525 Test Loss: 1.503 Test Acc: 0.525
Validation loss decreased (-0.490610 --> -0.524985).  Saving model ...
Epoch: 21 cost time: 3.0945799350738525
Epoch: 21, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.648 Vali Acc: 0.453 Test Loss: 1.648 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0597455501556396
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.689 Vali Acc: 0.478 Test Loss: 1.689 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8542253971099854
Epoch: 23, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.607 Vali Acc: 0.516 Test Loss: 1.607 Test Acc: 0.516
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.097459077835083
Epoch: 24, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.678 Vali Acc: 0.478 Test Loss: 1.678 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.1586406230926514
Epoch: 25, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.750 Vali Acc: 0.484 Test Loss: 1.750 Test Acc: 0.484
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.2224340438842773
Epoch: 26, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.638 Vali Acc: 0.516 Test Loss: 1.638 Test Acc: 0.516
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.9114246368408203
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.687 Vali Acc: 0.503 Test Loss: 1.687 Test Acc: 0.503
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.924912452697754
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.785 Vali Acc: 0.478 Test Loss: 1.785 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.2583999633789062
Epoch: 29, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.647 Vali Acc: 0.525 Test Loss: 1.647 Test Acc: 0.525
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.240739345550537
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.670 Vali Acc: 0.512 Test Loss: 1.670 Test Acc: 0.512
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.525
model parameter : 525448
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.389604091644287
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 2.078 Vali Acc: 0.119 Test Loss: 2.078 Test Acc: 0.119
Validation loss decreased (inf --> -0.118729).  Saving model ...
Epoch: 2 cost time: 2.908891439437866
Epoch: 2, Steps: 8 | Train Loss: 2.034 Vali Loss: 2.012 Vali Acc: 0.212 Test Loss: 2.012 Test Acc: 0.212
Validation loss decreased (-0.118729 --> -0.212480).  Saving model ...
Epoch: 3 cost time: 3.056317090988159
Epoch: 3, Steps: 8 | Train Loss: 1.909 Vali Loss: 1.942 Vali Acc: 0.281 Test Loss: 1.942 Test Acc: 0.281
Validation loss decreased (-0.212480 --> -0.281231).  Saving model ...
Epoch: 4 cost time: 2.6523091793060303
Epoch: 4, Steps: 8 | Train Loss: 1.688 Vali Loss: 1.891 Vali Acc: 0.284 Test Loss: 1.891 Test Acc: 0.284
Validation loss decreased (-0.281231 --> -0.284356).  Saving model ...
Epoch: 5 cost time: 2.6975486278533936
Epoch: 5, Steps: 8 | Train Loss: 1.490 Vali Loss: 1.811 Vali Acc: 0.334 Test Loss: 1.811 Test Acc: 0.334
Validation loss decreased (-0.284356 --> -0.334357).  Saving model ...
Epoch: 6 cost time: 3.2159934043884277
Epoch: 6, Steps: 8 | Train Loss: 1.225 Vali Loss: 1.711 Vali Acc: 0.366 Test Loss: 1.711 Test Acc: 0.366
Validation loss decreased (-0.334357 --> -0.365608).  Saving model ...
Epoch: 7 cost time: 2.88010835647583
Epoch: 7, Steps: 8 | Train Loss: 1.017 Vali Loss: 1.647 Vali Acc: 0.384 Test Loss: 1.647 Test Acc: 0.384
Validation loss decreased (-0.365608 --> -0.384359).  Saving model ...
Epoch: 8 cost time: 2.7811524868011475
Epoch: 8, Steps: 8 | Train Loss: 0.908 Vali Loss: 1.615 Vali Acc: 0.375 Test Loss: 1.615 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.773404836654663
Epoch: 9, Steps: 8 | Train Loss: 0.723 Vali Loss: 1.614 Vali Acc: 0.328 Test Loss: 1.614 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.152716636657715
Epoch: 10, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.632 Vali Acc: 0.325 Test Loss: 1.632 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.34297776222229
Epoch: 11, Steps: 8 | Train Loss: 0.448 Vali Loss: 1.535 Vali Acc: 0.375 Test Loss: 1.535 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9102091789245605
Epoch: 12, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.528 Vali Acc: 0.378 Test Loss: 1.528 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8954644203186035
Epoch: 13, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.648 Vali Acc: 0.347 Test Loss: 1.648 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.3738009929656982
Epoch: 14, Steps: 8 | Train Loss: 0.259 Vali Loss: 1.673 Vali Acc: 0.341 Test Loss: 1.673 Test Acc: 0.341
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.1141715049743652
Epoch: 15, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.727 Vali Acc: 0.334 Test Loss: 1.727 Test Acc: 0.334
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.9723520278930664
Epoch: 16, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.609 Vali Acc: 0.391 Test Loss: 1.609 Test Acc: 0.391
Validation loss decreased (-0.384359 --> -0.390609).  Saving model ...
Epoch: 17 cost time: 3.1106553077697754
Epoch: 17, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.966 Vali Acc: 0.328 Test Loss: 1.966 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1965079307556152
Epoch: 18, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.982 Vali Acc: 0.338 Test Loss: 1.982 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3102076053619385
Epoch: 19, Steps: 8 | Train Loss: 0.093 Vali Loss: 2.050 Vali Acc: 0.316 Test Loss: 2.050 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.912935972213745
Epoch: 20, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.706 Vali Acc: 0.450 Test Loss: 1.706 Test Acc: 0.450
Validation loss decreased (-0.390609 --> -0.449983).  Saving model ...
Epoch: 21 cost time: 3.0478897094726562
Epoch: 21, Steps: 8 | Train Loss: 0.062 Vali Loss: 2.026 Vali Acc: 0.375 Test Loss: 2.026 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.178481340408325
Epoch: 22, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.915 Vali Acc: 0.394 Test Loss: 1.915 Test Acc: 0.394
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2875211238861084
Epoch: 23, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.943 Vali Acc: 0.394 Test Loss: 1.943 Test Acc: 0.394
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.8951547145843506
Epoch: 24, Steps: 8 | Train Loss: 0.028 Vali Loss: 2.434 Vali Acc: 0.319 Test Loss: 2.434 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.06144118309021
Epoch: 25, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.762 Vali Acc: 0.450 Test Loss: 1.762 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.254774570465088
Epoch: 26, Steps: 8 | Train Loss: 0.030 Vali Loss: 2.216 Vali Acc: 0.359 Test Loss: 2.216 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.143394947052002
Epoch: 27, Steps: 8 | Train Loss: 0.023 Vali Loss: 2.168 Vali Acc: 0.350 Test Loss: 2.168 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.620220184326172
Epoch: 28, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.490 Vali Acc: 0.322 Test Loss: 2.490 Test Acc: 0.322
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.9269955158233643
Epoch: 29, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.124 Vali Acc: 0.375 Test Loss: 2.124 Test Acc: 0.375
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.2219748497009277
Epoch: 30, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.097 Vali Acc: 0.422 Test Loss: 2.097 Test Acc: 0.422
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.45
model parameter : 525448
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.576869964599609
Epoch: 1, Steps: 8 | Train Loss: 2.161 Vali Loss: 2.072 Vali Acc: 0.141 Test Loss: 2.072 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 3.2160072326660156
Epoch: 2, Steps: 8 | Train Loss: 2.066 Vali Loss: 2.032 Vali Acc: 0.272 Test Loss: 2.032 Test Acc: 0.272
Validation loss decreased (-0.140604 --> -0.271855).  Saving model ...
Epoch: 3 cost time: 3.36346173286438
Epoch: 3, Steps: 8 | Train Loss: 1.932 Vali Loss: 1.981 Vali Acc: 0.272 Test Loss: 1.981 Test Acc: 0.272
Validation loss decreased (-0.271855 --> -0.271855).  Saving model ...
Epoch: 4 cost time: 2.8486506938934326
Epoch: 4, Steps: 8 | Train Loss: 1.724 Vali Loss: 1.932 Vali Acc: 0.306 Test Loss: 1.932 Test Acc: 0.306
Validation loss decreased (-0.271855 --> -0.306231).  Saving model ...
Epoch: 5 cost time: 2.809422016143799
Epoch: 5, Steps: 8 | Train Loss: 1.536 Vali Loss: 1.881 Vali Acc: 0.341 Test Loss: 1.881 Test Acc: 0.341
Validation loss decreased (-0.306231 --> -0.340606).  Saving model ...
Epoch: 6 cost time: 3.130382537841797
Epoch: 6, Steps: 8 | Train Loss: 1.316 Vali Loss: 1.785 Vali Acc: 0.366 Test Loss: 1.785 Test Acc: 0.366
Validation loss decreased (-0.340606 --> -0.365607).  Saving model ...
Epoch: 7 cost time: 3.341580629348755
Epoch: 7, Steps: 8 | Train Loss: 1.087 Vali Loss: 1.726 Vali Acc: 0.369 Test Loss: 1.726 Test Acc: 0.369
Validation loss decreased (-0.365607 --> -0.368733).  Saving model ...
Epoch: 8 cost time: 2.841203451156616
Epoch: 8, Steps: 8 | Train Loss: 0.950 Vali Loss: 1.680 Vali Acc: 0.403 Test Loss: 1.680 Test Acc: 0.403
Validation loss decreased (-0.368733 --> -0.403108).  Saving model ...
Epoch: 9 cost time: 2.79512095451355
Epoch: 9, Steps: 8 | Train Loss: 0.772 Vali Loss: 1.652 Vali Acc: 0.347 Test Loss: 1.652 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1063544750213623
Epoch: 10, Steps: 8 | Train Loss: 0.639 Vali Loss: 1.610 Vali Acc: 0.344 Test Loss: 1.610 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1601922512054443
Epoch: 11, Steps: 8 | Train Loss: 0.479 Vali Loss: 1.524 Vali Acc: 0.391 Test Loss: 1.524 Test Acc: 0.391
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9364893436431885
Epoch: 12, Steps: 8 | Train Loss: 0.440 Vali Loss: 1.535 Vali Acc: 0.369 Test Loss: 1.535 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7281060218811035
Epoch: 13, Steps: 8 | Train Loss: 0.339 Vali Loss: 1.499 Vali Acc: 0.359 Test Loss: 1.499 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1472530364990234
Epoch: 14, Steps: 8 | Train Loss: 0.282 Vali Loss: 1.491 Vali Acc: 0.394 Test Loss: 1.491 Test Acc: 0.394
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2095396518707275
Epoch: 15, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.564 Vali Acc: 0.378 Test Loss: 1.564 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.219142436981201
Epoch: 16, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.504 Vali Acc: 0.378 Test Loss: 1.504 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.978034257888794
Epoch: 17, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.741 Vali Acc: 0.350 Test Loss: 1.741 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.9393677711486816
Epoch: 18, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.753 Vali Acc: 0.378 Test Loss: 1.753 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.403125
model parameter : 525448
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.8907105922698975
Epoch: 1, Steps: 8 | Train Loss: 2.177 Vali Loss: 2.094 Vali Acc: 0.128 Test Loss: 2.094 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 2.8450238704681396
Epoch: 2, Steps: 8 | Train Loss: 2.027 Vali Loss: 2.042 Vali Acc: 0.184 Test Loss: 2.042 Test Acc: 0.184
Validation loss decreased (-0.128104 --> -0.184355).  Saving model ...
Epoch: 3 cost time: 2.762860059738159
Epoch: 3, Steps: 8 | Train Loss: 1.899 Vali Loss: 2.004 Vali Acc: 0.231 Test Loss: 2.004 Test Acc: 0.231
Validation loss decreased (-0.184355 --> -0.231230).  Saving model ...
Epoch: 4 cost time: 3.430708885192871
Epoch: 4, Steps: 8 | Train Loss: 1.720 Vali Loss: 1.956 Vali Acc: 0.322 Test Loss: 1.956 Test Acc: 0.322
Validation loss decreased (-0.231230 --> -0.321855).  Saving model ...
Epoch: 5 cost time: 3.1735544204711914
Epoch: 5, Steps: 8 | Train Loss: 1.501 Vali Loss: 1.924 Vali Acc: 0.372 Test Loss: 1.924 Test Acc: 0.372
Validation loss decreased (-0.321855 --> -0.371856).  Saving model ...
Epoch: 6 cost time: 3.077085018157959
Epoch: 6, Steps: 8 | Train Loss: 1.248 Vali Loss: 1.847 Vali Acc: 0.341 Test Loss: 1.847 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8956923484802246
Epoch: 7, Steps: 8 | Train Loss: 1.024 Vali Loss: 1.786 Vali Acc: 0.338 Test Loss: 1.786 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.19244122505188
Epoch: 8, Steps: 8 | Train Loss: 0.880 Vali Loss: 1.717 Vali Acc: 0.356 Test Loss: 1.717 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9733591079711914
Epoch: 9, Steps: 8 | Train Loss: 0.709 Vali Loss: 1.704 Vali Acc: 0.322 Test Loss: 1.704 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.970686912536621
Epoch: 10, Steps: 8 | Train Loss: 0.599 Vali Loss: 1.676 Vali Acc: 0.328 Test Loss: 1.676 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2369561195373535
Epoch: 11, Steps: 8 | Train Loss: 0.461 Vali Loss: 1.530 Vali Acc: 0.381 Test Loss: 1.530 Test Acc: 0.381
Validation loss decreased (-0.371856 --> -0.381235).  Saving model ...
Epoch: 12 cost time: 2.9366519451141357
Epoch: 12, Steps: 8 | Train Loss: 0.415 Vali Loss: 1.566 Vali Acc: 0.378 Test Loss: 1.566 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.148533582687378
Epoch: 13, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.551 Vali Acc: 0.375 Test Loss: 1.551 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.975531816482544
Epoch: 14, Steps: 8 | Train Loss: 0.271 Vali Loss: 1.533 Vali Acc: 0.384 Test Loss: 1.533 Test Acc: 0.384
Validation loss decreased (-0.381235 --> -0.384360).  Saving model ...
Epoch: 15 cost time: 2.8205978870391846
Epoch: 15, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.568 Vali Acc: 0.381 Test Loss: 1.568 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6568243503570557
Epoch: 16, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.586 Vali Acc: 0.366 Test Loss: 1.586 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.90287446975708
Epoch: 17, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.636 Vali Acc: 0.369 Test Loss: 1.636 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.043243169784546
Epoch: 18, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.676 Vali Acc: 0.409 Test Loss: 1.676 Test Acc: 0.409
Validation loss decreased (-0.384360 --> -0.409358).  Saving model ...
Epoch: 19 cost time: 3.00345516204834
Epoch: 19, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.722 Vali Acc: 0.416 Test Loss: 1.722 Test Acc: 0.416
Validation loss decreased (-0.409358 --> -0.415608).  Saving model ...
Epoch: 20 cost time: 2.823035955429077
Epoch: 20, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.544 Vali Acc: 0.475 Test Loss: 1.544 Test Acc: 0.475
Validation loss decreased (-0.415608 --> -0.474985).  Saving model ...
Epoch: 21 cost time: 2.882631778717041
Epoch: 21, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.701 Vali Acc: 0.447 Test Loss: 1.701 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0094404220581055
Epoch: 22, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.751 Vali Acc: 0.456 Test Loss: 1.751 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8723936080932617
Epoch: 23, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.654 Vali Acc: 0.500 Test Loss: 1.654 Test Acc: 0.500
Validation loss decreased (-0.474985 --> -0.499983).  Saving model ...
Epoch: 24 cost time: 2.9240353107452393
Epoch: 24, Steps: 8 | Train Loss: 0.042 Vali Loss: 2.035 Vali Acc: 0.375 Test Loss: 2.035 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.083047389984131
Epoch: 25, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.664 Vali Acc: 0.481 Test Loss: 1.664 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.9930267333984375
Epoch: 26, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.791 Vali Acc: 0.438 Test Loss: 1.791 Test Acc: 0.438
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.1362202167510986
Epoch: 27, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.727 Vali Acc: 0.475 Test Loss: 1.727 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.900932788848877
Epoch: 28, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.834 Vali Acc: 0.463 Test Loss: 1.834 Test Acc: 0.463
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.8562827110290527
Epoch: 29, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.873 Vali Acc: 0.459 Test Loss: 1.873 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.728525161743164
Epoch: 30, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.757 Vali Acc: 0.494 Test Loss: 1.757 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.703752279281616
Epoch: 31, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.006 Vali Acc: 0.463 Test Loss: 2.006 Test Acc: 0.463
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.876377820968628
Epoch: 32, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.830 Vali Acc: 0.491 Test Loss: 1.830 Test Acc: 0.491
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.5914299488067627
Epoch: 33, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.670 Vali Acc: 0.531 Test Loss: 1.670 Test Acc: 0.531
Validation loss decreased (-0.499983 --> -0.531233).  Saving model ...
Epoch: 34 cost time: 2.9883437156677246
Epoch: 34, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.865 Vali Acc: 0.497 Test Loss: 1.865 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.8068976402282715
Epoch: 35, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.931 Vali Acc: 0.484 Test Loss: 1.931 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.8943469524383545
Epoch: 36, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.911 Vali Acc: 0.484 Test Loss: 1.911 Test Acc: 0.484
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.782639980316162
Epoch: 37, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.909 Vali Acc: 0.472 Test Loss: 1.909 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.7916274070739746
Epoch: 38, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.965 Vali Acc: 0.444 Test Loss: 1.965 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.141646146774292
Epoch: 39, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.812 Vali Acc: 0.500 Test Loss: 1.812 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.0931899547576904
Epoch: 40, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.843 Vali Acc: 0.516 Test Loss: 1.843 Test Acc: 0.516
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.173304796218872
Epoch: 41, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.009 Vali Acc: 0.478 Test Loss: 2.009 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.353972911834717
Epoch: 42, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.041 Vali Acc: 0.456 Test Loss: 2.041 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.201387405395508
Epoch: 43, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.871 Vali Acc: 0.497 Test Loss: 1.871 Test Acc: 0.497
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.53125
model parameter : 525448
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.367952346801758
Epoch: 1, Steps: 8 | Train Loss: 2.204 Vali Loss: 2.088 Vali Acc: 0.128 Test Loss: 2.088 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 2.9438858032226562
Epoch: 2, Steps: 8 | Train Loss: 2.054 Vali Loss: 2.052 Vali Acc: 0.131 Test Loss: 2.052 Test Acc: 0.131
Validation loss decreased (-0.128104 --> -0.131229).  Saving model ...
Epoch: 3 cost time: 2.730961322784424
Epoch: 3, Steps: 8 | Train Loss: 1.950 Vali Loss: 2.013 Vali Acc: 0.131 Test Loss: 2.013 Test Acc: 0.131
Validation loss decreased (-0.131229 --> -0.131230).  Saving model ...
Epoch: 4 cost time: 3.008179187774658
Epoch: 4, Steps: 8 | Train Loss: 1.769 Vali Loss: 1.960 Vali Acc: 0.225 Test Loss: 1.960 Test Acc: 0.225
Validation loss decreased (-0.131230 --> -0.224980).  Saving model ...
Epoch: 5 cost time: 2.6318631172180176
Epoch: 5, Steps: 8 | Train Loss: 1.568 Vali Loss: 1.865 Vali Acc: 0.297 Test Loss: 1.865 Test Acc: 0.297
Validation loss decreased (-0.224980 --> -0.296856).  Saving model ...
Epoch: 6 cost time: 2.8876264095306396
Epoch: 6, Steps: 8 | Train Loss: 1.295 Vali Loss: 1.771 Vali Acc: 0.309 Test Loss: 1.771 Test Acc: 0.309
Validation loss decreased (-0.296856 --> -0.309357).  Saving model ...
Epoch: 7 cost time: 2.9964654445648193
Epoch: 7, Steps: 8 | Train Loss: 1.072 Vali Loss: 1.685 Vali Acc: 0.366 Test Loss: 1.685 Test Acc: 0.366
Validation loss decreased (-0.309357 --> -0.365608).  Saving model ...
Epoch: 8 cost time: 3.156431198120117
Epoch: 8, Steps: 8 | Train Loss: 0.957 Vali Loss: 1.630 Vali Acc: 0.384 Test Loss: 1.630 Test Acc: 0.384
Validation loss decreased (-0.365608 --> -0.384359).  Saving model ...
Epoch: 9 cost time: 3.181598424911499
Epoch: 9, Steps: 8 | Train Loss: 0.789 Vali Loss: 1.572 Vali Acc: 0.366 Test Loss: 1.572 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.996891975402832
Epoch: 10, Steps: 8 | Train Loss: 0.650 Vali Loss: 1.556 Vali Acc: 0.372 Test Loss: 1.556 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8659284114837646
Epoch: 11, Steps: 8 | Train Loss: 0.500 Vali Loss: 1.445 Vali Acc: 0.422 Test Loss: 1.445 Test Acc: 0.422
Validation loss decreased (-0.384359 --> -0.421861).  Saving model ...
Epoch: 12 cost time: 2.913362979888916
Epoch: 12, Steps: 8 | Train Loss: 0.448 Vali Loss: 1.476 Vali Acc: 0.422 Test Loss: 1.476 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8418009281158447
Epoch: 13, Steps: 8 | Train Loss: 0.395 Vali Loss: 1.511 Vali Acc: 0.388 Test Loss: 1.511 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8526830673217773
Epoch: 14, Steps: 8 | Train Loss: 0.323 Vali Loss: 1.461 Vali Acc: 0.406 Test Loss: 1.461 Test Acc: 0.406
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8634843826293945
Epoch: 15, Steps: 8 | Train Loss: 0.245 Vali Loss: 1.559 Vali Acc: 0.375 Test Loss: 1.559 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0505330562591553
Epoch: 16, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.587 Vali Acc: 0.422 Test Loss: 1.587 Test Acc: 0.422
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.840120553970337
Epoch: 17, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.819 Vali Acc: 0.394 Test Loss: 1.819 Test Acc: 0.394
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.8464243412017822
Epoch: 18, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.782 Vali Acc: 0.403 Test Loss: 1.782 Test Acc: 0.403
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.00174617767334
Epoch: 19, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.827 Vali Acc: 0.425 Test Loss: 1.827 Test Acc: 0.425
Validation loss decreased (-0.421861 --> -0.424982).  Saving model ...
Epoch: 20 cost time: 2.9582736492156982
Epoch: 20, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.857 Vali Acc: 0.434 Test Loss: 1.857 Test Acc: 0.434
Validation loss decreased (-0.424982 --> -0.434356).  Saving model ...
Epoch: 21 cost time: 3.0524494647979736
Epoch: 21, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.842 Vali Acc: 0.453 Test Loss: 1.842 Test Acc: 0.453
Validation loss decreased (-0.434356 --> -0.453107).  Saving model ...
Epoch: 22 cost time: 2.777038812637329
Epoch: 22, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.972 Vali Acc: 0.447 Test Loss: 1.972 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0978221893310547
Epoch: 23, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.871 Vali Acc: 0.447 Test Loss: 1.871 Test Acc: 0.447
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.093445301055908
Epoch: 24, Steps: 8 | Train Loss: 0.061 Vali Loss: 2.150 Vali Acc: 0.416 Test Loss: 2.150 Test Acc: 0.416
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.8642818927764893
Epoch: 25, Steps: 8 | Train Loss: 0.054 Vali Loss: 2.086 Vali Acc: 0.472 Test Loss: 2.086 Test Acc: 0.472
Validation loss decreased (-0.453107 --> -0.471854).  Saving model ...
Epoch: 26 cost time: 2.8062965869903564
Epoch: 26, Steps: 8 | Train Loss: 0.046 Vali Loss: 2.072 Vali Acc: 0.447 Test Loss: 2.072 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7219114303588867
Epoch: 27, Steps: 8 | Train Loss: 0.038 Vali Loss: 2.002 Vali Acc: 0.463 Test Loss: 2.002 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.179986000061035
Epoch: 28, Steps: 8 | Train Loss: 0.027 Vali Loss: 2.293 Vali Acc: 0.441 Test Loss: 2.293 Test Acc: 0.441
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.064490795135498
Epoch: 29, Steps: 8 | Train Loss: 0.032 Vali Loss: 2.424 Vali Acc: 0.431 Test Loss: 2.424 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.7803189754486084
Epoch: 30, Steps: 8 | Train Loss: 0.029 Vali Loss: 2.341 Vali Acc: 0.434 Test Loss: 2.341 Test Acc: 0.434
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.999772548675537
Epoch: 31, Steps: 8 | Train Loss: 0.032 Vali Loss: 2.290 Vali Acc: 0.441 Test Loss: 2.290 Test Acc: 0.441
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.945601463317871
Epoch: 32, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.209 Vali Acc: 0.463 Test Loss: 2.209 Test Acc: 0.463
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.9935641288757324
Epoch: 33, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.254 Vali Acc: 0.459 Test Loss: 2.254 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.8964247703552246
Epoch: 34, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.383 Vali Acc: 0.450 Test Loss: 2.383 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.2148966789245605
Epoch: 35, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.381 Vali Acc: 0.438 Test Loss: 2.381 Test Acc: 0.438
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.471875
model parameter : 525448
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.561097621917725
Epoch: 1, Steps: 8 | Train Loss: 2.190 Vali Loss: 2.136 Vali Acc: 0.119 Test Loss: 2.136 Test Acc: 0.119
Validation loss decreased (inf --> -0.118729).  Saving model ...
Epoch: 2 cost time: 3.0294947624206543
Epoch: 2, Steps: 8 | Train Loss: 2.108 Vali Loss: 2.103 Vali Acc: 0.122 Test Loss: 2.103 Test Acc: 0.122
Validation loss decreased (-0.118729 --> -0.121854).  Saving model ...
Epoch: 3 cost time: 3.060394048690796
Epoch: 3, Steps: 8 | Train Loss: 1.995 Vali Loss: 2.052 Vali Acc: 0.188 Test Loss: 2.052 Test Acc: 0.188
Validation loss decreased (-0.121854 --> -0.187479).  Saving model ...
Epoch: 4 cost time: 2.9270005226135254
Epoch: 4, Steps: 8 | Train Loss: 1.828 Vali Loss: 2.003 Vali Acc: 0.219 Test Loss: 2.003 Test Acc: 0.219
Validation loss decreased (-0.187479 --> -0.218730).  Saving model ...
Epoch: 5 cost time: 2.6784019470214844
Epoch: 5, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.963 Vali Acc: 0.206 Test Loss: 1.963 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.835507869720459
Epoch: 6, Steps: 8 | Train Loss: 1.444 Vali Loss: 1.884 Vali Acc: 0.234 Test Loss: 1.884 Test Acc: 0.234
Validation loss decreased (-0.218730 --> -0.234356).  Saving model ...
Epoch: 7 cost time: 2.6785717010498047
Epoch: 7, Steps: 8 | Train Loss: 1.229 Vali Loss: 1.796 Vali Acc: 0.278 Test Loss: 1.796 Test Acc: 0.278
Validation loss decreased (-0.234356 --> -0.278107).  Saving model ...
Epoch: 8 cost time: 2.6022350788116455
Epoch: 8, Steps: 8 | Train Loss: 1.082 Vali Loss: 1.716 Vali Acc: 0.291 Test Loss: 1.716 Test Acc: 0.291
Validation loss decreased (-0.278107 --> -0.290608).  Saving model ...
Epoch: 9 cost time: 2.7090680599212646
Epoch: 9, Steps: 8 | Train Loss: 0.919 Vali Loss: 1.707 Vali Acc: 0.309 Test Loss: 1.707 Test Acc: 0.309
Validation loss decreased (-0.290608 --> -0.309358).  Saving model ...
Epoch: 10 cost time: 2.8321051597595215
Epoch: 10, Steps: 8 | Train Loss: 0.776 Vali Loss: 1.622 Vali Acc: 0.294 Test Loss: 1.622 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.663320541381836
Epoch: 11, Steps: 8 | Train Loss: 0.641 Vali Loss: 1.536 Vali Acc: 0.372 Test Loss: 1.536 Test Acc: 0.372
Validation loss decreased (-0.309358 --> -0.371860).  Saving model ...
Epoch: 12 cost time: 2.7541322708129883
Epoch: 12, Steps: 8 | Train Loss: 0.549 Vali Loss: 1.568 Vali Acc: 0.350 Test Loss: 1.568 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.806595802307129
Epoch: 13, Steps: 8 | Train Loss: 0.452 Vali Loss: 1.636 Vali Acc: 0.344 Test Loss: 1.636 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.979099988937378
Epoch: 14, Steps: 8 | Train Loss: 0.415 Vali Loss: 1.597 Vali Acc: 0.375 Test Loss: 1.597 Test Acc: 0.375
Validation loss decreased (-0.371860 --> -0.374984).  Saving model ...
Epoch: 15 cost time: 2.876065492630005
Epoch: 15, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.608 Vali Acc: 0.366 Test Loss: 1.608 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9697744846343994
Epoch: 16, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.676 Vali Acc: 0.381 Test Loss: 1.676 Test Acc: 0.381
Validation loss decreased (-0.374984 --> -0.381233).  Saving model ...
Epoch: 17 cost time: 2.8225836753845215
Epoch: 17, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.868 Vali Acc: 0.375 Test Loss: 1.868 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9124977588653564
Epoch: 18, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.828 Vali Acc: 0.378 Test Loss: 1.828 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6369097232818604
Epoch: 19, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.836 Vali Acc: 0.425 Test Loss: 1.836 Test Acc: 0.425
Validation loss decreased (-0.381233 --> -0.424982).  Saving model ...
Epoch: 20 cost time: 2.7623744010925293
Epoch: 20, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.767 Vali Acc: 0.428 Test Loss: 1.767 Test Acc: 0.428
Validation loss decreased (-0.424982 --> -0.428107).  Saving model ...
Epoch: 21 cost time: 2.6664798259735107
Epoch: 21, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.903 Vali Acc: 0.400 Test Loss: 1.903 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5607361793518066
Epoch: 22, Steps: 8 | Train Loss: 0.103 Vali Loss: 2.007 Vali Acc: 0.403 Test Loss: 2.007 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.655726909637451
Epoch: 23, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.744 Vali Acc: 0.412 Test Loss: 1.744 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7055912017822266
Epoch: 24, Steps: 8 | Train Loss: 0.079 Vali Loss: 2.089 Vali Acc: 0.412 Test Loss: 2.089 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.778770923614502
Epoch: 25, Steps: 8 | Train Loss: 0.085 Vali Loss: 2.200 Vali Acc: 0.397 Test Loss: 2.200 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.172736167907715
Epoch: 26, Steps: 8 | Train Loss: 0.069 Vali Loss: 2.187 Vali Acc: 0.406 Test Loss: 2.187 Test Acc: 0.406
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.8705387115478516
Epoch: 27, Steps: 8 | Train Loss: 0.043 Vali Loss: 2.091 Vali Acc: 0.409 Test Loss: 2.091 Test Acc: 0.409
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.9725241661071777
Epoch: 28, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.233 Vali Acc: 0.412 Test Loss: 2.233 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.9078586101531982
Epoch: 29, Steps: 8 | Train Loss: 0.049 Vali Loss: 2.153 Vali Acc: 0.456 Test Loss: 2.153 Test Acc: 0.456
Validation loss decreased (-0.428107 --> -0.456228).  Saving model ...
Epoch: 30 cost time: 2.744518995285034
Epoch: 30, Steps: 8 | Train Loss: 0.041 Vali Loss: 2.221 Vali Acc: 0.441 Test Loss: 2.221 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.508322238922119
Epoch: 31, Steps: 8 | Train Loss: 0.031 Vali Loss: 2.156 Vali Acc: 0.441 Test Loss: 2.156 Test Acc: 0.441
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.4057364463806152
Epoch: 32, Steps: 8 | Train Loss: 0.023 Vali Loss: 2.226 Vali Acc: 0.456 Test Loss: 2.226 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.5038225650787354
Epoch: 33, Steps: 8 | Train Loss: 0.022 Vali Loss: 2.326 Vali Acc: 0.434 Test Loss: 2.326 Test Acc: 0.434
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.696103096008301
Epoch: 34, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.251 Vali Acc: 0.463 Test Loss: 2.251 Test Acc: 0.463
Validation loss decreased (-0.456228 --> -0.462477).  Saving model ...
Epoch: 35 cost time: 2.514455556869507
Epoch: 35, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.240 Vali Acc: 0.469 Test Loss: 2.240 Test Acc: 0.469
Validation loss decreased (-0.462477 --> -0.468728).  Saving model ...
Epoch: 36 cost time: 2.405144453048706
Epoch: 36, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.369 Vali Acc: 0.447 Test Loss: 2.369 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.5938494205474854
Epoch: 37, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.358 Vali Acc: 0.463 Test Loss: 2.358 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.8664069175720215
Epoch: 38, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.216 Vali Acc: 0.459 Test Loss: 2.216 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.9782087802886963
Epoch: 39, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.196 Vali Acc: 0.497 Test Loss: 2.196 Test Acc: 0.497
Validation loss decreased (-0.468728 --> -0.496853).  Saving model ...
Epoch: 40 cost time: 3.0461301803588867
Epoch: 40, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.441 Vali Acc: 0.475 Test Loss: 2.441 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.8580663204193115
Epoch: 41, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.706 Vali Acc: 0.441 Test Loss: 2.706 Test Acc: 0.441
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.846226453781128
Epoch: 42, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.419 Vali Acc: 0.456 Test Loss: 2.419 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.5896918773651123
Epoch: 43, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.193 Vali Acc: 0.487 Test Loss: 2.193 Test Acc: 0.487
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.7060933113098145
Epoch: 44, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.223 Vali Acc: 0.503 Test Loss: 2.223 Test Acc: 0.503
Validation loss decreased (-0.496853 --> -0.503103).  Saving model ...
Epoch: 45 cost time: 2.4892563819885254
Epoch: 45, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.362 Vali Acc: 0.494 Test Loss: 2.362 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.783578872680664
Epoch: 46, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.506 Vali Acc: 0.484 Test Loss: 2.506 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.549095869064331
Epoch: 47, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.569 Vali Acc: 0.491 Test Loss: 2.569 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.5319557189941406
Epoch: 48, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.468 Vali Acc: 0.494 Test Loss: 2.468 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.561906099319458
Epoch: 49, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.348 Vali Acc: 0.491 Test Loss: 2.348 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.889054536819458
Epoch: 50, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.353 Vali Acc: 0.512 Test Loss: 2.353 Test Acc: 0.512
Validation loss decreased (-0.503103 --> -0.512476).  Saving model ...
Epoch: 51 cost time: 2.735994577407837
Epoch: 51, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.481 Vali Acc: 0.484 Test Loss: 2.481 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.8469784259796143
Epoch: 52, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.611 Vali Acc: 0.494 Test Loss: 2.611 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.7166707515716553
Epoch: 53, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.576 Vali Acc: 0.491 Test Loss: 2.576 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.603699207305908
Epoch: 54, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.506 Vali Acc: 0.484 Test Loss: 2.506 Test Acc: 0.484
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.5650744438171387
Epoch: 55, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.451 Vali Acc: 0.478 Test Loss: 2.451 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.6546289920806885
Epoch: 56, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.426 Vali Acc: 0.481 Test Loss: 2.426 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.6332030296325684
Epoch: 57, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.447 Vali Acc: 0.487 Test Loss: 2.447 Test Acc: 0.487
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.7275729179382324
Epoch: 58, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.338 Vali Acc: 0.506 Test Loss: 2.338 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 2.330491542816162
Epoch: 59, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.330 Vali Acc: 0.500 Test Loss: 2.330 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 2.419417142868042
Epoch: 60, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.381 Vali Acc: 0.497 Test Loss: 2.381 Test Acc: 0.497
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5125
model parameter : 525448
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.580728769302368
Epoch: 1, Steps: 8 | Train Loss: 2.112 Vali Loss: 1.906 Vali Acc: 0.322 Test Loss: 1.906 Test Acc: 0.322
Validation loss decreased (inf --> -0.321856).  Saving model ...
Epoch: 2 cost time: 3.1703622341156006
Epoch: 2, Steps: 8 | Train Loss: 1.732 Vali Loss: 1.440 Vali Acc: 0.688 Test Loss: 1.440 Test Acc: 0.688
Validation loss decreased (-0.321856 --> -0.687486).  Saving model ...
Epoch: 3 cost time: 2.677598476409912
Epoch: 3, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.059 Vali Acc: 0.700 Test Loss: 1.059 Test Acc: 0.700
Validation loss decreased (-0.687486 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 2.8601458072662354
Epoch: 4, Steps: 8 | Train Loss: 0.810 Vali Loss: 0.847 Vali Acc: 0.728 Test Loss: 0.847 Test Acc: 0.728
Validation loss decreased (-0.699989 --> -0.728117).  Saving model ...
Epoch: 5 cost time: 2.9235751628875732
Epoch: 5, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
Validation loss decreased (-0.728117 --> -0.749992).  Saving model ...
Epoch: 6 cost time: 2.925705909729004
Epoch: 6, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.721 Vali Acc: 0.759 Test Loss: 0.721 Test Acc: 0.759
Validation loss decreased (-0.749992 --> -0.759368).  Saving model ...
Epoch: 7 cost time: 2.906219959259033
Epoch: 7, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.730 Vali Acc: 0.759 Test Loss: 0.730 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.761307716369629
Epoch: 8, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.704 Vali Acc: 0.759 Test Loss: 0.704 Test Acc: 0.759
Validation loss decreased (-0.759368 --> -0.759368).  Saving model ...
Epoch: 9 cost time: 2.818510055541992
Epoch: 9, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.708 Vali Acc: 0.759 Test Loss: 0.708 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8757131099700928
Epoch: 10, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.742 Vali Acc: 0.766 Test Loss: 0.742 Test Acc: 0.766
Validation loss decreased (-0.759368 --> -0.765618).  Saving model ...
Epoch: 11 cost time: 3.0146825313568115
Epoch: 11, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.768 Vali Acc: 0.762 Test Loss: 0.768 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.923468589782715
Epoch: 12, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
Validation loss decreased (-0.765618 --> -0.774992).  Saving model ...
Epoch: 13 cost time: 2.9875128269195557
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.795 Vali Acc: 0.762 Test Loss: 0.795 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0824270248413086
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.808 Vali Acc: 0.781 Test Loss: 0.808 Test Acc: 0.781
Validation loss decreased (-0.774992 --> -0.781242).  Saving model ...
Epoch: 15 cost time: 2.740938425064087
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.822 Vali Acc: 0.769 Test Loss: 0.822 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5363850593566895
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.828 Vali Acc: 0.766 Test Loss: 0.828 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.725548028945923
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.820 Vali Acc: 0.784 Test Loss: 0.820 Test Acc: 0.784
Validation loss decreased (-0.781242 --> -0.784367).  Saving model ...
Epoch: 18 cost time: 3.0026941299438477
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.826 Vali Acc: 0.781 Test Loss: 0.826 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.926846981048584
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.833 Vali Acc: 0.778 Test Loss: 0.833 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.872366189956665
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.839 Vali Acc: 0.778 Test Loss: 0.839 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.8990933895111084
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.858 Vali Acc: 0.775 Test Loss: 0.858 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.9961016178131104
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.869 Vali Acc: 0.775 Test Loss: 0.869 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.030665874481201
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.871 Vali Acc: 0.784 Test Loss: 0.871 Test Acc: 0.784
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.0107998847961426
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.868 Vali Acc: 0.781 Test Loss: 0.868 Test Acc: 0.781
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.0292675495147705
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.867 Vali Acc: 0.781 Test Loss: 0.867 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.983086109161377
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.778 Test Loss: 0.878 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.7436106204986572
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.886 Vali Acc: 0.778 Test Loss: 0.886 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.784375
model parameter : 427144
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9931893348693848
Epoch: 1, Steps: 8 | Train Loss: 2.144 Vali Loss: 1.939 Vali Acc: 0.312 Test Loss: 1.939 Test Acc: 0.312
Validation loss decreased (inf --> -0.312481).  Saving model ...
Epoch: 2 cost time: 2.6616098880767822
Epoch: 2, Steps: 8 | Train Loss: 1.805 Vali Loss: 1.580 Vali Acc: 0.550 Test Loss: 1.580 Test Acc: 0.550
Validation loss decreased (-0.312481 --> -0.549984).  Saving model ...
Epoch: 3 cost time: 2.7337257862091064
Epoch: 3, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.289 Vali Acc: 0.597 Test Loss: 1.289 Test Acc: 0.597
Validation loss decreased (-0.549984 --> -0.596862).  Saving model ...
Epoch: 4 cost time: 2.683448076248169
Epoch: 4, Steps: 8 | Train Loss: 0.980 Vali Loss: 1.099 Vali Acc: 0.644 Test Loss: 1.099 Test Acc: 0.644
Validation loss decreased (-0.596862 --> -0.643739).  Saving model ...
Epoch: 5 cost time: 2.820685386657715
Epoch: 5, Steps: 8 | Train Loss: 0.715 Vali Loss: 1.020 Vali Acc: 0.666 Test Loss: 1.020 Test Acc: 0.666
Validation loss decreased (-0.643739 --> -0.665615).  Saving model ...
Epoch: 6 cost time: 2.6802029609680176
Epoch: 6, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.955 Vali Acc: 0.672 Test Loss: 0.955 Test Acc: 0.672
Validation loss decreased (-0.665615 --> -0.671865).  Saving model ...
Epoch: 7 cost time: 2.67161226272583
Epoch: 7, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.931 Vali Acc: 0.694 Test Loss: 0.931 Test Acc: 0.694
Validation loss decreased (-0.671865 --> -0.693741).  Saving model ...
Epoch: 8 cost time: 2.610652208328247
Epoch: 8, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.876 Vali Acc: 0.713 Test Loss: 0.876 Test Acc: 0.713
Validation loss decreased (-0.693741 --> -0.712491).  Saving model ...
Epoch: 9 cost time: 2.9918243885040283
Epoch: 9, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.935 Vali Acc: 0.675 Test Loss: 0.935 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.826913595199585
Epoch: 10, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.951 Vali Acc: 0.681 Test Loss: 0.951 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.786430597305298
Epoch: 11, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.972 Vali Acc: 0.684 Test Loss: 0.972 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8477015495300293
Epoch: 12, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.018 Vali Acc: 0.681 Test Loss: 1.018 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.668267250061035
Epoch: 13, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.039 Vali Acc: 0.669 Test Loss: 1.039 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7874650955200195
Epoch: 14, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.061 Vali Acc: 0.688 Test Loss: 1.061 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7134549617767334
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.054 Vali Acc: 0.697 Test Loss: 1.054 Test Acc: 0.697
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7742605209350586
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.078 Vali Acc: 0.694 Test Loss: 1.078 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.7191121578216553
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.086 Vali Acc: 0.697 Test Loss: 1.086 Test Acc: 0.697
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8565568923950195
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.088 Vali Acc: 0.697 Test Loss: 1.088 Test Acc: 0.697
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7125
model parameter : 427144
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.844705820083618
Epoch: 1, Steps: 8 | Train Loss: 2.135 Vali Loss: 1.977 Vali Acc: 0.309 Test Loss: 1.977 Test Acc: 0.309
Validation loss decreased (inf --> -0.309355).  Saving model ...
Epoch: 2 cost time: 3.064868211746216
Epoch: 2, Steps: 8 | Train Loss: 1.873 Vali Loss: 1.709 Vali Acc: 0.450 Test Loss: 1.709 Test Acc: 0.450
Validation loss decreased (-0.309355 --> -0.449983).  Saving model ...
Epoch: 3 cost time: 3.0173799991607666
Epoch: 3, Steps: 8 | Train Loss: 1.503 Vali Loss: 1.443 Vali Acc: 0.478 Test Loss: 1.443 Test Acc: 0.478
Validation loss decreased (-0.449983 --> -0.478111).  Saving model ...
Epoch: 4 cost time: 2.8034074306488037
Epoch: 4, Steps: 8 | Train Loss: 1.113 Vali Loss: 1.235 Vali Acc: 0.591 Test Loss: 1.235 Test Acc: 0.591
Validation loss decreased (-0.478111 --> -0.590613).  Saving model ...
Epoch: 5 cost time: 2.656777858734131
Epoch: 5, Steps: 8 | Train Loss: 0.827 Vali Loss: 1.142 Vali Acc: 0.591 Test Loss: 1.142 Test Acc: 0.591
Validation loss decreased (-0.590613 --> -0.590614).  Saving model ...
Epoch: 6 cost time: 2.602396249771118
Epoch: 6, Steps: 8 | Train Loss: 0.574 Vali Loss: 1.082 Vali Acc: 0.597 Test Loss: 1.082 Test Acc: 0.597
Validation loss decreased (-0.590614 --> -0.596864).  Saving model ...
Epoch: 7 cost time: 2.5777368545532227
Epoch: 7, Steps: 8 | Train Loss: 0.431 Vali Loss: 1.034 Vali Acc: 0.641 Test Loss: 1.034 Test Acc: 0.641
Validation loss decreased (-0.596864 --> -0.640615).  Saving model ...
Epoch: 8 cost time: 2.527935743331909
Epoch: 8, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.970 Vali Acc: 0.656 Test Loss: 0.970 Test Acc: 0.656
Validation loss decreased (-0.640615 --> -0.656240).  Saving model ...
Epoch: 9 cost time: 2.735046625137329
Epoch: 9, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.020 Vali Acc: 0.644 Test Loss: 1.020 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8555009365081787
Epoch: 10, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.007 Vali Acc: 0.656 Test Loss: 1.007 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.973874807357788
Epoch: 11, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.050 Vali Acc: 0.656 Test Loss: 1.050 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.86403489112854
Epoch: 12, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.087 Vali Acc: 0.659 Test Loss: 1.087 Test Acc: 0.659
Validation loss decreased (-0.656240 --> -0.659364).  Saving model ...
Epoch: 13 cost time: 2.8951144218444824
Epoch: 13, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.100 Vali Acc: 0.669 Test Loss: 1.100 Test Acc: 0.669
Validation loss decreased (-0.659364 --> -0.668739).  Saving model ...
Epoch: 14 cost time: 3.0240657329559326
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.079 Vali Acc: 0.669 Test Loss: 1.079 Test Acc: 0.669
Validation loss decreased (-0.668739 --> -0.668739).  Saving model ...
Epoch: 15 cost time: 2.745242118835449
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.121 Vali Acc: 0.666 Test Loss: 1.121 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6636691093444824
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.150 Vali Acc: 0.666 Test Loss: 1.150 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.77803373336792
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.131 Vali Acc: 0.659 Test Loss: 1.131 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8327083587646484
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.126 Vali Acc: 0.672 Test Loss: 1.126 Test Acc: 0.672
Validation loss decreased (-0.668739 --> -0.671864).  Saving model ...
Epoch: 19 cost time: 3.05973482131958
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.130 Vali Acc: 0.675 Test Loss: 1.130 Test Acc: 0.675
Validation loss decreased (-0.671864 --> -0.674989).  Saving model ...
Epoch: 20 cost time: 2.800553560256958
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.138 Vali Acc: 0.675 Test Loss: 1.138 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8159680366516113
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.159 Vali Acc: 0.675 Test Loss: 1.159 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.687427282333374
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.177 Vali Acc: 0.681 Test Loss: 1.177 Test Acc: 0.681
Validation loss decreased (-0.674989 --> -0.681238).  Saving model ...
Epoch: 23 cost time: 2.710557699203491
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.175 Vali Acc: 0.678 Test Loss: 1.175 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.488136053085327
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.159 Vali Acc: 0.684 Test Loss: 1.159 Test Acc: 0.684
Validation loss decreased (-0.681238 --> -0.684363).  Saving model ...
Epoch: 25 cost time: 2.593360185623169
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.158 Vali Acc: 0.688 Test Loss: 1.158 Test Acc: 0.688
Validation loss decreased (-0.684363 --> -0.687488).  Saving model ...
Epoch: 26 cost time: 2.535033702850342
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.163 Vali Acc: 0.691 Test Loss: 1.163 Test Acc: 0.691
Validation loss decreased (-0.687488 --> -0.690613).  Saving model ...
Epoch: 27 cost time: 2.5132694244384766
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.183 Vali Acc: 0.691 Test Loss: 1.183 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.7812275886535645
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.194 Vali Acc: 0.691 Test Loss: 1.194 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8885555267333984
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.193 Vali Acc: 0.694 Test Loss: 1.193 Test Acc: 0.694
Validation loss decreased (-0.690613 --> -0.693738).  Saving model ...
Epoch: 30 cost time: 2.8763434886932373
Epoch: 30, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.179 Vali Acc: 0.691 Test Loss: 1.179 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.9419825077056885
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.177 Vali Acc: 0.691 Test Loss: 1.177 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.9843034744262695
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.189 Vali Acc: 0.694 Test Loss: 1.189 Test Acc: 0.694
Validation loss decreased (-0.693738 --> -0.693738).  Saving model ...
Epoch: 33 cost time: 2.81255841255188
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.193 Vali Acc: 0.697 Test Loss: 1.193 Test Acc: 0.697
Validation loss decreased (-0.693738 --> -0.696863).  Saving model ...
Epoch: 34 cost time: 2.9746787548065186
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.189 Vali Acc: 0.700 Test Loss: 1.189 Test Acc: 0.700
Validation loss decreased (-0.696863 --> -0.699988).  Saving model ...
Epoch: 35 cost time: 2.893411159515381
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.198 Vali Acc: 0.697 Test Loss: 1.198 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.0661256313323975
Epoch: 36, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.204 Vali Acc: 0.694 Test Loss: 1.204 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.927874803543091
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.201 Vali Acc: 0.688 Test Loss: 1.201 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.1463623046875
Epoch: 38, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.199 Vali Acc: 0.700 Test Loss: 1.199 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.8506479263305664
Epoch: 39, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.200 Vali Acc: 0.703 Test Loss: 1.200 Test Acc: 0.703
Validation loss decreased (-0.699988 --> -0.703113).  Saving model ...
Epoch: 40 cost time: 2.8696155548095703
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.197 Vali Acc: 0.700 Test Loss: 1.197 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.9926745891571045
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.200 Vali Acc: 0.703 Test Loss: 1.200 Test Acc: 0.703
Validation loss decreased (-0.703113 --> -0.703113).  Saving model ...
Epoch: 42 cost time: 2.9870662689208984
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.205 Vali Acc: 0.694 Test Loss: 1.205 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.618654489517212
Epoch: 43, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.209 Vali Acc: 0.706 Test Loss: 1.209 Test Acc: 0.706
Validation loss decreased (-0.703113 --> -0.706238).  Saving model ...
Epoch: 44 cost time: 2.588791608810425
Epoch: 44, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.216 Vali Acc: 0.706 Test Loss: 1.216 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.6360108852386475
Epoch: 45, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.214 Vali Acc: 0.703 Test Loss: 1.214 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.9400012493133545
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.213 Vali Acc: 0.706 Test Loss: 1.213 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.780109405517578
Epoch: 47, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.210 Vali Acc: 0.709 Test Loss: 1.210 Test Acc: 0.709
Validation loss decreased (-0.706238 --> -0.709363).  Saving model ...
Epoch: 48 cost time: 2.7871172428131104
Epoch: 48, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.211 Vali Acc: 0.709 Test Loss: 1.211 Test Acc: 0.709
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.9437623023986816
Epoch: 49, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.216 Vali Acc: 0.709 Test Loss: 1.216 Test Acc: 0.709
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.9244446754455566
Epoch: 50, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.220 Vali Acc: 0.703 Test Loss: 1.220 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.0653793811798096
Epoch: 51, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.223 Vali Acc: 0.703 Test Loss: 1.223 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.646576166152954
Epoch: 52, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.222 Vali Acc: 0.709 Test Loss: 1.222 Test Acc: 0.709
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.5928690433502197
Epoch: 53, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.229 Vali Acc: 0.706 Test Loss: 1.229 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 2.5858607292175293
Epoch: 54, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.239 Vali Acc: 0.700 Test Loss: 1.239 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 2.6701858043670654
Epoch: 55, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.247 Vali Acc: 0.700 Test Loss: 1.247 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 2.7749099731445312
Epoch: 56, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.248 Vali Acc: 0.703 Test Loss: 1.248 Test Acc: 0.703
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.735177755355835
Epoch: 57, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.238 Vali Acc: 0.700 Test Loss: 1.238 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.709375
model parameter : 427144
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.940043926239014
Epoch: 1, Steps: 8 | Train Loss: 2.132 Vali Loss: 2.012 Vali Acc: 0.241 Test Loss: 2.012 Test Acc: 0.241
Validation loss decreased (inf --> -0.240605).  Saving model ...
Epoch: 2 cost time: 3.1164536476135254
Epoch: 2, Steps: 8 | Train Loss: 1.974 Vali Loss: 1.839 Vali Acc: 0.341 Test Loss: 1.839 Test Acc: 0.341
Validation loss decreased (-0.240605 --> -0.340607).  Saving model ...
Epoch: 3 cost time: 3.2112557888031006
Epoch: 3, Steps: 8 | Train Loss: 1.693 Vali Loss: 1.623 Vali Acc: 0.444 Test Loss: 1.623 Test Acc: 0.444
Validation loss decreased (-0.340607 --> -0.443734).  Saving model ...
Epoch: 4 cost time: 2.9998016357421875
Epoch: 4, Steps: 8 | Train Loss: 1.375 Vali Loss: 1.442 Vali Acc: 0.547 Test Loss: 1.442 Test Acc: 0.547
Validation loss decreased (-0.443734 --> -0.546861).  Saving model ...
Epoch: 5 cost time: 2.957460880279541
Epoch: 5, Steps: 8 | Train Loss: 1.083 Vali Loss: 1.298 Vali Acc: 0.559 Test Loss: 1.298 Test Acc: 0.559
Validation loss decreased (-0.546861 --> -0.559362).  Saving model ...
Epoch: 6 cost time: 2.8448028564453125
Epoch: 6, Steps: 8 | Train Loss: 0.821 Vali Loss: 1.241 Vali Acc: 0.547 Test Loss: 1.241 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8290371894836426
Epoch: 7, Steps: 8 | Train Loss: 0.629 Vali Loss: 1.141 Vali Acc: 0.603 Test Loss: 1.141 Test Acc: 0.603
Validation loss decreased (-0.559362 --> -0.603114).  Saving model ...
Epoch: 8 cost time: 3.030534267425537
Epoch: 8, Steps: 8 | Train Loss: 0.489 Vali Loss: 1.078 Vali Acc: 0.609 Test Loss: 1.078 Test Acc: 0.609
Validation loss decreased (-0.603114 --> -0.609364).  Saving model ...
Epoch: 9 cost time: 2.9133806228637695
Epoch: 9, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.134 Vali Acc: 0.609 Test Loss: 1.134 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1290760040283203
Epoch: 10, Steps: 8 | Train Loss: 0.302 Vali Loss: 1.019 Vali Acc: 0.637 Test Loss: 1.019 Test Acc: 0.637
Validation loss decreased (-0.609364 --> -0.637490).  Saving model ...
Epoch: 11 cost time: 2.846611976623535
Epoch: 11, Steps: 8 | Train Loss: 0.187 Vali Loss: 1.043 Vali Acc: 0.659 Test Loss: 1.043 Test Acc: 0.659
Validation loss decreased (-0.637490 --> -0.659365).  Saving model ...
Epoch: 12 cost time: 2.8944904804229736
Epoch: 12, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.043 Vali Acc: 0.634 Test Loss: 1.043 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5612783432006836
Epoch: 13, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.076 Vali Acc: 0.631 Test Loss: 1.076 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0175235271453857
Epoch: 14, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.076 Vali Acc: 0.650 Test Loss: 1.076 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.908674478530884
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.170 Vali Acc: 0.616 Test Loss: 1.170 Test Acc: 0.616
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.1335959434509277
Epoch: 16, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.153 Vali Acc: 0.619 Test Loss: 1.153 Test Acc: 0.619
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.2825257778167725
Epoch: 17, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.106 Vali Acc: 0.634 Test Loss: 1.106 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.1203577518463135
Epoch: 18, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.168 Vali Acc: 0.619 Test Loss: 1.168 Test Acc: 0.619
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.201216697692871
Epoch: 19, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.168 Vali Acc: 0.644 Test Loss: 1.168 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.5245773792266846
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.172 Vali Acc: 0.653 Test Loss: 1.172 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.717754364013672
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.170 Vali Acc: 0.644 Test Loss: 1.170 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.659375
model parameter : 427144
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.3634912967681885
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 2.102 Vali Acc: 0.116 Test Loss: 2.102 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 2.7649643421173096
Epoch: 2, Steps: 8 | Train Loss: 2.023 Vali Loss: 2.005 Vali Acc: 0.225 Test Loss: 2.005 Test Acc: 0.225
Validation loss decreased (-0.115604 --> -0.224980).  Saving model ...
Epoch: 3 cost time: 2.7490854263305664
Epoch: 3, Steps: 8 | Train Loss: 1.847 Vali Loss: 1.873 Vali Acc: 0.319 Test Loss: 1.873 Test Acc: 0.319
Validation loss decreased (-0.224980 --> -0.318731).  Saving model ...
Epoch: 4 cost time: 2.6592447757720947
Epoch: 4, Steps: 8 | Train Loss: 1.621 Vali Loss: 1.742 Vali Acc: 0.406 Test Loss: 1.742 Test Acc: 0.406
Validation loss decreased (-0.318731 --> -0.406233).  Saving model ...
Epoch: 5 cost time: 2.906597375869751
Epoch: 5, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.632 Vali Acc: 0.409 Test Loss: 1.632 Test Acc: 0.409
Validation loss decreased (-0.406233 --> -0.409359).  Saving model ...
Epoch: 6 cost time: 3.0015716552734375
Epoch: 6, Steps: 8 | Train Loss: 1.083 Vali Loss: 1.601 Vali Acc: 0.406 Test Loss: 1.601 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.048224449157715
Epoch: 7, Steps: 8 | Train Loss: 0.900 Vali Loss: 1.499 Vali Acc: 0.450 Test Loss: 1.499 Test Acc: 0.450
Validation loss decreased (-0.409359 --> -0.449985).  Saving model ...
Epoch: 8 cost time: 2.8670482635498047
Epoch: 8, Steps: 8 | Train Loss: 0.729 Vali Loss: 1.444 Vali Acc: 0.425 Test Loss: 1.444 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6769797801971436
Epoch: 9, Steps: 8 | Train Loss: 0.600 Vali Loss: 1.523 Vali Acc: 0.444 Test Loss: 1.523 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.810802936553955
Epoch: 10, Steps: 8 | Train Loss: 0.503 Vali Loss: 1.495 Vali Acc: 0.431 Test Loss: 1.495 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.86427640914917
Epoch: 11, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.441 Vali Acc: 0.466 Test Loss: 1.441 Test Acc: 0.466
Validation loss decreased (-0.449985 --> -0.465611).  Saving model ...
Epoch: 12 cost time: 2.6265828609466553
Epoch: 12, Steps: 8 | Train Loss: 0.329 Vali Loss: 1.424 Vali Acc: 0.491 Test Loss: 1.424 Test Acc: 0.491
Validation loss decreased (-0.465611 --> -0.490611).  Saving model ...
Epoch: 13 cost time: 2.9964704513549805
Epoch: 13, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.540 Vali Acc: 0.444 Test Loss: 1.540 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9152462482452393
Epoch: 14, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.524 Vali Acc: 0.484 Test Loss: 1.524 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0568180084228516
Epoch: 15, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.639 Vali Acc: 0.444 Test Loss: 1.639 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.0256330966949463
Epoch: 16, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.545 Vali Acc: 0.478 Test Loss: 1.545 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6768295764923096
Epoch: 17, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.579 Vali Acc: 0.475 Test Loss: 1.579 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.8562915325164795
Epoch: 18, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.547 Vali Acc: 0.484 Test Loss: 1.547 Test Acc: 0.484
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.752370595932007
Epoch: 19, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.658 Vali Acc: 0.438 Test Loss: 1.658 Test Acc: 0.438
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.796884298324585
Epoch: 20, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.651 Vali Acc: 0.478 Test Loss: 1.651 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.742213249206543
Epoch: 21, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.758 Vali Acc: 0.463 Test Loss: 1.758 Test Acc: 0.463
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.8090288639068604
Epoch: 22, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.597 Vali Acc: 0.512 Test Loss: 1.597 Test Acc: 0.512
Validation loss decreased (-0.490611 --> -0.512484).  Saving model ...
Epoch: 23 cost time: 2.943786859512329
Epoch: 23, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.620 Vali Acc: 0.500 Test Loss: 1.620 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1155242919921875
Epoch: 24, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.745 Vali Acc: 0.466 Test Loss: 1.745 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.9609923362731934
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.515 Vali Acc: 0.544 Test Loss: 1.515 Test Acc: 0.544
Validation loss decreased (-0.512484 --> -0.543735).  Saving model ...
Epoch: 26 cost time: 2.901142120361328
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.605 Vali Acc: 0.500 Test Loss: 1.605 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.649481773376465
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.578 Vali Acc: 0.531 Test Loss: 1.578 Test Acc: 0.531
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.915544033050537
Epoch: 28, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.765 Vali Acc: 0.487 Test Loss: 1.765 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.7925758361816406
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.670 Vali Acc: 0.500 Test Loss: 1.670 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.6995623111724854
Epoch: 30, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.566 Vali Acc: 0.534 Test Loss: 1.566 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.686947822570801
Epoch: 31, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.686 Vali Acc: 0.512 Test Loss: 1.686 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.7940850257873535
Epoch: 32, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.699 Vali Acc: 0.506 Test Loss: 1.699 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.8042244911193848
Epoch: 33, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.633 Vali Acc: 0.522 Test Loss: 1.633 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.807607412338257
Epoch: 34, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.598 Vali Acc: 0.531 Test Loss: 1.598 Test Acc: 0.531
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.9462761878967285
Epoch: 35, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.611 Vali Acc: 0.519 Test Loss: 1.611 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.54375
model parameter : 427144
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.818930149078369
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 2.074 Vali Acc: 0.178 Test Loss: 2.074 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 3.1749253273010254
Epoch: 2, Steps: 8 | Train Loss: 2.023 Vali Loss: 2.022 Vali Acc: 0.191 Test Loss: 2.022 Test Acc: 0.191
Validation loss decreased (-0.178104 --> -0.190605).  Saving model ...
Epoch: 3 cost time: 3.068272829055786
Epoch: 3, Steps: 8 | Train Loss: 1.914 Vali Loss: 1.944 Vali Acc: 0.287 Test Loss: 1.944 Test Acc: 0.287
Validation loss decreased (-0.190605 --> -0.287481).  Saving model ...
Epoch: 4 cost time: 2.8457181453704834
Epoch: 4, Steps: 8 | Train Loss: 1.738 Vali Loss: 1.884 Vali Acc: 0.338 Test Loss: 1.884 Test Acc: 0.338
Validation loss decreased (-0.287481 --> -0.337481).  Saving model ...
Epoch: 5 cost time: 2.7352466583251953
Epoch: 5, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.803 Vali Acc: 0.303 Test Loss: 1.803 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9179837703704834
Epoch: 6, Steps: 8 | Train Loss: 1.242 Vali Loss: 1.801 Vali Acc: 0.319 Test Loss: 1.801 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.093871831893921
Epoch: 7, Steps: 8 | Train Loss: 1.095 Vali Loss: 1.711 Vali Acc: 0.347 Test Loss: 1.711 Test Acc: 0.347
Validation loss decreased (-0.337481 --> -0.346858).  Saving model ...
Epoch: 8 cost time: 3.154762029647827
Epoch: 8, Steps: 8 | Train Loss: 0.890 Vali Loss: 1.619 Vali Acc: 0.375 Test Loss: 1.619 Test Acc: 0.375
Validation loss decreased (-0.346858 --> -0.374984).  Saving model ...
Epoch: 9 cost time: 3.3041789531707764
Epoch: 9, Steps: 8 | Train Loss: 0.742 Vali Loss: 1.701 Vali Acc: 0.400 Test Loss: 1.701 Test Acc: 0.400
Validation loss decreased (-0.374984 --> -0.399983).  Saving model ...
Epoch: 10 cost time: 3.3935821056365967
Epoch: 10, Steps: 8 | Train Loss: 0.628 Vali Loss: 1.629 Vali Acc: 0.347 Test Loss: 1.629 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1059489250183105
Epoch: 11, Steps: 8 | Train Loss: 0.467 Vali Loss: 1.571 Vali Acc: 0.366 Test Loss: 1.571 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8556225299835205
Epoch: 12, Steps: 8 | Train Loss: 0.414 Vali Loss: 1.511 Vali Acc: 0.422 Test Loss: 1.511 Test Acc: 0.422
Validation loss decreased (-0.399983 --> -0.421860).  Saving model ...
Epoch: 13 cost time: 2.9425148963928223
Epoch: 13, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.727 Vali Acc: 0.316 Test Loss: 1.727 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8971941471099854
Epoch: 14, Steps: 8 | Train Loss: 0.296 Vali Loss: 1.655 Vali Acc: 0.331 Test Loss: 1.655 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1617636680603027
Epoch: 15, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.771 Vali Acc: 0.322 Test Loss: 1.771 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.186875820159912
Epoch: 16, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.716 Vali Acc: 0.375 Test Loss: 1.716 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.393789529800415
Epoch: 17, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.734 Vali Acc: 0.347 Test Loss: 1.734 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.09612774848938
Epoch: 18, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.678 Vali Acc: 0.400 Test Loss: 1.678 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.905141830444336
Epoch: 19, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.798 Vali Acc: 0.394 Test Loss: 1.798 Test Acc: 0.394
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.2669217586517334
Epoch: 20, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.990 Vali Acc: 0.350 Test Loss: 1.990 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.0641896724700928
Epoch: 21, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.939 Vali Acc: 0.359 Test Loss: 1.939 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.8311283588409424
Epoch: 22, Steps: 8 | Train Loss: 0.057 Vali Loss: 2.031 Vali Acc: 0.359 Test Loss: 2.031 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.421875
model parameter : 427144
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.662285327911377
Epoch: 1, Steps: 8 | Train Loss: 2.132 Vali Loss: 2.106 Vali Acc: 0.128 Test Loss: 2.106 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 3.22041392326355
Epoch: 2, Steps: 8 | Train Loss: 2.054 Vali Loss: 2.070 Vali Acc: 0.197 Test Loss: 2.070 Test Acc: 0.197
Validation loss decreased (-0.128104 --> -0.196854).  Saving model ...
Epoch: 3 cost time: 3.118957281112671
Epoch: 3, Steps: 8 | Train Loss: 1.930 Vali Loss: 2.022 Vali Acc: 0.303 Test Loss: 2.022 Test Acc: 0.303
Validation loss decreased (-0.196854 --> -0.303105).  Saving model ...
Epoch: 4 cost time: 3.15480637550354
Epoch: 4, Steps: 8 | Train Loss: 1.771 Vali Loss: 1.959 Vali Acc: 0.316 Test Loss: 1.959 Test Acc: 0.316
Validation loss decreased (-0.303105 --> -0.315605).  Saving model ...
Epoch: 5 cost time: 3.013890504837036
Epoch: 5, Steps: 8 | Train Loss: 1.586 Vali Loss: 1.907 Vali Acc: 0.263 Test Loss: 1.907 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.943422555923462
Epoch: 6, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.874 Vali Acc: 0.328 Test Loss: 1.874 Test Acc: 0.328
Validation loss decreased (-0.315605 --> -0.328106).  Saving model ...
Epoch: 7 cost time: 3.304144859313965
Epoch: 7, Steps: 8 | Train Loss: 1.153 Vali Loss: 1.800 Vali Acc: 0.347 Test Loss: 1.800 Test Acc: 0.347
Validation loss decreased (-0.328106 --> -0.346857).  Saving model ...
Epoch: 8 cost time: 3.1076269149780273
Epoch: 8, Steps: 8 | Train Loss: 0.952 Vali Loss: 1.709 Vali Acc: 0.341 Test Loss: 1.709 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1581249237060547
Epoch: 9, Steps: 8 | Train Loss: 0.785 Vali Loss: 1.710 Vali Acc: 0.356 Test Loss: 1.710 Test Acc: 0.356
Validation loss decreased (-0.346857 --> -0.356233).  Saving model ...
Epoch: 10 cost time: 3.01237154006958
Epoch: 10, Steps: 8 | Train Loss: 0.668 Vali Loss: 1.665 Vali Acc: 0.319 Test Loss: 1.665 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.847973346710205
Epoch: 11, Steps: 8 | Train Loss: 0.502 Vali Loss: 1.573 Vali Acc: 0.353 Test Loss: 1.573 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8284285068511963
Epoch: 12, Steps: 8 | Train Loss: 0.449 Vali Loss: 1.521 Vali Acc: 0.344 Test Loss: 1.521 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1558659076690674
Epoch: 13, Steps: 8 | Train Loss: 0.360 Vali Loss: 1.579 Vali Acc: 0.341 Test Loss: 1.579 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.9517662525177
Epoch: 14, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.653 Vali Acc: 0.316 Test Loss: 1.653 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2071356773376465
Epoch: 15, Steps: 8 | Train Loss: 0.258 Vali Loss: 1.578 Vali Acc: 0.369 Test Loss: 1.578 Test Acc: 0.369
Validation loss decreased (-0.356233 --> -0.368734).  Saving model ...
Epoch: 16 cost time: 3.204231023788452
Epoch: 16, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.646 Vali Acc: 0.350 Test Loss: 1.646 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.894573450088501
Epoch: 17, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.644 Vali Acc: 0.366 Test Loss: 1.644 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9484355449676514
Epoch: 18, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.678 Vali Acc: 0.378 Test Loss: 1.678 Test Acc: 0.378
Validation loss decreased (-0.368734 --> -0.378108).  Saving model ...
Epoch: 19 cost time: 2.730577230453491
Epoch: 19, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.832 Vali Acc: 0.384 Test Loss: 1.832 Test Acc: 0.384
Validation loss decreased (-0.378108 --> -0.384357).  Saving model ...
Epoch: 20 cost time: 2.7142550945281982
Epoch: 20, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.781 Vali Acc: 0.356 Test Loss: 1.781 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.659090280532837
Epoch: 21, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.939 Vali Acc: 0.344 Test Loss: 1.939 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1065638065338135
Epoch: 22, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.903 Vali Acc: 0.384 Test Loss: 1.903 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.270514726638794
Epoch: 23, Steps: 8 | Train Loss: 0.056 Vali Loss: 2.003 Vali Acc: 0.359 Test Loss: 2.003 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.014378547668457
Epoch: 24, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.975 Vali Acc: 0.400 Test Loss: 1.975 Test Acc: 0.400
Validation loss decreased (-0.384357 --> -0.399980).  Saving model ...
Epoch: 25 cost time: 2.874091386795044
Epoch: 25, Steps: 8 | Train Loss: 0.036 Vali Loss: 2.174 Vali Acc: 0.366 Test Loss: 2.174 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.960017204284668
Epoch: 26, Steps: 8 | Train Loss: 0.036 Vali Loss: 2.080 Vali Acc: 0.416 Test Loss: 2.080 Test Acc: 0.416
Validation loss decreased (-0.399980 --> -0.415604).  Saving model ...
Epoch: 27 cost time: 3.207641124725342
Epoch: 27, Steps: 8 | Train Loss: 0.027 Vali Loss: 2.090 Vali Acc: 0.400 Test Loss: 2.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.798555850982666
Epoch: 28, Steps: 8 | Train Loss: 0.022 Vali Loss: 2.378 Vali Acc: 0.378 Test Loss: 2.378 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.7712647914886475
Epoch: 29, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.986 Vali Acc: 0.453 Test Loss: 1.986 Test Acc: 0.453
Validation loss decreased (-0.415604 --> -0.453105).  Saving model ...
Epoch: 30 cost time: 3.0394344329833984
Epoch: 30, Steps: 8 | Train Loss: 0.024 Vali Loss: 2.381 Vali Acc: 0.394 Test Loss: 2.381 Test Acc: 0.394
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.354581356048584
Epoch: 31, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.319 Vali Acc: 0.397 Test Loss: 2.319 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.9232280254364014
Epoch: 32, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.000 Vali Acc: 0.459 Test Loss: 2.000 Test Acc: 0.459
Validation loss decreased (-0.453105 --> -0.459355).  Saving model ...
Epoch: 33 cost time: 2.9254822731018066
Epoch: 33, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.222 Vali Acc: 0.444 Test Loss: 2.222 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.8169400691986084
Epoch: 34, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.914 Vali Acc: 0.472 Test Loss: 1.914 Test Acc: 0.472
Validation loss decreased (-0.459355 --> -0.471856).  Saving model ...
Epoch: 35 cost time: 3.309542655944824
Epoch: 35, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.163 Vali Acc: 0.412 Test Loss: 2.163 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.055865526199341
Epoch: 36, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.614 Vali Acc: 0.366 Test Loss: 2.614 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.360351800918579
Epoch: 37, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.349 Vali Acc: 0.388 Test Loss: 2.349 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.223598003387451
Epoch: 38, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.108 Vali Acc: 0.450 Test Loss: 2.108 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.123805046081543
Epoch: 39, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.416 Vali Acc: 0.391 Test Loss: 2.416 Test Acc: 0.391
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.0226874351501465
Epoch: 40, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.449 Vali Acc: 0.394 Test Loss: 2.449 Test Acc: 0.394
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.2221100330352783
Epoch: 41, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.321 Vali Acc: 0.409 Test Loss: 2.321 Test Acc: 0.409
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.0802087783813477
Epoch: 42, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.135 Vali Acc: 0.456 Test Loss: 2.135 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.0299570560455322
Epoch: 43, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.433 Vali Acc: 0.431 Test Loss: 2.433 Test Acc: 0.431
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.023634195327759
Epoch: 44, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.298 Vali Acc: 0.466 Test Loss: 2.298 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.471875
model parameter : 427144
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.322601795196533
Epoch: 1, Steps: 8 | Train Loss: 2.148 Vali Loss: 2.121 Vali Acc: 0.125 Test Loss: 2.121 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 2.84969425201416
Epoch: 2, Steps: 8 | Train Loss: 2.071 Vali Loss: 2.080 Vali Acc: 0.222 Test Loss: 2.080 Test Acc: 0.222
Validation loss decreased (-0.124979 --> -0.221854).  Saving model ...
Epoch: 3 cost time: 3.037797689437866
Epoch: 3, Steps: 8 | Train Loss: 1.917 Vali Loss: 2.042 Vali Acc: 0.278 Test Loss: 2.042 Test Acc: 0.278
Validation loss decreased (-0.221854 --> -0.278105).  Saving model ...
Epoch: 4 cost time: 2.8364405632019043
Epoch: 4, Steps: 8 | Train Loss: 1.755 Vali Loss: 1.980 Vali Acc: 0.281 Test Loss: 1.980 Test Acc: 0.281
Validation loss decreased (-0.278105 --> -0.281230).  Saving model ...
Epoch: 5 cost time: 3.0573365688323975
Epoch: 5, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.930 Vali Acc: 0.209 Test Loss: 1.930 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7735488414764404
Epoch: 6, Steps: 8 | Train Loss: 1.237 Vali Loss: 1.901 Vali Acc: 0.331 Test Loss: 1.901 Test Acc: 0.331
Validation loss decreased (-0.281230 --> -0.331231).  Saving model ...
Epoch: 7 cost time: 3.2007694244384766
Epoch: 7, Steps: 8 | Train Loss: 1.110 Vali Loss: 1.848 Vali Acc: 0.356 Test Loss: 1.848 Test Acc: 0.356
Validation loss decreased (-0.331231 --> -0.356232).  Saving model ...
Epoch: 8 cost time: 3.3082361221313477
Epoch: 8, Steps: 8 | Train Loss: 0.879 Vali Loss: 1.720 Vali Acc: 0.344 Test Loss: 1.720 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0799334049224854
Epoch: 9, Steps: 8 | Train Loss: 0.726 Vali Loss: 1.688 Vali Acc: 0.366 Test Loss: 1.688 Test Acc: 0.366
Validation loss decreased (-0.356232 --> -0.365608).  Saving model ...
Epoch: 10 cost time: 3.2107462882995605
Epoch: 10, Steps: 8 | Train Loss: 0.633 Vali Loss: 1.654 Vali Acc: 0.341 Test Loss: 1.654 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7975926399230957
Epoch: 11, Steps: 8 | Train Loss: 0.466 Vali Loss: 1.595 Vali Acc: 0.303 Test Loss: 1.595 Test Acc: 0.303
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.619809150695801
Epoch: 12, Steps: 8 | Train Loss: 0.424 Vali Loss: 1.514 Vali Acc: 0.350 Test Loss: 1.514 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7504723072052
Epoch: 13, Steps: 8 | Train Loss: 0.355 Vali Loss: 1.549 Vali Acc: 0.338 Test Loss: 1.549 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8263392448425293
Epoch: 14, Steps: 8 | Train Loss: 0.312 Vali Loss: 1.633 Vali Acc: 0.338 Test Loss: 1.633 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.128384590148926
Epoch: 15, Steps: 8 | Train Loss: 0.248 Vali Loss: 1.544 Vali Acc: 0.403 Test Loss: 1.544 Test Acc: 0.403
Validation loss decreased (-0.365608 --> -0.403110).  Saving model ...
Epoch: 16 cost time: 3.0282063484191895
Epoch: 16, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.586 Vali Acc: 0.388 Test Loss: 1.586 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3118858337402344
Epoch: 17, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.647 Vali Acc: 0.394 Test Loss: 1.647 Test Acc: 0.394
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0436391830444336
Epoch: 18, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.632 Vali Acc: 0.412 Test Loss: 1.632 Test Acc: 0.412
Validation loss decreased (-0.403110 --> -0.412484).  Saving model ...
Epoch: 19 cost time: 2.9500746726989746
Epoch: 19, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.588 Vali Acc: 0.441 Test Loss: 1.588 Test Acc: 0.441
Validation loss decreased (-0.412484 --> -0.440609).  Saving model ...
Epoch: 20 cost time: 2.867108106613159
Epoch: 20, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.831 Vali Acc: 0.366 Test Loss: 1.831 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4545655250549316
Epoch: 21, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.751 Vali Acc: 0.409 Test Loss: 1.751 Test Acc: 0.409
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.112570285797119
Epoch: 22, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.793 Vali Acc: 0.422 Test Loss: 1.793 Test Acc: 0.422
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.107287883758545
Epoch: 23, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.754 Vali Acc: 0.434 Test Loss: 1.754 Test Acc: 0.434
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.0031914710998535
Epoch: 24, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.750 Vali Acc: 0.453 Test Loss: 1.750 Test Acc: 0.453
Validation loss decreased (-0.440609 --> -0.453108).  Saving model ...
Epoch: 25 cost time: 3.0654666423797607
Epoch: 25, Steps: 8 | Train Loss: 0.050 Vali Loss: 2.030 Vali Acc: 0.372 Test Loss: 2.030 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9252982139587402
Epoch: 26, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.856 Vali Acc: 0.431 Test Loss: 1.856 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.9592201709747314
Epoch: 27, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.749 Vali Acc: 0.450 Test Loss: 1.749 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.8691725730895996
Epoch: 28, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.977 Vali Acc: 0.431 Test Loss: 1.977 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.8897175788879395
Epoch: 29, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.809 Vali Acc: 0.466 Test Loss: 1.809 Test Acc: 0.466
Validation loss decreased (-0.453108 --> -0.465607).  Saving model ...
Epoch: 30 cost time: 2.945718765258789
Epoch: 30, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.818 Vali Acc: 0.472 Test Loss: 1.818 Test Acc: 0.472
Validation loss decreased (-0.465607 --> -0.471857).  Saving model ...
Epoch: 31 cost time: 3.2383573055267334
Epoch: 31, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.033 Vali Acc: 0.459 Test Loss: 2.033 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.1646809577941895
Epoch: 32, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.834 Vali Acc: 0.472 Test Loss: 1.834 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.9949121475219727
Epoch: 33, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.762 Vali Acc: 0.500 Test Loss: 1.762 Test Acc: 0.500
Validation loss decreased (-0.471857 --> -0.499982).  Saving model ...
Epoch: 34 cost time: 2.977979898452759
Epoch: 34, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.808 Vali Acc: 0.491 Test Loss: 1.808 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.1640281677246094
Epoch: 35, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.917 Vali Acc: 0.478 Test Loss: 1.917 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.860208511352539
Epoch: 36, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.054 Vali Acc: 0.447 Test Loss: 2.054 Test Acc: 0.447
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.608152389526367
Epoch: 37, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.946 Vali Acc: 0.469 Test Loss: 1.946 Test Acc: 0.469
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.616163492202759
Epoch: 38, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.835 Vali Acc: 0.491 Test Loss: 1.835 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.9260995388031006
Epoch: 39, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.942 Vali Acc: 0.472 Test Loss: 1.942 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.0356671810150146
Epoch: 40, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.010 Vali Acc: 0.459 Test Loss: 2.010 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.0460221767425537
Epoch: 41, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.040 Vali Acc: 0.463 Test Loss: 2.040 Test Acc: 0.463
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.895737409591675
Epoch: 42, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.892 Vali Acc: 0.484 Test Loss: 1.892 Test Acc: 0.484
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.819786310195923
Epoch: 43, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.939 Vali Acc: 0.484 Test Loss: 1.939 Test Acc: 0.484
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5
model parameter : 427144
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.507797956466675
Epoch: 1, Steps: 8 | Train Loss: 2.103 Vali Loss: 2.078 Vali Acc: 0.219 Test Loss: 2.078 Test Acc: 0.219
Validation loss decreased (inf --> -0.218729).  Saving model ...
Epoch: 2 cost time: 3.009139060974121
Epoch: 2, Steps: 8 | Train Loss: 2.070 Vali Loss: 2.046 Vali Acc: 0.241 Test Loss: 2.046 Test Acc: 0.241
Validation loss decreased (-0.218729 --> -0.240605).  Saving model ...
Epoch: 3 cost time: 3.024155378341675
Epoch: 3, Steps: 8 | Train Loss: 1.990 Vali Loss: 1.995 Vali Acc: 0.250 Test Loss: 1.995 Test Acc: 0.250
Validation loss decreased (-0.240605 --> -0.249980).  Saving model ...
Epoch: 4 cost time: 2.941331148147583
Epoch: 4, Steps: 8 | Train Loss: 1.792 Vali Loss: 1.933 Vali Acc: 0.250 Test Loss: 1.933 Test Acc: 0.250
Validation loss decreased (-0.249980 --> -0.249981).  Saving model ...
Epoch: 5 cost time: 3.073483467102051
Epoch: 5, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.837 Vali Acc: 0.397 Test Loss: 1.837 Test Acc: 0.397
Validation loss decreased (-0.249981 --> -0.396857).  Saving model ...
Epoch: 6 cost time: 2.7734880447387695
Epoch: 6, Steps: 8 | Train Loss: 1.361 Vali Loss: 1.767 Vali Acc: 0.416 Test Loss: 1.767 Test Acc: 0.416
Validation loss decreased (-0.396857 --> -0.415607).  Saving model ...
Epoch: 7 cost time: 2.8593177795410156
Epoch: 7, Steps: 8 | Train Loss: 1.148 Vali Loss: 1.683 Vali Acc: 0.406 Test Loss: 1.683 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8430709838867188
Epoch: 8, Steps: 8 | Train Loss: 0.930 Vali Loss: 1.546 Vali Acc: 0.497 Test Loss: 1.546 Test Acc: 0.497
Validation loss decreased (-0.415607 --> -0.496860).  Saving model ...
Epoch: 9 cost time: 2.866095781326294
Epoch: 9, Steps: 8 | Train Loss: 0.807 Vali Loss: 1.496 Vali Acc: 0.472 Test Loss: 1.496 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.688298225402832
Epoch: 10, Steps: 8 | Train Loss: 0.672 Vali Loss: 1.420 Vali Acc: 0.497 Test Loss: 1.420 Test Acc: 0.497
Validation loss decreased (-0.496860 --> -0.496861).  Saving model ...
Epoch: 11 cost time: 2.8315887451171875
Epoch: 11, Steps: 8 | Train Loss: 0.520 Vali Loss: 1.401 Vali Acc: 0.463 Test Loss: 1.401 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.733092784881592
Epoch: 12, Steps: 8 | Train Loss: 0.473 Vali Loss: 1.365 Vali Acc: 0.484 Test Loss: 1.365 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.119077444076538
Epoch: 13, Steps: 8 | Train Loss: 0.391 Vali Loss: 1.455 Vali Acc: 0.406 Test Loss: 1.455 Test Acc: 0.406
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1918280124664307
Epoch: 14, Steps: 8 | Train Loss: 0.342 Vali Loss: 1.518 Vali Acc: 0.438 Test Loss: 1.518 Test Acc: 0.438
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.2373619079589844
Epoch: 15, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.475 Vali Acc: 0.466 Test Loss: 1.475 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.0242254734039307
Epoch: 16, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.539 Vali Acc: 0.463 Test Loss: 1.539 Test Acc: 0.463
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.006765842437744
Epoch: 17, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.633 Vali Acc: 0.469 Test Loss: 1.633 Test Acc: 0.469
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.892080545425415
Epoch: 18, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.733 Vali Acc: 0.456 Test Loss: 1.733 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.7374303340911865
Epoch: 19, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.648 Vali Acc: 0.466 Test Loss: 1.648 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.1012938022613525
Epoch: 20, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.852 Vali Acc: 0.441 Test Loss: 1.852 Test Acc: 0.441
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.496875
model parameter : 427144
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.4848010540008545
Epoch: 1, Steps: 8 | Train Loss: 2.157 Vali Loss: 2.122 Vali Acc: 0.147 Test Loss: 2.122 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 2.7046360969543457
Epoch: 2, Steps: 8 | Train Loss: 2.135 Vali Loss: 2.078 Vali Acc: 0.147 Test Loss: 2.078 Test Acc: 0.147
Validation loss decreased (-0.146854 --> -0.146854).  Saving model ...
Epoch: 3 cost time: 2.791290521621704
Epoch: 3, Steps: 8 | Train Loss: 1.972 Vali Loss: 2.031 Vali Acc: 0.178 Test Loss: 2.031 Test Acc: 0.178
Validation loss decreased (-0.146854 --> -0.178105).  Saving model ...
Epoch: 4 cost time: 2.7120351791381836
Epoch: 4, Steps: 8 | Train Loss: 1.818 Vali Loss: 1.978 Vali Acc: 0.166 Test Loss: 1.978 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8198401927948
Epoch: 5, Steps: 8 | Train Loss: 1.668 Vali Loss: 1.907 Vali Acc: 0.263 Test Loss: 1.907 Test Acc: 0.263
Validation loss decreased (-0.178105 --> -0.262481).  Saving model ...
Epoch: 6 cost time: 2.974628210067749
Epoch: 6, Steps: 8 | Train Loss: 1.423 Vali Loss: 1.821 Vali Acc: 0.381 Test Loss: 1.821 Test Acc: 0.381
Validation loss decreased (-0.262481 --> -0.381232).  Saving model ...
Epoch: 7 cost time: 2.9310779571533203
Epoch: 7, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.734 Vali Acc: 0.425 Test Loss: 1.734 Test Acc: 0.425
Validation loss decreased (-0.381232 --> -0.424983).  Saving model ...
Epoch: 8 cost time: 3.211171865463257
Epoch: 8, Steps: 8 | Train Loss: 1.048 Vali Loss: 1.668 Vali Acc: 0.362 Test Loss: 1.668 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0875473022460938
Epoch: 9, Steps: 8 | Train Loss: 0.934 Vali Loss: 1.609 Vali Acc: 0.353 Test Loss: 1.609 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.73721981048584
Epoch: 10, Steps: 8 | Train Loss: 0.777 Vali Loss: 1.549 Vali Acc: 0.397 Test Loss: 1.549 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.653563976287842
Epoch: 11, Steps: 8 | Train Loss: 0.670 Vali Loss: 1.534 Vali Acc: 0.400 Test Loss: 1.534 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.582108736038208
Epoch: 12, Steps: 8 | Train Loss: 0.596 Vali Loss: 1.539 Vali Acc: 0.384 Test Loss: 1.539 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.652674436569214
Epoch: 13, Steps: 8 | Train Loss: 0.482 Vali Loss: 1.443 Vali Acc: 0.416 Test Loss: 1.443 Test Acc: 0.416
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.0188708305358887
Epoch: 14, Steps: 8 | Train Loss: 0.418 Vali Loss: 1.490 Vali Acc: 0.419 Test Loss: 1.490 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.907191514968872
Epoch: 15, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.498 Vali Acc: 0.416 Test Loss: 1.498 Test Acc: 0.416
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.86423659324646
Epoch: 16, Steps: 8 | Train Loss: 0.321 Vali Loss: 1.530 Vali Acc: 0.419 Test Loss: 1.530 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.704235553741455
Epoch: 17, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.575 Vali Acc: 0.422 Test Loss: 1.575 Test Acc: 0.422
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.425
model parameter : 427144
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.612282037734985
Epoch: 1, Steps: 8 | Train Loss: 2.100 Vali Loss: 1.899 Vali Acc: 0.319 Test Loss: 1.899 Test Acc: 0.319
Validation loss decreased (inf --> -0.318731).  Saving model ...
Epoch: 2 cost time: 3.342334032058716
Epoch: 2, Steps: 8 | Train Loss: 1.686 Vali Loss: 1.428 Vali Acc: 0.647 Test Loss: 1.428 Test Acc: 0.647
Validation loss decreased (-0.318731 --> -0.646861).  Saving model ...
Epoch: 3 cost time: 3.0770514011383057
Epoch: 3, Steps: 8 | Train Loss: 1.207 Vali Loss: 1.070 Vali Acc: 0.719 Test Loss: 1.070 Test Acc: 0.719
Validation loss decreased (-0.646861 --> -0.718739).  Saving model ...
Epoch: 4 cost time: 3.2143876552581787
Epoch: 4, Steps: 8 | Train Loss: 0.818 Vali Loss: 0.875 Vali Acc: 0.716 Test Loss: 0.875 Test Acc: 0.716
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.158010721206665
Epoch: 5, Steps: 8 | Train Loss: 0.569 Vali Loss: 0.779 Vali Acc: 0.738 Test Loss: 0.779 Test Acc: 0.738
Validation loss decreased (-0.718739 --> -0.737492).  Saving model ...
Epoch: 6 cost time: 3.090318441390991
Epoch: 6, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.747 Vali Acc: 0.766 Test Loss: 0.747 Test Acc: 0.766
Validation loss decreased (-0.737492 --> -0.765618).  Saving model ...
Epoch: 7 cost time: 2.941978693008423
Epoch: 7, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.750 Vali Acc: 0.762 Test Loss: 0.750 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9577832221984863
Epoch: 8, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.738 Vali Acc: 0.756 Test Loss: 0.738 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.889448642730713
Epoch: 9, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.768 Vali Acc: 0.747 Test Loss: 0.768 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0568301677703857
Epoch: 10, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.821 Vali Acc: 0.744 Test Loss: 0.821 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0730209350585938
Epoch: 11, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.799 Vali Acc: 0.762 Test Loss: 0.799 Test Acc: 0.762
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0187413692474365
Epoch: 12, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.822 Vali Acc: 0.734 Test Loss: 0.822 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9189045429229736
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.830 Vali Acc: 0.756 Test Loss: 0.830 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.848520278930664
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.840 Vali Acc: 0.775 Test Loss: 0.840 Test Acc: 0.775
Validation loss decreased (-0.765618 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 3.107024908065796
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.858 Vali Acc: 0.756 Test Loss: 0.858 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.837667465209961
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.876 Vali Acc: 0.753 Test Loss: 0.876 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.286324977874756
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.884 Vali Acc: 0.769 Test Loss: 0.884 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1810219287872314
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.881 Vali Acc: 0.759 Test Loss: 0.881 Test Acc: 0.759
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.0597622394561768
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.906 Vali Acc: 0.759 Test Loss: 0.906 Test Acc: 0.759
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.9078335762023926
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.899 Vali Acc: 0.762 Test Loss: 0.899 Test Acc: 0.762
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.8142504692077637
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.885 Vali Acc: 0.769 Test Loss: 0.885 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9927821159362793
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.890 Vali Acc: 0.769 Test Loss: 0.890 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.7027735710144043
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.904 Vali Acc: 0.769 Test Loss: 0.904 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.063575029373169
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.910 Vali Acc: 0.772 Test Loss: 0.910 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.775
model parameter : 377992
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.479317903518677
Epoch: 1, Steps: 8 | Train Loss: 2.148 Vali Loss: 1.949 Vali Acc: 0.247 Test Loss: 1.949 Test Acc: 0.247
Validation loss decreased (inf --> -0.246856).  Saving model ...
Epoch: 2 cost time: 3.000166654586792
Epoch: 2, Steps: 8 | Train Loss: 1.788 Vali Loss: 1.575 Vali Acc: 0.553 Test Loss: 1.575 Test Acc: 0.553
Validation loss decreased (-0.246856 --> -0.553109).  Saving model ...
Epoch: 3 cost time: 2.8252084255218506
Epoch: 3, Steps: 8 | Train Loss: 1.363 Vali Loss: 1.281 Vali Acc: 0.613 Test Loss: 1.281 Test Acc: 0.613
Validation loss decreased (-0.553109 --> -0.612487).  Saving model ...
Epoch: 4 cost time: 3.3951525688171387
Epoch: 4, Steps: 8 | Train Loss: 0.970 Vali Loss: 1.095 Vali Acc: 0.650 Test Loss: 1.095 Test Acc: 0.650
Validation loss decreased (-0.612487 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 3.188577890396118
Epoch: 5, Steps: 8 | Train Loss: 0.695 Vali Loss: 0.978 Vali Acc: 0.706 Test Loss: 0.978 Test Acc: 0.706
Validation loss decreased (-0.649989 --> -0.706240).  Saving model ...
Epoch: 6 cost time: 3.4021105766296387
Epoch: 6, Steps: 8 | Train Loss: 0.532 Vali Loss: 0.939 Vali Acc: 0.691 Test Loss: 0.939 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1519880294799805
Epoch: 7, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.909 Vali Acc: 0.722 Test Loss: 0.909 Test Acc: 0.722
Validation loss decreased (-0.706240 --> -0.721866).  Saving model ...
Epoch: 8 cost time: 2.9553964138031006
Epoch: 8, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.915 Vali Acc: 0.697 Test Loss: 0.915 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.911543130874634
Epoch: 9, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.943 Vali Acc: 0.691 Test Loss: 0.943 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.2013392448425293
Epoch: 10, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.985 Vali Acc: 0.678 Test Loss: 0.985 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.1504483222961426
Epoch: 11, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.997 Vali Acc: 0.694 Test Loss: 0.997 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.978914260864258
Epoch: 12, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.016 Vali Acc: 0.691 Test Loss: 1.016 Test Acc: 0.691
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.823646306991577
Epoch: 13, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.088 Vali Acc: 0.684 Test Loss: 1.088 Test Acc: 0.684
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.651510000228882
Epoch: 14, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.055 Vali Acc: 0.694 Test Loss: 1.055 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.873331308364868
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.070 Vali Acc: 0.694 Test Loss: 1.070 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1525487899780273
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.106 Vali Acc: 0.697 Test Loss: 1.106 Test Acc: 0.697
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.233825445175171
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.096 Vali Acc: 0.684 Test Loss: 1.096 Test Acc: 0.684
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.721875
model parameter : 377992
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.63266658782959
Epoch: 1, Steps: 8 | Train Loss: 2.150 Vali Loss: 1.958 Vali Acc: 0.294 Test Loss: 1.958 Test Acc: 0.294
Validation loss decreased (inf --> -0.293730).  Saving model ...
Epoch: 2 cost time: 3.2449684143066406
Epoch: 2, Steps: 8 | Train Loss: 1.863 Vali Loss: 1.677 Vali Acc: 0.509 Test Loss: 1.677 Test Acc: 0.509
Validation loss decreased (-0.293730 --> -0.509358).  Saving model ...
Epoch: 3 cost time: 2.9579033851623535
Epoch: 3, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.416 Vali Acc: 0.550 Test Loss: 1.416 Test Acc: 0.550
Validation loss decreased (-0.509358 --> -0.549986).  Saving model ...
Epoch: 4 cost time: 3.1010334491729736
Epoch: 4, Steps: 8 | Train Loss: 1.104 Vali Loss: 1.225 Vali Acc: 0.603 Test Loss: 1.225 Test Acc: 0.603
Validation loss decreased (-0.549986 --> -0.603113).  Saving model ...
Epoch: 5 cost time: 3.2434632778167725
Epoch: 5, Steps: 8 | Train Loss: 0.816 Vali Loss: 1.088 Vali Acc: 0.634 Test Loss: 1.088 Test Acc: 0.634
Validation loss decreased (-0.603113 --> -0.634364).  Saving model ...
Epoch: 6 cost time: 3.1227211952209473
Epoch: 6, Steps: 8 | Train Loss: 0.634 Vali Loss: 1.063 Vali Acc: 0.637 Test Loss: 1.063 Test Acc: 0.637
Validation loss decreased (-0.634364 --> -0.637489).  Saving model ...
Epoch: 7 cost time: 3.3472087383270264
Epoch: 7, Steps: 8 | Train Loss: 0.449 Vali Loss: 1.016 Vali Acc: 0.656 Test Loss: 1.016 Test Acc: 0.656
Validation loss decreased (-0.637489 --> -0.656240).  Saving model ...
Epoch: 8 cost time: 3.220578670501709
Epoch: 8, Steps: 8 | Train Loss: 0.347 Vali Loss: 1.003 Vali Acc: 0.672 Test Loss: 1.003 Test Acc: 0.672
Validation loss decreased (-0.656240 --> -0.671865).  Saving model ...
Epoch: 9 cost time: 3.208547353744507
Epoch: 9, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.014 Vali Acc: 0.653 Test Loss: 1.014 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.14632511138916
Epoch: 10, Steps: 8 | Train Loss: 0.202 Vali Loss: 1.010 Vali Acc: 0.656 Test Loss: 1.010 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1882519721984863
Epoch: 11, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.024 Vali Acc: 0.669 Test Loss: 1.024 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.1271636486053467
Epoch: 12, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.039 Vali Acc: 0.662 Test Loss: 1.039 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.3197450637817383
Epoch: 13, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.065 Vali Acc: 0.669 Test Loss: 1.065 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2925798892974854
Epoch: 14, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.065 Vali Acc: 0.672 Test Loss: 1.065 Test Acc: 0.672
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3000550270080566
Epoch: 15, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.142 Vali Acc: 0.653 Test Loss: 1.142 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9860875606536865
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.112 Vali Acc: 0.669 Test Loss: 1.112 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.900811195373535
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.088 Vali Acc: 0.669 Test Loss: 1.088 Test Acc: 0.669
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6293859481811523
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.095 Vali Acc: 0.662 Test Loss: 1.095 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.671875
model parameter : 377992
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.455109596252441
Epoch: 1, Steps: 8 | Train Loss: 2.111 Vali Loss: 1.989 Vali Acc: 0.269 Test Loss: 1.989 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 2.5869669914245605
Epoch: 2, Steps: 8 | Train Loss: 1.906 Vali Loss: 1.814 Vali Acc: 0.369 Test Loss: 1.814 Test Acc: 0.369
Validation loss decreased (-0.268730 --> -0.368732).  Saving model ...
Epoch: 3 cost time: 2.6651716232299805
Epoch: 3, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.616 Vali Acc: 0.450 Test Loss: 1.616 Test Acc: 0.450
Validation loss decreased (-0.368732 --> -0.449984).  Saving model ...
Epoch: 4 cost time: 2.656067132949829
Epoch: 4, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.435 Vali Acc: 0.544 Test Loss: 1.435 Test Acc: 0.544
Validation loss decreased (-0.449984 --> -0.543736).  Saving model ...
Epoch: 5 cost time: 2.9205687046051025
Epoch: 5, Steps: 8 | Train Loss: 1.071 Vali Loss: 1.295 Vali Acc: 0.575 Test Loss: 1.295 Test Acc: 0.575
Validation loss decreased (-0.543736 --> -0.574987).  Saving model ...
Epoch: 6 cost time: 2.9277565479278564
Epoch: 6, Steps: 8 | Train Loss: 0.855 Vali Loss: 1.223 Vali Acc: 0.547 Test Loss: 1.223 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9442834854125977
Epoch: 7, Steps: 8 | Train Loss: 0.640 Vali Loss: 1.157 Vali Acc: 0.606 Test Loss: 1.157 Test Acc: 0.606
Validation loss decreased (-0.574987 --> -0.606238).  Saving model ...
Epoch: 8 cost time: 2.801241397857666
Epoch: 8, Steps: 8 | Train Loss: 0.508 Vali Loss: 1.143 Vali Acc: 0.594 Test Loss: 1.143 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7321314811706543
Epoch: 9, Steps: 8 | Train Loss: 0.464 Vali Loss: 1.077 Vali Acc: 0.619 Test Loss: 1.077 Test Acc: 0.619
Validation loss decreased (-0.606238 --> -0.618739).  Saving model ...
Epoch: 10 cost time: 2.889838218688965
Epoch: 10, Steps: 8 | Train Loss: 0.319 Vali Loss: 1.096 Vali Acc: 0.616 Test Loss: 1.096 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.86222505569458
Epoch: 11, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.068 Vali Acc: 0.631 Test Loss: 1.068 Test Acc: 0.631
Validation loss decreased (-0.618739 --> -0.631239).  Saving model ...
Epoch: 12 cost time: 3.1855602264404297
Epoch: 12, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.029 Vali Acc: 0.656 Test Loss: 1.029 Test Acc: 0.656
Validation loss decreased (-0.631239 --> -0.656240).  Saving model ...
Epoch: 13 cost time: 2.9839253425598145
Epoch: 13, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.090 Vali Acc: 0.637 Test Loss: 1.090 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.735419750213623
Epoch: 14, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.033 Vali Acc: 0.647 Test Loss: 1.033 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5200459957122803
Epoch: 15, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.154 Vali Acc: 0.619 Test Loss: 1.154 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7223422527313232
Epoch: 16, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.055 Vali Acc: 0.656 Test Loss: 1.055 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6698858737945557
Epoch: 17, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.080 Vali Acc: 0.650 Test Loss: 1.080 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0633976459503174
Epoch: 18, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.126 Vali Acc: 0.637 Test Loss: 1.126 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.9868805408477783
Epoch: 19, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.135 Vali Acc: 0.631 Test Loss: 1.135 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.0808427333831787
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.129 Vali Acc: 0.641 Test Loss: 1.129 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.7336161136627197
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.096 Vali Acc: 0.662 Test Loss: 1.096 Test Acc: 0.662
Validation loss decreased (-0.656240 --> -0.662489).  Saving model ...
Epoch: 22 cost time: 2.6936376094818115
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.092 Vali Acc: 0.662 Test Loss: 1.092 Test Acc: 0.662
Validation loss decreased (-0.662489 --> -0.662489).  Saving model ...
Epoch: 23 cost time: 2.783639430999756
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.114 Vali Acc: 0.662 Test Loss: 1.114 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0284218788146973
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.090 Vali Acc: 0.666 Test Loss: 1.090 Test Acc: 0.666
Validation loss decreased (-0.662489 --> -0.665614).  Saving model ...
Epoch: 25 cost time: 3.120863437652588
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.075 Vali Acc: 0.672 Test Loss: 1.075 Test Acc: 0.672
Validation loss decreased (-0.665614 --> -0.671864).  Saving model ...
Epoch: 26 cost time: 2.8278377056121826
Epoch: 26, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.103 Vali Acc: 0.659 Test Loss: 1.103 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.885493755340576
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.115 Vali Acc: 0.662 Test Loss: 1.115 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.648399591445923
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.109 Vali Acc: 0.662 Test Loss: 1.109 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.6795966625213623
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.103 Vali Acc: 0.666 Test Loss: 1.103 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.090622663497925
Epoch: 30, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.105 Vali Acc: 0.672 Test Loss: 1.105 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.8805127143859863
Epoch: 31, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.111 Vali Acc: 0.675 Test Loss: 1.111 Test Acc: 0.675
Validation loss decreased (-0.671864 --> -0.674989).  Saving model ...
Epoch: 32 cost time: 2.9262421131134033
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 33 cost time: 2.483813524246216
Epoch: 33, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.104 Vali Acc: 0.684 Test Loss: 1.104 Test Acc: 0.684
Validation loss decreased (-0.674989 --> -0.684364).  Saving model ...
Epoch: 34 cost time: 2.7796292304992676
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.106 Vali Acc: 0.684 Test Loss: 1.106 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.8755087852478027
Epoch: 35, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.116 Vali Acc: 0.678 Test Loss: 1.116 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.0220491886138916
Epoch: 36, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.119 Vali Acc: 0.678 Test Loss: 1.119 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.1644093990325928
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.097 Vali Acc: 0.684 Test Loss: 1.097 Test Acc: 0.684
Validation loss decreased (-0.684364 --> -0.684364).  Saving model ...
Epoch: 38 cost time: 2.87603759765625
Epoch: 38, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.095 Vali Acc: 0.684 Test Loss: 1.095 Test Acc: 0.684
Validation loss decreased (-0.684364 --> -0.684364).  Saving model ...
Epoch: 39 cost time: 2.83418607711792
Epoch: 39, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.094 Vali Acc: 0.678 Test Loss: 1.094 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.6542375087738037
Epoch: 40, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.097 Vali Acc: 0.678 Test Loss: 1.097 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.831934928894043
Epoch: 41, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.107 Vali Acc: 0.681 Test Loss: 1.107 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.6614372730255127
Epoch: 42, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.120 Vali Acc: 0.675 Test Loss: 1.120 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.8828823566436768
Epoch: 43, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.125 Vali Acc: 0.678 Test Loss: 1.125 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.9707062244415283
Epoch: 44, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.128 Vali Acc: 0.675 Test Loss: 1.128 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.679842233657837
Epoch: 45, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.126 Vali Acc: 0.675 Test Loss: 1.126 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.7538950443267822
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.124 Vali Acc: 0.681 Test Loss: 1.124 Test Acc: 0.681
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.6261229515075684
Epoch: 47, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.123 Vali Acc: 0.684 Test Loss: 1.123 Test Acc: 0.684
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.8330554962158203
Epoch: 48, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.125 Vali Acc: 0.678 Test Loss: 1.125 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.684375
model parameter : 377992
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.6673264503479
Epoch: 1, Steps: 8 | Train Loss: 2.161 Vali Loss: 2.045 Vali Acc: 0.150 Test Loss: 2.045 Test Acc: 0.150
Validation loss decreased (inf --> -0.149980).  Saving model ...
Epoch: 2 cost time: 2.7283198833465576
Epoch: 2, Steps: 8 | Train Loss: 2.011 Vali Loss: 1.943 Vali Acc: 0.272 Test Loss: 1.943 Test Acc: 0.272
Validation loss decreased (-0.149980 --> -0.271856).  Saving model ...
Epoch: 3 cost time: 2.824976921081543
Epoch: 3, Steps: 8 | Train Loss: 1.831 Vali Loss: 1.830 Vali Acc: 0.378 Test Loss: 1.830 Test Acc: 0.378
Validation loss decreased (-0.271856 --> -0.378107).  Saving model ...
Epoch: 4 cost time: 2.6959569454193115
Epoch: 4, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.697 Vali Acc: 0.434 Test Loss: 1.697 Test Acc: 0.434
Validation loss decreased (-0.378107 --> -0.434358).  Saving model ...
Epoch: 5 cost time: 3.1200308799743652
Epoch: 5, Steps: 8 | Train Loss: 1.333 Vali Loss: 1.580 Vali Acc: 0.466 Test Loss: 1.580 Test Acc: 0.466
Validation loss decreased (-0.434358 --> -0.465609).  Saving model ...
Epoch: 6 cost time: 3.1056089401245117
Epoch: 6, Steps: 8 | Train Loss: 1.123 Vali Loss: 1.535 Vali Acc: 0.434 Test Loss: 1.535 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9748377799987793
Epoch: 7, Steps: 8 | Train Loss: 0.914 Vali Loss: 1.443 Vali Acc: 0.478 Test Loss: 1.443 Test Acc: 0.478
Validation loss decreased (-0.465609 --> -0.478111).  Saving model ...
Epoch: 8 cost time: 2.80330753326416
Epoch: 8, Steps: 8 | Train Loss: 0.736 Vali Loss: 1.465 Vali Acc: 0.438 Test Loss: 1.465 Test Acc: 0.438
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6915531158447266
Epoch: 9, Steps: 8 | Train Loss: 0.648 Vali Loss: 1.370 Vali Acc: 0.509 Test Loss: 1.370 Test Acc: 0.509
Validation loss decreased (-0.478111 --> -0.509361).  Saving model ...
Epoch: 10 cost time: 2.582334280014038
Epoch: 10, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.476 Vali Acc: 0.412 Test Loss: 1.476 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8582992553710938
Epoch: 11, Steps: 8 | Train Loss: 0.424 Vali Loss: 1.440 Vali Acc: 0.509 Test Loss: 1.440 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.804255962371826
Epoch: 12, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.427 Vali Acc: 0.466 Test Loss: 1.427 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.004051923751831
Epoch: 13, Steps: 8 | Train Loss: 0.274 Vali Loss: 1.429 Vali Acc: 0.503 Test Loss: 1.429 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8477115631103516
Epoch: 14, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.361 Vali Acc: 0.506 Test Loss: 1.361 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.8411667346954346
Epoch: 15, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.577 Vali Acc: 0.428 Test Loss: 1.577 Test Acc: 0.428
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8113601207733154
Epoch: 16, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.361 Vali Acc: 0.519 Test Loss: 1.361 Test Acc: 0.519
Validation loss decreased (-0.509361 --> -0.518736).  Saving model ...
Epoch: 17 cost time: 3.22935152053833
Epoch: 17, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.435 Vali Acc: 0.472 Test Loss: 1.435 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.444425106048584
Epoch: 18, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.578 Vali Acc: 0.466 Test Loss: 1.578 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3991949558258057
Epoch: 19, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.596 Vali Acc: 0.484 Test Loss: 1.596 Test Acc: 0.484
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.1176624298095703
Epoch: 20, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.571 Vali Acc: 0.475 Test Loss: 1.571 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.202862024307251
Epoch: 21, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.480 Vali Acc: 0.512 Test Loss: 1.480 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.8676939010620117
Epoch: 22, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.522 Vali Acc: 0.491 Test Loss: 1.522 Test Acc: 0.491
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.9233551025390625
Epoch: 23, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.536 Vali Acc: 0.497 Test Loss: 1.536 Test Acc: 0.497
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.0166659355163574
Epoch: 24, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.609 Vali Acc: 0.503 Test Loss: 1.609 Test Acc: 0.503
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.9323933124542236
Epoch: 25, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.680 Vali Acc: 0.487 Test Loss: 1.680 Test Acc: 0.487
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.542982339859009
Epoch: 26, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.587 Vali Acc: 0.497 Test Loss: 1.587 Test Acc: 0.497
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.51875
model parameter : 377992
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.4320456981658936
Epoch: 1, Steps: 8 | Train Loss: 2.177 Vali Loss: 2.101 Vali Acc: 0.103 Test Loss: 2.101 Test Acc: 0.103
Validation loss decreased (inf --> -0.103104).  Saving model ...
Epoch: 2 cost time: 2.9063713550567627
Epoch: 2, Steps: 8 | Train Loss: 2.065 Vali Loss: 2.045 Vali Acc: 0.138 Test Loss: 2.045 Test Acc: 0.138
Validation loss decreased (-0.103104 --> -0.137480).  Saving model ...
Epoch: 3 cost time: 3.094789743423462
Epoch: 3, Steps: 8 | Train Loss: 1.928 Vali Loss: 1.991 Vali Acc: 0.138 Test Loss: 1.991 Test Acc: 0.138
Validation loss decreased (-0.137480 --> -0.137480).  Saving model ...
Epoch: 4 cost time: 3.032048463821411
Epoch: 4, Steps: 8 | Train Loss: 1.759 Vali Loss: 1.884 Vali Acc: 0.300 Test Loss: 1.884 Test Acc: 0.300
Validation loss decreased (-0.137480 --> -0.299981).  Saving model ...
Epoch: 5 cost time: 3.185889482498169
Epoch: 5, Steps: 8 | Train Loss: 1.513 Vali Loss: 1.811 Vali Acc: 0.325 Test Loss: 1.811 Test Acc: 0.325
Validation loss decreased (-0.299981 --> -0.324982).  Saving model ...
Epoch: 6 cost time: 2.6791250705718994
Epoch: 6, Steps: 8 | Train Loss: 1.334 Vali Loss: 1.783 Vali Acc: 0.297 Test Loss: 1.783 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6637158393859863
Epoch: 7, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.682 Vali Acc: 0.375 Test Loss: 1.682 Test Acc: 0.375
Validation loss decreased (-0.324982 --> -0.374983).  Saving model ...
Epoch: 8 cost time: 3.063119888305664
Epoch: 8, Steps: 8 | Train Loss: 0.922 Vali Loss: 1.686 Vali Acc: 0.319 Test Loss: 1.686 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.004849672317505
Epoch: 9, Steps: 8 | Train Loss: 0.823 Vali Loss: 1.555 Vali Acc: 0.416 Test Loss: 1.555 Test Acc: 0.416
Validation loss decreased (-0.374983 --> -0.415609).  Saving model ...
Epoch: 10 cost time: 2.901029586791992
Epoch: 10, Steps: 8 | Train Loss: 0.658 Vali Loss: 1.749 Vali Acc: 0.234 Test Loss: 1.749 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.780261993408203
Epoch: 11, Steps: 8 | Train Loss: 0.552 Vali Loss: 1.549 Vali Acc: 0.344 Test Loss: 1.549 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.074667453765869
Epoch: 12, Steps: 8 | Train Loss: 0.470 Vali Loss: 1.584 Vali Acc: 0.356 Test Loss: 1.584 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1232833862304688
Epoch: 13, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.548 Vali Acc: 0.347 Test Loss: 1.548 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.109227180480957
Epoch: 14, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.363 Vali Acc: 0.509 Test Loss: 1.363 Test Acc: 0.509
Validation loss decreased (-0.415609 --> -0.509361).  Saving model ...
Epoch: 15 cost time: 2.9666526317596436
Epoch: 15, Steps: 8 | Train Loss: 0.249 Vali Loss: 2.024 Vali Acc: 0.222 Test Loss: 2.024 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.418656826019287
Epoch: 16, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.380 Vali Acc: 0.450 Test Loss: 1.380 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.550471305847168
Epoch: 17, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.776 Vali Acc: 0.309 Test Loss: 1.776 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0409457683563232
Epoch: 18, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.773 Vali Acc: 0.356 Test Loss: 1.773 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.2549140453338623
Epoch: 19, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.746 Vali Acc: 0.369 Test Loss: 1.746 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.76863956451416
Epoch: 20, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.719 Vali Acc: 0.372 Test Loss: 1.719 Test Acc: 0.372
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.8255295753479004
Epoch: 21, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.634 Vali Acc: 0.428 Test Loss: 1.634 Test Acc: 0.428
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.2113711833953857
Epoch: 22, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.830 Vali Acc: 0.359 Test Loss: 1.830 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.4074277877807617
Epoch: 23, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.727 Vali Acc: 0.416 Test Loss: 1.727 Test Acc: 0.416
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.730117082595825
Epoch: 24, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.725 Vali Acc: 0.422 Test Loss: 1.725 Test Acc: 0.422
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.509375
model parameter : 377992
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.088596820831299
Epoch: 1, Steps: 8 | Train Loss: 2.174 Vali Loss: 2.087 Vali Acc: 0.113 Test Loss: 2.087 Test Acc: 0.113
Validation loss decreased (inf --> -0.112479).  Saving model ...
Epoch: 2 cost time: 3.009880304336548
Epoch: 2, Steps: 8 | Train Loss: 2.069 Vali Loss: 2.045 Vali Acc: 0.125 Test Loss: 2.045 Test Acc: 0.125
Validation loss decreased (-0.112479 --> -0.124980).  Saving model ...
Epoch: 3 cost time: 3.437370538711548
Epoch: 3, Steps: 8 | Train Loss: 1.956 Vali Loss: 2.014 Vali Acc: 0.125 Test Loss: 2.014 Test Acc: 0.125
Validation loss decreased (-0.124980 --> -0.124980).  Saving model ...
Epoch: 4 cost time: 3.087592124938965
Epoch: 4, Steps: 8 | Train Loss: 1.778 Vali Loss: 1.932 Vali Acc: 0.266 Test Loss: 1.932 Test Acc: 0.266
Validation loss decreased (-0.124980 --> -0.265606).  Saving model ...
Epoch: 5 cost time: 2.757481575012207
Epoch: 5, Steps: 8 | Train Loss: 1.518 Vali Loss: 1.868 Vali Acc: 0.303 Test Loss: 1.868 Test Acc: 0.303
Validation loss decreased (-0.265606 --> -0.303106).  Saving model ...
Epoch: 6 cost time: 3.2383363246917725
Epoch: 6, Steps: 8 | Train Loss: 1.363 Vali Loss: 1.838 Vali Acc: 0.284 Test Loss: 1.838 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2352144718170166
Epoch: 7, Steps: 8 | Train Loss: 1.154 Vali Loss: 1.756 Vali Acc: 0.334 Test Loss: 1.756 Test Acc: 0.334
Validation loss decreased (-0.303106 --> -0.334357).  Saving model ...
Epoch: 8 cost time: 3.300952672958374
Epoch: 8, Steps: 8 | Train Loss: 0.970 Vali Loss: 1.764 Vali Acc: 0.281 Test Loss: 1.764 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9578564167022705
Epoch: 9, Steps: 8 | Train Loss: 0.864 Vali Loss: 1.616 Vali Acc: 0.372 Test Loss: 1.616 Test Acc: 0.372
Validation loss decreased (-0.334357 --> -0.371859).  Saving model ...
Epoch: 10 cost time: 2.860460042953491
Epoch: 10, Steps: 8 | Train Loss: 0.686 Vali Loss: 1.739 Vali Acc: 0.231 Test Loss: 1.739 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8236823081970215
Epoch: 11, Steps: 8 | Train Loss: 0.573 Vali Loss: 1.589 Vali Acc: 0.297 Test Loss: 1.589 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1626501083374023
Epoch: 12, Steps: 8 | Train Loss: 0.502 Vali Loss: 1.495 Vali Acc: 0.347 Test Loss: 1.495 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.925421714782715
Epoch: 13, Steps: 8 | Train Loss: 0.368 Vali Loss: 1.516 Vali Acc: 0.316 Test Loss: 1.516 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2494990825653076
Epoch: 14, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.278 Vali Acc: 0.512 Test Loss: 1.278 Test Acc: 0.512
Validation loss decreased (-0.371859 --> -0.512487).  Saving model ...
Epoch: 15 cost time: 2.847017288208008
Epoch: 15, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.686 Vali Acc: 0.297 Test Loss: 1.686 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.995441198348999
Epoch: 16, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.365 Vali Acc: 0.438 Test Loss: 1.365 Test Acc: 0.438
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.190786361694336
Epoch: 17, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.442 Vali Acc: 0.441 Test Loss: 1.442 Test Acc: 0.441
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0489590167999268
Epoch: 18, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.650 Vali Acc: 0.369 Test Loss: 1.650 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.086188554763794
Epoch: 19, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.530 Vali Acc: 0.441 Test Loss: 1.530 Test Acc: 0.441
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.097848892211914
Epoch: 20, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.608 Vali Acc: 0.391 Test Loss: 1.608 Test Acc: 0.391
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.7865498065948486
Epoch: 21, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.522 Vali Acc: 0.463 Test Loss: 1.522 Test Acc: 0.463
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.033522129058838
Epoch: 22, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.602 Vali Acc: 0.422 Test Loss: 1.602 Test Acc: 0.422
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.3448145389556885
Epoch: 23, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.514 Vali Acc: 0.466 Test Loss: 1.514 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.812885284423828
Epoch: 24, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.568 Vali Acc: 0.466 Test Loss: 1.568 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5125
model parameter : 377992
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.5821099281311035
Epoch: 1, Steps: 8 | Train Loss: 2.175 Vali Loss: 2.105 Vali Acc: 0.128 Test Loss: 2.105 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 3.0829951763153076
Epoch: 2, Steps: 8 | Train Loss: 2.068 Vali Loss: 2.064 Vali Acc: 0.191 Test Loss: 2.064 Test Acc: 0.191
Validation loss decreased (-0.128104 --> -0.190604).  Saving model ...
Epoch: 3 cost time: 2.9826924800872803
Epoch: 3, Steps: 8 | Train Loss: 1.950 Vali Loss: 2.017 Vali Acc: 0.131 Test Loss: 2.017 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.645744800567627
Epoch: 4, Steps: 8 | Train Loss: 1.749 Vali Loss: 1.953 Vali Acc: 0.159 Test Loss: 1.953 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.875762939453125
Epoch: 5, Steps: 8 | Train Loss: 1.483 Vali Loss: 1.903 Vali Acc: 0.259 Test Loss: 1.903 Test Acc: 0.259
Validation loss decreased (-0.190604 --> -0.259356).  Saving model ...
Epoch: 6 cost time: 2.9386661052703857
Epoch: 6, Steps: 8 | Train Loss: 1.332 Vali Loss: 1.846 Vali Acc: 0.228 Test Loss: 1.846 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.211146354675293
Epoch: 7, Steps: 8 | Train Loss: 1.062 Vali Loss: 1.792 Vali Acc: 0.297 Test Loss: 1.792 Test Acc: 0.297
Validation loss decreased (-0.259356 --> -0.296857).  Saving model ...
Epoch: 8 cost time: 3.1918575763702393
Epoch: 8, Steps: 8 | Train Loss: 0.897 Vali Loss: 1.771 Vali Acc: 0.272 Test Loss: 1.771 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6370794773101807
Epoch: 9, Steps: 8 | Train Loss: 0.800 Vali Loss: 1.622 Vali Acc: 0.419 Test Loss: 1.622 Test Acc: 0.419
Validation loss decreased (-0.296857 --> -0.418734).  Saving model ...
Epoch: 10 cost time: 2.6594297885894775
Epoch: 10, Steps: 8 | Train Loss: 0.644 Vali Loss: 1.681 Vali Acc: 0.237 Test Loss: 1.681 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.560748815536499
Epoch: 11, Steps: 8 | Train Loss: 0.524 Vali Loss: 1.586 Vali Acc: 0.347 Test Loss: 1.586 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.834869623184204
Epoch: 12, Steps: 8 | Train Loss: 0.447 Vali Loss: 1.456 Vali Acc: 0.362 Test Loss: 1.456 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.081634283065796
Epoch: 13, Steps: 8 | Train Loss: 0.327 Vali Loss: 1.482 Vali Acc: 0.384 Test Loss: 1.482 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.756758689880371
Epoch: 14, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.362 Vali Acc: 0.469 Test Loss: 1.362 Test Acc: 0.469
Validation loss decreased (-0.418734 --> -0.468736).  Saving model ...
Epoch: 15 cost time: 2.7298903465270996
Epoch: 15, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.550 Vali Acc: 0.384 Test Loss: 1.550 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7456040382385254
Epoch: 16, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.508 Vali Acc: 0.428 Test Loss: 1.508 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1000876426696777
Epoch: 17, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.485 Vali Acc: 0.447 Test Loss: 1.485 Test Acc: 0.447
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.06547474861145
Epoch: 18, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.731 Vali Acc: 0.366 Test Loss: 1.731 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.9464969635009766
Epoch: 19, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.640 Vali Acc: 0.419 Test Loss: 1.640 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8289291858673096
Epoch: 20, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.693 Vali Acc: 0.391 Test Loss: 1.693 Test Acc: 0.391
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.836663007736206
Epoch: 21, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.476 Vali Acc: 0.481 Test Loss: 1.476 Test Acc: 0.481
Validation loss decreased (-0.468736 --> -0.481235).  Saving model ...
Epoch: 22 cost time: 3.0620250701904297
Epoch: 22, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.608 Vali Acc: 0.441 Test Loss: 1.608 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9629321098327637
Epoch: 23, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.563 Vali Acc: 0.459 Test Loss: 1.563 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.936565637588501
Epoch: 24, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.527 Vali Acc: 0.481 Test Loss: 1.527 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.777008533477783
Epoch: 25, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.660 Vali Acc: 0.459 Test Loss: 1.660 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.621347427368164
Epoch: 26, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.810 Vali Acc: 0.422 Test Loss: 1.810 Test Acc: 0.422
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.5629842281341553
Epoch: 27, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.710 Vali Acc: 0.469 Test Loss: 1.710 Test Acc: 0.469
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.970653772354126
Epoch: 28, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.631 Vali Acc: 0.487 Test Loss: 1.631 Test Acc: 0.487
Validation loss decreased (-0.481235 --> -0.487484).  Saving model ...
Epoch: 29 cost time: 2.5760676860809326
Epoch: 29, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.741 Vali Acc: 0.463 Test Loss: 1.741 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.221848726272583
Epoch: 30, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.659 Vali Acc: 0.500 Test Loss: 1.659 Test Acc: 0.500
Validation loss decreased (-0.487484 --> -0.499983).  Saving model ...
Epoch: 31 cost time: 2.922914505004883
Epoch: 31, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.672 Vali Acc: 0.519 Test Loss: 1.672 Test Acc: 0.519
Validation loss decreased (-0.499983 --> -0.518733).  Saving model ...
Epoch: 32 cost time: 2.5003418922424316
Epoch: 32, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.851 Vali Acc: 0.472 Test Loss: 1.851 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.5592947006225586
Epoch: 33, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.838 Vali Acc: 0.481 Test Loss: 1.838 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.7610349655151367
Epoch: 34, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.746 Vali Acc: 0.503 Test Loss: 1.746 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.0329837799072266
Epoch: 35, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.691 Vali Acc: 0.509 Test Loss: 1.691 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.864562511444092
Epoch: 36, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.976 Vali Acc: 0.469 Test Loss: 1.976 Test Acc: 0.469
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.6878182888031006
Epoch: 37, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.902 Vali Acc: 0.469 Test Loss: 1.902 Test Acc: 0.469
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.6908891201019287
Epoch: 38, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.667 Vali Acc: 0.534 Test Loss: 1.667 Test Acc: 0.534
Validation loss decreased (-0.518733 --> -0.534358).  Saving model ...
Epoch: 39 cost time: 3.110809087753296
Epoch: 39, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.672 Vali Acc: 0.522 Test Loss: 1.672 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.118213653564453
Epoch: 40, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.818 Vali Acc: 0.503 Test Loss: 1.818 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.8397939205169678
Epoch: 41, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.777 Vali Acc: 0.516 Test Loss: 1.777 Test Acc: 0.516
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.9424889087677
Epoch: 42, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.756 Vali Acc: 0.522 Test Loss: 1.756 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.8753914833068848
Epoch: 43, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.804 Vali Acc: 0.509 Test Loss: 1.804 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.2378783226013184
Epoch: 44, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.779 Vali Acc: 0.506 Test Loss: 1.779 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.0009162425994873
Epoch: 45, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.755 Vali Acc: 0.519 Test Loss: 1.755 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.7366726398468018
Epoch: 46, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.782 Vali Acc: 0.525 Test Loss: 1.782 Test Acc: 0.525
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.789665937423706
Epoch: 47, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.822 Vali Acc: 0.534 Test Loss: 1.822 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.997079610824585
Epoch: 48, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.844 Vali Acc: 0.537 Test Loss: 1.844 Test Acc: 0.537
Validation loss decreased (-0.534358 --> -0.537482).  Saving model ...
Epoch: 49 cost time: 3.0653655529022217
Epoch: 49, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.824 Vali Acc: 0.541 Test Loss: 1.824 Test Acc: 0.541
Validation loss decreased (-0.537482 --> -0.540607).  Saving model ...
Epoch: 50 cost time: 2.6951398849487305
Epoch: 50, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.817 Vali Acc: 0.537 Test Loss: 1.817 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.7918496131896973
Epoch: 51, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.777 Vali Acc: 0.537 Test Loss: 1.777 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.0949909687042236
Epoch: 52, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.793 Vali Acc: 0.519 Test Loss: 1.793 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.1766774654388428
Epoch: 53, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.780 Vali Acc: 0.531 Test Loss: 1.780 Test Acc: 0.531
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.117762565612793
Epoch: 54, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.762 Vali Acc: 0.528 Test Loss: 1.762 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 2.754796028137207
Epoch: 55, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.738 Vali Acc: 0.541 Test Loss: 1.738 Test Acc: 0.541
Validation loss decreased (-0.540607 --> -0.540608).  Saving model ...
Epoch: 56 cost time: 2.751210927963257
Epoch: 56, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.817 Vali Acc: 0.541 Test Loss: 1.817 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.0370192527770996
Epoch: 57, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.871 Vali Acc: 0.522 Test Loss: 1.871 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.0334949493408203
Epoch: 58, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.870 Vali Acc: 0.525 Test Loss: 1.870 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 3.1637349128723145
Epoch: 59, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.826 Vali Acc: 0.528 Test Loss: 1.826 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 2.8315658569335938
Epoch: 60, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.837 Vali Acc: 0.528 Test Loss: 1.837 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 2.682206392288208
Epoch: 61, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.861 Vali Acc: 0.528 Test Loss: 1.861 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 3.115433931350708
Epoch: 62, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.857 Vali Acc: 0.516 Test Loss: 1.857 Test Acc: 0.516
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 3.1851449012756348
Epoch: 63, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.841 Vali Acc: 0.522 Test Loss: 1.841 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 2.6703312397003174
Epoch: 64, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.812 Vali Acc: 0.544 Test Loss: 1.812 Test Acc: 0.544
Validation loss decreased (-0.540608 --> -0.543732).  Saving model ...
Epoch: 65 cost time: 2.7824928760528564
Epoch: 65, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.776 Vali Acc: 0.541 Test Loss: 1.776 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.2201783657073975
Epoch: 66, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.788 Vali Acc: 0.550 Test Loss: 1.788 Test Acc: 0.550
Validation loss decreased (-0.543732 --> -0.549982).  Saving model ...
Epoch: 67 cost time: 3.1294188499450684
Epoch: 67, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.779 Vali Acc: 0.553 Test Loss: 1.779 Test Acc: 0.553
Validation loss decreased (-0.549982 --> -0.553107).  Saving model ...
Epoch: 68 cost time: 3.024362564086914
Epoch: 68, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.867 Vali Acc: 0.566 Test Loss: 1.867 Test Acc: 0.566
Validation loss decreased (-0.553107 --> -0.565606).  Saving model ...
Epoch: 69 cost time: 2.968921661376953
Epoch: 69, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.955 Vali Acc: 0.556 Test Loss: 1.955 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 2.7544634342193604
Epoch: 70, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.898 Vali Acc: 0.559 Test Loss: 1.898 Test Acc: 0.559
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 3.0584211349487305
Epoch: 71, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.927 Vali Acc: 0.541 Test Loss: 1.927 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 3.0189669132232666
Epoch: 72, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.018 Vali Acc: 0.519 Test Loss: 2.018 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 2.9735429286956787
Epoch: 73, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.091 Vali Acc: 0.503 Test Loss: 2.091 Test Acc: 0.503
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 2.708953857421875
Epoch: 74, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.979 Vali Acc: 0.509 Test Loss: 1.979 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 2.7675118446350098
Epoch: 75, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.880 Vali Acc: 0.537 Test Loss: 1.880 Test Acc: 0.537
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 3.15777325630188
Epoch: 76, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.884 Vali Acc: 0.544 Test Loss: 1.884 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 3.0272316932678223
Epoch: 77, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.962 Vali Acc: 0.541 Test Loss: 1.962 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 2.7835419178009033
Epoch: 78, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.974 Vali Acc: 0.544 Test Loss: 1.974 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.565625
model parameter : 377992
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.695577621459961
Epoch: 1, Steps: 8 | Train Loss: 2.175 Vali Loss: 2.167 Vali Acc: 0.131 Test Loss: 2.167 Test Acc: 0.131
Validation loss decreased (inf --> -0.131228).  Saving model ...
Epoch: 2 cost time: 2.924586296081543
Epoch: 2, Steps: 8 | Train Loss: 2.118 Vali Loss: 2.150 Vali Acc: 0.128 Test Loss: 2.150 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7386434078216553
Epoch: 3, Steps: 8 | Train Loss: 1.947 Vali Loss: 2.119 Vali Acc: 0.128 Test Loss: 2.119 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1041555404663086
Epoch: 4, Steps: 8 | Train Loss: 1.766 Vali Loss: 2.028 Vali Acc: 0.134 Test Loss: 2.028 Test Acc: 0.134
Validation loss decreased (-0.131228 --> -0.134355).  Saving model ...
Epoch: 5 cost time: 2.971705675125122
Epoch: 5, Steps: 8 | Train Loss: 1.522 Vali Loss: 1.952 Vali Acc: 0.169 Test Loss: 1.952 Test Acc: 0.169
Validation loss decreased (-0.134355 --> -0.168730).  Saving model ...
Epoch: 6 cost time: 2.9513256549835205
Epoch: 6, Steps: 8 | Train Loss: 1.443 Vali Loss: 1.885 Vali Acc: 0.191 Test Loss: 1.885 Test Acc: 0.191
Validation loss decreased (-0.168730 --> -0.190606).  Saving model ...
Epoch: 7 cost time: 2.723717451095581
Epoch: 7, Steps: 8 | Train Loss: 1.139 Vali Loss: 1.811 Vali Acc: 0.206 Test Loss: 1.811 Test Acc: 0.206
Validation loss decreased (-0.190606 --> -0.206232).  Saving model ...
Epoch: 8 cost time: 2.5217487812042236
Epoch: 8, Steps: 8 | Train Loss: 0.970 Vali Loss: 1.735 Vali Acc: 0.200 Test Loss: 1.735 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.86519718170166
Epoch: 9, Steps: 8 | Train Loss: 0.862 Vali Loss: 1.565 Vali Acc: 0.341 Test Loss: 1.565 Test Acc: 0.341
Validation loss decreased (-0.206232 --> -0.340609).  Saving model ...
Epoch: 10 cost time: 3.094536304473877
Epoch: 10, Steps: 8 | Train Loss: 0.690 Vali Loss: 1.562 Vali Acc: 0.325 Test Loss: 1.562 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6444203853607178
Epoch: 11, Steps: 8 | Train Loss: 0.573 Vali Loss: 1.508 Vali Acc: 0.362 Test Loss: 1.508 Test Acc: 0.362
Validation loss decreased (-0.340609 --> -0.362485).  Saving model ...
Epoch: 12 cost time: 2.6926536560058594
Epoch: 12, Steps: 8 | Train Loss: 0.497 Vali Loss: 1.409 Vali Acc: 0.422 Test Loss: 1.409 Test Acc: 0.422
Validation loss decreased (-0.362485 --> -0.421861).  Saving model ...
Epoch: 13 cost time: 2.9658138751983643
Epoch: 13, Steps: 8 | Train Loss: 0.371 Vali Loss: 1.437 Vali Acc: 0.409 Test Loss: 1.437 Test Acc: 0.409
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0509862899780273
Epoch: 14, Steps: 8 | Train Loss: 0.357 Vali Loss: 1.310 Vali Acc: 0.487 Test Loss: 1.310 Test Acc: 0.487
Validation loss decreased (-0.421861 --> -0.487487).  Saving model ...
Epoch: 15 cost time: 3.0420429706573486
Epoch: 15, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.436 Vali Acc: 0.453 Test Loss: 1.436 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.710660696029663
Epoch: 16, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.568 Vali Acc: 0.397 Test Loss: 1.568 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.128847360610962
Epoch: 17, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.499 Vali Acc: 0.484 Test Loss: 1.499 Test Acc: 0.484
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0433154106140137
Epoch: 18, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.758 Vali Acc: 0.412 Test Loss: 1.758 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1821205615997314
Epoch: 19, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.780 Vali Acc: 0.412 Test Loss: 1.780 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.117661714553833
Epoch: 20, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.765 Vali Acc: 0.450 Test Loss: 1.765 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.9171388149261475
Epoch: 21, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.746 Vali Acc: 0.438 Test Loss: 1.746 Test Acc: 0.438
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.747295379638672
Epoch: 22, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.886 Vali Acc: 0.438 Test Loss: 1.886 Test Acc: 0.438
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.03747296333313
Epoch: 23, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.892 Vali Acc: 0.434 Test Loss: 1.892 Test Acc: 0.434
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.125837802886963
Epoch: 24, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.944 Vali Acc: 0.419 Test Loss: 1.944 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.4875
model parameter : 377992
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.2525177001953125
Epoch: 1, Steps: 8 | Train Loss: 2.214 Vali Loss: 2.120 Vali Acc: 0.116 Test Loss: 2.120 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 2.691486120223999
Epoch: 2, Steps: 8 | Train Loss: 2.090 Vali Loss: 2.098 Vali Acc: 0.134 Test Loss: 2.098 Test Acc: 0.134
Validation loss decreased (-0.115604 --> -0.134354).  Saving model ...
Epoch: 3 cost time: 2.816879987716675
Epoch: 3, Steps: 8 | Train Loss: 1.964 Vali Loss: 2.074 Vali Acc: 0.153 Test Loss: 2.074 Test Acc: 0.153
Validation loss decreased (-0.134354 --> -0.153104).  Saving model ...
Epoch: 4 cost time: 3.0384790897369385
Epoch: 4, Steps: 8 | Train Loss: 1.766 Vali Loss: 2.018 Vali Acc: 0.191 Test Loss: 2.018 Test Acc: 0.191
Validation loss decreased (-0.153104 --> -0.190605).  Saving model ...
Epoch: 5 cost time: 3.2288668155670166
Epoch: 5, Steps: 8 | Train Loss: 1.633 Vali Loss: 1.949 Vali Acc: 0.188 Test Loss: 1.949 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3362293243408203
Epoch: 6, Steps: 8 | Train Loss: 1.449 Vali Loss: 1.901 Vali Acc: 0.237 Test Loss: 1.901 Test Acc: 0.237
Validation loss decreased (-0.190605 --> -0.237481).  Saving model ...
Epoch: 7 cost time: 3.0874478816986084
Epoch: 7, Steps: 8 | Train Loss: 1.231 Vali Loss: 1.809 Vali Acc: 0.253 Test Loss: 1.809 Test Acc: 0.253
Validation loss decreased (-0.237481 --> -0.253107).  Saving model ...
Epoch: 8 cost time: 3.0063693523406982
Epoch: 8, Steps: 8 | Train Loss: 1.094 Vali Loss: 1.735 Vali Acc: 0.250 Test Loss: 1.735 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1984446048736572
Epoch: 9, Steps: 8 | Train Loss: 0.963 Vali Loss: 1.606 Vali Acc: 0.394 Test Loss: 1.606 Test Acc: 0.394
Validation loss decreased (-0.253107 --> -0.393734).  Saving model ...
Epoch: 10 cost time: 3.2071754932403564
Epoch: 10, Steps: 8 | Train Loss: 0.767 Vali Loss: 1.568 Vali Acc: 0.347 Test Loss: 1.568 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8380019664764404
Epoch: 11, Steps: 8 | Train Loss: 0.654 Vali Loss: 1.596 Vali Acc: 0.319 Test Loss: 1.596 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6756856441497803
Epoch: 12, Steps: 8 | Train Loss: 0.614 Vali Loss: 1.459 Vali Acc: 0.388 Test Loss: 1.459 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2404747009277344
Epoch: 13, Steps: 8 | Train Loss: 0.474 Vali Loss: 1.465 Vali Acc: 0.406 Test Loss: 1.465 Test Acc: 0.406
Validation loss decreased (-0.393734 --> -0.406235).  Saving model ...
Epoch: 14 cost time: 3.1153724193573
Epoch: 14, Steps: 8 | Train Loss: 0.426 Vali Loss: 1.362 Vali Acc: 0.494 Test Loss: 1.362 Test Acc: 0.494
Validation loss decreased (-0.406235 --> -0.493736).  Saving model ...
Epoch: 15 cost time: 2.8700571060180664
Epoch: 15, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.468 Vali Acc: 0.422 Test Loss: 1.468 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7820985317230225
Epoch: 16, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.636 Vali Acc: 0.362 Test Loss: 1.636 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2780067920684814
Epoch: 17, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.494 Vali Acc: 0.450 Test Loss: 1.494 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0998575687408447
Epoch: 18, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.699 Vali Acc: 0.419 Test Loss: 1.699 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.054471492767334
Epoch: 19, Steps: 8 | Train Loss: 0.194 Vali Loss: 2.054 Vali Acc: 0.366 Test Loss: 2.054 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.7258102893829346
Epoch: 20, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.821 Vali Acc: 0.412 Test Loss: 1.821 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1645545959472656
Epoch: 21, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.816 Vali Acc: 0.422 Test Loss: 1.816 Test Acc: 0.422
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.1358606815338135
Epoch: 22, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.876 Vali Acc: 0.412 Test Loss: 1.876 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.925354480743408
Epoch: 23, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.805 Vali Acc: 0.412 Test Loss: 1.805 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6900017261505127
Epoch: 24, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.959 Vali Acc: 0.400 Test Loss: 1.959 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.49375
model parameter : 377992
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.606258869171143
Epoch: 1, Steps: 8 | Train Loss: 2.058 Vali Loss: 1.959 Vali Acc: 0.253 Test Loss: 1.959 Test Acc: 0.253
Validation loss decreased (inf --> -0.253105).  Saving model ...
Epoch: 2 cost time: 2.8063852787017822
Epoch: 2, Steps: 8 | Train Loss: 1.834 Vali Loss: 1.621 Vali Acc: 0.547 Test Loss: 1.621 Test Acc: 0.547
Validation loss decreased (-0.253105 --> -0.546859).  Saving model ...
Epoch: 3 cost time: 3.165142774581909
Epoch: 3, Steps: 8 | Train Loss: 1.442 Vali Loss: 1.287 Vali Acc: 0.672 Test Loss: 1.287 Test Acc: 0.672
Validation loss decreased (-0.546859 --> -0.671862).  Saving model ...
Epoch: 4 cost time: 3.069596529006958
Epoch: 4, Steps: 8 | Train Loss: 1.121 Vali Loss: 1.019 Vali Acc: 0.734 Test Loss: 1.019 Test Acc: 0.734
Validation loss decreased (-0.671862 --> -0.734365).  Saving model ...
Epoch: 5 cost time: 3.02543306350708
Epoch: 5, Steps: 8 | Train Loss: 0.776 Vali Loss: 0.865 Vali Acc: 0.756 Test Loss: 0.865 Test Acc: 0.756
Validation loss decreased (-0.734365 --> -0.756241).  Saving model ...
Epoch: 6 cost time: 3.4461216926574707
Epoch: 6, Steps: 8 | Train Loss: 0.591 Vali Loss: 0.759 Vali Acc: 0.756 Test Loss: 0.759 Test Acc: 0.756
Validation loss decreased (-0.756241 --> -0.756242).  Saving model ...
Epoch: 7 cost time: 3.6888086795806885
Epoch: 7, Steps: 8 | Train Loss: 0.462 Vali Loss: 0.694 Vali Acc: 0.753 Test Loss: 0.694 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2440125942230225
Epoch: 8, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.657 Vali Acc: 0.766 Test Loss: 0.657 Test Acc: 0.766
Validation loss decreased (-0.756242 --> -0.765618).  Saving model ...
Epoch: 9 cost time: 3.3147640228271484
Epoch: 9, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.653 Vali Acc: 0.775 Test Loss: 0.653 Test Acc: 0.775
Validation loss decreased (-0.765618 --> -0.774993).  Saving model ...
Epoch: 10 cost time: 3.049990177154541
Epoch: 10, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.674 Vali Acc: 0.753 Test Loss: 0.674 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0926671028137207
Epoch: 11, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.687 Vali Acc: 0.784 Test Loss: 0.687 Test Acc: 0.784
Validation loss decreased (-0.774993 --> -0.784368).  Saving model ...
Epoch: 12 cost time: 3.358825922012329
Epoch: 12, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.693 Vali Acc: 0.766 Test Loss: 0.693 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1362223625183105
Epoch: 13, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.693 Vali Acc: 0.753 Test Loss: 0.693 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9153409004211426
Epoch: 14, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2377209663391113
Epoch: 15, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.742 Vali Acc: 0.772 Test Loss: 0.742 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.1576831340789795
Epoch: 16, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.726 Vali Acc: 0.769 Test Loss: 0.726 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.7732605934143066
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.962355613708496
Epoch: 18, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.712 Vali Acc: 0.775 Test Loss: 0.712 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.3138644695281982
Epoch: 19, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.718 Vali Acc: 0.775 Test Loss: 0.718 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.3145101070404053
Epoch: 20, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.720 Vali Acc: 0.781 Test Loss: 0.720 Test Acc: 0.781
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.8957982063293457
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.729 Vali Acc: 0.787 Test Loss: 0.729 Test Acc: 0.787
Validation loss decreased (-0.784368 --> -0.787493).  Saving model ...
Epoch: 22 cost time: 2.8803389072418213
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.758 Vali Acc: 0.781 Test Loss: 0.758 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.587740898132324
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.749 Vali Acc: 0.784 Test Loss: 0.749 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3048272132873535
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.756 Vali Acc: 0.781 Test Loss: 0.756 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.031428098678589
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.758 Vali Acc: 0.772 Test Loss: 0.758 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.639950752258301
Epoch: 26, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.762 Vali Acc: 0.775 Test Loss: 0.762 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.0868680477142334
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.767 Vali Acc: 0.784 Test Loss: 0.767 Test Acc: 0.784
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.312346935272217
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.771 Vali Acc: 0.784 Test Loss: 0.771 Test Acc: 0.784
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.742063283920288
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.761 Vali Acc: 0.794 Test Loss: 0.761 Test Acc: 0.794
Validation loss decreased (-0.787493 --> -0.793742).  Saving model ...
Epoch: 30 cost time: 2.8735265731811523
Epoch: 30, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.760 Vali Acc: 0.791 Test Loss: 0.760 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.0455470085144043
Epoch: 31, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.772 Vali Acc: 0.791 Test Loss: 0.772 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.5737428665161133
Epoch: 32, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.777 Vali Acc: 0.797 Test Loss: 0.777 Test Acc: 0.797
Validation loss decreased (-0.793742 --> -0.796867).  Saving model ...
Epoch: 33 cost time: 3.1440486907958984
Epoch: 33, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.778 Vali Acc: 0.794 Test Loss: 0.778 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.95853590965271
Epoch: 34, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.781 Vali Acc: 0.787 Test Loss: 0.781 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.170999050140381
Epoch: 35, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.782 Vali Acc: 0.781 Test Loss: 0.782 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.3685498237609863
Epoch: 36, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.778 Test Loss: 0.793 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.284022808074951
Epoch: 37, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.795 Vali Acc: 0.778 Test Loss: 0.795 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.08701229095459
Epoch: 38, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.790 Vali Acc: 0.781 Test Loss: 0.790 Test Acc: 0.781
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.8401668071746826
Epoch: 39, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.788 Vali Acc: 0.787 Test Loss: 0.788 Test Acc: 0.787
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.0917763710021973
Epoch: 40, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.793 Vali Acc: 0.791 Test Loss: 0.793 Test Acc: 0.791
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.206422805786133
Epoch: 41, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.796 Vali Acc: 0.791 Test Loss: 0.796 Test Acc: 0.791
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.065342903137207
Epoch: 42, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.797 Vali Acc: 0.794 Test Loss: 0.797 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.796875
model parameter : 516680
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.849665403366089
Epoch: 1, Steps: 8 | Train Loss: 2.078 Vali Loss: 1.989 Vali Acc: 0.250 Test Loss: 1.989 Test Acc: 0.250
Validation loss decreased (inf --> -0.249980).  Saving model ...
Epoch: 2 cost time: 3.1115331649780273
Epoch: 2, Steps: 8 | Train Loss: 1.882 Vali Loss: 1.717 Vali Acc: 0.463 Test Loss: 1.717 Test Acc: 0.463
Validation loss decreased (-0.249980 --> -0.462483).  Saving model ...
Epoch: 3 cost time: 3.193255662918091
Epoch: 3, Steps: 8 | Train Loss: 1.539 Vali Loss: 1.445 Vali Acc: 0.581 Test Loss: 1.445 Test Acc: 0.581
Validation loss decreased (-0.462483 --> -0.581236).  Saving model ...
Epoch: 4 cost time: 2.820108413696289
Epoch: 4, Steps: 8 | Train Loss: 1.257 Vali Loss: 1.216 Vali Acc: 0.634 Test Loss: 1.216 Test Acc: 0.634
Validation loss decreased (-0.581236 --> -0.634363).  Saving model ...
Epoch: 5 cost time: 2.8524742126464844
Epoch: 5, Steps: 8 | Train Loss: 0.920 Vali Loss: 1.072 Vali Acc: 0.688 Test Loss: 1.072 Test Acc: 0.688
Validation loss decreased (-0.634363 --> -0.687489).  Saving model ...
Epoch: 6 cost time: 3.2564756870269775
Epoch: 6, Steps: 8 | Train Loss: 0.710 Vali Loss: 0.957 Vali Acc: 0.688 Test Loss: 0.957 Test Acc: 0.688
Validation loss decreased (-0.687489 --> -0.687490).  Saving model ...
Epoch: 7 cost time: 3.0731306076049805
Epoch: 7, Steps: 8 | Train Loss: 0.579 Vali Loss: 0.887 Vali Acc: 0.725 Test Loss: 0.887 Test Acc: 0.725
Validation loss decreased (-0.687490 --> -0.724991).  Saving model ...
Epoch: 8 cost time: 2.7376909255981445
Epoch: 8, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.818 Vali Acc: 0.747 Test Loss: 0.818 Test Acc: 0.747
Validation loss decreased (-0.724991 --> -0.746867).  Saving model ...
Epoch: 9 cost time: 2.769038677215576
Epoch: 9, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.831 Vali Acc: 0.725 Test Loss: 0.831 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.447063446044922
Epoch: 10, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.840 Vali Acc: 0.709 Test Loss: 0.840 Test Acc: 0.709
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6718313694000244
Epoch: 11, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.868 Vali Acc: 0.706 Test Loss: 0.868 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.082468032836914
Epoch: 12, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.859 Vali Acc: 0.713 Test Loss: 0.859 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.082508087158203
Epoch: 13, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.855 Vali Acc: 0.716 Test Loss: 0.855 Test Acc: 0.716
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.0978782176971436
Epoch: 14, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.887 Vali Acc: 0.713 Test Loss: 0.887 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.1907382011413574
Epoch: 15, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.901 Vali Acc: 0.709 Test Loss: 0.901 Test Acc: 0.709
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7023427486419678
Epoch: 16, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.900 Vali Acc: 0.713 Test Loss: 0.900 Test Acc: 0.713
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.142850160598755
Epoch: 17, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.891 Vali Acc: 0.716 Test Loss: 0.891 Test Acc: 0.716
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.0678439140319824
Epoch: 18, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.912 Vali Acc: 0.716 Test Loss: 0.912 Test Acc: 0.716
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.746875
model parameter : 516680
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.549863815307617
Epoch: 1, Steps: 8 | Train Loss: 2.130 Vali Loss: 2.049 Vali Acc: 0.172 Test Loss: 2.049 Test Acc: 0.172
Validation loss decreased (inf --> -0.171855).  Saving model ...
Epoch: 2 cost time: 2.9575071334838867
Epoch: 2, Steps: 8 | Train Loss: 1.964 Vali Loss: 1.833 Vali Acc: 0.444 Test Loss: 1.833 Test Acc: 0.444
Validation loss decreased (-0.171855 --> -0.443732).  Saving model ...
Epoch: 3 cost time: 2.8963088989257812
Epoch: 3, Steps: 8 | Train Loss: 1.677 Vali Loss: 1.592 Vali Acc: 0.541 Test Loss: 1.592 Test Acc: 0.541
Validation loss decreased (-0.443732 --> -0.540609).  Saving model ...
Epoch: 4 cost time: 2.951878309249878
Epoch: 4, Steps: 8 | Train Loss: 1.385 Vali Loss: 1.368 Vali Acc: 0.613 Test Loss: 1.368 Test Acc: 0.613
Validation loss decreased (-0.540609 --> -0.612486).  Saving model ...
Epoch: 5 cost time: 2.68255615234375
Epoch: 5, Steps: 8 | Train Loss: 1.066 Vali Loss: 1.221 Vali Acc: 0.606 Test Loss: 1.221 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1205525398254395
Epoch: 6, Steps: 8 | Train Loss: 0.835 Vali Loss: 1.101 Vali Acc: 0.616 Test Loss: 1.101 Test Acc: 0.616
Validation loss decreased (-0.612486 --> -0.615614).  Saving model ...
Epoch: 7 cost time: 2.6607577800750732
Epoch: 7, Steps: 8 | Train Loss: 0.680 Vali Loss: 1.018 Vali Acc: 0.666 Test Loss: 1.018 Test Acc: 0.666
Validation loss decreased (-0.615614 --> -0.665615).  Saving model ...
Epoch: 8 cost time: 2.798577308654785
Epoch: 8, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.952 Vali Acc: 0.681 Test Loss: 0.952 Test Acc: 0.681
Validation loss decreased (-0.665615 --> -0.681240).  Saving model ...
Epoch: 9 cost time: 2.666518211364746
Epoch: 9, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.970 Vali Acc: 0.662 Test Loss: 0.970 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2501275539398193
Epoch: 10, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.952 Vali Acc: 0.675 Test Loss: 0.952 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.064100742340088
Epoch: 11, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.999 Vali Acc: 0.662 Test Loss: 0.999 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4254531860351562
Epoch: 12, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.945 Vali Acc: 0.688 Test Loss: 0.945 Test Acc: 0.688
Validation loss decreased (-0.681240 --> -0.687491).  Saving model ...
Epoch: 13 cost time: 3.4329051971435547
Epoch: 13, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.974 Vali Acc: 0.691 Test Loss: 0.974 Test Acc: 0.691
Validation loss decreased (-0.687491 --> -0.690615).  Saving model ...
Epoch: 14 cost time: 3.1569948196411133
Epoch: 14, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.046 Vali Acc: 0.678 Test Loss: 1.046 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.957312822341919
Epoch: 15, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.990 Vali Acc: 0.706 Test Loss: 0.990 Test Acc: 0.706
Validation loss decreased (-0.690615 --> -0.706240).  Saving model ...
Epoch: 16 cost time: 2.6267502307891846
Epoch: 16, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.976 Vali Acc: 0.706 Test Loss: 0.976 Test Acc: 0.706
Validation loss decreased (-0.706240 --> -0.706240).  Saving model ...
Epoch: 17 cost time: 2.756012201309204
Epoch: 17, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.009 Vali Acc: 0.709 Test Loss: 1.009 Test Acc: 0.709
Validation loss decreased (-0.706240 --> -0.709365).  Saving model ...
Epoch: 18 cost time: 2.744302988052368
Epoch: 18, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.047 Vali Acc: 0.700 Test Loss: 1.047 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.794036388397217
Epoch: 19, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6410768032073975
Epoch: 20, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.057 Vali Acc: 0.691 Test Loss: 1.057 Test Acc: 0.691
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.717130184173584
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.041 Vali Acc: 0.722 Test Loss: 1.041 Test Acc: 0.722
Validation loss decreased (-0.709365 --> -0.721865).  Saving model ...
Epoch: 22 cost time: 2.9375486373901367
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.047 Vali Acc: 0.709 Test Loss: 1.047 Test Acc: 0.709
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.126343011856079
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.061 Vali Acc: 0.716 Test Loss: 1.061 Test Acc: 0.716
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.174520969390869
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.070 Vali Acc: 0.713 Test Loss: 1.070 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1807148456573486
Epoch: 25, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.074 Vali Acc: 0.716 Test Loss: 1.074 Test Acc: 0.716
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.060490608215332
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.077 Vali Acc: 0.725 Test Loss: 1.077 Test Acc: 0.725
Validation loss decreased (-0.721865 --> -0.724989).  Saving model ...
Epoch: 27 cost time: 2.7612428665161133
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.061 Vali Acc: 0.725 Test Loss: 1.061 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 28 cost time: 3.2420108318328857
Epoch: 28, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.062 Vali Acc: 0.722 Test Loss: 1.062 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1247830390930176
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.061 Vali Acc: 0.719 Test Loss: 1.061 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.9387292861938477
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.069 Vali Acc: 0.716 Test Loss: 1.069 Test Acc: 0.716
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.7461369037628174
Epoch: 31, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.084 Vali Acc: 0.722 Test Loss: 1.084 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.7156076431274414
Epoch: 32, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.074 Vali Acc: 0.716 Test Loss: 1.074 Test Acc: 0.716
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.8906478881835938
Epoch: 33, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.071 Vali Acc: 0.722 Test Loss: 1.071 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.996670961380005
Epoch: 34, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.090 Vali Acc: 0.719 Test Loss: 1.090 Test Acc: 0.719
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.0267794132232666
Epoch: 35, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.107 Vali Acc: 0.719 Test Loss: 1.107 Test Acc: 0.719
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.072849988937378
Epoch: 36, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.116 Vali Acc: 0.713 Test Loss: 1.116 Test Acc: 0.713
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.1656441688537598
Epoch: 37, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.119 Vali Acc: 0.713 Test Loss: 1.119 Test Acc: 0.713
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.725
model parameter : 516680
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.238676309585571
Epoch: 1, Steps: 8 | Train Loss: 2.098 Vali Loss: 2.053 Vali Acc: 0.150 Test Loss: 2.053 Test Acc: 0.150
Validation loss decreased (inf --> -0.149979).  Saving model ...
Epoch: 2 cost time: 2.827744722366333
Epoch: 2, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.914 Vali Acc: 0.328 Test Loss: 1.914 Test Acc: 0.328
Validation loss decreased (-0.149979 --> -0.328106).  Saving model ...
Epoch: 3 cost time: 2.8215548992156982
Epoch: 3, Steps: 8 | Train Loss: 1.803 Vali Loss: 1.759 Vali Acc: 0.450 Test Loss: 1.759 Test Acc: 0.450
Validation loss decreased (-0.328106 --> -0.449982).  Saving model ...
Epoch: 4 cost time: 2.688725471496582
Epoch: 4, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.580 Vali Acc: 0.522 Test Loss: 1.580 Test Acc: 0.522
Validation loss decreased (-0.449982 --> -0.521859).  Saving model ...
Epoch: 5 cost time: 3.0681841373443604
Epoch: 5, Steps: 8 | Train Loss: 1.312 Vali Loss: 1.421 Vali Acc: 0.550 Test Loss: 1.421 Test Acc: 0.550
Validation loss decreased (-0.521859 --> -0.549986).  Saving model ...
Epoch: 6 cost time: 3.168833017349243
Epoch: 6, Steps: 8 | Train Loss: 1.069 Vali Loss: 1.279 Vali Acc: 0.569 Test Loss: 1.279 Test Acc: 0.569
Validation loss decreased (-0.549986 --> -0.568737).  Saving model ...
Epoch: 7 cost time: 3.119994878768921
Epoch: 7, Steps: 8 | Train Loss: 0.913 Vali Loss: 1.158 Vali Acc: 0.597 Test Loss: 1.158 Test Acc: 0.597
Validation loss decreased (-0.568737 --> -0.596863).  Saving model ...
Epoch: 8 cost time: 3.078071355819702
Epoch: 8, Steps: 8 | Train Loss: 0.737 Vali Loss: 1.057 Vali Acc: 0.613 Test Loss: 1.057 Test Acc: 0.613
Validation loss decreased (-0.596863 --> -0.612489).  Saving model ...
Epoch: 9 cost time: 3.2468018531799316
Epoch: 9, Steps: 8 | Train Loss: 0.603 Vali Loss: 1.034 Vali Acc: 0.628 Test Loss: 1.034 Test Acc: 0.628
Validation loss decreased (-0.612489 --> -0.628115).  Saving model ...
Epoch: 10 cost time: 2.8340208530426025
Epoch: 10, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.988 Vali Acc: 0.625 Test Loss: 0.988 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.107609510421753
Epoch: 11, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.965 Vali Acc: 0.637 Test Loss: 0.965 Test Acc: 0.637
Validation loss decreased (-0.628115 --> -0.637490).  Saving model ...
Epoch: 12 cost time: 2.6448893547058105
Epoch: 12, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.947 Vali Acc: 0.631 Test Loss: 0.947 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.795821189880371
Epoch: 13, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.968 Vali Acc: 0.622 Test Loss: 0.968 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1380221843719482
Epoch: 14, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.985 Vali Acc: 0.656 Test Loss: 0.985 Test Acc: 0.656
Validation loss decreased (-0.637490 --> -0.656240).  Saving model ...
Epoch: 15 cost time: 3.20672345161438
Epoch: 15, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.964 Vali Acc: 0.637 Test Loss: 0.964 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.438789129257202
Epoch: 16, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.979 Vali Acc: 0.619 Test Loss: 0.979 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9124562740325928
Epoch: 17, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.034 Vali Acc: 0.619 Test Loss: 1.034 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1549839973449707
Epoch: 18, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.013 Vali Acc: 0.622 Test Loss: 1.013 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.745706796646118
Epoch: 19, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.017 Vali Acc: 0.628 Test Loss: 1.017 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.959873676300049
Epoch: 20, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.057 Vali Acc: 0.637 Test Loss: 1.057 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.8713982105255127
Epoch: 21, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.006 Vali Acc: 0.637 Test Loss: 1.006 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.053358316421509
Epoch: 22, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.044 Vali Acc: 0.637 Test Loss: 1.044 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.207581043243408
Epoch: 23, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.046 Vali Acc: 0.637 Test Loss: 1.046 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.7225818634033203
Epoch: 24, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.041 Vali Acc: 0.634 Test Loss: 1.041 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.65625
model parameter : 516680
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.76484489440918
Epoch: 1, Steps: 8 | Train Loss: 2.175 Vali Loss: 2.113 Vali Acc: 0.119 Test Loss: 2.113 Test Acc: 0.119
Validation loss decreased (inf --> -0.118729).  Saving model ...
Epoch: 2 cost time: 3.145340919494629
Epoch: 2, Steps: 8 | Train Loss: 2.071 Vali Loss: 2.013 Vali Acc: 0.266 Test Loss: 2.013 Test Acc: 0.266
Validation loss decreased (-0.118729 --> -0.265605).  Saving model ...
Epoch: 3 cost time: 3.1735033988952637
Epoch: 3, Steps: 8 | Train Loss: 1.946 Vali Loss: 1.928 Vali Acc: 0.350 Test Loss: 1.928 Test Acc: 0.350
Validation loss decreased (-0.265605 --> -0.349981).  Saving model ...
Epoch: 4 cost time: 2.8453612327575684
Epoch: 4, Steps: 8 | Train Loss: 1.787 Vali Loss: 1.822 Vali Acc: 0.388 Test Loss: 1.822 Test Acc: 0.388
Validation loss decreased (-0.349981 --> -0.387482).  Saving model ...
Epoch: 5 cost time: 2.6478867530822754
Epoch: 5, Steps: 8 | Train Loss: 1.578 Vali Loss: 1.721 Vali Acc: 0.416 Test Loss: 1.721 Test Acc: 0.416
Validation loss decreased (-0.387482 --> -0.415608).  Saving model ...
Epoch: 6 cost time: 2.7851004600524902
Epoch: 6, Steps: 8 | Train Loss: 1.420 Vali Loss: 1.630 Vali Acc: 0.406 Test Loss: 1.630 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6622111797332764
Epoch: 7, Steps: 8 | Train Loss: 1.240 Vali Loss: 1.513 Vali Acc: 0.469 Test Loss: 1.513 Test Acc: 0.469
Validation loss decreased (-0.415608 --> -0.468735).  Saving model ...
Epoch: 8 cost time: 2.448967933654785
Epoch: 8, Steps: 8 | Train Loss: 1.052 Vali Loss: 1.417 Vali Acc: 0.494 Test Loss: 1.417 Test Acc: 0.494
Validation loss decreased (-0.468735 --> -0.493736).  Saving model ...
Epoch: 9 cost time: 3.1102640628814697
Epoch: 9, Steps: 8 | Train Loss: 0.910 Vali Loss: 1.360 Vali Acc: 0.516 Test Loss: 1.360 Test Acc: 0.516
Validation loss decreased (-0.493736 --> -0.515611).  Saving model ...
Epoch: 10 cost time: 2.8879504203796387
Epoch: 10, Steps: 8 | Train Loss: 0.727 Vali Loss: 1.328 Vali Acc: 0.494 Test Loss: 1.328 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0215225219726562
Epoch: 11, Steps: 8 | Train Loss: 0.619 Vali Loss: 1.284 Vali Acc: 0.497 Test Loss: 1.284 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.322781801223755
Epoch: 12, Steps: 8 | Train Loss: 0.488 Vali Loss: 1.252 Vali Acc: 0.516 Test Loss: 1.252 Test Acc: 0.516
Validation loss decreased (-0.515611 --> -0.515612).  Saving model ...
Epoch: 13 cost time: 3.198643684387207
Epoch: 13, Steps: 8 | Train Loss: 0.417 Vali Loss: 1.277 Vali Acc: 0.512 Test Loss: 1.277 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3058342933654785
Epoch: 14, Steps: 8 | Train Loss: 0.318 Vali Loss: 1.268 Vali Acc: 0.562 Test Loss: 1.268 Test Acc: 0.562
Validation loss decreased (-0.515612 --> -0.562487).  Saving model ...
Epoch: 15 cost time: 2.9236645698547363
Epoch: 15, Steps: 8 | Train Loss: 0.337 Vali Loss: 1.234 Vali Acc: 0.556 Test Loss: 1.234 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.168355941772461
Epoch: 16, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.271 Vali Acc: 0.547 Test Loss: 1.271 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7688024044036865
Epoch: 17, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.306 Vali Acc: 0.506 Test Loss: 1.306 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7887279987335205
Epoch: 18, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.182 Vali Acc: 0.575 Test Loss: 1.182 Test Acc: 0.575
Validation loss decreased (-0.562487 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 2.961552619934082
Epoch: 19, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.334 Vali Acc: 0.522 Test Loss: 1.334 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.872920036315918
Epoch: 20, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.211 Vali Acc: 0.556 Test Loss: 1.211 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.985116958618164
Epoch: 21, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.294 Vali Acc: 0.547 Test Loss: 1.294 Test Acc: 0.547
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.8489081859588623
Epoch: 22, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.307 Vali Acc: 0.534 Test Loss: 1.307 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.8815674781799316
Epoch: 23, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.194 Vali Acc: 0.591 Test Loss: 1.194 Test Acc: 0.591
Validation loss decreased (-0.574988 --> -0.590613).  Saving model ...
Epoch: 24 cost time: 2.785311460494995
Epoch: 24, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.436 Vali Acc: 0.541 Test Loss: 1.436 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4737637042999268
Epoch: 25, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.237 Vali Acc: 0.566 Test Loss: 1.237 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.61002516746521
Epoch: 26, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.323 Vali Acc: 0.566 Test Loss: 1.323 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.6908249855041504
Epoch: 27, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.284 Vali Acc: 0.566 Test Loss: 1.284 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.79675555229187
Epoch: 28, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.377 Vali Acc: 0.562 Test Loss: 1.377 Test Acc: 0.562
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.0258188247680664
Epoch: 29, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.355 Vali Acc: 0.559 Test Loss: 1.355 Test Acc: 0.559
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.8785533905029297
Epoch: 30, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.363 Vali Acc: 0.559 Test Loss: 1.363 Test Acc: 0.559
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.163956880569458
Epoch: 31, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.426 Vali Acc: 0.556 Test Loss: 1.426 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.366018295288086
Epoch: 32, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.331 Vali Acc: 0.569 Test Loss: 1.331 Test Acc: 0.569
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.4247684478759766
Epoch: 33, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.335 Vali Acc: 0.588 Test Loss: 1.335 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.590625
model parameter : 516680
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.385619878768921
Epoch: 1, Steps: 8 | Train Loss: 2.149 Vali Loss: 2.114 Vali Acc: 0.178 Test Loss: 2.114 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 2.5638437271118164
Epoch: 2, Steps: 8 | Train Loss: 2.086 Vali Loss: 2.056 Vali Acc: 0.184 Test Loss: 2.056 Test Acc: 0.184
Validation loss decreased (-0.178104 --> -0.184354).  Saving model ...
Epoch: 3 cost time: 2.83786678314209
Epoch: 3, Steps: 8 | Train Loss: 2.034 Vali Loss: 2.001 Vali Acc: 0.303 Test Loss: 2.001 Test Acc: 0.303
Validation loss decreased (-0.184354 --> -0.303105).  Saving model ...
Epoch: 4 cost time: 2.9646451473236084
Epoch: 4, Steps: 8 | Train Loss: 1.913 Vali Loss: 1.945 Vali Acc: 0.225 Test Loss: 1.945 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.911705255508423
Epoch: 5, Steps: 8 | Train Loss: 1.753 Vali Loss: 1.872 Vali Acc: 0.400 Test Loss: 1.872 Test Acc: 0.400
Validation loss decreased (-0.303105 --> -0.399981).  Saving model ...
Epoch: 6 cost time: 2.9199931621551514
Epoch: 6, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.816 Vali Acc: 0.375 Test Loss: 1.816 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.445488691329956
Epoch: 7, Steps: 8 | Train Loss: 1.453 Vali Loss: 1.725 Vali Acc: 0.359 Test Loss: 1.725 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.193179130554199
Epoch: 8, Steps: 8 | Train Loss: 1.315 Vali Loss: 1.641 Vali Acc: 0.434 Test Loss: 1.641 Test Acc: 0.434
Validation loss decreased (-0.399981 --> -0.434359).  Saving model ...
Epoch: 9 cost time: 3.0239973068237305
Epoch: 9, Steps: 8 | Train Loss: 1.111 Vali Loss: 1.565 Vali Acc: 0.438 Test Loss: 1.565 Test Acc: 0.438
Validation loss decreased (-0.434359 --> -0.437484).  Saving model ...
Epoch: 10 cost time: 3.027796983718872
Epoch: 10, Steps: 8 | Train Loss: 0.883 Vali Loss: 1.540 Vali Acc: 0.428 Test Loss: 1.540 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5629537105560303
Epoch: 11, Steps: 8 | Train Loss: 0.792 Vali Loss: 1.435 Vali Acc: 0.487 Test Loss: 1.435 Test Acc: 0.487
Validation loss decreased (-0.437484 --> -0.487486).  Saving model ...
Epoch: 12 cost time: 2.6684885025024414
Epoch: 12, Steps: 8 | Train Loss: 0.627 Vali Loss: 1.379 Vali Acc: 0.463 Test Loss: 1.379 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8557751178741455
Epoch: 13, Steps: 8 | Train Loss: 0.563 Vali Loss: 1.366 Vali Acc: 0.484 Test Loss: 1.366 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7763044834136963
Epoch: 14, Steps: 8 | Train Loss: 0.435 Vali Loss: 1.269 Vali Acc: 0.553 Test Loss: 1.269 Test Acc: 0.553
Validation loss decreased (-0.487486 --> -0.553112).  Saving model ...
Epoch: 15 cost time: 2.8595292568206787
Epoch: 15, Steps: 8 | Train Loss: 0.413 Vali Loss: 1.203 Vali Acc: 0.581 Test Loss: 1.203 Test Acc: 0.581
Validation loss decreased (-0.553112 --> -0.581238).  Saving model ...
Epoch: 16 cost time: 2.6966471672058105
Epoch: 16, Steps: 8 | Train Loss: 0.352 Vali Loss: 1.320 Vali Acc: 0.481 Test Loss: 1.320 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.932976722717285
Epoch: 17, Steps: 8 | Train Loss: 0.313 Vali Loss: 1.313 Vali Acc: 0.528 Test Loss: 1.313 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0924060344696045
Epoch: 18, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.180 Vali Acc: 0.566 Test Loss: 1.180 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.2188971042633057
Epoch: 19, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.478 Vali Acc: 0.422 Test Loss: 1.478 Test Acc: 0.422
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.2345707416534424
Epoch: 20, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.341 Vali Acc: 0.525 Test Loss: 1.341 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.237084150314331
Epoch: 21, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.429 Vali Acc: 0.450 Test Loss: 1.429 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.666473150253296
Epoch: 22, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.514 Vali Acc: 0.453 Test Loss: 1.514 Test Acc: 0.453
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.1430718898773193
Epoch: 23, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.204 Vali Acc: 0.619 Test Loss: 1.204 Test Acc: 0.619
Validation loss decreased (-0.581238 --> -0.618738).  Saving model ...
Epoch: 24 cost time: 2.699873447418213
Epoch: 24, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.549 Vali Acc: 0.441 Test Loss: 1.549 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.6185195446014404
Epoch: 25, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.377 Vali Acc: 0.547 Test Loss: 1.377 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.9039862155914307
Epoch: 26, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.425 Vali Acc: 0.528 Test Loss: 1.425 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.9203007221221924
Epoch: 27, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.546 Vali Acc: 0.463 Test Loss: 1.546 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.771087169647217
Epoch: 28, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.460 Vali Acc: 0.519 Test Loss: 1.460 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.992011070251465
Epoch: 29, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.422 Vali Acc: 0.534 Test Loss: 1.422 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.25126314163208
Epoch: 30, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.529 Vali Acc: 0.512 Test Loss: 1.529 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.245100259780884
Epoch: 31, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.399 Vali Acc: 0.531 Test Loss: 1.399 Test Acc: 0.531
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.9643919467926025
Epoch: 32, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.503 Vali Acc: 0.503 Test Loss: 1.503 Test Acc: 0.503
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.169255495071411
Epoch: 33, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.429 Vali Acc: 0.509 Test Loss: 1.429 Test Acc: 0.509
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.61875
model parameter : 516680
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.345482349395752
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 2.117 Vali Acc: 0.116 Test Loss: 2.117 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 2.7837400436401367
Epoch: 2, Steps: 8 | Train Loss: 2.118 Vali Loss: 2.068 Vali Acc: 0.131 Test Loss: 2.068 Test Acc: 0.131
Validation loss decreased (-0.115604 --> -0.131229).  Saving model ...
Epoch: 3 cost time: 2.750694513320923
Epoch: 3, Steps: 8 | Train Loss: 2.043 Vali Loss: 2.031 Vali Acc: 0.197 Test Loss: 2.031 Test Acc: 0.197
Validation loss decreased (-0.131229 --> -0.196855).  Saving model ...
Epoch: 4 cost time: 2.8134140968322754
Epoch: 4, Steps: 8 | Train Loss: 1.950 Vali Loss: 1.995 Vali Acc: 0.259 Test Loss: 1.995 Test Acc: 0.259
Validation loss decreased (-0.196855 --> -0.259355).  Saving model ...
Epoch: 5 cost time: 2.8274989128112793
Epoch: 5, Steps: 8 | Train Loss: 1.742 Vali Loss: 1.954 Vali Acc: 0.341 Test Loss: 1.954 Test Acc: 0.341
Validation loss decreased (-0.259355 --> -0.340605).  Saving model ...
Epoch: 6 cost time: 3.0378692150115967
Epoch: 6, Steps: 8 | Train Loss: 1.623 Vali Loss: 1.925 Vali Acc: 0.300 Test Loss: 1.925 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0802247524261475
Epoch: 7, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.856 Vali Acc: 0.334 Test Loss: 1.856 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.975769519805908
Epoch: 8, Steps: 8 | Train Loss: 1.395 Vali Loss: 1.784 Vali Acc: 0.347 Test Loss: 1.784 Test Acc: 0.347
Validation loss decreased (-0.340605 --> -0.346857).  Saving model ...
Epoch: 9 cost time: 2.8821306228637695
Epoch: 9, Steps: 8 | Train Loss: 1.187 Vali Loss: 1.737 Vali Acc: 0.397 Test Loss: 1.737 Test Acc: 0.397
Validation loss decreased (-0.346857 --> -0.396858).  Saving model ...
Epoch: 10 cost time: 2.807746171951294
Epoch: 10, Steps: 8 | Train Loss: 0.983 Vali Loss: 1.679 Vali Acc: 0.425 Test Loss: 1.679 Test Acc: 0.425
Validation loss decreased (-0.396858 --> -0.424983).  Saving model ...
Epoch: 11 cost time: 2.9296791553497314
Epoch: 11, Steps: 8 | Train Loss: 0.861 Vali Loss: 1.612 Vali Acc: 0.400 Test Loss: 1.612 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7360310554504395
Epoch: 12, Steps: 8 | Train Loss: 0.698 Vali Loss: 1.539 Vali Acc: 0.431 Test Loss: 1.539 Test Acc: 0.431
Validation loss decreased (-0.424983 --> -0.431235).  Saving model ...
Epoch: 13 cost time: 2.6913387775421143
Epoch: 13, Steps: 8 | Train Loss: 0.629 Vali Loss: 1.518 Vali Acc: 0.453 Test Loss: 1.518 Test Acc: 0.453
Validation loss decreased (-0.431235 --> -0.453110).  Saving model ...
Epoch: 14 cost time: 2.9101369380950928
Epoch: 14, Steps: 8 | Train Loss: 0.522 Vali Loss: 1.427 Vali Acc: 0.463 Test Loss: 1.427 Test Acc: 0.463
Validation loss decreased (-0.453110 --> -0.462486).  Saving model ...
Epoch: 15 cost time: 2.9046475887298584
Epoch: 15, Steps: 8 | Train Loss: 0.522 Vali Loss: 1.421 Vali Acc: 0.463 Test Loss: 1.421 Test Acc: 0.463
Validation loss decreased (-0.462486 --> -0.462486).  Saving model ...
Epoch: 16 cost time: 3.3275744915008545
Epoch: 16, Steps: 8 | Train Loss: 0.423 Vali Loss: 1.390 Vali Acc: 0.487 Test Loss: 1.390 Test Acc: 0.487
Validation loss decreased (-0.462486 --> -0.487486).  Saving model ...
Epoch: 17 cost time: 2.9481682777404785
Epoch: 17, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.405 Vali Acc: 0.459 Test Loss: 1.405 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.569350242614746
Epoch: 18, Steps: 8 | Train Loss: 0.326 Vali Loss: 1.268 Vali Acc: 0.528 Test Loss: 1.268 Test Acc: 0.528
Validation loss decreased (-0.487486 --> -0.528112).  Saving model ...
Epoch: 19 cost time: 2.6135058403015137
Epoch: 19, Steps: 8 | Train Loss: 0.299 Vali Loss: 1.343 Vali Acc: 0.494 Test Loss: 1.343 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.727503776550293
Epoch: 20, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.290 Vali Acc: 0.506 Test Loss: 1.290 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4219069480895996
Epoch: 21, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.390 Vali Acc: 0.481 Test Loss: 1.390 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.6371331214904785
Epoch: 22, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.511 Vali Acc: 0.472 Test Loss: 1.511 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.917184591293335
Epoch: 23, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.424 Vali Acc: 0.528 Test Loss: 1.424 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.867276191711426
Epoch: 24, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.591 Vali Acc: 0.469 Test Loss: 1.591 Test Acc: 0.469
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1297616958618164
Epoch: 25, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.467 Vali Acc: 0.512 Test Loss: 1.467 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7910759449005127
Epoch: 26, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.551 Vali Acc: 0.503 Test Loss: 1.551 Test Acc: 0.503
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.588245153427124
Epoch: 27, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.524 Vali Acc: 0.503 Test Loss: 1.524 Test Acc: 0.503
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.7142865657806396
Epoch: 28, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.572 Vali Acc: 0.494 Test Loss: 1.572 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.528125
model parameter : 516680
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.203632831573486
Epoch: 1, Steps: 8 | Train Loss: 2.178 Vali Loss: 2.118 Vali Acc: 0.125 Test Loss: 2.118 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 2.5930047035217285
Epoch: 2, Steps: 8 | Train Loss: 2.110 Vali Loss: 2.080 Vali Acc: 0.138 Test Loss: 2.080 Test Acc: 0.138
Validation loss decreased (-0.124979 --> -0.137479).  Saving model ...
Epoch: 3 cost time: 3.0060782432556152
Epoch: 3, Steps: 8 | Train Loss: 2.005 Vali Loss: 2.051 Vali Acc: 0.125 Test Loss: 2.051 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8520803451538086
Epoch: 4, Steps: 8 | Train Loss: 1.972 Vali Loss: 2.024 Vali Acc: 0.184 Test Loss: 2.024 Test Acc: 0.184
Validation loss decreased (-0.137479 --> -0.184355).  Saving model ...
Epoch: 5 cost time: 2.8798885345458984
Epoch: 5, Steps: 8 | Train Loss: 1.763 Vali Loss: 1.986 Vali Acc: 0.272 Test Loss: 1.986 Test Acc: 0.272
Validation loss decreased (-0.184355 --> -0.271855).  Saving model ...
Epoch: 6 cost time: 3.050344944000244
Epoch: 6, Steps: 8 | Train Loss: 1.628 Vali Loss: 1.959 Vali Acc: 0.300 Test Loss: 1.959 Test Acc: 0.300
Validation loss decreased (-0.271855 --> -0.299980).  Saving model ...
Epoch: 7 cost time: 2.9180667400360107
Epoch: 7, Steps: 8 | Train Loss: 1.526 Vali Loss: 1.921 Vali Acc: 0.297 Test Loss: 1.921 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.638939380645752
Epoch: 8, Steps: 8 | Train Loss: 1.409 Vali Loss: 1.870 Vali Acc: 0.297 Test Loss: 1.870 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.770244836807251
Epoch: 9, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.830 Vali Acc: 0.325 Test Loss: 1.830 Test Acc: 0.325
Validation loss decreased (-0.299980 --> -0.324982).  Saving model ...
Epoch: 10 cost time: 2.8986527919769287
Epoch: 10, Steps: 8 | Train Loss: 1.013 Vali Loss: 1.804 Vali Acc: 0.353 Test Loss: 1.804 Test Acc: 0.353
Validation loss decreased (-0.324982 --> -0.353107).  Saving model ...
Epoch: 11 cost time: 2.8568639755249023
Epoch: 11, Steps: 8 | Train Loss: 0.894 Vali Loss: 1.738 Vali Acc: 0.375 Test Loss: 1.738 Test Acc: 0.375
Validation loss decreased (-0.353107 --> -0.374983).  Saving model ...
Epoch: 12 cost time: 3.115865707397461
Epoch: 12, Steps: 8 | Train Loss: 0.738 Vali Loss: 1.674 Vali Acc: 0.438 Test Loss: 1.674 Test Acc: 0.438
Validation loss decreased (-0.374983 --> -0.437483).  Saving model ...
Epoch: 13 cost time: 3.076695203781128
Epoch: 13, Steps: 8 | Train Loss: 0.685 Vali Loss: 1.655 Vali Acc: 0.378 Test Loss: 1.655 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8869855403900146
Epoch: 14, Steps: 8 | Train Loss: 0.577 Vali Loss: 1.596 Vali Acc: 0.434 Test Loss: 1.596 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.125880718231201
Epoch: 15, Steps: 8 | Train Loss: 0.570 Vali Loss: 1.570 Vali Acc: 0.428 Test Loss: 1.570 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.679600477218628
Epoch: 16, Steps: 8 | Train Loss: 0.463 Vali Loss: 1.508 Vali Acc: 0.444 Test Loss: 1.508 Test Acc: 0.444
Validation loss decreased (-0.437483 --> -0.443735).  Saving model ...
Epoch: 17 cost time: 2.696913719177246
Epoch: 17, Steps: 8 | Train Loss: 0.436 Vali Loss: 1.554 Vali Acc: 0.384 Test Loss: 1.554 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.802379608154297
Epoch: 18, Steps: 8 | Train Loss: 0.395 Vali Loss: 1.404 Vali Acc: 0.487 Test Loss: 1.404 Test Acc: 0.487
Validation loss decreased (-0.443735 --> -0.487486).  Saving model ...
Epoch: 19 cost time: 2.735511064529419
Epoch: 19, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.480 Vali Acc: 0.428 Test Loss: 1.480 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1028223037719727
Epoch: 20, Steps: 8 | Train Loss: 0.314 Vali Loss: 1.564 Vali Acc: 0.338 Test Loss: 1.564 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.289564847946167
Epoch: 21, Steps: 8 | Train Loss: 0.287 Vali Loss: 1.393 Vali Acc: 0.431 Test Loss: 1.393 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.114119291305542
Epoch: 22, Steps: 8 | Train Loss: 0.254 Vali Loss: 1.586 Vali Acc: 0.388 Test Loss: 1.586 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.143913984298706
Epoch: 23, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.505 Vali Acc: 0.419 Test Loss: 1.505 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2249398231506348
Epoch: 24, Steps: 8 | Train Loss: 0.208 Vali Loss: 1.548 Vali Acc: 0.434 Test Loss: 1.548 Test Acc: 0.434
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.2768611907958984
Epoch: 25, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.470 Vali Acc: 0.456 Test Loss: 1.470 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.824711322784424
Epoch: 26, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.533 Vali Acc: 0.450 Test Loss: 1.533 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.796255588531494
Epoch: 27, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.509 Vali Acc: 0.450 Test Loss: 1.509 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.6996970176696777
Epoch: 28, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.524 Vali Acc: 0.466 Test Loss: 1.524 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.4875
model parameter : 516680
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.097466707229614
Epoch: 1, Steps: 8 | Train Loss: 2.170 Vali Loss: 2.136 Vali Acc: 0.113 Test Loss: 2.136 Test Acc: 0.113
Validation loss decreased (inf --> -0.112479).  Saving model ...
Epoch: 2 cost time: 2.6292383670806885
Epoch: 2, Steps: 8 | Train Loss: 2.181 Vali Loss: 2.113 Vali Acc: 0.128 Test Loss: 2.113 Test Acc: 0.128
Validation loss decreased (-0.112479 --> -0.128104).  Saving model ...
Epoch: 3 cost time: 2.541455030441284
Epoch: 3, Steps: 8 | Train Loss: 2.012 Vali Loss: 2.091 Vali Acc: 0.138 Test Loss: 2.091 Test Acc: 0.138
Validation loss decreased (-0.128104 --> -0.137479).  Saving model ...
Epoch: 4 cost time: 2.918926954269409
Epoch: 4, Steps: 8 | Train Loss: 1.950 Vali Loss: 2.067 Vali Acc: 0.156 Test Loss: 2.067 Test Acc: 0.156
Validation loss decreased (-0.137479 --> -0.156229).  Saving model ...
Epoch: 5 cost time: 2.627337694168091
Epoch: 5, Steps: 8 | Train Loss: 1.824 Vali Loss: 2.028 Vali Acc: 0.153 Test Loss: 2.028 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6397979259490967
Epoch: 6, Steps: 8 | Train Loss: 1.718 Vali Loss: 1.981 Vali Acc: 0.200 Test Loss: 1.981 Test Acc: 0.200
Validation loss decreased (-0.156229 --> -0.199980).  Saving model ...
Epoch: 7 cost time: 2.45647931098938
Epoch: 7, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.941 Vali Acc: 0.250 Test Loss: 1.941 Test Acc: 0.250
Validation loss decreased (-0.199980 --> -0.249981).  Saving model ...
Epoch: 8 cost time: 2.7046287059783936
Epoch: 8, Steps: 8 | Train Loss: 1.477 Vali Loss: 1.897 Vali Acc: 0.303 Test Loss: 1.897 Test Acc: 0.303
Validation loss decreased (-0.249981 --> -0.303106).  Saving model ...
Epoch: 9 cost time: 2.6926162242889404
Epoch: 9, Steps: 8 | Train Loss: 1.324 Vali Loss: 1.851 Vali Acc: 0.322 Test Loss: 1.851 Test Acc: 0.322
Validation loss decreased (-0.303106 --> -0.321856).  Saving model ...
Epoch: 10 cost time: 2.738225221633911
Epoch: 10, Steps: 8 | Train Loss: 1.163 Vali Loss: 1.822 Vali Acc: 0.338 Test Loss: 1.822 Test Acc: 0.338
Validation loss decreased (-0.321856 --> -0.337482).  Saving model ...
Epoch: 11 cost time: 2.8940765857696533
Epoch: 11, Steps: 8 | Train Loss: 1.048 Vali Loss: 1.773 Vali Acc: 0.341 Test Loss: 1.773 Test Acc: 0.341
Validation loss decreased (-0.337482 --> -0.340607).  Saving model ...
Epoch: 12 cost time: 2.7025461196899414
Epoch: 12, Steps: 8 | Train Loss: 0.957 Vali Loss: 1.711 Vali Acc: 0.403 Test Loss: 1.711 Test Acc: 0.403
Validation loss decreased (-0.340607 --> -0.403108).  Saving model ...
Epoch: 13 cost time: 2.9191980361938477
Epoch: 13, Steps: 8 | Train Loss: 0.840 Vali Loss: 1.685 Vali Acc: 0.306 Test Loss: 1.685 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9214770793914795
Epoch: 14, Steps: 8 | Train Loss: 0.690 Vali Loss: 1.607 Vali Acc: 0.400 Test Loss: 1.607 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6670496463775635
Epoch: 15, Steps: 8 | Train Loss: 0.631 Vali Loss: 1.575 Vali Acc: 0.416 Test Loss: 1.575 Test Acc: 0.416
Validation loss decreased (-0.403108 --> -0.415609).  Saving model ...
Epoch: 16 cost time: 2.7682597637176514
Epoch: 16, Steps: 8 | Train Loss: 0.574 Vali Loss: 1.541 Vali Acc: 0.409 Test Loss: 1.541 Test Acc: 0.409
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.054198741912842
Epoch: 17, Steps: 8 | Train Loss: 0.544 Vali Loss: 1.588 Vali Acc: 0.359 Test Loss: 1.588 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6714444160461426
Epoch: 18, Steps: 8 | Train Loss: 0.493 Vali Loss: 1.469 Vali Acc: 0.466 Test Loss: 1.469 Test Acc: 0.466
Validation loss decreased (-0.415609 --> -0.465610).  Saving model ...
Epoch: 19 cost time: 2.9632785320281982
Epoch: 19, Steps: 8 | Train Loss: 0.414 Vali Loss: 1.449 Vali Acc: 0.459 Test Loss: 1.449 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8859500885009766
Epoch: 20, Steps: 8 | Train Loss: 0.383 Vali Loss: 1.456 Vali Acc: 0.444 Test Loss: 1.456 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1886305809020996
Epoch: 21, Steps: 8 | Train Loss: 0.352 Vali Loss: 1.448 Vali Acc: 0.459 Test Loss: 1.448 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.096100091934204
Epoch: 22, Steps: 8 | Train Loss: 0.312 Vali Loss: 1.472 Vali Acc: 0.459 Test Loss: 1.472 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.015979051589966
Epoch: 23, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.435 Vali Acc: 0.497 Test Loss: 1.435 Test Acc: 0.497
Validation loss decreased (-0.465610 --> -0.496861).  Saving model ...
Epoch: 24 cost time: 2.84383487701416
Epoch: 24, Steps: 8 | Train Loss: 0.261 Vali Loss: 1.519 Vali Acc: 0.444 Test Loss: 1.519 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7712011337280273
Epoch: 25, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.558 Vali Acc: 0.431 Test Loss: 1.558 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.55556321144104
Epoch: 26, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.479 Vali Acc: 0.453 Test Loss: 1.479 Test Acc: 0.453
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.670388698577881
Epoch: 27, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.456 Vali Acc: 0.481 Test Loss: 1.456 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.642503261566162
Epoch: 28, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.548 Vali Acc: 0.438 Test Loss: 1.548 Test Acc: 0.438
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.605700731277466
Epoch: 29, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.595 Vali Acc: 0.419 Test Loss: 1.595 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.853539228439331
Epoch: 30, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.551 Vali Acc: 0.441 Test Loss: 1.551 Test Acc: 0.441
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.9180374145507812
Epoch: 31, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.671 Vali Acc: 0.416 Test Loss: 1.671 Test Acc: 0.416
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.069607973098755
Epoch: 32, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.671 Vali Acc: 0.438 Test Loss: 1.671 Test Acc: 0.438
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.084599256515503
Epoch: 33, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.657 Vali Acc: 0.456 Test Loss: 1.657 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.496875
model parameter : 516680
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.475058317184448
Epoch: 1, Steps: 8 | Train Loss: 2.184 Vali Loss: 2.155 Vali Acc: 0.125 Test Loss: 2.155 Test Acc: 0.125
Validation loss decreased (inf --> -0.124978).  Saving model ...
Epoch: 2 cost time: 2.8981752395629883
Epoch: 2, Steps: 8 | Train Loss: 2.092 Vali Loss: 2.146 Vali Acc: 0.128 Test Loss: 2.146 Test Acc: 0.128
Validation loss decreased (-0.124978 --> -0.128104).  Saving model ...
Epoch: 3 cost time: 2.9772837162017822
Epoch: 3, Steps: 8 | Train Loss: 2.079 Vali Loss: 2.130 Vali Acc: 0.134 Test Loss: 2.130 Test Acc: 0.134
Validation loss decreased (-0.128104 --> -0.134354).  Saving model ...
Epoch: 4 cost time: 2.6890456676483154
Epoch: 4, Steps: 8 | Train Loss: 2.030 Vali Loss: 2.102 Vali Acc: 0.147 Test Loss: 2.102 Test Acc: 0.147
Validation loss decreased (-0.134354 --> -0.146854).  Saving model ...
Epoch: 5 cost time: 2.939859390258789
Epoch: 5, Steps: 8 | Train Loss: 1.924 Vali Loss: 2.079 Vali Acc: 0.153 Test Loss: 2.079 Test Acc: 0.153
Validation loss decreased (-0.146854 --> -0.153104).  Saving model ...
Epoch: 6 cost time: 3.177480459213257
Epoch: 6, Steps: 8 | Train Loss: 1.816 Vali Loss: 2.067 Vali Acc: 0.144 Test Loss: 2.067 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9821267127990723
Epoch: 7, Steps: 8 | Train Loss: 1.687 Vali Loss: 2.036 Vali Acc: 0.153 Test Loss: 2.036 Test Acc: 0.153
Validation loss decreased (-0.153104 --> -0.153105).  Saving model ...
Epoch: 8 cost time: 2.964437961578369
Epoch: 8, Steps: 8 | Train Loss: 1.586 Vali Loss: 2.005 Vali Acc: 0.153 Test Loss: 2.005 Test Acc: 0.153
Validation loss decreased (-0.153105 --> -0.153105).  Saving model ...
Epoch: 9 cost time: 2.56301212310791
Epoch: 9, Steps: 8 | Train Loss: 1.439 Vali Loss: 1.979 Vali Acc: 0.206 Test Loss: 1.979 Test Acc: 0.206
Validation loss decreased (-0.153105 --> -0.206230).  Saving model ...
Epoch: 10 cost time: 2.5979576110839844
Epoch: 10, Steps: 8 | Train Loss: 1.288 Vali Loss: 1.973 Vali Acc: 0.134 Test Loss: 1.973 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8018343448638916
Epoch: 11, Steps: 8 | Train Loss: 1.140 Vali Loss: 1.928 Vali Acc: 0.172 Test Loss: 1.928 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.686069965362549
Epoch: 12, Steps: 8 | Train Loss: 1.066 Vali Loss: 1.888 Vali Acc: 0.138 Test Loss: 1.888 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8027000427246094
Epoch: 13, Steps: 8 | Train Loss: 0.963 Vali Loss: 1.919 Vali Acc: 0.141 Test Loss: 1.919 Test Acc: 0.141
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0084898471832275
Epoch: 14, Steps: 8 | Train Loss: 0.876 Vali Loss: 1.877 Vali Acc: 0.228 Test Loss: 1.877 Test Acc: 0.228
Validation loss decreased (-0.206230 --> -0.228106).  Saving model ...
Epoch: 15 cost time: 3.3441739082336426
Epoch: 15, Steps: 8 | Train Loss: 0.822 Vali Loss: 1.767 Vali Acc: 0.263 Test Loss: 1.767 Test Acc: 0.263
Validation loss decreased (-0.228106 --> -0.262482).  Saving model ...
Epoch: 16 cost time: 3.3167335987091064
Epoch: 16, Steps: 8 | Train Loss: 0.701 Vali Loss: 1.701 Vali Acc: 0.300 Test Loss: 1.701 Test Acc: 0.300
Validation loss decreased (-0.262482 --> -0.299983).  Saving model ...
Epoch: 17 cost time: 2.930906057357788
Epoch: 17, Steps: 8 | Train Loss: 0.664 Vali Loss: 1.808 Vali Acc: 0.172 Test Loss: 1.808 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.020801067352295
Epoch: 18, Steps: 8 | Train Loss: 0.602 Vali Loss: 1.670 Vali Acc: 0.284 Test Loss: 1.670 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7269046306610107
Epoch: 19, Steps: 8 | Train Loss: 0.546 Vali Loss: 1.695 Vali Acc: 0.294 Test Loss: 1.695 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.78358793258667
Epoch: 20, Steps: 8 | Train Loss: 0.503 Vali Loss: 1.723 Vali Acc: 0.306 Test Loss: 1.723 Test Acc: 0.306
Validation loss decreased (-0.299983 --> -0.306233).  Saving model ...
Epoch: 21 cost time: 2.902557849884033
Epoch: 21, Steps: 8 | Train Loss: 0.472 Vali Loss: 1.592 Vali Acc: 0.378 Test Loss: 1.592 Test Acc: 0.378
Validation loss decreased (-0.306233 --> -0.378109).  Saving model ...
Epoch: 22 cost time: 2.937877655029297
Epoch: 22, Steps: 8 | Train Loss: 0.387 Vali Loss: 1.637 Vali Acc: 0.334 Test Loss: 1.637 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.79730224609375
Epoch: 23, Steps: 8 | Train Loss: 0.408 Vali Loss: 1.601 Vali Acc: 0.372 Test Loss: 1.601 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.720503568649292
Epoch: 24, Steps: 8 | Train Loss: 0.340 Vali Loss: 1.617 Vali Acc: 0.350 Test Loss: 1.617 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0313479900360107
Epoch: 25, Steps: 8 | Train Loss: 0.333 Vali Loss: 1.627 Vali Acc: 0.350 Test Loss: 1.627 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.0182650089263916
Epoch: 26, Steps: 8 | Train Loss: 0.283 Vali Loss: 1.629 Vali Acc: 0.328 Test Loss: 1.629 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.2492644786834717
Epoch: 27, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.600 Vali Acc: 0.375 Test Loss: 1.600 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.431751012802124
Epoch: 28, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.663 Vali Acc: 0.359 Test Loss: 1.663 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.2169864177703857
Epoch: 29, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.643 Vali Acc: 0.384 Test Loss: 1.643 Test Acc: 0.384
Validation loss decreased (-0.378109 --> -0.384359).  Saving model ...
Epoch: 30 cost time: 3.10150146484375
Epoch: 30, Steps: 8 | Train Loss: 0.257 Vali Loss: 1.698 Vali Acc: 0.366 Test Loss: 1.698 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.5788121223449707
Epoch: 31, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.753 Vali Acc: 0.372 Test Loss: 1.753 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.9304263591766357
Epoch: 32, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.733 Vali Acc: 0.375 Test Loss: 1.733 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.847053050994873
Epoch: 33, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.692 Vali Acc: 0.409 Test Loss: 1.692 Test Acc: 0.409
Validation loss decreased (-0.384359 --> -0.409358).  Saving model ...
Epoch: 34 cost time: 2.705207586288452
Epoch: 34, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.822 Vali Acc: 0.381 Test Loss: 1.822 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.669222593307495
Epoch: 35, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.757 Vali Acc: 0.381 Test Loss: 1.757 Test Acc: 0.381
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.556227207183838
Epoch: 36, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.728 Vali Acc: 0.409 Test Loss: 1.728 Test Acc: 0.409
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.8123703002929688
Epoch: 37, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.784 Vali Acc: 0.406 Test Loss: 1.784 Test Acc: 0.406
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.104532241821289
Epoch: 38, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.948 Vali Acc: 0.384 Test Loss: 1.948 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.084662914276123
Epoch: 39, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.849 Vali Acc: 0.403 Test Loss: 1.849 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.0367591381073
Epoch: 40, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.861 Vali Acc: 0.381 Test Loss: 1.861 Test Acc: 0.381
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.1400790214538574
Epoch: 41, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.911 Vali Acc: 0.409 Test Loss: 1.911 Test Acc: 0.409
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.9667341709136963
Epoch: 42, Steps: 8 | Train Loss: 0.089 Vali Loss: 2.006 Vali Acc: 0.388 Test Loss: 2.006 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.7589783668518066
Epoch: 43, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.940 Vali Acc: 0.381 Test Loss: 1.940 Test Acc: 0.381
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.409375
model parameter : 516680
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.119293451309204
Epoch: 1, Steps: 8 | Train Loss: 2.108 Vali Loss: 1.984 Vali Acc: 0.259 Test Loss: 1.984 Test Acc: 0.259
Validation loss decreased (inf --> -0.259355).  Saving model ...
Epoch: 2 cost time: 2.7693305015563965
Epoch: 2, Steps: 8 | Train Loss: 1.888 Vali Loss: 1.660 Vali Acc: 0.550 Test Loss: 1.660 Test Acc: 0.550
Validation loss decreased (-0.259355 --> -0.549983).  Saving model ...
Epoch: 3 cost time: 2.6542229652404785
Epoch: 3, Steps: 8 | Train Loss: 1.501 Vali Loss: 1.326 Vali Acc: 0.675 Test Loss: 1.326 Test Acc: 0.675
Validation loss decreased (-0.549983 --> -0.674987).  Saving model ...
Epoch: 4 cost time: 2.600740909576416
Epoch: 4, Steps: 8 | Train Loss: 1.186 Vali Loss: 1.082 Vali Acc: 0.709 Test Loss: 1.082 Test Acc: 0.709
Validation loss decreased (-0.674987 --> -0.709364).  Saving model ...
Epoch: 5 cost time: 2.649135112762451
Epoch: 5, Steps: 8 | Train Loss: 0.848 Vali Loss: 0.900 Vali Acc: 0.762 Test Loss: 0.900 Test Acc: 0.762
Validation loss decreased (-0.709364 --> -0.762491).  Saving model ...
Epoch: 6 cost time: 2.4207663536071777
Epoch: 6, Steps: 8 | Train Loss: 0.661 Vali Loss: 0.785 Vali Acc: 0.784 Test Loss: 0.785 Test Acc: 0.784
Validation loss decreased (-0.762491 --> -0.784367).  Saving model ...
Epoch: 7 cost time: 2.3858611583709717
Epoch: 7, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.715 Vali Acc: 0.778 Test Loss: 0.715 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4556076526641846
Epoch: 8, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.663 Vali Acc: 0.778 Test Loss: 0.663 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7180588245391846
Epoch: 9, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.658 Vali Acc: 0.778 Test Loss: 0.658 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.649413824081421
Epoch: 10, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.661 Vali Acc: 0.787 Test Loss: 0.661 Test Acc: 0.787
Validation loss decreased (-0.784367 --> -0.787493).  Saving model ...
Epoch: 11 cost time: 2.8623552322387695
Epoch: 11, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.657 Vali Acc: 0.772 Test Loss: 0.657 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9309661388397217
Epoch: 12, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.665 Vali Acc: 0.781 Test Loss: 0.665 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7382490634918213
Epoch: 13, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.696 Vali Acc: 0.775 Test Loss: 0.696 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.075047492980957
Epoch: 14, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.703 Vali Acc: 0.778 Test Loss: 0.703 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7506556510925293
Epoch: 15, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.712 Vali Acc: 0.775 Test Loss: 0.712 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.74409556388855
Epoch: 16, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.733 Vali Acc: 0.778 Test Loss: 0.733 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.519479513168335
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.5655953884124756
Epoch: 18, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.742 Vali Acc: 0.778 Test Loss: 0.742 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.7399044036865234
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.753 Vali Acc: 0.766 Test Loss: 0.753 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.8218472003936768
Epoch: 20, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.754 Vali Acc: 0.772 Test Loss: 0.754 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.7875
model parameter : 320072
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.15572452545166
Epoch: 1, Steps: 8 | Train Loss: 2.083 Vali Loss: 1.998 Vali Acc: 0.234 Test Loss: 1.998 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 2.7677342891693115
Epoch: 2, Steps: 8 | Train Loss: 1.914 Vali Loss: 1.739 Vali Acc: 0.481 Test Loss: 1.739 Test Acc: 0.481
Validation loss decreased (-0.234355 --> -0.481233).  Saving model ...
Epoch: 3 cost time: 2.7656900882720947
Epoch: 3, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.477 Vali Acc: 0.581 Test Loss: 1.477 Test Acc: 0.581
Validation loss decreased (-0.481233 --> -0.581235).  Saving model ...
Epoch: 4 cost time: 2.828267812728882
Epoch: 4, Steps: 8 | Train Loss: 1.328 Vali Loss: 1.281 Vali Acc: 0.625 Test Loss: 1.281 Test Acc: 0.625
Validation loss decreased (-0.581235 --> -0.624987).  Saving model ...
Epoch: 5 cost time: 2.6986300945281982
Epoch: 5, Steps: 8 | Train Loss: 1.018 Vali Loss: 1.124 Vali Acc: 0.666 Test Loss: 1.124 Test Acc: 0.666
Validation loss decreased (-0.624987 --> -0.665614).  Saving model ...
Epoch: 6 cost time: 2.5470986366271973
Epoch: 6, Steps: 8 | Train Loss: 0.808 Vali Loss: 1.008 Vali Acc: 0.700 Test Loss: 1.008 Test Acc: 0.700
Validation loss decreased (-0.665614 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 2.968064785003662
Epoch: 7, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.925 Vali Acc: 0.697 Test Loss: 0.925 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.791511297225952
Epoch: 8, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.861 Vali Acc: 0.713 Test Loss: 0.861 Test Acc: 0.713
Validation loss decreased (-0.699990 --> -0.712491).  Saving model ...
Epoch: 9 cost time: 3.072558641433716
Epoch: 9, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.840 Vali Acc: 0.716 Test Loss: 0.840 Test Acc: 0.716
Validation loss decreased (-0.712491 --> -0.715617).  Saving model ...
Epoch: 10 cost time: 2.685354471206665
Epoch: 10, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.818 Vali Acc: 0.728 Test Loss: 0.818 Test Acc: 0.728
Validation loss decreased (-0.715617 --> -0.728117).  Saving model ...
Epoch: 11 cost time: 2.5130081176757812
Epoch: 11, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.813 Vali Acc: 0.719 Test Loss: 0.813 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5565123558044434
Epoch: 12, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.858 Vali Acc: 0.694 Test Loss: 0.858 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3868672847747803
Epoch: 13, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.862 Vali Acc: 0.709 Test Loss: 0.862 Test Acc: 0.709
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.378894329071045
Epoch: 14, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.872 Vali Acc: 0.697 Test Loss: 0.872 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6076741218566895
Epoch: 15, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.901 Vali Acc: 0.697 Test Loss: 0.901 Test Acc: 0.697
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9768426418304443
Epoch: 16, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.930 Vali Acc: 0.700 Test Loss: 0.930 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.821565866470337
Epoch: 17, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.965 Vali Acc: 0.700 Test Loss: 0.965 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7605464458465576
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.954 Vali Acc: 0.700 Test Loss: 0.954 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.7834877967834473
Epoch: 19, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.939 Vali Acc: 0.697 Test Loss: 0.939 Test Acc: 0.697
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.6087071895599365
Epoch: 20, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.965 Vali Acc: 0.691 Test Loss: 0.965 Test Acc: 0.691
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.728125
model parameter : 320072
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.244657516479492
Epoch: 1, Steps: 8 | Train Loss: 2.117 Vali Loss: 2.046 Vali Acc: 0.225 Test Loss: 2.046 Test Acc: 0.225
Validation loss decreased (inf --> -0.224980).  Saving model ...
Epoch: 2 cost time: 2.8785765171051025
Epoch: 2, Steps: 8 | Train Loss: 2.002 Vali Loss: 1.845 Vali Acc: 0.381 Test Loss: 1.845 Test Acc: 0.381
Validation loss decreased (-0.224980 --> -0.381232).  Saving model ...
Epoch: 3 cost time: 2.7089221477508545
Epoch: 3, Steps: 8 | Train Loss: 1.705 Vali Loss: 1.625 Vali Acc: 0.497 Test Loss: 1.625 Test Acc: 0.497
Validation loss decreased (-0.381232 --> -0.496859).  Saving model ...
Epoch: 4 cost time: 2.8007254600524902
Epoch: 4, Steps: 8 | Train Loss: 1.496 Vali Loss: 1.436 Vali Acc: 0.537 Test Loss: 1.436 Test Acc: 0.537
Validation loss decreased (-0.496859 --> -0.537486).  Saving model ...
Epoch: 5 cost time: 2.4408164024353027
Epoch: 5, Steps: 8 | Train Loss: 1.175 Vali Loss: 1.278 Vali Acc: 0.581 Test Loss: 1.278 Test Acc: 0.581
Validation loss decreased (-0.537486 --> -0.581237).  Saving model ...
Epoch: 6 cost time: 2.590087890625
Epoch: 6, Steps: 8 | Train Loss: 0.944 Vali Loss: 1.165 Vali Acc: 0.578 Test Loss: 1.165 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6151552200317383
Epoch: 7, Steps: 8 | Train Loss: 0.754 Vali Loss: 1.076 Vali Acc: 0.625 Test Loss: 1.076 Test Acc: 0.625
Validation loss decreased (-0.581237 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 2.8134655952453613
Epoch: 8, Steps: 8 | Train Loss: 0.626 Vali Loss: 1.001 Vali Acc: 0.672 Test Loss: 1.001 Test Acc: 0.672
Validation loss decreased (-0.624989 --> -0.671865).  Saving model ...
Epoch: 9 cost time: 2.9985849857330322
Epoch: 9, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.972 Vali Acc: 0.656 Test Loss: 0.972 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.197392702102661
Epoch: 10, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.953 Vali Acc: 0.694 Test Loss: 0.953 Test Acc: 0.694
Validation loss decreased (-0.671865 --> -0.693740).  Saving model ...
Epoch: 11 cost time: 2.8426175117492676
Epoch: 11, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.941 Vali Acc: 0.694 Test Loss: 0.941 Test Acc: 0.694
Validation loss decreased (-0.693740 --> -0.693741).  Saving model ...
Epoch: 12 cost time: 2.884298324584961
Epoch: 12, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.936 Vali Acc: 0.681 Test Loss: 0.936 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8097281455993652
Epoch: 13, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.930 Vali Acc: 0.709 Test Loss: 0.930 Test Acc: 0.709
Validation loss decreased (-0.693741 --> -0.709366).  Saving model ...
Epoch: 14 cost time: 2.7254059314727783
Epoch: 14, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.971 Vali Acc: 0.694 Test Loss: 0.971 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.620285749435425
Epoch: 15, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.010 Vali Acc: 0.681 Test Loss: 1.010 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.626432418823242
Epoch: 16, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.036 Vali Acc: 0.684 Test Loss: 1.036 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.08064866065979
Epoch: 17, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.032 Vali Acc: 0.678 Test Loss: 1.032 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9081177711486816
Epoch: 18, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.036 Vali Acc: 0.672 Test Loss: 1.036 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.052166700363159
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.047 Vali Acc: 0.691 Test Loss: 1.047 Test Acc: 0.691
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.217684507369995
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.078 Vali Acc: 0.688 Test Loss: 1.078 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.9329335689544678
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.092 Vali Acc: 0.681 Test Loss: 1.092 Test Acc: 0.681
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.9684014320373535
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.086 Vali Acc: 0.684 Test Loss: 1.086 Test Acc: 0.684
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.122528553009033
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.084 Vali Acc: 0.688 Test Loss: 1.084 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.709375
model parameter : 320072
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.2994771003723145
Epoch: 1, Steps: 8 | Train Loss: 2.134 Vali Loss: 2.089 Vali Acc: 0.178 Test Loss: 2.089 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 2.8719701766967773
Epoch: 2, Steps: 8 | Train Loss: 2.065 Vali Loss: 1.967 Vali Acc: 0.259 Test Loss: 1.967 Test Acc: 0.259
Validation loss decreased (-0.178104 --> -0.259355).  Saving model ...
Epoch: 3 cost time: 2.7380459308624268
Epoch: 3, Steps: 8 | Train Loss: 1.845 Vali Loss: 1.831 Vali Acc: 0.316 Test Loss: 1.831 Test Acc: 0.316
Validation loss decreased (-0.259355 --> -0.315607).  Saving model ...
Epoch: 4 cost time: 2.8157403469085693
Epoch: 4, Steps: 8 | Train Loss: 1.727 Vali Loss: 1.687 Vali Acc: 0.416 Test Loss: 1.687 Test Acc: 0.416
Validation loss decreased (-0.315607 --> -0.415608).  Saving model ...
Epoch: 5 cost time: 2.5274407863616943
Epoch: 5, Steps: 8 | Train Loss: 1.427 Vali Loss: 1.549 Vali Acc: 0.459 Test Loss: 1.549 Test Acc: 0.459
Validation loss decreased (-0.415608 --> -0.459360).  Saving model ...
Epoch: 6 cost time: 2.89375638961792
Epoch: 6, Steps: 8 | Train Loss: 1.224 Vali Loss: 1.411 Vali Acc: 0.506 Test Loss: 1.411 Test Acc: 0.506
Validation loss decreased (-0.459360 --> -0.506236).  Saving model ...
Epoch: 7 cost time: 2.9727091789245605
Epoch: 7, Steps: 8 | Train Loss: 0.994 Vali Loss: 1.290 Vali Acc: 0.550 Test Loss: 1.290 Test Acc: 0.550
Validation loss decreased (-0.506236 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 3.1559886932373047
Epoch: 8, Steps: 8 | Train Loss: 0.859 Vali Loss: 1.186 Vali Acc: 0.575 Test Loss: 1.186 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 2.7837562561035156
Epoch: 9, Steps: 8 | Train Loss: 0.704 Vali Loss: 1.106 Vali Acc: 0.619 Test Loss: 1.106 Test Acc: 0.619
Validation loss decreased (-0.574988 --> -0.618739).  Saving model ...
Epoch: 10 cost time: 3.346341848373413
Epoch: 10, Steps: 8 | Train Loss: 0.539 Vali Loss: 1.069 Vali Acc: 0.622 Test Loss: 1.069 Test Acc: 0.622
Validation loss decreased (-0.618739 --> -0.621864).  Saving model ...
Epoch: 11 cost time: 2.608628273010254
Epoch: 11, Steps: 8 | Train Loss: 0.405 Vali Loss: 1.039 Vali Acc: 0.616 Test Loss: 1.039 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8085403442382812
Epoch: 12, Steps: 8 | Train Loss: 0.350 Vali Loss: 1.008 Vali Acc: 0.616 Test Loss: 1.008 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7438738346099854
Epoch: 13, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.988 Vali Acc: 0.625 Test Loss: 0.988 Test Acc: 0.625
Validation loss decreased (-0.621864 --> -0.624990).  Saving model ...
Epoch: 14 cost time: 2.6949543952941895
Epoch: 14, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.007 Vali Acc: 0.653 Test Loss: 1.007 Test Acc: 0.653
Validation loss decreased (-0.624990 --> -0.653115).  Saving model ...
Epoch: 15 cost time: 2.964693546295166
Epoch: 15, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.037 Vali Acc: 0.625 Test Loss: 1.037 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.031466245651245
Epoch: 16, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.060 Vali Acc: 0.625 Test Loss: 1.060 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.33941650390625
Epoch: 17, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.033 Vali Acc: 0.622 Test Loss: 1.033 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.645660638809204
Epoch: 18, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.059 Vali Acc: 0.631 Test Loss: 1.059 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.8132987022399902
Epoch: 19, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.086 Vali Acc: 0.628 Test Loss: 1.086 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6587464809417725
Epoch: 20, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.109 Vali Acc: 0.619 Test Loss: 1.109 Test Acc: 0.619
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.9353322982788086
Epoch: 21, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.060 Vali Acc: 0.641 Test Loss: 1.060 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.239154577255249
Epoch: 22, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.076 Vali Acc: 0.644 Test Loss: 1.076 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.221123218536377
Epoch: 23, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.081 Vali Acc: 0.637 Test Loss: 1.081 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.035987615585327
Epoch: 24, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.092 Vali Acc: 0.650 Test Loss: 1.092 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.653125
model parameter : 320072
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.076335430145264
Epoch: 1, Steps: 8 | Train Loss: 2.160 Vali Loss: 2.099 Vali Acc: 0.138 Test Loss: 2.099 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 2.6403207778930664
Epoch: 2, Steps: 8 | Train Loss: 2.100 Vali Loss: 2.023 Vali Acc: 0.231 Test Loss: 2.023 Test Acc: 0.231
Validation loss decreased (-0.137479 --> -0.231230).  Saving model ...
Epoch: 3 cost time: 2.6822988986968994
Epoch: 3, Steps: 8 | Train Loss: 1.967 Vali Loss: 1.956 Vali Acc: 0.206 Test Loss: 1.956 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4303407669067383
Epoch: 4, Steps: 8 | Train Loss: 1.895 Vali Loss: 1.879 Vali Acc: 0.369 Test Loss: 1.879 Test Acc: 0.369
Validation loss decreased (-0.231230 --> -0.368731).  Saving model ...
Epoch: 5 cost time: 2.8046329021453857
Epoch: 5, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.771 Vali Acc: 0.394 Test Loss: 1.771 Test Acc: 0.394
Validation loss decreased (-0.368731 --> -0.393732).  Saving model ...
Epoch: 6 cost time: 2.6377112865448
Epoch: 6, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.680 Vali Acc: 0.400 Test Loss: 1.680 Test Acc: 0.400
Validation loss decreased (-0.393732 --> -0.399983).  Saving model ...
Epoch: 7 cost time: 3.0228562355041504
Epoch: 7, Steps: 8 | Train Loss: 1.273 Vali Loss: 1.595 Vali Acc: 0.431 Test Loss: 1.595 Test Acc: 0.431
Validation loss decreased (-0.399983 --> -0.431234).  Saving model ...
Epoch: 8 cost time: 2.9294090270996094
Epoch: 8, Steps: 8 | Train Loss: 1.124 Vali Loss: 1.506 Vali Acc: 0.463 Test Loss: 1.506 Test Acc: 0.463
Validation loss decreased (-0.431234 --> -0.462485).  Saving model ...
Epoch: 9 cost time: 2.677488327026367
Epoch: 9, Steps: 8 | Train Loss: 1.012 Vali Loss: 1.444 Vali Acc: 0.472 Test Loss: 1.444 Test Acc: 0.472
Validation loss decreased (-0.462485 --> -0.471861).  Saving model ...
Epoch: 10 cost time: 2.7564244270324707
Epoch: 10, Steps: 8 | Train Loss: 0.785 Vali Loss: 1.390 Vali Acc: 0.487 Test Loss: 1.390 Test Acc: 0.487
Validation loss decreased (-0.471861 --> -0.487486).  Saving model ...
Epoch: 11 cost time: 2.5772876739501953
Epoch: 11, Steps: 8 | Train Loss: 0.627 Vali Loss: 1.402 Vali Acc: 0.447 Test Loss: 1.402 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.673858165740967
Epoch: 12, Steps: 8 | Train Loss: 0.557 Vali Loss: 1.344 Vali Acc: 0.494 Test Loss: 1.344 Test Acc: 0.494
Validation loss decreased (-0.487486 --> -0.493737).  Saving model ...
Epoch: 13 cost time: 2.6934354305267334
Epoch: 13, Steps: 8 | Train Loss: 0.436 Vali Loss: 1.357 Vali Acc: 0.484 Test Loss: 1.357 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.434544086456299
Epoch: 14, Steps: 8 | Train Loss: 0.354 Vali Loss: 1.453 Vali Acc: 0.469 Test Loss: 1.453 Test Acc: 0.469
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6566779613494873
Epoch: 15, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.342 Vali Acc: 0.506 Test Loss: 1.342 Test Acc: 0.506
Validation loss decreased (-0.493737 --> -0.506237).  Saving model ...
Epoch: 16 cost time: 2.363597869873047
Epoch: 16, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.455 Vali Acc: 0.466 Test Loss: 1.455 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9618189334869385
Epoch: 17, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.356 Vali Acc: 0.516 Test Loss: 1.356 Test Acc: 0.516
Validation loss decreased (-0.506237 --> -0.515611).  Saving model ...
Epoch: 18 cost time: 2.8550360202789307
Epoch: 18, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.371 Vali Acc: 0.534 Test Loss: 1.371 Test Acc: 0.534
Validation loss decreased (-0.515611 --> -0.534361).  Saving model ...
Epoch: 19 cost time: 2.5172016620635986
Epoch: 19, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.484 Vali Acc: 0.484 Test Loss: 1.484 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5482072830200195
Epoch: 20, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.505 Vali Acc: 0.481 Test Loss: 1.505 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4622514247894287
Epoch: 21, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.383 Vali Acc: 0.534 Test Loss: 1.383 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.866987705230713
Epoch: 22, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.567 Vali Acc: 0.509 Test Loss: 1.567 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.197723865509033
Epoch: 23, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.556 Vali Acc: 0.491 Test Loss: 1.556 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.018411874771118
Epoch: 24, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.558 Vali Acc: 0.494 Test Loss: 1.558 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.0316965579986572
Epoch: 25, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.572 Vali Acc: 0.516 Test Loss: 1.572 Test Acc: 0.516
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7340986728668213
Epoch: 26, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.639 Vali Acc: 0.469 Test Loss: 1.639 Test Acc: 0.469
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.0632259845733643
Epoch: 27, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.570 Vali Acc: 0.506 Test Loss: 1.570 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.776477813720703
Epoch: 28, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.590 Vali Acc: 0.506 Test Loss: 1.590 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.534375
model parameter : 320072
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.32258415222168
Epoch: 1, Steps: 8 | Train Loss: 2.149 Vali Loss: 2.085 Vali Acc: 0.175 Test Loss: 2.085 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 2.552001953125
Epoch: 2, Steps: 8 | Train Loss: 2.094 Vali Loss: 2.043 Vali Acc: 0.216 Test Loss: 2.043 Test Acc: 0.216
Validation loss decreased (-0.174979 --> -0.215605).  Saving model ...
Epoch: 3 cost time: 2.7313530445098877
Epoch: 3, Steps: 8 | Train Loss: 1.997 Vali Loss: 2.006 Vali Acc: 0.166 Test Loss: 2.006 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.883239269256592
Epoch: 4, Steps: 8 | Train Loss: 1.967 Vali Loss: 1.966 Vali Acc: 0.278 Test Loss: 1.966 Test Acc: 0.278
Validation loss decreased (-0.215605 --> -0.278105).  Saving model ...
Epoch: 5 cost time: 2.5179755687713623
Epoch: 5, Steps: 8 | Train Loss: 1.806 Vali Loss: 1.907 Vali Acc: 0.306 Test Loss: 1.907 Test Acc: 0.306
Validation loss decreased (-0.278105 --> -0.306231).  Saving model ...
Epoch: 6 cost time: 3.036428928375244
Epoch: 6, Steps: 8 | Train Loss: 1.662 Vali Loss: 1.850 Vali Acc: 0.328 Test Loss: 1.850 Test Acc: 0.328
Validation loss decreased (-0.306231 --> -0.328107).  Saving model ...
Epoch: 7 cost time: 3.1150448322296143
Epoch: 7, Steps: 8 | Train Loss: 1.490 Vali Loss: 1.780 Vali Acc: 0.362 Test Loss: 1.780 Test Acc: 0.362
Validation loss decreased (-0.328107 --> -0.362482).  Saving model ...
Epoch: 8 cost time: 2.9669368267059326
Epoch: 8, Steps: 8 | Train Loss: 1.355 Vali Loss: 1.709 Vali Acc: 0.428 Test Loss: 1.709 Test Acc: 0.428
Validation loss decreased (-0.362482 --> -0.428108).  Saving model ...
Epoch: 9 cost time: 2.9348275661468506
Epoch: 9, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.652 Vali Acc: 0.431 Test Loss: 1.652 Test Acc: 0.431
Validation loss decreased (-0.428108 --> -0.431233).  Saving model ...
Epoch: 10 cost time: 2.813220739364624
Epoch: 10, Steps: 8 | Train Loss: 0.995 Vali Loss: 1.576 Vali Acc: 0.459 Test Loss: 1.576 Test Acc: 0.459
Validation loss decreased (-0.431233 --> -0.459359).  Saving model ...
Epoch: 11 cost time: 3.069949150085449
Epoch: 11, Steps: 8 | Train Loss: 0.842 Vali Loss: 1.537 Vali Acc: 0.428 Test Loss: 1.537 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0389516353607178
Epoch: 12, Steps: 8 | Train Loss: 0.717 Vali Loss: 1.454 Vali Acc: 0.472 Test Loss: 1.454 Test Acc: 0.472
Validation loss decreased (-0.459359 --> -0.471860).  Saving model ...
Epoch: 13 cost time: 3.2398316860198975
Epoch: 13, Steps: 8 | Train Loss: 0.593 Vali Loss: 1.412 Vali Acc: 0.481 Test Loss: 1.412 Test Acc: 0.481
Validation loss decreased (-0.471860 --> -0.481236).  Saving model ...
Epoch: 14 cost time: 3.1866455078125
Epoch: 14, Steps: 8 | Train Loss: 0.470 Vali Loss: 1.476 Vali Acc: 0.409 Test Loss: 1.476 Test Acc: 0.409
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.843623161315918
Epoch: 15, Steps: 8 | Train Loss: 0.460 Vali Loss: 1.292 Vali Acc: 0.519 Test Loss: 1.292 Test Acc: 0.519
Validation loss decreased (-0.481236 --> -0.518737).  Saving model ...
Epoch: 16 cost time: 2.6482725143432617
Epoch: 16, Steps: 8 | Train Loss: 0.358 Vali Loss: 1.350 Vali Acc: 0.475 Test Loss: 1.350 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7440173625946045
Epoch: 17, Steps: 8 | Train Loss: 0.329 Vali Loss: 1.456 Vali Acc: 0.419 Test Loss: 1.456 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2493388652801514
Epoch: 18, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.410 Vali Acc: 0.453 Test Loss: 1.410 Test Acc: 0.453
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0343568325042725
Epoch: 19, Steps: 8 | Train Loss: 0.243 Vali Loss: 1.519 Vali Acc: 0.384 Test Loss: 1.519 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.049212694168091
Epoch: 20, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.658 Vali Acc: 0.384 Test Loss: 1.658 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.0619733333587646
Epoch: 21, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.384 Vali Acc: 0.500 Test Loss: 1.384 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.974364995956421
Epoch: 22, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.643 Vali Acc: 0.388 Test Loss: 1.643 Test Acc: 0.388
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.2449188232421875
Epoch: 23, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.506 Vali Acc: 0.472 Test Loss: 1.506 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.110271692276001
Epoch: 24, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.549 Vali Acc: 0.472 Test Loss: 1.549 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.4205453395843506
Epoch: 25, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.762 Vali Acc: 0.384 Test Loss: 1.762 Test Acc: 0.384
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.51875
model parameter : 320072
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.093485116958618
Epoch: 1, Steps: 8 | Train Loss: 2.177 Vali Loss: 2.097 Vali Acc: 0.209 Test Loss: 2.097 Test Acc: 0.209
Validation loss decreased (inf --> -0.209354).  Saving model ...
Epoch: 2 cost time: 2.734837055206299
Epoch: 2, Steps: 8 | Train Loss: 2.121 Vali Loss: 2.057 Vali Acc: 0.184 Test Loss: 2.057 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.865640163421631
Epoch: 3, Steps: 8 | Train Loss: 1.978 Vali Loss: 2.030 Vali Acc: 0.144 Test Loss: 2.030 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.255218744277954
Epoch: 4, Steps: 8 | Train Loss: 1.986 Vali Loss: 2.009 Vali Acc: 0.228 Test Loss: 2.009 Test Acc: 0.228
Validation loss decreased (-0.209354 --> -0.228105).  Saving model ...
Epoch: 5 cost time: 3.105581283569336
Epoch: 5, Steps: 8 | Train Loss: 1.842 Vali Loss: 1.965 Vali Acc: 0.259 Test Loss: 1.965 Test Acc: 0.259
Validation loss decreased (-0.228105 --> -0.259355).  Saving model ...
Epoch: 6 cost time: 2.645904302597046
Epoch: 6, Steps: 8 | Train Loss: 1.699 Vali Loss: 1.930 Vali Acc: 0.275 Test Loss: 1.930 Test Acc: 0.275
Validation loss decreased (-0.259355 --> -0.274981).  Saving model ...
Epoch: 7 cost time: 2.917541027069092
Epoch: 7, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.884 Vali Acc: 0.287 Test Loss: 1.884 Test Acc: 0.287
Validation loss decreased (-0.274981 --> -0.287481).  Saving model ...
Epoch: 8 cost time: 2.9277796745300293
Epoch: 8, Steps: 8 | Train Loss: 1.398 Vali Loss: 1.822 Vali Acc: 0.353 Test Loss: 1.822 Test Acc: 0.353
Validation loss decreased (-0.287481 --> -0.353107).  Saving model ...
Epoch: 9 cost time: 2.8913304805755615
Epoch: 9, Steps: 8 | Train Loss: 1.292 Vali Loss: 1.757 Vali Acc: 0.372 Test Loss: 1.757 Test Acc: 0.372
Validation loss decreased (-0.353107 --> -0.371857).  Saving model ...
Epoch: 10 cost time: 3.1341116428375244
Epoch: 10, Steps: 8 | Train Loss: 1.063 Vali Loss: 1.688 Vali Acc: 0.397 Test Loss: 1.688 Test Acc: 0.397
Validation loss decreased (-0.371857 --> -0.396858).  Saving model ...
Epoch: 11 cost time: 3.13712215423584
Epoch: 11, Steps: 8 | Train Loss: 0.899 Vali Loss: 1.634 Vali Acc: 0.400 Test Loss: 1.634 Test Acc: 0.400
Validation loss decreased (-0.396858 --> -0.399984).  Saving model ...
Epoch: 12 cost time: 3.211542844772339
Epoch: 12, Steps: 8 | Train Loss: 0.774 Vali Loss: 1.565 Vali Acc: 0.397 Test Loss: 1.565 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.865760564804077
Epoch: 13, Steps: 8 | Train Loss: 0.665 Vali Loss: 1.513 Vali Acc: 0.406 Test Loss: 1.513 Test Acc: 0.406
Validation loss decreased (-0.399984 --> -0.406235).  Saving model ...
Epoch: 14 cost time: 2.966672897338867
Epoch: 14, Steps: 8 | Train Loss: 0.539 Vali Loss: 1.558 Vali Acc: 0.381 Test Loss: 1.558 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6754589080810547
Epoch: 15, Steps: 8 | Train Loss: 0.526 Vali Loss: 1.414 Vali Acc: 0.475 Test Loss: 1.414 Test Acc: 0.475
Validation loss decreased (-0.406235 --> -0.474986).  Saving model ...
Epoch: 16 cost time: 3.005720853805542
Epoch: 16, Steps: 8 | Train Loss: 0.432 Vali Loss: 1.457 Vali Acc: 0.403 Test Loss: 1.457 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9817392826080322
Epoch: 17, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.464 Vali Acc: 0.428 Test Loss: 1.464 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.86159610748291
Epoch: 18, Steps: 8 | Train Loss: 0.341 Vali Loss: 1.488 Vali Acc: 0.388 Test Loss: 1.488 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0122599601745605
Epoch: 19, Steps: 8 | Train Loss: 0.302 Vali Loss: 1.476 Vali Acc: 0.416 Test Loss: 1.476 Test Acc: 0.416
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6842777729034424
Epoch: 20, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.520 Vali Acc: 0.444 Test Loss: 1.520 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.769460439682007
Epoch: 21, Steps: 8 | Train Loss: 0.254 Vali Loss: 1.599 Vali Acc: 0.400 Test Loss: 1.599 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.120960235595703
Epoch: 22, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.626 Vali Acc: 0.438 Test Loss: 1.626 Test Acc: 0.438
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.264284372329712
Epoch: 23, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.565 Vali Acc: 0.466 Test Loss: 1.565 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.272407293319702
Epoch: 24, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.632 Vali Acc: 0.459 Test Loss: 1.632 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.211493492126465
Epoch: 25, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.668 Vali Acc: 0.431 Test Loss: 1.668 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.475
model parameter : 320072
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.132332801818848
Epoch: 1, Steps: 8 | Train Loss: 2.169 Vali Loss: 2.117 Vali Acc: 0.175 Test Loss: 2.117 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 3.1583778858184814
Epoch: 2, Steps: 8 | Train Loss: 2.109 Vali Loss: 2.072 Vali Acc: 0.188 Test Loss: 2.072 Test Acc: 0.188
Validation loss decreased (-0.174979 --> -0.187479).  Saving model ...
Epoch: 3 cost time: 2.9471957683563232
Epoch: 3, Steps: 8 | Train Loss: 2.002 Vali Loss: 2.043 Vali Acc: 0.169 Test Loss: 2.043 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.103855848312378
Epoch: 4, Steps: 8 | Train Loss: 1.992 Vali Loss: 2.032 Vali Acc: 0.216 Test Loss: 2.032 Test Acc: 0.216
Validation loss decreased (-0.187479 --> -0.215605).  Saving model ...
Epoch: 5 cost time: 3.0329341888427734
Epoch: 5, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.992 Vali Acc: 0.259 Test Loss: 1.992 Test Acc: 0.259
Validation loss decreased (-0.215605 --> -0.259355).  Saving model ...
Epoch: 6 cost time: 2.785855770111084
Epoch: 6, Steps: 8 | Train Loss: 1.694 Vali Loss: 1.965 Vali Acc: 0.259 Test Loss: 1.965 Test Acc: 0.259
Validation loss decreased (-0.259355 --> -0.259355).  Saving model ...
Epoch: 7 cost time: 2.7149784564971924
Epoch: 7, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.942 Vali Acc: 0.303 Test Loss: 1.942 Test Acc: 0.303
Validation loss decreased (-0.259355 --> -0.303106).  Saving model ...
Epoch: 8 cost time: 3.288388252258301
Epoch: 8, Steps: 8 | Train Loss: 1.406 Vali Loss: 1.900 Vali Acc: 0.297 Test Loss: 1.900 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4296319484710693
Epoch: 9, Steps: 8 | Train Loss: 1.295 Vali Loss: 1.856 Vali Acc: 0.338 Test Loss: 1.856 Test Acc: 0.338
Validation loss decreased (-0.303106 --> -0.337481).  Saving model ...
Epoch: 10 cost time: 3.1384360790252686
Epoch: 10, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.792 Vali Acc: 0.384 Test Loss: 1.792 Test Acc: 0.384
Validation loss decreased (-0.337481 --> -0.384357).  Saving model ...
Epoch: 11 cost time: 2.819777488708496
Epoch: 11, Steps: 8 | Train Loss: 0.928 Vali Loss: 1.762 Vali Acc: 0.350 Test Loss: 1.762 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.125903844833374
Epoch: 12, Steps: 8 | Train Loss: 0.815 Vali Loss: 1.737 Vali Acc: 0.369 Test Loss: 1.737 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.76247501373291
Epoch: 13, Steps: 8 | Train Loss: 0.713 Vali Loss: 1.699 Vali Acc: 0.359 Test Loss: 1.699 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0330166816711426
Epoch: 14, Steps: 8 | Train Loss: 0.626 Vali Loss: 1.697 Vali Acc: 0.319 Test Loss: 1.697 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7869250774383545
Epoch: 15, Steps: 8 | Train Loss: 0.561 Vali Loss: 1.666 Vali Acc: 0.287 Test Loss: 1.666 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6296939849853516
Epoch: 16, Steps: 8 | Train Loss: 0.475 Vali Loss: 1.624 Vali Acc: 0.353 Test Loss: 1.624 Test Acc: 0.353
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.9314053058624268
Epoch: 17, Steps: 8 | Train Loss: 0.429 Vali Loss: 1.611 Vali Acc: 0.338 Test Loss: 1.611 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.9201059341430664
Epoch: 18, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.568 Vali Acc: 0.391 Test Loss: 1.568 Test Acc: 0.391
Validation loss decreased (-0.384357 --> -0.390609).  Saving model ...
Epoch: 19 cost time: 2.755553960800171
Epoch: 19, Steps: 8 | Train Loss: 0.367 Vali Loss: 1.607 Vali Acc: 0.347 Test Loss: 1.607 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5944571495056152
Epoch: 20, Steps: 8 | Train Loss: 0.292 Vali Loss: 1.588 Vali Acc: 0.412 Test Loss: 1.588 Test Acc: 0.412
Validation loss decreased (-0.390609 --> -0.412484).  Saving model ...
Epoch: 21 cost time: 2.68513822555542
Epoch: 21, Steps: 8 | Train Loss: 0.303 Vali Loss: 1.545 Vali Acc: 0.384 Test Loss: 1.545 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.247433662414551
Epoch: 22, Steps: 8 | Train Loss: 0.282 Vali Loss: 1.670 Vali Acc: 0.331 Test Loss: 1.670 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0747182369232178
Epoch: 23, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.542 Vali Acc: 0.409 Test Loss: 1.542 Test Acc: 0.409
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.235074758529663
Epoch: 24, Steps: 8 | Train Loss: 0.208 Vali Loss: 1.718 Vali Acc: 0.338 Test Loss: 1.718 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.9064126014709473
Epoch: 25, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.619 Vali Acc: 0.372 Test Loss: 1.619 Test Acc: 0.372
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.8652334213256836
Epoch: 26, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.768 Vali Acc: 0.338 Test Loss: 1.768 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.1833548545837402
Epoch: 27, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.548 Vali Acc: 0.447 Test Loss: 1.548 Test Acc: 0.447
Validation loss decreased (-0.412484 --> -0.446860).  Saving model ...
Epoch: 28 cost time: 3.185577392578125
Epoch: 28, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.764 Vali Acc: 0.372 Test Loss: 1.764 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1189444065093994
Epoch: 29, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.873 Vali Acc: 0.334 Test Loss: 1.873 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.859093189239502
Epoch: 30, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.792 Vali Acc: 0.412 Test Loss: 1.792 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.9287381172180176
Epoch: 31, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.771 Vali Acc: 0.406 Test Loss: 1.771 Test Acc: 0.406
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.02687668800354
Epoch: 32, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.943 Vali Acc: 0.378 Test Loss: 1.943 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.0993385314941406
Epoch: 33, Steps: 8 | Train Loss: 0.106 Vali Loss: 2.016 Vali Acc: 0.359 Test Loss: 2.016 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.915346384048462
Epoch: 34, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.786 Vali Acc: 0.416 Test Loss: 1.786 Test Acc: 0.416
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.8343584537506104
Epoch: 35, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.904 Vali Acc: 0.397 Test Loss: 1.904 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.900923490524292
Epoch: 36, Steps: 8 | Train Loss: 0.075 Vali Loss: 2.018 Vali Acc: 0.334 Test Loss: 2.018 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.440690279006958
Epoch: 37, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.800 Vali Acc: 0.425 Test Loss: 1.800 Test Acc: 0.425
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.446875
model parameter : 320072
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.5386621952056885
Epoch: 1, Steps: 8 | Train Loss: 2.144 Vali Loss: 2.137 Vali Acc: 0.138 Test Loss: 2.137 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 2.7572672367095947
Epoch: 2, Steps: 8 | Train Loss: 2.109 Vali Loss: 2.109 Vali Acc: 0.138 Test Loss: 2.109 Test Acc: 0.138
Validation loss decreased (-0.137479 --> -0.137479).  Saving model ...
Epoch: 3 cost time: 3.232025623321533
Epoch: 3, Steps: 8 | Train Loss: 1.986 Vali Loss: 2.080 Vali Acc: 0.134 Test Loss: 2.080 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9944303035736084
Epoch: 4, Steps: 8 | Train Loss: 2.008 Vali Loss: 2.049 Vali Acc: 0.163 Test Loss: 2.049 Test Acc: 0.163
Validation loss decreased (-0.137479 --> -0.162480).  Saving model ...
Epoch: 5 cost time: 3.1744673252105713
Epoch: 5, Steps: 8 | Train Loss: 1.804 Vali Loss: 2.024 Vali Acc: 0.144 Test Loss: 2.024 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.907039165496826
Epoch: 6, Steps: 8 | Train Loss: 1.755 Vali Loss: 1.997 Vali Acc: 0.203 Test Loss: 1.997 Test Acc: 0.203
Validation loss decreased (-0.162480 --> -0.203105).  Saving model ...
Epoch: 7 cost time: 2.8812003135681152
Epoch: 7, Steps: 8 | Train Loss: 1.607 Vali Loss: 1.964 Vali Acc: 0.228 Test Loss: 1.964 Test Acc: 0.228
Validation loss decreased (-0.203105 --> -0.228105).  Saving model ...
Epoch: 8 cost time: 2.868103265762329
Epoch: 8, Steps: 8 | Train Loss: 1.454 Vali Loss: 1.918 Vali Acc: 0.291 Test Loss: 1.918 Test Acc: 0.291
Validation loss decreased (-0.228105 --> -0.290606).  Saving model ...
Epoch: 9 cost time: 3.0297324657440186
Epoch: 9, Steps: 8 | Train Loss: 1.380 Vali Loss: 1.872 Vali Acc: 0.287 Test Loss: 1.872 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0304174423217773
Epoch: 10, Steps: 8 | Train Loss: 1.191 Vali Loss: 1.809 Vali Acc: 0.281 Test Loss: 1.809 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.654433488845825
Epoch: 11, Steps: 8 | Train Loss: 1.047 Vali Loss: 1.774 Vali Acc: 0.278 Test Loss: 1.774 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8190724849700928
Epoch: 12, Steps: 8 | Train Loss: 0.956 Vali Loss: 1.727 Vali Acc: 0.294 Test Loss: 1.727 Test Acc: 0.294
Validation loss decreased (-0.290606 --> -0.293733).  Saving model ...
Epoch: 13 cost time: 2.9610750675201416
Epoch: 13, Steps: 8 | Train Loss: 0.809 Vali Loss: 1.686 Vali Acc: 0.291 Test Loss: 1.686 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9840314388275146
Epoch: 14, Steps: 8 | Train Loss: 0.745 Vali Loss: 1.679 Vali Acc: 0.303 Test Loss: 1.679 Test Acc: 0.303
Validation loss decreased (-0.293733 --> -0.303108).  Saving model ...
Epoch: 15 cost time: 3.1172380447387695
Epoch: 15, Steps: 8 | Train Loss: 0.673 Vali Loss: 1.648 Vali Acc: 0.281 Test Loss: 1.648 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8183188438415527
Epoch: 16, Steps: 8 | Train Loss: 0.555 Vali Loss: 1.578 Vali Acc: 0.350 Test Loss: 1.578 Test Acc: 0.350
Validation loss decreased (-0.303108 --> -0.349984).  Saving model ...
Epoch: 17 cost time: 2.800318479537964
Epoch: 17, Steps: 8 | Train Loss: 0.545 Vali Loss: 1.559 Vali Acc: 0.328 Test Loss: 1.559 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.769228935241699
Epoch: 18, Steps: 8 | Train Loss: 0.465 Vali Loss: 1.510 Vali Acc: 0.394 Test Loss: 1.510 Test Acc: 0.394
Validation loss decreased (-0.349984 --> -0.393735).  Saving model ...
Epoch: 19 cost time: 2.9101102352142334
Epoch: 19, Steps: 8 | Train Loss: 0.483 Vali Loss: 1.507 Vali Acc: 0.422 Test Loss: 1.507 Test Acc: 0.422
Validation loss decreased (-0.393735 --> -0.421860).  Saving model ...
Epoch: 20 cost time: 2.9369821548461914
Epoch: 20, Steps: 8 | Train Loss: 0.408 Vali Loss: 1.507 Vali Acc: 0.441 Test Loss: 1.507 Test Acc: 0.441
Validation loss decreased (-0.421860 --> -0.440610).  Saving model ...
Epoch: 21 cost time: 2.6662604808807373
Epoch: 21, Steps: 8 | Train Loss: 0.358 Vali Loss: 1.423 Vali Acc: 0.484 Test Loss: 1.423 Test Acc: 0.484
Validation loss decreased (-0.440610 --> -0.484361).  Saving model ...
Epoch: 22 cost time: 2.7164156436920166
Epoch: 22, Steps: 8 | Train Loss: 0.373 Vali Loss: 1.472 Vali Acc: 0.431 Test Loss: 1.472 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7101714611053467
Epoch: 23, Steps: 8 | Train Loss: 0.291 Vali Loss: 1.430 Vali Acc: 0.484 Test Loss: 1.430 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.286275863647461
Epoch: 24, Steps: 8 | Train Loss: 0.248 Vali Loss: 1.446 Vali Acc: 0.447 Test Loss: 1.446 Test Acc: 0.447
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.107919931411743
Epoch: 25, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.492 Vali Acc: 0.472 Test Loss: 1.492 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.93743634223938
Epoch: 26, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.520 Vali Acc: 0.450 Test Loss: 1.520 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.687638521194458
Epoch: 27, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.459 Vali Acc: 0.484 Test Loss: 1.459 Test Acc: 0.484
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.82207989692688
Epoch: 28, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.507 Vali Acc: 0.456 Test Loss: 1.507 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.0718367099761963
Epoch: 29, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.571 Vali Acc: 0.450 Test Loss: 1.571 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.118424892425537
Epoch: 30, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.716 Vali Acc: 0.397 Test Loss: 1.716 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.348050832748413
Epoch: 31, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.674 Vali Acc: 0.428 Test Loss: 1.674 Test Acc: 0.428
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.484375
model parameter : 320072
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8181495666503906
Epoch: 1, Steps: 8 | Train Loss: 2.129 Vali Loss: 2.144 Vali Acc: 0.103 Test Loss: 2.144 Test Acc: 0.103
Validation loss decreased (inf --> -0.103104).  Saving model ...
Epoch: 2 cost time: 3.382603406906128
Epoch: 2, Steps: 8 | Train Loss: 2.071 Vali Loss: 2.126 Vali Acc: 0.125 Test Loss: 2.126 Test Acc: 0.125
Validation loss decreased (-0.103104 --> -0.124979).  Saving model ...
Epoch: 3 cost time: 3.1763651371002197
Epoch: 3, Steps: 8 | Train Loss: 2.038 Vali Loss: 2.097 Vali Acc: 0.172 Test Loss: 2.097 Test Acc: 0.172
Validation loss decreased (-0.124979 --> -0.171854).  Saving model ...
Epoch: 4 cost time: 2.780989646911621
Epoch: 4, Steps: 8 | Train Loss: 2.017 Vali Loss: 2.061 Vali Acc: 0.175 Test Loss: 2.061 Test Acc: 0.175
Validation loss decreased (-0.171854 --> -0.174979).  Saving model ...
Epoch: 5 cost time: 2.712318181991577
Epoch: 5, Steps: 8 | Train Loss: 1.899 Vali Loss: 2.039 Vali Acc: 0.284 Test Loss: 2.039 Test Acc: 0.284
Validation loss decreased (-0.174979 --> -0.284355).  Saving model ...
Epoch: 6 cost time: 3.0037484169006348
Epoch: 6, Steps: 8 | Train Loss: 1.771 Vali Loss: 2.014 Vali Acc: 0.312 Test Loss: 2.014 Test Acc: 0.312
Validation loss decreased (-0.284355 --> -0.312480).  Saving model ...
Epoch: 7 cost time: 2.8217241764068604
Epoch: 7, Steps: 8 | Train Loss: 1.690 Vali Loss: 1.973 Vali Acc: 0.338 Test Loss: 1.973 Test Acc: 0.338
Validation loss decreased (-0.312480 --> -0.337480).  Saving model ...
Epoch: 8 cost time: 2.883108377456665
Epoch: 8, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.930 Vali Acc: 0.356 Test Loss: 1.930 Test Acc: 0.356
Validation loss decreased (-0.337480 --> -0.356231).  Saving model ...
Epoch: 9 cost time: 2.9872543811798096
Epoch: 9, Steps: 8 | Train Loss: 1.499 Vali Loss: 1.900 Vali Acc: 0.384 Test Loss: 1.900 Test Acc: 0.384
Validation loss decreased (-0.356231 --> -0.384356).  Saving model ...
Epoch: 10 cost time: 3.037872076034546
Epoch: 10, Steps: 8 | Train Loss: 1.368 Vali Loss: 1.857 Vali Acc: 0.388 Test Loss: 1.857 Test Acc: 0.388
Validation loss decreased (-0.384356 --> -0.387481).  Saving model ...
Epoch: 11 cost time: 3.3554887771606445
Epoch: 11, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.815 Vali Acc: 0.356 Test Loss: 1.815 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.409557342529297
Epoch: 12, Steps: 8 | Train Loss: 1.072 Vali Loss: 1.757 Vali Acc: 0.381 Test Loss: 1.757 Test Acc: 0.381
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9650325775146484
Epoch: 13, Steps: 8 | Train Loss: 1.043 Vali Loss: 1.713 Vali Acc: 0.353 Test Loss: 1.713 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.805507183074951
Epoch: 14, Steps: 8 | Train Loss: 0.900 Vali Loss: 1.685 Vali Acc: 0.353 Test Loss: 1.685 Test Acc: 0.353
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.035930633544922
Epoch: 15, Steps: 8 | Train Loss: 0.821 Vali Loss: 1.665 Vali Acc: 0.338 Test Loss: 1.665 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.256103277206421
Epoch: 16, Steps: 8 | Train Loss: 0.752 Vali Loss: 1.606 Vali Acc: 0.366 Test Loss: 1.606 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.1641457080841064
Epoch: 17, Steps: 8 | Train Loss: 0.656 Vali Loss: 1.607 Vali Acc: 0.309 Test Loss: 1.607 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.733656644821167
Epoch: 18, Steps: 8 | Train Loss: 0.604 Vali Loss: 1.586 Vali Acc: 0.353 Test Loss: 1.586 Test Acc: 0.353
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.9829652309417725
Epoch: 19, Steps: 8 | Train Loss: 0.567 Vali Loss: 1.609 Vali Acc: 0.303 Test Loss: 1.609 Test Acc: 0.303
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.1737303733825684
Epoch: 20, Steps: 8 | Train Loss: 0.512 Vali Loss: 1.638 Vali Acc: 0.284 Test Loss: 1.638 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.3875
model parameter : 320072
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.128219366073608
Epoch: 1, Steps: 8 | Train Loss: 2.169 Vali Loss: 2.032 Vali Acc: 0.156 Test Loss: 2.032 Test Acc: 0.156
Validation loss decreased (inf --> -0.156230).  Saving model ...
Epoch: 2 cost time: 2.8986191749572754
Epoch: 2, Steps: 8 | Train Loss: 1.970 Vali Loss: 1.716 Vali Acc: 0.494 Test Loss: 1.716 Test Acc: 0.494
Validation loss decreased (-0.156230 --> -0.493733).  Saving model ...
Epoch: 3 cost time: 2.880331516265869
Epoch: 3, Steps: 8 | Train Loss: 1.557 Vali Loss: 1.385 Vali Acc: 0.659 Test Loss: 1.385 Test Acc: 0.659
Validation loss decreased (-0.493733 --> -0.659361).  Saving model ...
Epoch: 4 cost time: 2.5788211822509766
Epoch: 4, Steps: 8 | Train Loss: 1.215 Vali Loss: 1.129 Vali Acc: 0.728 Test Loss: 1.129 Test Acc: 0.728
Validation loss decreased (-0.659361 --> -0.728114).  Saving model ...
Epoch: 5 cost time: 2.699108600616455
Epoch: 5, Steps: 8 | Train Loss: 0.935 Vali Loss: 0.944 Vali Acc: 0.756 Test Loss: 0.944 Test Acc: 0.756
Validation loss decreased (-0.728114 --> -0.756241).  Saving model ...
Epoch: 6 cost time: 2.9767837524414062
Epoch: 6, Steps: 8 | Train Loss: 0.701 Vali Loss: 0.830 Vali Acc: 0.769 Test Loss: 0.830 Test Acc: 0.769
Validation loss decreased (-0.756241 --> -0.768742).  Saving model ...
Epoch: 7 cost time: 2.9357004165649414
Epoch: 7, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.765 Vali Acc: 0.756 Test Loss: 0.765 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.560577869415283
Epoch: 8, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.733 Vali Acc: 0.766 Test Loss: 0.733 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5291597843170166
Epoch: 9, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.714 Vali Acc: 0.741 Test Loss: 0.714 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5942001342773438
Epoch: 10, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.709 Vali Acc: 0.772 Test Loss: 0.709 Test Acc: 0.772
Validation loss decreased (-0.768742 --> -0.771868).  Saving model ...
Epoch: 11 cost time: 2.7862889766693115
Epoch: 11, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.710 Vali Acc: 0.762 Test Loss: 0.710 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.82534122467041
Epoch: 12, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.726 Vali Acc: 0.756 Test Loss: 0.726 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4741761684417725
Epoch: 13, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.732 Vali Acc: 0.766 Test Loss: 0.732 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6755125522613525
Epoch: 14, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.730 Vali Acc: 0.766 Test Loss: 0.730 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0588467121124268
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.757 Vali Acc: 0.747 Test Loss: 0.757 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.001610040664673
Epoch: 16, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.798 Vali Acc: 0.731 Test Loss: 0.798 Test Acc: 0.731
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.838989496231079
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.812 Vali Acc: 0.744 Test Loss: 0.812 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.6961898803710938
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.808 Vali Acc: 0.747 Test Loss: 0.808 Test Acc: 0.747
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.606520891189575
Epoch: 19, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.800 Vali Acc: 0.759 Test Loss: 0.800 Test Acc: 0.759
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.794138193130493
Epoch: 20, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.811 Vali Acc: 0.762 Test Loss: 0.811 Test Acc: 0.762
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.771875
model parameter : 221768
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.169243097305298
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 2.038 Vali Acc: 0.150 Test Loss: 2.038 Test Acc: 0.150
Validation loss decreased (inf --> -0.149980).  Saving model ...
Epoch: 2 cost time: 2.6167385578155518
Epoch: 2, Steps: 8 | Train Loss: 1.987 Vali Loss: 1.791 Vali Acc: 0.419 Test Loss: 1.791 Test Acc: 0.419
Validation loss decreased (-0.149980 --> -0.418732).  Saving model ...
Epoch: 3 cost time: 2.9142374992370605
Epoch: 3, Steps: 8 | Train Loss: 1.618 Vali Loss: 1.533 Vali Acc: 0.534 Test Loss: 1.533 Test Acc: 0.534
Validation loss decreased (-0.418732 --> -0.534360).  Saving model ...
Epoch: 4 cost time: 2.8550291061401367
Epoch: 4, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.329 Vali Acc: 0.619 Test Loss: 1.329 Test Acc: 0.619
Validation loss decreased (-0.534360 --> -0.618737).  Saving model ...
Epoch: 5 cost time: 2.525735378265381
Epoch: 5, Steps: 8 | Train Loss: 1.058 Vali Loss: 1.175 Vali Acc: 0.631 Test Loss: 1.175 Test Acc: 0.631
Validation loss decreased (-0.618737 --> -0.631238).  Saving model ...
Epoch: 6 cost time: 2.659877061843872
Epoch: 6, Steps: 8 | Train Loss: 0.821 Vali Loss: 1.061 Vali Acc: 0.659 Test Loss: 1.061 Test Acc: 0.659
Validation loss decreased (-0.631238 --> -0.659364).  Saving model ...
Epoch: 7 cost time: 2.9214589595794678
Epoch: 7, Steps: 8 | Train Loss: 0.650 Vali Loss: 0.986 Vali Acc: 0.675 Test Loss: 0.986 Test Acc: 0.675
Validation loss decreased (-0.659364 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 2.99747633934021
Epoch: 8, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.951 Vali Acc: 0.675 Test Loss: 0.951 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 3.08945894241333
Epoch: 9, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.911 Vali Acc: 0.691 Test Loss: 0.911 Test Acc: 0.691
Validation loss decreased (-0.674990 --> -0.690616).  Saving model ...
Epoch: 10 cost time: 2.728785514831543
Epoch: 10, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.893 Vali Acc: 0.681 Test Loss: 0.893 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6107375621795654
Epoch: 11, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.902 Vali Acc: 0.678 Test Loss: 0.902 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.893436908721924
Epoch: 12, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.908 Vali Acc: 0.681 Test Loss: 0.908 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.067634105682373
Epoch: 13, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.889 Vali Acc: 0.684 Test Loss: 0.889 Test Acc: 0.684
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.9703872203826904
Epoch: 14, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.890 Vali Acc: 0.688 Test Loss: 0.890 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.983109951019287
Epoch: 15, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.962 Vali Acc: 0.691 Test Loss: 0.962 Test Acc: 0.691
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.6632983684539795
Epoch: 16, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.976 Vali Acc: 0.678 Test Loss: 0.976 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4884660243988037
Epoch: 17, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.000 Vali Acc: 0.669 Test Loss: 1.000 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.928431272506714
Epoch: 18, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.014 Vali Acc: 0.675 Test Loss: 1.014 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.424734354019165
Epoch: 19, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.015 Vali Acc: 0.688 Test Loss: 1.015 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.690625
model parameter : 221768
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.60111141204834
Epoch: 1, Steps: 8 | Train Loss: 2.164 Vali Loss: 2.044 Vali Acc: 0.188 Test Loss: 2.044 Test Acc: 0.188
Validation loss decreased (inf --> -0.187480).  Saving model ...
Epoch: 2 cost time: 2.4031455516815186
Epoch: 2, Steps: 8 | Train Loss: 2.018 Vali Loss: 1.857 Vali Acc: 0.362 Test Loss: 1.857 Test Acc: 0.362
Validation loss decreased (-0.187480 --> -0.362481).  Saving model ...
Epoch: 3 cost time: 2.6409077644348145
Epoch: 3, Steps: 8 | Train Loss: 1.718 Vali Loss: 1.648 Vali Acc: 0.456 Test Loss: 1.648 Test Acc: 0.456
Validation loss decreased (-0.362481 --> -0.456234).  Saving model ...
Epoch: 4 cost time: 2.5124127864837646
Epoch: 4, Steps: 8 | Train Loss: 1.494 Vali Loss: 1.465 Vali Acc: 0.553 Test Loss: 1.465 Test Acc: 0.553
Validation loss decreased (-0.456234 --> -0.553110).  Saving model ...
Epoch: 5 cost time: 2.953514814376831
Epoch: 5, Steps: 8 | Train Loss: 1.191 Vali Loss: 1.314 Vali Acc: 0.597 Test Loss: 1.314 Test Acc: 0.597
Validation loss decreased (-0.553110 --> -0.596862).  Saving model ...
Epoch: 6 cost time: 2.98000431060791
Epoch: 6, Steps: 8 | Train Loss: 0.941 Vali Loss: 1.203 Vali Acc: 0.591 Test Loss: 1.203 Test Acc: 0.591
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6746253967285156
Epoch: 7, Steps: 8 | Train Loss: 0.764 Vali Loss: 1.121 Vali Acc: 0.622 Test Loss: 1.121 Test Acc: 0.622
Validation loss decreased (-0.596862 --> -0.621864).  Saving model ...
Epoch: 8 cost time: 2.800846576690674
Epoch: 8, Steps: 8 | Train Loss: 0.645 Vali Loss: 1.072 Vali Acc: 0.625 Test Loss: 1.072 Test Acc: 0.625
Validation loss decreased (-0.621864 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 3.037158966064453
Epoch: 9, Steps: 8 | Train Loss: 0.522 Vali Loss: 1.021 Vali Acc: 0.656 Test Loss: 1.021 Test Acc: 0.656
Validation loss decreased (-0.624989 --> -0.656240).  Saving model ...
Epoch: 10 cost time: 3.0891005992889404
Epoch: 10, Steps: 8 | Train Loss: 0.389 Vali Loss: 1.006 Vali Acc: 0.675 Test Loss: 1.006 Test Acc: 0.675
Validation loss decreased (-0.656240 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 2.405797243118286
Epoch: 11, Steps: 8 | Train Loss: 0.319 Vali Loss: 1.000 Vali Acc: 0.650 Test Loss: 1.000 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.666726589202881
Epoch: 12, Steps: 8 | Train Loss: 0.271 Vali Loss: 1.004 Vali Acc: 0.650 Test Loss: 1.004 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.86519455909729
Epoch: 13, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.995 Vali Acc: 0.656 Test Loss: 0.995 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6195809841156006
Epoch: 14, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.982 Vali Acc: 0.662 Test Loss: 0.982 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.71907901763916
Epoch: 15, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9552509784698486
Epoch: 16, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.023 Vali Acc: 0.641 Test Loss: 1.023 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.8547379970550537
Epoch: 17, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.077 Vali Acc: 0.650 Test Loss: 1.077 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.6619081497192383
Epoch: 18, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.089 Vali Acc: 0.656 Test Loss: 1.089 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.666224718093872
Epoch: 19, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.083 Vali Acc: 0.653 Test Loss: 1.083 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.975773572921753
Epoch: 20, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.084 Vali Acc: 0.656 Test Loss: 1.084 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.675
model parameter : 221768
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.263132810592651
Epoch: 1, Steps: 8 | Train Loss: 2.152 Vali Loss: 2.058 Vali Acc: 0.134 Test Loss: 2.058 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 3.137619733810425
Epoch: 2, Steps: 8 | Train Loss: 2.067 Vali Loss: 1.938 Vali Acc: 0.247 Test Loss: 1.938 Test Acc: 0.247
Validation loss decreased (-0.134354 --> -0.246856).  Saving model ...
Epoch: 3 cost time: 2.9618070125579834
Epoch: 3, Steps: 8 | Train Loss: 1.845 Vali Loss: 1.801 Vali Acc: 0.406 Test Loss: 1.801 Test Acc: 0.406
Validation loss decreased (-0.246856 --> -0.406232).  Saving model ...
Epoch: 4 cost time: 3.1569321155548096
Epoch: 4, Steps: 8 | Train Loss: 1.701 Vali Loss: 1.663 Vali Acc: 0.491 Test Loss: 1.663 Test Acc: 0.491
Validation loss decreased (-0.406232 --> -0.490608).  Saving model ...
Epoch: 5 cost time: 2.9995768070220947
Epoch: 5, Steps: 8 | Train Loss: 1.425 Vali Loss: 1.526 Vali Acc: 0.503 Test Loss: 1.526 Test Acc: 0.503
Validation loss decreased (-0.490608 --> -0.503110).  Saving model ...
Epoch: 6 cost time: 2.904362678527832
Epoch: 6, Steps: 8 | Train Loss: 1.218 Vali Loss: 1.406 Vali Acc: 0.544 Test Loss: 1.406 Test Acc: 0.544
Validation loss decreased (-0.503110 --> -0.543736).  Saving model ...
Epoch: 7 cost time: 3.0313589572906494
Epoch: 7, Steps: 8 | Train Loss: 1.029 Vali Loss: 1.302 Vali Acc: 0.547 Test Loss: 1.302 Test Acc: 0.547
Validation loss decreased (-0.543736 --> -0.546862).  Saving model ...
Epoch: 8 cost time: 3.1696763038635254
Epoch: 8, Steps: 8 | Train Loss: 0.861 Vali Loss: 1.228 Vali Acc: 0.600 Test Loss: 1.228 Test Acc: 0.600
Validation loss decreased (-0.546862 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 2.755781888961792
Epoch: 9, Steps: 8 | Train Loss: 0.718 Vali Loss: 1.164 Vali Acc: 0.594 Test Loss: 1.164 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.232900857925415
Epoch: 10, Steps: 8 | Train Loss: 0.570 Vali Loss: 1.119 Vali Acc: 0.597 Test Loss: 1.119 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2533860206604004
Epoch: 11, Steps: 8 | Train Loss: 0.481 Vali Loss: 1.089 Vali Acc: 0.609 Test Loss: 1.089 Test Acc: 0.609
Validation loss decreased (-0.599988 --> -0.609364).  Saving model ...
Epoch: 12 cost time: 3.1967382431030273
Epoch: 12, Steps: 8 | Train Loss: 0.411 Vali Loss: 1.049 Vali Acc: 0.634 Test Loss: 1.049 Test Acc: 0.634
Validation loss decreased (-0.609364 --> -0.634365).  Saving model ...
Epoch: 13 cost time: 3.08752703666687
Epoch: 13, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.044 Vali Acc: 0.619 Test Loss: 1.044 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.698500156402588
Epoch: 14, Steps: 8 | Train Loss: 0.243 Vali Loss: 1.017 Vali Acc: 0.628 Test Loss: 1.017 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1295981407165527
Epoch: 15, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.034 Vali Acc: 0.622 Test Loss: 1.034 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9369399547576904
Epoch: 16, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.058 Vali Acc: 0.622 Test Loss: 1.058 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.909268617630005
Epoch: 17, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.095 Vali Acc: 0.616 Test Loss: 1.095 Test Acc: 0.616
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.1892545223236084
Epoch: 18, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.123 Vali Acc: 0.591 Test Loss: 1.123 Test Acc: 0.591
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.2346861362457275
Epoch: 19, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.111 Vali Acc: 0.609 Test Loss: 1.111 Test Acc: 0.609
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.9493424892425537
Epoch: 20, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.144 Vali Acc: 0.616 Test Loss: 1.144 Test Acc: 0.616
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.882314682006836
Epoch: 21, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.108 Vali Acc: 0.619 Test Loss: 1.108 Test Acc: 0.619
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.133556842803955
Epoch: 22, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.136 Vali Acc: 0.616 Test Loss: 1.136 Test Acc: 0.616
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.634375
model parameter : 221768
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9546375274658203
Epoch: 1, Steps: 8 | Train Loss: 2.165 Vali Loss: 2.102 Vali Acc: 0.156 Test Loss: 2.102 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 3.0699946880340576
Epoch: 2, Steps: 8 | Train Loss: 2.095 Vali Loss: 2.024 Vali Acc: 0.200 Test Loss: 2.024 Test Acc: 0.200
Validation loss decreased (-0.156229 --> -0.199980).  Saving model ...
Epoch: 3 cost time: 2.949843168258667
Epoch: 3, Steps: 8 | Train Loss: 1.930 Vali Loss: 1.949 Vali Acc: 0.303 Test Loss: 1.949 Test Acc: 0.303
Validation loss decreased (-0.199980 --> -0.303106).  Saving model ...
Epoch: 4 cost time: 3.0834317207336426
Epoch: 4, Steps: 8 | Train Loss: 1.841 Vali Loss: 1.865 Vali Acc: 0.388 Test Loss: 1.865 Test Acc: 0.388
Validation loss decreased (-0.303106 --> -0.387481).  Saving model ...
Epoch: 5 cost time: 3.2345640659332275
Epoch: 5, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.774 Vali Acc: 0.397 Test Loss: 1.774 Test Acc: 0.397
Validation loss decreased (-0.387481 --> -0.396857).  Saving model ...
Epoch: 6 cost time: 2.906914710998535
Epoch: 6, Steps: 8 | Train Loss: 1.469 Vali Loss: 1.691 Vali Acc: 0.394 Test Loss: 1.691 Test Acc: 0.394
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.030463695526123
Epoch: 7, Steps: 8 | Train Loss: 1.287 Vali Loss: 1.598 Vali Acc: 0.463 Test Loss: 1.598 Test Acc: 0.463
Validation loss decreased (-0.396857 --> -0.462484).  Saving model ...
Epoch: 8 cost time: 3.0742719173431396
Epoch: 8, Steps: 8 | Train Loss: 1.178 Vali Loss: 1.535 Vali Acc: 0.450 Test Loss: 1.535 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6674916744232178
Epoch: 9, Steps: 8 | Train Loss: 0.992 Vali Loss: 1.476 Vali Acc: 0.463 Test Loss: 1.476 Test Acc: 0.463
Validation loss decreased (-0.462484 --> -0.462485).  Saving model ...
Epoch: 10 cost time: 2.9899067878723145
Epoch: 10, Steps: 8 | Train Loss: 0.801 Vali Loss: 1.407 Vali Acc: 0.481 Test Loss: 1.407 Test Acc: 0.481
Validation loss decreased (-0.462485 --> -0.481236).  Saving model ...
Epoch: 11 cost time: 3.095752000808716
Epoch: 11, Steps: 8 | Train Loss: 0.684 Vali Loss: 1.381 Vali Acc: 0.525 Test Loss: 1.381 Test Acc: 0.525
Validation loss decreased (-0.481236 --> -0.524986).  Saving model ...
Epoch: 12 cost time: 2.721845865249634
Epoch: 12, Steps: 8 | Train Loss: 0.607 Vali Loss: 1.382 Vali Acc: 0.497 Test Loss: 1.382 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6905791759490967
Epoch: 13, Steps: 8 | Train Loss: 0.505 Vali Loss: 1.359 Vali Acc: 0.503 Test Loss: 1.359 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0482518672943115
Epoch: 14, Steps: 8 | Train Loss: 0.406 Vali Loss: 1.340 Vali Acc: 0.512 Test Loss: 1.340 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7735912799835205
Epoch: 15, Steps: 8 | Train Loss: 0.326 Vali Loss: 1.321 Vali Acc: 0.516 Test Loss: 1.321 Test Acc: 0.516
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.5120227336883545
Epoch: 16, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.347 Vali Acc: 0.528 Test Loss: 1.347 Test Acc: 0.528
Validation loss decreased (-0.524986 --> -0.528112).  Saving model ...
Epoch: 17 cost time: 3.022005319595337
Epoch: 17, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.405 Vali Acc: 0.500 Test Loss: 1.405 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9834911823272705
Epoch: 18, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.347 Vali Acc: 0.522 Test Loss: 1.347 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.2778544425964355
Epoch: 19, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.255 Vali Acc: 0.553 Test Loss: 1.255 Test Acc: 0.553
Validation loss decreased (-0.528112 --> -0.553112).  Saving model ...
Epoch: 20 cost time: 3.6254167556762695
Epoch: 20, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.477 Vali Acc: 0.484 Test Loss: 1.477 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6982531547546387
Epoch: 21, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.289 Vali Acc: 0.556 Test Loss: 1.289 Test Acc: 0.556
Validation loss decreased (-0.553112 --> -0.556237).  Saving model ...
Epoch: 22 cost time: 2.7562310695648193
Epoch: 22, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.365 Vali Acc: 0.528 Test Loss: 1.365 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.945194959640503
Epoch: 23, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.460 Vali Acc: 0.534 Test Loss: 1.460 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.0478334426879883
Epoch: 24, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.427 Vali Acc: 0.522 Test Loss: 1.427 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.9168431758880615
Epoch: 25, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.528 Vali Acc: 0.494 Test Loss: 1.528 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.015381336212158
Epoch: 26, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.451 Vali Acc: 0.550 Test Loss: 1.451 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.206127405166626
Epoch: 27, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.633 Vali Acc: 0.509 Test Loss: 1.633 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.106060028076172
Epoch: 28, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.563 Vali Acc: 0.497 Test Loss: 1.563 Test Acc: 0.497
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.64357590675354
Epoch: 29, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.549 Vali Acc: 0.512 Test Loss: 1.549 Test Acc: 0.512
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.136146068572998
Epoch: 30, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.548 Vali Acc: 0.522 Test Loss: 1.548 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.2773616313934326
Epoch: 31, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.555 Vali Acc: 0.531 Test Loss: 1.555 Test Acc: 0.531
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.55625
model parameter : 221768
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.569508075714111
Epoch: 1, Steps: 8 | Train Loss: 2.184 Vali Loss: 2.109 Vali Acc: 0.113 Test Loss: 2.109 Test Acc: 0.113
Validation loss decreased (inf --> -0.112479).  Saving model ...
Epoch: 2 cost time: 3.121755599975586
Epoch: 2, Steps: 8 | Train Loss: 2.100 Vali Loss: 2.067 Vali Acc: 0.225 Test Loss: 2.067 Test Acc: 0.225
Validation loss decreased (-0.112479 --> -0.224979).  Saving model ...
Epoch: 3 cost time: 2.6765050888061523
Epoch: 3, Steps: 8 | Train Loss: 1.990 Vali Loss: 2.026 Vali Acc: 0.244 Test Loss: 2.026 Test Acc: 0.244
Validation loss decreased (-0.224979 --> -0.243730).  Saving model ...
Epoch: 4 cost time: 3.727048873901367
Epoch: 4, Steps: 8 | Train Loss: 1.955 Vali Loss: 1.978 Vali Acc: 0.350 Test Loss: 1.978 Test Acc: 0.350
Validation loss decreased (-0.243730 --> -0.349980).  Saving model ...
Epoch: 5 cost time: 3.064384698867798
Epoch: 5, Steps: 8 | Train Loss: 1.759 Vali Loss: 1.919 Vali Acc: 0.291 Test Loss: 1.919 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8602335453033447
Epoch: 6, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.869 Vali Acc: 0.325 Test Loss: 1.869 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1348073482513428
Epoch: 7, Steps: 8 | Train Loss: 1.491 Vali Loss: 1.797 Vali Acc: 0.400 Test Loss: 1.797 Test Acc: 0.400
Validation loss decreased (-0.349980 --> -0.399982).  Saving model ...
Epoch: 8 cost time: 3.2813076972961426
Epoch: 8, Steps: 8 | Train Loss: 1.397 Vali Loss: 1.741 Vali Acc: 0.384 Test Loss: 1.741 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5765011310577393
Epoch: 9, Steps: 8 | Train Loss: 1.219 Vali Loss: 1.697 Vali Acc: 0.344 Test Loss: 1.697 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9847395420074463
Epoch: 10, Steps: 8 | Train Loss: 1.029 Vali Loss: 1.618 Vali Acc: 0.450 Test Loss: 1.618 Test Acc: 0.450
Validation loss decreased (-0.399982 --> -0.449984).  Saving model ...
Epoch: 11 cost time: 3.201855182647705
Epoch: 11, Steps: 8 | Train Loss: 0.880 Vali Loss: 1.551 Vali Acc: 0.484 Test Loss: 1.551 Test Acc: 0.484
Validation loss decreased (-0.449984 --> -0.484359).  Saving model ...
Epoch: 12 cost time: 2.735442638397217
Epoch: 12, Steps: 8 | Train Loss: 0.769 Vali Loss: 1.517 Vali Acc: 0.444 Test Loss: 1.517 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.080634832382202
Epoch: 13, Steps: 8 | Train Loss: 0.636 Vali Loss: 1.486 Vali Acc: 0.425 Test Loss: 1.486 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.072418212890625
Epoch: 14, Steps: 8 | Train Loss: 0.550 Vali Loss: 1.432 Vali Acc: 0.456 Test Loss: 1.432 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.030622959136963
Epoch: 15, Steps: 8 | Train Loss: 0.444 Vali Loss: 1.353 Vali Acc: 0.484 Test Loss: 1.353 Test Acc: 0.484
Validation loss decreased (-0.484359 --> -0.484361).  Saving model ...
Epoch: 16 cost time: 3.014160633087158
Epoch: 16, Steps: 8 | Train Loss: 0.408 Vali Loss: 1.367 Vali Acc: 0.472 Test Loss: 1.367 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.057851791381836
Epoch: 17, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.413 Vali Acc: 0.459 Test Loss: 1.413 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1272382736206055
Epoch: 18, Steps: 8 | Train Loss: 0.289 Vali Loss: 1.323 Vali Acc: 0.522 Test Loss: 1.323 Test Acc: 0.522
Validation loss decreased (-0.484361 --> -0.521862).  Saving model ...
Epoch: 19 cost time: 2.9411096572875977
Epoch: 19, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.277 Vali Acc: 0.528 Test Loss: 1.277 Test Acc: 0.528
Validation loss decreased (-0.521862 --> -0.528112).  Saving model ...
Epoch: 20 cost time: 3.068011522293091
Epoch: 20, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.501 Vali Acc: 0.406 Test Loss: 1.501 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.155883312225342
Epoch: 21, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.348 Vali Acc: 0.509 Test Loss: 1.348 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.886863946914673
Epoch: 22, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.388 Vali Acc: 0.494 Test Loss: 1.388 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.92824125289917
Epoch: 23, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.445 Vali Acc: 0.472 Test Loss: 1.445 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.0735275745391846
Epoch: 24, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.500 Vali Acc: 0.456 Test Loss: 1.500 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.834007978439331
Epoch: 25, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.559 Vali Acc: 0.475 Test Loss: 1.559 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.7024223804473877
Epoch: 26, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.529 Vali Acc: 0.500 Test Loss: 1.529 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.320211887359619
Epoch: 27, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.643 Vali Acc: 0.463 Test Loss: 1.643 Test Acc: 0.463
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.088306427001953
Epoch: 28, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.560 Vali Acc: 0.516 Test Loss: 1.560 Test Acc: 0.516
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.5637545585632324
Epoch: 29, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.690 Vali Acc: 0.484 Test Loss: 1.690 Test Acc: 0.484
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.528125
model parameter : 221768
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.463907718658447
Epoch: 1, Steps: 8 | Train Loss: 2.260 Vali Loss: 2.193 Vali Acc: 0.122 Test Loss: 2.193 Test Acc: 0.122
Validation loss decreased (inf --> -0.121853).  Saving model ...
Epoch: 2 cost time: 3.0627729892730713
Epoch: 2, Steps: 8 | Train Loss: 2.136 Vali Loss: 2.101 Vali Acc: 0.128 Test Loss: 2.101 Test Acc: 0.128
Validation loss decreased (-0.121853 --> -0.128104).  Saving model ...
Epoch: 3 cost time: 2.7030105590820312
Epoch: 3, Steps: 8 | Train Loss: 2.017 Vali Loss: 2.042 Vali Acc: 0.231 Test Loss: 2.042 Test Acc: 0.231
Validation loss decreased (-0.128104 --> -0.231230).  Saving model ...
Epoch: 4 cost time: 3.263522148132324
Epoch: 4, Steps: 8 | Train Loss: 1.983 Vali Loss: 2.007 Vali Acc: 0.284 Test Loss: 2.007 Test Acc: 0.284
Validation loss decreased (-0.231230 --> -0.284355).  Saving model ...
Epoch: 5 cost time: 2.9511687755584717
Epoch: 5, Steps: 8 | Train Loss: 1.812 Vali Loss: 1.968 Vali Acc: 0.325 Test Loss: 1.968 Test Acc: 0.325
Validation loss decreased (-0.284355 --> -0.324980).  Saving model ...
Epoch: 6 cost time: 2.7475433349609375
Epoch: 6, Steps: 8 | Train Loss: 1.683 Vali Loss: 1.943 Vali Acc: 0.150 Test Loss: 1.943 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.794536828994751
Epoch: 7, Steps: 8 | Train Loss: 1.549 Vali Loss: 1.883 Vali Acc: 0.350 Test Loss: 1.883 Test Acc: 0.350
Validation loss decreased (-0.324980 --> -0.349981).  Saving model ...
Epoch: 8 cost time: 2.6574277877807617
Epoch: 8, Steps: 8 | Train Loss: 1.461 Vali Loss: 1.827 Vali Acc: 0.356 Test Loss: 1.827 Test Acc: 0.356
Validation loss decreased (-0.349981 --> -0.356232).  Saving model ...
Epoch: 9 cost time: 2.644050121307373
Epoch: 9, Steps: 8 | Train Loss: 1.300 Vali Loss: 1.776 Vali Acc: 0.388 Test Loss: 1.776 Test Acc: 0.388
Validation loss decreased (-0.356232 --> -0.387482).  Saving model ...
Epoch: 10 cost time: 2.939607858657837
Epoch: 10, Steps: 8 | Train Loss: 1.108 Vali Loss: 1.718 Vali Acc: 0.381 Test Loss: 1.718 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6692826747894287
Epoch: 11, Steps: 8 | Train Loss: 0.979 Vali Loss: 1.651 Vali Acc: 0.434 Test Loss: 1.651 Test Acc: 0.434
Validation loss decreased (-0.387482 --> -0.434358).  Saving model ...
Epoch: 12 cost time: 2.79325795173645
Epoch: 12, Steps: 8 | Train Loss: 0.848 Vali Loss: 1.597 Vali Acc: 0.431 Test Loss: 1.597 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8809516429901123
Epoch: 13, Steps: 8 | Train Loss: 0.746 Vali Loss: 1.551 Vali Acc: 0.441 Test Loss: 1.551 Test Acc: 0.441
Validation loss decreased (-0.434358 --> -0.440609).  Saving model ...
Epoch: 14 cost time: 2.699465751647949
Epoch: 14, Steps: 8 | Train Loss: 0.600 Vali Loss: 1.505 Vali Acc: 0.431 Test Loss: 1.505 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2325656414031982
Epoch: 15, Steps: 8 | Train Loss: 0.526 Vali Loss: 1.407 Vali Acc: 0.484 Test Loss: 1.407 Test Acc: 0.484
Validation loss decreased (-0.440609 --> -0.484361).  Saving model ...
Epoch: 16 cost time: 2.879056453704834
Epoch: 16, Steps: 8 | Train Loss: 0.444 Vali Loss: 1.417 Vali Acc: 0.463 Test Loss: 1.417 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8961081504821777
Epoch: 17, Steps: 8 | Train Loss: 0.398 Vali Loss: 1.414 Vali Acc: 0.466 Test Loss: 1.414 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0022530555725098
Epoch: 18, Steps: 8 | Train Loss: 0.347 Vali Loss: 1.385 Vali Acc: 0.463 Test Loss: 1.385 Test Acc: 0.463
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0064878463745117
Epoch: 19, Steps: 8 | Train Loss: 0.340 Vali Loss: 1.342 Vali Acc: 0.478 Test Loss: 1.342 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.739043712615967
Epoch: 20, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.562 Vali Acc: 0.412 Test Loss: 1.562 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.456059694290161
Epoch: 21, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.592 Vali Acc: 0.409 Test Loss: 1.592 Test Acc: 0.409
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5943007469177246
Epoch: 22, Steps: 8 | Train Loss: 0.202 Vali Loss: 1.430 Vali Acc: 0.487 Test Loss: 1.430 Test Acc: 0.487
Validation loss decreased (-0.484361 --> -0.487486).  Saving model ...
Epoch: 23 cost time: 2.503899574279785
Epoch: 23, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.516 Vali Acc: 0.450 Test Loss: 1.516 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.754803419113159
Epoch: 24, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.601 Vali Acc: 0.456 Test Loss: 1.601 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.5996687412261963
Epoch: 25, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.756 Vali Acc: 0.444 Test Loss: 1.756 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.116342782974243
Epoch: 26, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.639 Vali Acc: 0.469 Test Loss: 1.639 Test Acc: 0.469
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.34686279296875
Epoch: 27, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.795 Vali Acc: 0.438 Test Loss: 1.795 Test Acc: 0.438
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.872490406036377
Epoch: 28, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.684 Vali Acc: 0.438 Test Loss: 1.684 Test Acc: 0.438
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.7616405487060547
Epoch: 29, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.975 Vali Acc: 0.422 Test Loss: 1.975 Test Acc: 0.422
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.7797677516937256
Epoch: 30, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.796 Vali Acc: 0.459 Test Loss: 1.796 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.9476654529571533
Epoch: 31, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.708 Vali Acc: 0.469 Test Loss: 1.708 Test Acc: 0.469
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.965740442276001
Epoch: 32, Steps: 8 | Train Loss: 0.067 Vali Loss: 2.095 Vali Acc: 0.391 Test Loss: 2.095 Test Acc: 0.391
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.4875
model parameter : 221768
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.035197496414185
Epoch: 1, Steps: 8 | Train Loss: 2.240 Vali Loss: 2.213 Vali Acc: 0.125 Test Loss: 2.213 Test Acc: 0.125
Validation loss decreased (inf --> -0.124978).  Saving model ...
Epoch: 2 cost time: 2.5109825134277344
Epoch: 2, Steps: 8 | Train Loss: 2.150 Vali Loss: 2.138 Vali Acc: 0.125 Test Loss: 2.138 Test Acc: 0.125
Validation loss decreased (-0.124978 --> -0.124979).  Saving model ...
Epoch: 3 cost time: 2.719115734100342
Epoch: 3, Steps: 8 | Train Loss: 2.034 Vali Loss: 2.078 Vali Acc: 0.125 Test Loss: 2.078 Test Acc: 0.125
Validation loss decreased (-0.124979 --> -0.124979).  Saving model ...
Epoch: 4 cost time: 2.477642059326172
Epoch: 4, Steps: 8 | Train Loss: 1.973 Vali Loss: 2.043 Vali Acc: 0.134 Test Loss: 2.043 Test Acc: 0.134
Validation loss decreased (-0.124979 --> -0.134355).  Saving model ...
Epoch: 5 cost time: 2.4684510231018066
Epoch: 5, Steps: 8 | Train Loss: 1.797 Vali Loss: 2.010 Vali Acc: 0.188 Test Loss: 2.010 Test Acc: 0.188
Validation loss decreased (-0.134355 --> -0.187480).  Saving model ...
Epoch: 6 cost time: 2.696493625640869
Epoch: 6, Steps: 8 | Train Loss: 1.673 Vali Loss: 1.992 Vali Acc: 0.125 Test Loss: 1.992 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.601822853088379
Epoch: 7, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.950 Vali Acc: 0.256 Test Loss: 1.950 Test Acc: 0.256
Validation loss decreased (-0.187480 --> -0.256230).  Saving model ...
Epoch: 8 cost time: 2.773639440536499
Epoch: 8, Steps: 8 | Train Loss: 1.414 Vali Loss: 1.894 Vali Acc: 0.338 Test Loss: 1.894 Test Acc: 0.338
Validation loss decreased (-0.256230 --> -0.337481).  Saving model ...
Epoch: 9 cost time: 2.658689022064209
Epoch: 9, Steps: 8 | Train Loss: 1.267 Vali Loss: 1.853 Vali Acc: 0.325 Test Loss: 1.853 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7909228801727295
Epoch: 10, Steps: 8 | Train Loss: 1.120 Vali Loss: 1.816 Vali Acc: 0.303 Test Loss: 1.816 Test Acc: 0.303
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7392404079437256
Epoch: 11, Steps: 8 | Train Loss: 0.971 Vali Loss: 1.765 Vali Acc: 0.372 Test Loss: 1.765 Test Acc: 0.372
Validation loss decreased (-0.337481 --> -0.371857).  Saving model ...
Epoch: 12 cost time: 2.7230148315429688
Epoch: 12, Steps: 8 | Train Loss: 0.855 Vali Loss: 1.703 Vali Acc: 0.419 Test Loss: 1.703 Test Acc: 0.419
Validation loss decreased (-0.371857 --> -0.418733).  Saving model ...
Epoch: 13 cost time: 2.5741004943847656
Epoch: 13, Steps: 8 | Train Loss: 0.778 Vali Loss: 1.669 Vali Acc: 0.428 Test Loss: 1.669 Test Acc: 0.428
Validation loss decreased (-0.418733 --> -0.428108).  Saving model ...
Epoch: 14 cost time: 2.498839855194092
Epoch: 14, Steps: 8 | Train Loss: 0.641 Vali Loss: 1.623 Vali Acc: 0.434 Test Loss: 1.623 Test Acc: 0.434
Validation loss decreased (-0.428108 --> -0.434359).  Saving model ...
Epoch: 15 cost time: 2.6294426918029785
Epoch: 15, Steps: 8 | Train Loss: 0.563 Vali Loss: 1.555 Vali Acc: 0.497 Test Loss: 1.555 Test Acc: 0.497
Validation loss decreased (-0.434359 --> -0.496859).  Saving model ...
Epoch: 16 cost time: 2.817464828491211
Epoch: 16, Steps: 8 | Train Loss: 0.485 Vali Loss: 1.512 Vali Acc: 0.512 Test Loss: 1.512 Test Acc: 0.512
Validation loss decreased (-0.496859 --> -0.512485).  Saving model ...
Epoch: 17 cost time: 2.337198257446289
Epoch: 17, Steps: 8 | Train Loss: 0.449 Vali Loss: 1.493 Vali Acc: 0.459 Test Loss: 1.493 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5546345710754395
Epoch: 18, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.418 Vali Acc: 0.575 Test Loss: 1.418 Test Acc: 0.575
Validation loss decreased (-0.512485 --> -0.574986).  Saving model ...
Epoch: 19 cost time: 2.690538167953491
Epoch: 19, Steps: 8 | Train Loss: 0.392 Vali Loss: 1.354 Vali Acc: 0.516 Test Loss: 1.354 Test Acc: 0.516
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.565310001373291
Epoch: 20, Steps: 8 | Train Loss: 0.314 Vali Loss: 1.391 Vali Acc: 0.484 Test Loss: 1.391 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6257143020629883
Epoch: 21, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.417 Vali Acc: 0.441 Test Loss: 1.417 Test Acc: 0.441
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.603348970413208
Epoch: 22, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4737894535064697
Epoch: 23, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.415 Vali Acc: 0.469 Test Loss: 1.415 Test Acc: 0.469
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.383251190185547
Epoch: 24, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.412 Vali Acc: 0.481 Test Loss: 1.412 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.595834732055664
Epoch: 25, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.431 Vali Acc: 0.475 Test Loss: 1.431 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.6952273845672607
Epoch: 26, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.517 Vali Acc: 0.472 Test Loss: 1.517 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.583069324493408
Epoch: 27, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.542 Vali Acc: 0.456 Test Loss: 1.542 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.556727170944214
Epoch: 28, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.599 Vali Acc: 0.444 Test Loss: 1.599 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.575
model parameter : 221768
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.432682275772095
Epoch: 1, Steps: 8 | Train Loss: 2.168 Vali Loss: 2.131 Vali Acc: 0.144 Test Loss: 2.131 Test Acc: 0.144
Validation loss decreased (inf --> -0.143729).  Saving model ...
Epoch: 2 cost time: 3.100721836090088
Epoch: 2, Steps: 8 | Train Loss: 2.096 Vali Loss: 2.118 Vali Acc: 0.159 Test Loss: 2.118 Test Acc: 0.159
Validation loss decreased (-0.143729 --> -0.159354).  Saving model ...
Epoch: 3 cost time: 2.977027177810669
Epoch: 3, Steps: 8 | Train Loss: 2.076 Vali Loss: 2.103 Vali Acc: 0.188 Test Loss: 2.103 Test Acc: 0.188
Validation loss decreased (-0.159354 --> -0.187479).  Saving model ...
Epoch: 4 cost time: 2.751175880432129
Epoch: 4, Steps: 8 | Train Loss: 1.907 Vali Loss: 2.083 Vali Acc: 0.200 Test Loss: 2.083 Test Acc: 0.200
Validation loss decreased (-0.187479 --> -0.199979).  Saving model ...
Epoch: 5 cost time: 2.6713714599609375
Epoch: 5, Steps: 8 | Train Loss: 1.821 Vali Loss: 2.049 Vali Acc: 0.216 Test Loss: 2.049 Test Acc: 0.216
Validation loss decreased (-0.199979 --> -0.215605).  Saving model ...
Epoch: 6 cost time: 2.5867063999176025
Epoch: 6, Steps: 8 | Train Loss: 1.715 Vali Loss: 2.018 Vali Acc: 0.209 Test Loss: 2.018 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.466731071472168
Epoch: 7, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.981 Vali Acc: 0.222 Test Loss: 1.981 Test Acc: 0.222
Validation loss decreased (-0.215605 --> -0.221855).  Saving model ...
Epoch: 8 cost time: 2.6096761226654053
Epoch: 8, Steps: 8 | Train Loss: 1.459 Vali Loss: 1.932 Vali Acc: 0.228 Test Loss: 1.932 Test Acc: 0.228
Validation loss decreased (-0.221855 --> -0.228106).  Saving model ...
Epoch: 9 cost time: 2.494981527328491
Epoch: 9, Steps: 8 | Train Loss: 1.341 Vali Loss: 1.905 Vali Acc: 0.212 Test Loss: 1.905 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6346373558044434
Epoch: 10, Steps: 8 | Train Loss: 1.218 Vali Loss: 1.863 Vali Acc: 0.244 Test Loss: 1.863 Test Acc: 0.244
Validation loss decreased (-0.228106 --> -0.243731).  Saving model ...
Epoch: 11 cost time: 2.600996971130371
Epoch: 11, Steps: 8 | Train Loss: 1.092 Vali Loss: 1.815 Vali Acc: 0.359 Test Loss: 1.815 Test Acc: 0.359
Validation loss decreased (-0.243731 --> -0.359357).  Saving model ...
Epoch: 12 cost time: 2.4526526927948
Epoch: 12, Steps: 8 | Train Loss: 0.929 Vali Loss: 1.771 Vali Acc: 0.375 Test Loss: 1.771 Test Acc: 0.375
Validation loss decreased (-0.359357 --> -0.374982).  Saving model ...
Epoch: 13 cost time: 3.0115866661071777
Epoch: 13, Steps: 8 | Train Loss: 0.920 Vali Loss: 1.744 Vali Acc: 0.353 Test Loss: 1.744 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9079766273498535
Epoch: 14, Steps: 8 | Train Loss: 0.759 Vali Loss: 1.736 Vali Acc: 0.334 Test Loss: 1.736 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1595802307128906
Epoch: 15, Steps: 8 | Train Loss: 0.681 Vali Loss: 1.681 Vali Acc: 0.350 Test Loss: 1.681 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1435015201568604
Epoch: 16, Steps: 8 | Train Loss: 0.613 Vali Loss: 1.624 Vali Acc: 0.391 Test Loss: 1.624 Test Acc: 0.391
Validation loss decreased (-0.374982 --> -0.390609).  Saving model ...
Epoch: 17 cost time: 2.7032923698425293
Epoch: 17, Steps: 8 | Train Loss: 0.579 Vali Loss: 1.613 Vali Acc: 0.381 Test Loss: 1.613 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7409465312957764
Epoch: 18, Steps: 8 | Train Loss: 0.506 Vali Loss: 1.554 Vali Acc: 0.425 Test Loss: 1.554 Test Acc: 0.425
Validation loss decreased (-0.390609 --> -0.424984).  Saving model ...
Epoch: 19 cost time: 2.900341272354126
Epoch: 19, Steps: 8 | Train Loss: 0.459 Vali Loss: 1.497 Vali Acc: 0.469 Test Loss: 1.497 Test Acc: 0.469
Validation loss decreased (-0.424984 --> -0.468735).  Saving model ...
Epoch: 20 cost time: 2.9262540340423584
Epoch: 20, Steps: 8 | Train Loss: 0.416 Vali Loss: 1.568 Vali Acc: 0.397 Test Loss: 1.568 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.897899866104126
Epoch: 21, Steps: 8 | Train Loss: 0.361 Vali Loss: 1.597 Vali Acc: 0.359 Test Loss: 1.597 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.8459668159484863
Epoch: 22, Steps: 8 | Train Loss: 0.335 Vali Loss: 1.544 Vali Acc: 0.469 Test Loss: 1.544 Test Acc: 0.469
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.8055078983306885
Epoch: 23, Steps: 8 | Train Loss: 0.329 Vali Loss: 1.483 Vali Acc: 0.463 Test Loss: 1.483 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.962432622909546
Epoch: 24, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.518 Vali Acc: 0.422 Test Loss: 1.518 Test Acc: 0.422
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8045260906219482
Epoch: 25, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.563 Vali Acc: 0.438 Test Loss: 1.563 Test Acc: 0.438
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.9136054515838623
Epoch: 26, Steps: 8 | Train Loss: 0.228 Vali Loss: 1.607 Vali Acc: 0.419 Test Loss: 1.607 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.137904644012451
Epoch: 27, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.568 Vali Acc: 0.431 Test Loss: 1.568 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.83305287361145
Epoch: 28, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.658 Vali Acc: 0.409 Test Loss: 1.658 Test Acc: 0.409
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.84183669090271
Epoch: 29, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.727 Vali Acc: 0.422 Test Loss: 1.727 Test Acc: 0.422
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.46875
model parameter : 221768
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.01520299911499
Epoch: 1, Steps: 8 | Train Loss: 2.182 Vali Loss: 2.141 Vali Acc: 0.144 Test Loss: 2.141 Test Acc: 0.144
Validation loss decreased (inf --> -0.143729).  Saving model ...
Epoch: 2 cost time: 2.4873764514923096
Epoch: 2, Steps: 8 | Train Loss: 2.208 Vali Loss: 2.130 Vali Acc: 0.150 Test Loss: 2.130 Test Acc: 0.150
Validation loss decreased (-0.143729 --> -0.149979).  Saving model ...
Epoch: 3 cost time: 2.5970869064331055
Epoch: 3, Steps: 8 | Train Loss: 2.072 Vali Loss: 2.113 Vali Acc: 0.184 Test Loss: 2.113 Test Acc: 0.184
Validation loss decreased (-0.149979 --> -0.184354).  Saving model ...
Epoch: 4 cost time: 2.555185079574585
Epoch: 4, Steps: 8 | Train Loss: 2.004 Vali Loss: 2.092 Vali Acc: 0.159 Test Loss: 2.092 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8243019580841064
Epoch: 5, Steps: 8 | Train Loss: 1.848 Vali Loss: 2.078 Vali Acc: 0.156 Test Loss: 2.078 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.723616600036621
Epoch: 6, Steps: 8 | Train Loss: 1.749 Vali Loss: 2.067 Vali Acc: 0.194 Test Loss: 2.067 Test Acc: 0.194
Validation loss decreased (-0.184354 --> -0.193729).  Saving model ...
Epoch: 7 cost time: 2.5732336044311523
Epoch: 7, Steps: 8 | Train Loss: 1.742 Vali Loss: 2.037 Vali Acc: 0.194 Test Loss: 2.037 Test Acc: 0.194
Validation loss decreased (-0.193729 --> -0.193730).  Saving model ...
Epoch: 8 cost time: 2.5049993991851807
Epoch: 8, Steps: 8 | Train Loss: 1.575 Vali Loss: 2.009 Vali Acc: 0.159 Test Loss: 2.009 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.617069959640503
Epoch: 9, Steps: 8 | Train Loss: 1.446 Vali Loss: 1.992 Vali Acc: 0.125 Test Loss: 1.992 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7949771881103516
Epoch: 10, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.948 Vali Acc: 0.147 Test Loss: 1.948 Test Acc: 0.147
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8199520111083984
Epoch: 11, Steps: 8 | Train Loss: 1.221 Vali Loss: 1.899 Vali Acc: 0.172 Test Loss: 1.899 Test Acc: 0.172
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8587894439697266
Epoch: 12, Steps: 8 | Train Loss: 1.108 Vali Loss: 1.879 Vali Acc: 0.153 Test Loss: 1.879 Test Acc: 0.153
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6803274154663086
Epoch: 13, Steps: 8 | Train Loss: 1.040 Vali Loss: 1.869 Vali Acc: 0.150 Test Loss: 1.869 Test Acc: 0.150
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.4729864597320557
Epoch: 14, Steps: 8 | Train Loss: 0.929 Vali Loss: 1.855 Vali Acc: 0.163 Test Loss: 1.855 Test Acc: 0.163
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5098085403442383
Epoch: 15, Steps: 8 | Train Loss: 0.817 Vali Loss: 1.831 Vali Acc: 0.175 Test Loss: 1.831 Test Acc: 0.175
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4923174381256104
Epoch: 16, Steps: 8 | Train Loss: 0.731 Vali Loss: 1.784 Vali Acc: 0.209 Test Loss: 1.784 Test Acc: 0.209
Validation loss decreased (-0.193730 --> -0.209357).  Saving model ...
Epoch: 17 cost time: 2.639355182647705
Epoch: 17, Steps: 8 | Train Loss: 0.668 Vali Loss: 1.745 Vali Acc: 0.269 Test Loss: 1.745 Test Acc: 0.269
Validation loss decreased (-0.209357 --> -0.268733).  Saving model ...
Epoch: 18 cost time: 2.5731778144836426
Epoch: 18, Steps: 8 | Train Loss: 0.597 Vali Loss: 1.685 Vali Acc: 0.309 Test Loss: 1.685 Test Acc: 0.309
Validation loss decreased (-0.268733 --> -0.309358).  Saving model ...
Epoch: 19 cost time: 2.523252487182617
Epoch: 19, Steps: 8 | Train Loss: 0.607 Vali Loss: 1.574 Vali Acc: 0.394 Test Loss: 1.574 Test Acc: 0.394
Validation loss decreased (-0.309358 --> -0.393734).  Saving model ...
Epoch: 20 cost time: 2.484171152114868
Epoch: 20, Steps: 8 | Train Loss: 0.523 Vali Loss: 1.673 Vali Acc: 0.331 Test Loss: 1.673 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6985645294189453
Epoch: 21, Steps: 8 | Train Loss: 0.501 Vali Loss: 1.723 Vali Acc: 0.319 Test Loss: 1.723 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7330706119537354
Epoch: 22, Steps: 8 | Train Loss: 0.406 Vali Loss: 1.672 Vali Acc: 0.353 Test Loss: 1.672 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.966668128967285
Epoch: 23, Steps: 8 | Train Loss: 0.395 Vali Loss: 1.553 Vali Acc: 0.372 Test Loss: 1.553 Test Acc: 0.372
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.7397117614746094
Epoch: 24, Steps: 8 | Train Loss: 0.342 Vali Loss: 1.572 Vali Acc: 0.344 Test Loss: 1.572 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.850267171859741
Epoch: 25, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.641 Vali Acc: 0.350 Test Loss: 1.641 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.7150862216949463
Epoch: 26, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.670 Vali Acc: 0.366 Test Loss: 1.670 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.844784736633301
Epoch: 27, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.614 Vali Acc: 0.391 Test Loss: 1.614 Test Acc: 0.391
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.493927240371704
Epoch: 28, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.634 Vali Acc: 0.422 Test Loss: 1.634 Test Acc: 0.422
Validation loss decreased (-0.393734 --> -0.421859).  Saving model ...
Epoch: 29 cost time: 2.4926650524139404
Epoch: 29, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.692 Vali Acc: 0.388 Test Loss: 1.692 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5048553943634033
Epoch: 30, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.738 Vali Acc: 0.403 Test Loss: 1.738 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.5573923587799072
Epoch: 31, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.657 Vali Acc: 0.431 Test Loss: 1.657 Test Acc: 0.431
Validation loss decreased (-0.421859 --> -0.431233).  Saving model ...
Epoch: 32 cost time: 2.5436511039733887
Epoch: 32, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.777 Vali Acc: 0.416 Test Loss: 1.777 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.431166172027588
Epoch: 33, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.894 Vali Acc: 0.391 Test Loss: 1.894 Test Acc: 0.391
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.5021121501922607
Epoch: 34, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.835 Vali Acc: 0.397 Test Loss: 1.835 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.555412530899048
Epoch: 35, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.845 Vali Acc: 0.388 Test Loss: 1.845 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.633784532546997
Epoch: 36, Steps: 8 | Train Loss: 0.141 Vali Loss: 2.087 Vali Acc: 0.359 Test Loss: 2.087 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.702714443206787
Epoch: 37, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.956 Vali Acc: 0.409 Test Loss: 1.956 Test Acc: 0.409
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.953263521194458
Epoch: 38, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.950 Vali Acc: 0.378 Test Loss: 1.950 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.7675490379333496
Epoch: 39, Steps: 8 | Train Loss: 0.100 Vali Loss: 2.023 Vali Acc: 0.356 Test Loss: 2.023 Test Acc: 0.356
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.703169584274292
Epoch: 40, Steps: 8 | Train Loss: 0.092 Vali Loss: 2.146 Vali Acc: 0.366 Test Loss: 2.146 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.540327787399292
Epoch: 41, Steps: 8 | Train Loss: 0.073 Vali Loss: 2.265 Vali Acc: 0.369 Test Loss: 2.265 Test Acc: 0.369
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.43125
model parameter : 221768
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9384424686431885
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 1.990 Vali Acc: 0.194 Test Loss: 1.990 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 2.566990613937378
Epoch: 2, Steps: 8 | Train Loss: 1.878 Vali Loss: 1.678 Vali Acc: 0.562 Test Loss: 1.678 Test Acc: 0.562
Validation loss decreased (-0.193730 --> -0.562483).  Saving model ...
Epoch: 3 cost time: 2.605895757675171
Epoch: 3, Steps: 8 | Train Loss: 1.513 Vali Loss: 1.355 Vali Acc: 0.647 Test Loss: 1.355 Test Acc: 0.647
Validation loss decreased (-0.562483 --> -0.646861).  Saving model ...
Epoch: 4 cost time: 2.556666374206543
Epoch: 4, Steps: 8 | Train Loss: 1.160 Vali Loss: 1.089 Vali Acc: 0.734 Test Loss: 1.089 Test Acc: 0.734
Validation loss decreased (-0.646861 --> -0.734364).  Saving model ...
Epoch: 5 cost time: 2.6060941219329834
Epoch: 5, Steps: 8 | Train Loss: 0.901 Vali Loss: 0.924 Vali Acc: 0.772 Test Loss: 0.924 Test Acc: 0.772
Validation loss decreased (-0.734364 --> -0.771866).  Saving model ...
Epoch: 6 cost time: 2.713747262954712
Epoch: 6, Steps: 8 | Train Loss: 0.693 Vali Loss: 0.822 Vali Acc: 0.772 Test Loss: 0.822 Test Acc: 0.772
Validation loss decreased (-0.771866 --> -0.771867).  Saving model ...
Epoch: 7 cost time: 2.494584083557129
Epoch: 7, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.750 Vali Acc: 0.781 Test Loss: 0.750 Test Acc: 0.781
Validation loss decreased (-0.771867 --> -0.781243).  Saving model ...
Epoch: 8 cost time: 2.830472707748413
Epoch: 8, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.719 Vali Acc: 0.784 Test Loss: 0.719 Test Acc: 0.784
Validation loss decreased (-0.781243 --> -0.784368).  Saving model ...
Epoch: 9 cost time: 2.8112008571624756
Epoch: 9, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.690 Vali Acc: 0.772 Test Loss: 0.690 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0678153038024902
Epoch: 10, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.661 Vali Acc: 0.766 Test Loss: 0.661 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8972926139831543
Epoch: 11, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.669 Vali Acc: 0.769 Test Loss: 0.669 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0614218711853027
Epoch: 12, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.672 Vali Acc: 0.784 Test Loss: 0.672 Test Acc: 0.784
Validation loss decreased (-0.784368 --> -0.784368).  Saving model ...
Epoch: 13 cost time: 2.6747305393218994
Epoch: 13, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.681 Vali Acc: 0.759 Test Loss: 0.681 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.559769868850708
Epoch: 14, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.702 Vali Acc: 0.759 Test Loss: 0.702 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3333494663238525
Epoch: 15, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.726 Vali Acc: 0.762 Test Loss: 0.726 Test Acc: 0.762
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.608114242553711
Epoch: 16, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.708 Vali Acc: 0.759 Test Loss: 0.708 Test Acc: 0.759
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3474786281585693
Epoch: 17, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5500550270080566
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.721 Vali Acc: 0.762 Test Loss: 0.721 Test Acc: 0.762
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5005557537078857
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.735 Vali Acc: 0.772 Test Loss: 0.735 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.1043813228607178
Epoch: 20, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.91186261177063
Epoch: 21, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.747 Vali Acc: 0.784 Test Loss: 0.747 Test Acc: 0.784
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.625600576400757
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.742 Vali Acc: 0.775 Test Loss: 0.742 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.784375
model parameter : 172616
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.151082992553711
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 2.030 Vali Acc: 0.166 Test Loss: 2.030 Test Acc: 0.166
Validation loss decreased (inf --> -0.165605).  Saving model ...
Epoch: 2 cost time: 2.5788235664367676
Epoch: 2, Steps: 8 | Train Loss: 1.936 Vali Loss: 1.782 Vali Acc: 0.438 Test Loss: 1.782 Test Acc: 0.438
Validation loss decreased (-0.165605 --> -0.437482).  Saving model ...
Epoch: 3 cost time: 2.6822545528411865
Epoch: 3, Steps: 8 | Train Loss: 1.633 Vali Loss: 1.526 Vali Acc: 0.566 Test Loss: 1.526 Test Acc: 0.566
Validation loss decreased (-0.437482 --> -0.565610).  Saving model ...
Epoch: 4 cost time: 2.9291441440582275
Epoch: 4, Steps: 8 | Train Loss: 1.300 Vali Loss: 1.296 Vali Acc: 0.653 Test Loss: 1.296 Test Acc: 0.653
Validation loss decreased (-0.565610 --> -0.653112).  Saving model ...
Epoch: 5 cost time: 2.7158684730529785
Epoch: 5, Steps: 8 | Train Loss: 1.066 Vali Loss: 1.141 Vali Acc: 0.681 Test Loss: 1.141 Test Acc: 0.681
Validation loss decreased (-0.653112 --> -0.681239).  Saving model ...
Epoch: 6 cost time: 2.5493063926696777
Epoch: 6, Steps: 8 | Train Loss: 0.838 Vali Loss: 1.039 Vali Acc: 0.688 Test Loss: 1.039 Test Acc: 0.688
Validation loss decreased (-0.681239 --> -0.687490).  Saving model ...
Epoch: 7 cost time: 3.047426462173462
Epoch: 7, Steps: 8 | Train Loss: 0.653 Vali Loss: 0.959 Vali Acc: 0.700 Test Loss: 0.959 Test Acc: 0.700
Validation loss decreased (-0.687490 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 3.1106951236724854
Epoch: 8, Steps: 8 | Train Loss: 0.496 Vali Loss: 0.912 Vali Acc: 0.719 Test Loss: 0.912 Test Acc: 0.719
Validation loss decreased (-0.699990 --> -0.718741).  Saving model ...
Epoch: 9 cost time: 3.1490478515625
Epoch: 9, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.870 Vali Acc: 0.700 Test Loss: 0.870 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.861814260482788
Epoch: 10, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.817 Vali Acc: 0.713 Test Loss: 0.817 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8138935565948486
Epoch: 11, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.820 Vali Acc: 0.728 Test Loss: 0.820 Test Acc: 0.728
Validation loss decreased (-0.718741 --> -0.728117).  Saving model ...
Epoch: 12 cost time: 2.698390483856201
Epoch: 12, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.828 Vali Acc: 0.725 Test Loss: 0.828 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.738936424255371
Epoch: 13, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.831 Vali Acc: 0.709 Test Loss: 0.831 Test Acc: 0.709
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.834726095199585
Epoch: 14, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.869 Vali Acc: 0.700 Test Loss: 0.869 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.708775043487549
Epoch: 15, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.893 Vali Acc: 0.703 Test Loss: 0.893 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0773262977600098
Epoch: 16, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.876 Vali Acc: 0.694 Test Loss: 0.876 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.8708951473236084
Epoch: 17, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.896 Vali Acc: 0.713 Test Loss: 0.896 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7970023155212402
Epoch: 18, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.917 Vali Acc: 0.713 Test Loss: 0.917 Test Acc: 0.713
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.646726608276367
Epoch: 19, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.919 Vali Acc: 0.709 Test Loss: 0.919 Test Acc: 0.709
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4897758960723877
Epoch: 20, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.904 Vali Acc: 0.709 Test Loss: 0.904 Test Acc: 0.709
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6116487979888916
Epoch: 21, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.920 Vali Acc: 0.716 Test Loss: 0.920 Test Acc: 0.716
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.728125
model parameter : 172616
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.18117618560791
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 2.052 Vali Acc: 0.166 Test Loss: 2.052 Test Acc: 0.166
Validation loss decreased (inf --> -0.165604).  Saving model ...
Epoch: 2 cost time: 2.743811845779419
Epoch: 2, Steps: 8 | Train Loss: 1.965 Vali Loss: 1.862 Vali Acc: 0.378 Test Loss: 1.862 Test Acc: 0.378
Validation loss decreased (-0.165604 --> -0.378106).  Saving model ...
Epoch: 3 cost time: 2.531214714050293
Epoch: 3, Steps: 8 | Train Loss: 1.730 Vali Loss: 1.661 Vali Acc: 0.506 Test Loss: 1.661 Test Acc: 0.506
Validation loss decreased (-0.378106 --> -0.506233).  Saving model ...
Epoch: 4 cost time: 2.7330164909362793
Epoch: 4, Steps: 8 | Train Loss: 1.457 Vali Loss: 1.451 Vali Acc: 0.600 Test Loss: 1.451 Test Acc: 0.600
Validation loss decreased (-0.506233 --> -0.599985).  Saving model ...
Epoch: 5 cost time: 2.5131821632385254
Epoch: 5, Steps: 8 | Train Loss: 1.214 Vali Loss: 1.295 Vali Acc: 0.613 Test Loss: 1.295 Test Acc: 0.613
Validation loss decreased (-0.599985 --> -0.612487).  Saving model ...
Epoch: 6 cost time: 2.406018018722534
Epoch: 6, Steps: 8 | Train Loss: 0.969 Vali Loss: 1.183 Vali Acc: 0.625 Test Loss: 1.183 Test Acc: 0.625
Validation loss decreased (-0.612487 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 2.7717549800872803
Epoch: 7, Steps: 8 | Train Loss: 0.774 Vali Loss: 1.098 Vali Acc: 0.628 Test Loss: 1.098 Test Acc: 0.628
Validation loss decreased (-0.624988 --> -0.628114).  Saving model ...
Epoch: 8 cost time: 2.5115039348602295
Epoch: 8, Steps: 8 | Train Loss: 0.605 Vali Loss: 1.048 Vali Acc: 0.641 Test Loss: 1.048 Test Acc: 0.641
Validation loss decreased (-0.628114 --> -0.640615).  Saving model ...
Epoch: 9 cost time: 2.5492849349975586
Epoch: 9, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.014 Vali Acc: 0.647 Test Loss: 1.014 Test Acc: 0.647
Validation loss decreased (-0.640615 --> -0.646865).  Saving model ...
Epoch: 10 cost time: 2.592554807662964
Epoch: 10, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.960 Vali Acc: 0.662 Test Loss: 0.960 Test Acc: 0.662
Validation loss decreased (-0.646865 --> -0.662490).  Saving model ...
Epoch: 11 cost time: 2.409797430038452
Epoch: 11, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.941 Vali Acc: 0.694 Test Loss: 0.941 Test Acc: 0.694
Validation loss decreased (-0.662490 --> -0.693741).  Saving model ...
Epoch: 12 cost time: 2.4917166233062744
Epoch: 12, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.947 Vali Acc: 0.688 Test Loss: 0.947 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.383425235748291
Epoch: 13, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.942 Vali Acc: 0.666 Test Loss: 0.942 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.509774684906006
Epoch: 14, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.961 Vali Acc: 0.666 Test Loss: 0.961 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.558563709259033
Epoch: 15, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.005 Vali Acc: 0.678 Test Loss: 1.005 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.6538143157958984
Epoch: 16, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.006 Vali Acc: 0.669 Test Loss: 1.006 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.5668540000915527
Epoch: 17, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.989 Vali Acc: 0.678 Test Loss: 0.989 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.720273494720459
Epoch: 18, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.990 Vali Acc: 0.688 Test Loss: 0.990 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.899181842803955
Epoch: 19, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.999 Vali Acc: 0.691 Test Loss: 0.999 Test Acc: 0.691
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.683915853500366
Epoch: 20, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.017 Vali Acc: 0.678 Test Loss: 1.017 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.749570608139038
Epoch: 21, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.028 Vali Acc: 0.672 Test Loss: 1.028 Test Acc: 0.672
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.69375
model parameter : 172616
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.193077325820923
Epoch: 1, Steps: 8 | Train Loss: 2.104 Vali Loss: 2.051 Vali Acc: 0.150 Test Loss: 2.051 Test Acc: 0.150
Validation loss decreased (inf --> -0.149979).  Saving model ...
Epoch: 2 cost time: 2.6721837520599365
Epoch: 2, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.938 Vali Acc: 0.303 Test Loss: 1.938 Test Acc: 0.303
Validation loss decreased (-0.149979 --> -0.303106).  Saving model ...
Epoch: 3 cost time: 2.5969057083129883
Epoch: 3, Steps: 8 | Train Loss: 1.829 Vali Loss: 1.816 Vali Acc: 0.362 Test Loss: 1.816 Test Acc: 0.362
Validation loss decreased (-0.303106 --> -0.362482).  Saving model ...
Epoch: 4 cost time: 2.483691692352295
Epoch: 4, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.660 Vali Acc: 0.472 Test Loss: 1.660 Test Acc: 0.472
Validation loss decreased (-0.362482 --> -0.471858).  Saving model ...
Epoch: 5 cost time: 2.4705963134765625
Epoch: 5, Steps: 8 | Train Loss: 1.432 Vali Loss: 1.527 Vali Acc: 0.522 Test Loss: 1.527 Test Acc: 0.522
Validation loss decreased (-0.471858 --> -0.521860).  Saving model ...
Epoch: 6 cost time: 2.554415702819824
Epoch: 6, Steps: 8 | Train Loss: 1.250 Vali Loss: 1.405 Vali Acc: 0.544 Test Loss: 1.405 Test Acc: 0.544
Validation loss decreased (-0.521860 --> -0.543736).  Saving model ...
Epoch: 7 cost time: 2.4212467670440674
Epoch: 7, Steps: 8 | Train Loss: 1.027 Vali Loss: 1.320 Vali Acc: 0.562 Test Loss: 1.320 Test Acc: 0.562
Validation loss decreased (-0.543736 --> -0.562487).  Saving model ...
Epoch: 8 cost time: 2.369189500808716
Epoch: 8, Steps: 8 | Train Loss: 0.849 Vali Loss: 1.215 Vali Acc: 0.591 Test Loss: 1.215 Test Acc: 0.591
Validation loss decreased (-0.562487 --> -0.590613).  Saving model ...
Epoch: 9 cost time: 2.345970869064331
Epoch: 9, Steps: 8 | Train Loss: 0.723 Vali Loss: 1.166 Vali Acc: 0.594 Test Loss: 1.166 Test Acc: 0.594
Validation loss decreased (-0.590613 --> -0.593738).  Saving model ...
Epoch: 10 cost time: 2.330650806427002
Epoch: 10, Steps: 8 | Train Loss: 0.606 Vali Loss: 1.106 Vali Acc: 0.597 Test Loss: 1.106 Test Acc: 0.597
Validation loss decreased (-0.593738 --> -0.596864).  Saving model ...
Epoch: 11 cost time: 2.6309852600097656
Epoch: 11, Steps: 8 | Train Loss: 0.490 Vali Loss: 1.056 Vali Acc: 0.613 Test Loss: 1.056 Test Acc: 0.613
Validation loss decreased (-0.596864 --> -0.612489).  Saving model ...
Epoch: 12 cost time: 2.5341451168060303
Epoch: 12, Steps: 8 | Train Loss: 0.428 Vali Loss: 1.029 Vali Acc: 0.650 Test Loss: 1.029 Test Acc: 0.650
Validation loss decreased (-0.612489 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 2.763564109802246
Epoch: 13, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.000 Vali Acc: 0.625 Test Loss: 1.000 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9147121906280518
Epoch: 14, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.995 Vali Acc: 0.622 Test Loss: 0.995 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9142205715179443
Epoch: 15, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.015 Vali Acc: 0.628 Test Loss: 1.015 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.751868724822998
Epoch: 16, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.009 Vali Acc: 0.625 Test Loss: 1.009 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7115585803985596
Epoch: 17, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.989 Vali Acc: 0.650 Test Loss: 0.989 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 18 cost time: 2.653413772583008
Epoch: 18, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.004 Vali Acc: 0.622 Test Loss: 1.004 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8835742473602295
Epoch: 19, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.028 Vali Acc: 0.597 Test Loss: 1.028 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6362781524658203
Epoch: 20, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.015 Vali Acc: 0.625 Test Loss: 1.015 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.573316812515259
Epoch: 21, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.040 Vali Acc: 0.628 Test Loss: 1.040 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.650118589401245
Epoch: 22, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.023 Vali Acc: 0.634 Test Loss: 1.023 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.8333420753479004
Epoch: 23, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.026 Vali Acc: 0.628 Test Loss: 1.026 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.7905964851379395
Epoch: 24, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.024 Vali Acc: 0.622 Test Loss: 1.024 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8819611072540283
Epoch: 25, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.020 Vali Acc: 0.656 Test Loss: 1.020 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.656240).  Saving model ...
Epoch: 26 cost time: 2.72232985496521
Epoch: 26, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.034 Vali Acc: 0.656 Test Loss: 1.034 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.9287807941436768
Epoch: 27, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.033 Vali Acc: 0.647 Test Loss: 1.033 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.7896814346313477
Epoch: 28, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.042 Vali Acc: 0.656 Test Loss: 1.042 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.716771125793457
Epoch: 29, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.040 Vali Acc: 0.659 Test Loss: 1.040 Test Acc: 0.659
Validation loss decreased (-0.656240 --> -0.659365).  Saving model ...
Epoch: 30 cost time: 3.037839412689209
Epoch: 30, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.024 Vali Acc: 0.653 Test Loss: 1.024 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.963829517364502
Epoch: 31, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.024 Vali Acc: 0.650 Test Loss: 1.024 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.6727700233459473
Epoch: 32, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.047 Vali Acc: 0.653 Test Loss: 1.047 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.7936959266662598
Epoch: 33, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.039 Vali Acc: 0.659 Test Loss: 1.039 Test Acc: 0.659
Validation loss decreased (-0.659365 --> -0.659365).  Saving model ...
Epoch: 34 cost time: 2.958868980407715
Epoch: 34, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.033 Vali Acc: 0.653 Test Loss: 1.033 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.736691951751709
Epoch: 35, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.033 Vali Acc: 0.662 Test Loss: 1.033 Test Acc: 0.662
Validation loss decreased (-0.659365 --> -0.662490).  Saving model ...
Epoch: 36 cost time: 3.0092008113861084
Epoch: 36, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.042 Vali Acc: 0.662 Test Loss: 1.042 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.536916732788086
Epoch: 37, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.018 Vali Acc: 0.678 Test Loss: 1.018 Test Acc: 0.678
Validation loss decreased (-0.662490 --> -0.678115).  Saving model ...
Epoch: 38 cost time: 2.6431121826171875
Epoch: 38, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.003 Vali Acc: 0.678 Test Loss: 1.003 Test Acc: 0.678
Validation loss decreased (-0.678115 --> -0.678115).  Saving model ...
Epoch: 39 cost time: 2.7288315296173096
Epoch: 39, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.993 Vali Acc: 0.678 Test Loss: 0.993 Test Acc: 0.678
Validation loss decreased (-0.678115 --> -0.678115).  Saving model ...
Epoch: 40 cost time: 2.6485602855682373
Epoch: 40, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.008 Vali Acc: 0.672 Test Loss: 1.008 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.8718764781951904
Epoch: 41, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.082 Vali Acc: 0.650 Test Loss: 1.082 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.1128170490264893
Epoch: 42, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.024 Vali Acc: 0.688 Test Loss: 1.024 Test Acc: 0.688
Validation loss decreased (-0.678115 --> -0.687490).  Saving model ...
Epoch: 43 cost time: 2.900301933288574
Epoch: 43, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.012 Vali Acc: 0.672 Test Loss: 1.012 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.8320462703704834
Epoch: 44, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.022 Vali Acc: 0.672 Test Loss: 1.022 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.7992331981658936
Epoch: 45, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.029 Vali Acc: 0.672 Test Loss: 1.029 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.999717950820923
Epoch: 46, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.028 Vali Acc: 0.669 Test Loss: 1.028 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.870471477508545
Epoch: 47, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.023 Vali Acc: 0.666 Test Loss: 1.023 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.917149782180786
Epoch: 48, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.021 Vali Acc: 0.669 Test Loss: 1.021 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.0306684970855713
Epoch: 49, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.018 Vali Acc: 0.672 Test Loss: 1.018 Test Acc: 0.672
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.8647382259368896
Epoch: 50, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 2.9886138439178467
Epoch: 51, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.017 Vali Acc: 0.675 Test Loss: 1.017 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 2.55544376373291
Epoch: 52, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.014 Vali Acc: 0.666 Test Loss: 1.014 Test Acc: 0.666
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.6875
model parameter : 172616
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.043567419052124
Epoch: 1, Steps: 8 | Train Loss: 2.147 Vali Loss: 2.077 Vali Acc: 0.119 Test Loss: 2.077 Test Acc: 0.119
Validation loss decreased (inf --> -0.118729).  Saving model ...
Epoch: 2 cost time: 2.811248779296875
Epoch: 2, Steps: 8 | Train Loss: 2.058 Vali Loss: 2.009 Vali Acc: 0.234 Test Loss: 2.009 Test Acc: 0.234
Validation loss decreased (-0.118729 --> -0.234355).  Saving model ...
Epoch: 3 cost time: 2.9442696571350098
Epoch: 3, Steps: 8 | Train Loss: 1.946 Vali Loss: 1.948 Vali Acc: 0.225 Test Loss: 1.948 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.661309242248535
Epoch: 4, Steps: 8 | Train Loss: 1.772 Vali Loss: 1.856 Vali Acc: 0.341 Test Loss: 1.856 Test Acc: 0.341
Validation loss decreased (-0.234355 --> -0.340606).  Saving model ...
Epoch: 5 cost time: 2.7093214988708496
Epoch: 5, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.768 Vali Acc: 0.475 Test Loss: 1.768 Test Acc: 0.475
Validation loss decreased (-0.340606 --> -0.474982).  Saving model ...
Epoch: 6 cost time: 2.836486577987671
Epoch: 6, Steps: 8 | Train Loss: 1.475 Vali Loss: 1.685 Vali Acc: 0.459 Test Loss: 1.685 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6067683696746826
Epoch: 7, Steps: 8 | Train Loss: 1.336 Vali Loss: 1.621 Vali Acc: 0.453 Test Loss: 1.621 Test Acc: 0.453
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.574033737182617
Epoch: 8, Steps: 8 | Train Loss: 1.130 Vali Loss: 1.532 Vali Acc: 0.466 Test Loss: 1.532 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4954922199249268
Epoch: 9, Steps: 8 | Train Loss: 1.005 Vali Loss: 1.479 Vali Acc: 0.484 Test Loss: 1.479 Test Acc: 0.484
Validation loss decreased (-0.474982 --> -0.484360).  Saving model ...
Epoch: 10 cost time: 2.548980474472046
Epoch: 10, Steps: 8 | Train Loss: 0.865 Vali Loss: 1.428 Vali Acc: 0.512 Test Loss: 1.428 Test Acc: 0.512
Validation loss decreased (-0.484360 --> -0.512486).  Saving model ...
Epoch: 11 cost time: 2.5532066822052
Epoch: 11, Steps: 8 | Train Loss: 0.757 Vali Loss: 1.375 Vali Acc: 0.478 Test Loss: 1.375 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4654886722564697
Epoch: 12, Steps: 8 | Train Loss: 0.644 Vali Loss: 1.339 Vali Acc: 0.503 Test Loss: 1.339 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.495579242706299
Epoch: 13, Steps: 8 | Train Loss: 0.574 Vali Loss: 1.327 Vali Acc: 0.516 Test Loss: 1.327 Test Acc: 0.516
Validation loss decreased (-0.512486 --> -0.515612).  Saving model ...
Epoch: 14 cost time: 2.5015854835510254
Epoch: 14, Steps: 8 | Train Loss: 0.461 Vali Loss: 1.311 Vali Acc: 0.500 Test Loss: 1.311 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6414854526519775
Epoch: 15, Steps: 8 | Train Loss: 0.401 Vali Loss: 1.333 Vali Acc: 0.475 Test Loss: 1.333 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.58856201171875
Epoch: 16, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.291 Vali Acc: 0.522 Test Loss: 1.291 Test Acc: 0.522
Validation loss decreased (-0.515612 --> -0.521862).  Saving model ...
Epoch: 17 cost time: 2.796320676803589
Epoch: 17, Steps: 8 | Train Loss: 0.274 Vali Loss: 1.266 Vali Acc: 0.534 Test Loss: 1.266 Test Acc: 0.534
Validation loss decreased (-0.521862 --> -0.534362).  Saving model ...
Epoch: 18 cost time: 2.7514302730560303
Epoch: 18, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.312 Vali Acc: 0.512 Test Loss: 1.312 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9018290042877197
Epoch: 19, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.403 Vali Acc: 0.487 Test Loss: 1.403 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8368606567382812
Epoch: 20, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.309 Vali Acc: 0.525 Test Loss: 1.309 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.8349523544311523
Epoch: 21, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.323 Vali Acc: 0.528 Test Loss: 1.323 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.9766507148742676
Epoch: 22, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.330 Vali Acc: 0.531 Test Loss: 1.330 Test Acc: 0.531
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.7880592346191406
Epoch: 23, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.424 Vali Acc: 0.506 Test Loss: 1.424 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.629256248474121
Epoch: 24, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.451 Vali Acc: 0.509 Test Loss: 1.451 Test Acc: 0.509
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.7153778076171875
Epoch: 25, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.393 Vali Acc: 0.534 Test Loss: 1.393 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.5927422046661377
Epoch: 26, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.411 Vali Acc: 0.525 Test Loss: 1.411 Test Acc: 0.525
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.6467230319976807
Epoch: 27, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.484 Vali Acc: 0.509 Test Loss: 1.484 Test Acc: 0.509
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.534375
model parameter : 172616
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.95048451423645
Epoch: 1, Steps: 8 | Train Loss: 2.144 Vali Loss: 2.098 Vali Acc: 0.138 Test Loss: 2.098 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 2.3870885372161865
Epoch: 2, Steps: 8 | Train Loss: 2.088 Vali Loss: 2.052 Vali Acc: 0.188 Test Loss: 2.052 Test Acc: 0.188
Validation loss decreased (-0.137479 --> -0.187479).  Saving model ...
Epoch: 3 cost time: 2.5459322929382324
Epoch: 3, Steps: 8 | Train Loss: 1.993 Vali Loss: 2.022 Vali Acc: 0.275 Test Loss: 2.022 Test Acc: 0.275
Validation loss decreased (-0.187479 --> -0.274980).  Saving model ...
Epoch: 4 cost time: 2.9864447116851807
Epoch: 4, Steps: 8 | Train Loss: 1.841 Vali Loss: 1.975 Vali Acc: 0.291 Test Loss: 1.975 Test Acc: 0.291
Validation loss decreased (-0.274980 --> -0.290605).  Saving model ...
Epoch: 5 cost time: 2.959390878677368
Epoch: 5, Steps: 8 | Train Loss: 1.744 Vali Loss: 1.914 Vali Acc: 0.353 Test Loss: 1.914 Test Acc: 0.353
Validation loss decreased (-0.290605 --> -0.353106).  Saving model ...
Epoch: 6 cost time: 3.096552610397339
Epoch: 6, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.863 Vali Acc: 0.359 Test Loss: 1.863 Test Acc: 0.359
Validation loss decreased (-0.353106 --> -0.359356).  Saving model ...
Epoch: 7 cost time: 2.9285898208618164
Epoch: 7, Steps: 8 | Train Loss: 1.499 Vali Loss: 1.822 Vali Acc: 0.369 Test Loss: 1.822 Test Acc: 0.369
Validation loss decreased (-0.359356 --> -0.368732).  Saving model ...
Epoch: 8 cost time: 2.6982247829437256
Epoch: 8, Steps: 8 | Train Loss: 1.342 Vali Loss: 1.749 Vali Acc: 0.381 Test Loss: 1.749 Test Acc: 0.381
Validation loss decreased (-0.368732 --> -0.381233).  Saving model ...
Epoch: 9 cost time: 2.812589645385742
Epoch: 9, Steps: 8 | Train Loss: 1.199 Vali Loss: 1.690 Vali Acc: 0.409 Test Loss: 1.690 Test Acc: 0.409
Validation loss decreased (-0.381233 --> -0.409358).  Saving model ...
Epoch: 10 cost time: 2.5532174110412598
Epoch: 10, Steps: 8 | Train Loss: 1.060 Vali Loss: 1.645 Vali Acc: 0.406 Test Loss: 1.645 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6989831924438477
Epoch: 11, Steps: 8 | Train Loss: 0.935 Vali Loss: 1.586 Vali Acc: 0.463 Test Loss: 1.586 Test Acc: 0.463
Validation loss decreased (-0.409358 --> -0.462484).  Saving model ...
Epoch: 12 cost time: 2.506622552871704
Epoch: 12, Steps: 8 | Train Loss: 0.784 Vali Loss: 1.514 Vali Acc: 0.484 Test Loss: 1.514 Test Acc: 0.484
Validation loss decreased (-0.462484 --> -0.484360).  Saving model ...
Epoch: 13 cost time: 2.688722610473633
Epoch: 13, Steps: 8 | Train Loss: 0.734 Vali Loss: 1.478 Vali Acc: 0.497 Test Loss: 1.478 Test Acc: 0.497
Validation loss decreased (-0.484360 --> -0.496860).  Saving model ...
Epoch: 14 cost time: 2.483306646347046
Epoch: 14, Steps: 8 | Train Loss: 0.582 Vali Loss: 1.415 Vali Acc: 0.487 Test Loss: 1.415 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4309213161468506
Epoch: 15, Steps: 8 | Train Loss: 0.510 Vali Loss: 1.387 Vali Acc: 0.466 Test Loss: 1.387 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8886687755584717
Epoch: 16, Steps: 8 | Train Loss: 0.428 Vali Loss: 1.338 Vali Acc: 0.491 Test Loss: 1.338 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6375608444213867
Epoch: 17, Steps: 8 | Train Loss: 0.388 Vali Loss: 1.242 Vali Acc: 0.537 Test Loss: 1.242 Test Acc: 0.537
Validation loss decreased (-0.496860 --> -0.537488).  Saving model ...
Epoch: 18 cost time: 2.9937705993652344
Epoch: 18, Steps: 8 | Train Loss: 0.346 Vali Loss: 1.265 Vali Acc: 0.512 Test Loss: 1.265 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7628610134124756
Epoch: 19, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.421 Vali Acc: 0.466 Test Loss: 1.421 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.922805070877075
Epoch: 20, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.274 Vali Acc: 0.503 Test Loss: 1.274 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5389797687530518
Epoch: 21, Steps: 8 | Train Loss: 0.230 Vali Loss: 1.283 Vali Acc: 0.519 Test Loss: 1.283 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5685763359069824
Epoch: 22, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.487 Vali Acc: 0.469 Test Loss: 1.487 Test Acc: 0.469
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.852118968963623
Epoch: 23, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.470 Vali Acc: 0.450 Test Loss: 1.470 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.0326764583587646
Epoch: 24, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.469 Vali Acc: 0.475 Test Loss: 1.469 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8216590881347656
Epoch: 25, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.510 Vali Acc: 0.469 Test Loss: 1.510 Test Acc: 0.469
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.627894401550293
Epoch: 26, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.534 Vali Acc: 0.466 Test Loss: 1.534 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.7840521335601807
Epoch: 27, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.695 Vali Acc: 0.450 Test Loss: 1.695 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5375
model parameter : 172616
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.2869038581848145
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 2.134 Vali Acc: 0.122 Test Loss: 2.134 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 2.680772066116333
Epoch: 2, Steps: 8 | Train Loss: 2.106 Vali Loss: 2.083 Vali Acc: 0.125 Test Loss: 2.083 Test Acc: 0.125
Validation loss decreased (-0.121854 --> -0.124979).  Saving model ...
Epoch: 3 cost time: 2.7404394149780273
Epoch: 3, Steps: 8 | Train Loss: 2.031 Vali Loss: 2.059 Vali Acc: 0.247 Test Loss: 2.059 Test Acc: 0.247
Validation loss decreased (-0.124979 --> -0.246854).  Saving model ...
Epoch: 4 cost time: 2.883111000061035
Epoch: 4, Steps: 8 | Train Loss: 1.895 Vali Loss: 2.028 Vali Acc: 0.237 Test Loss: 2.028 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.847806453704834
Epoch: 5, Steps: 8 | Train Loss: 1.804 Vali Loss: 1.983 Vali Acc: 0.287 Test Loss: 1.983 Test Acc: 0.287
Validation loss decreased (-0.246854 --> -0.287480).  Saving model ...
Epoch: 6 cost time: 3.0908329486846924
Epoch: 6, Steps: 8 | Train Loss: 1.731 Vali Loss: 1.949 Vali Acc: 0.281 Test Loss: 1.949 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.926657199859619
Epoch: 7, Steps: 8 | Train Loss: 1.552 Vali Loss: 1.912 Vali Acc: 0.378 Test Loss: 1.912 Test Acc: 0.378
Validation loss decreased (-0.287480 --> -0.378106).  Saving model ...
Epoch: 8 cost time: 2.7064220905303955
Epoch: 8, Steps: 8 | Train Loss: 1.406 Vali Loss: 1.854 Vali Acc: 0.378 Test Loss: 1.854 Test Acc: 0.378
Validation loss decreased (-0.378106 --> -0.378106).  Saving model ...
Epoch: 9 cost time: 2.6875765323638916
Epoch: 9, Steps: 8 | Train Loss: 1.276 Vali Loss: 1.817 Vali Acc: 0.366 Test Loss: 1.817 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.694387912750244
Epoch: 10, Steps: 8 | Train Loss: 1.143 Vali Loss: 1.773 Vali Acc: 0.384 Test Loss: 1.773 Test Acc: 0.384
Validation loss decreased (-0.378106 --> -0.384357).  Saving model ...
Epoch: 11 cost time: 2.7209866046905518
Epoch: 11, Steps: 8 | Train Loss: 1.044 Vali Loss: 1.715 Vali Acc: 0.428 Test Loss: 1.715 Test Acc: 0.428
Validation loss decreased (-0.384357 --> -0.428108).  Saving model ...
Epoch: 12 cost time: 2.6830034255981445
Epoch: 12, Steps: 8 | Train Loss: 0.870 Vali Loss: 1.654 Vali Acc: 0.419 Test Loss: 1.654 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6272432804107666
Epoch: 13, Steps: 8 | Train Loss: 0.810 Vali Loss: 1.610 Vali Acc: 0.422 Test Loss: 1.610 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4249370098114014
Epoch: 14, Steps: 8 | Train Loss: 0.674 Vali Loss: 1.536 Vali Acc: 0.472 Test Loss: 1.536 Test Acc: 0.472
Validation loss decreased (-0.428108 --> -0.471860).  Saving model ...
Epoch: 15 cost time: 2.5971176624298096
Epoch: 15, Steps: 8 | Train Loss: 0.583 Vali Loss: 1.496 Vali Acc: 0.453 Test Loss: 1.496 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.411898136138916
Epoch: 16, Steps: 8 | Train Loss: 0.493 Vali Loss: 1.435 Vali Acc: 0.494 Test Loss: 1.435 Test Acc: 0.494
Validation loss decreased (-0.471860 --> -0.493736).  Saving model ...
Epoch: 17 cost time: 2.560885429382324
Epoch: 17, Steps: 8 | Train Loss: 0.444 Vali Loss: 1.341 Vali Acc: 0.553 Test Loss: 1.341 Test Acc: 0.553
Validation loss decreased (-0.493736 --> -0.553112).  Saving model ...
Epoch: 18 cost time: 3.1310482025146484
Epoch: 18, Steps: 8 | Train Loss: 0.405 Vali Loss: 1.328 Vali Acc: 0.531 Test Loss: 1.328 Test Acc: 0.531
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8271429538726807
Epoch: 19, Steps: 8 | Train Loss: 0.359 Vali Loss: 1.390 Vali Acc: 0.453 Test Loss: 1.390 Test Acc: 0.453
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.934408187866211
Epoch: 20, Steps: 8 | Train Loss: 0.290 Vali Loss: 1.372 Vali Acc: 0.494 Test Loss: 1.372 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.957143545150757
Epoch: 21, Steps: 8 | Train Loss: 0.282 Vali Loss: 1.375 Vali Acc: 0.503 Test Loss: 1.375 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.94384765625
Epoch: 22, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.467 Vali Acc: 0.469 Test Loss: 1.467 Test Acc: 0.469
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6910343170166016
Epoch: 23, Steps: 8 | Train Loss: 0.187 Vali Loss: 1.533 Vali Acc: 0.447 Test Loss: 1.533 Test Acc: 0.447
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.8024954795837402
Epoch: 24, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.485 Vali Acc: 0.456 Test Loss: 1.485 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.568315029144287
Epoch: 25, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.529 Vali Acc: 0.456 Test Loss: 1.529 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.6156797409057617
Epoch: 26, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.553 Vali Acc: 0.469 Test Loss: 1.553 Test Acc: 0.469
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.609250545501709
Epoch: 27, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.644 Vali Acc: 0.456 Test Loss: 1.644 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.553125
model parameter : 172616
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.158137083053589
Epoch: 1, Steps: 8 | Train Loss: 2.149 Vali Loss: 2.134 Vali Acc: 0.125 Test Loss: 2.134 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 2.717909812927246
Epoch: 2, Steps: 8 | Train Loss: 2.118 Vali Loss: 2.093 Vali Acc: 0.122 Test Loss: 2.093 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0934391021728516
Epoch: 3, Steps: 8 | Train Loss: 2.012 Vali Loss: 2.063 Vali Acc: 0.134 Test Loss: 2.063 Test Acc: 0.134
Validation loss decreased (-0.124979 --> -0.134354).  Saving model ...
Epoch: 4 cost time: 3.2088277339935303
Epoch: 4, Steps: 8 | Train Loss: 1.870 Vali Loss: 2.037 Vali Acc: 0.263 Test Loss: 2.037 Test Acc: 0.263
Validation loss decreased (-0.134354 --> -0.262480).  Saving model ...
Epoch: 5 cost time: 2.914203405380249
Epoch: 5, Steps: 8 | Train Loss: 1.820 Vali Loss: 2.003 Vali Acc: 0.191 Test Loss: 2.003 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.874962329864502
Epoch: 6, Steps: 8 | Train Loss: 1.708 Vali Loss: 1.972 Vali Acc: 0.334 Test Loss: 1.972 Test Acc: 0.334
Validation loss decreased (-0.262480 --> -0.334355).  Saving model ...
Epoch: 7 cost time: 2.761136770248413
Epoch: 7, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.936 Vali Acc: 0.394 Test Loss: 1.936 Test Acc: 0.394
Validation loss decreased (-0.334355 --> -0.393731).  Saving model ...
Epoch: 8 cost time: 2.6481900215148926
Epoch: 8, Steps: 8 | Train Loss: 1.360 Vali Loss: 1.894 Vali Acc: 0.409 Test Loss: 1.894 Test Acc: 0.409
Validation loss decreased (-0.393731 --> -0.409356).  Saving model ...
Epoch: 9 cost time: 2.7687885761260986
Epoch: 9, Steps: 8 | Train Loss: 1.249 Vali Loss: 1.863 Vali Acc: 0.400 Test Loss: 1.863 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8250763416290283
Epoch: 10, Steps: 8 | Train Loss: 1.104 Vali Loss: 1.824 Vali Acc: 0.394 Test Loss: 1.824 Test Acc: 0.394
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.551086664199829
Epoch: 11, Steps: 8 | Train Loss: 1.026 Vali Loss: 1.774 Vali Acc: 0.416 Test Loss: 1.774 Test Acc: 0.416
Validation loss decreased (-0.409356 --> -0.415607).  Saving model ...
Epoch: 12 cost time: 2.63657546043396
Epoch: 12, Steps: 8 | Train Loss: 0.871 Vali Loss: 1.735 Vali Acc: 0.406 Test Loss: 1.735 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.789876937866211
Epoch: 13, Steps: 8 | Train Loss: 0.818 Vali Loss: 1.709 Vali Acc: 0.431 Test Loss: 1.709 Test Acc: 0.431
Validation loss decreased (-0.415607 --> -0.431233).  Saving model ...
Epoch: 14 cost time: 2.942741632461548
Epoch: 14, Steps: 8 | Train Loss: 0.692 Vali Loss: 1.651 Vali Acc: 0.469 Test Loss: 1.651 Test Acc: 0.469
Validation loss decreased (-0.431233 --> -0.468733).  Saving model ...
Epoch: 15 cost time: 3.044398069381714
Epoch: 15, Steps: 8 | Train Loss: 0.604 Vali Loss: 1.619 Vali Acc: 0.459 Test Loss: 1.619 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8411848545074463
Epoch: 16, Steps: 8 | Train Loss: 0.519 Vali Loss: 1.609 Vali Acc: 0.463 Test Loss: 1.609 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0675575733184814
Epoch: 17, Steps: 8 | Train Loss: 0.482 Vali Loss: 1.536 Vali Acc: 0.500 Test Loss: 1.536 Test Acc: 0.500
Validation loss decreased (-0.468733 --> -0.499985).  Saving model ...
Epoch: 18 cost time: 2.8759922981262207
Epoch: 18, Steps: 8 | Train Loss: 0.455 Vali Loss: 1.504 Vali Acc: 0.522 Test Loss: 1.504 Test Acc: 0.522
Validation loss decreased (-0.499985 --> -0.521860).  Saving model ...
Epoch: 19 cost time: 2.848003387451172
Epoch: 19, Steps: 8 | Train Loss: 0.423 Vali Loss: 1.505 Vali Acc: 0.453 Test Loss: 1.505 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7091894149780273
Epoch: 20, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.449 Vali Acc: 0.516 Test Loss: 1.449 Test Acc: 0.516
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1396071910858154
Epoch: 21, Steps: 8 | Train Loss: 0.362 Vali Loss: 1.428 Vali Acc: 0.547 Test Loss: 1.428 Test Acc: 0.547
Validation loss decreased (-0.521860 --> -0.546861).  Saving model ...
Epoch: 22 cost time: 3.021843194961548
Epoch: 22, Steps: 8 | Train Loss: 0.269 Vali Loss: 1.452 Vali Acc: 0.487 Test Loss: 1.452 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.846839427947998
Epoch: 23, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.517 Vali Acc: 0.441 Test Loss: 1.517 Test Acc: 0.441
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6845903396606445
Epoch: 24, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.379 Vali Acc: 0.525 Test Loss: 1.379 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7068731784820557
Epoch: 25, Steps: 8 | Train Loss: 0.259 Vali Loss: 1.435 Vali Acc: 0.472 Test Loss: 1.435 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.6326041221618652
Epoch: 26, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.418 Vali Acc: 0.509 Test Loss: 1.418 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.814201593399048
Epoch: 27, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.464 Vali Acc: 0.484 Test Loss: 1.464 Test Acc: 0.484
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.8919711112976074
Epoch: 28, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.518 Vali Acc: 0.456 Test Loss: 1.518 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.7745285034179688
Epoch: 29, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.602 Vali Acc: 0.438 Test Loss: 1.602 Test Acc: 0.438
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.9413440227508545
Epoch: 30, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.503 Vali Acc: 0.469 Test Loss: 1.503 Test Acc: 0.469
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.0085697174072266
Epoch: 31, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.572 Vali Acc: 0.441 Test Loss: 1.572 Test Acc: 0.441
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.546875
model parameter : 172616
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.457947492599487
Epoch: 1, Steps: 8 | Train Loss: 2.165 Vali Loss: 2.140 Vali Acc: 0.138 Test Loss: 2.140 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 2.930326461791992
Epoch: 2, Steps: 8 | Train Loss: 2.146 Vali Loss: 2.106 Vali Acc: 0.144 Test Loss: 2.106 Test Acc: 0.144
Validation loss decreased (-0.137479 --> -0.143729).  Saving model ...
Epoch: 3 cost time: 2.7038919925689697
Epoch: 3, Steps: 8 | Train Loss: 2.042 Vali Loss: 2.071 Vali Acc: 0.150 Test Loss: 2.071 Test Acc: 0.150
Validation loss decreased (-0.143729 --> -0.149979).  Saving model ...
Epoch: 4 cost time: 2.3305749893188477
Epoch: 4, Steps: 8 | Train Loss: 1.886 Vali Loss: 2.041 Vali Acc: 0.194 Test Loss: 2.041 Test Acc: 0.194
Validation loss decreased (-0.149979 --> -0.193730).  Saving model ...
Epoch: 5 cost time: 2.4533214569091797
Epoch: 5, Steps: 8 | Train Loss: 1.821 Vali Loss: 2.019 Vali Acc: 0.178 Test Loss: 2.019 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7093682289123535
Epoch: 6, Steps: 8 | Train Loss: 1.718 Vali Loss: 1.993 Vali Acc: 0.250 Test Loss: 1.993 Test Acc: 0.250
Validation loss decreased (-0.193730 --> -0.249980).  Saving model ...
Epoch: 7 cost time: 2.7318966388702393
Epoch: 7, Steps: 8 | Train Loss: 1.580 Vali Loss: 1.965 Vali Acc: 0.259 Test Loss: 1.965 Test Acc: 0.259
Validation loss decreased (-0.249980 --> -0.259355).  Saving model ...
Epoch: 8 cost time: 2.817911148071289
Epoch: 8, Steps: 8 | Train Loss: 1.396 Vali Loss: 1.934 Vali Acc: 0.297 Test Loss: 1.934 Test Acc: 0.297
Validation loss decreased (-0.259355 --> -0.296856).  Saving model ...
Epoch: 9 cost time: 2.751157760620117
Epoch: 9, Steps: 8 | Train Loss: 1.331 Vali Loss: 1.914 Vali Acc: 0.319 Test Loss: 1.914 Test Acc: 0.319
Validation loss decreased (-0.296856 --> -0.318731).  Saving model ...
Epoch: 10 cost time: 2.562741279602051
Epoch: 10, Steps: 8 | Train Loss: 1.175 Vali Loss: 1.874 Vali Acc: 0.325 Test Loss: 1.874 Test Acc: 0.325
Validation loss decreased (-0.318731 --> -0.324981).  Saving model ...
Epoch: 11 cost time: 2.8809008598327637
Epoch: 11, Steps: 8 | Train Loss: 1.089 Vali Loss: 1.834 Vali Acc: 0.316 Test Loss: 1.834 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9186084270477295
Epoch: 12, Steps: 8 | Train Loss: 0.946 Vali Loss: 1.799 Vali Acc: 0.306 Test Loss: 1.799 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.534841537475586
Epoch: 13, Steps: 8 | Train Loss: 0.891 Vali Loss: 1.780 Vali Acc: 0.338 Test Loss: 1.780 Test Acc: 0.338
Validation loss decreased (-0.324981 --> -0.337482).  Saving model ...
Epoch: 14 cost time: 2.627413034439087
Epoch: 14, Steps: 8 | Train Loss: 0.779 Vali Loss: 1.753 Vali Acc: 0.341 Test Loss: 1.753 Test Acc: 0.341
Validation loss decreased (-0.337482 --> -0.340607).  Saving model ...
Epoch: 15 cost time: 2.797363758087158
Epoch: 15, Steps: 8 | Train Loss: 0.693 Vali Loss: 1.740 Vali Acc: 0.362 Test Loss: 1.740 Test Acc: 0.362
Validation loss decreased (-0.340607 --> -0.362483).  Saving model ...
Epoch: 16 cost time: 2.644655704498291
Epoch: 16, Steps: 8 | Train Loss: 0.619 Vali Loss: 1.730 Vali Acc: 0.341 Test Loss: 1.730 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7566077709198
Epoch: 17, Steps: 8 | Train Loss: 0.574 Vali Loss: 1.649 Vali Acc: 0.366 Test Loss: 1.649 Test Acc: 0.366
Validation loss decreased (-0.362483 --> -0.365609).  Saving model ...
Epoch: 18 cost time: 2.4672765731811523
Epoch: 18, Steps: 8 | Train Loss: 0.527 Vali Loss: 1.642 Vali Acc: 0.319 Test Loss: 1.642 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5614984035491943
Epoch: 19, Steps: 8 | Train Loss: 0.487 Vali Loss: 1.781 Vali Acc: 0.275 Test Loss: 1.781 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.475464105606079
Epoch: 20, Steps: 8 | Train Loss: 0.430 Vali Loss: 1.754 Vali Acc: 0.306 Test Loss: 1.754 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9444596767425537
Epoch: 21, Steps: 8 | Train Loss: 0.407 Vali Loss: 1.773 Vali Acc: 0.312 Test Loss: 1.773 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.589388370513916
Epoch: 22, Steps: 8 | Train Loss: 0.336 Vali Loss: 1.703 Vali Acc: 0.344 Test Loss: 1.703 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.548003673553467
Epoch: 23, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.903 Vali Acc: 0.297 Test Loss: 1.903 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.8393356800079346
Epoch: 24, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.834 Vali Acc: 0.347 Test Loss: 1.834 Test Acc: 0.347
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.5585765838623047
Epoch: 25, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.868 Vali Acc: 0.338 Test Loss: 1.868 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.5941829681396484
Epoch: 26, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.724 Vali Acc: 0.369 Test Loss: 1.724 Test Acc: 0.369
Validation loss decreased (-0.365609 --> -0.368733).  Saving model ...
Epoch: 27 cost time: 2.9888830184936523
Epoch: 27, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.889 Vali Acc: 0.350 Test Loss: 1.889 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.7948157787323
Epoch: 28, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.924 Vali Acc: 0.350 Test Loss: 1.924 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0603039264678955
Epoch: 29, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.765 Vali Acc: 0.397 Test Loss: 1.765 Test Acc: 0.397
Validation loss decreased (-0.368733 --> -0.396857).  Saving model ...
Epoch: 30 cost time: 2.823535919189453
Epoch: 30, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.836 Vali Acc: 0.362 Test Loss: 1.836 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.8739781379699707
Epoch: 31, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.909 Vali Acc: 0.359 Test Loss: 1.909 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.8636128902435303
Epoch: 32, Steps: 8 | Train Loss: 0.129 Vali Loss: 2.065 Vali Acc: 0.347 Test Loss: 2.065 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.7035741806030273
Epoch: 33, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.936 Vali Acc: 0.378 Test Loss: 1.936 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.6294991970062256
Epoch: 34, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.799 Vali Acc: 0.425 Test Loss: 1.799 Test Acc: 0.425
Validation loss decreased (-0.396857 --> -0.424982).  Saving model ...
Epoch: 35 cost time: 2.6724610328674316
Epoch: 35, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.903 Vali Acc: 0.394 Test Loss: 1.903 Test Acc: 0.394
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.7298290729522705
Epoch: 36, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.975 Vali Acc: 0.388 Test Loss: 1.975 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.7858774662017822
Epoch: 37, Steps: 8 | Train Loss: 0.082 Vali Loss: 2.110 Vali Acc: 0.375 Test Loss: 2.110 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.938645124435425
Epoch: 38, Steps: 8 | Train Loss: 0.070 Vali Loss: 2.193 Vali Acc: 0.366 Test Loss: 2.193 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.8190183639526367
Epoch: 39, Steps: 8 | Train Loss: 0.068 Vali Loss: 2.155 Vali Acc: 0.375 Test Loss: 2.155 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.8722848892211914
Epoch: 40, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.988 Vali Acc: 0.378 Test Loss: 1.988 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.7505698204040527
Epoch: 41, Steps: 8 | Train Loss: 0.061 Vali Loss: 2.314 Vali Acc: 0.344 Test Loss: 2.314 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.5181894302368164
Epoch: 42, Steps: 8 | Train Loss: 0.058 Vali Loss: 2.163 Vali Acc: 0.384 Test Loss: 2.163 Test Acc: 0.384
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.6437180042266846
Epoch: 43, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.128 Vali Acc: 0.409 Test Loss: 2.128 Test Acc: 0.409
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.7218005657196045
Epoch: 44, Steps: 8 | Train Loss: 0.055 Vali Loss: 2.204 Vali Acc: 0.378 Test Loss: 2.204 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.425
model parameter : 172616
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.166464328765869
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 2.189 Vali Acc: 0.125 Test Loss: 2.189 Test Acc: 0.125
Validation loss decreased (inf --> -0.124978).  Saving model ...
Epoch: 2 cost time: 2.590008020401001
Epoch: 2, Steps: 8 | Train Loss: 2.090 Vali Loss: 2.166 Vali Acc: 0.125 Test Loss: 2.166 Test Acc: 0.125
Validation loss decreased (-0.124978 --> -0.124978).  Saving model ...
Epoch: 3 cost time: 2.5946288108825684
Epoch: 3, Steps: 8 | Train Loss: 2.035 Vali Loss: 2.137 Vali Acc: 0.138 Test Loss: 2.137 Test Acc: 0.138
Validation loss decreased (-0.124978 --> -0.137479).  Saving model ...
Epoch: 4 cost time: 2.3590009212493896
Epoch: 4, Steps: 8 | Train Loss: 1.965 Vali Loss: 2.107 Vali Acc: 0.219 Test Loss: 2.107 Test Acc: 0.219
Validation loss decreased (-0.137479 --> -0.218729).  Saving model ...
Epoch: 5 cost time: 2.5670199394226074
Epoch: 5, Steps: 8 | Train Loss: 1.880 Vali Loss: 2.081 Vali Acc: 0.234 Test Loss: 2.081 Test Acc: 0.234
Validation loss decreased (-0.218729 --> -0.234354).  Saving model ...
Epoch: 6 cost time: 2.6559650897979736
Epoch: 6, Steps: 8 | Train Loss: 1.744 Vali Loss: 2.056 Vali Acc: 0.247 Test Loss: 2.056 Test Acc: 0.247
Validation loss decreased (-0.234354 --> -0.246854).  Saving model ...
Epoch: 7 cost time: 2.7942216396331787
Epoch: 7, Steps: 8 | Train Loss: 1.682 Vali Loss: 2.032 Vali Acc: 0.247 Test Loss: 2.032 Test Acc: 0.247
Validation loss decreased (-0.246854 --> -0.246855).  Saving model ...
Epoch: 8 cost time: 2.8233728408813477
Epoch: 8, Steps: 8 | Train Loss: 1.533 Vali Loss: 1.987 Vali Acc: 0.247 Test Loss: 1.987 Test Acc: 0.247
Validation loss decreased (-0.246855 --> -0.246855).  Saving model ...
Epoch: 9 cost time: 2.8121843338012695
Epoch: 9, Steps: 8 | Train Loss: 1.492 Vali Loss: 1.958 Vali Acc: 0.244 Test Loss: 1.958 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.763249158859253
Epoch: 10, Steps: 8 | Train Loss: 1.399 Vali Loss: 1.921 Vali Acc: 0.250 Test Loss: 1.921 Test Acc: 0.250
Validation loss decreased (-0.246855 --> -0.249981).  Saving model ...
Epoch: 11 cost time: 2.7374627590179443
Epoch: 11, Steps: 8 | Train Loss: 1.294 Vali Loss: 1.869 Vali Acc: 0.287 Test Loss: 1.869 Test Acc: 0.287
Validation loss decreased (-0.249981 --> -0.287481).  Saving model ...
Epoch: 12 cost time: 2.6643309593200684
Epoch: 12, Steps: 8 | Train Loss: 1.104 Vali Loss: 1.829 Vali Acc: 0.325 Test Loss: 1.829 Test Acc: 0.325
Validation loss decreased (-0.287481 --> -0.324982).  Saving model ...
Epoch: 13 cost time: 2.76983904838562
Epoch: 13, Steps: 8 | Train Loss: 1.008 Vali Loss: 1.797 Vali Acc: 0.347 Test Loss: 1.797 Test Acc: 0.347
Validation loss decreased (-0.324982 --> -0.346857).  Saving model ...
Epoch: 14 cost time: 3.0151801109313965
Epoch: 14, Steps: 8 | Train Loss: 0.928 Vali Loss: 1.746 Vali Acc: 0.381 Test Loss: 1.746 Test Acc: 0.381
Validation loss decreased (-0.346857 --> -0.381233).  Saving model ...
Epoch: 15 cost time: 2.6547327041625977
Epoch: 15, Steps: 8 | Train Loss: 0.837 Vali Loss: 1.700 Vali Acc: 0.409 Test Loss: 1.700 Test Acc: 0.409
Validation loss decreased (-0.381233 --> -0.409358).  Saving model ...
Epoch: 16 cost time: 2.6874444484710693
Epoch: 16, Steps: 8 | Train Loss: 0.750 Vali Loss: 1.688 Vali Acc: 0.394 Test Loss: 1.688 Test Acc: 0.394
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.642104387283325
Epoch: 17, Steps: 8 | Train Loss: 0.677 Vali Loss: 1.617 Vali Acc: 0.431 Test Loss: 1.617 Test Acc: 0.431
Validation loss decreased (-0.409358 --> -0.431234).  Saving model ...
Epoch: 18 cost time: 2.587690830230713
Epoch: 18, Steps: 8 | Train Loss: 0.689 Vali Loss: 1.594 Vali Acc: 0.422 Test Loss: 1.594 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6929147243499756
Epoch: 19, Steps: 8 | Train Loss: 0.636 Vali Loss: 1.615 Vali Acc: 0.366 Test Loss: 1.615 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5821871757507324
Epoch: 20, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.553 Vali Acc: 0.391 Test Loss: 1.553 Test Acc: 0.391
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.837327480316162
Epoch: 21, Steps: 8 | Train Loss: 0.506 Vali Loss: 1.555 Vali Acc: 0.384 Test Loss: 1.555 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.897412061691284
Epoch: 22, Steps: 8 | Train Loss: 0.434 Vali Loss: 1.547 Vali Acc: 0.422 Test Loss: 1.547 Test Acc: 0.422
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.829693078994751
Epoch: 23, Steps: 8 | Train Loss: 0.411 Vali Loss: 1.675 Vali Acc: 0.356 Test Loss: 1.675 Test Acc: 0.356
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.6305742263793945
Epoch: 24, Steps: 8 | Train Loss: 0.387 Vali Loss: 1.598 Vali Acc: 0.359 Test Loss: 1.598 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.778231143951416
Epoch: 25, Steps: 8 | Train Loss: 0.376 Vali Loss: 1.517 Vali Acc: 0.384 Test Loss: 1.517 Test Acc: 0.384
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.0816423892974854
Epoch: 26, Steps: 8 | Train Loss: 0.363 Vali Loss: 1.545 Vali Acc: 0.362 Test Loss: 1.545 Test Acc: 0.362
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.75431227684021
Epoch: 27, Steps: 8 | Train Loss: 0.280 Vali Loss: 1.613 Vali Acc: 0.338 Test Loss: 1.613 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.43125
model parameter : 172616
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         158                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9021530151367188
Epoch: 1, Steps: 8 | Train Loss: 2.139 Vali Loss: 2.025 Vali Acc: 0.184 Test Loss: 2.025 Test Acc: 0.184
Validation loss decreased (inf --> -0.184355).  Saving model ...
Epoch: 2 cost time: 2.4955332279205322
Epoch: 2, Steps: 8 | Train Loss: 1.978 Vali Loss: 1.712 Vali Acc: 0.487 Test Loss: 1.712 Test Acc: 0.487
Validation loss decreased (-0.184355 --> -0.487483).  Saving model ...
Epoch: 3 cost time: 2.3229382038116455
Epoch: 3, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.392 Vali Acc: 0.641 Test Loss: 1.392 Test Acc: 0.641
Validation loss decreased (-0.487483 --> -0.640611).  Saving model ...
Epoch: 4 cost time: 2.4954116344451904
Epoch: 4, Steps: 8 | Train Loss: 1.278 Vali Loss: 1.129 Vali Acc: 0.734 Test Loss: 1.129 Test Acc: 0.734
Validation loss decreased (-0.640611 --> -0.734364).  Saving model ...
Epoch: 5 cost time: 2.3318514823913574
Epoch: 5, Steps: 8 | Train Loss: 0.952 Vali Loss: 0.965 Vali Acc: 0.759 Test Loss: 0.965 Test Acc: 0.759
Validation loss decreased (-0.734364 --> -0.759365).  Saving model ...
Epoch: 6 cost time: 2.5177114009857178
Epoch: 6, Steps: 8 | Train Loss: 0.735 Vali Loss: 0.851 Vali Acc: 0.766 Test Loss: 0.851 Test Acc: 0.766
Validation loss decreased (-0.759365 --> -0.765616).  Saving model ...
Epoch: 7 cost time: 2.3806934356689453
Epoch: 7, Steps: 8 | Train Loss: 0.575 Vali Loss: 0.758 Vali Acc: 0.784 Test Loss: 0.758 Test Acc: 0.784
Validation loss decreased (-0.765616 --> -0.784367).  Saving model ...
Epoch: 8 cost time: 2.341073751449585
Epoch: 8, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.714 Vali Acc: 0.791 Test Loss: 0.714 Test Acc: 0.791
Validation loss decreased (-0.784367 --> -0.790618).  Saving model ...
Epoch: 9 cost time: 2.7448348999023438
Epoch: 9, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.688 Vali Acc: 0.781 Test Loss: 0.688 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7563469409942627
Epoch: 10, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.705 Vali Acc: 0.778 Test Loss: 0.705 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5725998878479004
Epoch: 11, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.679 Vali Acc: 0.778 Test Loss: 0.679 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5704526901245117
Epoch: 12, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.674 Vali Acc: 0.775 Test Loss: 0.674 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.785299301147461
Epoch: 13, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.693 Vali Acc: 0.766 Test Loss: 0.693 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7384674549102783
Epoch: 14, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.691 Vali Acc: 0.775 Test Loss: 0.691 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.557976484298706
Epoch: 15, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.712 Vali Acc: 0.766 Test Loss: 0.712 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4527816772460938
Epoch: 16, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.725 Vali Acc: 0.775 Test Loss: 0.725 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.47975492477417
Epoch: 17, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.746 Vali Acc: 0.759 Test Loss: 0.746 Test Acc: 0.759
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.519815444946289
Epoch: 18, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.743 Vali Acc: 0.756 Test Loss: 0.743 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.790625
model parameter : 148040
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         126                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8922159671783447
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 2.050 Vali Acc: 0.166 Test Loss: 2.050 Test Acc: 0.166
Validation loss decreased (inf --> -0.165604).  Saving model ...
Epoch: 2 cost time: 2.621889352798462
Epoch: 2, Steps: 8 | Train Loss: 2.009 Vali Loss: 1.801 Vali Acc: 0.409 Test Loss: 1.801 Test Acc: 0.409
Validation loss decreased (-0.165604 --> -0.409357).  Saving model ...
Epoch: 3 cost time: 2.4704208374023438
Epoch: 3, Steps: 8 | Train Loss: 1.691 Vali Loss: 1.540 Vali Acc: 0.556 Test Loss: 1.540 Test Acc: 0.556
Validation loss decreased (-0.409357 --> -0.556235).  Saving model ...
Epoch: 4 cost time: 2.865603446960449
Epoch: 4, Steps: 8 | Train Loss: 1.403 Vali Loss: 1.319 Vali Acc: 0.653 Test Loss: 1.319 Test Acc: 0.653
Validation loss decreased (-0.556235 --> -0.653112).  Saving model ...
Epoch: 5 cost time: 2.6346309185028076
Epoch: 5, Steps: 8 | Train Loss: 1.111 Vali Loss: 1.178 Vali Acc: 0.666 Test Loss: 1.178 Test Acc: 0.666
Validation loss decreased (-0.653112 --> -0.665613).  Saving model ...
Epoch: 6 cost time: 2.643792152404785
Epoch: 6, Steps: 8 | Train Loss: 0.892 Vali Loss: 1.063 Vali Acc: 0.672 Test Loss: 1.063 Test Acc: 0.672
Validation loss decreased (-0.665613 --> -0.671864).  Saving model ...
Epoch: 7 cost time: 2.642871856689453
Epoch: 7, Steps: 8 | Train Loss: 0.697 Vali Loss: 0.959 Vali Acc: 0.697 Test Loss: 0.959 Test Acc: 0.697
Validation loss decreased (-0.671864 --> -0.696865).  Saving model ...
Epoch: 8 cost time: 2.9500064849853516
Epoch: 8, Steps: 8 | Train Loss: 0.569 Vali Loss: 0.907 Vali Acc: 0.713 Test Loss: 0.907 Test Acc: 0.713
Validation loss decreased (-0.696865 --> -0.712491).  Saving model ...
Epoch: 9 cost time: 2.661832571029663
Epoch: 9, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.860 Vali Acc: 0.719 Test Loss: 0.860 Test Acc: 0.719
Validation loss decreased (-0.712491 --> -0.718741).  Saving model ...
Epoch: 10 cost time: 2.7855443954467773
Epoch: 10, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.845 Vali Acc: 0.716 Test Loss: 0.845 Test Acc: 0.716
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.531890630722046
Epoch: 11, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.842 Vali Acc: 0.709 Test Loss: 0.842 Test Acc: 0.709
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.436218500137329
Epoch: 12, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.835 Vali Acc: 0.716 Test Loss: 0.835 Test Acc: 0.716
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5773613452911377
Epoch: 13, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.834 Vali Acc: 0.706 Test Loss: 0.834 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.662205457687378
Epoch: 14, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.832 Vali Acc: 0.716 Test Loss: 0.832 Test Acc: 0.716
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.8904972076416016
Epoch: 15, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.876 Vali Acc: 0.713 Test Loss: 0.876 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.585210084915161
Epoch: 16, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.896 Vali Acc: 0.709 Test Loss: 0.896 Test Acc: 0.709
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.8885438442230225
Epoch: 17, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.869 Vali Acc: 0.709 Test Loss: 0.869 Test Acc: 0.709
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.6707212924957275
Epoch: 18, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.907 Vali Acc: 0.700 Test Loss: 0.907 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.505497932434082
Epoch: 19, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.948 Vali Acc: 0.709 Test Loss: 0.948 Test Acc: 0.709
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.71875
model parameter : 148040
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         95                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma95_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9276223182678223
Epoch: 1, Steps: 8 | Train Loss: 2.148 Vali Loss: 2.083 Vali Acc: 0.153 Test Loss: 2.083 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 2.6604669094085693
Epoch: 2, Steps: 8 | Train Loss: 2.030 Vali Loss: 1.889 Vali Acc: 0.331 Test Loss: 1.889 Test Acc: 0.331
Validation loss decreased (-0.153104 --> -0.331231).  Saving model ...
Epoch: 3 cost time: 2.6849722862243652
Epoch: 3, Steps: 8 | Train Loss: 1.775 Vali Loss: 1.669 Vali Acc: 0.522 Test Loss: 1.669 Test Acc: 0.522
Validation loss decreased (-0.331231 --> -0.521858).  Saving model ...
Epoch: 4 cost time: 2.948127269744873
Epoch: 4, Steps: 8 | Train Loss: 1.521 Vali Loss: 1.467 Vali Acc: 0.588 Test Loss: 1.467 Test Acc: 0.588
Validation loss decreased (-0.521858 --> -0.587485).  Saving model ...
Epoch: 5 cost time: 2.6980738639831543
Epoch: 5, Steps: 8 | Train Loss: 1.244 Vali Loss: 1.320 Vali Acc: 0.603 Test Loss: 1.320 Test Acc: 0.603
Validation loss decreased (-0.587485 --> -0.603112).  Saving model ...
Epoch: 6 cost time: 2.5554070472717285
Epoch: 6, Steps: 8 | Train Loss: 1.017 Vali Loss: 1.211 Vali Acc: 0.613 Test Loss: 1.211 Test Acc: 0.613
Validation loss decreased (-0.603112 --> -0.612488).  Saving model ...
Epoch: 7 cost time: 2.3244552612304688
Epoch: 7, Steps: 8 | Train Loss: 0.814 Vali Loss: 1.115 Vali Acc: 0.650 Test Loss: 1.115 Test Acc: 0.650
Validation loss decreased (-0.612488 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 2.7971277236938477
Epoch: 8, Steps: 8 | Train Loss: 0.682 Vali Loss: 1.051 Vali Acc: 0.647 Test Loss: 1.051 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.312690496444702
Epoch: 9, Steps: 8 | Train Loss: 0.539 Vali Loss: 1.015 Vali Acc: 0.653 Test Loss: 1.015 Test Acc: 0.653
Validation loss decreased (-0.649989 --> -0.653115).  Saving model ...
Epoch: 10 cost time: 2.6362030506134033
Epoch: 10, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4665913581848145
Epoch: 11, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.965 Vali Acc: 0.681 Test Loss: 0.965 Test Acc: 0.681
Validation loss decreased (-0.653115 --> -0.681240).  Saving model ...
Epoch: 12 cost time: 2.598381996154785
Epoch: 12, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.959 Vali Acc: 0.659 Test Loss: 0.959 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.671532154083252
Epoch: 13, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.955 Vali Acc: 0.666 Test Loss: 0.955 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7751598358154297
Epoch: 14, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.964 Vali Acc: 0.675 Test Loss: 0.964 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.585638999938965
Epoch: 15, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.981 Vali Acc: 0.653 Test Loss: 0.981 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4421792030334473
Epoch: 16, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.987 Vali Acc: 0.662 Test Loss: 0.987 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.5302436351776123
Epoch: 17, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.986 Vali Acc: 0.669 Test Loss: 0.986 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7626423835754395
Epoch: 18, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.005 Vali Acc: 0.666 Test Loss: 1.005 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5377118587493896
Epoch: 19, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.032 Vali Acc: 0.662 Test Loss: 1.032 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5107059478759766
Epoch: 20, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.032 Vali Acc: 0.672 Test Loss: 1.032 Test Acc: 0.672
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6473288536071777
Epoch: 21, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.042 Vali Acc: 0.650 Test Loss: 1.042 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma95_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.68125
model parameter : 148040
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         63                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.0641961097717285
Epoch: 1, Steps: 8 | Train Loss: 2.150 Vali Loss: 2.096 Vali Acc: 0.144 Test Loss: 2.096 Test Acc: 0.144
Validation loss decreased (inf --> -0.143729).  Saving model ...
Epoch: 2 cost time: 2.545828104019165
Epoch: 2, Steps: 8 | Train Loss: 2.093 Vali Loss: 1.978 Vali Acc: 0.263 Test Loss: 1.978 Test Acc: 0.263
Validation loss decreased (-0.143729 --> -0.262480).  Saving model ...
Epoch: 3 cost time: 2.606057643890381
Epoch: 3, Steps: 8 | Train Loss: 1.892 Vali Loss: 1.834 Vali Acc: 0.384 Test Loss: 1.834 Test Acc: 0.384
Validation loss decreased (-0.262480 --> -0.384357).  Saving model ...
Epoch: 4 cost time: 2.587940216064453
Epoch: 4, Steps: 8 | Train Loss: 1.711 Vali Loss: 1.686 Vali Acc: 0.491 Test Loss: 1.686 Test Acc: 0.491
Validation loss decreased (-0.384357 --> -0.490608).  Saving model ...
Epoch: 5 cost time: 2.6744232177734375
Epoch: 5, Steps: 8 | Train Loss: 1.510 Vali Loss: 1.544 Vali Acc: 0.537 Test Loss: 1.544 Test Acc: 0.537
Validation loss decreased (-0.490608 --> -0.537485).  Saving model ...
Epoch: 6 cost time: 2.8537256717681885
Epoch: 6, Steps: 8 | Train Loss: 1.267 Vali Loss: 1.431 Vali Acc: 0.547 Test Loss: 1.431 Test Acc: 0.547
Validation loss decreased (-0.537485 --> -0.546861).  Saving model ...
Epoch: 7 cost time: 2.831467866897583
Epoch: 7, Steps: 8 | Train Loss: 1.077 Vali Loss: 1.333 Vali Acc: 0.584 Test Loss: 1.333 Test Acc: 0.584
Validation loss decreased (-0.546861 --> -0.584362).  Saving model ...
Epoch: 8 cost time: 2.714048385620117
Epoch: 8, Steps: 8 | Train Loss: 0.922 Vali Loss: 1.243 Vali Acc: 0.600 Test Loss: 1.243 Test Acc: 0.600
Validation loss decreased (-0.584362 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 2.935346841812134
Epoch: 9, Steps: 8 | Train Loss: 0.773 Vali Loss: 1.177 Vali Acc: 0.603 Test Loss: 1.177 Test Acc: 0.603
Validation loss decreased (-0.599988 --> -0.603113).  Saving model ...
Epoch: 10 cost time: 2.917318344116211
Epoch: 10, Steps: 8 | Train Loss: 0.656 Vali Loss: 1.135 Vali Acc: 0.619 Test Loss: 1.135 Test Acc: 0.619
Validation loss decreased (-0.603113 --> -0.618739).  Saving model ...
Epoch: 11 cost time: 2.8889665603637695
Epoch: 11, Steps: 8 | Train Loss: 0.519 Vali Loss: 1.089 Vali Acc: 0.625 Test Loss: 1.089 Test Acc: 0.625
Validation loss decreased (-0.618739 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 2.930427312850952
Epoch: 12, Steps: 8 | Train Loss: 0.468 Vali Loss: 1.079 Vali Acc: 0.603 Test Loss: 1.079 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.703218936920166
Epoch: 13, Steps: 8 | Train Loss: 0.401 Vali Loss: 1.050 Vali Acc: 0.616 Test Loss: 1.050 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5195367336273193
Epoch: 14, Steps: 8 | Train Loss: 0.319 Vali Loss: 1.049 Vali Acc: 0.619 Test Loss: 1.049 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.787165641784668
Epoch: 15, Steps: 8 | Train Loss: 0.271 Vali Loss: 1.008 Vali Acc: 0.628 Test Loss: 1.008 Test Acc: 0.628
Validation loss decreased (-0.624989 --> -0.628115).  Saving model ...
Epoch: 16 cost time: 2.7370405197143555
Epoch: 16, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.011 Vali Acc: 0.634 Test Loss: 1.011 Test Acc: 0.634
Validation loss decreased (-0.628115 --> -0.634365).  Saving model ...
Epoch: 17 cost time: 3.0748863220214844
Epoch: 17, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.025 Vali Acc: 0.606 Test Loss: 1.025 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6677231788635254
Epoch: 18, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.034 Vali Acc: 0.628 Test Loss: 1.034 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.9058263301849365
Epoch: 19, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.062 Vali Acc: 0.619 Test Loss: 1.062 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6175808906555176
Epoch: 20, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.011 Vali Acc: 0.644 Test Loss: 1.011 Test Acc: 0.644
Validation loss decreased (-0.634365 --> -0.643740).  Saving model ...
Epoch: 21 cost time: 2.9382097721099854
Epoch: 21, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.018 Vali Acc: 0.613 Test Loss: 1.018 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0178771018981934
Epoch: 22, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.024 Vali Acc: 0.637 Test Loss: 1.024 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.049147367477417
Epoch: 23, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.021 Vali Acc: 0.634 Test Loss: 1.021 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.88364839553833
Epoch: 24, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.008 Vali Acc: 0.631 Test Loss: 1.008 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.64636492729187
Epoch: 25, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.046 Vali Acc: 0.637 Test Loss: 1.046 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.91764760017395
Epoch: 26, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.029 Vali Acc: 0.641 Test Loss: 1.029 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.471466064453125
Epoch: 27, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.015 Vali Acc: 0.647 Test Loss: 1.015 Test Acc: 0.647
Validation loss decreased (-0.643740 --> -0.646865).  Saving model ...
Epoch: 28 cost time: 2.6371495723724365
Epoch: 28, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.005 Vali Acc: 0.656 Test Loss: 1.005 Test Acc: 0.656
Validation loss decreased (-0.646865 --> -0.656240).  Saving model ...
Epoch: 29 cost time: 2.58503794670105
Epoch: 29, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.017 Vali Acc: 0.662 Test Loss: 1.017 Test Acc: 0.662
Validation loss decreased (-0.656240 --> -0.662490).  Saving model ...
Epoch: 30 cost time: 2.872044324874878
Epoch: 30, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.030 Vali Acc: 0.644 Test Loss: 1.030 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.42635178565979
Epoch: 31, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.024 Vali Acc: 0.644 Test Loss: 1.024 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.557171106338501
Epoch: 32, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.039 Vali Acc: 0.644 Test Loss: 1.039 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.857966184616089
Epoch: 33, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.047 Vali Acc: 0.650 Test Loss: 1.047 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.78971266746521
Epoch: 34, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.017 Vali Acc: 0.647 Test Loss: 1.017 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.8466899394989014
Epoch: 35, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.029 Vali Acc: 0.647 Test Loss: 1.029 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.7220633029937744
Epoch: 36, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.047 Vali Acc: 0.644 Test Loss: 1.047 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.9336907863616943
Epoch: 37, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.037 Vali Acc: 0.644 Test Loss: 1.037 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.7337160110473633
Epoch: 38, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.029 Vali Acc: 0.653 Test Loss: 1.029 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.8373827934265137
Epoch: 39, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.013 Vali Acc: 0.662 Test Loss: 1.013 Test Acc: 0.662
Validation loss decreased (-0.662490 --> -0.662490).  Saving model ...
Epoch: 40 cost time: 2.6877217292785645
Epoch: 40, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.007 Vali Acc: 0.666 Test Loss: 1.007 Test Acc: 0.666
Validation loss decreased (-0.662490 --> -0.665615).  Saving model ...
Epoch: 41 cost time: 2.521919012069702
Epoch: 41, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.024 Vali Acc: 0.669 Test Loss: 1.024 Test Acc: 0.669
Validation loss decreased (-0.665615 --> -0.668740).  Saving model ...
Epoch: 42 cost time: 2.388047456741333
Epoch: 42, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.043 Vali Acc: 0.672 Test Loss: 1.043 Test Acc: 0.672
Validation loss decreased (-0.668740 --> -0.671865).  Saving model ...
Epoch: 43 cost time: 2.45564341545105
Epoch: 43, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.039 Vali Acc: 0.669 Test Loss: 1.039 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.6796562671661377
Epoch: 44, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.032 Vali Acc: 0.678 Test Loss: 1.032 Test Acc: 0.678
Validation loss decreased (-0.671865 --> -0.678115).  Saving model ...
Epoch: 45 cost time: 2.5210583209991455
Epoch: 45, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.052 Vali Acc: 0.662 Test Loss: 1.052 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.680985927581787
Epoch: 46, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.051 Vali Acc: 0.666 Test Loss: 1.051 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.791551113128662
Epoch: 47, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.035 Vali Acc: 0.662 Test Loss: 1.035 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.7359087467193604
Epoch: 48, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.039 Vali Acc: 0.678 Test Loss: 1.039 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.6048970222473145
Epoch: 49, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.048 Vali Acc: 0.678 Test Loss: 1.048 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.8787081241607666
Epoch: 50, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.039 Vali Acc: 0.681 Test Loss: 1.039 Test Acc: 0.681
Validation loss decreased (-0.678115 --> -0.681240).  Saving model ...
Epoch: 51 cost time: 2.465463876724243
Epoch: 51, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.040 Vali Acc: 0.662 Test Loss: 1.040 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.5682485103607178
Epoch: 52, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.031 Vali Acc: 0.662 Test Loss: 1.031 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.768648386001587
Epoch: 53, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.027 Vali Acc: 0.669 Test Loss: 1.027 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.757221221923828
Epoch: 54, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.026 Vali Acc: 0.678 Test Loss: 1.026 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.707477569580078
Epoch: 55, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.027 Vali Acc: 0.666 Test Loss: 1.027 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.904627561569214
Epoch: 56, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.043 Vali Acc: 0.678 Test Loss: 1.043 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.185321569442749
Epoch: 57, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.045 Vali Acc: 0.684 Test Loss: 1.045 Test Acc: 0.684
Validation loss decreased (-0.681240 --> -0.684365).  Saving model ...
Epoch: 58 cost time: 2.9117298126220703
Epoch: 58, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.037 Vali Acc: 0.681 Test Loss: 1.037 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.852116346359253
Epoch: 59, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.042 Vali Acc: 0.675 Test Loss: 1.042 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.961085319519043
Epoch: 60, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.041 Vali Acc: 0.672 Test Loss: 1.041 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.6630094051361084
Epoch: 61, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.054 Vali Acc: 0.678 Test Loss: 1.054 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 2.4166572093963623
Epoch: 62, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.049 Vali Acc: 0.681 Test Loss: 1.049 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 2.729919672012329
Epoch: 63, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.035 Vali Acc: 0.684 Test Loss: 1.035 Test Acc: 0.684
Validation loss decreased (-0.684365 --> -0.684365).  Saving model ...
Epoch: 64 cost time: 2.584095001220703
Epoch: 64, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.024 Vali Acc: 0.681 Test Loss: 1.024 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.6486916542053223
Epoch: 65, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.017 Vali Acc: 0.688 Test Loss: 1.017 Test Acc: 0.688
Validation loss decreased (-0.684365 --> -0.687490).  Saving model ...
Epoch: 66 cost time: 2.739413261413574
Epoch: 66, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.018 Vali Acc: 0.684 Test Loss: 1.018 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.700436592102051
Epoch: 67, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.022 Vali Acc: 0.681 Test Loss: 1.022 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 2.873533010482788
Epoch: 68, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.032 Vali Acc: 0.681 Test Loss: 1.032 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 2.730998992919922
Epoch: 69, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.039 Vali Acc: 0.688 Test Loss: 1.039 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 3.1997756958007812
Epoch: 70, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.031 Vali Acc: 0.681 Test Loss: 1.031 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 2.87894868850708
Epoch: 71, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.025 Vali Acc: 0.688 Test Loss: 1.025 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 2.8898918628692627
Epoch: 72, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.022 Vali Acc: 0.688 Test Loss: 1.022 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 2.76169490814209
Epoch: 73, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.019 Vali Acc: 0.688 Test Loss: 1.019 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 2.9398794174194336
Epoch: 74, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.027 Vali Acc: 0.694 Test Loss: 1.027 Test Acc: 0.694
Validation loss decreased (-0.687490 --> -0.693740).  Saving model ...
Epoch: 75 cost time: 2.639901638031006
Epoch: 75, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.028 Vali Acc: 0.694 Test Loss: 1.028 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 2.722557783126831
Epoch: 76, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.032 Vali Acc: 0.684 Test Loss: 1.032 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 2.3553130626678467
Epoch: 77, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.034 Vali Acc: 0.681 Test Loss: 1.034 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 2.513117551803589
Epoch: 78, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.037 Vali Acc: 0.681 Test Loss: 1.037 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 2.773822546005249
Epoch: 79, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.044 Vali Acc: 0.684 Test Loss: 1.044 Test Acc: 0.684
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 2.612161159515381
Epoch: 80, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.038 Vali Acc: 0.681 Test Loss: 1.038 Test Acc: 0.681
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 2.527852773666382
Epoch: 81, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.039 Vali Acc: 0.681 Test Loss: 1.039 Test Acc: 0.681
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 2.8949921131134033
Epoch: 82, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.037 Vali Acc: 0.688 Test Loss: 1.037 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 2.7038867473602295
Epoch: 83, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.038 Vali Acc: 0.691 Test Loss: 1.038 Test Acc: 0.691
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 2.89642333984375
Epoch: 84, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.694 Test Loss: 1.036 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.69375
model parameter : 148040
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.196228981018066
Epoch: 1, Steps: 8 | Train Loss: 2.073 Vali Loss: 2.064 Vali Acc: 0.156 Test Loss: 2.064 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 2.8467679023742676
Epoch: 2, Steps: 8 | Train Loss: 2.027 Vali Loss: 2.004 Vali Acc: 0.225 Test Loss: 2.004 Test Acc: 0.225
Validation loss decreased (-0.156229 --> -0.224980).  Saving model ...
Epoch: 3 cost time: 2.886096239089966
Epoch: 3, Steps: 8 | Train Loss: 1.918 Vali Loss: 1.932 Vali Acc: 0.306 Test Loss: 1.932 Test Acc: 0.306
Validation loss decreased (-0.224980 --> -0.306231).  Saving model ...
Epoch: 4 cost time: 3.111265182495117
Epoch: 4, Steps: 8 | Train Loss: 1.809 Vali Loss: 1.848 Vali Acc: 0.341 Test Loss: 1.848 Test Acc: 0.341
Validation loss decreased (-0.306231 --> -0.340607).  Saving model ...
Epoch: 5 cost time: 2.9404501914978027
Epoch: 5, Steps: 8 | Train Loss: 1.654 Vali Loss: 1.771 Vali Acc: 0.381 Test Loss: 1.771 Test Acc: 0.381
Validation loss decreased (-0.340607 --> -0.381232).  Saving model ...
Epoch: 6 cost time: 2.7914042472839355
Epoch: 6, Steps: 8 | Train Loss: 1.479 Vali Loss: 1.693 Vali Acc: 0.400 Test Loss: 1.693 Test Acc: 0.400
Validation loss decreased (-0.381232 --> -0.399983).  Saving model ...
Epoch: 7 cost time: 2.8081674575805664
Epoch: 7, Steps: 8 | Train Loss: 1.335 Vali Loss: 1.614 Vali Acc: 0.441 Test Loss: 1.614 Test Acc: 0.441
Validation loss decreased (-0.399983 --> -0.440609).  Saving model ...
Epoch: 8 cost time: 2.6022801399230957
Epoch: 8, Steps: 8 | Train Loss: 1.186 Vali Loss: 1.548 Vali Acc: 0.450 Test Loss: 1.548 Test Acc: 0.450
Validation loss decreased (-0.440609 --> -0.449985).  Saving model ...
Epoch: 9 cost time: 2.5937788486480713
Epoch: 9, Steps: 8 | Train Loss: 1.018 Vali Loss: 1.484 Vali Acc: 0.469 Test Loss: 1.484 Test Acc: 0.469
Validation loss decreased (-0.449985 --> -0.468735).  Saving model ...
Epoch: 10 cost time: 2.742769479751587
Epoch: 10, Steps: 8 | Train Loss: 0.906 Vali Loss: 1.457 Vali Acc: 0.425 Test Loss: 1.457 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7401516437530518
Epoch: 11, Steps: 8 | Train Loss: 0.771 Vali Loss: 1.391 Vali Acc: 0.487 Test Loss: 1.391 Test Acc: 0.487
Validation loss decreased (-0.468735 --> -0.487486).  Saving model ...
Epoch: 12 cost time: 2.8201377391815186
Epoch: 12, Steps: 8 | Train Loss: 0.693 Vali Loss: 1.391 Vali Acc: 0.481 Test Loss: 1.391 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.76216721534729
Epoch: 13, Steps: 8 | Train Loss: 0.600 Vali Loss: 1.362 Vali Acc: 0.469 Test Loss: 1.362 Test Acc: 0.469
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.702502727508545
Epoch: 14, Steps: 8 | Train Loss: 0.541 Vali Loss: 1.314 Vali Acc: 0.503 Test Loss: 1.314 Test Acc: 0.503
Validation loss decreased (-0.487486 --> -0.503112).  Saving model ...
Epoch: 15 cost time: 2.5423355102539062
Epoch: 15, Steps: 8 | Train Loss: 0.461 Vali Loss: 1.297 Vali Acc: 0.503 Test Loss: 1.297 Test Acc: 0.503
Validation loss decreased (-0.503112 --> -0.503112).  Saving model ...
Epoch: 16 cost time: 2.6592962741851807
Epoch: 16, Steps: 8 | Train Loss: 0.422 Vali Loss: 1.329 Vali Acc: 0.491 Test Loss: 1.329 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6474215984344482
Epoch: 17, Steps: 8 | Train Loss: 0.343 Vali Loss: 1.294 Vali Acc: 0.509 Test Loss: 1.294 Test Acc: 0.509
Validation loss decreased (-0.503112 --> -0.509362).  Saving model ...
Epoch: 18 cost time: 2.3423008918762207
Epoch: 18, Steps: 8 | Train Loss: 0.287 Vali Loss: 1.223 Vali Acc: 0.528 Test Loss: 1.223 Test Acc: 0.528
Validation loss decreased (-0.509362 --> -0.528113).  Saving model ...
Epoch: 19 cost time: 2.5210094451904297
Epoch: 19, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.333 Vali Acc: 0.497 Test Loss: 1.333 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.580617666244507
Epoch: 20, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.215 Vali Acc: 0.544 Test Loss: 1.215 Test Acc: 0.544
Validation loss decreased (-0.528113 --> -0.543738).  Saving model ...
Epoch: 21 cost time: 2.727916955947876
Epoch: 21, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.247 Vali Acc: 0.531 Test Loss: 1.247 Test Acc: 0.531
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.558422565460205
Epoch: 22, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.334 Vali Acc: 0.512 Test Loss: 1.334 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.4719042778015137
Epoch: 23, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.294 Vali Acc: 0.541 Test Loss: 1.294 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.9774234294891357
Epoch: 24, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.273 Vali Acc: 0.562 Test Loss: 1.273 Test Acc: 0.562
Validation loss decreased (-0.543738 --> -0.562487).  Saving model ...
Epoch: 25 cost time: 2.710761785507202
Epoch: 25, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.357 Vali Acc: 0.522 Test Loss: 1.357 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9609692096710205
Epoch: 26, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.375 Vali Acc: 0.525 Test Loss: 1.375 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7399723529815674
Epoch: 27, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.401 Vali Acc: 0.525 Test Loss: 1.401 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.8290045261383057
Epoch: 28, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.404 Vali Acc: 0.525 Test Loss: 1.404 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.557084560394287
Epoch: 29, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.472 Vali Acc: 0.497 Test Loss: 1.472 Test Acc: 0.497
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.839137554168701
Epoch: 30, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.374 Vali Acc: 0.541 Test Loss: 1.374 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.5489768981933594
Epoch: 31, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.409 Vali Acc: 0.531 Test Loss: 1.409 Test Acc: 0.531
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.664518117904663
Epoch: 32, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.472 Vali Acc: 0.512 Test Loss: 1.472 Test Acc: 0.512
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.702115535736084
Epoch: 33, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.406 Vali Acc: 0.537 Test Loss: 1.406 Test Acc: 0.537
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.955137014389038
Epoch: 34, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.351 Vali Acc: 0.575 Test Loss: 1.351 Test Acc: 0.575
Validation loss decreased (-0.562487 --> -0.574986).  Saving model ...
Epoch: 35 cost time: 2.5388453006744385
Epoch: 35, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.448 Vali Acc: 0.531 Test Loss: 1.448 Test Acc: 0.531
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.8509697914123535
Epoch: 36, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.553 Vali Acc: 0.519 Test Loss: 1.553 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.1024792194366455
Epoch: 37, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.439 Vali Acc: 0.556 Test Loss: 1.439 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.7060790061950684
Epoch: 38, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.427 Vali Acc: 0.553 Test Loss: 1.427 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.7327685356140137
Epoch: 39, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.393 Vali Acc: 0.562 Test Loss: 1.393 Test Acc: 0.562
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.733520746231079
Epoch: 40, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.394 Vali Acc: 0.569 Test Loss: 1.394 Test Acc: 0.569
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.0696096420288086
Epoch: 41, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.628 Vali Acc: 0.541 Test Loss: 1.628 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.9338905811309814
Epoch: 42, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.538 Vali Acc: 0.559 Test Loss: 1.538 Test Acc: 0.559
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.863590955734253
Epoch: 43, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.426 Vali Acc: 0.559 Test Loss: 1.426 Test Acc: 0.559
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.6036746501922607
Epoch: 44, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.421 Vali Acc: 0.566 Test Loss: 1.421 Test Acc: 0.566
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.575
model parameter : 148040
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.795794725418091
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 2.107 Vali Acc: 0.094 Test Loss: 2.107 Test Acc: 0.094
Validation loss decreased (inf --> -0.093729).  Saving model ...
Epoch: 2 cost time: 2.7617952823638916
Epoch: 2, Steps: 8 | Train Loss: 2.125 Vali Loss: 2.047 Vali Acc: 0.212 Test Loss: 2.047 Test Acc: 0.212
Validation loss decreased (-0.093729 --> -0.212480).  Saving model ...
Epoch: 3 cost time: 2.632098913192749
Epoch: 3, Steps: 8 | Train Loss: 2.024 Vali Loss: 2.008 Vali Acc: 0.237 Test Loss: 2.008 Test Acc: 0.237
Validation loss decreased (-0.212480 --> -0.237480).  Saving model ...
Epoch: 4 cost time: 2.8042986392974854
Epoch: 4, Steps: 8 | Train Loss: 1.930 Vali Loss: 1.963 Vali Acc: 0.241 Test Loss: 1.963 Test Acc: 0.241
Validation loss decreased (-0.237480 --> -0.240605).  Saving model ...
Epoch: 5 cost time: 3.0386271476745605
Epoch: 5, Steps: 8 | Train Loss: 1.847 Vali Loss: 1.918 Vali Acc: 0.362 Test Loss: 1.918 Test Acc: 0.362
Validation loss decreased (-0.240605 --> -0.362481).  Saving model ...
Epoch: 6 cost time: 2.6561551094055176
Epoch: 6, Steps: 8 | Train Loss: 1.690 Vali Loss: 1.876 Vali Acc: 0.328 Test Loss: 1.876 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4695773124694824
Epoch: 7, Steps: 8 | Train Loss: 1.542 Vali Loss: 1.811 Vali Acc: 0.425 Test Loss: 1.811 Test Acc: 0.425
Validation loss decreased (-0.362481 --> -0.424982).  Saving model ...
Epoch: 8 cost time: 2.698147773742676
Epoch: 8, Steps: 8 | Train Loss: 1.400 Vali Loss: 1.763 Vali Acc: 0.419 Test Loss: 1.763 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8877882957458496
Epoch: 9, Steps: 8 | Train Loss: 1.257 Vali Loss: 1.716 Vali Acc: 0.403 Test Loss: 1.716 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8020081520080566
Epoch: 10, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.661 Vali Acc: 0.406 Test Loss: 1.661 Test Acc: 0.406
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.833646774291992
Epoch: 11, Steps: 8 | Train Loss: 1.000 Vali Loss: 1.597 Vali Acc: 0.431 Test Loss: 1.597 Test Acc: 0.431
Validation loss decreased (-0.424982 --> -0.431234).  Saving model ...
Epoch: 12 cost time: 2.6183969974517822
Epoch: 12, Steps: 8 | Train Loss: 0.912 Vali Loss: 1.590 Vali Acc: 0.434 Test Loss: 1.590 Test Acc: 0.434
Validation loss decreased (-0.431234 --> -0.434359).  Saving model ...
Epoch: 13 cost time: 2.657938241958618
Epoch: 13, Steps: 8 | Train Loss: 0.756 Vali Loss: 1.516 Vali Acc: 0.481 Test Loss: 1.516 Test Acc: 0.481
Validation loss decreased (-0.434359 --> -0.481235).  Saving model ...
Epoch: 14 cost time: 2.632340669631958
Epoch: 14, Steps: 8 | Train Loss: 0.686 Vali Loss: 1.446 Vali Acc: 0.472 Test Loss: 1.446 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.709393262863159
Epoch: 15, Steps: 8 | Train Loss: 0.589 Vali Loss: 1.371 Vali Acc: 0.528 Test Loss: 1.371 Test Acc: 0.528
Validation loss decreased (-0.481235 --> -0.528111).  Saving model ...
Epoch: 16 cost time: 2.637159824371338
Epoch: 16, Steps: 8 | Train Loss: 0.563 Vali Loss: 1.364 Vali Acc: 0.472 Test Loss: 1.364 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.833894729614258
Epoch: 17, Steps: 8 | Train Loss: 0.425 Vali Loss: 1.304 Vali Acc: 0.516 Test Loss: 1.304 Test Acc: 0.516
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6283860206604004
Epoch: 18, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.220 Vali Acc: 0.572 Test Loss: 1.220 Test Acc: 0.572
Validation loss decreased (-0.528111 --> -0.571863).  Saving model ...
Epoch: 19 cost time: 2.9340670108795166
Epoch: 19, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.288 Vali Acc: 0.528 Test Loss: 1.288 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7654407024383545
Epoch: 20, Steps: 8 | Train Loss: 0.291 Vali Loss: 1.230 Vali Acc: 0.547 Test Loss: 1.230 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.9421262741088867
Epoch: 21, Steps: 8 | Train Loss: 0.248 Vali Loss: 1.284 Vali Acc: 0.553 Test Loss: 1.284 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.1817126274108887
Epoch: 22, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.283 Vali Acc: 0.544 Test Loss: 1.283 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.1777632236480713
Epoch: 23, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.308 Vali Acc: 0.531 Test Loss: 1.308 Test Acc: 0.531
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2736055850982666
Epoch: 24, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.392 Vali Acc: 0.506 Test Loss: 1.392 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.9614381790161133
Epoch: 25, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.367 Vali Acc: 0.512 Test Loss: 1.367 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7656447887420654
Epoch: 26, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.368 Vali Acc: 0.522 Test Loss: 1.368 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.546677350997925
Epoch: 27, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.428 Vali Acc: 0.525 Test Loss: 1.428 Test Acc: 0.525
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.4465384483337402
Epoch: 28, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.399 Vali Acc: 0.534 Test Loss: 1.399 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.571875
model parameter : 148040
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.874932050704956
Epoch: 1, Steps: 8 | Train Loss: 2.094 Vali Loss: 2.093 Vali Acc: 0.163 Test Loss: 2.093 Test Acc: 0.163
Validation loss decreased (inf --> -0.162479).  Saving model ...
Epoch: 2 cost time: 2.581369161605835
Epoch: 2, Steps: 8 | Train Loss: 2.132 Vali Loss: 2.053 Vali Acc: 0.197 Test Loss: 2.053 Test Acc: 0.197
Validation loss decreased (-0.162479 --> -0.196854).  Saving model ...
Epoch: 3 cost time: 2.9661824703216553
Epoch: 3, Steps: 8 | Train Loss: 2.019 Vali Loss: 2.027 Vali Acc: 0.194 Test Loss: 2.027 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.464930534362793
Epoch: 4, Steps: 8 | Train Loss: 1.948 Vali Loss: 1.994 Vali Acc: 0.216 Test Loss: 1.994 Test Acc: 0.216
Validation loss decreased (-0.196854 --> -0.215605).  Saving model ...
Epoch: 5 cost time: 2.8489370346069336
Epoch: 5, Steps: 8 | Train Loss: 1.842 Vali Loss: 1.969 Vali Acc: 0.278 Test Loss: 1.969 Test Acc: 0.278
Validation loss decreased (-0.215605 --> -0.278105).  Saving model ...
Epoch: 6 cost time: 3.285320520401001
Epoch: 6, Steps: 8 | Train Loss: 1.728 Vali Loss: 1.941 Vali Acc: 0.284 Test Loss: 1.941 Test Acc: 0.284
Validation loss decreased (-0.278105 --> -0.284356).  Saving model ...
Epoch: 7 cost time: 2.929008722305298
Epoch: 7, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.885 Vali Acc: 0.325 Test Loss: 1.885 Test Acc: 0.325
Validation loss decreased (-0.284356 --> -0.324981).  Saving model ...
Epoch: 8 cost time: 2.7432494163513184
Epoch: 8, Steps: 8 | Train Loss: 1.448 Vali Loss: 1.842 Vali Acc: 0.366 Test Loss: 1.842 Test Acc: 0.366
Validation loss decreased (-0.324981 --> -0.365607).  Saving model ...
Epoch: 9 cost time: 2.604567289352417
Epoch: 9, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.801 Vali Acc: 0.406 Test Loss: 1.801 Test Acc: 0.406
Validation loss decreased (-0.365607 --> -0.406232).  Saving model ...
Epoch: 10 cost time: 2.5392985343933105
Epoch: 10, Steps: 8 | Train Loss: 1.192 Vali Loss: 1.771 Vali Acc: 0.325 Test Loss: 1.771 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7817025184631348
Epoch: 11, Steps: 8 | Train Loss: 1.068 Vali Loss: 1.712 Vali Acc: 0.394 Test Loss: 1.712 Test Acc: 0.394
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4992005825042725
Epoch: 12, Steps: 8 | Train Loss: 0.942 Vali Loss: 1.681 Vali Acc: 0.438 Test Loss: 1.681 Test Acc: 0.438
Validation loss decreased (-0.406232 --> -0.437483).  Saving model ...
Epoch: 13 cost time: 2.3862082958221436
Epoch: 13, Steps: 8 | Train Loss: 0.822 Vali Loss: 1.629 Vali Acc: 0.453 Test Loss: 1.629 Test Acc: 0.453
Validation loss decreased (-0.437483 --> -0.453109).  Saving model ...
Epoch: 14 cost time: 2.545626640319824
Epoch: 14, Steps: 8 | Train Loss: 0.756 Vali Loss: 1.585 Vali Acc: 0.381 Test Loss: 1.585 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.559460401535034
Epoch: 15, Steps: 8 | Train Loss: 0.642 Vali Loss: 1.505 Vali Acc: 0.478 Test Loss: 1.505 Test Acc: 0.478
Validation loss decreased (-0.453109 --> -0.478110).  Saving model ...
Epoch: 16 cost time: 2.5648396015167236
Epoch: 16, Steps: 8 | Train Loss: 0.622 Vali Loss: 1.440 Vali Acc: 0.484 Test Loss: 1.440 Test Acc: 0.484
Validation loss decreased (-0.478110 --> -0.484361).  Saving model ...
Epoch: 17 cost time: 3.002934455871582
Epoch: 17, Steps: 8 | Train Loss: 0.507 Vali Loss: 1.396 Vali Acc: 0.497 Test Loss: 1.396 Test Acc: 0.497
Validation loss decreased (-0.484361 --> -0.496861).  Saving model ...
Epoch: 18 cost time: 2.618798017501831
Epoch: 18, Steps: 8 | Train Loss: 0.428 Vali Loss: 1.309 Vali Acc: 0.559 Test Loss: 1.309 Test Acc: 0.559
Validation loss decreased (-0.496861 --> -0.559362).  Saving model ...
Epoch: 19 cost time: 2.9647140502929688
Epoch: 19, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.344 Vali Acc: 0.512 Test Loss: 1.344 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.797971487045288
Epoch: 20, Steps: 8 | Train Loss: 0.349 Vali Loss: 1.240 Vali Acc: 0.562 Test Loss: 1.240 Test Acc: 0.562
Validation loss decreased (-0.559362 --> -0.562488).  Saving model ...
Epoch: 21 cost time: 2.758866548538208
Epoch: 21, Steps: 8 | Train Loss: 0.282 Vali Loss: 1.283 Vali Acc: 0.534 Test Loss: 1.283 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8989007472991943
Epoch: 22, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.324 Vali Acc: 0.528 Test Loss: 1.324 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.1939148902893066
Epoch: 23, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.334 Vali Acc: 0.519 Test Loss: 1.334 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.8060619831085205
Epoch: 24, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.392 Vali Acc: 0.484 Test Loss: 1.392 Test Acc: 0.484
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.5454893112182617
Epoch: 25, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.437 Vali Acc: 0.491 Test Loss: 1.437 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.409036159515381
Epoch: 26, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.501 Vali Acc: 0.475 Test Loss: 1.501 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.344449043273926
Epoch: 27, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.506 Vali Acc: 0.491 Test Loss: 1.506 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.5164568424224854
Epoch: 28, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.547 Vali Acc: 0.494 Test Loss: 1.547 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.758877754211426
Epoch: 29, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.533 Vali Acc: 0.481 Test Loss: 1.533 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.655562162399292
Epoch: 30, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.510 Vali Acc: 0.494 Test Loss: 1.510 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.5625
model parameter : 148040
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9951930046081543
Epoch: 1, Steps: 8 | Train Loss: 2.104 Vali Loss: 2.089 Vali Acc: 0.141 Test Loss: 2.089 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 3.049091339111328
Epoch: 2, Steps: 8 | Train Loss: 2.134 Vali Loss: 2.065 Vali Acc: 0.147 Test Loss: 2.065 Test Acc: 0.147
Validation loss decreased (-0.140604 --> -0.146854).  Saving model ...
Epoch: 3 cost time: 2.8934154510498047
Epoch: 3, Steps: 8 | Train Loss: 2.026 Vali Loss: 2.046 Vali Acc: 0.216 Test Loss: 2.046 Test Acc: 0.216
Validation loss decreased (-0.146854 --> -0.215605).  Saving model ...
Epoch: 4 cost time: 2.7770886421203613
Epoch: 4, Steps: 8 | Train Loss: 1.918 Vali Loss: 2.021 Vali Acc: 0.188 Test Loss: 2.021 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.734231948852539
Epoch: 5, Steps: 8 | Train Loss: 1.854 Vali Loss: 2.002 Vali Acc: 0.266 Test Loss: 2.002 Test Acc: 0.266
Validation loss decreased (-0.215605 --> -0.265605).  Saving model ...
Epoch: 6 cost time: 2.608243703842163
Epoch: 6, Steps: 8 | Train Loss: 1.695 Vali Loss: 1.979 Vali Acc: 0.300 Test Loss: 1.979 Test Acc: 0.300
Validation loss decreased (-0.265605 --> -0.299980).  Saving model ...
Epoch: 7 cost time: 2.53830623626709
Epoch: 7, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.933 Vali Acc: 0.341 Test Loss: 1.933 Test Acc: 0.341
Validation loss decreased (-0.299980 --> -0.340606).  Saving model ...
Epoch: 8 cost time: 2.59275221824646
Epoch: 8, Steps: 8 | Train Loss: 1.458 Vali Loss: 1.899 Vali Acc: 0.372 Test Loss: 1.899 Test Acc: 0.372
Validation loss decreased (-0.340606 --> -0.371856).  Saving model ...
Epoch: 9 cost time: 2.4458186626434326
Epoch: 9, Steps: 8 | Train Loss: 1.315 Vali Loss: 1.870 Vali Acc: 0.353 Test Loss: 1.870 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.611473560333252
Epoch: 10, Steps: 8 | Train Loss: 1.147 Vali Loss: 1.840 Vali Acc: 0.366 Test Loss: 1.840 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8034040927886963
Epoch: 11, Steps: 8 | Train Loss: 1.040 Vali Loss: 1.808 Vali Acc: 0.362 Test Loss: 1.808 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.663726329803467
Epoch: 12, Steps: 8 | Train Loss: 0.930 Vali Loss: 1.780 Vali Acc: 0.359 Test Loss: 1.780 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7158994674682617
Epoch: 13, Steps: 8 | Train Loss: 0.811 Vali Loss: 1.746 Vali Acc: 0.328 Test Loss: 1.746 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7815184593200684
Epoch: 14, Steps: 8 | Train Loss: 0.780 Vali Loss: 1.734 Vali Acc: 0.287 Test Loss: 1.734 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.728334903717041
Epoch: 15, Steps: 8 | Train Loss: 0.641 Vali Loss: 1.700 Vali Acc: 0.403 Test Loss: 1.700 Test Acc: 0.403
Validation loss decreased (-0.371856 --> -0.403108).  Saving model ...
Epoch: 16 cost time: 2.8432488441467285
Epoch: 16, Steps: 8 | Train Loss: 0.586 Vali Loss: 1.661 Vali Acc: 0.403 Test Loss: 1.661 Test Acc: 0.403
Validation loss decreased (-0.403108 --> -0.403108).  Saving model ...
Epoch: 17 cost time: 3.0445938110351562
Epoch: 17, Steps: 8 | Train Loss: 0.525 Vali Loss: 1.660 Vali Acc: 0.356 Test Loss: 1.660 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.849900007247925
Epoch: 18, Steps: 8 | Train Loss: 0.447 Vali Loss: 1.605 Vali Acc: 0.378 Test Loss: 1.605 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7353384494781494
Epoch: 19, Steps: 8 | Train Loss: 0.401 Vali Loss: 1.655 Vali Acc: 0.300 Test Loss: 1.655 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.722733974456787
Epoch: 20, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.530 Vali Acc: 0.469 Test Loss: 1.530 Test Acc: 0.469
Validation loss decreased (-0.403108 --> -0.468735).  Saving model ...
Epoch: 21 cost time: 2.775895357131958
Epoch: 21, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.547 Vali Acc: 0.416 Test Loss: 1.547 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4576127529144287
Epoch: 22, Steps: 8 | Train Loss: 0.290 Vali Loss: 1.598 Vali Acc: 0.341 Test Loss: 1.598 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5588226318359375
Epoch: 23, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.523 Vali Acc: 0.456 Test Loss: 1.523 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7285308837890625
Epoch: 24, Steps: 8 | Train Loss: 0.259 Vali Loss: 1.456 Vali Acc: 0.481 Test Loss: 1.456 Test Acc: 0.481
Validation loss decreased (-0.468735 --> -0.481235).  Saving model ...
Epoch: 25 cost time: 2.5829055309295654
Epoch: 25, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.596 Vali Acc: 0.419 Test Loss: 1.596 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.7096824645996094
Epoch: 26, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.634 Vali Acc: 0.388 Test Loss: 1.634 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4846739768981934
Epoch: 27, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.598 Vali Acc: 0.450 Test Loss: 1.598 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.462531328201294
Epoch: 28, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.675 Vali Acc: 0.403 Test Loss: 1.675 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.710643768310547
Epoch: 29, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.599 Vali Acc: 0.453 Test Loss: 1.599 Test Acc: 0.453
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.8759827613830566
Epoch: 30, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.537 Vali Acc: 0.494 Test Loss: 1.537 Test Acc: 0.494
Validation loss decreased (-0.481235 --> -0.493735).  Saving model ...
Epoch: 31 cost time: 3.001624822616577
Epoch: 31, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.592 Vali Acc: 0.469 Test Loss: 1.592 Test Acc: 0.469
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.171771764755249
Epoch: 32, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.672 Vali Acc: 0.447 Test Loss: 1.672 Test Acc: 0.447
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.6944947242736816
Epoch: 33, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.758 Vali Acc: 0.422 Test Loss: 1.758 Test Acc: 0.422
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.790308952331543
Epoch: 34, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.632 Vali Acc: 0.469 Test Loss: 1.632 Test Acc: 0.469
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.886758327484131
Epoch: 35, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.598 Vali Acc: 0.503 Test Loss: 1.598 Test Acc: 0.503
Validation loss decreased (-0.493735 --> -0.503109).  Saving model ...
Epoch: 36 cost time: 2.658191204071045
Epoch: 36, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.881 Vali Acc: 0.422 Test Loss: 1.881 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.4908759593963623
Epoch: 37, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.667 Vali Acc: 0.500 Test Loss: 1.667 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.8645012378692627
Epoch: 38, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.620 Vali Acc: 0.509 Test Loss: 1.620 Test Acc: 0.509
Validation loss decreased (-0.503109 --> -0.509359).  Saving model ...
Epoch: 39 cost time: 2.48511004447937
Epoch: 39, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.771 Vali Acc: 0.475 Test Loss: 1.771 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.5988481044769287
Epoch: 40, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.824 Vali Acc: 0.487 Test Loss: 1.824 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.602203369140625
Epoch: 41, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.725 Vali Acc: 0.487 Test Loss: 1.725 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.7784764766693115
Epoch: 42, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.800 Vali Acc: 0.444 Test Loss: 1.800 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.590609312057495
Epoch: 43, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.673 Vali Acc: 0.509 Test Loss: 1.673 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.674321174621582
Epoch: 44, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.735 Vali Acc: 0.503 Test Loss: 1.735 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.634856700897217
Epoch: 45, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.782 Vali Acc: 0.500 Test Loss: 1.782 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.8656392097473145
Epoch: 46, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.815 Vali Acc: 0.503 Test Loss: 1.815 Test Acc: 0.503
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.006624698638916
Epoch: 47, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.845 Vali Acc: 0.500 Test Loss: 1.845 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.644188165664673
Epoch: 48, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.768 Vali Acc: 0.519 Test Loss: 1.768 Test Acc: 0.519
Validation loss decreased (-0.509359 --> -0.518732).  Saving model ...
Epoch: 49 cost time: 2.739175796508789
Epoch: 49, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.808 Vali Acc: 0.481 Test Loss: 1.808 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.750980854034424
Epoch: 50, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.734 Vali Acc: 0.506 Test Loss: 1.734 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.9566516876220703
Epoch: 51, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.955 Vali Acc: 0.475 Test Loss: 1.955 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.9255335330963135
Epoch: 52, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.948 Vali Acc: 0.478 Test Loss: 1.948 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.9678549766540527
Epoch: 53, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.840 Vali Acc: 0.519 Test Loss: 1.840 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 2.5030088424682617
Epoch: 54, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.826 Vali Acc: 0.509 Test Loss: 1.826 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 2.568452835083008
Epoch: 55, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.929 Vali Acc: 0.503 Test Loss: 1.929 Test Acc: 0.503
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.674870729446411
Epoch: 56, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.922 Vali Acc: 0.481 Test Loss: 1.922 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 2.791123867034912
Epoch: 57, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.804 Vali Acc: 0.519 Test Loss: 1.804 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 2.862302541732788
Epoch: 58, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.834 Vali Acc: 0.519 Test Loss: 1.834 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.51875
model parameter : 148040
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.807098150253296
Epoch: 1, Steps: 8 | Train Loss: 2.174 Vali Loss: 2.084 Vali Acc: 0.131 Test Loss: 2.084 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 2.4961514472961426
Epoch: 2, Steps: 8 | Train Loss: 2.117 Vali Loss: 2.060 Vali Acc: 0.138 Test Loss: 2.060 Test Acc: 0.138
Validation loss decreased (-0.131229 --> -0.137479).  Saving model ...
Epoch: 3 cost time: 2.749446392059326
Epoch: 3, Steps: 8 | Train Loss: 2.044 Vali Loss: 2.036 Vali Acc: 0.194 Test Loss: 2.036 Test Acc: 0.194
Validation loss decreased (-0.137479 --> -0.193730).  Saving model ...
Epoch: 4 cost time: 2.7316842079162598
Epoch: 4, Steps: 8 | Train Loss: 1.946 Vali Loss: 2.012 Vali Acc: 0.216 Test Loss: 2.012 Test Acc: 0.216
Validation loss decreased (-0.193730 --> -0.215605).  Saving model ...
Epoch: 5 cost time: 2.6633896827697754
Epoch: 5, Steps: 8 | Train Loss: 1.889 Vali Loss: 1.984 Vali Acc: 0.234 Test Loss: 1.984 Test Acc: 0.234
Validation loss decreased (-0.215605 --> -0.234355).  Saving model ...
Epoch: 6 cost time: 2.5398240089416504
Epoch: 6, Steps: 8 | Train Loss: 1.723 Vali Loss: 1.955 Vali Acc: 0.278 Test Loss: 1.955 Test Acc: 0.278
Validation loss decreased (-0.234355 --> -0.278105).  Saving model ...
Epoch: 7 cost time: 2.586557149887085
Epoch: 7, Steps: 8 | Train Loss: 1.617 Vali Loss: 1.921 Vali Acc: 0.319 Test Loss: 1.921 Test Acc: 0.319
Validation loss decreased (-0.278105 --> -0.318731).  Saving model ...
Epoch: 8 cost time: 2.4526824951171875
Epoch: 8, Steps: 8 | Train Loss: 1.516 Vali Loss: 1.894 Vali Acc: 0.303 Test Loss: 1.894 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.431135654449463
Epoch: 9, Steps: 8 | Train Loss: 1.398 Vali Loss: 1.863 Vali Acc: 0.350 Test Loss: 1.863 Test Acc: 0.350
Validation loss decreased (-0.318731 --> -0.349981).  Saving model ...
Epoch: 10 cost time: 2.515981912612915
Epoch: 10, Steps: 8 | Train Loss: 1.240 Vali Loss: 1.828 Vali Acc: 0.344 Test Loss: 1.828 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.434804916381836
Epoch: 11, Steps: 8 | Train Loss: 1.124 Vali Loss: 1.799 Vali Acc: 0.322 Test Loss: 1.799 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.573909282684326
Epoch: 12, Steps: 8 | Train Loss: 0.989 Vali Loss: 1.781 Vali Acc: 0.362 Test Loss: 1.781 Test Acc: 0.362
Validation loss decreased (-0.349981 --> -0.362482).  Saving model ...
Epoch: 13 cost time: 2.41158390045166
Epoch: 13, Steps: 8 | Train Loss: 0.858 Vali Loss: 1.755 Vali Acc: 0.319 Test Loss: 1.755 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.471686363220215
Epoch: 14, Steps: 8 | Train Loss: 0.826 Vali Loss: 1.730 Vali Acc: 0.306 Test Loss: 1.730 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6329572200775146
Epoch: 15, Steps: 8 | Train Loss: 0.743 Vali Loss: 1.687 Vali Acc: 0.375 Test Loss: 1.687 Test Acc: 0.375
Validation loss decreased (-0.362482 --> -0.374983).  Saving model ...
Epoch: 16 cost time: 2.713721990585327
Epoch: 16, Steps: 8 | Train Loss: 0.672 Vali Loss: 1.666 Vali Acc: 0.400 Test Loss: 1.666 Test Acc: 0.400
Validation loss decreased (-0.374983 --> -0.399983).  Saving model ...
Epoch: 17 cost time: 2.7428109645843506
Epoch: 17, Steps: 8 | Train Loss: 0.593 Vali Loss: 1.682 Vali Acc: 0.316 Test Loss: 1.682 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7044153213500977
Epoch: 18, Steps: 8 | Train Loss: 0.523 Vali Loss: 1.636 Vali Acc: 0.341 Test Loss: 1.636 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.444101572036743
Epoch: 19, Steps: 8 | Train Loss: 0.459 Vali Loss: 1.611 Vali Acc: 0.353 Test Loss: 1.611 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.368788480758667
Epoch: 20, Steps: 8 | Train Loss: 0.441 Vali Loss: 1.549 Vali Acc: 0.453 Test Loss: 1.549 Test Acc: 0.453
Validation loss decreased (-0.399983 --> -0.453110).  Saving model ...
Epoch: 21 cost time: 2.80698823928833
Epoch: 21, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.533 Vali Acc: 0.466 Test Loss: 1.533 Test Acc: 0.466
Validation loss decreased (-0.453110 --> -0.465610).  Saving model ...
Epoch: 22 cost time: 2.646165370941162
Epoch: 22, Steps: 8 | Train Loss: 0.336 Vali Loss: 1.567 Vali Acc: 0.372 Test Loss: 1.567 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5755763053894043
Epoch: 23, Steps: 8 | Train Loss: 0.340 Vali Loss: 1.538 Vali Acc: 0.431 Test Loss: 1.538 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3673477172851562
Epoch: 24, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.472 Vali Acc: 0.497 Test Loss: 1.472 Test Acc: 0.497
Validation loss decreased (-0.465610 --> -0.496860).  Saving model ...
Epoch: 25 cost time: 2.349327564239502
Epoch: 25, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.522 Vali Acc: 0.450 Test Loss: 1.522 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.447575807571411
Epoch: 26, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.578 Vali Acc: 0.419 Test Loss: 1.578 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4476916790008545
Epoch: 27, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.527 Vali Acc: 0.463 Test Loss: 1.527 Test Acc: 0.463
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.49257493019104
Epoch: 28, Steps: 8 | Train Loss: 0.238 Vali Loss: 1.595 Vali Acc: 0.453 Test Loss: 1.595 Test Acc: 0.453
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.6705057621002197
Epoch: 29, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.628 Vali Acc: 0.453 Test Loss: 1.628 Test Acc: 0.453
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.3668835163116455
Epoch: 30, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.663 Vali Acc: 0.422 Test Loss: 1.663 Test Acc: 0.422
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.710967779159546
Epoch: 31, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.618 Vali Acc: 0.434 Test Loss: 1.618 Test Acc: 0.434
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.6615543365478516
Epoch: 32, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.658 Vali Acc: 0.434 Test Loss: 1.658 Test Acc: 0.434
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.6610779762268066
Epoch: 33, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.842 Vali Acc: 0.406 Test Loss: 1.842 Test Acc: 0.406
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.6551802158355713
Epoch: 34, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.754 Vali Acc: 0.425 Test Loss: 1.754 Test Acc: 0.425
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.496875
model parameter : 148040
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
fourier enhanced block used!
modes=32, index=[0, 2, 6, 8, 13, 14, 22, 23, 28, 30, 34, 35, 42, 64, 65, 66, 69, 73, 79, 80, 81, 87, 88, 97, 98, 103, 112, 121, 125, 130, 132, 150]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 11, 12, 13, 14, 15, 17, 20, 24, 28, 30, 31, 32, 36, 37, 38, 41, 47, 48, 49, 50, 61, 65, 67, 70, 73, 74, 76]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 5, 6, 9, 11, 23, 25, 27, 28, 29, 35, 36, 38, 40, 41, 42, 44, 45, 51, 54, 56, 59, 60, 65, 66, 67, 69, 70, 71, 72, 75]
modes_kv=32, index_kv=[2, 3, 17, 20, 21, 24, 26, 27, 30, 34, 37, 45, 51, 54, 64, 68, 82, 85, 93, 99, 100, 106, 118, 120, 131, 132, 133, 136, 138, 147, 152, 154]
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8806066513061523
Epoch: 1, Steps: 8 | Train Loss: 2.169 Vali Loss: 2.152 Vali Acc: 0.150 Test Loss: 2.152 Test Acc: 0.150
Validation loss decreased (inf --> -0.149978).  Saving model ...
Epoch: 2 cost time: 3.0424556732177734
Epoch: 2, Steps: 8 | Train Loss: 2.174 Vali Loss: 2.141 Vali Acc: 0.134 Test Loss: 2.141 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.750880479812622
Epoch: 3, Steps: 8 | Train Loss: 2.086 Vali Loss: 2.130 Vali Acc: 0.131 Test Loss: 2.130 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.911874771118164
Epoch: 4, Steps: 8 | Train Loss: 2.015 Vali Loss: 2.109 Vali Acc: 0.131 Test Loss: 2.109 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8022680282592773
Epoch: 5, Steps: 8 | Train Loss: 1.849 Vali Loss: 2.104 Vali Acc: 0.128 Test Loss: 2.104 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.81046724319458
Epoch: 6, Steps: 8 | Train Loss: 1.777 Vali Loss: 2.084 Vali Acc: 0.134 Test Loss: 2.084 Test Acc: 0.134
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4881088733673096
Epoch: 7, Steps: 8 | Train Loss: 1.686 Vali Loss: 2.062 Vali Acc: 0.134 Test Loss: 2.062 Test Acc: 0.134
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6488986015319824
Epoch: 8, Steps: 8 | Train Loss: 1.571 Vali Loss: 2.047 Vali Acc: 0.125 Test Loss: 2.047 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.504228353500366
Epoch: 9, Steps: 8 | Train Loss: 1.484 Vali Loss: 1.996 Vali Acc: 0.138 Test Loss: 1.996 Test Acc: 0.138
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.7066097259521484
Epoch: 10, Steps: 8 | Train Loss: 1.371 Vali Loss: 1.986 Vali Acc: 0.141 Test Loss: 1.986 Test Acc: 0.141
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7559595108032227
Epoch: 11, Steps: 8 | Train Loss: 1.269 Vali Loss: 1.972 Vali Acc: 0.147 Test Loss: 1.972 Test Acc: 0.147
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_FEDformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.15
model parameter : 148040
model size : 1.81MB
