Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 34.124452114105225
Epoch: 1, Steps: 13 | Train Loss: 1.044 Vali Loss: 1.702 Vali Acc: 0.522 Test Loss: 1.702 Test Acc: 0.522
Validation loss decreased (inf --> -0.522205).  Saving model ...
Epoch: 2 cost time: 36.38048815727234
Epoch: 2, Steps: 13 | Train Loss: 0.943 Vali Loss: 3.125 Vali Acc: 0.494 Test Loss: 3.125 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 30.5310959815979
Epoch: 3, Steps: 13 | Train Loss: 1.160 Vali Loss: 3.232 Vali Acc: 0.511 Test Loss: 3.232 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 29.959121704101562
Epoch: 4, Steps: 13 | Train Loss: 1.013 Vali Loss: 6.173 Vali Acc: 0.489 Test Loss: 6.173 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 30.482176303863525
Epoch: 5, Steps: 13 | Train Loss: 2.562 Vali Loss: 5.303 Vali Acc: 0.478 Test Loss: 5.303 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 33.60458707809448
Epoch: 6, Steps: 13 | Train Loss: 0.929 Vali Loss: 6.577 Vali Acc: 0.489 Test Loss: 6.577 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 28.117313861846924
Epoch: 7, Steps: 13 | Train Loss: 0.857 Vali Loss: 6.824 Vali Acc: 0.522 Test Loss: 6.824 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 29.12347984313965
Epoch: 8, Steps: 13 | Train Loss: 0.845 Vali Loss: 7.863 Vali Acc: 0.411 Test Loss: 7.863 Test Acc: 0.411
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 30.2944495677948
Epoch: 9, Steps: 13 | Train Loss: 0.304 Vali Loss: 9.959 Vali Acc: 0.483 Test Loss: 9.959 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 29.467835426330566
Epoch: 10, Steps: 13 | Train Loss: 1.006 Vali Loss: 10.852 Vali Acc: 0.528 Test Loss: 10.852 Test Acc: 0.528
Validation loss decreased (-0.522205 --> -0.527669).  Saving model ...
Epoch: 11 cost time: 34.428332805633545
Epoch: 11, Steps: 13 | Train Loss: 1.267 Vali Loss: 12.637 Vali Acc: 0.500 Test Loss: 12.637 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 29.52172350883484
Epoch: 12, Steps: 13 | Train Loss: 2.160 Vali Loss: 16.157 Vali Acc: 0.483 Test Loss: 16.157 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 36.48845434188843
Epoch: 13, Steps: 13 | Train Loss: 0.764 Vali Loss: 14.054 Vali Acc: 0.494 Test Loss: 14.054 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 37.96674585342407
Epoch: 14, Steps: 13 | Train Loss: 1.377 Vali Loss: 16.498 Vali Acc: 0.506 Test Loss: 16.498 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 36.07841897010803
Epoch: 15, Steps: 13 | Train Loss: 1.309 Vali Loss: 17.409 Vali Acc: 0.483 Test Loss: 17.409 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 35.29303550720215
Epoch: 16, Steps: 13 | Train Loss: 0.383 Vali Loss: 19.394 Vali Acc: 0.478 Test Loss: 19.394 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 34.746421098709106
Epoch: 17, Steps: 13 | Train Loss: 0.453 Vali Loss: 22.717 Vali Acc: 0.472 Test Loss: 22.717 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 37.79570770263672
Epoch: 18, Steps: 13 | Train Loss: 0.877 Vali Loss: 22.409 Vali Acc: 0.483 Test Loss: 22.409 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 38.159531593322754
Epoch: 19, Steps: 13 | Train Loss: 0.198 Vali Loss: 28.222 Vali Acc: 0.472 Test Loss: 28.222 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 38.16258692741394
Epoch: 20, Steps: 13 | Train Loss: 0.597 Vali Loss: 22.864 Vali Acc: 0.528 Test Loss: 22.864 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 17992706
model size : 88.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 29.793476104736328
Epoch: 1, Steps: 13 | Train Loss: 1.051 Vali Loss: 1.264 Vali Acc: 0.550 Test Loss: 1.264 Test Acc: 0.550
Validation loss decreased (inf --> -0.549987).  Saving model ...
Epoch: 2 cost time: 28.116410493850708
Epoch: 2, Steps: 13 | Train Loss: 0.784 Vali Loss: 2.481 Vali Acc: 0.522 Test Loss: 2.481 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.56017827987671
Epoch: 3, Steps: 13 | Train Loss: 0.975 Vali Loss: 2.963 Vali Acc: 0.522 Test Loss: 2.963 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 29.478556871414185
Epoch: 4, Steps: 13 | Train Loss: 0.510 Vali Loss: 4.124 Vali Acc: 0.506 Test Loss: 4.124 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 29.46569013595581
Epoch: 5, Steps: 13 | Train Loss: 0.713 Vali Loss: 5.295 Vali Acc: 0.511 Test Loss: 5.295 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 28.752033233642578
Epoch: 6, Steps: 13 | Train Loss: 0.930 Vali Loss: 5.373 Vali Acc: 0.467 Test Loss: 5.373 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 29.60940456390381
Epoch: 7, Steps: 13 | Train Loss: 0.616 Vali Loss: 7.698 Vali Acc: 0.478 Test Loss: 7.698 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 30.91234254837036
Epoch: 8, Steps: 13 | Train Loss: 0.845 Vali Loss: 10.636 Vali Acc: 0.517 Test Loss: 10.636 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 27.63418173789978
Epoch: 9, Steps: 13 | Train Loss: 0.898 Vali Loss: 9.204 Vali Acc: 0.456 Test Loss: 9.204 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 30.44829225540161
Epoch: 10, Steps: 13 | Train Loss: 0.436 Vali Loss: 9.592 Vali Acc: 0.478 Test Loss: 9.592 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 30.976001977920532
Epoch: 11, Steps: 13 | Train Loss: 0.469 Vali Loss: 10.274 Vali Acc: 0.483 Test Loss: 10.274 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 17992706
model size : 88.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 21.303770542144775
Epoch: 1, Steps: 13 | Train Loss: 1.188 Vali Loss: 1.972 Vali Acc: 0.511 Test Loss: 1.972 Test Acc: 0.511
Validation loss decreased (inf --> -0.511091).  Saving model ...
Epoch: 2 cost time: 24.614787101745605
Epoch: 2, Steps: 13 | Train Loss: 1.138 Vali Loss: 1.916 Vali Acc: 0.539 Test Loss: 1.916 Test Acc: 0.539
Validation loss decreased (-0.511091 --> -0.538870).  Saving model ...
Epoch: 3 cost time: 22.395095586776733
Epoch: 3, Steps: 13 | Train Loss: 0.759 Vali Loss: 2.410 Vali Acc: 0.528 Test Loss: 2.410 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.562187671661377
Epoch: 4, Steps: 13 | Train Loss: 1.165 Vali Loss: 4.059 Vali Acc: 0.478 Test Loss: 4.059 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 26.160481452941895
Epoch: 5, Steps: 13 | Train Loss: 1.070 Vali Loss: 4.642 Vali Acc: 0.528 Test Loss: 4.642 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 25.76451063156128
Epoch: 6, Steps: 13 | Train Loss: 1.488 Vali Loss: 5.243 Vali Acc: 0.500 Test Loss: 5.243 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 23.801379680633545
Epoch: 7, Steps: 13 | Train Loss: 0.965 Vali Loss: 6.315 Vali Acc: 0.517 Test Loss: 6.315 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 26.77808713912964
Epoch: 8, Steps: 13 | Train Loss: 0.419 Vali Loss: 7.863 Vali Acc: 0.522 Test Loss: 7.863 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 27.069262266159058
Epoch: 9, Steps: 13 | Train Loss: 0.434 Vali Loss: 9.023 Vali Acc: 0.483 Test Loss: 9.023 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 25.969053030014038
Epoch: 10, Steps: 13 | Train Loss: 0.827 Vali Loss: 12.795 Vali Acc: 0.489 Test Loss: 12.795 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 24.472511291503906
Epoch: 11, Steps: 13 | Train Loss: 1.027 Vali Loss: 10.951 Vali Acc: 0.489 Test Loss: 10.951 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 26.40416932106018
Epoch: 12, Steps: 13 | Train Loss: 0.862 Vali Loss: 14.033 Vali Acc: 0.461 Test Loss: 14.033 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 17992706
model size : 88.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 23.239623546600342
Epoch: 1, Steps: 13 | Train Loss: 1.127 Vali Loss: 1.742 Vali Acc: 0.522 Test Loss: 1.742 Test Acc: 0.522
Validation loss decreased (inf --> -0.522205).  Saving model ...
Epoch: 2 cost time: 24.380616664886475
Epoch: 2, Steps: 13 | Train Loss: 1.028 Vali Loss: 2.462 Vali Acc: 0.511 Test Loss: 2.462 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.546205282211304
Epoch: 3, Steps: 13 | Train Loss: 0.778 Vali Loss: 2.834 Vali Acc: 0.539 Test Loss: 2.834 Test Acc: 0.539
Validation loss decreased (-0.522205 --> -0.538861).  Saving model ...
Epoch: 4 cost time: 21.618797779083252
Epoch: 4, Steps: 13 | Train Loss: 0.822 Vali Loss: 6.184 Vali Acc: 0.533 Test Loss: 6.184 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.21521496772766
Epoch: 5, Steps: 13 | Train Loss: 1.308 Vali Loss: 5.915 Vali Acc: 0.472 Test Loss: 5.915 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.115070581436157
Epoch: 6, Steps: 13 | Train Loss: 1.179 Vali Loss: 5.616 Vali Acc: 0.494 Test Loss: 5.616 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.59664750099182
Epoch: 7, Steps: 13 | Train Loss: 1.208 Vali Loss: 7.432 Vali Acc: 0.511 Test Loss: 7.432 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 20.908262014389038
Epoch: 8, Steps: 13 | Train Loss: 0.917 Vali Loss: 8.025 Vali Acc: 0.500 Test Loss: 8.025 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.400646686553955
Epoch: 9, Steps: 13 | Train Loss: 1.571 Vali Loss: 12.364 Vali Acc: 0.517 Test Loss: 12.364 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 22.821101665496826
Epoch: 10, Steps: 13 | Train Loss: 1.015 Vali Loss: 9.448 Vali Acc: 0.461 Test Loss: 9.448 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 23.764704704284668
Epoch: 11, Steps: 13 | Train Loss: 2.091 Vali Loss: 14.217 Vali Acc: 0.472 Test Loss: 14.217 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 24.430529594421387
Epoch: 12, Steps: 13 | Train Loss: 1.642 Vali Loss: 15.955 Vali Acc: 0.500 Test Loss: 15.955 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 23.775697946548462
Epoch: 13, Steps: 13 | Train Loss: 0.830 Vali Loss: 17.205 Vali Acc: 0.439 Test Loss: 17.205 Test Acc: 0.439
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 17992706
model size : 88.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 20.479490041732788
Epoch: 1, Steps: 13 | Train Loss: 0.960 Vali Loss: 1.645 Vali Acc: 0.506 Test Loss: 1.645 Test Acc: 0.506
Validation loss decreased (inf --> -0.505539).  Saving model ...
Epoch: 2 cost time: 20.30687117576599
Epoch: 2, Steps: 13 | Train Loss: 0.848 Vali Loss: 2.264 Vali Acc: 0.511 Test Loss: 2.264 Test Acc: 0.511
Validation loss decreased (-0.505539 --> -0.511088).  Saving model ...
Epoch: 3 cost time: 20.124586820602417
Epoch: 3, Steps: 13 | Train Loss: 0.737 Vali Loss: 3.527 Vali Acc: 0.494 Test Loss: 3.527 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.720234870910645
Epoch: 4, Steps: 13 | Train Loss: 1.110 Vali Loss: 3.944 Vali Acc: 0.500 Test Loss: 3.944 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.138090133666992
Epoch: 5, Steps: 13 | Train Loss: 0.542 Vali Loss: 5.129 Vali Acc: 0.556 Test Loss: 5.129 Test Acc: 0.556
Validation loss decreased (-0.511088 --> -0.555504).  Saving model ...
Epoch: 6 cost time: 17.26455044746399
Epoch: 6, Steps: 13 | Train Loss: 1.256 Vali Loss: 5.523 Vali Acc: 0.511 Test Loss: 5.523 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.859180450439453
Epoch: 7, Steps: 13 | Train Loss: 0.772 Vali Loss: 9.271 Vali Acc: 0.489 Test Loss: 9.271 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.954283952713013
Epoch: 8, Steps: 13 | Train Loss: 1.101 Vali Loss: 7.990 Vali Acc: 0.472 Test Loss: 7.990 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 17.839810371398926
Epoch: 9, Steps: 13 | Train Loss: 0.987 Vali Loss: 8.670 Vali Acc: 0.478 Test Loss: 8.670 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 21.606371641159058
Epoch: 10, Steps: 13 | Train Loss: 0.902 Vali Loss: 12.606 Vali Acc: 0.489 Test Loss: 12.606 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 18.438174962997437
Epoch: 11, Steps: 13 | Train Loss: 1.688 Vali Loss: 11.696 Vali Acc: 0.528 Test Loss: 11.696 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 17.839563608169556
Epoch: 12, Steps: 13 | Train Loss: 0.314 Vali Loss: 13.653 Vali Acc: 0.494 Test Loss: 13.653 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 20.296308994293213
Epoch: 13, Steps: 13 | Train Loss: 0.430 Vali Loss: 14.279 Vali Acc: 0.506 Test Loss: 14.279 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 19.865135669708252
Epoch: 14, Steps: 13 | Train Loss: 0.324 Vali Loss: 12.494 Vali Acc: 0.517 Test Loss: 12.494 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 19.716310739517212
Epoch: 15, Steps: 13 | Train Loss: 0.305 Vali Loss: 14.603 Vali Acc: 0.528 Test Loss: 14.603 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 17992706
model size : 88.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 19.59134554862976
Epoch: 1, Steps: 13 | Train Loss: 1.089 Vali Loss: 1.328 Vali Acc: 0.489 Test Loss: 1.328 Test Acc: 0.489
Validation loss decreased (inf --> -0.488876).  Saving model ...
Epoch: 2 cost time: 17.689768075942993
Epoch: 2, Steps: 13 | Train Loss: 1.126 Vali Loss: 1.985 Vali Acc: 0.522 Test Loss: 1.985 Test Acc: 0.522
Validation loss decreased (-0.488876 --> -0.522202).  Saving model ...
Epoch: 3 cost time: 15.58006238937378
Epoch: 3, Steps: 13 | Train Loss: 1.641 Vali Loss: 6.192 Vali Acc: 0.500 Test Loss: 6.192 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.90286636352539
Epoch: 4, Steps: 13 | Train Loss: 1.922 Vali Loss: 4.454 Vali Acc: 0.517 Test Loss: 4.454 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.412898063659668
Epoch: 5, Steps: 13 | Train Loss: 0.883 Vali Loss: 4.474 Vali Acc: 0.472 Test Loss: 4.474 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 19.023189306259155
Epoch: 6, Steps: 13 | Train Loss: 0.467 Vali Loss: 5.823 Vali Acc: 0.461 Test Loss: 5.823 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.09547472000122
Epoch: 7, Steps: 13 | Train Loss: 0.902 Vali Loss: 6.421 Vali Acc: 0.433 Test Loss: 6.421 Test Acc: 0.433
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 17.52714967727661
Epoch: 8, Steps: 13 | Train Loss: 0.560 Vali Loss: 7.580 Vali Acc: 0.500 Test Loss: 7.580 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 17.04912304878235
Epoch: 9, Steps: 13 | Train Loss: 0.690 Vali Loss: 9.243 Vali Acc: 0.522 Test Loss: 9.243 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 16.385928869247437
Epoch: 10, Steps: 13 | Train Loss: 0.635 Vali Loss: 8.878 Vali Acc: 0.456 Test Loss: 8.878 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 17.03202509880066
Epoch: 11, Steps: 13 | Train Loss: 0.802 Vali Loss: 10.123 Vali Acc: 0.478 Test Loss: 10.123 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 18.842203855514526
Epoch: 12, Steps: 13 | Train Loss: 0.541 Vali Loss: 11.606 Vali Acc: 0.478 Test Loss: 11.606 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 17992706
model size : 88.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 13.145132780075073
Epoch: 1, Steps: 13 | Train Loss: 0.914 Vali Loss: 1.489 Vali Acc: 0.456 Test Loss: 1.489 Test Acc: 0.456
Validation loss decreased (inf --> -0.455541).  Saving model ...
Epoch: 2 cost time: 16.55500316619873
Epoch: 2, Steps: 13 | Train Loss: 0.868 Vali Loss: 2.517 Vali Acc: 0.478 Test Loss: 2.517 Test Acc: 0.478
Validation loss decreased (-0.455541 --> -0.477753).  Saving model ...
Epoch: 3 cost time: 16.453927278518677
Epoch: 3, Steps: 13 | Train Loss: 1.081 Vali Loss: 4.075 Vali Acc: 0.500 Test Loss: 4.075 Test Acc: 0.500
Validation loss decreased (-0.477753 --> -0.499959).  Saving model ...
Epoch: 4 cost time: 17.525657415390015
Epoch: 4, Steps: 13 | Train Loss: 0.864 Vali Loss: 3.644 Vali Acc: 0.467 Test Loss: 3.644 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.546483993530273
Epoch: 5, Steps: 13 | Train Loss: 0.643 Vali Loss: 3.270 Vali Acc: 0.489 Test Loss: 3.270 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.141632556915283
Epoch: 6, Steps: 13 | Train Loss: 0.675 Vali Loss: 4.056 Vali Acc: 0.472 Test Loss: 4.056 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.1552312374115
Epoch: 7, Steps: 13 | Train Loss: 0.890 Vali Loss: 5.411 Vali Acc: 0.433 Test Loss: 5.411 Test Acc: 0.433
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 14.788404703140259
Epoch: 8, Steps: 13 | Train Loss: 0.720 Vali Loss: 5.897 Vali Acc: 0.478 Test Loss: 5.897 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 17.164605379104614
Epoch: 9, Steps: 13 | Train Loss: 0.931 Vali Loss: 5.606 Vali Acc: 0.506 Test Loss: 5.606 Test Acc: 0.506
Validation loss decreased (-0.499959 --> -0.505499).  Saving model ...
Epoch: 10 cost time: 15.889370203018188
Epoch: 10, Steps: 13 | Train Loss: 0.894 Vali Loss: 7.623 Vali Acc: 0.494 Test Loss: 7.623 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.438838005065918
Epoch: 11, Steps: 13 | Train Loss: 1.979 Vali Loss: 8.701 Vali Acc: 0.444 Test Loss: 8.701 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.754147291183472
Epoch: 12, Steps: 13 | Train Loss: 1.528 Vali Loss: 13.210 Vali Acc: 0.467 Test Loss: 13.210 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.674745798110962
Epoch: 13, Steps: 13 | Train Loss: 1.482 Vali Loss: 11.028 Vali Acc: 0.456 Test Loss: 11.028 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 17.205701112747192
Epoch: 14, Steps: 13 | Train Loss: 0.946 Vali Loss: 11.132 Vali Acc: 0.483 Test Loss: 11.132 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 15.48749589920044
Epoch: 15, Steps: 13 | Train Loss: 0.607 Vali Loss: 13.596 Vali Acc: 0.489 Test Loss: 13.596 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 17.113213539123535
Epoch: 16, Steps: 13 | Train Loss: 1.223 Vali Loss: 13.749 Vali Acc: 0.500 Test Loss: 13.749 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 18.260677099227905
Epoch: 17, Steps: 13 | Train Loss: 1.005 Vali Loss: 19.654 Vali Acc: 0.500 Test Loss: 19.654 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 17.791531085968018
Epoch: 18, Steps: 13 | Train Loss: 3.166 Vali Loss: 20.569 Vali Acc: 0.522 Test Loss: 20.569 Test Acc: 0.522
Validation loss decreased (-0.505499 --> -0.522017).  Saving model ...
Epoch: 19 cost time: 17.555480003356934
Epoch: 19, Steps: 13 | Train Loss: 2.042 Vali Loss: 17.398 Vali Acc: 0.483 Test Loss: 17.398 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 17.548794269561768
Epoch: 20, Steps: 13 | Train Loss: 0.515 Vali Loss: 17.612 Vali Acc: 0.467 Test Loss: 17.612 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 11.890998363494873
Epoch: 21, Steps: 13 | Train Loss: 0.962 Vali Loss: 18.469 Vali Acc: 0.467 Test Loss: 18.469 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 14.393879890441895
Epoch: 22, Steps: 13 | Train Loss: 0.973 Vali Loss: 21.246 Vali Acc: 0.489 Test Loss: 21.246 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 15.947747468948364
Epoch: 23, Steps: 13 | Train Loss: 0.785 Vali Loss: 22.446 Vali Acc: 0.461 Test Loss: 22.446 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 15.632323026657104
Epoch: 24, Steps: 13 | Train Loss: 1.169 Vali Loss: 21.929 Vali Acc: 0.456 Test Loss: 21.929 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 14.226900577545166
Epoch: 25, Steps: 13 | Train Loss: 0.930 Vali Loss: 22.523 Vali Acc: 0.461 Test Loss: 22.523 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 16.18654203414917
Epoch: 26, Steps: 13 | Train Loss: 0.379 Vali Loss: 22.700 Vali Acc: 0.467 Test Loss: 22.700 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 18.16236114501953
Epoch: 27, Steps: 13 | Train Loss: 0.647 Vali Loss: 25.495 Vali Acc: 0.506 Test Loss: 25.495 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 16.865397214889526
Epoch: 28, Steps: 13 | Train Loss: 0.867 Vali Loss: 28.238 Vali Acc: 0.478 Test Loss: 28.238 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 17992706
model size : 88.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 17.500548362731934
Epoch: 1, Steps: 13 | Train Loss: 1.227 Vali Loss: 0.997 Vali Acc: 0.528 Test Loss: 0.997 Test Acc: 0.528
Validation loss decreased (inf --> -0.527768).  Saving model ...
Epoch: 2 cost time: 15.239635229110718
Epoch: 2, Steps: 13 | Train Loss: 1.011 Vali Loss: 1.917 Vali Acc: 0.539 Test Loss: 1.917 Test Acc: 0.539
Validation loss decreased (-0.527768 --> -0.538870).  Saving model ...
Epoch: 3 cost time: 16.92362356185913
Epoch: 3, Steps: 13 | Train Loss: 1.091 Vali Loss: 3.880 Vali Acc: 0.489 Test Loss: 3.880 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.62114143371582
Epoch: 4, Steps: 13 | Train Loss: 0.754 Vali Loss: 3.261 Vali Acc: 0.489 Test Loss: 3.261 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.394742488861084
Epoch: 5, Steps: 13 | Train Loss: 0.660 Vali Loss: 5.543 Vali Acc: 0.489 Test Loss: 5.543 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.950629472732544
Epoch: 6, Steps: 13 | Train Loss: 1.206 Vali Loss: 5.020 Vali Acc: 0.444 Test Loss: 5.020 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.574592590332031
Epoch: 7, Steps: 13 | Train Loss: 0.790 Vali Loss: 6.207 Vali Acc: 0.489 Test Loss: 6.207 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.62984013557434
Epoch: 8, Steps: 13 | Train Loss: 1.063 Vali Loss: 7.605 Vali Acc: 0.472 Test Loss: 7.605 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 14.702623128890991
Epoch: 9, Steps: 13 | Train Loss: 0.664 Vali Loss: 8.654 Vali Acc: 0.489 Test Loss: 8.654 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 14.814229011535645
Epoch: 10, Steps: 13 | Train Loss: 0.927 Vali Loss: 8.134 Vali Acc: 0.511 Test Loss: 8.134 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.081106424331665
Epoch: 11, Steps: 13 | Train Loss: 1.419 Vali Loss: 9.344 Vali Acc: 0.500 Test Loss: 9.344 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 17.43758225440979
Epoch: 12, Steps: 13 | Train Loss: 1.067 Vali Loss: 10.022 Vali Acc: 0.461 Test Loss: 10.022 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 17992706
model size : 88.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 16.70163059234619
Epoch: 1, Steps: 13 | Train Loss: 1.125 Vali Loss: 0.743 Vali Acc: 0.544 Test Loss: 0.743 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 14.311997413635254
Epoch: 2, Steps: 13 | Train Loss: 1.088 Vali Loss: 1.201 Vali Acc: 0.533 Test Loss: 1.201 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.114192247390747
Epoch: 3, Steps: 13 | Train Loss: 1.549 Vali Loss: 2.824 Vali Acc: 0.517 Test Loss: 2.824 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.022632837295532
Epoch: 4, Steps: 13 | Train Loss: 1.648 Vali Loss: 2.165 Vali Acc: 0.522 Test Loss: 2.165 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.518484592437744
Epoch: 5, Steps: 13 | Train Loss: 1.672 Vali Loss: 3.029 Vali Acc: 0.539 Test Loss: 3.029 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.74122166633606
Epoch: 6, Steps: 13 | Train Loss: 0.638 Vali Loss: 3.475 Vali Acc: 0.517 Test Loss: 3.475 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.968989372253418
Epoch: 7, Steps: 13 | Train Loss: 1.310 Vali Loss: 4.124 Vali Acc: 0.550 Test Loss: 4.124 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549959).  Saving model ...
Epoch: 8 cost time: 16.077574968338013
Epoch: 8, Steps: 13 | Train Loss: 1.150 Vali Loss: 4.166 Vali Acc: 0.533 Test Loss: 4.166 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.60428214073181
Epoch: 9, Steps: 13 | Train Loss: 0.523 Vali Loss: 5.120 Vali Acc: 0.522 Test Loss: 5.120 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.635081768035889
Epoch: 10, Steps: 13 | Train Loss: 0.680 Vali Loss: 5.664 Vali Acc: 0.511 Test Loss: 5.664 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.258134841918945
Epoch: 11, Steps: 13 | Train Loss: 0.541 Vali Loss: 6.945 Vali Acc: 0.583 Test Loss: 6.945 Test Acc: 0.583
Validation loss decreased (-0.549959 --> -0.583264).  Saving model ...
Epoch: 12 cost time: 15.494568109512329
Epoch: 12, Steps: 13 | Train Loss: 0.709 Vali Loss: 11.104 Vali Acc: 0.544 Test Loss: 11.104 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.249743700027466
Epoch: 13, Steps: 13 | Train Loss: 1.904 Vali Loss: 9.442 Vali Acc: 0.533 Test Loss: 9.442 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.691820621490479
Epoch: 14, Steps: 13 | Train Loss: 1.682 Vali Loss: 10.179 Vali Acc: 0.533 Test Loss: 10.179 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.9632887840271
Epoch: 15, Steps: 13 | Train Loss: 1.881 Vali Loss: 11.563 Vali Acc: 0.528 Test Loss: 11.563 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 16.870134353637695
Epoch: 16, Steps: 13 | Train Loss: 0.487 Vali Loss: 12.703 Vali Acc: 0.511 Test Loss: 12.703 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.846179008483887
Epoch: 17, Steps: 13 | Train Loss: 0.842 Vali Loss: 12.754 Vali Acc: 0.522 Test Loss: 12.754 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 14.166964054107666
Epoch: 18, Steps: 13 | Train Loss: 3.468 Vali Loss: 13.133 Vali Acc: 0.528 Test Loss: 13.133 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 14.613669395446777
Epoch: 19, Steps: 13 | Train Loss: 1.043 Vali Loss: 16.439 Vali Acc: 0.561 Test Loss: 16.439 Test Acc: 0.561
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 17.42496633529663
Epoch: 20, Steps: 13 | Train Loss: 0.285 Vali Loss: 16.831 Vali Acc: 0.561 Test Loss: 16.831 Test Acc: 0.561
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.403513431549072
Epoch: 21, Steps: 13 | Train Loss: 1.183 Vali Loss: 21.804 Vali Acc: 0.511 Test Loss: 21.804 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 17992706
model size : 88.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 17.498151779174805
Epoch: 1, Steps: 13 | Train Loss: 0.829 Vali Loss: 1.631 Vali Acc: 0.517 Test Loss: 1.631 Test Acc: 0.517
Validation loss decreased (inf --> -0.516650).  Saving model ...
Epoch: 2 cost time: 15.59930968284607
Epoch: 2, Steps: 13 | Train Loss: 0.986 Vali Loss: 2.402 Vali Acc: 0.511 Test Loss: 2.402 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.451278686523438
Epoch: 3, Steps: 13 | Train Loss: 0.933 Vali Loss: 1.513 Vali Acc: 0.500 Test Loss: 1.513 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.589213371276855
Epoch: 4, Steps: 13 | Train Loss: 0.784 Vali Loss: 2.570 Vali Acc: 0.494 Test Loss: 2.570 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.279242515563965
Epoch: 5, Steps: 13 | Train Loss: 1.289 Vali Loss: 2.195 Vali Acc: 0.511 Test Loss: 2.195 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.628566026687622
Epoch: 6, Steps: 13 | Train Loss: 1.254 Vali Loss: 5.451 Vali Acc: 0.522 Test Loss: 5.451 Test Acc: 0.522
Validation loss decreased (-0.516650 --> -0.522168).  Saving model ...
Epoch: 7 cost time: 17.023863792419434
Epoch: 7, Steps: 13 | Train Loss: 1.566 Vali Loss: 2.642 Vali Acc: 0.572 Test Loss: 2.642 Test Acc: 0.572
Validation loss decreased (-0.522168 --> -0.572196).  Saving model ...
Epoch: 8 cost time: 17.421483755111694
Epoch: 8, Steps: 13 | Train Loss: 0.706 Vali Loss: 2.944 Vali Acc: 0.467 Test Loss: 2.944 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.19962501525879
Epoch: 9, Steps: 13 | Train Loss: 0.615 Vali Loss: 3.436 Vali Acc: 0.517 Test Loss: 3.436 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.471271514892578
Epoch: 10, Steps: 13 | Train Loss: 0.970 Vali Loss: 4.635 Vali Acc: 0.544 Test Loss: 4.635 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.62621521949768
Epoch: 11, Steps: 13 | Train Loss: 1.705 Vali Loss: 3.689 Vali Acc: 0.550 Test Loss: 3.689 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.60730767250061
Epoch: 12, Steps: 13 | Train Loss: 0.484 Vali Loss: 4.741 Vali Acc: 0.544 Test Loss: 4.741 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 15.8425133228302
Epoch: 13, Steps: 13 | Train Loss: 1.473 Vali Loss: 6.581 Vali Acc: 0.478 Test Loss: 6.581 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.10790729522705
Epoch: 14, Steps: 13 | Train Loss: 1.254 Vali Loss: 5.270 Vali Acc: 0.539 Test Loss: 5.270 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 15.441842079162598
Epoch: 15, Steps: 13 | Train Loss: 1.291 Vali Loss: 6.626 Vali Acc: 0.494 Test Loss: 6.626 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 16.016059637069702
Epoch: 16, Steps: 13 | Train Loss: 1.545 Vali Loss: 5.610 Vali Acc: 0.500 Test Loss: 5.610 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 13.868434429168701
Epoch: 17, Steps: 13 | Train Loss: 1.247 Vali Loss: 7.515 Vali Acc: 0.472 Test Loss: 7.515 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 17992706
model size : 88.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 29.655619382858276
Epoch: 1, Steps: 13 | Train Loss: 0.950 Vali Loss: 1.547 Vali Acc: 0.522 Test Loss: 1.547 Test Acc: 0.522
Validation loss decreased (inf --> -0.522207).  Saving model ...
Epoch: 2 cost time: 28.201446294784546
Epoch: 2, Steps: 13 | Train Loss: 0.652 Vali Loss: 4.307 Vali Acc: 0.506 Test Loss: 4.307 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.178569555282593
Epoch: 3, Steps: 13 | Train Loss: 1.796 Vali Loss: 2.510 Vali Acc: 0.489 Test Loss: 2.510 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.097666025161743
Epoch: 4, Steps: 13 | Train Loss: 0.894 Vali Loss: 3.546 Vali Acc: 0.467 Test Loss: 3.546 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 28.19707179069519
Epoch: 5, Steps: 13 | Train Loss: 0.818 Vali Loss: 4.524 Vali Acc: 0.456 Test Loss: 4.524 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 25.52501392364502
Epoch: 6, Steps: 13 | Train Loss: 0.463 Vali Loss: 5.678 Vali Acc: 0.472 Test Loss: 5.678 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 29.03995132446289
Epoch: 7, Steps: 13 | Train Loss: 0.518 Vali Loss: 7.532 Vali Acc: 0.500 Test Loss: 7.532 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 28.330063819885254
Epoch: 8, Steps: 13 | Train Loss: 1.281 Vali Loss: 8.094 Vali Acc: 0.511 Test Loss: 8.094 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 28.30768060684204
Epoch: 9, Steps: 13 | Train Loss: 0.901 Vali Loss: 13.899 Vali Acc: 0.478 Test Loss: 13.899 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 28.17224359512329
Epoch: 10, Steps: 13 | Train Loss: 1.240 Vali Loss: 14.205 Vali Acc: 0.483 Test Loss: 14.205 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 30.242823362350464
Epoch: 11, Steps: 13 | Train Loss: 0.958 Vali Loss: 12.314 Vali Acc: 0.500 Test Loss: 12.314 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 14846978
model size : 76.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 24.42041802406311
Epoch: 1, Steps: 13 | Train Loss: 0.972 Vali Loss: 1.846 Vali Acc: 0.522 Test Loss: 1.846 Test Acc: 0.522
Validation loss decreased (inf --> -0.522204).  Saving model ...
Epoch: 2 cost time: 25.150815963745117
Epoch: 2, Steps: 13 | Train Loss: 1.071 Vali Loss: 2.085 Vali Acc: 0.522 Test Loss: 2.085 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.990556240081787
Epoch: 3, Steps: 13 | Train Loss: 0.707 Vali Loss: 4.412 Vali Acc: 0.517 Test Loss: 4.412 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 25.09977102279663
Epoch: 4, Steps: 13 | Train Loss: 0.879 Vali Loss: 4.757 Vali Acc: 0.478 Test Loss: 4.757 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.80195665359497
Epoch: 5, Steps: 13 | Train Loss: 1.807 Vali Loss: 6.762 Vali Acc: 0.478 Test Loss: 6.762 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 26.59350275993347
Epoch: 6, Steps: 13 | Train Loss: 1.307 Vali Loss: 6.746 Vali Acc: 0.522 Test Loss: 6.746 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 26.409302711486816
Epoch: 7, Steps: 13 | Train Loss: 0.903 Vali Loss: 8.155 Vali Acc: 0.528 Test Loss: 8.155 Test Acc: 0.528
Validation loss decreased (-0.522204 --> -0.527696).  Saving model ...
Epoch: 8 cost time: 25.369430541992188
Epoch: 8, Steps: 13 | Train Loss: 0.598 Vali Loss: 7.220 Vali Acc: 0.533 Test Loss: 7.220 Test Acc: 0.533
Validation loss decreased (-0.527696 --> -0.533261).  Saving model ...
Epoch: 9 cost time: 26.354689359664917
Epoch: 9, Steps: 13 | Train Loss: 0.504 Vali Loss: 9.518 Vali Acc: 0.478 Test Loss: 9.518 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.50381088256836
Epoch: 10, Steps: 13 | Train Loss: 0.939 Vali Loss: 11.496 Vali Acc: 0.539 Test Loss: 11.496 Test Acc: 0.539
Validation loss decreased (-0.533261 --> -0.538774).  Saving model ...
Epoch: 11 cost time: 25.006956338882446
Epoch: 11, Steps: 13 | Train Loss: 1.753 Vali Loss: 12.379 Vali Acc: 0.500 Test Loss: 12.379 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.570786714553833
Epoch: 12, Steps: 13 | Train Loss: 0.497 Vali Loss: 11.964 Vali Acc: 0.489 Test Loss: 11.964 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 25.761077880859375
Epoch: 13, Steps: 13 | Train Loss: 0.501 Vali Loss: 12.215 Vali Acc: 0.483 Test Loss: 12.215 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 26.48226046562195
Epoch: 14, Steps: 13 | Train Loss: 0.524 Vali Loss: 14.236 Vali Acc: 0.444 Test Loss: 14.236 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 29.550903797149658
Epoch: 15, Steps: 13 | Train Loss: 0.763 Vali Loss: 14.323 Vali Acc: 0.517 Test Loss: 14.323 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 31.407825708389282
Epoch: 16, Steps: 13 | Train Loss: 0.416 Vali Loss: 15.495 Vali Acc: 0.517 Test Loss: 15.495 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 26.349059581756592
Epoch: 17, Steps: 13 | Train Loss: 1.274 Vali Loss: 18.786 Vali Acc: 0.578 Test Loss: 18.786 Test Acc: 0.578
Validation loss decreased (-0.538774 --> -0.577590).  Saving model ...
Epoch: 18 cost time: 31.02138042449951
Epoch: 18, Steps: 13 | Train Loss: 2.174 Vali Loss: 22.877 Vali Acc: 0.550 Test Loss: 22.877 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 31.29393434524536
Epoch: 19, Steps: 13 | Train Loss: 1.131 Vali Loss: 20.394 Vali Acc: 0.517 Test Loss: 20.394 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 32.755873680114746
Epoch: 20, Steps: 13 | Train Loss: 1.280 Vali Loss: 25.762 Vali Acc: 0.444 Test Loss: 25.762 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 30.026323318481445
Epoch: 21, Steps: 13 | Train Loss: 0.826 Vali Loss: 22.722 Vali Acc: 0.500 Test Loss: 22.722 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 28.97292709350586
Epoch: 22, Steps: 13 | Train Loss: 0.193 Vali Loss: 23.281 Vali Acc: 0.483 Test Loss: 23.281 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 33.41375255584717
Epoch: 23, Steps: 13 | Train Loss: 0.560 Vali Loss: 28.077 Vali Acc: 0.450 Test Loss: 28.077 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 32.502198457717896
Epoch: 24, Steps: 13 | Train Loss: 0.366 Vali Loss: 24.277 Vali Acc: 0.450 Test Loss: 24.277 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 29.628076791763306
Epoch: 25, Steps: 13 | Train Loss: 0.227 Vali Loss: 24.163 Vali Acc: 0.483 Test Loss: 24.163 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 27.176695585250854
Epoch: 26, Steps: 13 | Train Loss: 0.381 Vali Loss: 34.699 Vali Acc: 0.500 Test Loss: 34.699 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 32.536277770996094
Epoch: 27, Steps: 13 | Train Loss: 0.878 Vali Loss: 33.034 Vali Acc: 0.478 Test Loss: 33.034 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 14846978
model size : 76.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 22.221802949905396
Epoch: 1, Steps: 13 | Train Loss: 1.018 Vali Loss: 2.045 Vali Acc: 0.517 Test Loss: 2.045 Test Acc: 0.517
Validation loss decreased (inf --> -0.516646).  Saving model ...
Epoch: 2 cost time: 19.57794427871704
Epoch: 2, Steps: 13 | Train Loss: 1.020 Vali Loss: 1.815 Vali Acc: 0.483 Test Loss: 1.815 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.470343112945557
Epoch: 3, Steps: 13 | Train Loss: 0.622 Vali Loss: 4.946 Vali Acc: 0.517 Test Loss: 4.946 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 22.822756052017212
Epoch: 4, Steps: 13 | Train Loss: 1.320 Vali Loss: 4.083 Vali Acc: 0.483 Test Loss: 4.083 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.315895795822144
Epoch: 5, Steps: 13 | Train Loss: 0.751 Vali Loss: 7.152 Vali Acc: 0.494 Test Loss: 7.152 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 21.82686161994934
Epoch: 6, Steps: 13 | Train Loss: 1.926 Vali Loss: 6.462 Vali Acc: 0.511 Test Loss: 6.462 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 23.522337198257446
Epoch: 7, Steps: 13 | Train Loss: 2.150 Vali Loss: 6.794 Vali Acc: 0.494 Test Loss: 6.794 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 21.89463472366333
Epoch: 8, Steps: 13 | Train Loss: 0.670 Vali Loss: 7.939 Vali Acc: 0.528 Test Loss: 7.939 Test Acc: 0.528
Validation loss decreased (-0.516646 --> -0.527698).  Saving model ...
Epoch: 9 cost time: 22.961310625076294
Epoch: 9, Steps: 13 | Train Loss: 0.894 Vali Loss: 12.216 Vali Acc: 0.478 Test Loss: 12.216 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.908241987228394
Epoch: 10, Steps: 13 | Train Loss: 2.349 Vali Loss: 10.037 Vali Acc: 0.483 Test Loss: 10.037 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.74731707572937
Epoch: 11, Steps: 13 | Train Loss: 0.838 Vali Loss: 14.290 Vali Acc: 0.489 Test Loss: 14.290 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 22.81226396560669
Epoch: 12, Steps: 13 | Train Loss: 1.063 Vali Loss: 16.791 Vali Acc: 0.483 Test Loss: 16.791 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 23.357449054718018
Epoch: 13, Steps: 13 | Train Loss: 2.167 Vali Loss: 22.914 Vali Acc: 0.494 Test Loss: 22.914 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 26.307847261428833
Epoch: 14, Steps: 13 | Train Loss: 1.355 Vali Loss: 15.219 Vali Acc: 0.483 Test Loss: 15.219 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 18.592488527297974
Epoch: 15, Steps: 13 | Train Loss: 1.044 Vali Loss: 17.530 Vali Acc: 0.461 Test Loss: 17.530 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 22.359086990356445
Epoch: 16, Steps: 13 | Train Loss: 0.243 Vali Loss: 20.577 Vali Acc: 0.450 Test Loss: 20.577 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 25.945132732391357
Epoch: 17, Steps: 13 | Train Loss: 0.437 Vali Loss: 18.477 Vali Acc: 0.478 Test Loss: 18.477 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 26.922231435775757
Epoch: 18, Steps: 13 | Train Loss: 1.281 Vali Loss: 21.130 Vali Acc: 0.472 Test Loss: 21.130 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 14846978
model size : 76.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 20.243369102478027
Epoch: 1, Steps: 13 | Train Loss: 0.925 Vali Loss: 1.562 Vali Acc: 0.500 Test Loss: 1.562 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 18.67601776123047
Epoch: 2, Steps: 13 | Train Loss: 0.693 Vali Loss: 2.888 Vali Acc: 0.494 Test Loss: 2.888 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.293675899505615
Epoch: 3, Steps: 13 | Train Loss: 1.046 Vali Loss: 3.977 Vali Acc: 0.522 Test Loss: 3.977 Test Acc: 0.522
Validation loss decreased (-0.499984 --> -0.522182).  Saving model ...
Epoch: 4 cost time: 21.153732299804688
Epoch: 4, Steps: 13 | Train Loss: 1.285 Vali Loss: 6.745 Vali Acc: 0.506 Test Loss: 6.745 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.87674355506897
Epoch: 5, Steps: 13 | Train Loss: 1.990 Vali Loss: 5.153 Vali Acc: 0.533 Test Loss: 5.153 Test Acc: 0.533
Validation loss decreased (-0.522182 --> -0.533282).  Saving model ...
Epoch: 6 cost time: 19.492485284805298
Epoch: 6, Steps: 13 | Train Loss: 1.454 Vali Loss: 6.000 Vali Acc: 0.456 Test Loss: 6.000 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.389663219451904
Epoch: 7, Steps: 13 | Train Loss: 0.726 Vali Loss: 6.739 Vali Acc: 0.422 Test Loss: 6.739 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.236325979232788
Epoch: 8, Steps: 13 | Train Loss: 0.986 Vali Loss: 9.191 Vali Acc: 0.467 Test Loss: 9.191 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 16.731731414794922
Epoch: 9, Steps: 13 | Train Loss: 1.010 Vali Loss: 10.515 Vali Acc: 0.489 Test Loss: 10.515 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 20.015231370925903
Epoch: 10, Steps: 13 | Train Loss: 1.932 Vali Loss: 9.313 Vali Acc: 0.500 Test Loss: 9.313 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 18.05441451072693
Epoch: 11, Steps: 13 | Train Loss: 0.706 Vali Loss: 9.750 Vali Acc: 0.517 Test Loss: 9.750 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 20.898424863815308
Epoch: 12, Steps: 13 | Train Loss: 0.476 Vali Loss: 10.849 Vali Acc: 0.511 Test Loss: 10.849 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 20.71059226989746
Epoch: 13, Steps: 13 | Train Loss: 0.971 Vali Loss: 14.110 Vali Acc: 0.461 Test Loss: 14.110 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 19.552526235580444
Epoch: 14, Steps: 13 | Train Loss: 0.868 Vali Loss: 14.361 Vali Acc: 0.506 Test Loss: 14.361 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 14.25015640258789
Epoch: 15, Steps: 13 | Train Loss: 1.981 Vali Loss: 21.792 Vali Acc: 0.511 Test Loss: 21.792 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 14846978
model size : 76.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 17.512609720230103
Epoch: 1, Steps: 13 | Train Loss: 0.842 Vali Loss: 1.050 Vali Acc: 0.506 Test Loss: 1.050 Test Acc: 0.506
Validation loss decreased (inf --> -0.505545).  Saving model ...
Epoch: 2 cost time: 16.604822635650635
Epoch: 2, Steps: 13 | Train Loss: 0.640 Vali Loss: 2.324 Vali Acc: 0.511 Test Loss: 2.324 Test Acc: 0.511
Validation loss decreased (-0.505545 --> -0.511088).  Saving model ...
Epoch: 3 cost time: 17.432968854904175
Epoch: 3, Steps: 13 | Train Loss: 0.641 Vali Loss: 3.945 Vali Acc: 0.511 Test Loss: 3.945 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.330025672912598
Epoch: 4, Steps: 13 | Train Loss: 1.277 Vali Loss: 4.661 Vali Acc: 0.539 Test Loss: 4.661 Test Acc: 0.539
Validation loss decreased (-0.511088 --> -0.538842).  Saving model ...
Epoch: 5 cost time: 15.626179218292236
Epoch: 5, Steps: 13 | Train Loss: 0.561 Vali Loss: 5.262 Vali Acc: 0.506 Test Loss: 5.262 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.810954809188843
Epoch: 6, Steps: 13 | Train Loss: 0.870 Vali Loss: 7.182 Vali Acc: 0.544 Test Loss: 7.182 Test Acc: 0.544
Validation loss decreased (-0.538842 --> -0.544373).  Saving model ...
Epoch: 7 cost time: 16.493520498275757
Epoch: 7, Steps: 13 | Train Loss: 0.827 Vali Loss: 5.905 Vali Acc: 0.489 Test Loss: 5.905 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.959758043289185
Epoch: 8, Steps: 13 | Train Loss: 0.607 Vali Loss: 7.206 Vali Acc: 0.494 Test Loss: 7.206 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.287286043167114
Epoch: 9, Steps: 13 | Train Loss: 0.834 Vali Loss: 9.361 Vali Acc: 0.489 Test Loss: 9.361 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.250242710113525
Epoch: 10, Steps: 13 | Train Loss: 0.716 Vali Loss: 13.733 Vali Acc: 0.467 Test Loss: 13.733 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.34569811820984
Epoch: 11, Steps: 13 | Train Loss: 2.164 Vali Loss: 20.698 Vali Acc: 0.489 Test Loss: 20.698 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.676076650619507
Epoch: 12, Steps: 13 | Train Loss: 2.329 Vali Loss: 21.841 Vali Acc: 0.511 Test Loss: 21.841 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 18.410585165023804
Epoch: 13, Steps: 13 | Train Loss: 3.710 Vali Loss: 27.014 Vali Acc: 0.517 Test Loss: 27.014 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 18.834402322769165
Epoch: 14, Steps: 13 | Train Loss: 2.339 Vali Loss: 21.735 Vali Acc: 0.539 Test Loss: 21.735 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 18.60263466835022
Epoch: 15, Steps: 13 | Train Loss: 2.257 Vali Loss: 25.040 Vali Acc: 0.494 Test Loss: 25.040 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 19.134706258773804
Epoch: 16, Steps: 13 | Train Loss: 2.111 Vali Loss: 18.468 Vali Acc: 0.539 Test Loss: 18.468 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 14846978
model size : 76.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 16.04071879386902
Epoch: 1, Steps: 13 | Train Loss: 0.811 Vali Loss: 1.069 Vali Acc: 0.544 Test Loss: 1.069 Test Acc: 0.544
Validation loss decreased (inf --> -0.544434).  Saving model ...
Epoch: 2 cost time: 13.88976502418518
Epoch: 2, Steps: 13 | Train Loss: 0.698 Vali Loss: 2.010 Vali Acc: 0.478 Test Loss: 2.010 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.716445207595825
Epoch: 3, Steps: 13 | Train Loss: 0.612 Vali Loss: 2.406 Vali Acc: 0.539 Test Loss: 2.406 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.96614360809326
Epoch: 4, Steps: 13 | Train Loss: 0.616 Vali Loss: 3.099 Vali Acc: 0.517 Test Loss: 3.099 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.290169715881348
Epoch: 5, Steps: 13 | Train Loss: 0.458 Vali Loss: 4.514 Vali Acc: 0.489 Test Loss: 4.514 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.175659418106079
Epoch: 6, Steps: 13 | Train Loss: 0.298 Vali Loss: 6.803 Vali Acc: 0.506 Test Loss: 6.803 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.3657386302948
Epoch: 7, Steps: 13 | Train Loss: 0.926 Vali Loss: 5.929 Vali Acc: 0.500 Test Loss: 5.929 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.038282632827759
Epoch: 8, Steps: 13 | Train Loss: 0.707 Vali Loss: 8.751 Vali Acc: 0.511 Test Loss: 8.751 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 15.057264804840088
Epoch: 9, Steps: 13 | Train Loss: 1.363 Vali Loss: 11.732 Vali Acc: 0.506 Test Loss: 11.732 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 15.96675443649292
Epoch: 10, Steps: 13 | Train Loss: 1.354 Vali Loss: 9.970 Vali Acc: 0.511 Test Loss: 9.970 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.697599411010742
Epoch: 11, Steps: 13 | Train Loss: 0.403 Vali Loss: 10.013 Vali Acc: 0.483 Test Loss: 10.013 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 14846978
model size : 76.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 16.712944746017456
Epoch: 1, Steps: 13 | Train Loss: 0.844 Vali Loss: 1.332 Vali Acc: 0.494 Test Loss: 1.332 Test Acc: 0.494
Validation loss decreased (inf --> -0.494431).  Saving model ...
Epoch: 2 cost time: 15.101227521896362
Epoch: 2, Steps: 13 | Train Loss: 0.977 Vali Loss: 3.545 Vali Acc: 0.467 Test Loss: 3.545 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.06832242012024
Epoch: 3, Steps: 13 | Train Loss: 1.493 Vali Loss: 2.837 Vali Acc: 0.483 Test Loss: 2.837 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.120533466339111
Epoch: 4, Steps: 13 | Train Loss: 0.717 Vali Loss: 3.653 Vali Acc: 0.489 Test Loss: 3.653 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.02773928642273
Epoch: 5, Steps: 13 | Train Loss: 0.929 Vali Loss: 5.862 Vali Acc: 0.489 Test Loss: 5.862 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.070135354995728
Epoch: 6, Steps: 13 | Train Loss: 1.378 Vali Loss: 5.404 Vali Acc: 0.489 Test Loss: 5.404 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.47147536277771
Epoch: 7, Steps: 13 | Train Loss: 0.921 Vali Loss: 5.364 Vali Acc: 0.483 Test Loss: 5.364 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.261367082595825
Epoch: 8, Steps: 13 | Train Loss: 1.171 Vali Loss: 8.589 Vali Acc: 0.489 Test Loss: 8.589 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.791958332061768
Epoch: 9, Steps: 13 | Train Loss: 1.790 Vali Loss: 9.692 Vali Acc: 0.494 Test Loss: 9.692 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.603901624679565
Epoch: 10, Steps: 13 | Train Loss: 2.320 Vali Loss: 9.461 Vali Acc: 0.439 Test Loss: 9.461 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 14.059173345565796
Epoch: 11, Steps: 13 | Train Loss: 1.416 Vali Loss: 8.730 Vali Acc: 0.483 Test Loss: 8.730 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.49444444444444446
model parameter : 14846978
model size : 76.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 15.192604064941406
Epoch: 1, Steps: 13 | Train Loss: 0.769 Vali Loss: 1.031 Vali Acc: 0.506 Test Loss: 1.031 Test Acc: 0.506
Validation loss decreased (inf --> -0.505545).  Saving model ...
Epoch: 2 cost time: 13.775084257125854
Epoch: 2, Steps: 13 | Train Loss: 0.618 Vali Loss: 3.166 Vali Acc: 0.483 Test Loss: 3.166 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.298962593078613
Epoch: 3, Steps: 13 | Train Loss: 0.657 Vali Loss: 3.017 Vali Acc: 0.478 Test Loss: 3.017 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.509002447128296
Epoch: 4, Steps: 13 | Train Loss: 0.531 Vali Loss: 3.778 Vali Acc: 0.483 Test Loss: 3.778 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.506638288497925
Epoch: 5, Steps: 13 | Train Loss: 0.442 Vali Loss: 3.881 Vali Acc: 0.478 Test Loss: 3.881 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.358211278915405
Epoch: 6, Steps: 13 | Train Loss: 0.702 Vali Loss: 6.168 Vali Acc: 0.467 Test Loss: 6.168 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.95949673652649
Epoch: 7, Steps: 13 | Train Loss: 0.574 Vali Loss: 7.281 Vali Acc: 0.450 Test Loss: 7.281 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.685847759246826
Epoch: 8, Steps: 13 | Train Loss: 0.752 Vali Loss: 9.618 Vali Acc: 0.444 Test Loss: 9.618 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.77664589881897
Epoch: 9, Steps: 13 | Train Loss: 0.892 Vali Loss: 7.643 Vali Acc: 0.500 Test Loss: 7.643 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 14.205706119537354
Epoch: 10, Steps: 13 | Train Loss: 1.150 Vali Loss: 11.866 Vali Acc: 0.517 Test Loss: 11.866 Test Acc: 0.517
Validation loss decreased (-0.505545 --> -0.516548).  Saving model ...
Epoch: 11 cost time: 12.62627100944519
Epoch: 11, Steps: 13 | Train Loss: 2.104 Vali Loss: 17.608 Vali Acc: 0.450 Test Loss: 17.608 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.404365062713623
Epoch: 12, Steps: 13 | Train Loss: 2.891 Vali Loss: 13.697 Vali Acc: 0.467 Test Loss: 13.697 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.71191668510437
Epoch: 13, Steps: 13 | Train Loss: 1.284 Vali Loss: 16.228 Vali Acc: 0.450 Test Loss: 16.228 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.166134357452393
Epoch: 14, Steps: 13 | Train Loss: 2.135 Vali Loss: 13.561 Vali Acc: 0.500 Test Loss: 13.561 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.477450132369995
Epoch: 15, Steps: 13 | Train Loss: 1.072 Vali Loss: 12.900 Vali Acc: 0.500 Test Loss: 12.900 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.878054857254028
Epoch: 16, Steps: 13 | Train Loss: 0.189 Vali Loss: 15.205 Vali Acc: 0.494 Test Loss: 15.205 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 14.157868385314941
Epoch: 17, Steps: 13 | Train Loss: 0.472 Vali Loss: 17.417 Vali Acc: 0.450 Test Loss: 17.417 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 14.876866579055786
Epoch: 18, Steps: 13 | Train Loss: 0.712 Vali Loss: 17.349 Vali Acc: 0.467 Test Loss: 17.349 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 14.699437379837036
Epoch: 19, Steps: 13 | Train Loss: 0.232 Vali Loss: 15.440 Vali Acc: 0.494 Test Loss: 15.440 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 13.798022031784058
Epoch: 20, Steps: 13 | Train Loss: 0.454 Vali Loss: 17.828 Vali Acc: 0.500 Test Loss: 17.828 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 14846978
model size : 76.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 14.704904794692993
Epoch: 1, Steps: 13 | Train Loss: 0.852 Vali Loss: 0.773 Vali Acc: 0.550 Test Loss: 0.773 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 12.917328357696533
Epoch: 2, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.932 Vali Acc: 0.561 Test Loss: 0.932 Test Acc: 0.561
Validation loss decreased (-0.549992 --> -0.561102).  Saving model ...
Epoch: 3 cost time: 13.282698392868042
Epoch: 3, Steps: 13 | Train Loss: 0.692 Vali Loss: 1.582 Vali Acc: 0.517 Test Loss: 1.582 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.15372085571289
Epoch: 4, Steps: 13 | Train Loss: 1.165 Vali Loss: 2.901 Vali Acc: 0.517 Test Loss: 2.901 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.533121347427368
Epoch: 5, Steps: 13 | Train Loss: 0.842 Vali Loss: 2.256 Vali Acc: 0.522 Test Loss: 2.256 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.940818071365356
Epoch: 6, Steps: 13 | Train Loss: 0.425 Vali Loss: 2.522 Vali Acc: 0.522 Test Loss: 2.522 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.099985837936401
Epoch: 7, Steps: 13 | Train Loss: 0.800 Vali Loss: 3.215 Vali Acc: 0.544 Test Loss: 3.215 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.20003080368042
Epoch: 8, Steps: 13 | Train Loss: 0.323 Vali Loss: 3.899 Vali Acc: 0.533 Test Loss: 3.899 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.791560173034668
Epoch: 9, Steps: 13 | Train Loss: 0.559 Vali Loss: 4.298 Vali Acc: 0.522 Test Loss: 4.298 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.427127599716187
Epoch: 10, Steps: 13 | Train Loss: 0.257 Vali Loss: 4.335 Vali Acc: 0.578 Test Loss: 4.335 Test Acc: 0.578
Validation loss decreased (-0.561102 --> -0.577734).  Saving model ...
Epoch: 11 cost time: 12.243435621261597
Epoch: 11, Steps: 13 | Train Loss: 0.583 Vali Loss: 5.966 Vali Acc: 0.533 Test Loss: 5.966 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.442521810531616
Epoch: 12, Steps: 13 | Train Loss: 0.498 Vali Loss: 5.647 Vali Acc: 0.550 Test Loss: 5.647 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.520288705825806
Epoch: 13, Steps: 13 | Train Loss: 0.557 Vali Loss: 6.260 Vali Acc: 0.561 Test Loss: 6.260 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.369378089904785
Epoch: 14, Steps: 13 | Train Loss: 0.371 Vali Loss: 9.433 Vali Acc: 0.550 Test Loss: 9.433 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.865612268447876
Epoch: 15, Steps: 13 | Train Loss: 1.453 Vali Loss: 8.904 Vali Acc: 0.517 Test Loss: 8.904 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 13.906297445297241
Epoch: 16, Steps: 13 | Train Loss: 0.498 Vali Loss: 14.050 Vali Acc: 0.489 Test Loss: 14.050 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 13.641716957092285
Epoch: 17, Steps: 13 | Train Loss: 0.699 Vali Loss: 11.493 Vali Acc: 0.528 Test Loss: 11.493 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 14.19628620147705
Epoch: 18, Steps: 13 | Train Loss: 1.956 Vali Loss: 18.851 Vali Acc: 0.478 Test Loss: 18.851 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 12.08236575126648
Epoch: 19, Steps: 13 | Train Loss: 1.105 Vali Loss: 13.327 Vali Acc: 0.539 Test Loss: 13.327 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.592310428619385
Epoch: 20, Steps: 13 | Train Loss: 0.503 Vali Loss: 14.171 Vali Acc: 0.528 Test Loss: 14.171 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 14846978
model size : 76.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 14.196044683456421
Epoch: 1, Steps: 13 | Train Loss: 0.803 Vali Loss: 1.207 Vali Acc: 0.517 Test Loss: 1.207 Test Acc: 0.517
Validation loss decreased (inf --> -0.516655).  Saving model ...
Epoch: 2 cost time: 13.932130098342896
Epoch: 2, Steps: 13 | Train Loss: 1.117 Vali Loss: 1.428 Vali Acc: 0.522 Test Loss: 1.428 Test Acc: 0.522
Validation loss decreased (-0.516655 --> -0.522208).  Saving model ...
Epoch: 3 cost time: 10.403473377227783
Epoch: 3, Steps: 13 | Train Loss: 0.650 Vali Loss: 2.041 Vali Acc: 0.489 Test Loss: 2.041 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.299812316894531
Epoch: 4, Steps: 13 | Train Loss: 1.229 Vali Loss: 1.702 Vali Acc: 0.539 Test Loss: 1.702 Test Acc: 0.539
Validation loss decreased (-0.522208 --> -0.538872).  Saving model ...
Epoch: 5 cost time: 12.611011266708374
Epoch: 5, Steps: 13 | Train Loss: 0.989 Vali Loss: 4.082 Vali Acc: 0.511 Test Loss: 4.082 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.007001161575317
Epoch: 6, Steps: 13 | Train Loss: 1.330 Vali Loss: 3.349 Vali Acc: 0.528 Test Loss: 3.349 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.813034057617188
Epoch: 7, Steps: 13 | Train Loss: 1.543 Vali Loss: 2.730 Vali Acc: 0.556 Test Loss: 2.730 Test Acc: 0.556
Validation loss decreased (-0.538872 --> -0.555528).  Saving model ...
Epoch: 8 cost time: 10.754952430725098
Epoch: 8, Steps: 13 | Train Loss: 1.068 Vali Loss: 2.532 Vali Acc: 0.528 Test Loss: 2.532 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.537008047103882
Epoch: 9, Steps: 13 | Train Loss: 0.719 Vali Loss: 2.872 Vali Acc: 0.589 Test Loss: 2.872 Test Acc: 0.589
Validation loss decreased (-0.555528 --> -0.588860).  Saving model ...
Epoch: 10 cost time: 13.990867137908936
Epoch: 10, Steps: 13 | Train Loss: 0.806 Vali Loss: 7.037 Vali Acc: 0.511 Test Loss: 7.037 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.109901189804077
Epoch: 11, Steps: 13 | Train Loss: 1.283 Vali Loss: 3.693 Vali Acc: 0.539 Test Loss: 3.693 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.985505819320679
Epoch: 12, Steps: 13 | Train Loss: 0.835 Vali Loss: 4.948 Vali Acc: 0.539 Test Loss: 4.948 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 14.200981140136719
Epoch: 13, Steps: 13 | Train Loss: 1.531 Vali Loss: 5.912 Vali Acc: 0.539 Test Loss: 5.912 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.530766248703003
Epoch: 14, Steps: 13 | Train Loss: 1.720 Vali Loss: 6.126 Vali Acc: 0.561 Test Loss: 6.126 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 11.812966585159302
Epoch: 15, Steps: 13 | Train Loss: 1.193 Vali Loss: 6.894 Vali Acc: 0.511 Test Loss: 6.894 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.909614086151123
Epoch: 16, Steps: 13 | Train Loss: 1.817 Vali Loss: 5.630 Vali Acc: 0.556 Test Loss: 5.630 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 13.391378402709961
Epoch: 17, Steps: 13 | Train Loss: 1.604 Vali Loss: 5.291 Vali Acc: 0.539 Test Loss: 5.291 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 14.448001861572266
Epoch: 18, Steps: 13 | Train Loss: 0.854 Vali Loss: 7.720 Vali Acc: 0.544 Test Loss: 7.720 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 14.095492124557495
Epoch: 19, Steps: 13 | Train Loss: 1.666 Vali Loss: 7.662 Vali Acc: 0.556 Test Loss: 7.662 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 14846978
model size : 76.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 28.216952323913574
Epoch: 1, Steps: 13 | Train Loss: 0.951 Vali Loss: 1.230 Vali Acc: 0.506 Test Loss: 1.230 Test Acc: 0.506
Validation loss decreased (inf --> -0.505543).  Saving model ...
Epoch: 2 cost time: 24.648274183273315
Epoch: 2, Steps: 13 | Train Loss: 1.239 Vali Loss: 2.465 Vali Acc: 0.539 Test Loss: 2.465 Test Acc: 0.539
Validation loss decreased (-0.505543 --> -0.538864).  Saving model ...
Epoch: 3 cost time: 27.94437336921692
Epoch: 3, Steps: 13 | Train Loss: 1.016 Vali Loss: 3.113 Vali Acc: 0.511 Test Loss: 3.113 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.197998762130737
Epoch: 4, Steps: 13 | Train Loss: 1.447 Vali Loss: 4.724 Vali Acc: 0.483 Test Loss: 4.724 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 28.07498049736023
Epoch: 5, Steps: 13 | Train Loss: 1.245 Vali Loss: 6.600 Vali Acc: 0.511 Test Loss: 6.600 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 24.58398127555847
Epoch: 6, Steps: 13 | Train Loss: 1.193 Vali Loss: 5.620 Vali Acc: 0.544 Test Loss: 5.620 Test Acc: 0.544
Validation loss decreased (-0.538864 --> -0.544388).  Saving model ...
Epoch: 7 cost time: 27.613897562026978
Epoch: 7, Steps: 13 | Train Loss: 0.556 Vali Loss: 7.054 Vali Acc: 0.483 Test Loss: 7.054 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 26.60135555267334
Epoch: 8, Steps: 13 | Train Loss: 0.652 Vali Loss: 10.222 Vali Acc: 0.533 Test Loss: 10.222 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 29.03478741645813
Epoch: 9, Steps: 13 | Train Loss: 0.826 Vali Loss: 11.017 Vali Acc: 0.478 Test Loss: 11.017 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 20.937306880950928
Epoch: 10, Steps: 13 | Train Loss: 1.065 Vali Loss: 13.153 Vali Acc: 0.511 Test Loss: 13.153 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 28.979731798171997
Epoch: 11, Steps: 13 | Train Loss: 1.054 Vali Loss: 11.357 Vali Acc: 0.456 Test Loss: 11.357 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 27.06078815460205
Epoch: 12, Steps: 13 | Train Loss: 1.120 Vali Loss: 11.952 Vali Acc: 0.433 Test Loss: 11.952 Test Acc: 0.433
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 29.107043504714966
Epoch: 13, Steps: 13 | Train Loss: 0.695 Vali Loss: 15.304 Vali Acc: 0.506 Test Loss: 15.304 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 29.085728883743286
Epoch: 14, Steps: 13 | Train Loss: 0.789 Vali Loss: 16.260 Vali Acc: 0.461 Test Loss: 16.260 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 32.032365560531616
Epoch: 15, Steps: 13 | Train Loss: 0.448 Vali Loss: 17.346 Vali Acc: 0.494 Test Loss: 17.346 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 29.234947204589844
Epoch: 16, Steps: 13 | Train Loss: 2.306 Vali Loss: 19.130 Vali Acc: 0.506 Test Loss: 19.130 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 13274114
model size : 70.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 26.08301043510437
Epoch: 1, Steps: 13 | Train Loss: 0.911 Vali Loss: 1.043 Vali Acc: 0.511 Test Loss: 1.043 Test Acc: 0.511
Validation loss decreased (inf --> -0.511101).  Saving model ...
Epoch: 2 cost time: 17.62163519859314
Epoch: 2, Steps: 13 | Train Loss: 0.746 Vali Loss: 2.858 Vali Acc: 0.506 Test Loss: 2.858 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.67046284675598
Epoch: 3, Steps: 13 | Train Loss: 0.791 Vali Loss: 3.117 Vali Acc: 0.472 Test Loss: 3.117 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 25.536100387573242
Epoch: 4, Steps: 13 | Train Loss: 0.883 Vali Loss: 3.778 Vali Acc: 0.433 Test Loss: 3.778 Test Acc: 0.433
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.49950385093689
Epoch: 5, Steps: 13 | Train Loss: 0.709 Vali Loss: 4.285 Vali Acc: 0.528 Test Loss: 4.285 Test Acc: 0.528
Validation loss decreased (-0.511101 --> -0.527735).  Saving model ...
Epoch: 6 cost time: 26.150271892547607
Epoch: 6, Steps: 13 | Train Loss: 0.513 Vali Loss: 5.129 Vali Acc: 0.483 Test Loss: 5.129 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 27.33335304260254
Epoch: 7, Steps: 13 | Train Loss: 0.794 Vali Loss: 5.910 Vali Acc: 0.478 Test Loss: 5.910 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 25.6898672580719
Epoch: 8, Steps: 13 | Train Loss: 0.687 Vali Loss: 6.482 Vali Acc: 0.522 Test Loss: 6.482 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 21.758790731430054
Epoch: 9, Steps: 13 | Train Loss: 0.698 Vali Loss: 9.093 Vali Acc: 0.494 Test Loss: 9.093 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.716439485549927
Epoch: 10, Steps: 13 | Train Loss: 0.887 Vali Loss: 9.790 Vali Acc: 0.461 Test Loss: 9.790 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 25.82625126838684
Epoch: 11, Steps: 13 | Train Loss: 0.561 Vali Loss: 11.604 Vali Acc: 0.456 Test Loss: 11.604 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 27.280784368515015
Epoch: 12, Steps: 13 | Train Loss: 1.484 Vali Loss: 12.902 Vali Acc: 0.494 Test Loss: 12.902 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 23.60050916671753
Epoch: 13, Steps: 13 | Train Loss: 0.850 Vali Loss: 12.447 Vali Acc: 0.494 Test Loss: 12.447 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 26.0337016582489
Epoch: 14, Steps: 13 | Train Loss: 1.509 Vali Loss: 18.535 Vali Acc: 0.517 Test Loss: 18.535 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 29.59693193435669
Epoch: 15, Steps: 13 | Train Loss: 0.999 Vali Loss: 15.654 Vali Acc: 0.494 Test Loss: 15.654 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 13274114
model size : 70.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 24.141449689865112
Epoch: 1, Steps: 13 | Train Loss: 0.915 Vali Loss: 0.970 Vali Acc: 0.522 Test Loss: 0.970 Test Acc: 0.522
Validation loss decreased (inf --> -0.522213).  Saving model ...
Epoch: 2 cost time: 20.187148809432983
Epoch: 2, Steps: 13 | Train Loss: 0.691 Vali Loss: 2.031 Vali Acc: 0.489 Test Loss: 2.031 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.24617910385132
Epoch: 3, Steps: 13 | Train Loss: 0.725 Vali Loss: 3.281 Vali Acc: 0.489 Test Loss: 3.281 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 22.55122399330139
Epoch: 4, Steps: 13 | Train Loss: 1.082 Vali Loss: 3.479 Vali Acc: 0.522 Test Loss: 3.479 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.331841945648193
Epoch: 5, Steps: 13 | Train Loss: 0.728 Vali Loss: 3.998 Vali Acc: 0.517 Test Loss: 3.998 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 22.335442543029785
Epoch: 6, Steps: 13 | Train Loss: 0.787 Vali Loss: 6.861 Vali Acc: 0.506 Test Loss: 6.861 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.564345836639404
Epoch: 7, Steps: 13 | Train Loss: 1.179 Vali Loss: 6.278 Vali Acc: 0.461 Test Loss: 6.278 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 21.12409472465515
Epoch: 8, Steps: 13 | Train Loss: 0.320 Vali Loss: 7.218 Vali Acc: 0.478 Test Loss: 7.218 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 19.70447301864624
Epoch: 9, Steps: 13 | Train Loss: 0.399 Vali Loss: 7.740 Vali Acc: 0.522 Test Loss: 7.740 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 20.418181896209717
Epoch: 10, Steps: 13 | Train Loss: 0.578 Vali Loss: 7.994 Vali Acc: 0.467 Test Loss: 7.994 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 22.915283203125
Epoch: 11, Steps: 13 | Train Loss: 1.501 Vali Loss: 9.973 Vali Acc: 0.472 Test Loss: 9.973 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 13274114
model size : 70.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 19.670619010925293
Epoch: 1, Steps: 13 | Train Loss: 0.892 Vali Loss: 1.099 Vali Acc: 0.544 Test Loss: 1.099 Test Acc: 0.544
Validation loss decreased (inf --> -0.544433).  Saving model ...
Epoch: 2 cost time: 17.219118118286133
Epoch: 2, Steps: 13 | Train Loss: 0.668 Vali Loss: 2.530 Vali Acc: 0.539 Test Loss: 2.530 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.625390529632568
Epoch: 3, Steps: 13 | Train Loss: 0.984 Vali Loss: 3.817 Vali Acc: 0.517 Test Loss: 3.817 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.544541597366333
Epoch: 4, Steps: 13 | Train Loss: 0.616 Vali Loss: 4.009 Vali Acc: 0.539 Test Loss: 4.009 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.37725830078125
Epoch: 5, Steps: 13 | Train Loss: 1.099 Vali Loss: 5.725 Vali Acc: 0.511 Test Loss: 5.725 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.23960018157959
Epoch: 6, Steps: 13 | Train Loss: 0.684 Vali Loss: 5.621 Vali Acc: 0.483 Test Loss: 5.621 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.920104503631592
Epoch: 7, Steps: 13 | Train Loss: 0.879 Vali Loss: 7.886 Vali Acc: 0.528 Test Loss: 7.886 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 17.54571557044983
Epoch: 8, Steps: 13 | Train Loss: 0.660 Vali Loss: 6.972 Vali Acc: 0.506 Test Loss: 6.972 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 17.85566020011902
Epoch: 9, Steps: 13 | Train Loss: 0.464 Vali Loss: 7.752 Vali Acc: 0.544 Test Loss: 7.752 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 17.230344772338867
Epoch: 10, Steps: 13 | Train Loss: 0.572 Vali Loss: 10.592 Vali Acc: 0.456 Test Loss: 10.592 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 18.34423279762268
Epoch: 11, Steps: 13 | Train Loss: 1.389 Vali Loss: 12.781 Vali Acc: 0.511 Test Loss: 12.781 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 13274114
model size : 70.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 18.527942657470703
Epoch: 1, Steps: 13 | Train Loss: 0.821 Vali Loss: 1.447 Vali Acc: 0.533 Test Loss: 1.447 Test Acc: 0.533
Validation loss decreased (inf --> -0.533319).  Saving model ...
Epoch: 2 cost time: 15.736458778381348
Epoch: 2, Steps: 13 | Train Loss: 0.802 Vali Loss: 2.075 Vali Acc: 0.500 Test Loss: 2.075 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.452266693115234
Epoch: 3, Steps: 13 | Train Loss: 0.644 Vali Loss: 3.026 Vali Acc: 0.461 Test Loss: 3.026 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.851022958755493
Epoch: 4, Steps: 13 | Train Loss: 0.515 Vali Loss: 3.930 Vali Acc: 0.494 Test Loss: 3.930 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.548640489578247
Epoch: 5, Steps: 13 | Train Loss: 0.834 Vali Loss: 5.531 Vali Acc: 0.494 Test Loss: 5.531 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.600825309753418
Epoch: 6, Steps: 13 | Train Loss: 1.701 Vali Loss: 8.025 Vali Acc: 0.511 Test Loss: 8.025 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.736047267913818
Epoch: 7, Steps: 13 | Train Loss: 1.962 Vali Loss: 7.531 Vali Acc: 0.522 Test Loss: 7.531 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.7583909034729
Epoch: 8, Steps: 13 | Train Loss: 2.645 Vali Loss: 7.621 Vali Acc: 0.533 Test Loss: 7.621 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 15.121752262115479
Epoch: 9, Steps: 13 | Train Loss: 0.363 Vali Loss: 8.741 Vali Acc: 0.511 Test Loss: 8.741 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.449038028717041
Epoch: 10, Steps: 13 | Train Loss: 0.416 Vali Loss: 10.968 Vali Acc: 0.478 Test Loss: 10.968 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 14.547015905380249
Epoch: 11, Steps: 13 | Train Loss: 0.561 Vali Loss: 10.483 Vali Acc: 0.489 Test Loss: 10.483 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 13274114
model size : 70.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.616676330566406
Epoch: 1, Steps: 13 | Train Loss: 0.892 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 4.328889846801758
Epoch: 2, Steps: 13 | Train Loss: 0.721 Vali Loss: 1.765 Vali Acc: 0.528 Test Loss: 1.765 Test Acc: 0.528
Validation loss decreased (-0.499987 --> -0.527760).  Saving model ...
Epoch: 3 cost time: 4.499606370925903
Epoch: 3, Steps: 13 | Train Loss: 0.787 Vali Loss: 3.335 Vali Acc: 0.472 Test Loss: 3.335 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.431705951690674
Epoch: 4, Steps: 13 | Train Loss: 0.761 Vali Loss: 4.275 Vali Acc: 0.506 Test Loss: 4.275 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.434778690338135
Epoch: 5, Steps: 13 | Train Loss: 1.000 Vali Loss: 6.508 Vali Acc: 0.511 Test Loss: 6.508 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.542211532592773
Epoch: 6, Steps: 13 | Train Loss: 1.211 Vali Loss: 6.468 Vali Acc: 0.506 Test Loss: 6.468 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.466799259185791
Epoch: 7, Steps: 13 | Train Loss: 2.379 Vali Loss: 6.902 Vali Acc: 0.511 Test Loss: 6.902 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.355868577957153
Epoch: 8, Steps: 13 | Train Loss: 1.475 Vali Loss: 7.584 Vali Acc: 0.489 Test Loss: 7.584 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.569063901901245
Epoch: 9, Steps: 13 | Train Loss: 1.372 Vali Loss: 11.944 Vali Acc: 0.522 Test Loss: 11.944 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.5972442626953125
Epoch: 10, Steps: 13 | Train Loss: 1.422 Vali Loss: 8.648 Vali Acc: 0.550 Test Loss: 8.648 Test Acc: 0.550
Validation loss decreased (-0.527760 --> -0.549914).  Saving model ...
Epoch: 11 cost time: 4.563142776489258
Epoch: 11, Steps: 13 | Train Loss: 1.025 Vali Loss: 9.200 Vali Acc: 0.583 Test Loss: 9.200 Test Acc: 0.583
Validation loss decreased (-0.549914 --> -0.583241).  Saving model ...
Epoch: 12 cost time: 4.624283790588379
Epoch: 12, Steps: 13 | Train Loss: 0.661 Vali Loss: 10.198 Vali Acc: 0.589 Test Loss: 10.198 Test Acc: 0.589
Validation loss decreased (-0.583241 --> -0.588787).  Saving model ...
Epoch: 13 cost time: 4.592021226882935
Epoch: 13, Steps: 13 | Train Loss: 0.812 Vali Loss: 12.342 Vali Acc: 0.506 Test Loss: 12.342 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.732541561126709
Epoch: 14, Steps: 13 | Train Loss: 0.548 Vali Loss: 12.378 Vali Acc: 0.506 Test Loss: 12.378 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.682082414627075
Epoch: 15, Steps: 13 | Train Loss: 1.179 Vali Loss: 17.937 Vali Acc: 0.450 Test Loss: 17.937 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.675020217895508
Epoch: 16, Steps: 13 | Train Loss: 0.711 Vali Loss: 16.361 Vali Acc: 0.511 Test Loss: 16.361 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.5872962474823
Epoch: 17, Steps: 13 | Train Loss: 0.559 Vali Loss: 18.338 Vali Acc: 0.500 Test Loss: 18.338 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.650314807891846
Epoch: 18, Steps: 13 | Train Loss: 0.201 Vali Loss: 16.717 Vali Acc: 0.533 Test Loss: 16.717 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.7410478591918945
Epoch: 19, Steps: 13 | Train Loss: 0.699 Vali Loss: 18.112 Vali Acc: 0.511 Test Loss: 18.112 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.883201360702515
Epoch: 20, Steps: 13 | Train Loss: 1.079 Vali Loss: 20.490 Vali Acc: 0.494 Test Loss: 20.490 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.89514422416687
Epoch: 21, Steps: 13 | Train Loss: 1.162 Vali Loss: 20.148 Vali Acc: 0.500 Test Loss: 20.148 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.675069332122803
Epoch: 22, Steps: 13 | Train Loss: 0.998 Vali Loss: 19.964 Vali Acc: 0.494 Test Loss: 19.964 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 13274114
model size : 70.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 15.192833662033081
Epoch: 1, Steps: 13 | Train Loss: 0.910 Vali Loss: 2.016 Vali Acc: 0.506 Test Loss: 2.016 Test Acc: 0.506
Validation loss decreased (inf --> -0.505535).  Saving model ...
Epoch: 2 cost time: 14.665021657943726
Epoch: 2, Steps: 13 | Train Loss: 1.080 Vali Loss: 2.781 Vali Acc: 0.483 Test Loss: 2.781 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.789793014526367
Epoch: 3, Steps: 13 | Train Loss: 0.974 Vali Loss: 3.426 Vali Acc: 0.483 Test Loss: 3.426 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.056891202926636
Epoch: 4, Steps: 13 | Train Loss: 0.802 Vali Loss: 3.394 Vali Acc: 0.500 Test Loss: 3.394 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.295376539230347
Epoch: 5, Steps: 13 | Train Loss: 0.834 Vali Loss: 4.431 Vali Acc: 0.478 Test Loss: 4.431 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.289827823638916
Epoch: 6, Steps: 13 | Train Loss: 0.525 Vali Loss: 5.310 Vali Acc: 0.461 Test Loss: 5.310 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.992096185684204
Epoch: 7, Steps: 13 | Train Loss: 0.641 Vali Loss: 5.120 Vali Acc: 0.522 Test Loss: 5.120 Test Acc: 0.522
Validation loss decreased (-0.505535 --> -0.522171).  Saving model ...
Epoch: 8 cost time: 13.478243112564087
Epoch: 8, Steps: 13 | Train Loss: 0.678 Vali Loss: 6.001 Vali Acc: 0.528 Test Loss: 6.001 Test Acc: 0.528
Validation loss decreased (-0.522171 --> -0.527718).  Saving model ...
Epoch: 9 cost time: 14.64962363243103
Epoch: 9, Steps: 13 | Train Loss: 0.931 Vali Loss: 9.473 Vali Acc: 0.489 Test Loss: 9.473 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.91431736946106
Epoch: 10, Steps: 13 | Train Loss: 1.168 Vali Loss: 7.244 Vali Acc: 0.522 Test Loss: 7.244 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.81880521774292
Epoch: 11, Steps: 13 | Train Loss: 1.304 Vali Loss: 9.084 Vali Acc: 0.500 Test Loss: 9.084 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.384635925292969
Epoch: 12, Steps: 13 | Train Loss: 0.708 Vali Loss: 10.170 Vali Acc: 0.450 Test Loss: 10.170 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.219119310379028
Epoch: 13, Steps: 13 | Train Loss: 0.585 Vali Loss: 10.183 Vali Acc: 0.472 Test Loss: 10.183 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.27467393875122
Epoch: 14, Steps: 13 | Train Loss: 0.965 Vali Loss: 10.878 Vali Acc: 0.483 Test Loss: 10.878 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 12.307848453521729
Epoch: 15, Steps: 13 | Train Loss: 1.625 Vali Loss: 14.255 Vali Acc: 0.478 Test Loss: 14.255 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 13.291270732879639
Epoch: 16, Steps: 13 | Train Loss: 1.068 Vali Loss: 12.494 Vali Acc: 0.450 Test Loss: 12.494 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 13.353275299072266
Epoch: 17, Steps: 13 | Train Loss: 0.816 Vali Loss: 15.634 Vali Acc: 0.461 Test Loss: 15.634 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 14.23907470703125
Epoch: 18, Steps: 13 | Train Loss: 0.869 Vali Loss: 15.318 Vali Acc: 0.444 Test Loss: 15.318 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 13274114
model size : 70.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 15.72570538520813
Epoch: 1, Steps: 13 | Train Loss: 0.828 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 12.19090485572815
Epoch: 2, Steps: 13 | Train Loss: 0.699 Vali Loss: 2.361 Vali Acc: 0.478 Test Loss: 2.361 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.520631551742554
Epoch: 3, Steps: 13 | Train Loss: 0.695 Vali Loss: 3.383 Vali Acc: 0.456 Test Loss: 3.383 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.550216436386108
Epoch: 4, Steps: 13 | Train Loss: 0.605 Vali Loss: 3.622 Vali Acc: 0.450 Test Loss: 3.622 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.013536930084229
Epoch: 5, Steps: 13 | Train Loss: 0.428 Vali Loss: 4.437 Vali Acc: 0.494 Test Loss: 4.437 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.309093952178955
Epoch: 6, Steps: 13 | Train Loss: 1.212 Vali Loss: 8.290 Vali Acc: 0.483 Test Loss: 8.290 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.77434229850769
Epoch: 7, Steps: 13 | Train Loss: 2.208 Vali Loss: 9.415 Vali Acc: 0.478 Test Loss: 9.415 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.96571946144104
Epoch: 8, Steps: 13 | Train Loss: 1.645 Vali Loss: 8.217 Vali Acc: 0.500 Test Loss: 8.217 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.718770980834961
Epoch: 9, Steps: 13 | Train Loss: 1.348 Vali Loss: 8.295 Vali Acc: 0.522 Test Loss: 8.295 Test Acc: 0.522
Validation loss decreased (-0.499987 --> -0.522139).  Saving model ...
Epoch: 10 cost time: 13.408650159835815
Epoch: 10, Steps: 13 | Train Loss: 0.762 Vali Loss: 10.681 Vali Acc: 0.467 Test Loss: 10.681 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.065983057022095
Epoch: 11, Steps: 13 | Train Loss: 0.739 Vali Loss: 11.884 Vali Acc: 0.494 Test Loss: 11.884 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.474894285202026
Epoch: 12, Steps: 13 | Train Loss: 1.063 Vali Loss: 9.003 Vali Acc: 0.489 Test Loss: 9.003 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.0040602684021
Epoch: 13, Steps: 13 | Train Loss: 2.395 Vali Loss: 12.509 Vali Acc: 0.450 Test Loss: 12.509 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.07924747467041
Epoch: 14, Steps: 13 | Train Loss: 0.432 Vali Loss: 17.061 Vali Acc: 0.450 Test Loss: 17.061 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.350618600845337
Epoch: 15, Steps: 13 | Train Loss: 0.332 Vali Loss: 15.610 Vali Acc: 0.467 Test Loss: 15.610 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.535076379776001
Epoch: 16, Steps: 13 | Train Loss: 0.428 Vali Loss: 13.241 Vali Acc: 0.461 Test Loss: 13.241 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 13.98595142364502
Epoch: 17, Steps: 13 | Train Loss: 0.308 Vali Loss: 15.085 Vali Acc: 0.461 Test Loss: 15.085 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 13.05519413948059
Epoch: 18, Steps: 13 | Train Loss: 1.061 Vali Loss: 21.903 Vali Acc: 0.528 Test Loss: 21.903 Test Acc: 0.528
Validation loss decreased (-0.522139 --> -0.527559).  Saving model ...
Epoch: 19 cost time: 12.820488214492798
Epoch: 19, Steps: 13 | Train Loss: 1.183 Vali Loss: 18.051 Vali Acc: 0.467 Test Loss: 18.051 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.326990127563477
Epoch: 20, Steps: 13 | Train Loss: 0.670 Vali Loss: 17.916 Vali Acc: 0.461 Test Loss: 17.916 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 11.275803327560425
Epoch: 21, Steps: 13 | Train Loss: 0.459 Vali Loss: 18.905 Vali Acc: 0.461 Test Loss: 18.905 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 10.78093695640564
Epoch: 22, Steps: 13 | Train Loss: 0.203 Vali Loss: 20.096 Vali Acc: 0.472 Test Loss: 20.096 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 10.407278537750244
Epoch: 23, Steps: 13 | Train Loss: 0.839 Vali Loss: 23.972 Vali Acc: 0.467 Test Loss: 23.972 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 12.303394556045532
Epoch: 24, Steps: 13 | Train Loss: 0.386 Vali Loss: 19.575 Vali Acc: 0.461 Test Loss: 19.575 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 13.7887282371521
Epoch: 25, Steps: 13 | Train Loss: 0.354 Vali Loss: 21.376 Vali Acc: 0.467 Test Loss: 21.376 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 13.482338428497314
Epoch: 26, Steps: 13 | Train Loss: 0.777 Vali Loss: 19.550 Vali Acc: 0.472 Test Loss: 19.550 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 13.885624885559082
Epoch: 27, Steps: 13 | Train Loss: 0.671 Vali Loss: 22.984 Vali Acc: 0.506 Test Loss: 22.984 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 13.967775106430054
Epoch: 28, Steps: 13 | Train Loss: 0.689 Vali Loss: 25.699 Vali Acc: 0.478 Test Loss: 25.699 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 13274114
model size : 70.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 13.910034418106079
Epoch: 1, Steps: 13 | Train Loss: 0.792 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 13.046462059020996
Epoch: 2, Steps: 13 | Train Loss: 1.063 Vali Loss: 1.145 Vali Acc: 0.522 Test Loss: 1.145 Test Acc: 0.522
Validation loss decreased (-0.499987 --> -0.522211).  Saving model ...
Epoch: 3 cost time: 11.280941009521484
Epoch: 3, Steps: 13 | Train Loss: 0.697 Vali Loss: 1.868 Vali Acc: 0.511 Test Loss: 1.868 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.204093217849731
Epoch: 4, Steps: 13 | Train Loss: 0.567 Vali Loss: 2.169 Vali Acc: 0.533 Test Loss: 2.169 Test Acc: 0.533
Validation loss decreased (-0.522211 --> -0.533312).  Saving model ...
Epoch: 5 cost time: 13.571887254714966
Epoch: 5, Steps: 13 | Train Loss: 0.589 Vali Loss: 2.714 Vali Acc: 0.533 Test Loss: 2.714 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.667331457138062
Epoch: 6, Steps: 13 | Train Loss: 0.630 Vali Loss: 2.603 Vali Acc: 0.567 Test Loss: 2.603 Test Acc: 0.567
Validation loss decreased (-0.533312 --> -0.566641).  Saving model ...
Epoch: 7 cost time: 12.895328283309937
Epoch: 7, Steps: 13 | Train Loss: 0.517 Vali Loss: 2.782 Vali Acc: 0.544 Test Loss: 2.782 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.685700178146362
Epoch: 8, Steps: 13 | Train Loss: 0.459 Vali Loss: 3.450 Vali Acc: 0.533 Test Loss: 3.450 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.988935470581055
Epoch: 9, Steps: 13 | Train Loss: 0.394 Vali Loss: 4.587 Vali Acc: 0.567 Test Loss: 4.587 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.515421867370605
Epoch: 10, Steps: 13 | Train Loss: 1.009 Vali Loss: 4.567 Vali Acc: 0.550 Test Loss: 4.567 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.900384426116943
Epoch: 11, Steps: 13 | Train Loss: 1.146 Vali Loss: 6.935 Vali Acc: 0.517 Test Loss: 6.935 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.541870832443237
Epoch: 12, Steps: 13 | Train Loss: 1.826 Vali Loss: 6.107 Vali Acc: 0.533 Test Loss: 6.107 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.661483526229858
Epoch: 13, Steps: 13 | Train Loss: 0.792 Vali Loss: 7.105 Vali Acc: 0.517 Test Loss: 7.105 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.628929138183594
Epoch: 14, Steps: 13 | Train Loss: 0.792 Vali Loss: 10.040 Vali Acc: 0.489 Test Loss: 10.040 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.878135204315186
Epoch: 15, Steps: 13 | Train Loss: 0.626 Vali Loss: 7.660 Vali Acc: 0.533 Test Loss: 7.660 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.20004916191101
Epoch: 16, Steps: 13 | Train Loss: 0.406 Vali Loss: 8.811 Vali Acc: 0.567 Test Loss: 8.811 Test Acc: 0.567
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 13274114
model size : 70.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 12.651955366134644
Epoch: 1, Steps: 13 | Train Loss: 0.764 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 11.306585550308228
Epoch: 2, Steps: 13 | Train Loss: 1.042 Vali Loss: 2.151 Vali Acc: 0.511 Test Loss: 2.151 Test Acc: 0.511
Validation loss decreased (-0.499988 --> -0.511090).  Saving model ...
Epoch: 3 cost time: 11.162719964981079
Epoch: 3, Steps: 13 | Train Loss: 0.966 Vali Loss: 2.084 Vali Acc: 0.539 Test Loss: 2.084 Test Acc: 0.539
Validation loss decreased (-0.511090 --> -0.538868).  Saving model ...
Epoch: 4 cost time: 13.430936574935913
Epoch: 4, Steps: 13 | Train Loss: 0.714 Vali Loss: 1.818 Vali Acc: 0.528 Test Loss: 1.818 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.999082803726196
Epoch: 5, Steps: 13 | Train Loss: 0.692 Vali Loss: 2.824 Vali Acc: 0.539 Test Loss: 2.824 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.593500137329102
Epoch: 6, Steps: 13 | Train Loss: 0.773 Vali Loss: 3.996 Vali Acc: 0.494 Test Loss: 3.996 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.587098836898804
Epoch: 7, Steps: 13 | Train Loss: 0.992 Vali Loss: 2.905 Vali Acc: 0.489 Test Loss: 2.905 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.9939444065094
Epoch: 8, Steps: 13 | Train Loss: 1.197 Vali Loss: 3.546 Vali Acc: 0.517 Test Loss: 3.546 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.137963056564331
Epoch: 9, Steps: 13 | Train Loss: 0.544 Vali Loss: 5.768 Vali Acc: 0.506 Test Loss: 5.768 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.824002027511597
Epoch: 10, Steps: 13 | Train Loss: 0.998 Vali Loss: 4.531 Vali Acc: 0.567 Test Loss: 4.531 Test Acc: 0.567
Validation loss decreased (-0.538868 --> -0.566621).  Saving model ...
Epoch: 11 cost time: 11.77712368965149
Epoch: 11, Steps: 13 | Train Loss: 0.925 Vali Loss: 4.217 Vali Acc: 0.528 Test Loss: 4.217 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.184354066848755
Epoch: 12, Steps: 13 | Train Loss: 0.750 Vali Loss: 8.295 Vali Acc: 0.478 Test Loss: 8.295 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.064537286758423
Epoch: 13, Steps: 13 | Train Loss: 0.622 Vali Loss: 4.387 Vali Acc: 0.528 Test Loss: 4.387 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.209646463394165
Epoch: 14, Steps: 13 | Train Loss: 0.486 Vali Loss: 5.084 Vali Acc: 0.539 Test Loss: 5.084 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.326892375946045
Epoch: 15, Steps: 13 | Train Loss: 0.625 Vali Loss: 6.078 Vali Acc: 0.522 Test Loss: 6.078 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.70899772644043
Epoch: 16, Steps: 13 | Train Loss: 0.631 Vali Loss: 6.041 Vali Acc: 0.528 Test Loss: 6.041 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.111286640167236
Epoch: 17, Steps: 13 | Train Loss: 0.744 Vali Loss: 5.334 Vali Acc: 0.539 Test Loss: 5.334 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.464690685272217
Epoch: 18, Steps: 13 | Train Loss: 0.659 Vali Loss: 9.261 Vali Acc: 0.544 Test Loss: 9.261 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.379359245300293
Epoch: 19, Steps: 13 | Train Loss: 1.488 Vali Loss: 4.878 Vali Acc: 0.578 Test Loss: 4.878 Test Acc: 0.578
Validation loss decreased (-0.566621 --> -0.577729).  Saving model ...
Epoch: 20 cost time: 12.982081651687622
Epoch: 20, Steps: 13 | Train Loss: 1.893 Vali Loss: 4.775 Vali Acc: 0.489 Test Loss: 4.775 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 12.144237279891968
Epoch: 21, Steps: 13 | Train Loss: 1.197 Vali Loss: 6.729 Vali Acc: 0.589 Test Loss: 6.729 Test Acc: 0.589
Validation loss decreased (-0.577729 --> -0.588822).  Saving model ...
Epoch: 22 cost time: 12.793868064880371
Epoch: 22, Steps: 13 | Train Loss: 1.125 Vali Loss: 13.630 Vali Acc: 0.511 Test Loss: 13.630 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 12.06834864616394
Epoch: 23, Steps: 13 | Train Loss: 2.649 Vali Loss: 11.602 Vali Acc: 0.522 Test Loss: 11.602 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 12.895680904388428
Epoch: 24, Steps: 13 | Train Loss: 1.416 Vali Loss: 8.145 Vali Acc: 0.528 Test Loss: 8.145 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 13.201603889465332
Epoch: 25, Steps: 13 | Train Loss: 0.575 Vali Loss: 5.418 Vali Acc: 0.539 Test Loss: 5.418 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 13.260315179824829
Epoch: 26, Steps: 13 | Train Loss: 0.913 Vali Loss: 9.989 Vali Acc: 0.517 Test Loss: 9.989 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 11.514809131622314
Epoch: 27, Steps: 13 | Train Loss: 1.550 Vali Loss: 8.065 Vali Acc: 0.578 Test Loss: 8.065 Test Acc: 0.578
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 10.23073410987854
Epoch: 28, Steps: 13 | Train Loss: 3.132 Vali Loss: 20.840 Vali Acc: 0.539 Test Loss: 20.840 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 11.395110607147217
Epoch: 29, Steps: 13 | Train Loss: 3.013 Vali Loss: 8.127 Vali Acc: 0.583 Test Loss: 8.127 Test Acc: 0.583
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 11.894695281982422
Epoch: 30, Steps: 13 | Train Loss: 0.959 Vali Loss: 14.514 Vali Acc: 0.544 Test Loss: 14.514 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 11.887450695037842
Epoch: 31, Steps: 13 | Train Loss: 2.675 Vali Loss: 9.659 Vali Acc: 0.528 Test Loss: 9.659 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 13274114
model size : 70.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 27.608718395233154
Epoch: 1, Steps: 13 | Train Loss: 0.826 Vali Loss: 1.148 Vali Acc: 0.506 Test Loss: 1.148 Test Acc: 0.506
Validation loss decreased (inf --> -0.505544).  Saving model ...
Epoch: 2 cost time: 24.997828722000122
Epoch: 2, Steps: 13 | Train Loss: 0.845 Vali Loss: 2.068 Vali Acc: 0.494 Test Loss: 2.068 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.430280447006226
Epoch: 3, Steps: 13 | Train Loss: 1.082 Vali Loss: 4.664 Vali Acc: 0.472 Test Loss: 4.664 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 25.60026454925537
Epoch: 4, Steps: 13 | Train Loss: 0.960 Vali Loss: 4.712 Vali Acc: 0.506 Test Loss: 4.712 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 21.287626028060913
Epoch: 5, Steps: 13 | Train Loss: 1.344 Vali Loss: 8.145 Vali Acc: 0.494 Test Loss: 8.145 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 25.90386176109314
Epoch: 6, Steps: 13 | Train Loss: 2.529 Vali Loss: 5.629 Vali Acc: 0.517 Test Loss: 5.629 Test Acc: 0.517
Validation loss decreased (-0.505544 --> -0.516610).  Saving model ...
Epoch: 7 cost time: 23.558407068252563
Epoch: 7, Steps: 13 | Train Loss: 0.367 Vali Loss: 5.997 Vali Acc: 0.478 Test Loss: 5.997 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 26.563379764556885
Epoch: 8, Steps: 13 | Train Loss: 0.292 Vali Loss: 6.737 Vali Acc: 0.500 Test Loss: 6.737 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 25.501379251480103
Epoch: 9, Steps: 13 | Train Loss: 1.122 Vali Loss: 8.463 Vali Acc: 0.500 Test Loss: 8.463 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.45787763595581
Epoch: 10, Steps: 13 | Train Loss: 0.758 Vali Loss: 12.730 Vali Acc: 0.500 Test Loss: 12.730 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 25.104521989822388
Epoch: 11, Steps: 13 | Train Loss: 1.270 Vali Loss: 10.081 Vali Acc: 0.483 Test Loss: 10.081 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 28.6029372215271
Epoch: 12, Steps: 13 | Train Loss: 1.484 Vali Loss: 16.026 Vali Acc: 0.522 Test Loss: 16.026 Test Acc: 0.522
Validation loss decreased (-0.516610 --> -0.522062).  Saving model ...
Epoch: 13 cost time: 26.660727977752686
Epoch: 13, Steps: 13 | Train Loss: 1.005 Vali Loss: 13.401 Vali Acc: 0.467 Test Loss: 13.401 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.694710969924927
Epoch: 14, Steps: 13 | Train Loss: 0.434 Vali Loss: 12.969 Vali Acc: 0.461 Test Loss: 12.969 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 22.185158252716064
Epoch: 15, Steps: 13 | Train Loss: 0.691 Vali Loss: 17.295 Vali Acc: 0.494 Test Loss: 17.295 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 27.66614532470703
Epoch: 16, Steps: 13 | Train Loss: 0.858 Vali Loss: 14.997 Vali Acc: 0.461 Test Loss: 14.997 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 29.736205577850342
Epoch: 17, Steps: 13 | Train Loss: 0.417 Vali Loss: 17.270 Vali Acc: 0.472 Test Loss: 17.270 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 29.332918882369995
Epoch: 18, Steps: 13 | Train Loss: 0.472 Vali Loss: 17.177 Vali Acc: 0.472 Test Loss: 17.177 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 28.32758116722107
Epoch: 19, Steps: 13 | Train Loss: 1.180 Vali Loss: 29.350 Vali Acc: 0.533 Test Loss: 29.350 Test Acc: 0.533
Validation loss decreased (-0.522062 --> -0.533040).  Saving model ...
Epoch: 20 cost time: 30.95676851272583
Epoch: 20, Steps: 13 | Train Loss: 2.627 Vali Loss: 20.841 Vali Acc: 0.511 Test Loss: 20.841 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 31.1275475025177
Epoch: 21, Steps: 13 | Train Loss: 0.544 Vali Loss: 21.725 Vali Acc: 0.506 Test Loss: 21.725 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 32.148656606674194
Epoch: 22, Steps: 13 | Train Loss: 0.531 Vali Loss: 24.472 Vali Acc: 0.522 Test Loss: 24.472 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 27.55415105819702
Epoch: 23, Steps: 13 | Train Loss: 0.568 Vali Loss: 23.481 Vali Acc: 0.467 Test Loss: 23.481 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 28.97957134246826
Epoch: 24, Steps: 13 | Train Loss: 0.165 Vali Loss: 23.508 Vali Acc: 0.433 Test Loss: 23.508 Test Acc: 0.433
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 32.585784912109375
Epoch: 25, Steps: 13 | Train Loss: 0.664 Vali Loss: 22.791 Vali Acc: 0.494 Test Loss: 22.791 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 34.44967985153198
Epoch: 26, Steps: 13 | Train Loss: 0.567 Vali Loss: 29.770 Vali Acc: 0.456 Test Loss: 29.770 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 29.85070490837097
Epoch: 27, Steps: 13 | Train Loss: 0.359 Vali Loss: 28.646 Vali Acc: 0.494 Test Loss: 28.646 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 33.137964487075806
Epoch: 28, Steps: 13 | Train Loss: 0.221 Vali Loss: 29.616 Vali Acc: 0.522 Test Loss: 29.616 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 34.441532373428345
Epoch: 29, Steps: 13 | Train Loss: 0.439 Vali Loss: 28.366 Vali Acc: 0.494 Test Loss: 28.366 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 12487682
model size : 67.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 21.61870503425598
Epoch: 1, Steps: 13 | Train Loss: 0.835 Vali Loss: 1.421 Vali Acc: 0.533 Test Loss: 1.421 Test Acc: 0.533
Validation loss decreased (inf --> -0.533319).  Saving model ...
Epoch: 2 cost time: 12.043968677520752
Epoch: 2, Steps: 13 | Train Loss: 1.010 Vali Loss: 2.866 Vali Acc: 0.544 Test Loss: 2.866 Test Acc: 0.544
Validation loss decreased (-0.533319 --> -0.544416).  Saving model ...
Epoch: 3 cost time: 19.851723670959473
Epoch: 3, Steps: 13 | Train Loss: 1.292 Vali Loss: 4.382 Vali Acc: 0.511 Test Loss: 4.382 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.734208822250366
Epoch: 4, Steps: 13 | Train Loss: 1.359 Vali Loss: 3.845 Vali Acc: 0.528 Test Loss: 3.845 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.41520881652832
Epoch: 5, Steps: 13 | Train Loss: 0.777 Vali Loss: 4.514 Vali Acc: 0.489 Test Loss: 4.514 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 22.712740182876587
Epoch: 6, Steps: 13 | Train Loss: 0.522 Vali Loss: 7.374 Vali Acc: 0.478 Test Loss: 7.374 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 20.849481344223022
Epoch: 7, Steps: 13 | Train Loss: 1.071 Vali Loss: 8.717 Vali Acc: 0.450 Test Loss: 8.717 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 20.785422325134277
Epoch: 8, Steps: 13 | Train Loss: 1.167 Vali Loss: 8.967 Vali Acc: 0.472 Test Loss: 8.967 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 22.01684045791626
Epoch: 9, Steps: 13 | Train Loss: 0.485 Vali Loss: 9.190 Vali Acc: 0.483 Test Loss: 9.190 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 22.185752630233765
Epoch: 10, Steps: 13 | Train Loss: 0.550 Vali Loss: 12.656 Vali Acc: 0.456 Test Loss: 12.656 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 22.249107360839844
Epoch: 11, Steps: 13 | Train Loss: 0.972 Vali Loss: 15.031 Vali Acc: 0.467 Test Loss: 15.031 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 21.966217517852783
Epoch: 12, Steps: 13 | Train Loss: 1.709 Vali Loss: 13.482 Vali Acc: 0.428 Test Loss: 13.482 Test Acc: 0.428
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 12487682
model size : 67.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 21.191019773483276
Epoch: 1, Steps: 13 | Train Loss: 0.817 Vali Loss: 1.444 Vali Acc: 0.500 Test Loss: 1.444 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 20.643423318862915
Epoch: 2, Steps: 13 | Train Loss: 0.926 Vali Loss: 3.926 Vali Acc: 0.522 Test Loss: 3.926 Test Acc: 0.522
Validation loss decreased (-0.499986 --> -0.522183).  Saving model ...
Epoch: 3 cost time: 20.07162857055664
Epoch: 3, Steps: 13 | Train Loss: 1.453 Vali Loss: 5.103 Vali Acc: 0.522 Test Loss: 5.103 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.00521183013916
Epoch: 4, Steps: 13 | Train Loss: 1.208 Vali Loss: 3.723 Vali Acc: 0.500 Test Loss: 3.723 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.76248812675476
Epoch: 5, Steps: 13 | Train Loss: 1.683 Vali Loss: 9.540 Vali Acc: 0.478 Test Loss: 9.540 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 19.903346300125122
Epoch: 6, Steps: 13 | Train Loss: 2.908 Vali Loss: 5.846 Vali Acc: 0.539 Test Loss: 5.846 Test Acc: 0.539
Validation loss decreased (-0.522183 --> -0.538830).  Saving model ...
Epoch: 7 cost time: 19.82947063446045
Epoch: 7, Steps: 13 | Train Loss: 1.610 Vali Loss: 6.951 Vali Acc: 0.383 Test Loss: 6.951 Test Acc: 0.383
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.251260995864868
Epoch: 8, Steps: 13 | Train Loss: 0.823 Vali Loss: 7.910 Vali Acc: 0.467 Test Loss: 7.910 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.35831332206726
Epoch: 9, Steps: 13 | Train Loss: 1.104 Vali Loss: 9.367 Vali Acc: 0.494 Test Loss: 9.367 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.580384254455566
Epoch: 10, Steps: 13 | Train Loss: 0.517 Vali Loss: 9.864 Vali Acc: 0.489 Test Loss: 9.864 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 21.47762393951416
Epoch: 11, Steps: 13 | Train Loss: 0.970 Vali Loss: 12.130 Vali Acc: 0.500 Test Loss: 12.130 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 20.632277011871338
Epoch: 12, Steps: 13 | Train Loss: 1.064 Vali Loss: 12.008 Vali Acc: 0.511 Test Loss: 12.008 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 18.031749963760376
Epoch: 13, Steps: 13 | Train Loss: 0.632 Vali Loss: 13.815 Vali Acc: 0.517 Test Loss: 13.815 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 18.809094429016113
Epoch: 14, Steps: 13 | Train Loss: 0.550 Vali Loss: 13.679 Vali Acc: 0.444 Test Loss: 13.679 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 19.394500494003296
Epoch: 15, Steps: 13 | Train Loss: 0.222 Vali Loss: 13.768 Vali Acc: 0.489 Test Loss: 13.768 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 23.920522212982178
Epoch: 16, Steps: 13 | Train Loss: 0.838 Vali Loss: 14.975 Vali Acc: 0.522 Test Loss: 14.975 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 12487682
model size : 67.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 20.751814365386963
Epoch: 1, Steps: 13 | Train Loss: 0.868 Vali Loss: 1.743 Vali Acc: 0.511 Test Loss: 1.743 Test Acc: 0.511
Validation loss decreased (inf --> -0.511094).  Saving model ...
Epoch: 2 cost time: 18.632384300231934
Epoch: 2, Steps: 13 | Train Loss: 0.712 Vali Loss: 1.793 Vali Acc: 0.533 Test Loss: 1.793 Test Acc: 0.533
Validation loss decreased (-0.511094 --> -0.533315).  Saving model ...
Epoch: 3 cost time: 16.140419721603394
Epoch: 3, Steps: 13 | Train Loss: 0.806 Vali Loss: 2.988 Vali Acc: 0.478 Test Loss: 2.988 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.749975204467773
Epoch: 4, Steps: 13 | Train Loss: 0.868 Vali Loss: 3.815 Vali Acc: 0.467 Test Loss: 3.815 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.184789419174194
Epoch: 5, Steps: 13 | Train Loss: 0.799 Vali Loss: 5.494 Vali Acc: 0.489 Test Loss: 5.494 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 19.630655527114868
Epoch: 6, Steps: 13 | Train Loss: 0.818 Vali Loss: 4.997 Vali Acc: 0.483 Test Loss: 4.997 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 18.168246269226074
Epoch: 7, Steps: 13 | Train Loss: 0.418 Vali Loss: 6.079 Vali Acc: 0.483 Test Loss: 6.079 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 18.911802053451538
Epoch: 8, Steps: 13 | Train Loss: 0.582 Vali Loss: 7.301 Vali Acc: 0.439 Test Loss: 7.301 Test Acc: 0.439
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 18.093376398086548
Epoch: 9, Steps: 13 | Train Loss: 0.611 Vali Loss: 8.431 Vali Acc: 0.456 Test Loss: 8.431 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 17.041815042495728
Epoch: 10, Steps: 13 | Train Loss: 0.747 Vali Loss: 10.058 Vali Acc: 0.533 Test Loss: 10.058 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 16.998017072677612
Epoch: 11, Steps: 13 | Train Loss: 1.417 Vali Loss: 12.901 Vali Acc: 0.494 Test Loss: 12.901 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 20.4723002910614
Epoch: 12, Steps: 13 | Train Loss: 1.501 Vali Loss: 13.796 Vali Acc: 0.483 Test Loss: 13.796 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 12487682
model size : 67.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 16.982244729995728
Epoch: 1, Steps: 13 | Train Loss: 0.863 Vali Loss: 1.294 Vali Acc: 0.522 Test Loss: 1.294 Test Acc: 0.522
Validation loss decreased (inf --> -0.522209).  Saving model ...
Epoch: 2 cost time: 14.104640245437622
Epoch: 2, Steps: 13 | Train Loss: 0.880 Vali Loss: 3.406 Vali Acc: 0.517 Test Loss: 3.406 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.171507835388184
Epoch: 3, Steps: 13 | Train Loss: 0.925 Vali Loss: 3.157 Vali Acc: 0.500 Test Loss: 3.157 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.004183769226074
Epoch: 4, Steps: 13 | Train Loss: 0.474 Vali Loss: 4.054 Vali Acc: 0.544 Test Loss: 4.054 Test Acc: 0.544
Validation loss decreased (-0.522209 --> -0.544404).  Saving model ...
Epoch: 5 cost time: 14.804999828338623
Epoch: 5, Steps: 13 | Train Loss: 1.667 Vali Loss: 4.594 Vali Acc: 0.506 Test Loss: 4.594 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.914899587631226
Epoch: 6, Steps: 13 | Train Loss: 0.453 Vali Loss: 5.474 Vali Acc: 0.494 Test Loss: 5.474 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.533973693847656
Epoch: 7, Steps: 13 | Train Loss: 0.267 Vali Loss: 6.121 Vali Acc: 0.533 Test Loss: 6.121 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 16.890403747558594
Epoch: 8, Steps: 13 | Train Loss: 1.192 Vali Loss: 10.195 Vali Acc: 0.556 Test Loss: 10.195 Test Acc: 0.556
Validation loss decreased (-0.544404 --> -0.555454).  Saving model ...
Epoch: 9 cost time: 15.071478605270386
Epoch: 9, Steps: 13 | Train Loss: 1.314 Vali Loss: 8.479 Vali Acc: 0.528 Test Loss: 8.479 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.20856499671936
Epoch: 10, Steps: 13 | Train Loss: 0.607 Vali Loss: 13.010 Vali Acc: 0.517 Test Loss: 13.010 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.875244379043579
Epoch: 11, Steps: 13 | Train Loss: 1.006 Vali Loss: 10.457 Vali Acc: 0.511 Test Loss: 10.457 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.950212240219116
Epoch: 12, Steps: 13 | Train Loss: 0.323 Vali Loss: 11.166 Vali Acc: 0.489 Test Loss: 11.166 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 15.993601560592651
Epoch: 13, Steps: 13 | Train Loss: 0.611 Vali Loss: 14.294 Vali Acc: 0.517 Test Loss: 14.294 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 16.355895280838013
Epoch: 14, Steps: 13 | Train Loss: 1.055 Vali Loss: 13.163 Vali Acc: 0.522 Test Loss: 13.163 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 14.388173818588257
Epoch: 15, Steps: 13 | Train Loss: 0.218 Vali Loss: 14.532 Vali Acc: 0.494 Test Loss: 14.532 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 15.99086046218872
Epoch: 16, Steps: 13 | Train Loss: 0.447 Vali Loss: 16.237 Vali Acc: 0.500 Test Loss: 16.237 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 14.451034307479858
Epoch: 17, Steps: 13 | Train Loss: 0.563 Vali Loss: 21.043 Vali Acc: 0.500 Test Loss: 21.043 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 15.597339391708374
Epoch: 18, Steps: 13 | Train Loss: 0.698 Vali Loss: 18.111 Vali Acc: 0.506 Test Loss: 18.111 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 12487682
model size : 67.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 15.774103164672852
Epoch: 1, Steps: 13 | Train Loss: 0.801 Vali Loss: 1.148 Vali Acc: 0.494 Test Loss: 1.148 Test Acc: 0.494
Validation loss decreased (inf --> -0.494433).  Saving model ...
Epoch: 2 cost time: 14.135606527328491
Epoch: 2, Steps: 13 | Train Loss: 0.826 Vali Loss: 3.702 Vali Acc: 0.500 Test Loss: 3.702 Test Acc: 0.500
Validation loss decreased (-0.494433 --> -0.499963).  Saving model ...
Epoch: 3 cost time: 12.625479221343994
Epoch: 3, Steps: 13 | Train Loss: 1.319 Vali Loss: 3.424 Vali Acc: 0.494 Test Loss: 3.424 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.223472118377686
Epoch: 4, Steps: 13 | Train Loss: 0.450 Vali Loss: 3.752 Vali Acc: 0.478 Test Loss: 3.752 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.798083543777466
Epoch: 5, Steps: 13 | Train Loss: 0.990 Vali Loss: 5.600 Vali Acc: 0.522 Test Loss: 5.600 Test Acc: 0.522
Validation loss decreased (-0.499963 --> -0.522166).  Saving model ...
Epoch: 6 cost time: 13.181461811065674
Epoch: 6, Steps: 13 | Train Loss: 1.201 Vali Loss: 5.290 Vali Acc: 0.483 Test Loss: 5.290 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.557523488998413
Epoch: 7, Steps: 13 | Train Loss: 0.643 Vali Loss: 5.633 Vali Acc: 0.461 Test Loss: 5.633 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.94979214668274
Epoch: 8, Steps: 13 | Train Loss: 0.678 Vali Loss: 7.012 Vali Acc: 0.489 Test Loss: 7.012 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.125250101089478
Epoch: 9, Steps: 13 | Train Loss: 0.199 Vali Loss: 7.756 Vali Acc: 0.489 Test Loss: 7.756 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.830159187316895
Epoch: 10, Steps: 13 | Train Loss: 0.568 Vali Loss: 11.080 Vali Acc: 0.517 Test Loss: 11.080 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 14.267834186553955
Epoch: 11, Steps: 13 | Train Loss: 1.101 Vali Loss: 9.405 Vali Acc: 0.456 Test Loss: 9.405 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.915471076965332
Epoch: 12, Steps: 13 | Train Loss: 0.931 Vali Loss: 11.119 Vali Acc: 0.467 Test Loss: 11.119 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.041034460067749
Epoch: 13, Steps: 13 | Train Loss: 0.274 Vali Loss: 11.638 Vali Acc: 0.478 Test Loss: 11.638 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.622899532318115
Epoch: 14, Steps: 13 | Train Loss: 0.387 Vali Loss: 12.849 Vali Acc: 0.517 Test Loss: 12.849 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.879626989364624
Epoch: 15, Steps: 13 | Train Loss: 0.741 Vali Loss: 14.500 Vali Acc: 0.467 Test Loss: 14.500 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 12487682
model size : 67.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 14.723981618881226
Epoch: 1, Steps: 13 | Train Loss: 0.846 Vali Loss: 1.381 Vali Acc: 0.461 Test Loss: 1.381 Test Acc: 0.461
Validation loss decreased (inf --> -0.461097).  Saving model ...
Epoch: 2 cost time: 14.313848733901978
Epoch: 2, Steps: 13 | Train Loss: 1.038 Vali Loss: 2.489 Vali Acc: 0.478 Test Loss: 2.489 Test Acc: 0.478
Validation loss decreased (-0.461097 --> -0.477753).  Saving model ...
Epoch: 3 cost time: 12.881146669387817
Epoch: 3, Steps: 13 | Train Loss: 0.948 Vali Loss: 2.590 Vali Acc: 0.500 Test Loss: 2.590 Test Acc: 0.500
Validation loss decreased (-0.477753 --> -0.499974).  Saving model ...
Epoch: 4 cost time: 12.883311748504639
Epoch: 4, Steps: 13 | Train Loss: 0.892 Vali Loss: 3.203 Vali Acc: 0.489 Test Loss: 3.203 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.551503658294678
Epoch: 5, Steps: 13 | Train Loss: 1.039 Vali Loss: 5.836 Vali Acc: 0.483 Test Loss: 5.836 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.932902336120605
Epoch: 6, Steps: 13 | Train Loss: 1.130 Vali Loss: 4.576 Vali Acc: 0.472 Test Loss: 4.576 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.518662214279175
Epoch: 7, Steps: 13 | Train Loss: 1.049 Vali Loss: 5.826 Vali Acc: 0.506 Test Loss: 5.826 Test Acc: 0.506
Validation loss decreased (-0.499974 --> -0.505497).  Saving model ...
Epoch: 8 cost time: 13.49644923210144
Epoch: 8, Steps: 13 | Train Loss: 0.913 Vali Loss: 6.338 Vali Acc: 0.494 Test Loss: 6.338 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.123044490814209
Epoch: 9, Steps: 13 | Train Loss: 0.780 Vali Loss: 6.657 Vali Acc: 0.467 Test Loss: 6.657 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.751082181930542
Epoch: 10, Steps: 13 | Train Loss: 1.073 Vali Loss: 7.365 Vali Acc: 0.500 Test Loss: 7.365 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.638808488845825
Epoch: 11, Steps: 13 | Train Loss: 1.055 Vali Loss: 8.932 Vali Acc: 0.467 Test Loss: 8.932 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.942838668823242
Epoch: 12, Steps: 13 | Train Loss: 0.512 Vali Loss: 11.859 Vali Acc: 0.450 Test Loss: 11.859 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.192790508270264
Epoch: 13, Steps: 13 | Train Loss: 1.246 Vali Loss: 11.350 Vali Acc: 0.472 Test Loss: 11.350 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.545011758804321
Epoch: 14, Steps: 13 | Train Loss: 1.162 Vali Loss: 11.029 Vali Acc: 0.489 Test Loss: 11.029 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.046257495880127
Epoch: 15, Steps: 13 | Train Loss: 0.940 Vali Loss: 12.392 Vali Acc: 0.478 Test Loss: 12.392 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.160027027130127
Epoch: 16, Steps: 13 | Train Loss: 1.068 Vali Loss: 12.172 Vali Acc: 0.483 Test Loss: 12.172 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.925359725952148
Epoch: 17, Steps: 13 | Train Loss: 0.427 Vali Loss: 13.374 Vali Acc: 0.494 Test Loss: 13.374 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5055555555555555
model parameter : 12487682
model size : 67.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 15.360406398773193
Epoch: 1, Steps: 13 | Train Loss: 0.808 Vali Loss: 1.420 Vali Acc: 0.467 Test Loss: 1.420 Test Acc: 0.467
Validation loss decreased (inf --> -0.466652).  Saving model ...
Epoch: 2 cost time: 12.729642152786255
Epoch: 2, Steps: 13 | Train Loss: 0.660 Vali Loss: 1.944 Vali Acc: 0.494 Test Loss: 1.944 Test Acc: 0.494
Validation loss decreased (-0.466652 --> -0.494425).  Saving model ...
Epoch: 3 cost time: 12.794030904769897
Epoch: 3, Steps: 13 | Train Loss: 0.742 Vali Loss: 3.126 Vali Acc: 0.494 Test Loss: 3.126 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.786677360534668
Epoch: 4, Steps: 13 | Train Loss: 0.951 Vali Loss: 4.255 Vali Acc: 0.472 Test Loss: 4.255 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.971630096435547
Epoch: 5, Steps: 13 | Train Loss: 0.852 Vali Loss: 5.708 Vali Acc: 0.483 Test Loss: 5.708 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.094642400741577
Epoch: 6, Steps: 13 | Train Loss: 1.084 Vali Loss: 7.048 Vali Acc: 0.517 Test Loss: 7.048 Test Acc: 0.517
Validation loss decreased (-0.494425 --> -0.516596).  Saving model ...
Epoch: 7 cost time: 11.917480945587158
Epoch: 7, Steps: 13 | Train Loss: 0.964 Vali Loss: 6.642 Vali Acc: 0.494 Test Loss: 6.642 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.271148204803467
Epoch: 8, Steps: 13 | Train Loss: 0.756 Vali Loss: 6.361 Vali Acc: 0.467 Test Loss: 6.361 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.628087043762207
Epoch: 9, Steps: 13 | Train Loss: 0.941 Vali Loss: 8.025 Vali Acc: 0.494 Test Loss: 8.025 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.519271612167358
Epoch: 10, Steps: 13 | Train Loss: 1.285 Vali Loss: 9.646 Vali Acc: 0.494 Test Loss: 9.646 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.489576816558838
Epoch: 11, Steps: 13 | Train Loss: 0.836 Vali Loss: 11.654 Vali Acc: 0.444 Test Loss: 11.654 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.927781343460083
Epoch: 12, Steps: 13 | Train Loss: 0.571 Vali Loss: 10.547 Vali Acc: 0.467 Test Loss: 10.547 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.103724002838135
Epoch: 13, Steps: 13 | Train Loss: 0.636 Vali Loss: 11.640 Vali Acc: 0.489 Test Loss: 11.640 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.7040696144104
Epoch: 14, Steps: 13 | Train Loss: 0.699 Vali Loss: 11.072 Vali Acc: 0.494 Test Loss: 11.072 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.903855085372925
Epoch: 15, Steps: 13 | Train Loss: 0.545 Vali Loss: 11.690 Vali Acc: 0.511 Test Loss: 11.690 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.466328859329224
Epoch: 16, Steps: 13 | Train Loss: 0.697 Vali Loss: 12.736 Vali Acc: 0.472 Test Loss: 12.736 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 12487682
model size : 67.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 13.526716470718384
Epoch: 1, Steps: 13 | Train Loss: 0.760 Vali Loss: 1.346 Vali Acc: 0.500 Test Loss: 1.346 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 12.155202150344849
Epoch: 2, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.920 Vali Acc: 0.556 Test Loss: 0.920 Test Acc: 0.556
Validation loss decreased (-0.499987 --> -0.555546).  Saving model ...
Epoch: 3 cost time: 8.48986005783081
Epoch: 3, Steps: 13 | Train Loss: 0.424 Vali Loss: 1.263 Vali Acc: 0.561 Test Loss: 1.263 Test Acc: 0.561
Validation loss decreased (-0.555546 --> -0.561098).  Saving model ...
Epoch: 4 cost time: 9.930437326431274
Epoch: 4, Steps: 13 | Train Loss: 0.622 Vali Loss: 2.177 Vali Acc: 0.483 Test Loss: 2.177 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.85644793510437
Epoch: 5, Steps: 13 | Train Loss: 0.399 Vali Loss: 2.717 Vali Acc: 0.539 Test Loss: 2.717 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.550122737884521
Epoch: 6, Steps: 13 | Train Loss: 0.406 Vali Loss: 2.163 Vali Acc: 0.528 Test Loss: 2.163 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.727656364440918
Epoch: 7, Steps: 13 | Train Loss: 0.186 Vali Loss: 3.433 Vali Acc: 0.561 Test Loss: 3.433 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.617485046386719
Epoch: 8, Steps: 13 | Train Loss: 0.432 Vali Loss: 3.451 Vali Acc: 0.528 Test Loss: 3.451 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.15924620628357
Epoch: 9, Steps: 13 | Train Loss: 0.423 Vali Loss: 3.487 Vali Acc: 0.556 Test Loss: 3.487 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.991554021835327
Epoch: 10, Steps: 13 | Train Loss: 0.375 Vali Loss: 5.218 Vali Acc: 0.528 Test Loss: 5.218 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.269505262374878
Epoch: 11, Steps: 13 | Train Loss: 0.314 Vali Loss: 4.401 Vali Acc: 0.539 Test Loss: 4.401 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 11.095031499862671
Epoch: 12, Steps: 13 | Train Loss: 0.160 Vali Loss: 5.209 Vali Acc: 0.539 Test Loss: 5.209 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.272250890731812
Epoch: 13, Steps: 13 | Train Loss: 0.257 Vali Loss: 6.157 Vali Acc: 0.489 Test Loss: 6.157 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 12487682
model size : 67.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.664409399032593
Epoch: 1, Steps: 13 | Train Loss: 0.801 Vali Loss: 1.307 Vali Acc: 0.544 Test Loss: 1.307 Test Acc: 0.544
Validation loss decreased (inf --> -0.544431).  Saving model ...
Epoch: 2 cost time: 4.219873428344727
Epoch: 2, Steps: 13 | Train Loss: 0.736 Vali Loss: 1.819 Vali Acc: 0.539 Test Loss: 1.819 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.303650379180908
Epoch: 3, Steps: 13 | Train Loss: 0.760 Vali Loss: 1.571 Vali Acc: 0.550 Test Loss: 1.571 Test Acc: 0.550
Validation loss decreased (-0.544431 --> -0.549984).  Saving model ...
Epoch: 4 cost time: 4.2061097621917725
Epoch: 4, Steps: 13 | Train Loss: 0.811 Vali Loss: 2.197 Vali Acc: 0.533 Test Loss: 2.197 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.334625720977783
Epoch: 5, Steps: 13 | Train Loss: 0.883 Vali Loss: 3.240 Vali Acc: 0.528 Test Loss: 3.240 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.21904182434082
Epoch: 6, Steps: 13 | Train Loss: 1.996 Vali Loss: 7.295 Vali Acc: 0.478 Test Loss: 7.295 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.064470291137695
Epoch: 7, Steps: 13 | Train Loss: 1.284 Vali Loss: 2.788 Vali Acc: 0.533 Test Loss: 2.788 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.1993021965026855
Epoch: 8, Steps: 13 | Train Loss: 0.865 Vali Loss: 4.054 Vali Acc: 0.533 Test Loss: 4.054 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.249654054641724
Epoch: 9, Steps: 13 | Train Loss: 0.906 Vali Loss: 4.096 Vali Acc: 0.506 Test Loss: 4.096 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.140611171722412
Epoch: 10, Steps: 13 | Train Loss: 0.779 Vali Loss: 9.804 Vali Acc: 0.506 Test Loss: 9.804 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.254136562347412
Epoch: 11, Steps: 13 | Train Loss: 2.819 Vali Loss: 9.312 Vali Acc: 0.517 Test Loss: 9.312 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.2417075634002686
Epoch: 12, Steps: 13 | Train Loss: 1.924 Vali Loss: 5.456 Vali Acc: 0.561 Test Loss: 5.456 Test Acc: 0.561
Validation loss decreased (-0.549984 --> -0.561057).  Saving model ...
Epoch: 13 cost time: 4.159766674041748
Epoch: 13, Steps: 13 | Train Loss: 0.978 Vali Loss: 3.072 Vali Acc: 0.528 Test Loss: 3.072 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.206279516220093
Epoch: 14, Steps: 13 | Train Loss: 1.804 Vali Loss: 5.606 Vali Acc: 0.533 Test Loss: 5.606 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.214485168457031
Epoch: 15, Steps: 13 | Train Loss: 0.596 Vali Loss: 5.113 Vali Acc: 0.494 Test Loss: 5.113 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.0856101512908936
Epoch: 16, Steps: 13 | Train Loss: 0.862 Vali Loss: 4.700 Vali Acc: 0.544 Test Loss: 4.700 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.046242952346802
Epoch: 17, Steps: 13 | Train Loss: 0.515 Vali Loss: 5.840 Vali Acc: 0.567 Test Loss: 5.840 Test Acc: 0.567
Validation loss decreased (-0.561057 --> -0.566608).  Saving model ...
Epoch: 18 cost time: 4.024878740310669
Epoch: 18, Steps: 13 | Train Loss: 0.676 Vali Loss: 11.746 Vali Acc: 0.528 Test Loss: 11.746 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.997206449508667
Epoch: 19, Steps: 13 | Train Loss: 1.357 Vali Loss: 6.646 Vali Acc: 0.544 Test Loss: 6.646 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.140897512435913
Epoch: 20, Steps: 13 | Train Loss: 0.534 Vali Loss: 7.294 Vali Acc: 0.506 Test Loss: 7.294 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.191172361373901
Epoch: 21, Steps: 13 | Train Loss: 1.330 Vali Loss: 8.561 Vali Acc: 0.544 Test Loss: 8.561 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.086889982223511
Epoch: 22, Steps: 13 | Train Loss: 1.781 Vali Loss: 7.515 Vali Acc: 0.489 Test Loss: 7.515 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.094841241836548
Epoch: 23, Steps: 13 | Train Loss: 1.868 Vali Loss: 13.359 Vali Acc: 0.511 Test Loss: 13.359 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.0992560386657715
Epoch: 24, Steps: 13 | Train Loss: 1.222 Vali Loss: 11.086 Vali Acc: 0.539 Test Loss: 11.086 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.197774410247803
Epoch: 25, Steps: 13 | Train Loss: 0.677 Vali Loss: 7.364 Vali Acc: 0.517 Test Loss: 7.364 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.255242824554443
Epoch: 26, Steps: 13 | Train Loss: 0.731 Vali Loss: 10.149 Vali Acc: 0.544 Test Loss: 10.149 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.129615545272827
Epoch: 27, Steps: 13 | Train Loss: 0.811 Vali Loss: 9.278 Vali Acc: 0.528 Test Loss: 9.278 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 12487682
model size : 67.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 33.868879318237305
Epoch: 1, Steps: 13 | Train Loss: 0.840 Vali Loss: 1.180 Vali Acc: 0.494 Test Loss: 1.180 Test Acc: 0.494
Validation loss decreased (inf --> -0.494433).  Saving model ...
Epoch: 2 cost time: 24.00050711631775
Epoch: 2, Steps: 13 | Train Loss: 0.726 Vali Loss: 2.591 Vali Acc: 0.483 Test Loss: 2.591 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.913720846176147
Epoch: 3, Steps: 13 | Train Loss: 0.498 Vali Loss: 2.820 Vali Acc: 0.489 Test Loss: 2.820 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 24.406765937805176
Epoch: 4, Steps: 13 | Train Loss: 1.158 Vali Loss: 4.501 Vali Acc: 0.472 Test Loss: 4.501 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 22.34848380088806
Epoch: 5, Steps: 13 | Train Loss: 0.860 Vali Loss: 5.642 Vali Acc: 0.522 Test Loss: 5.642 Test Acc: 0.522
Validation loss decreased (-0.494433 --> -0.522166).  Saving model ...
Epoch: 6 cost time: 24.32641053199768
Epoch: 6, Steps: 13 | Train Loss: 1.168 Vali Loss: 5.137 Vali Acc: 0.467 Test Loss: 5.137 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.39013147354126
Epoch: 7, Steps: 13 | Train Loss: 0.520 Vali Loss: 7.209 Vali Acc: 0.494 Test Loss: 7.209 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 26.293639421463013
Epoch: 8, Steps: 13 | Train Loss: 0.732 Vali Loss: 6.973 Vali Acc: 0.444 Test Loss: 6.973 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 23.11375403404236
Epoch: 9, Steps: 13 | Train Loss: 0.732 Vali Loss: 9.404 Vali Acc: 0.483 Test Loss: 9.404 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.948397636413574
Epoch: 10, Steps: 13 | Train Loss: 0.444 Vali Loss: 10.294 Vali Acc: 0.489 Test Loss: 10.294 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 26.582748651504517
Epoch: 11, Steps: 13 | Train Loss: 3.881 Vali Loss: 10.267 Vali Acc: 0.489 Test Loss: 10.267 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 21.933480739593506
Epoch: 12, Steps: 13 | Train Loss: 1.232 Vali Loss: 12.659 Vali Acc: 0.483 Test Loss: 12.659 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 24.801799297332764
Epoch: 13, Steps: 13 | Train Loss: 1.992 Vali Loss: 12.146 Vali Acc: 0.439 Test Loss: 12.146 Test Acc: 0.439
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 23.39707899093628
Epoch: 14, Steps: 13 | Train Loss: 1.492 Vali Loss: 12.999 Vali Acc: 0.517 Test Loss: 12.999 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 27.35731077194214
Epoch: 15, Steps: 13 | Train Loss: 0.851 Vali Loss: 13.955 Vali Acc: 0.461 Test Loss: 13.955 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 12094466
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 24.793465852737427
Epoch: 1, Steps: 13 | Train Loss: 0.966 Vali Loss: 1.458 Vali Acc: 0.517 Test Loss: 1.458 Test Acc: 0.517
Validation loss decreased (inf --> -0.516652).  Saving model ...
Epoch: 2 cost time: 19.56236958503723
Epoch: 2, Steps: 13 | Train Loss: 0.957 Vali Loss: 2.277 Vali Acc: 0.461 Test Loss: 2.277 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.42280125617981
Epoch: 3, Steps: 13 | Train Loss: 0.844 Vali Loss: 3.464 Vali Acc: 0.494 Test Loss: 3.464 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 21.728363037109375
Epoch: 4, Steps: 13 | Train Loss: 0.706 Vali Loss: 3.487 Vali Acc: 0.494 Test Loss: 3.487 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.343084812164307
Epoch: 5, Steps: 13 | Train Loss: 0.669 Vali Loss: 5.393 Vali Acc: 0.478 Test Loss: 5.393 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.69197416305542
Epoch: 6, Steps: 13 | Train Loss: 1.065 Vali Loss: 7.991 Vali Acc: 0.483 Test Loss: 7.991 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 22.147151708602905
Epoch: 7, Steps: 13 | Train Loss: 1.528 Vali Loss: 9.002 Vali Acc: 0.561 Test Loss: 9.002 Test Acc: 0.561
Validation loss decreased (-0.516652 --> -0.561021).  Saving model ...
Epoch: 8 cost time: 19.72778606414795
Epoch: 8, Steps: 13 | Train Loss: 0.648 Vali Loss: 8.837 Vali Acc: 0.461 Test Loss: 8.837 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.433645248413086
Epoch: 9, Steps: 13 | Train Loss: 0.448 Vali Loss: 8.016 Vali Acc: 0.483 Test Loss: 8.016 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.065644025802612
Epoch: 10, Steps: 13 | Train Loss: 0.545 Vali Loss: 9.424 Vali Acc: 0.500 Test Loss: 9.424 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 22.280275106430054
Epoch: 11, Steps: 13 | Train Loss: 0.615 Vali Loss: 9.930 Vali Acc: 0.500 Test Loss: 9.930 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 21.071259260177612
Epoch: 12, Steps: 13 | Train Loss: 0.537 Vali Loss: 12.380 Vali Acc: 0.517 Test Loss: 12.380 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 21.248881816864014
Epoch: 13, Steps: 13 | Train Loss: 1.131 Vali Loss: 12.285 Vali Acc: 0.483 Test Loss: 12.285 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 23.343493938446045
Epoch: 14, Steps: 13 | Train Loss: 0.930 Vali Loss: 11.533 Vali Acc: 0.522 Test Loss: 11.533 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 22.65965509414673
Epoch: 15, Steps: 13 | Train Loss: 0.914 Vali Loss: 16.976 Vali Acc: 0.528 Test Loss: 16.976 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 23.710094213485718
Epoch: 16, Steps: 13 | Train Loss: 2.234 Vali Loss: 15.776 Vali Acc: 0.522 Test Loss: 15.776 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 19.81031894683838
Epoch: 17, Steps: 13 | Train Loss: 0.522 Vali Loss: 17.573 Vali Acc: 0.522 Test Loss: 17.573 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 12094466
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 20.84563398361206
Epoch: 1, Steps: 13 | Train Loss: 0.938 Vali Loss: 1.117 Vali Acc: 0.511 Test Loss: 1.117 Test Acc: 0.511
Validation loss decreased (inf --> -0.511100).  Saving model ...
Epoch: 2 cost time: 18.731156826019287
Epoch: 2, Steps: 13 | Train Loss: 1.605 Vali Loss: 3.028 Vali Acc: 0.500 Test Loss: 3.028 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.440460920333862
Epoch: 3, Steps: 13 | Train Loss: 1.486 Vali Loss: 2.745 Vali Acc: 0.478 Test Loss: 2.745 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.344319105148315
Epoch: 4, Steps: 13 | Train Loss: 1.118 Vali Loss: 4.195 Vali Acc: 0.456 Test Loss: 4.195 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.35718011856079
Epoch: 5, Steps: 13 | Train Loss: 1.092 Vali Loss: 8.872 Vali Acc: 0.500 Test Loss: 8.872 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 19.549444675445557
Epoch: 6, Steps: 13 | Train Loss: 1.459 Vali Loss: 6.414 Vali Acc: 0.506 Test Loss: 6.414 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 19.382071018218994
Epoch: 7, Steps: 13 | Train Loss: 2.055 Vali Loss: 7.838 Vali Acc: 0.517 Test Loss: 7.838 Test Acc: 0.517
Validation loss decreased (-0.511100 --> -0.516588).  Saving model ...
Epoch: 8 cost time: 18.240956783294678
Epoch: 8, Steps: 13 | Train Loss: 0.900 Vali Loss: 8.024 Vali Acc: 0.500 Test Loss: 8.024 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.82807993888855
Epoch: 9, Steps: 13 | Train Loss: 0.848 Vali Loss: 9.120 Vali Acc: 0.511 Test Loss: 9.120 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.548558950424194
Epoch: 10, Steps: 13 | Train Loss: 0.339 Vali Loss: 8.228 Vali Acc: 0.506 Test Loss: 8.228 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.762430429458618
Epoch: 11, Steps: 13 | Train Loss: 0.352 Vali Loss: 8.983 Vali Acc: 0.467 Test Loss: 8.983 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 20.017403602600098
Epoch: 12, Steps: 13 | Train Loss: 1.085 Vali Loss: 10.068 Vali Acc: 0.456 Test Loss: 10.068 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 18.27970552444458
Epoch: 13, Steps: 13 | Train Loss: 0.213 Vali Loss: 15.444 Vali Acc: 0.506 Test Loss: 15.444 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 20.059542655944824
Epoch: 14, Steps: 13 | Train Loss: 1.003 Vali Loss: 12.336 Vali Acc: 0.478 Test Loss: 12.336 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 16.852272033691406
Epoch: 15, Steps: 13 | Train Loss: 1.719 Vali Loss: 13.523 Vali Acc: 0.500 Test Loss: 13.523 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 18.146063327789307
Epoch: 16, Steps: 13 | Train Loss: 0.367 Vali Loss: 16.016 Vali Acc: 0.483 Test Loss: 16.016 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 20.296074151992798
Epoch: 17, Steps: 13 | Train Loss: 1.906 Vali Loss: 14.796 Vali Acc: 0.489 Test Loss: 14.796 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 12094466
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 17.95452570915222
Epoch: 1, Steps: 13 | Train Loss: 0.867 Vali Loss: 1.363 Vali Acc: 0.539 Test Loss: 1.363 Test Acc: 0.539
Validation loss decreased (inf --> -0.538875).  Saving model ...
Epoch: 2 cost time: 14.16885256767273
Epoch: 2, Steps: 13 | Train Loss: 0.826 Vali Loss: 2.021 Vali Acc: 0.467 Test Loss: 2.021 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.710700511932373
Epoch: 3, Steps: 13 | Train Loss: 0.664 Vali Loss: 3.329 Vali Acc: 0.544 Test Loss: 3.329 Test Acc: 0.544
Validation loss decreased (-0.538875 --> -0.544411).  Saving model ...
Epoch: 4 cost time: 15.72472858428955
Epoch: 4, Steps: 13 | Train Loss: 0.934 Vali Loss: 4.690 Vali Acc: 0.478 Test Loss: 4.690 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.2681827545166
Epoch: 5, Steps: 13 | Train Loss: 1.705 Vali Loss: 4.525 Vali Acc: 0.528 Test Loss: 4.525 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.327016830444336
Epoch: 6, Steps: 13 | Train Loss: 0.813 Vali Loss: 4.912 Vali Acc: 0.511 Test Loss: 4.912 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.583528280258179
Epoch: 7, Steps: 13 | Train Loss: 0.466 Vali Loss: 5.480 Vali Acc: 0.478 Test Loss: 5.480 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.826855659484863
Epoch: 8, Steps: 13 | Train Loss: 0.611 Vali Loss: 7.535 Vali Acc: 0.456 Test Loss: 7.535 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.357375144958496
Epoch: 9, Steps: 13 | Train Loss: 0.764 Vali Loss: 8.895 Vali Acc: 0.522 Test Loss: 8.895 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.122354745864868
Epoch: 10, Steps: 13 | Train Loss: 0.378 Vali Loss: 8.111 Vali Acc: 0.522 Test Loss: 8.111 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 17.418781280517578
Epoch: 11, Steps: 13 | Train Loss: 0.641 Vali Loss: 10.174 Vali Acc: 0.494 Test Loss: 10.174 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 16.41152548789978
Epoch: 12, Steps: 13 | Train Loss: 0.595 Vali Loss: 8.983 Vali Acc: 0.517 Test Loss: 8.983 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 15.637135744094849
Epoch: 13, Steps: 13 | Train Loss: 0.907 Vali Loss: 13.592 Vali Acc: 0.506 Test Loss: 13.592 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 12094466
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 12.473540306091309
Epoch: 1, Steps: 13 | Train Loss: 0.900 Vali Loss: 1.083 Vali Acc: 0.544 Test Loss: 1.083 Test Acc: 0.544
Validation loss decreased (inf --> -0.544434).  Saving model ...
Epoch: 2 cost time: 11.618765354156494
Epoch: 2, Steps: 13 | Train Loss: 0.776 Vali Loss: 2.265 Vali Acc: 0.533 Test Loss: 2.265 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.168190956115723
Epoch: 3, Steps: 13 | Train Loss: 0.668 Vali Loss: 3.056 Vali Acc: 0.556 Test Loss: 3.056 Test Acc: 0.556
Validation loss decreased (-0.544434 --> -0.555525).  Saving model ...
Epoch: 4 cost time: 12.576823711395264
Epoch: 4, Steps: 13 | Train Loss: 0.601 Vali Loss: 5.938 Vali Acc: 0.478 Test Loss: 5.938 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.345532894134521
Epoch: 5, Steps: 13 | Train Loss: 0.944 Vali Loss: 5.063 Vali Acc: 0.489 Test Loss: 5.063 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.643478155136108
Epoch: 6, Steps: 13 | Train Loss: 0.788 Vali Loss: 5.827 Vali Acc: 0.500 Test Loss: 5.827 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.797106742858887
Epoch: 7, Steps: 13 | Train Loss: 0.532 Vali Loss: 6.449 Vali Acc: 0.550 Test Loss: 6.449 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.444740533828735
Epoch: 8, Steps: 13 | Train Loss: 0.945 Vali Loss: 7.600 Vali Acc: 0.539 Test Loss: 7.600 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.478001356124878
Epoch: 9, Steps: 13 | Train Loss: 0.413 Vali Loss: 8.514 Vali Acc: 0.483 Test Loss: 8.514 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.61749005317688
Epoch: 10, Steps: 13 | Train Loss: 0.805 Vali Loss: 11.768 Vali Acc: 0.456 Test Loss: 11.768 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.036943674087524
Epoch: 11, Steps: 13 | Train Loss: 1.389 Vali Loss: 13.535 Vali Acc: 0.456 Test Loss: 13.535 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.265126466751099
Epoch: 12, Steps: 13 | Train Loss: 0.979 Vali Loss: 11.328 Vali Acc: 0.500 Test Loss: 11.328 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 14.203900814056396
Epoch: 13, Steps: 13 | Train Loss: 0.280 Vali Loss: 12.517 Vali Acc: 0.472 Test Loss: 12.517 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 12094466
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 13.93606972694397
Epoch: 1, Steps: 13 | Train Loss: 0.905 Vali Loss: 1.250 Vali Acc: 0.511 Test Loss: 1.250 Test Acc: 0.511
Validation loss decreased (inf --> -0.511099).  Saving model ...
Epoch: 2 cost time: 11.537340879440308
Epoch: 2, Steps: 13 | Train Loss: 0.680 Vali Loss: 2.040 Vali Acc: 0.506 Test Loss: 2.040 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.835144519805908
Epoch: 3, Steps: 13 | Train Loss: 1.316 Vali Loss: 5.702 Vali Acc: 0.500 Test Loss: 5.702 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.17032527923584
Epoch: 4, Steps: 13 | Train Loss: 1.820 Vali Loss: 3.987 Vali Acc: 0.533 Test Loss: 3.987 Test Acc: 0.533
Validation loss decreased (-0.511099 --> -0.533293).  Saving model ...
Epoch: 5 cost time: 11.457140684127808
Epoch: 5, Steps: 13 | Train Loss: 0.801 Vali Loss: 5.213 Vali Acc: 0.489 Test Loss: 5.213 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.166131496429443
Epoch: 6, Steps: 13 | Train Loss: 0.696 Vali Loss: 6.808 Vali Acc: 0.539 Test Loss: 6.808 Test Acc: 0.539
Validation loss decreased (-0.533293 --> -0.538821).  Saving model ...
Epoch: 7 cost time: 12.231667518615723
Epoch: 7, Steps: 13 | Train Loss: 0.828 Vali Loss: 8.378 Vali Acc: 0.494 Test Loss: 8.378 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.297970056533813
Epoch: 8, Steps: 13 | Train Loss: 1.731 Vali Loss: 7.426 Vali Acc: 0.483 Test Loss: 7.426 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.412287950515747
Epoch: 9, Steps: 13 | Train Loss: 0.624 Vali Loss: 8.551 Vali Acc: 0.489 Test Loss: 8.551 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.201690435409546
Epoch: 10, Steps: 13 | Train Loss: 1.230 Vali Loss: 9.206 Vali Acc: 0.506 Test Loss: 9.206 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.960536479949951
Epoch: 11, Steps: 13 | Train Loss: 0.271 Vali Loss: 8.479 Vali Acc: 0.472 Test Loss: 8.479 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.292553424835205
Epoch: 12, Steps: 13 | Train Loss: 0.657 Vali Loss: 11.289 Vali Acc: 0.461 Test Loss: 11.289 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.687242269515991
Epoch: 13, Steps: 13 | Train Loss: 0.426 Vali Loss: 10.382 Vali Acc: 0.494 Test Loss: 10.382 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.078675508499146
Epoch: 14, Steps: 13 | Train Loss: 0.292 Vali Loss: 15.998 Vali Acc: 0.489 Test Loss: 15.998 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.92479944229126
Epoch: 15, Steps: 13 | Train Loss: 0.501 Vali Loss: 14.282 Vali Acc: 0.517 Test Loss: 14.282 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 13.376067876815796
Epoch: 16, Steps: 13 | Train Loss: 0.485 Vali Loss: 14.124 Vali Acc: 0.511 Test Loss: 14.124 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 12094466
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 13.609479665756226
Epoch: 1, Steps: 13 | Train Loss: 0.892 Vali Loss: 1.278 Vali Acc: 0.478 Test Loss: 1.278 Test Acc: 0.478
Validation loss decreased (inf --> -0.477765).  Saving model ...
Epoch: 2 cost time: 11.386205196380615
Epoch: 2, Steps: 13 | Train Loss: 1.101 Vali Loss: 4.188 Vali Acc: 0.511 Test Loss: 4.188 Test Acc: 0.511
Validation loss decreased (-0.477765 --> -0.511069).  Saving model ...
Epoch: 3 cost time: 10.624183177947998
Epoch: 3, Steps: 13 | Train Loss: 1.161 Vali Loss: 3.384 Vali Acc: 0.417 Test Loss: 3.384 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.015864610671997
Epoch: 4, Steps: 13 | Train Loss: 1.065 Vali Loss: 4.297 Vali Acc: 0.456 Test Loss: 4.297 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.654972791671753
Epoch: 5, Steps: 13 | Train Loss: 0.996 Vali Loss: 4.370 Vali Acc: 0.506 Test Loss: 4.370 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.585780143737793
Epoch: 6, Steps: 13 | Train Loss: 1.127 Vali Loss: 7.744 Vali Acc: 0.517 Test Loss: 7.744 Test Acc: 0.517
Validation loss decreased (-0.511069 --> -0.516589).  Saving model ...
Epoch: 7 cost time: 11.825849771499634
Epoch: 7, Steps: 13 | Train Loss: 1.663 Vali Loss: 6.135 Vali Acc: 0.483 Test Loss: 6.135 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.770973443984985
Epoch: 8, Steps: 13 | Train Loss: 1.417 Vali Loss: 8.164 Vali Acc: 0.500 Test Loss: 8.164 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.615626096725464
Epoch: 9, Steps: 13 | Train Loss: 1.260 Vali Loss: 8.866 Vali Acc: 0.461 Test Loss: 8.866 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.262234449386597
Epoch: 10, Steps: 13 | Train Loss: 2.543 Vali Loss: 12.083 Vali Acc: 0.483 Test Loss: 12.083 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.12267255783081
Epoch: 11, Steps: 13 | Train Loss: 1.270 Vali Loss: 9.104 Vali Acc: 0.461 Test Loss: 9.104 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.04373288154602
Epoch: 12, Steps: 13 | Train Loss: 0.475 Vali Loss: 9.676 Vali Acc: 0.489 Test Loss: 9.676 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.022438049316406
Epoch: 13, Steps: 13 | Train Loss: 2.411 Vali Loss: 10.160 Vali Acc: 0.494 Test Loss: 10.160 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.81898546218872
Epoch: 14, Steps: 13 | Train Loss: 0.491 Vali Loss: 10.935 Vali Acc: 0.483 Test Loss: 10.935 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.399935483932495
Epoch: 15, Steps: 13 | Train Loss: 2.018 Vali Loss: 13.868 Vali Acc: 0.489 Test Loss: 13.868 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.039009094238281
Epoch: 16, Steps: 13 | Train Loss: 1.983 Vali Loss: 11.980 Vali Acc: 0.528 Test Loss: 11.980 Test Acc: 0.528
Validation loss decreased (-0.516589 --> -0.527658).  Saving model ...
Epoch: 17 cost time: 12.402989864349365
Epoch: 17, Steps: 13 | Train Loss: 0.957 Vali Loss: 21.313 Vali Acc: 0.517 Test Loss: 21.313 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 11.87496829032898
Epoch: 18, Steps: 13 | Train Loss: 1.572 Vali Loss: 13.113 Vali Acc: 0.528 Test Loss: 13.113 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 11.657117366790771
Epoch: 19, Steps: 13 | Train Loss: 0.556 Vali Loss: 13.112 Vali Acc: 0.494 Test Loss: 13.112 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 10.428390979766846
Epoch: 20, Steps: 13 | Train Loss: 0.840 Vali Loss: 12.913 Vali Acc: 0.517 Test Loss: 12.913 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.629242181777954
Epoch: 21, Steps: 13 | Train Loss: 0.692 Vali Loss: 15.710 Vali Acc: 0.494 Test Loss: 15.710 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.787318229675293
Epoch: 22, Steps: 13 | Train Loss: 0.810 Vali Loss: 19.166 Vali Acc: 0.422 Test Loss: 19.166 Test Acc: 0.422
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 12.973960876464844
Epoch: 23, Steps: 13 | Train Loss: 0.908 Vali Loss: 19.598 Vali Acc: 0.489 Test Loss: 19.598 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 11.29710841178894
Epoch: 24, Steps: 13 | Train Loss: 0.452 Vali Loss: 19.751 Vali Acc: 0.511 Test Loss: 19.751 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 12.171833753585815
Epoch: 25, Steps: 13 | Train Loss: 0.491 Vali Loss: 22.230 Vali Acc: 0.500 Test Loss: 22.230 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 12.443748474121094
Epoch: 26, Steps: 13 | Train Loss: 0.612 Vali Loss: 25.942 Vali Acc: 0.489 Test Loss: 25.942 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 12094466
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 11.928752899169922
Epoch: 1, Steps: 13 | Train Loss: 0.846 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 9.532420635223389
Epoch: 2, Steps: 13 | Train Loss: 0.642 Vali Loss: 1.719 Vali Acc: 0.550 Test Loss: 1.719 Test Acc: 0.550
Validation loss decreased (-0.533322 --> -0.549983).  Saving model ...
Epoch: 3 cost time: 6.752104043960571
Epoch: 3, Steps: 13 | Train Loss: 0.537 Vali Loss: 2.962 Vali Acc: 0.500 Test Loss: 2.962 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.225167512893677
Epoch: 4, Steps: 13 | Train Loss: 0.867 Vali Loss: 3.321 Vali Acc: 0.506 Test Loss: 3.321 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.647062301635742
Epoch: 5, Steps: 13 | Train Loss: 0.726 Vali Loss: 4.027 Vali Acc: 0.450 Test Loss: 4.027 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.659813165664673
Epoch: 6, Steps: 13 | Train Loss: 0.997 Vali Loss: 5.518 Vali Acc: 0.478 Test Loss: 5.518 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.710018873214722
Epoch: 7, Steps: 13 | Train Loss: 0.360 Vali Loss: 6.343 Vali Acc: 0.506 Test Loss: 6.343 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.757049322128296
Epoch: 8, Steps: 13 | Train Loss: 1.452 Vali Loss: 9.128 Vali Acc: 0.517 Test Loss: 9.128 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.311348676681519
Epoch: 9, Steps: 13 | Train Loss: 1.047 Vali Loss: 8.388 Vali Acc: 0.472 Test Loss: 8.388 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.752209663391113
Epoch: 10, Steps: 13 | Train Loss: 0.861 Vali Loss: 9.713 Vali Acc: 0.450 Test Loss: 9.713 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.038420677185059
Epoch: 11, Steps: 13 | Train Loss: 1.005 Vali Loss: 9.981 Vali Acc: 0.522 Test Loss: 9.981 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.072604894638062
Epoch: 12, Steps: 13 | Train Loss: 1.553 Vali Loss: 10.909 Vali Acc: 0.439 Test Loss: 10.909 Test Acc: 0.439
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 12094466
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 12.378143787384033
Epoch: 1, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 10.552943229675293
Epoch: 2, Steps: 13 | Train Loss: 0.751 Vali Loss: 1.800 Vali Acc: 0.511 Test Loss: 1.800 Test Acc: 0.511
Validation loss decreased (-0.499992 --> -0.511093).  Saving model ...
Epoch: 3 cost time: 15.20117998123169
Epoch: 3, Steps: 13 | Train Loss: 0.807 Vali Loss: 1.152 Vali Acc: 0.550 Test Loss: 1.152 Test Acc: 0.550
Validation loss decreased (-0.511093 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 15.251194715499878
Epoch: 4, Steps: 13 | Train Loss: 0.742 Vali Loss: 1.487 Vali Acc: 0.539 Test Loss: 1.487 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.163071155548096
Epoch: 5, Steps: 13 | Train Loss: 0.568 Vali Loss: 2.864 Vali Acc: 0.533 Test Loss: 2.864 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.16518759727478
Epoch: 6, Steps: 13 | Train Loss: 0.877 Vali Loss: 2.257 Vali Acc: 0.561 Test Loss: 2.257 Test Acc: 0.561
Validation loss decreased (-0.549988 --> -0.561089).  Saving model ...
Epoch: 7 cost time: 11.182528972625732
Epoch: 7, Steps: 13 | Train Loss: 0.917 Vali Loss: 5.511 Vali Acc: 0.511 Test Loss: 5.511 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.389200210571289
Epoch: 8, Steps: 13 | Train Loss: 0.764 Vali Loss: 2.889 Vali Acc: 0.572 Test Loss: 2.889 Test Acc: 0.572
Validation loss decreased (-0.561089 --> -0.572193).  Saving model ...
Epoch: 9 cost time: 15.956123113632202
Epoch: 9, Steps: 13 | Train Loss: 0.438 Vali Loss: 5.015 Vali Acc: 0.522 Test Loss: 5.015 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.058917760848999
Epoch: 10, Steps: 13 | Train Loss: 0.358 Vali Loss: 4.342 Vali Acc: 0.533 Test Loss: 4.342 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.829736709594727
Epoch: 11, Steps: 13 | Train Loss: 0.307 Vali Loss: 4.493 Vali Acc: 0.533 Test Loss: 4.493 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.805202722549438
Epoch: 12, Steps: 13 | Train Loss: 0.309 Vali Loss: 4.354 Vali Acc: 0.556 Test Loss: 4.354 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 15.176849842071533
Epoch: 13, Steps: 13 | Train Loss: 0.618 Vali Loss: 5.158 Vali Acc: 0.544 Test Loss: 5.158 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 14.841898441314697
Epoch: 14, Steps: 13 | Train Loss: 0.288 Vali Loss: 6.136 Vali Acc: 0.572 Test Loss: 6.136 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 12.603232145309448
Epoch: 15, Steps: 13 | Train Loss: 0.162 Vali Loss: 6.768 Vali Acc: 0.533 Test Loss: 6.768 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 14.741254091262817
Epoch: 16, Steps: 13 | Train Loss: 0.393 Vali Loss: 7.711 Vali Acc: 0.511 Test Loss: 7.711 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 14.108945608139038
Epoch: 17, Steps: 13 | Train Loss: 0.162 Vali Loss: 7.044 Vali Acc: 0.506 Test Loss: 7.044 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.250463962554932
Epoch: 18, Steps: 13 | Train Loss: 0.148 Vali Loss: 8.425 Vali Acc: 0.522 Test Loss: 8.425 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 12094466
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 16.938812255859375
Epoch: 1, Steps: 13 | Train Loss: 0.866 Vali Loss: 1.105 Vali Acc: 0.522 Test Loss: 1.105 Test Acc: 0.522
Validation loss decreased (inf --> -0.522211).  Saving model ...
Epoch: 2 cost time: 15.268065929412842
Epoch: 2, Steps: 13 | Train Loss: 1.236 Vali Loss: 2.317 Vali Acc: 0.511 Test Loss: 2.317 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.597147941589355
Epoch: 3, Steps: 13 | Train Loss: 1.778 Vali Loss: 3.405 Vali Acc: 0.494 Test Loss: 3.405 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.070380926132202
Epoch: 4, Steps: 13 | Train Loss: 1.341 Vali Loss: 3.600 Vali Acc: 0.544 Test Loss: 3.600 Test Acc: 0.544
Validation loss decreased (-0.522211 --> -0.544408).  Saving model ...
Epoch: 5 cost time: 12.680107355117798
Epoch: 5, Steps: 13 | Train Loss: 1.004 Vali Loss: 1.857 Vali Acc: 0.494 Test Loss: 1.857 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.460315942764282
Epoch: 6, Steps: 13 | Train Loss: 0.967 Vali Loss: 3.257 Vali Acc: 0.533 Test Loss: 3.257 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.375180006027222
Epoch: 7, Steps: 13 | Train Loss: 1.163 Vali Loss: 4.027 Vali Acc: 0.517 Test Loss: 4.027 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.646104097366333
Epoch: 8, Steps: 13 | Train Loss: 1.103 Vali Loss: 3.740 Vali Acc: 0.533 Test Loss: 3.740 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 15.597800970077515
Epoch: 9, Steps: 13 | Train Loss: 1.028 Vali Loss: 3.208 Vali Acc: 0.550 Test Loss: 3.208 Test Acc: 0.550
Validation loss decreased (-0.544408 --> -0.549968).  Saving model ...
Epoch: 10 cost time: 14.193421602249146
Epoch: 10, Steps: 13 | Train Loss: 1.507 Vali Loss: 4.210 Vali Acc: 0.572 Test Loss: 4.210 Test Acc: 0.572
Validation loss decreased (-0.549968 --> -0.572180).  Saving model ...
Epoch: 11 cost time: 14.383940935134888
Epoch: 11, Steps: 13 | Train Loss: 0.973 Vali Loss: 7.561 Vali Acc: 0.511 Test Loss: 7.561 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.710228681564331
Epoch: 12, Steps: 13 | Train Loss: 2.903 Vali Loss: 7.891 Vali Acc: 0.522 Test Loss: 7.891 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.165916442871094
Epoch: 13, Steps: 13 | Train Loss: 2.002 Vali Loss: 5.439 Vali Acc: 0.533 Test Loss: 5.439 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.823436498641968
Epoch: 14, Steps: 13 | Train Loss: 0.908 Vali Loss: 3.819 Vali Acc: 0.506 Test Loss: 3.819 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.217454671859741
Epoch: 15, Steps: 13 | Train Loss: 0.991 Vali Loss: 4.533 Vali Acc: 0.517 Test Loss: 4.533 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.473944187164307
Epoch: 16, Steps: 13 | Train Loss: 1.036 Vali Loss: 6.420 Vali Acc: 0.544 Test Loss: 6.420 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 13.9313485622406
Epoch: 17, Steps: 13 | Train Loss: 1.785 Vali Loss: 6.091 Vali Acc: 0.550 Test Loss: 6.091 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 14.862298488616943
Epoch: 18, Steps: 13 | Train Loss: 1.096 Vali Loss: 4.650 Vali Acc: 0.550 Test Loss: 4.650 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 14.258705854415894
Epoch: 19, Steps: 13 | Train Loss: 0.731 Vali Loss: 6.238 Vali Acc: 0.544 Test Loss: 6.238 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.800523519515991
Epoch: 20, Steps: 13 | Train Loss: 0.836 Vali Loss: 7.238 Vali Acc: 0.511 Test Loss: 7.238 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 12094466
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 18.85987639427185
Epoch: 1, Steps: 13 | Train Loss: 0.860 Vali Loss: 1.063 Vali Acc: 0.511 Test Loss: 1.063 Test Acc: 0.511
Validation loss decreased (inf --> -0.511100).  Saving model ...
Epoch: 2 cost time: 18.19124150276184
Epoch: 2, Steps: 13 | Train Loss: 0.806 Vali Loss: 2.048 Vali Acc: 0.483 Test Loss: 2.048 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.051785469055176
Epoch: 3, Steps: 13 | Train Loss: 0.923 Vali Loss: 2.474 Vali Acc: 0.500 Test Loss: 2.474 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.426093339920044
Epoch: 4, Steps: 13 | Train Loss: 1.389 Vali Loss: 2.888 Vali Acc: 0.472 Test Loss: 2.888 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.997223138809204
Epoch: 5, Steps: 13 | Train Loss: 1.377 Vali Loss: 2.895 Vali Acc: 0.483 Test Loss: 2.895 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.344212293624878
Epoch: 6, Steps: 13 | Train Loss: 0.547 Vali Loss: 4.010 Vali Acc: 0.500 Test Loss: 4.010 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 18.93601965904236
Epoch: 7, Steps: 13 | Train Loss: 0.797 Vali Loss: 5.510 Vali Acc: 0.506 Test Loss: 5.510 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.496170997619629
Epoch: 8, Steps: 13 | Train Loss: 0.838 Vali Loss: 5.897 Vali Acc: 0.489 Test Loss: 5.897 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.791242837905884
Epoch: 9, Steps: 13 | Train Loss: 0.638 Vali Loss: 6.094 Vali Acc: 0.517 Test Loss: 6.094 Test Acc: 0.517
Validation loss decreased (-0.511100 --> -0.516606).  Saving model ...
Epoch: 10 cost time: 17.12350082397461
Epoch: 10, Steps: 13 | Train Loss: 0.355 Vali Loss: 6.263 Vali Acc: 0.461 Test Loss: 6.263 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.181154251098633
Epoch: 11, Steps: 13 | Train Loss: 0.499 Vali Loss: 7.235 Vali Acc: 0.489 Test Loss: 7.235 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.010887384414673
Epoch: 12, Steps: 13 | Train Loss: 0.220 Vali Loss: 7.107 Vali Acc: 0.500 Test Loss: 7.107 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 18.655713319778442
Epoch: 13, Steps: 13 | Train Loss: 0.340 Vali Loss: 7.590 Vali Acc: 0.478 Test Loss: 7.590 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 17.095523357391357
Epoch: 14, Steps: 13 | Train Loss: 0.149 Vali Loss: 7.695 Vali Acc: 0.478 Test Loss: 7.695 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.355303764343262
Epoch: 15, Steps: 13 | Train Loss: 0.201 Vali Loss: 8.546 Vali Acc: 0.456 Test Loss: 8.546 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 15.382413387298584
Epoch: 16, Steps: 13 | Train Loss: 0.238 Vali Loss: 9.942 Vali Acc: 0.483 Test Loss: 9.942 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 17.972828149795532
Epoch: 17, Steps: 13 | Train Loss: 0.311 Vali Loss: 13.884 Vali Acc: 0.533 Test Loss: 13.884 Test Acc: 0.533
Validation loss decreased (-0.516606 --> -0.533194).  Saving model ...
Epoch: 18 cost time: 17.20581555366516
Epoch: 18, Steps: 13 | Train Loss: 0.664 Vali Loss: 14.054 Vali Acc: 0.511 Test Loss: 14.054 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 20.38497567176819
Epoch: 19, Steps: 13 | Train Loss: 0.674 Vali Loss: 12.221 Vali Acc: 0.506 Test Loss: 12.221 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 21.19346261024475
Epoch: 20, Steps: 13 | Train Loss: 0.242 Vali Loss: 13.752 Vali Acc: 0.517 Test Loss: 13.752 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 19.343390226364136
Epoch: 21, Steps: 13 | Train Loss: 0.521 Vali Loss: 13.655 Vali Acc: 0.494 Test Loss: 13.655 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 20.389280557632446
Epoch: 22, Steps: 13 | Train Loss: 0.386 Vali Loss: 13.888 Vali Acc: 0.483 Test Loss: 13.888 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 20.820297956466675
Epoch: 23, Steps: 13 | Train Loss: 0.152 Vali Loss: 15.620 Vali Acc: 0.472 Test Loss: 15.620 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 16.789547204971313
Epoch: 24, Steps: 13 | Train Loss: 0.137 Vali Loss: 14.393 Vali Acc: 0.467 Test Loss: 14.393 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 21.37481927871704
Epoch: 25, Steps: 13 | Train Loss: 0.132 Vali Loss: 15.406 Vali Acc: 0.467 Test Loss: 15.406 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 22.489223957061768
Epoch: 26, Steps: 13 | Train Loss: 0.115 Vali Loss: 18.579 Vali Acc: 0.456 Test Loss: 18.579 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 20.517847299575806
Epoch: 27, Steps: 13 | Train Loss: 0.205 Vali Loss: 18.067 Vali Acc: 0.422 Test Loss: 18.067 Test Acc: 0.422
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 6374914
model size : 34.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 14.559280157089233
Epoch: 1, Steps: 13 | Train Loss: 0.831 Vali Loss: 1.074 Vali Acc: 0.544 Test Loss: 1.074 Test Acc: 0.544
Validation loss decreased (inf --> -0.544434).  Saving model ...
Epoch: 2 cost time: 17.527897596359253
Epoch: 2, Steps: 13 | Train Loss: 0.786 Vali Loss: 2.228 Vali Acc: 0.483 Test Loss: 2.228 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.855475187301636
Epoch: 3, Steps: 13 | Train Loss: 0.802 Vali Loss: 1.810 Vali Acc: 0.489 Test Loss: 1.810 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.479824542999268
Epoch: 4, Steps: 13 | Train Loss: 0.621 Vali Loss: 2.193 Vali Acc: 0.456 Test Loss: 2.193 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.283364057540894
Epoch: 5, Steps: 13 | Train Loss: 0.361 Vali Loss: 2.845 Vali Acc: 0.472 Test Loss: 2.845 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.257852792739868
Epoch: 6, Steps: 13 | Train Loss: 0.675 Vali Loss: 3.252 Vali Acc: 0.556 Test Loss: 3.252 Test Acc: 0.556
Validation loss decreased (-0.544434 --> -0.555523).  Saving model ...
Epoch: 7 cost time: 16.045589923858643
Epoch: 7, Steps: 13 | Train Loss: 0.722 Vali Loss: 3.923 Vali Acc: 0.433 Test Loss: 3.923 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.45222234725952
Epoch: 8, Steps: 13 | Train Loss: 0.385 Vali Loss: 4.620 Vali Acc: 0.500 Test Loss: 4.620 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.73694610595703
Epoch: 9, Steps: 13 | Train Loss: 0.470 Vali Loss: 5.154 Vali Acc: 0.472 Test Loss: 5.154 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.325837135314941
Epoch: 10, Steps: 13 | Train Loss: 0.676 Vali Loss: 9.857 Vali Acc: 0.528 Test Loss: 9.857 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.731045484542847
Epoch: 11, Steps: 13 | Train Loss: 0.946 Vali Loss: 5.727 Vali Acc: 0.478 Test Loss: 5.727 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.529978036880493
Epoch: 12, Steps: 13 | Train Loss: 0.466 Vali Loss: 10.823 Vali Acc: 0.483 Test Loss: 10.823 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 13.066603422164917
Epoch: 13, Steps: 13 | Train Loss: 0.776 Vali Loss: 8.658 Vali Acc: 0.472 Test Loss: 8.658 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 15.211325407028198
Epoch: 14, Steps: 13 | Train Loss: 0.817 Vali Loss: 8.739 Vali Acc: 0.467 Test Loss: 8.739 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.423295974731445
Epoch: 15, Steps: 13 | Train Loss: 0.156 Vali Loss: 9.253 Vali Acc: 0.483 Test Loss: 9.253 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 16.62521743774414
Epoch: 16, Steps: 13 | Train Loss: 0.074 Vali Loss: 9.761 Vali Acc: 0.478 Test Loss: 9.761 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 6374914
model size : 34.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 14.187231540679932
Epoch: 1, Steps: 13 | Train Loss: 0.787 Vali Loss: 0.861 Vali Acc: 0.550 Test Loss: 0.861 Test Acc: 0.550
Validation loss decreased (inf --> -0.549991).  Saving model ...
Epoch: 2 cost time: 13.69699764251709
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 1.399 Vali Acc: 0.472 Test Loss: 1.399 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.106173992156982
Epoch: 3, Steps: 13 | Train Loss: 0.439 Vali Loss: 1.790 Vali Acc: 0.467 Test Loss: 1.790 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.851127624511719
Epoch: 4, Steps: 13 | Train Loss: 0.465 Vali Loss: 2.752 Vali Acc: 0.506 Test Loss: 2.752 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.820853233337402
Epoch: 5, Steps: 13 | Train Loss: 0.437 Vali Loss: 2.716 Vali Acc: 0.494 Test Loss: 2.716 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.23638916015625
Epoch: 6, Steps: 13 | Train Loss: 0.209 Vali Loss: 3.671 Vali Acc: 0.511 Test Loss: 3.671 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.00331163406372
Epoch: 7, Steps: 13 | Train Loss: 0.302 Vali Loss: 5.239 Vali Acc: 0.478 Test Loss: 5.239 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.944253921508789
Epoch: 8, Steps: 13 | Train Loss: 0.867 Vali Loss: 4.872 Vali Acc: 0.483 Test Loss: 4.872 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.692771196365356
Epoch: 9, Steps: 13 | Train Loss: 0.411 Vali Loss: 5.559 Vali Acc: 0.478 Test Loss: 5.559 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.09052562713623
Epoch: 10, Steps: 13 | Train Loss: 0.328 Vali Loss: 5.764 Vali Acc: 0.450 Test Loss: 5.764 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.029539108276367
Epoch: 11, Steps: 13 | Train Loss: 0.241 Vali Loss: 6.087 Vali Acc: 0.478 Test Loss: 6.087 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 6374914
model size : 34.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 13.181598424911499
Epoch: 1, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.843 Vali Acc: 0.522 Test Loss: 0.843 Test Acc: 0.522
Validation loss decreased (inf --> -0.522214).  Saving model ...
Epoch: 2 cost time: 12.829267024993896
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 1.292 Vali Acc: 0.556 Test Loss: 1.292 Test Acc: 0.556
Validation loss decreased (-0.522214 --> -0.555543).  Saving model ...
Epoch: 3 cost time: 11.794042587280273
Epoch: 3, Steps: 13 | Train Loss: 0.457 Vali Loss: 1.872 Vali Acc: 0.539 Test Loss: 1.872 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.991180658340454
Epoch: 4, Steps: 13 | Train Loss: 0.574 Vali Loss: 3.108 Vali Acc: 0.500 Test Loss: 3.108 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.531413793563843
Epoch: 5, Steps: 13 | Train Loss: 0.588 Vali Loss: 3.612 Vali Acc: 0.506 Test Loss: 3.612 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.734320878982544
Epoch: 6, Steps: 13 | Train Loss: 1.255 Vali Loss: 3.314 Vali Acc: 0.461 Test Loss: 3.314 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.46194076538086
Epoch: 7, Steps: 13 | Train Loss: 1.059 Vali Loss: 5.028 Vali Acc: 0.506 Test Loss: 5.028 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.165435552597046
Epoch: 8, Steps: 13 | Train Loss: 0.507 Vali Loss: 4.581 Vali Acc: 0.472 Test Loss: 4.581 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.235490322113037
Epoch: 9, Steps: 13 | Train Loss: 0.444 Vali Loss: 6.349 Vali Acc: 0.511 Test Loss: 6.349 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.631389379501343
Epoch: 10, Steps: 13 | Train Loss: 1.343 Vali Loss: 12.349 Vali Acc: 0.500 Test Loss: 12.349 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.076573610305786
Epoch: 11, Steps: 13 | Train Loss: 1.049 Vali Loss: 8.256 Vali Acc: 0.522 Test Loss: 8.256 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 14.29132080078125
Epoch: 12, Steps: 13 | Train Loss: 0.224 Vali Loss: 9.061 Vali Acc: 0.511 Test Loss: 9.061 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 6374914
model size : 34.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 12.57283902168274
Epoch: 1, Steps: 13 | Train Loss: 0.805 Vali Loss: 0.976 Vali Acc: 0.567 Test Loss: 0.976 Test Acc: 0.567
Validation loss decreased (inf --> -0.566657).  Saving model ...
Epoch: 2 cost time: 11.799784898757935
Epoch: 2, Steps: 13 | Train Loss: 0.667 Vali Loss: 1.425 Vali Acc: 0.517 Test Loss: 1.425 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.90614628791809
Epoch: 3, Steps: 13 | Train Loss: 0.515 Vali Loss: 2.077 Vali Acc: 0.517 Test Loss: 2.077 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.5118818283081055
Epoch: 4, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.927 Vali Acc: 0.478 Test Loss: 1.927 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.521845817565918
Epoch: 5, Steps: 13 | Train Loss: 0.277 Vali Loss: 2.596 Vali Acc: 0.500 Test Loss: 2.596 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.331908702850342
Epoch: 6, Steps: 13 | Train Loss: 0.470 Vali Loss: 3.036 Vali Acc: 0.561 Test Loss: 3.036 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.544734239578247
Epoch: 7, Steps: 13 | Train Loss: 0.258 Vali Loss: 3.606 Vali Acc: 0.561 Test Loss: 3.606 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.794618129730225
Epoch: 8, Steps: 13 | Train Loss: 0.281 Vali Loss: 4.561 Vali Acc: 0.506 Test Loss: 4.561 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.295400381088257
Epoch: 9, Steps: 13 | Train Loss: 0.397 Vali Loss: 5.340 Vali Acc: 0.472 Test Loss: 5.340 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.936240434646606
Epoch: 10, Steps: 13 | Train Loss: 0.151 Vali Loss: 5.725 Vali Acc: 0.433 Test Loss: 5.725 Test Acc: 0.433
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.52894639968872
Epoch: 11, Steps: 13 | Train Loss: 0.137 Vali Loss: 5.907 Vali Acc: 0.500 Test Loss: 5.907 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 6374914
model size : 34.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 11.574466228485107
Epoch: 1, Steps: 13 | Train Loss: 0.826 Vali Loss: 1.037 Vali Acc: 0.522 Test Loss: 1.037 Test Acc: 0.522
Validation loss decreased (inf --> -0.522212).  Saving model ...
Epoch: 2 cost time: 10.527586221694946
Epoch: 2, Steps: 13 | Train Loss: 0.583 Vali Loss: 1.355 Vali Acc: 0.550 Test Loss: 1.355 Test Acc: 0.550
Validation loss decreased (-0.522212 --> -0.549986).  Saving model ...
Epoch: 3 cost time: 10.504110097885132
Epoch: 3, Steps: 13 | Train Loss: 0.595 Vali Loss: 1.913 Vali Acc: 0.500 Test Loss: 1.913 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.795501708984375
Epoch: 4, Steps: 13 | Train Loss: 0.547 Vali Loss: 3.233 Vali Acc: 0.489 Test Loss: 3.233 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.717534303665161
Epoch: 5, Steps: 13 | Train Loss: 0.571 Vali Loss: 2.676 Vali Acc: 0.517 Test Loss: 2.676 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.103617191314697
Epoch: 6, Steps: 13 | Train Loss: 0.297 Vali Loss: 3.314 Vali Acc: 0.439 Test Loss: 3.314 Test Acc: 0.439
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.433886528015137
Epoch: 7, Steps: 13 | Train Loss: 0.339 Vali Loss: 3.470 Vali Acc: 0.494 Test Loss: 3.470 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.08917760848999
Epoch: 8, Steps: 13 | Train Loss: 0.708 Vali Loss: 3.901 Vali Acc: 0.489 Test Loss: 3.901 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.783323526382446
Epoch: 9, Steps: 13 | Train Loss: 0.556 Vali Loss: 5.896 Vali Acc: 0.489 Test Loss: 5.896 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.0864996910095215
Epoch: 10, Steps: 13 | Train Loss: 0.277 Vali Loss: 5.772 Vali Acc: 0.522 Test Loss: 5.772 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.864537715911865
Epoch: 11, Steps: 13 | Train Loss: 0.994 Vali Loss: 6.605 Vali Acc: 0.522 Test Loss: 6.605 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.061814308166504
Epoch: 12, Steps: 13 | Train Loss: 0.586 Vali Loss: 8.859 Vali Acc: 0.506 Test Loss: 8.859 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 6374914
model size : 34.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.67721962928772
Epoch: 1, Steps: 13 | Train Loss: 0.799 Vali Loss: 1.032 Vali Acc: 0.478 Test Loss: 1.032 Test Acc: 0.478
Validation loss decreased (inf --> -0.477767).  Saving model ...
Epoch: 2 cost time: 7.971094608306885
Epoch: 2, Steps: 13 | Train Loss: 0.783 Vali Loss: 1.958 Vali Acc: 0.461 Test Loss: 1.958 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.558044672012329
Epoch: 3, Steps: 13 | Train Loss: 0.615 Vali Loss: 1.821 Vali Acc: 0.494 Test Loss: 1.821 Test Acc: 0.494
Validation loss decreased (-0.477767 --> -0.494426).  Saving model ...
Epoch: 4 cost time: 9.898281574249268
Epoch: 4, Steps: 13 | Train Loss: 0.906 Vali Loss: 3.102 Vali Acc: 0.500 Test Loss: 3.102 Test Acc: 0.500
Validation loss decreased (-0.494426 --> -0.499969).  Saving model ...
Epoch: 5 cost time: 9.970644474029541
Epoch: 5, Steps: 13 | Train Loss: 0.801 Vali Loss: 3.048 Vali Acc: 0.461 Test Loss: 3.048 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.7918617725372314
Epoch: 6, Steps: 13 | Train Loss: 0.912 Vali Loss: 2.992 Vali Acc: 0.489 Test Loss: 2.992 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.659530639648438
Epoch: 7, Steps: 13 | Train Loss: 0.739 Vali Loss: 3.492 Vali Acc: 0.489 Test Loss: 3.492 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.559553146362305
Epoch: 8, Steps: 13 | Train Loss: 0.504 Vali Loss: 3.638 Vali Acc: 0.483 Test Loss: 3.638 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.479396343231201
Epoch: 9, Steps: 13 | Train Loss: 0.754 Vali Loss: 6.044 Vali Acc: 0.517 Test Loss: 6.044 Test Acc: 0.517
Validation loss decreased (-0.499969 --> -0.516606).  Saving model ...
Epoch: 10 cost time: 8.853968858718872
Epoch: 10, Steps: 13 | Train Loss: 1.601 Vali Loss: 6.113 Vali Acc: 0.472 Test Loss: 6.113 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.874436378479004
Epoch: 11, Steps: 13 | Train Loss: 1.127 Vali Loss: 5.697 Vali Acc: 0.494 Test Loss: 5.697 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.391061067581177
Epoch: 12, Steps: 13 | Train Loss: 0.343 Vali Loss: 6.836 Vali Acc: 0.467 Test Loss: 6.836 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.193986892700195
Epoch: 13, Steps: 13 | Train Loss: 0.451 Vali Loss: 7.110 Vali Acc: 0.456 Test Loss: 7.110 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.124820709228516
Epoch: 14, Steps: 13 | Train Loss: 0.285 Vali Loss: 7.857 Vali Acc: 0.461 Test Loss: 7.857 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.502049446105957
Epoch: 15, Steps: 13 | Train Loss: 0.353 Vali Loss: 9.496 Vali Acc: 0.461 Test Loss: 9.496 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.809199571609497
Epoch: 16, Steps: 13 | Train Loss: 0.473 Vali Loss: 8.465 Vali Acc: 0.439 Test Loss: 8.465 Test Acc: 0.439
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.9456260204315186
Epoch: 17, Steps: 13 | Train Loss: 0.345 Vali Loss: 9.403 Vali Acc: 0.483 Test Loss: 9.403 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.930248260498047
Epoch: 18, Steps: 13 | Train Loss: 0.201 Vali Loss: 9.671 Vali Acc: 0.483 Test Loss: 9.671 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.285073280334473
Epoch: 19, Steps: 13 | Train Loss: 0.683 Vali Loss: 10.376 Vali Acc: 0.456 Test Loss: 10.376 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 6374914
model size : 34.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 11.111049890518188
Epoch: 1, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.862 Vali Acc: 0.506 Test Loss: 0.862 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 10.427473068237305
Epoch: 2, Steps: 13 | Train Loss: 0.600 Vali Loss: 1.857 Vali Acc: 0.439 Test Loss: 1.857 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.511941909790039
Epoch: 3, Steps: 13 | Train Loss: 0.488 Vali Loss: 1.847 Vali Acc: 0.511 Test Loss: 1.847 Test Acc: 0.511
Validation loss decreased (-0.505547 --> -0.511093).  Saving model ...
Epoch: 4 cost time: 9.431080102920532
Epoch: 4, Steps: 13 | Train Loss: 0.354 Vali Loss: 2.083 Vali Acc: 0.489 Test Loss: 2.083 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.394251346588135
Epoch: 5, Steps: 13 | Train Loss: 0.361 Vali Loss: 2.937 Vali Acc: 0.433 Test Loss: 2.937 Test Acc: 0.433
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.772593021392822
Epoch: 6, Steps: 13 | Train Loss: 0.627 Vali Loss: 3.198 Vali Acc: 0.494 Test Loss: 3.198 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.065788269042969
Epoch: 7, Steps: 13 | Train Loss: 0.309 Vali Loss: 3.776 Vali Acc: 0.467 Test Loss: 3.776 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.47739577293396
Epoch: 8, Steps: 13 | Train Loss: 0.662 Vali Loss: 4.670 Vali Acc: 0.439 Test Loss: 4.670 Test Acc: 0.439
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.091815948486328
Epoch: 9, Steps: 13 | Train Loss: 0.547 Vali Loss: 6.662 Vali Acc: 0.483 Test Loss: 6.662 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.175161361694336
Epoch: 10, Steps: 13 | Train Loss: 0.801 Vali Loss: 6.099 Vali Acc: 0.456 Test Loss: 6.099 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.129797220230103
Epoch: 11, Steps: 13 | Train Loss: 0.996 Vali Loss: 6.295 Vali Acc: 0.500 Test Loss: 6.295 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.910314083099365
Epoch: 12, Steps: 13 | Train Loss: 0.440 Vali Loss: 6.364 Vali Acc: 0.483 Test Loss: 6.364 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.153611898422241
Epoch: 13, Steps: 13 | Train Loss: 0.243 Vali Loss: 7.206 Vali Acc: 0.494 Test Loss: 7.206 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 6374914
model size : 34.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 11.830403327941895
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.838 Vali Acc: 0.506 Test Loss: 0.838 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 10.493537902832031
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 1.230 Vali Acc: 0.494 Test Loss: 1.230 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.697042226791382
Epoch: 3, Steps: 13 | Train Loss: 0.825 Vali Loss: 0.909 Vali Acc: 0.567 Test Loss: 0.909 Test Acc: 0.567
Validation loss decreased (-0.505547 --> -0.566658).  Saving model ...
Epoch: 4 cost time: 10.026892900466919
Epoch: 4, Steps: 13 | Train Loss: 0.507 Vali Loss: 1.181 Vali Acc: 0.539 Test Loss: 1.181 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.079967737197876
Epoch: 5, Steps: 13 | Train Loss: 0.501 Vali Loss: 1.629 Vali Acc: 0.550 Test Loss: 1.629 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.100342512130737
Epoch: 6, Steps: 13 | Train Loss: 0.518 Vali Loss: 2.008 Vali Acc: 0.517 Test Loss: 2.008 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.296715259552002
Epoch: 7, Steps: 13 | Train Loss: 0.398 Vali Loss: 2.165 Vali Acc: 0.517 Test Loss: 2.165 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.664982557296753
Epoch: 8, Steps: 13 | Train Loss: 0.256 Vali Loss: 3.542 Vali Acc: 0.494 Test Loss: 3.542 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.377760171890259
Epoch: 9, Steps: 13 | Train Loss: 0.364 Vali Loss: 3.047 Vali Acc: 0.539 Test Loss: 3.047 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.618269443511963
Epoch: 10, Steps: 13 | Train Loss: 0.163 Vali Loss: 4.146 Vali Acc: 0.500 Test Loss: 4.146 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.434933423995972
Epoch: 11, Steps: 13 | Train Loss: 0.514 Vali Loss: 4.551 Vali Acc: 0.522 Test Loss: 4.551 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.912353754043579
Epoch: 12, Steps: 13 | Train Loss: 0.496 Vali Loss: 4.247 Vali Acc: 0.544 Test Loss: 4.247 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.883247137069702
Epoch: 13, Steps: 13 | Train Loss: 0.313 Vali Loss: 5.991 Vali Acc: 0.556 Test Loss: 5.991 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 6374914
model size : 34.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.895407915115356
Epoch: 1, Steps: 13 | Train Loss: 0.795 Vali Loss: 0.860 Vali Acc: 0.556 Test Loss: 0.860 Test Acc: 0.556
Validation loss decreased (inf --> -0.555547).  Saving model ...
Epoch: 2 cost time: 9.386250972747803
Epoch: 2, Steps: 13 | Train Loss: 0.897 Vali Loss: 1.639 Vali Acc: 0.506 Test Loss: 1.639 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.645883560180664
Epoch: 3, Steps: 13 | Train Loss: 0.815 Vali Loss: 1.190 Vali Acc: 0.533 Test Loss: 1.190 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.297799825668335
Epoch: 4, Steps: 13 | Train Loss: 0.688 Vali Loss: 1.365 Vali Acc: 0.511 Test Loss: 1.365 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.823610782623291
Epoch: 5, Steps: 13 | Train Loss: 0.816 Vali Loss: 1.251 Vali Acc: 0.517 Test Loss: 1.251 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.076474666595459
Epoch: 6, Steps: 13 | Train Loss: 0.612 Vali Loss: 1.894 Vali Acc: 0.517 Test Loss: 1.894 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.877236604690552
Epoch: 7, Steps: 13 | Train Loss: 0.659 Vali Loss: 2.034 Vali Acc: 0.567 Test Loss: 2.034 Test Acc: 0.567
Validation loss decreased (-0.555547 --> -0.566646).  Saving model ...
Epoch: 8 cost time: 7.208223342895508
Epoch: 8, Steps: 13 | Train Loss: 0.585 Vali Loss: 2.781 Vali Acc: 0.533 Test Loss: 2.781 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.39269733428955
Epoch: 9, Steps: 13 | Train Loss: 0.661 Vali Loss: 2.020 Vali Acc: 0.511 Test Loss: 2.020 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.852599620819092
Epoch: 10, Steps: 13 | Train Loss: 0.747 Vali Loss: 1.399 Vali Acc: 0.561 Test Loss: 1.399 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.1586172580719
Epoch: 11, Steps: 13 | Train Loss: 0.993 Vali Loss: 3.247 Vali Acc: 0.517 Test Loss: 3.247 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.995529651641846
Epoch: 12, Steps: 13 | Train Loss: 1.245 Vali Loss: 1.579 Vali Acc: 0.544 Test Loss: 1.579 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.41331148147583
Epoch: 13, Steps: 13 | Train Loss: 0.452 Vali Loss: 2.451 Vali Acc: 0.556 Test Loss: 2.451 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.025012016296387
Epoch: 14, Steps: 13 | Train Loss: 0.379 Vali Loss: 2.039 Vali Acc: 0.583 Test Loss: 2.039 Test Acc: 0.583
Validation loss decreased (-0.566646 --> -0.583313).  Saving model ...
Epoch: 15 cost time: 9.545088291168213
Epoch: 15, Steps: 13 | Train Loss: 0.498 Vali Loss: 2.658 Vali Acc: 0.517 Test Loss: 2.658 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.396965980529785
Epoch: 16, Steps: 13 | Train Loss: 0.508 Vali Loss: 2.520 Vali Acc: 0.567 Test Loss: 2.520 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.239530563354492
Epoch: 17, Steps: 13 | Train Loss: 0.717 Vali Loss: 4.391 Vali Acc: 0.517 Test Loss: 4.391 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.43350625038147
Epoch: 18, Steps: 13 | Train Loss: 0.679 Vali Loss: 3.574 Vali Acc: 0.544 Test Loss: 3.574 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.073468446731567
Epoch: 19, Steps: 13 | Train Loss: 0.892 Vali Loss: 2.272 Vali Acc: 0.572 Test Loss: 2.272 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.82106876373291
Epoch: 20, Steps: 13 | Train Loss: 1.245 Vali Loss: 4.350 Vali Acc: 0.489 Test Loss: 4.350 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.630061864852905
Epoch: 21, Steps: 13 | Train Loss: 1.226 Vali Loss: 6.905 Vali Acc: 0.494 Test Loss: 6.905 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.110098600387573
Epoch: 22, Steps: 13 | Train Loss: 1.260 Vali Loss: 3.996 Vali Acc: 0.517 Test Loss: 3.996 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.034443616867065
Epoch: 23, Steps: 13 | Train Loss: 0.659 Vali Loss: 3.568 Vali Acc: 0.578 Test Loss: 3.568 Test Acc: 0.578
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.81814455986023
Epoch: 24, Steps: 13 | Train Loss: 0.817 Vali Loss: 4.262 Vali Acc: 0.506 Test Loss: 4.262 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 6374914
model size : 34.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 15.58247971534729
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 1.254 Vali Acc: 0.528 Test Loss: 1.254 Test Acc: 0.528
Validation loss decreased (inf --> -0.527765).  Saving model ...
Epoch: 2 cost time: 16.880608320236206
Epoch: 2, Steps: 13 | Train Loss: 0.652 Vali Loss: 1.537 Vali Acc: 0.461 Test Loss: 1.537 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.242868423461914
Epoch: 3, Steps: 13 | Train Loss: 0.447 Vali Loss: 1.728 Vali Acc: 0.517 Test Loss: 1.728 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.628290176391602
Epoch: 4, Steps: 13 | Train Loss: 0.469 Vali Loss: 2.797 Vali Acc: 0.489 Test Loss: 2.797 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.34467363357544
Epoch: 5, Steps: 13 | Train Loss: 0.383 Vali Loss: 2.918 Vali Acc: 0.483 Test Loss: 2.918 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.0086669921875
Epoch: 6, Steps: 13 | Train Loss: 0.369 Vali Loss: 2.857 Vali Acc: 0.522 Test Loss: 2.857 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.94452452659607
Epoch: 7, Steps: 13 | Train Loss: 0.255 Vali Loss: 3.572 Vali Acc: 0.494 Test Loss: 3.572 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.62977170944214
Epoch: 8, Steps: 13 | Train Loss: 0.280 Vali Loss: 3.859 Vali Acc: 0.483 Test Loss: 3.859 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 16.73951268196106
Epoch: 9, Steps: 13 | Train Loss: 0.206 Vali Loss: 5.258 Vali Acc: 0.522 Test Loss: 5.258 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 14.339173555374146
Epoch: 10, Steps: 13 | Train Loss: 0.572 Vali Loss: 5.481 Vali Acc: 0.489 Test Loss: 5.481 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 17.70471978187561
Epoch: 11, Steps: 13 | Train Loss: 0.562 Vali Loss: 6.090 Vali Acc: 0.483 Test Loss: 6.090 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 4802050
model size : 28.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 17.5095636844635
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 1.171 Vali Acc: 0.533 Test Loss: 1.171 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 16.68523645401001
Epoch: 2, Steps: 13 | Train Loss: 0.700 Vali Loss: 1.886 Vali Acc: 0.500 Test Loss: 1.886 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.96343684196472
Epoch: 3, Steps: 13 | Train Loss: 0.508 Vali Loss: 1.710 Vali Acc: 0.517 Test Loss: 1.710 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.034257888793945
Epoch: 4, Steps: 13 | Train Loss: 0.486 Vali Loss: 2.341 Vali Acc: 0.433 Test Loss: 2.341 Test Acc: 0.433
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.35861325263977
Epoch: 5, Steps: 13 | Train Loss: 0.266 Vali Loss: 2.465 Vali Acc: 0.478 Test Loss: 2.465 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.162974119186401
Epoch: 6, Steps: 13 | Train Loss: 0.309 Vali Loss: 3.036 Vali Acc: 0.478 Test Loss: 3.036 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 14.554741621017456
Epoch: 7, Steps: 13 | Train Loss: 0.230 Vali Loss: 3.999 Vali Acc: 0.467 Test Loss: 3.999 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.294819593429565
Epoch: 8, Steps: 13 | Train Loss: 0.474 Vali Loss: 5.445 Vali Acc: 0.533 Test Loss: 5.445 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 16.848767280578613
Epoch: 9, Steps: 13 | Train Loss: 0.423 Vali Loss: 5.342 Vali Acc: 0.478 Test Loss: 5.342 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 16.824785947799683
Epoch: 10, Steps: 13 | Train Loss: 0.340 Vali Loss: 6.022 Vali Acc: 0.467 Test Loss: 6.022 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 16.35713481903076
Epoch: 11, Steps: 13 | Train Loss: 0.316 Vali Loss: 6.617 Vali Acc: 0.506 Test Loss: 6.617 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 4802050
model size : 28.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 13.620117664337158
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 1.176 Vali Acc: 0.506 Test Loss: 1.176 Test Acc: 0.506
Validation loss decreased (inf --> -0.505544).  Saving model ...
Epoch: 2 cost time: 9.437888383865356
Epoch: 2, Steps: 13 | Train Loss: 0.654 Vali Loss: 1.694 Vali Acc: 0.550 Test Loss: 1.694 Test Acc: 0.550
Validation loss decreased (-0.505544 --> -0.549983).  Saving model ...
Epoch: 3 cost time: 11.960598945617676
Epoch: 3, Steps: 13 | Train Loss: 0.467 Vali Loss: 1.791 Vali Acc: 0.500 Test Loss: 1.791 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.305519580841064
Epoch: 4, Steps: 13 | Train Loss: 0.428 Vali Loss: 2.264 Vali Acc: 0.494 Test Loss: 2.264 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.07337236404419
Epoch: 5, Steps: 13 | Train Loss: 0.309 Vali Loss: 3.136 Vali Acc: 0.494 Test Loss: 3.136 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.290679216384888
Epoch: 6, Steps: 13 | Train Loss: 0.528 Vali Loss: 5.413 Vali Acc: 0.494 Test Loss: 5.413 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.226850271224976
Epoch: 7, Steps: 13 | Train Loss: 0.798 Vali Loss: 4.302 Vali Acc: 0.472 Test Loss: 4.302 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.147883892059326
Epoch: 8, Steps: 13 | Train Loss: 1.098 Vali Loss: 5.226 Vali Acc: 0.506 Test Loss: 5.226 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.63360595703125
Epoch: 9, Steps: 13 | Train Loss: 0.530 Vali Loss: 6.221 Vali Acc: 0.478 Test Loss: 6.221 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.173535585403442
Epoch: 10, Steps: 13 | Train Loss: 0.251 Vali Loss: 6.516 Vali Acc: 0.494 Test Loss: 6.516 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 13.407097101211548
Epoch: 11, Steps: 13 | Train Loss: 0.287 Vali Loss: 5.730 Vali Acc: 0.517 Test Loss: 5.730 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.159442663192749
Epoch: 12, Steps: 13 | Train Loss: 0.209 Vali Loss: 6.221 Vali Acc: 0.489 Test Loss: 6.221 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 4802050
model size : 28.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 13.105666875839233
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 1.234 Vali Acc: 0.517 Test Loss: 1.234 Test Acc: 0.517
Validation loss decreased (inf --> -0.516654).  Saving model ...
Epoch: 2 cost time: 10.78779911994934
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 1.219 Vali Acc: 0.489 Test Loss: 1.219 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.140301942825317
Epoch: 3, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.559 Vali Acc: 0.522 Test Loss: 1.559 Test Acc: 0.522
Validation loss decreased (-0.516654 --> -0.522207).  Saving model ...
Epoch: 4 cost time: 11.850191116333008
Epoch: 4, Steps: 13 | Train Loss: 0.371 Vali Loss: 2.153 Vali Acc: 0.500 Test Loss: 2.153 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.992962837219238
Epoch: 5, Steps: 13 | Train Loss: 0.529 Vali Loss: 4.264 Vali Acc: 0.483 Test Loss: 4.264 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.159919738769531
Epoch: 6, Steps: 13 | Train Loss: 1.232 Vali Loss: 3.585 Vali Acc: 0.489 Test Loss: 3.585 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.174932718276978
Epoch: 7, Steps: 13 | Train Loss: 0.884 Vali Loss: 6.380 Vali Acc: 0.517 Test Loss: 6.380 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.984632730484009
Epoch: 8, Steps: 13 | Train Loss: 0.568 Vali Loss: 5.559 Vali Acc: 0.478 Test Loss: 5.559 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.987754821777344
Epoch: 9, Steps: 13 | Train Loss: 0.743 Vali Loss: 4.617 Vali Acc: 0.478 Test Loss: 4.617 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.55354642868042
Epoch: 10, Steps: 13 | Train Loss: 0.109 Vali Loss: 7.272 Vali Acc: 0.494 Test Loss: 7.272 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.602759599685669
Epoch: 11, Steps: 13 | Train Loss: 0.619 Vali Loss: 6.689 Vali Acc: 0.444 Test Loss: 6.689 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.79306411743164
Epoch: 12, Steps: 13 | Train Loss: 0.394 Vali Loss: 6.656 Vali Acc: 0.494 Test Loss: 6.656 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.212183237075806
Epoch: 13, Steps: 13 | Train Loss: 0.402 Vali Loss: 8.950 Vali Acc: 0.500 Test Loss: 8.950 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 4802050
model size : 28.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.917598247528076
Epoch: 1, Steps: 13 | Train Loss: 0.706 Vali Loss: 1.213 Vali Acc: 0.522 Test Loss: 1.213 Test Acc: 0.522
Validation loss decreased (inf --> -0.522210).  Saving model ...
Epoch: 2 cost time: 8.30718207359314
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 1.336 Vali Acc: 0.483 Test Loss: 1.336 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.195795059204102
Epoch: 3, Steps: 13 | Train Loss: 0.485 Vali Loss: 1.834 Vali Acc: 0.517 Test Loss: 1.834 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.576326370239258
Epoch: 4, Steps: 13 | Train Loss: 0.405 Vali Loss: 2.194 Vali Acc: 0.517 Test Loss: 2.194 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.544049263000488
Epoch: 5, Steps: 13 | Train Loss: 0.345 Vali Loss: 2.544 Vali Acc: 0.494 Test Loss: 2.544 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.501853704452515
Epoch: 6, Steps: 13 | Train Loss: 0.243 Vali Loss: 3.477 Vali Acc: 0.528 Test Loss: 3.477 Test Acc: 0.528
Validation loss decreased (-0.522210 --> -0.527743).  Saving model ...
Epoch: 7 cost time: 9.56360673904419
Epoch: 7, Steps: 13 | Train Loss: 0.806 Vali Loss: 4.103 Vali Acc: 0.506 Test Loss: 4.103 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.282028675079346
Epoch: 8, Steps: 13 | Train Loss: 0.788 Vali Loss: 5.325 Vali Acc: 0.544 Test Loss: 5.325 Test Acc: 0.544
Validation loss decreased (-0.527743 --> -0.544391).  Saving model ...
Epoch: 9 cost time: 9.297293663024902
Epoch: 9, Steps: 13 | Train Loss: 0.459 Vali Loss: 6.920 Vali Acc: 0.500 Test Loss: 6.920 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.37250566482544
Epoch: 10, Steps: 13 | Train Loss: 0.752 Vali Loss: 5.692 Vali Acc: 0.528 Test Loss: 5.692 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.879957437515259
Epoch: 11, Steps: 13 | Train Loss: 0.280 Vali Loss: 7.292 Vali Acc: 0.489 Test Loss: 7.292 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.664772987365723
Epoch: 12, Steps: 13 | Train Loss: 0.165 Vali Loss: 6.785 Vali Acc: 0.517 Test Loss: 6.785 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.852867841720581
Epoch: 13, Steps: 13 | Train Loss: 0.600 Vali Loss: 7.075 Vali Acc: 0.539 Test Loss: 7.075 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.2495858669281
Epoch: 14, Steps: 13 | Train Loss: 0.480 Vali Loss: 7.673 Vali Acc: 0.556 Test Loss: 7.673 Test Acc: 0.556
Validation loss decreased (-0.544391 --> -0.555479).  Saving model ...
Epoch: 15 cost time: 7.225739002227783
Epoch: 15, Steps: 13 | Train Loss: 0.403 Vali Loss: 8.504 Vali Acc: 0.528 Test Loss: 8.504 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.07482385635376
Epoch: 16, Steps: 13 | Train Loss: 0.264 Vali Loss: 10.670 Vali Acc: 0.517 Test Loss: 10.670 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.156928300857544
Epoch: 17, Steps: 13 | Train Loss: 0.650 Vali Loss: 13.080 Vali Acc: 0.472 Test Loss: 13.080 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.622422933578491
Epoch: 18, Steps: 13 | Train Loss: 0.659 Vali Loss: 13.782 Vali Acc: 0.428 Test Loss: 13.782 Test Acc: 0.428
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.874451398849487
Epoch: 19, Steps: 13 | Train Loss: 0.304 Vali Loss: 13.822 Vali Acc: 0.428 Test Loss: 13.822 Test Acc: 0.428
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 10.507727146148682
Epoch: 20, Steps: 13 | Train Loss: 0.437 Vali Loss: 15.055 Vali Acc: 0.444 Test Loss: 15.055 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.538927316665649
Epoch: 21, Steps: 13 | Train Loss: 0.202 Vali Loss: 14.571 Vali Acc: 0.461 Test Loss: 14.571 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.270036697387695
Epoch: 22, Steps: 13 | Train Loss: 0.172 Vali Loss: 14.175 Vali Acc: 0.483 Test Loss: 14.175 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.752230405807495
Epoch: 23, Steps: 13 | Train Loss: 0.461 Vali Loss: 15.419 Vali Acc: 0.489 Test Loss: 15.419 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.858444213867188
Epoch: 24, Steps: 13 | Train Loss: 0.733 Vali Loss: 14.283 Vali Acc: 0.533 Test Loss: 14.283 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 4802050
model size : 28.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 10.467754602432251
Epoch: 1, Steps: 13 | Train Loss: 0.760 Vali Loss: 1.328 Vali Acc: 0.506 Test Loss: 1.328 Test Acc: 0.506
Validation loss decreased (inf --> -0.505542).  Saving model ...
Epoch: 2 cost time: 7.95569634437561
Epoch: 2, Steps: 13 | Train Loss: 0.774 Vali Loss: 1.300 Vali Acc: 0.522 Test Loss: 1.300 Test Acc: 0.522
Validation loss decreased (-0.505542 --> -0.522209).  Saving model ...
Epoch: 3 cost time: 8.093814611434937
Epoch: 3, Steps: 13 | Train Loss: 0.675 Vali Loss: 1.645 Vali Acc: 0.517 Test Loss: 1.645 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.062845706939697
Epoch: 4, Steps: 13 | Train Loss: 0.581 Vali Loss: 2.405 Vali Acc: 0.500 Test Loss: 2.405 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.591421127319336
Epoch: 5, Steps: 13 | Train Loss: 0.419 Vali Loss: 3.581 Vali Acc: 0.489 Test Loss: 3.581 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.784453630447388
Epoch: 6, Steps: 13 | Train Loss: 0.402 Vali Loss: 3.436 Vali Acc: 0.506 Test Loss: 3.436 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.02852725982666
Epoch: 7, Steps: 13 | Train Loss: 0.566 Vali Loss: 3.772 Vali Acc: 0.522 Test Loss: 3.772 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.493077278137207
Epoch: 8, Steps: 13 | Train Loss: 0.444 Vali Loss: 4.236 Vali Acc: 0.517 Test Loss: 4.236 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.4580607414245605
Epoch: 9, Steps: 13 | Train Loss: 0.562 Vali Loss: 6.300 Vali Acc: 0.450 Test Loss: 6.300 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.232467174530029
Epoch: 10, Steps: 13 | Train Loss: 0.432 Vali Loss: 5.384 Vali Acc: 0.483 Test Loss: 5.384 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.457860708236694
Epoch: 11, Steps: 13 | Train Loss: 0.369 Vali Loss: 6.744 Vali Acc: 0.478 Test Loss: 6.744 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.418429136276245
Epoch: 12, Steps: 13 | Train Loss: 0.338 Vali Loss: 6.861 Vali Acc: 0.489 Test Loss: 6.861 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 4802050
model size : 28.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.711904525756836
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 1.529 Vali Acc: 0.489 Test Loss: 1.529 Test Acc: 0.489
Validation loss decreased (inf --> -0.488874).  Saving model ...
Epoch: 2 cost time: 7.773181676864624
Epoch: 2, Steps: 13 | Train Loss: 0.788 Vali Loss: 1.760 Vali Acc: 0.428 Test Loss: 1.760 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.406567811965942
Epoch: 3, Steps: 13 | Train Loss: 1.083 Vali Loss: 2.502 Vali Acc: 0.506 Test Loss: 2.502 Test Acc: 0.506
Validation loss decreased (-0.488874 --> -0.505531).  Saving model ...
Epoch: 4 cost time: 8.564921855926514
Epoch: 4, Steps: 13 | Train Loss: 1.168 Vali Loss: 3.375 Vali Acc: 0.494 Test Loss: 3.375 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.069162607192993
Epoch: 5, Steps: 13 | Train Loss: 1.126 Vali Loss: 2.302 Vali Acc: 0.506 Test Loss: 2.302 Test Acc: 0.506
Validation loss decreased (-0.505531 --> -0.505533).  Saving model ...
Epoch: 6 cost time: 6.051780939102173
Epoch: 6, Steps: 13 | Train Loss: 0.715 Vali Loss: 4.789 Vali Acc: 0.517 Test Loss: 4.789 Test Acc: 0.517
Validation loss decreased (-0.505533 --> -0.516619).  Saving model ...
Epoch: 7 cost time: 7.967243194580078
Epoch: 7, Steps: 13 | Train Loss: 0.972 Vali Loss: 5.088 Vali Acc: 0.478 Test Loss: 5.088 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.978845119476318
Epoch: 8, Steps: 13 | Train Loss: 0.793 Vali Loss: 4.228 Vali Acc: 0.444 Test Loss: 4.228 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.668837070465088
Epoch: 9, Steps: 13 | Train Loss: 0.449 Vali Loss: 5.111 Vali Acc: 0.517 Test Loss: 5.111 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.29187297821045
Epoch: 10, Steps: 13 | Train Loss: 0.653 Vali Loss: 3.944 Vali Acc: 0.517 Test Loss: 3.944 Test Acc: 0.517
Validation loss decreased (-0.516619 --> -0.516627).  Saving model ...
Epoch: 11 cost time: 6.412449598312378
Epoch: 11, Steps: 13 | Train Loss: 0.361 Vali Loss: 4.225 Vali Acc: 0.483 Test Loss: 4.225 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.1126604080200195
Epoch: 12, Steps: 13 | Train Loss: 0.813 Vali Loss: 5.303 Vali Acc: 0.517 Test Loss: 5.303 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.58840799331665
Epoch: 13, Steps: 13 | Train Loss: 0.430 Vali Loss: 6.394 Vali Acc: 0.467 Test Loss: 6.394 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.841701984405518
Epoch: 14, Steps: 13 | Train Loss: 0.359 Vali Loss: 7.457 Vali Acc: 0.450 Test Loss: 7.457 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.189578056335449
Epoch: 15, Steps: 13 | Train Loss: 0.577 Vali Loss: 13.380 Vali Acc: 0.489 Test Loss: 13.380 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.75733757019043
Epoch: 16, Steps: 13 | Train Loss: 1.060 Vali Loss: 9.288 Vali Acc: 0.467 Test Loss: 9.288 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.795935153961182
Epoch: 17, Steps: 13 | Train Loss: 0.592 Vali Loss: 8.651 Vali Acc: 0.461 Test Loss: 8.651 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.510676383972168
Epoch: 18, Steps: 13 | Train Loss: 0.520 Vali Loss: 8.960 Vali Acc: 0.450 Test Loss: 8.960 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.756270408630371
Epoch: 19, Steps: 13 | Train Loss: 0.288 Vali Loss: 9.532 Vali Acc: 0.478 Test Loss: 9.532 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.23789644241333
Epoch: 20, Steps: 13 | Train Loss: 0.405 Vali Loss: 10.899 Vali Acc: 0.461 Test Loss: 10.899 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 4802050
model size : 28.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.252527236938477
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 1.355 Vali Acc: 0.483 Test Loss: 1.355 Test Acc: 0.483
Validation loss decreased (inf --> -0.483320).  Saving model ...
Epoch: 2 cost time: 6.752264738082886
Epoch: 2, Steps: 13 | Train Loss: 0.656 Vali Loss: 1.495 Vali Acc: 0.444 Test Loss: 1.495 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.194508790969849
Epoch: 3, Steps: 13 | Train Loss: 0.478 Vali Loss: 2.074 Vali Acc: 0.483 Test Loss: 2.074 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.137637376785278
Epoch: 4, Steps: 13 | Train Loss: 0.573 Vali Loss: 2.500 Vali Acc: 0.450 Test Loss: 2.500 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.226438045501709
Epoch: 5, Steps: 13 | Train Loss: 0.377 Vali Loss: 3.240 Vali Acc: 0.467 Test Loss: 3.240 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.977579832077026
Epoch: 6, Steps: 13 | Train Loss: 2.070 Vali Loss: 5.744 Vali Acc: 0.500 Test Loss: 5.744 Test Acc: 0.500
Validation loss decreased (-0.483320 --> -0.499943).  Saving model ...
Epoch: 7 cost time: 7.2832207679748535
Epoch: 7, Steps: 13 | Train Loss: 1.760 Vali Loss: 4.824 Vali Acc: 0.494 Test Loss: 4.824 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.04818081855774
Epoch: 8, Steps: 13 | Train Loss: 0.383 Vali Loss: 4.335 Vali Acc: 0.450 Test Loss: 4.335 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.352043151855469
Epoch: 9, Steps: 13 | Train Loss: 0.347 Vali Loss: 4.432 Vali Acc: 0.489 Test Loss: 4.432 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.176336765289307
Epoch: 10, Steps: 13 | Train Loss: 0.577 Vali Loss: 5.384 Vali Acc: 0.478 Test Loss: 5.384 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.485093116760254
Epoch: 11, Steps: 13 | Train Loss: 0.386 Vali Loss: 6.872 Vali Acc: 0.422 Test Loss: 6.872 Test Acc: 0.422
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.066984176635742
Epoch: 12, Steps: 13 | Train Loss: 0.521 Vali Loss: 6.349 Vali Acc: 0.450 Test Loss: 6.349 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.838376760482788
Epoch: 13, Steps: 13 | Train Loss: 0.302 Vali Loss: 6.253 Vali Acc: 0.489 Test Loss: 6.253 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.836989641189575
Epoch: 14, Steps: 13 | Train Loss: 0.168 Vali Loss: 8.885 Vali Acc: 0.456 Test Loss: 8.885 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.816701412200928
Epoch: 15, Steps: 13 | Train Loss: 0.985 Vali Loss: 11.345 Vali Acc: 0.456 Test Loss: 11.345 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.99981689453125
Epoch: 16, Steps: 13 | Train Loss: 1.844 Vali Loss: 16.609 Vali Acc: 0.478 Test Loss: 16.609 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5
model parameter : 4802050
model size : 28.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.461627960205078
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 8.236140966415405
Epoch: 2, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.985 Vali Acc: 0.511 Test Loss: 0.985 Test Acc: 0.511
Validation loss decreased (-0.499987 --> -0.511101).  Saving model ...
Epoch: 3 cost time: 8.424406051635742
Epoch: 3, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.857 Vali Acc: 0.561 Test Loss: 0.857 Test Acc: 0.561
Validation loss decreased (-0.511101 --> -0.561103).  Saving model ...
Epoch: 4 cost time: 8.302879333496094
Epoch: 4, Steps: 13 | Train Loss: 0.411 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.294243574142456
Epoch: 5, Steps: 13 | Train Loss: 0.502 Vali Loss: 1.680 Vali Acc: 0.517 Test Loss: 1.680 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.740640163421631
Epoch: 6, Steps: 13 | Train Loss: 0.842 Vali Loss: 4.168 Vali Acc: 0.494 Test Loss: 4.168 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.919225692749023
Epoch: 7, Steps: 13 | Train Loss: 1.299 Vali Loss: 2.394 Vali Acc: 0.544 Test Loss: 2.394 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.62808632850647
Epoch: 8, Steps: 13 | Train Loss: 0.439 Vali Loss: 2.370 Vali Acc: 0.511 Test Loss: 2.370 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.181253910064697
Epoch: 9, Steps: 13 | Train Loss: 0.738 Vali Loss: 2.710 Vali Acc: 0.550 Test Loss: 2.710 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.876121759414673
Epoch: 10, Steps: 13 | Train Loss: 0.587 Vali Loss: 3.333 Vali Acc: 0.528 Test Loss: 3.333 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.866936206817627
Epoch: 11, Steps: 13 | Train Loss: 0.367 Vali Loss: 3.847 Vali Acc: 0.550 Test Loss: 3.847 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.019539833068848
Epoch: 12, Steps: 13 | Train Loss: 0.758 Vali Loss: 5.120 Vali Acc: 0.522 Test Loss: 5.120 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.668968915939331
Epoch: 13, Steps: 13 | Train Loss: 0.309 Vali Loss: 5.408 Vali Acc: 0.533 Test Loss: 5.408 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 4802050
model size : 28.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.17999529838562
Epoch: 1, Steps: 13 | Train Loss: 0.749 Vali Loss: 1.760 Vali Acc: 0.500 Test Loss: 1.760 Test Acc: 0.500
Validation loss decreased (inf --> -0.499982).  Saving model ...
Epoch: 2 cost time: 7.859981536865234
Epoch: 2, Steps: 13 | Train Loss: 0.971 Vali Loss: 1.182 Vali Acc: 0.517 Test Loss: 1.182 Test Acc: 0.517
Validation loss decreased (-0.499982 --> -0.516655).  Saving model ...
Epoch: 3 cost time: 7.950432300567627
Epoch: 3, Steps: 13 | Train Loss: 0.727 Vali Loss: 1.452 Vali Acc: 0.556 Test Loss: 1.452 Test Acc: 0.556
Validation loss decreased (-0.516655 --> -0.555541).  Saving model ...
Epoch: 4 cost time: 8.043603658676147
Epoch: 4, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.869 Vali Acc: 0.511 Test Loss: 0.869 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.93260931968689
Epoch: 5, Steps: 13 | Train Loss: 0.587 Vali Loss: 1.420 Vali Acc: 0.522 Test Loss: 1.420 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.169989824295044
Epoch: 6, Steps: 13 | Train Loss: 0.681 Vali Loss: 1.271 Vali Acc: 0.511 Test Loss: 1.271 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.6683125495910645
Epoch: 7, Steps: 13 | Train Loss: 0.518 Vali Loss: 1.462 Vali Acc: 0.550 Test Loss: 1.462 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.337001800537109
Epoch: 8, Steps: 13 | Train Loss: 0.659 Vali Loss: 2.489 Vali Acc: 0.517 Test Loss: 2.489 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.02099347114563
Epoch: 9, Steps: 13 | Train Loss: 0.638 Vali Loss: 2.451 Vali Acc: 0.556 Test Loss: 2.451 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.204791784286499
Epoch: 10, Steps: 13 | Train Loss: 0.519 Vali Loss: 2.888 Vali Acc: 0.489 Test Loss: 2.888 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.811823606491089
Epoch: 11, Steps: 13 | Train Loss: 0.613 Vali Loss: 2.110 Vali Acc: 0.517 Test Loss: 2.110 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.94197154045105
Epoch: 12, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.953 Vali Acc: 0.556 Test Loss: 1.953 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.693365812301636
Epoch: 13, Steps: 13 | Train Loss: 0.483 Vali Loss: 2.450 Vali Acc: 0.522 Test Loss: 2.450 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 4802050
model size : 28.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 17.441699743270874
Epoch: 1, Steps: 13 | Train Loss: 0.784 Vali Loss: 1.034 Vali Acc: 0.522 Test Loss: 1.034 Test Acc: 0.522
Validation loss decreased (inf --> -0.522212).  Saving model ...
Epoch: 2 cost time: 14.578379392623901
Epoch: 2, Steps: 13 | Train Loss: 0.811 Vali Loss: 1.920 Vali Acc: 0.506 Test Loss: 1.920 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.324222564697266
Epoch: 3, Steps: 13 | Train Loss: 0.569 Vali Loss: 2.029 Vali Acc: 0.472 Test Loss: 2.029 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.403634309768677
Epoch: 4, Steps: 13 | Train Loss: 0.446 Vali Loss: 1.864 Vali Acc: 0.506 Test Loss: 1.864 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.04642629623413
Epoch: 5, Steps: 13 | Train Loss: 0.199 Vali Loss: 2.842 Vali Acc: 0.444 Test Loss: 2.842 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.422611951828003
Epoch: 6, Steps: 13 | Train Loss: 0.339 Vali Loss: 2.838 Vali Acc: 0.483 Test Loss: 2.838 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 14.335051774978638
Epoch: 7, Steps: 13 | Train Loss: 0.220 Vali Loss: 3.243 Vali Acc: 0.478 Test Loss: 3.243 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.800881624221802
Epoch: 8, Steps: 13 | Train Loss: 0.436 Vali Loss: 4.967 Vali Acc: 0.511 Test Loss: 4.967 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.83424997329712
Epoch: 9, Steps: 13 | Train Loss: 0.382 Vali Loss: 4.465 Vali Acc: 0.478 Test Loss: 4.465 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 15.163806438446045
Epoch: 10, Steps: 13 | Train Loss: 0.427 Vali Loss: 4.853 Vali Acc: 0.467 Test Loss: 4.853 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 16.000709295272827
Epoch: 11, Steps: 13 | Train Loss: 0.275 Vali Loss: 5.231 Vali Acc: 0.517 Test Loss: 5.231 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 4015618
model size : 25.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 14.905311822891235
Epoch: 1, Steps: 13 | Train Loss: 0.790 Vali Loss: 0.888 Vali Acc: 0.517 Test Loss: 0.888 Test Acc: 0.517
Validation loss decreased (inf --> -0.516658).  Saving model ...
Epoch: 2 cost time: 15.104741096496582
Epoch: 2, Steps: 13 | Train Loss: 0.623 Vali Loss: 1.514 Vali Acc: 0.467 Test Loss: 1.514 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.154192924499512
Epoch: 3, Steps: 13 | Train Loss: 0.484 Vali Loss: 1.945 Vali Acc: 0.494 Test Loss: 1.945 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.980141162872314
Epoch: 4, Steps: 13 | Train Loss: 0.444 Vali Loss: 2.121 Vali Acc: 0.489 Test Loss: 2.121 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.596291780471802
Epoch: 5, Steps: 13 | Train Loss: 0.572 Vali Loss: 2.997 Vali Acc: 0.467 Test Loss: 2.997 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.761546611785889
Epoch: 6, Steps: 13 | Train Loss: 0.893 Vali Loss: 3.135 Vali Acc: 0.522 Test Loss: 3.135 Test Acc: 0.522
Validation loss decreased (-0.516658 --> -0.522191).  Saving model ...
Epoch: 7 cost time: 12.945612668991089
Epoch: 7, Steps: 13 | Train Loss: 0.365 Vali Loss: 5.550 Vali Acc: 0.506 Test Loss: 5.550 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.964640140533447
Epoch: 8, Steps: 13 | Train Loss: 0.324 Vali Loss: 3.995 Vali Acc: 0.550 Test Loss: 3.995 Test Acc: 0.550
Validation loss decreased (-0.522191 --> -0.549960).  Saving model ...
Epoch: 9 cost time: 14.680094957351685
Epoch: 9, Steps: 13 | Train Loss: 0.237 Vali Loss: 4.427 Vali Acc: 0.472 Test Loss: 4.427 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.044652462005615
Epoch: 10, Steps: 13 | Train Loss: 0.275 Vali Loss: 5.235 Vali Acc: 0.494 Test Loss: 5.235 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.710721254348755
Epoch: 11, Steps: 13 | Train Loss: 0.248 Vali Loss: 6.941 Vali Acc: 0.522 Test Loss: 6.941 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.766826391220093
Epoch: 12, Steps: 13 | Train Loss: 0.337 Vali Loss: 6.177 Vali Acc: 0.489 Test Loss: 6.177 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.669514656066895
Epoch: 13, Steps: 13 | Train Loss: 0.180 Vali Loss: 7.843 Vali Acc: 0.461 Test Loss: 7.843 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 14.986014127731323
Epoch: 14, Steps: 13 | Train Loss: 0.307 Vali Loss: 8.362 Vali Acc: 0.478 Test Loss: 8.362 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 13.110365152359009
Epoch: 15, Steps: 13 | Train Loss: 0.358 Vali Loss: 10.095 Vali Acc: 0.461 Test Loss: 10.095 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.09777545928955
Epoch: 16, Steps: 13 | Train Loss: 0.575 Vali Loss: 8.598 Vali Acc: 0.467 Test Loss: 8.598 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 13.533503293991089
Epoch: 17, Steps: 13 | Train Loss: 0.098 Vali Loss: 9.259 Vali Acc: 0.489 Test Loss: 9.259 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 14.4163076877594
Epoch: 18, Steps: 13 | Train Loss: 0.116 Vali Loss: 9.771 Vali Acc: 0.483 Test Loss: 9.771 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 4015618
model size : 25.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 13.692344188690186
Epoch: 1, Steps: 13 | Train Loss: 0.787 Vali Loss: 0.891 Vali Acc: 0.522 Test Loss: 0.891 Test Acc: 0.522
Validation loss decreased (inf --> -0.522213).  Saving model ...
Epoch: 2 cost time: 11.816060781478882
Epoch: 2, Steps: 13 | Train Loss: 0.621 Vali Loss: 1.334 Vali Acc: 0.500 Test Loss: 1.334 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.24003291130066
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 1.672 Vali Acc: 0.472 Test Loss: 1.672 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.797425746917725
Epoch: 4, Steps: 13 | Train Loss: 0.356 Vali Loss: 2.154 Vali Acc: 0.511 Test Loss: 2.154 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.479797840118408
Epoch: 5, Steps: 13 | Train Loss: 0.358 Vali Loss: 2.942 Vali Acc: 0.511 Test Loss: 2.942 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.483211040496826
Epoch: 6, Steps: 13 | Train Loss: 0.460 Vali Loss: 2.946 Vali Acc: 0.450 Test Loss: 2.946 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.027814626693726
Epoch: 7, Steps: 13 | Train Loss: 0.408 Vali Loss: 4.045 Vali Acc: 0.517 Test Loss: 4.045 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.486334800720215
Epoch: 8, Steps: 13 | Train Loss: 0.431 Vali Loss: 3.918 Vali Acc: 0.500 Test Loss: 3.918 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 11.623772621154785
Epoch: 9, Steps: 13 | Train Loss: 0.367 Vali Loss: 4.289 Vali Acc: 0.489 Test Loss: 4.289 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.531524419784546
Epoch: 10, Steps: 13 | Train Loss: 0.310 Vali Loss: 5.103 Vali Acc: 0.494 Test Loss: 5.103 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 12.054986000061035
Epoch: 11, Steps: 13 | Train Loss: 0.734 Vali Loss: 5.385 Vali Acc: 0.467 Test Loss: 5.385 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 4015618
model size : 25.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 10.53243374824524
Epoch: 1, Steps: 13 | Train Loss: 0.790 Vali Loss: 0.956 Vali Acc: 0.489 Test Loss: 0.956 Test Acc: 0.489
Validation loss decreased (inf --> -0.488879).  Saving model ...
Epoch: 2 cost time: 9.19967794418335
Epoch: 2, Steps: 13 | Train Loss: 0.677 Vali Loss: 1.319 Vali Acc: 0.528 Test Loss: 1.319 Test Acc: 0.528
Validation loss decreased (-0.488879 --> -0.527765).  Saving model ...
Epoch: 3 cost time: 11.53573751449585
Epoch: 3, Steps: 13 | Train Loss: 0.962 Vali Loss: 1.627 Vali Acc: 0.528 Test Loss: 1.627 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.068629503250122
Epoch: 4, Steps: 13 | Train Loss: 0.535 Vali Loss: 2.660 Vali Acc: 0.528 Test Loss: 2.660 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.044912576675415
Epoch: 5, Steps: 13 | Train Loss: 0.483 Vali Loss: 2.457 Vali Acc: 0.528 Test Loss: 2.457 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.290991306304932
Epoch: 6, Steps: 13 | Train Loss: 0.360 Vali Loss: 2.724 Vali Acc: 0.461 Test Loss: 2.724 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.92711615562439
Epoch: 7, Steps: 13 | Train Loss: 0.439 Vali Loss: 3.495 Vali Acc: 0.494 Test Loss: 3.495 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.270333528518677
Epoch: 8, Steps: 13 | Train Loss: 0.289 Vali Loss: 4.521 Vali Acc: 0.494 Test Loss: 4.521 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.928065776824951
Epoch: 9, Steps: 13 | Train Loss: 1.070 Vali Loss: 4.551 Vali Acc: 0.483 Test Loss: 4.551 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.454907894134521
Epoch: 10, Steps: 13 | Train Loss: 0.242 Vali Loss: 5.565 Vali Acc: 0.511 Test Loss: 5.565 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 10.83427906036377
Epoch: 11, Steps: 13 | Train Loss: 0.381 Vali Loss: 7.534 Vali Acc: 0.533 Test Loss: 7.534 Test Acc: 0.533
Validation loss decreased (-0.527765 --> -0.533258).  Saving model ...
Epoch: 12 cost time: 11.14702582359314
Epoch: 12, Steps: 13 | Train Loss: 1.035 Vali Loss: 6.888 Vali Acc: 0.456 Test Loss: 6.888 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.979120016098022
Epoch: 13, Steps: 13 | Train Loss: 1.444 Vali Loss: 7.213 Vali Acc: 0.439 Test Loss: 7.213 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.091752290725708
Epoch: 14, Steps: 13 | Train Loss: 0.473 Vali Loss: 7.875 Vali Acc: 0.478 Test Loss: 7.875 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.382486820220947
Epoch: 15, Steps: 13 | Train Loss: 0.254 Vali Loss: 9.376 Vali Acc: 0.517 Test Loss: 9.376 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.307413101196289
Epoch: 16, Steps: 13 | Train Loss: 0.065 Vali Loss: 8.813 Vali Acc: 0.456 Test Loss: 8.813 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.553956985473633
Epoch: 17, Steps: 13 | Train Loss: 0.191 Vali Loss: 8.706 Vali Acc: 0.444 Test Loss: 8.706 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 11.358478784561157
Epoch: 18, Steps: 13 | Train Loss: 0.045 Vali Loss: 9.242 Vali Acc: 0.494 Test Loss: 9.242 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.01088809967041
Epoch: 19, Steps: 13 | Train Loss: 0.090 Vali Loss: 9.694 Vali Acc: 0.500 Test Loss: 9.694 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.571598529815674
Epoch: 20, Steps: 13 | Train Loss: 0.508 Vali Loss: 10.739 Vali Acc: 0.528 Test Loss: 10.739 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 10.623063802719116
Epoch: 21, Steps: 13 | Train Loss: 0.306 Vali Loss: 10.693 Vali Acc: 0.483 Test Loss: 10.693 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 4015618
model size : 25.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 10.394273281097412
Epoch: 1, Steps: 13 | Train Loss: 0.796 Vali Loss: 0.843 Vali Acc: 0.533 Test Loss: 0.843 Test Acc: 0.533
Validation loss decreased (inf --> -0.533325).  Saving model ...
Epoch: 2 cost time: 6.7514636516571045
Epoch: 2, Steps: 13 | Train Loss: 0.542 Vali Loss: 1.262 Vali Acc: 0.539 Test Loss: 1.262 Test Acc: 0.539
Validation loss decreased (-0.533325 --> -0.538876).  Saving model ...
Epoch: 3 cost time: 9.209863901138306
Epoch: 3, Steps: 13 | Train Loss: 0.434 Vali Loss: 2.129 Vali Acc: 0.489 Test Loss: 2.129 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.567797899246216
Epoch: 4, Steps: 13 | Train Loss: 0.608 Vali Loss: 2.832 Vali Acc: 0.506 Test Loss: 2.832 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.982567071914673
Epoch: 5, Steps: 13 | Train Loss: 0.298 Vali Loss: 3.284 Vali Acc: 0.500 Test Loss: 3.284 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.45820164680481
Epoch: 6, Steps: 13 | Train Loss: 0.268 Vali Loss: 3.052 Vali Acc: 0.511 Test Loss: 3.052 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.42893671989441
Epoch: 7, Steps: 13 | Train Loss: 0.465 Vali Loss: 3.673 Vali Acc: 0.467 Test Loss: 3.673 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.230905055999756
Epoch: 8, Steps: 13 | Train Loss: 0.561 Vali Loss: 4.776 Vali Acc: 0.511 Test Loss: 4.776 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.363685131072998
Epoch: 9, Steps: 13 | Train Loss: 0.225 Vali Loss: 5.094 Vali Acc: 0.450 Test Loss: 5.094 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.338323593139648
Epoch: 10, Steps: 13 | Train Loss: 0.347 Vali Loss: 5.306 Vali Acc: 0.506 Test Loss: 5.306 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.2353315353393555
Epoch: 11, Steps: 13 | Train Loss: 0.157 Vali Loss: 5.462 Vali Acc: 0.489 Test Loss: 5.462 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.152658700942993
Epoch: 12, Steps: 13 | Train Loss: 0.212 Vali Loss: 7.806 Vali Acc: 0.517 Test Loss: 7.806 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 4015618
model size : 25.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.869492530822754
Epoch: 1, Steps: 13 | Train Loss: 0.814 Vali Loss: 0.843 Vali Acc: 0.539 Test Loss: 0.843 Test Acc: 0.539
Validation loss decreased (inf --> -0.538880).  Saving model ...
Epoch: 2 cost time: 7.0068747997283936
Epoch: 2, Steps: 13 | Train Loss: 0.574 Vali Loss: 1.150 Vali Acc: 0.517 Test Loss: 1.150 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.74486780166626
Epoch: 3, Steps: 13 | Train Loss: 0.578 Vali Loss: 1.686 Vali Acc: 0.500 Test Loss: 1.686 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.462391138076782
Epoch: 4, Steps: 13 | Train Loss: 0.715 Vali Loss: 2.853 Vali Acc: 0.522 Test Loss: 2.853 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.347179174423218
Epoch: 5, Steps: 13 | Train Loss: 0.302 Vali Loss: 2.890 Vali Acc: 0.550 Test Loss: 2.890 Test Acc: 0.550
Validation loss decreased (-0.538880 --> -0.549971).  Saving model ...
Epoch: 6 cost time: 6.6106672286987305
Epoch: 6, Steps: 13 | Train Loss: 0.508 Vali Loss: 2.757 Vali Acc: 0.517 Test Loss: 2.757 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.249495267868042
Epoch: 7, Steps: 13 | Train Loss: 0.392 Vali Loss: 3.700 Vali Acc: 0.511 Test Loss: 3.700 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.765611410140991
Epoch: 8, Steps: 13 | Train Loss: 0.482 Vali Loss: 3.963 Vali Acc: 0.556 Test Loss: 3.963 Test Acc: 0.556
Validation loss decreased (-0.549971 --> -0.555516).  Saving model ...
Epoch: 9 cost time: 5.467289447784424
Epoch: 9, Steps: 13 | Train Loss: 0.422 Vali Loss: 5.338 Vali Acc: 0.478 Test Loss: 5.338 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.769274711608887
Epoch: 10, Steps: 13 | Train Loss: 0.528 Vali Loss: 7.568 Vali Acc: 0.494 Test Loss: 7.568 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.41685938835144
Epoch: 11, Steps: 13 | Train Loss: 0.547 Vali Loss: 5.357 Vali Acc: 0.561 Test Loss: 5.357 Test Acc: 0.561
Validation loss decreased (-0.555516 --> -0.561058).  Saving model ...
Epoch: 12 cost time: 6.7426416873931885
Epoch: 12, Steps: 13 | Train Loss: 0.260 Vali Loss: 6.280 Vali Acc: 0.522 Test Loss: 6.280 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.040892839431763
Epoch: 13, Steps: 13 | Train Loss: 0.274 Vali Loss: 8.988 Vali Acc: 0.506 Test Loss: 8.988 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.5080225467681885
Epoch: 14, Steps: 13 | Train Loss: 0.801 Vali Loss: 9.571 Vali Acc: 0.511 Test Loss: 9.571 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.962766408920288
Epoch: 15, Steps: 13 | Train Loss: 1.064 Vali Loss: 8.631 Vali Acc: 0.494 Test Loss: 8.631 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.160586595535278
Epoch: 16, Steps: 13 | Train Loss: 0.442 Vali Loss: 9.320 Vali Acc: 0.483 Test Loss: 9.320 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.760745763778687
Epoch: 17, Steps: 13 | Train Loss: 0.092 Vali Loss: 9.642 Vali Acc: 0.533 Test Loss: 9.642 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 9.152680158615112
Epoch: 18, Steps: 13 | Train Loss: 0.055 Vali Loss: 10.628 Vali Acc: 0.467 Test Loss: 10.628 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.513788938522339
Epoch: 19, Steps: 13 | Train Loss: 0.925 Vali Loss: 14.975 Vali Acc: 0.444 Test Loss: 14.975 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.591444253921509
Epoch: 20, Steps: 13 | Train Loss: 0.481 Vali Loss: 11.157 Vali Acc: 0.483 Test Loss: 11.157 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.129878997802734
Epoch: 21, Steps: 13 | Train Loss: 0.192 Vali Loss: 11.592 Vali Acc: 0.500 Test Loss: 11.592 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 4015618
model size : 25.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.1483118534088135
Epoch: 1, Steps: 13 | Train Loss: 0.831 Vali Loss: 0.970 Vali Acc: 0.494 Test Loss: 0.970 Test Acc: 0.494
Validation loss decreased (inf --> -0.494435).  Saving model ...
Epoch: 2 cost time: 7.9395997524261475
Epoch: 2, Steps: 13 | Train Loss: 0.672 Vali Loss: 1.418 Vali Acc: 0.456 Test Loss: 1.418 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.066091060638428
Epoch: 3, Steps: 13 | Train Loss: 0.774 Vali Loss: 1.905 Vali Acc: 0.500 Test Loss: 1.905 Test Acc: 0.500
Validation loss decreased (-0.494435 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 7.0892791748046875
Epoch: 4, Steps: 13 | Train Loss: 0.531 Vali Loss: 1.983 Vali Acc: 0.528 Test Loss: 1.983 Test Acc: 0.528
Validation loss decreased (-0.499981 --> -0.527758).  Saving model ...
Epoch: 5 cost time: 8.09136438369751
Epoch: 5, Steps: 13 | Train Loss: 0.727 Vali Loss: 2.872 Vali Acc: 0.478 Test Loss: 2.872 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.419216394424438
Epoch: 6, Steps: 13 | Train Loss: 0.777 Vali Loss: 4.813 Vali Acc: 0.489 Test Loss: 4.813 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.905706882476807
Epoch: 7, Steps: 13 | Train Loss: 0.706 Vali Loss: 4.400 Vali Acc: 0.439 Test Loss: 4.400 Test Acc: 0.439
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.370122671127319
Epoch: 8, Steps: 13 | Train Loss: 0.665 Vali Loss: 3.562 Vali Acc: 0.467 Test Loss: 3.562 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.773334503173828
Epoch: 9, Steps: 13 | Train Loss: 0.229 Vali Loss: 3.816 Vali Acc: 0.472 Test Loss: 3.816 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.338246583938599
Epoch: 10, Steps: 13 | Train Loss: 0.253 Vali Loss: 3.982 Vali Acc: 0.522 Test Loss: 3.982 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.390082359313965
Epoch: 11, Steps: 13 | Train Loss: 0.246 Vali Loss: 5.492 Vali Acc: 0.533 Test Loss: 5.492 Test Acc: 0.533
Validation loss decreased (-0.527758 --> -0.533278).  Saving model ...
Epoch: 12 cost time: 8.807670831680298
Epoch: 12, Steps: 13 | Train Loss: 0.580 Vali Loss: 5.656 Vali Acc: 0.506 Test Loss: 5.656 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.600438833236694
Epoch: 13, Steps: 13 | Train Loss: 0.667 Vali Loss: 6.049 Vali Acc: 0.444 Test Loss: 6.049 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.5095319747924805
Epoch: 14, Steps: 13 | Train Loss: 0.159 Vali Loss: 6.408 Vali Acc: 0.467 Test Loss: 6.408 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.61512303352356
Epoch: 15, Steps: 13 | Train Loss: 0.304 Vali Loss: 6.210 Vali Acc: 0.472 Test Loss: 6.210 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.165703296661377
Epoch: 16, Steps: 13 | Train Loss: 0.219 Vali Loss: 6.496 Vali Acc: 0.472 Test Loss: 6.496 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.349599361419678
Epoch: 17, Steps: 13 | Train Loss: 0.233 Vali Loss: 6.753 Vali Acc: 0.483 Test Loss: 6.753 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.693890571594238
Epoch: 18, Steps: 13 | Train Loss: 0.258 Vali Loss: 7.761 Vali Acc: 0.494 Test Loss: 7.761 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.489962816238403
Epoch: 19, Steps: 13 | Train Loss: 0.251 Vali Loss: 8.717 Vali Acc: 0.472 Test Loss: 8.717 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.90476393699646
Epoch: 20, Steps: 13 | Train Loss: 0.032 Vali Loss: 9.637 Vali Acc: 0.472 Test Loss: 9.637 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.165124893188477
Epoch: 21, Steps: 13 | Train Loss: 0.134 Vali Loss: 10.051 Vali Acc: 0.461 Test Loss: 10.051 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 4015618
model size : 25.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.922367811203003
Epoch: 1, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.829 Vali Acc: 0.489 Test Loss: 0.829 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 8.097673892974854
Epoch: 2, Steps: 13 | Train Loss: 0.554 Vali Loss: 1.228 Vali Acc: 0.506 Test Loss: 1.228 Test Acc: 0.506
Validation loss decreased (-0.488881 --> -0.505543).  Saving model ...
Epoch: 3 cost time: 6.677198648452759
Epoch: 3, Steps: 13 | Train Loss: 0.421 Vali Loss: 1.649 Vali Acc: 0.461 Test Loss: 1.649 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.846686840057373
Epoch: 4, Steps: 13 | Train Loss: 0.411 Vali Loss: 3.210 Vali Acc: 0.489 Test Loss: 3.210 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.462340354919434
Epoch: 5, Steps: 13 | Train Loss: 0.696 Vali Loss: 3.549 Vali Acc: 0.472 Test Loss: 3.549 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.907696962356567
Epoch: 6, Steps: 13 | Train Loss: 0.627 Vali Loss: 3.548 Vali Acc: 0.489 Test Loss: 3.548 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.528526544570923
Epoch: 7, Steps: 13 | Train Loss: 0.422 Vali Loss: 4.309 Vali Acc: 0.511 Test Loss: 4.309 Test Acc: 0.511
Validation loss decreased (-0.505543 --> -0.511068).  Saving model ...
Epoch: 8 cost time: 5.71236252784729
Epoch: 8, Steps: 13 | Train Loss: 0.317 Vali Loss: 4.080 Vali Acc: 0.478 Test Loss: 4.080 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.740695238113403
Epoch: 9, Steps: 13 | Train Loss: 0.254 Vali Loss: 4.142 Vali Acc: 0.456 Test Loss: 4.142 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.766990423202515
Epoch: 10, Steps: 13 | Train Loss: 0.250 Vali Loss: 5.327 Vali Acc: 0.439 Test Loss: 5.327 Test Acc: 0.439
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.70729398727417
Epoch: 11, Steps: 13 | Train Loss: 0.128 Vali Loss: 5.105 Vali Acc: 0.472 Test Loss: 5.105 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.853301763534546
Epoch: 12, Steps: 13 | Train Loss: 0.291 Vali Loss: 6.524 Vali Acc: 0.500 Test Loss: 6.524 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.652580261230469
Epoch: 13, Steps: 13 | Train Loss: 0.298 Vali Loss: 7.077 Vali Acc: 0.428 Test Loss: 7.077 Test Acc: 0.428
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.4204583168029785
Epoch: 14, Steps: 13 | Train Loss: 0.372 Vali Loss: 7.329 Vali Acc: 0.478 Test Loss: 7.329 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.377910375595093
Epoch: 15, Steps: 13 | Train Loss: 0.189 Vali Loss: 8.857 Vali Acc: 0.461 Test Loss: 8.857 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.642780542373657
Epoch: 16, Steps: 13 | Train Loss: 0.179 Vali Loss: 7.035 Vali Acc: 0.450 Test Loss: 7.035 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.174586057662964
Epoch: 17, Steps: 13 | Train Loss: 0.239 Vali Loss: 7.442 Vali Acc: 0.456 Test Loss: 7.442 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 4015618
model size : 25.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.831353425979614
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.685 Vali Acc: 0.522 Test Loss: 0.685 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 6.703521013259888
Epoch: 2, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.942 Vali Acc: 0.539 Test Loss: 0.942 Test Acc: 0.539
Validation loss decreased (-0.522215 --> -0.538879).  Saving model ...
Epoch: 3 cost time: 6.451958656311035
Epoch: 3, Steps: 13 | Train Loss: 0.710 Vali Loss: 1.172 Vali Acc: 0.528 Test Loss: 1.172 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.219887733459473
Epoch: 4, Steps: 13 | Train Loss: 0.823 Vali Loss: 1.794 Vali Acc: 0.517 Test Loss: 1.794 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.669306039810181
Epoch: 5, Steps: 13 | Train Loss: 0.556 Vali Loss: 1.260 Vali Acc: 0.544 Test Loss: 1.260 Test Acc: 0.544
Validation loss decreased (-0.538879 --> -0.544432).  Saving model ...
Epoch: 6 cost time: 7.274351119995117
Epoch: 6, Steps: 13 | Train Loss: 0.379 Vali Loss: 1.348 Vali Acc: 0.578 Test Loss: 1.348 Test Acc: 0.578
Validation loss decreased (-0.544432 --> -0.577764).  Saving model ...
Epoch: 7 cost time: 7.804644584655762
Epoch: 7, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.670 Vali Acc: 0.533 Test Loss: 1.670 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.271049737930298
Epoch: 8, Steps: 13 | Train Loss: 0.597 Vali Loss: 2.174 Vali Acc: 0.533 Test Loss: 2.174 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.204314231872559
Epoch: 9, Steps: 13 | Train Loss: 0.302 Vali Loss: 2.170 Vali Acc: 0.544 Test Loss: 2.170 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.8600687980651855
Epoch: 10, Steps: 13 | Train Loss: 0.498 Vali Loss: 2.654 Vali Acc: 0.528 Test Loss: 2.654 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.359842538833618
Epoch: 11, Steps: 13 | Train Loss: 0.209 Vali Loss: 3.052 Vali Acc: 0.567 Test Loss: 3.052 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.002579689025879
Epoch: 12, Steps: 13 | Train Loss: 0.131 Vali Loss: 3.453 Vali Acc: 0.533 Test Loss: 3.453 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.853445768356323
Epoch: 13, Steps: 13 | Train Loss: 0.439 Vali Loss: 4.352 Vali Acc: 0.544 Test Loss: 4.352 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.537351608276367
Epoch: 14, Steps: 13 | Train Loss: 0.446 Vali Loss: 4.191 Vali Acc: 0.539 Test Loss: 4.191 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.49927544593811
Epoch: 15, Steps: 13 | Train Loss: 0.260 Vali Loss: 5.104 Vali Acc: 0.483 Test Loss: 5.104 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.780346155166626
Epoch: 16, Steps: 13 | Train Loss: 0.256 Vali Loss: 5.105 Vali Acc: 0.522 Test Loss: 5.105 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 4015618
model size : 25.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.29673147201538
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.916 Vali Acc: 0.561 Test Loss: 0.916 Test Acc: 0.561
Validation loss decreased (inf --> -0.561102).  Saving model ...
Epoch: 2 cost time: 5.587271451950073
Epoch: 2, Steps: 13 | Train Loss: 0.738 Vali Loss: 1.584 Vali Acc: 0.506 Test Loss: 1.584 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.098893642425537
Epoch: 3, Steps: 13 | Train Loss: 0.929 Vali Loss: 1.908 Vali Acc: 0.511 Test Loss: 1.908 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.911963701248169
Epoch: 4, Steps: 13 | Train Loss: 1.091 Vali Loss: 2.029 Vali Acc: 0.522 Test Loss: 2.029 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.1422436237335205
Epoch: 5, Steps: 13 | Train Loss: 0.807 Vali Loss: 1.106 Vali Acc: 0.517 Test Loss: 1.106 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.504532337188721
Epoch: 6, Steps: 13 | Train Loss: 0.576 Vali Loss: 2.178 Vali Acc: 0.522 Test Loss: 2.178 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.173115253448486
Epoch: 7, Steps: 13 | Train Loss: 1.309 Vali Loss: 2.866 Vali Acc: 0.522 Test Loss: 2.866 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.12422251701355
Epoch: 8, Steps: 13 | Train Loss: 0.772 Vali Loss: 2.424 Vali Acc: 0.533 Test Loss: 2.424 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.0051429271698
Epoch: 9, Steps: 13 | Train Loss: 0.767 Vali Loss: 2.092 Vali Acc: 0.522 Test Loss: 2.092 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.652406215667725
Epoch: 10, Steps: 13 | Train Loss: 0.668 Vali Loss: 2.664 Vali Acc: 0.511 Test Loss: 2.664 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.331674098968506
Epoch: 11, Steps: 13 | Train Loss: 0.439 Vali Loss: 2.253 Vali Acc: 0.528 Test Loss: 2.253 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 4015618
model size : 25.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 15.432441234588623
Epoch: 1, Steps: 13 | Train Loss: 0.721 Vali Loss: 1.024 Vali Acc: 0.500 Test Loss: 1.024 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 15.332139730453491
Epoch: 2, Steps: 13 | Train Loss: 1.000 Vali Loss: 2.387 Vali Acc: 0.506 Test Loss: 2.387 Test Acc: 0.506
Validation loss decreased (-0.499990 --> -0.505532).  Saving model ...
Epoch: 3 cost time: 13.108395099639893
Epoch: 3, Steps: 13 | Train Loss: 0.650 Vali Loss: 2.051 Vali Acc: 0.494 Test Loss: 2.051 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.270203590393066
Epoch: 4, Steps: 13 | Train Loss: 0.642 Vali Loss: 2.308 Vali Acc: 0.483 Test Loss: 2.308 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.126986742019653
Epoch: 5, Steps: 13 | Train Loss: 0.424 Vali Loss: 2.359 Vali Acc: 0.517 Test Loss: 2.359 Test Acc: 0.517
Validation loss decreased (-0.505532 --> -0.516643).  Saving model ...
Epoch: 6 cost time: 12.871918678283691
Epoch: 6, Steps: 13 | Train Loss: 0.290 Vali Loss: 3.693 Vali Acc: 0.494 Test Loss: 3.693 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.278666734695435
Epoch: 7, Steps: 13 | Train Loss: 0.938 Vali Loss: 5.841 Vali Acc: 0.533 Test Loss: 5.841 Test Acc: 0.533
Validation loss decreased (-0.516643 --> -0.533275).  Saving model ...
Epoch: 8 cost time: 11.935437202453613
Epoch: 8, Steps: 13 | Train Loss: 1.154 Vali Loss: 3.972 Vali Acc: 0.489 Test Loss: 3.972 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.202144145965576
Epoch: 9, Steps: 13 | Train Loss: 0.633 Vali Loss: 3.908 Vali Acc: 0.467 Test Loss: 3.908 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.958163022994995
Epoch: 10, Steps: 13 | Train Loss: 0.557 Vali Loss: 5.022 Vali Acc: 0.517 Test Loss: 5.022 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.719467163085938
Epoch: 11, Steps: 13 | Train Loss: 0.207 Vali Loss: 5.986 Vali Acc: 0.494 Test Loss: 5.986 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.313914060592651
Epoch: 12, Steps: 13 | Train Loss: 0.632 Vali Loss: 7.131 Vali Acc: 0.461 Test Loss: 7.131 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.945101499557495
Epoch: 13, Steps: 13 | Train Loss: 1.751 Vali Loss: 7.076 Vali Acc: 0.500 Test Loss: 7.076 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 13.329462051391602
Epoch: 14, Steps: 13 | Train Loss: 0.360 Vali Loss: 9.232 Vali Acc: 0.433 Test Loss: 9.232 Test Acc: 0.433
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.422930002212524
Epoch: 15, Steps: 13 | Train Loss: 0.706 Vali Loss: 10.148 Vali Acc: 0.506 Test Loss: 10.148 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.803474426269531
Epoch: 16, Steps: 13 | Train Loss: 0.912 Vali Loss: 9.927 Vali Acc: 0.450 Test Loss: 9.927 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.758644819259644
Epoch: 17, Steps: 13 | Train Loss: 0.215 Vali Loss: 12.048 Vali Acc: 0.522 Test Loss: 12.048 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 3622402
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 12.916268825531006
Epoch: 1, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.934 Vali Acc: 0.528 Test Loss: 0.934 Test Acc: 0.528
Validation loss decreased (inf --> -0.527768).  Saving model ...
Epoch: 2 cost time: 13.239156246185303
Epoch: 2, Steps: 13 | Train Loss: 0.802 Vali Loss: 1.996 Vali Acc: 0.544 Test Loss: 1.996 Test Acc: 0.544
Validation loss decreased (-0.527768 --> -0.544424).  Saving model ...
Epoch: 3 cost time: 14.202307939529419
Epoch: 3, Steps: 13 | Train Loss: 0.653 Vali Loss: 2.093 Vali Acc: 0.483 Test Loss: 2.093 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.108249187469482
Epoch: 4, Steps: 13 | Train Loss: 0.644 Vali Loss: 2.101 Vali Acc: 0.511 Test Loss: 2.101 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.133701086044312
Epoch: 5, Steps: 13 | Train Loss: 0.448 Vali Loss: 2.673 Vali Acc: 0.467 Test Loss: 2.673 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.923094511032104
Epoch: 6, Steps: 13 | Train Loss: 0.386 Vali Loss: 3.113 Vali Acc: 0.467 Test Loss: 3.113 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.084167957305908
Epoch: 7, Steps: 13 | Train Loss: 0.382 Vali Loss: 3.767 Vali Acc: 0.483 Test Loss: 3.767 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.926944494247437
Epoch: 8, Steps: 13 | Train Loss: 0.225 Vali Loss: 4.013 Vali Acc: 0.511 Test Loss: 4.013 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.939468383789062
Epoch: 9, Steps: 13 | Train Loss: 0.618 Vali Loss: 5.202 Vali Acc: 0.467 Test Loss: 5.202 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.46442437171936
Epoch: 10, Steps: 13 | Train Loss: 0.141 Vali Loss: 5.104 Vali Acc: 0.500 Test Loss: 5.104 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.671767711639404
Epoch: 11, Steps: 13 | Train Loss: 0.049 Vali Loss: 5.973 Vali Acc: 0.478 Test Loss: 5.973 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 11.87223219871521
Epoch: 12, Steps: 13 | Train Loss: 0.234 Vali Loss: 5.682 Vali Acc: 0.494 Test Loss: 5.682 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 3622402
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 10.888803958892822
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.960 Vali Acc: 0.533 Test Loss: 0.960 Test Acc: 0.533
Validation loss decreased (inf --> -0.533324).  Saving model ...
Epoch: 2 cost time: 9.591634273529053
Epoch: 2, Steps: 13 | Train Loss: 0.986 Vali Loss: 2.762 Vali Acc: 0.528 Test Loss: 2.762 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.802971124649048
Epoch: 3, Steps: 13 | Train Loss: 0.659 Vali Loss: 1.859 Vali Acc: 0.467 Test Loss: 1.859 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.044424533843994
Epoch: 4, Steps: 13 | Train Loss: 0.789 Vali Loss: 3.134 Vali Acc: 0.439 Test Loss: 3.134 Test Acc: 0.439
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.22421383857727
Epoch: 5, Steps: 13 | Train Loss: 0.837 Vali Loss: 2.870 Vali Acc: 0.489 Test Loss: 2.870 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.076439380645752
Epoch: 6, Steps: 13 | Train Loss: 0.661 Vali Loss: 3.840 Vali Acc: 0.533 Test Loss: 3.840 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.650731086730957
Epoch: 7, Steps: 13 | Train Loss: 0.333 Vali Loss: 4.245 Vali Acc: 0.511 Test Loss: 4.245 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.475588083267212
Epoch: 8, Steps: 13 | Train Loss: 0.596 Vali Loss: 3.762 Vali Acc: 0.511 Test Loss: 3.762 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.790696859359741
Epoch: 9, Steps: 13 | Train Loss: 0.599 Vali Loss: 4.716 Vali Acc: 0.544 Test Loss: 4.716 Test Acc: 0.544
Validation loss decreased (-0.533324 --> -0.544397).  Saving model ...
Epoch: 10 cost time: 10.012524604797363
Epoch: 10, Steps: 13 | Train Loss: 0.660 Vali Loss: 5.761 Vali Acc: 0.511 Test Loss: 5.761 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.769785165786743
Epoch: 11, Steps: 13 | Train Loss: 0.644 Vali Loss: 5.829 Vali Acc: 0.483 Test Loss: 5.829 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.289528608322144
Epoch: 12, Steps: 13 | Train Loss: 0.212 Vali Loss: 6.714 Vali Acc: 0.506 Test Loss: 6.714 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.432512044906616
Epoch: 13, Steps: 13 | Train Loss: 0.230 Vali Loss: 6.370 Vali Acc: 0.494 Test Loss: 6.370 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.08694577217102
Epoch: 14, Steps: 13 | Train Loss: 0.100 Vali Loss: 6.699 Vali Acc: 0.483 Test Loss: 6.699 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.17708683013916
Epoch: 15, Steps: 13 | Train Loss: 0.353 Vali Loss: 9.808 Vali Acc: 0.472 Test Loss: 9.808 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.536478042602539
Epoch: 16, Steps: 13 | Train Loss: 0.594 Vali Loss: 8.168 Vali Acc: 0.450 Test Loss: 8.168 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.957009553909302
Epoch: 17, Steps: 13 | Train Loss: 0.204 Vali Loss: 10.199 Vali Acc: 0.489 Test Loss: 10.199 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.816871643066406
Epoch: 18, Steps: 13 | Train Loss: 0.171 Vali Loss: 9.961 Vali Acc: 0.461 Test Loss: 9.961 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.453969717025757
Epoch: 19, Steps: 13 | Train Loss: 0.670 Vali Loss: 9.616 Vali Acc: 0.500 Test Loss: 9.616 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 3622402
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.923641443252563
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.874 Vali Acc: 0.533 Test Loss: 0.874 Test Acc: 0.533
Validation loss decreased (inf --> -0.533325).  Saving model ...
Epoch: 2 cost time: 8.22896146774292
Epoch: 2, Steps: 13 | Train Loss: 0.946 Vali Loss: 2.982 Vali Acc: 0.506 Test Loss: 2.982 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.93599796295166
Epoch: 3, Steps: 13 | Train Loss: 0.750 Vali Loss: 1.759 Vali Acc: 0.489 Test Loss: 1.759 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.32869005203247
Epoch: 4, Steps: 13 | Train Loss: 1.334 Vali Loss: 3.935 Vali Acc: 0.500 Test Loss: 3.935 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.184982538223267
Epoch: 5, Steps: 13 | Train Loss: 0.998 Vali Loss: 3.363 Vali Acc: 0.506 Test Loss: 3.363 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.120573282241821
Epoch: 6, Steps: 13 | Train Loss: 0.380 Vali Loss: 2.948 Vali Acc: 0.506 Test Loss: 2.948 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.531371116638184
Epoch: 7, Steps: 13 | Train Loss: 0.438 Vali Loss: 3.123 Vali Acc: 0.472 Test Loss: 3.123 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.051027536392212
Epoch: 8, Steps: 13 | Train Loss: 0.458 Vali Loss: 3.604 Vali Acc: 0.500 Test Loss: 3.604 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.527756929397583
Epoch: 9, Steps: 13 | Train Loss: 1.780 Vali Loss: 4.326 Vali Acc: 0.528 Test Loss: 4.326 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.792553424835205
Epoch: 10, Steps: 13 | Train Loss: 0.882 Vali Loss: 6.904 Vali Acc: 0.539 Test Loss: 6.904 Test Acc: 0.539
Validation loss decreased (-0.533325 --> -0.538820).  Saving model ...
Epoch: 11 cost time: 7.0033650398254395
Epoch: 11, Steps: 13 | Train Loss: 0.678 Vali Loss: 9.356 Vali Acc: 0.517 Test Loss: 9.356 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.516027927398682
Epoch: 12, Steps: 13 | Train Loss: 0.383 Vali Loss: 6.890 Vali Acc: 0.467 Test Loss: 6.890 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.509326934814453
Epoch: 13, Steps: 13 | Train Loss: 0.144 Vali Loss: 7.229 Vali Acc: 0.467 Test Loss: 7.229 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.345568895339966
Epoch: 14, Steps: 13 | Train Loss: 0.091 Vali Loss: 6.905 Vali Acc: 0.494 Test Loss: 6.905 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.651310443878174
Epoch: 15, Steps: 13 | Train Loss: 0.186 Vali Loss: 7.545 Vali Acc: 0.494 Test Loss: 7.545 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.215977191925049
Epoch: 16, Steps: 13 | Train Loss: 0.125 Vali Loss: 11.246 Vali Acc: 0.522 Test Loss: 11.246 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.052563905715942
Epoch: 17, Steps: 13 | Train Loss: 0.494 Vali Loss: 9.077 Vali Acc: 0.511 Test Loss: 9.077 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.239522695541382
Epoch: 18, Steps: 13 | Train Loss: 1.013 Vali Loss: 17.442 Vali Acc: 0.500 Test Loss: 17.442 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.992752313613892
Epoch: 19, Steps: 13 | Train Loss: 2.104 Vali Loss: 16.739 Vali Acc: 0.506 Test Loss: 16.739 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.494959354400635
Epoch: 20, Steps: 13 | Train Loss: 1.436 Vali Loss: 10.898 Vali Acc: 0.494 Test Loss: 10.898 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 3622402
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.02523946762085
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.895 Vali Acc: 0.522 Test Loss: 0.895 Test Acc: 0.522
Validation loss decreased (inf --> -0.522213).  Saving model ...
Epoch: 2 cost time: 7.4516472816467285
Epoch: 2, Steps: 13 | Train Loss: 0.902 Vali Loss: 3.415 Vali Acc: 0.500 Test Loss: 3.415 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.74042820930481
Epoch: 3, Steps: 13 | Train Loss: 0.668 Vali Loss: 1.707 Vali Acc: 0.483 Test Loss: 1.707 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.855214357376099
Epoch: 4, Steps: 13 | Train Loss: 1.003 Vali Loss: 3.461 Vali Acc: 0.511 Test Loss: 3.461 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.63463830947876
Epoch: 5, Steps: 13 | Train Loss: 0.533 Vali Loss: 2.586 Vali Acc: 0.517 Test Loss: 2.586 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.302116632461548
Epoch: 6, Steps: 13 | Train Loss: 0.321 Vali Loss: 5.133 Vali Acc: 0.511 Test Loss: 5.133 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.034192800521851
Epoch: 7, Steps: 13 | Train Loss: 0.882 Vali Loss: 3.684 Vali Acc: 0.494 Test Loss: 3.684 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.8428802490234375
Epoch: 8, Steps: 13 | Train Loss: 0.515 Vali Loss: 4.052 Vali Acc: 0.461 Test Loss: 4.052 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.396692276000977
Epoch: 9, Steps: 13 | Train Loss: 0.163 Vali Loss: 4.680 Vali Acc: 0.489 Test Loss: 4.680 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.093005418777466
Epoch: 10, Steps: 13 | Train Loss: 0.069 Vali Loss: 4.579 Vali Acc: 0.511 Test Loss: 4.579 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.790881872177124
Epoch: 11, Steps: 13 | Train Loss: 0.329 Vali Loss: 5.298 Vali Acc: 0.494 Test Loss: 5.298 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 3622402
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.38514232635498
Epoch: 1, Steps: 13 | Train Loss: 0.820 Vali Loss: 0.832 Vali Acc: 0.550 Test Loss: 0.832 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 5.790578126907349
Epoch: 2, Steps: 13 | Train Loss: 0.862 Vali Loss: 2.335 Vali Acc: 0.500 Test Loss: 2.335 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.779462814331055
Epoch: 3, Steps: 13 | Train Loss: 0.594 Vali Loss: 1.822 Vali Acc: 0.539 Test Loss: 1.822 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.090983867645264
Epoch: 4, Steps: 13 | Train Loss: 0.523 Vali Loss: 2.612 Vali Acc: 0.494 Test Loss: 2.612 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.089301586151123
Epoch: 5, Steps: 13 | Train Loss: 0.680 Vali Loss: 2.537 Vali Acc: 0.500 Test Loss: 2.537 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.534688949584961
Epoch: 6, Steps: 13 | Train Loss: 0.246 Vali Loss: 2.364 Vali Acc: 0.528 Test Loss: 2.364 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.453406810760498
Epoch: 7, Steps: 13 | Train Loss: 0.472 Vali Loss: 3.962 Vali Acc: 0.506 Test Loss: 3.962 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.280152082443237
Epoch: 8, Steps: 13 | Train Loss: 0.847 Vali Loss: 3.715 Vali Acc: 0.500 Test Loss: 3.715 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.085629463195801
Epoch: 9, Steps: 13 | Train Loss: 0.564 Vali Loss: 5.224 Vali Acc: 0.506 Test Loss: 5.224 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.527999401092529
Epoch: 10, Steps: 13 | Train Loss: 0.921 Vali Loss: 5.017 Vali Acc: 0.533 Test Loss: 5.017 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.96271276473999
Epoch: 11, Steps: 13 | Train Loss: 0.167 Vali Loss: 5.480 Vali Acc: 0.500 Test Loss: 5.480 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 3622402
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.40353775024414
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 1.013 Vali Acc: 0.478 Test Loss: 1.013 Test Acc: 0.478
Validation loss decreased (inf --> -0.477768).  Saving model ...
Epoch: 2 cost time: 6.320892810821533
Epoch: 2, Steps: 13 | Train Loss: 0.906 Vali Loss: 3.564 Vali Acc: 0.489 Test Loss: 3.564 Test Acc: 0.489
Validation loss decreased (-0.477768 --> -0.488853).  Saving model ...
Epoch: 3 cost time: 6.245728254318237
Epoch: 3, Steps: 13 | Train Loss: 0.931 Vali Loss: 2.398 Vali Acc: 0.483 Test Loss: 2.398 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.759114742279053
Epoch: 4, Steps: 13 | Train Loss: 0.990 Vali Loss: 4.175 Vali Acc: 0.506 Test Loss: 4.175 Test Acc: 0.506
Validation loss decreased (-0.488853 --> -0.505514).  Saving model ...
Epoch: 5 cost time: 7.354873418807983
Epoch: 5, Steps: 13 | Train Loss: 0.963 Vali Loss: 3.769 Vali Acc: 0.500 Test Loss: 3.769 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.85059666633606
Epoch: 6, Steps: 13 | Train Loss: 1.110 Vali Loss: 3.239 Vali Acc: 0.428 Test Loss: 3.239 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.004762411117554
Epoch: 7, Steps: 13 | Train Loss: 0.452 Vali Loss: 3.442 Vali Acc: 0.483 Test Loss: 3.442 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.321969747543335
Epoch: 8, Steps: 13 | Train Loss: 0.490 Vali Loss: 3.762 Vali Acc: 0.456 Test Loss: 3.762 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.469660997390747
Epoch: 9, Steps: 13 | Train Loss: 0.176 Vali Loss: 3.795 Vali Acc: 0.483 Test Loss: 3.795 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.683129072189331
Epoch: 10, Steps: 13 | Train Loss: 0.324 Vali Loss: 5.078 Vali Acc: 0.444 Test Loss: 5.078 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.716841220855713
Epoch: 11, Steps: 13 | Train Loss: 0.532 Vali Loss: 5.608 Vali Acc: 0.456 Test Loss: 5.608 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.113055944442749
Epoch: 12, Steps: 13 | Train Loss: 0.548 Vali Loss: 6.711 Vali Acc: 0.461 Test Loss: 6.711 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.479829788208008
Epoch: 13, Steps: 13 | Train Loss: 0.492 Vali Loss: 6.006 Vali Acc: 0.456 Test Loss: 6.006 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.233969211578369
Epoch: 14, Steps: 13 | Train Loss: 0.323 Vali Loss: 6.967 Vali Acc: 0.444 Test Loss: 6.967 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5055555555555555
model parameter : 3622402
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.577411890029907
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.817 Vali Acc: 0.456 Test Loss: 0.817 Test Acc: 0.456
Validation loss decreased (inf --> -0.455547).  Saving model ...
Epoch: 2 cost time: 7.382833957672119
Epoch: 2, Steps: 13 | Train Loss: 0.909 Vali Loss: 3.598 Vali Acc: 0.500 Test Loss: 3.598 Test Acc: 0.500
Validation loss decreased (-0.455547 --> -0.499964).  Saving model ...
Epoch: 3 cost time: 7.4328978061676025
Epoch: 3, Steps: 13 | Train Loss: 0.779 Vali Loss: 1.923 Vali Acc: 0.444 Test Loss: 1.923 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.98698616027832
Epoch: 4, Steps: 13 | Train Loss: 0.575 Vali Loss: 2.317 Vali Acc: 0.472 Test Loss: 2.317 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.7248313426971436
Epoch: 5, Steps: 13 | Train Loss: 0.378 Vali Loss: 2.621 Vali Acc: 0.461 Test Loss: 2.621 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.1721882820129395
Epoch: 6, Steps: 13 | Train Loss: 0.246 Vali Loss: 2.963 Vali Acc: 0.467 Test Loss: 2.963 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.604814767837524
Epoch: 7, Steps: 13 | Train Loss: 0.583 Vali Loss: 6.751 Vali Acc: 0.489 Test Loss: 6.751 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.678709983825684
Epoch: 8, Steps: 13 | Train Loss: 0.693 Vali Loss: 4.040 Vali Acc: 0.439 Test Loss: 4.040 Test Acc: 0.439
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.945309400558472
Epoch: 9, Steps: 13 | Train Loss: 0.248 Vali Loss: 5.587 Vali Acc: 0.489 Test Loss: 5.587 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.115782737731934
Epoch: 10, Steps: 13 | Train Loss: 0.673 Vali Loss: 5.674 Vali Acc: 0.456 Test Loss: 5.674 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.4304046630859375
Epoch: 11, Steps: 13 | Train Loss: 0.603 Vali Loss: 7.362 Vali Acc: 0.506 Test Loss: 7.362 Test Acc: 0.506
Validation loss decreased (-0.499964 --> -0.505482).  Saving model ...
Epoch: 12 cost time: 6.218317985534668
Epoch: 12, Steps: 13 | Train Loss: 0.916 Vali Loss: 6.917 Vali Acc: 0.494 Test Loss: 6.917 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.269012212753296
Epoch: 13, Steps: 13 | Train Loss: 0.930 Vali Loss: 7.736 Vali Acc: 0.489 Test Loss: 7.736 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.553202152252197
Epoch: 14, Steps: 13 | Train Loss: 0.429 Vali Loss: 8.454 Vali Acc: 0.456 Test Loss: 8.454 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.258836507797241
Epoch: 15, Steps: 13 | Train Loss: 0.268 Vali Loss: 8.164 Vali Acc: 0.489 Test Loss: 8.164 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.29031229019165
Epoch: 16, Steps: 13 | Train Loss: 0.109 Vali Loss: 7.574 Vali Acc: 0.522 Test Loss: 7.574 Test Acc: 0.522
Validation loss decreased (-0.505482 --> -0.522146).  Saving model ...
Epoch: 17 cost time: 6.891752243041992
Epoch: 17, Steps: 13 | Train Loss: 0.068 Vali Loss: 8.019 Vali Acc: 0.483 Test Loss: 8.019 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.199798583984375
Epoch: 18, Steps: 13 | Train Loss: 0.199 Vali Loss: 8.993 Vali Acc: 0.500 Test Loss: 8.993 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.128692150115967
Epoch: 19, Steps: 13 | Train Loss: 0.149 Vali Loss: 11.275 Vali Acc: 0.506 Test Loss: 11.275 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.941609144210815
Epoch: 20, Steps: 13 | Train Loss: 0.590 Vali Loss: 10.628 Vali Acc: 0.467 Test Loss: 10.628 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.398391246795654
Epoch: 21, Steps: 13 | Train Loss: 0.271 Vali Loss: 11.117 Vali Acc: 0.461 Test Loss: 11.117 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.9410529136657715
Epoch: 22, Steps: 13 | Train Loss: 1.022 Vali Loss: 12.278 Vali Acc: 0.433 Test Loss: 12.278 Test Acc: 0.433
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.003728628158569
Epoch: 23, Steps: 13 | Train Loss: 0.447 Vali Loss: 13.824 Vali Acc: 0.456 Test Loss: 13.824 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.902488946914673
Epoch: 24, Steps: 13 | Train Loss: 0.315 Vali Loss: 15.523 Vali Acc: 0.467 Test Loss: 15.523 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.5139923095703125
Epoch: 25, Steps: 13 | Train Loss: 0.422 Vali Loss: 15.470 Vali Acc: 0.483 Test Loss: 15.470 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.148244619369507
Epoch: 26, Steps: 13 | Train Loss: 0.455 Vali Loss: 15.791 Vali Acc: 0.467 Test Loss: 15.791 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 3622402
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.072741508483887
Epoch: 1, Steps: 13 | Train Loss: 0.814 Vali Loss: 0.789 Vali Acc: 0.517 Test Loss: 0.789 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 6.664752960205078
Epoch: 2, Steps: 13 | Train Loss: 0.899 Vali Loss: 2.458 Vali Acc: 0.500 Test Loss: 2.458 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.549604177474976
Epoch: 3, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.857 Vali Acc: 0.539 Test Loss: 0.857 Test Acc: 0.539
Validation loss decreased (-0.516659 --> -0.538880).  Saving model ...
Epoch: 4 cost time: 6.953949451446533
Epoch: 4, Steps: 13 | Train Loss: 0.456 Vali Loss: 1.047 Vali Acc: 0.539 Test Loss: 1.047 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.01802396774292
Epoch: 5, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.221 Vali Acc: 0.528 Test Loss: 1.221 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.052096128463745
Epoch: 6, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.409 Vali Acc: 0.544 Test Loss: 1.409 Test Acc: 0.544
Validation loss decreased (-0.538880 --> -0.544430).  Saving model ...
Epoch: 7 cost time: 6.858725309371948
Epoch: 7, Steps: 13 | Train Loss: 0.417 Vali Loss: 1.587 Vali Acc: 0.567 Test Loss: 1.587 Test Acc: 0.567
Validation loss decreased (-0.544430 --> -0.566651).  Saving model ...
Epoch: 8 cost time: 6.273791074752808
Epoch: 8, Steps: 13 | Train Loss: 0.896 Vali Loss: 2.766 Vali Acc: 0.517 Test Loss: 2.766 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.855346918106079
Epoch: 9, Steps: 13 | Train Loss: 0.612 Vali Loss: 2.446 Vali Acc: 0.522 Test Loss: 2.446 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.694701671600342
Epoch: 10, Steps: 13 | Train Loss: 0.381 Vali Loss: 4.081 Vali Acc: 0.517 Test Loss: 4.081 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.770571708679199
Epoch: 11, Steps: 13 | Train Loss: 0.232 Vali Loss: 2.733 Vali Acc: 0.522 Test Loss: 2.733 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.800105094909668
Epoch: 12, Steps: 13 | Train Loss: 0.205 Vali Loss: 2.966 Vali Acc: 0.494 Test Loss: 2.966 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.5968286991119385
Epoch: 13, Steps: 13 | Train Loss: 0.430 Vali Loss: 3.123 Vali Acc: 0.511 Test Loss: 3.123 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.645519971847534
Epoch: 14, Steps: 13 | Train Loss: 0.573 Vali Loss: 3.591 Vali Acc: 0.517 Test Loss: 3.591 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.626512289047241
Epoch: 15, Steps: 13 | Train Loss: 1.063 Vali Loss: 5.166 Vali Acc: 0.567 Test Loss: 5.166 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.071055889129639
Epoch: 16, Steps: 13 | Train Loss: 0.233 Vali Loss: 5.806 Vali Acc: 0.511 Test Loss: 5.806 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.503741264343262
Epoch: 17, Steps: 13 | Train Loss: 0.383 Vali Loss: 4.779 Vali Acc: 0.539 Test Loss: 4.779 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 3622402
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.08038854598999
Epoch: 1, Steps: 13 | Train Loss: 0.799 Vali Loss: 0.854 Vali Acc: 0.556 Test Loss: 0.854 Test Acc: 0.556
Validation loss decreased (inf --> -0.555547).  Saving model ...
Epoch: 2 cost time: 6.66646146774292
Epoch: 2, Steps: 13 | Train Loss: 0.840 Vali Loss: 2.044 Vali Acc: 0.539 Test Loss: 2.044 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.949273109436035
Epoch: 3, Steps: 13 | Train Loss: 0.770 Vali Loss: 1.872 Vali Acc: 0.511 Test Loss: 1.872 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.640857458114624
Epoch: 4, Steps: 13 | Train Loss: 0.784 Vali Loss: 1.379 Vali Acc: 0.583 Test Loss: 1.379 Test Acc: 0.583
Validation loss decreased (-0.555547 --> -0.583320).  Saving model ...
Epoch: 5 cost time: 7.1125006675720215
Epoch: 5, Steps: 13 | Train Loss: 0.773 Vali Loss: 1.272 Vali Acc: 0.506 Test Loss: 1.272 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.299631357192993
Epoch: 6, Steps: 13 | Train Loss: 0.546 Vali Loss: 1.351 Vali Acc: 0.517 Test Loss: 1.351 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.2865517139434814
Epoch: 7, Steps: 13 | Train Loss: 0.581 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.734396696090698
Epoch: 8, Steps: 13 | Train Loss: 0.459 Vali Loss: 2.018 Vali Acc: 0.528 Test Loss: 2.018 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.915935039520264
Epoch: 9, Steps: 13 | Train Loss: 0.509 Vali Loss: 2.245 Vali Acc: 0.550 Test Loss: 2.245 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.90639853477478
Epoch: 10, Steps: 13 | Train Loss: 0.627 Vali Loss: 4.324 Vali Acc: 0.517 Test Loss: 4.324 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.96776270866394
Epoch: 11, Steps: 13 | Train Loss: 0.593 Vali Loss: 1.571 Vali Acc: 0.517 Test Loss: 1.571 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.374687910079956
Epoch: 12, Steps: 13 | Train Loss: 0.631 Vali Loss: 3.626 Vali Acc: 0.544 Test Loss: 3.626 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.5372302532196045
Epoch: 13, Steps: 13 | Train Loss: 0.667 Vali Loss: 3.496 Vali Acc: 0.550 Test Loss: 3.496 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.0073676109313965
Epoch: 14, Steps: 13 | Train Loss: 0.911 Vali Loss: 2.878 Vali Acc: 0.544 Test Loss: 2.878 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 3622402
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 13.426884174346924
Epoch: 1, Steps: 13 | Train Loss: 0.972 Vali Loss: 1.443 Vali Acc: 0.494 Test Loss: 1.443 Test Acc: 0.494
Validation loss decreased (inf --> -0.494430).  Saving model ...
Epoch: 2 cost time: 12.75145959854126
Epoch: 2, Steps: 13 | Train Loss: 1.035 Vali Loss: 1.778 Vali Acc: 0.522 Test Loss: 1.778 Test Acc: 0.522
Validation loss decreased (-0.494430 --> -0.522204).  Saving model ...
Epoch: 3 cost time: 11.961416721343994
Epoch: 3, Steps: 13 | Train Loss: 0.795 Vali Loss: 2.438 Vali Acc: 0.506 Test Loss: 2.438 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.025481224060059
Epoch: 4, Steps: 13 | Train Loss: 0.496 Vali Loss: 2.175 Vali Acc: 0.483 Test Loss: 2.175 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.229198694229126
Epoch: 5, Steps: 13 | Train Loss: 0.393 Vali Loss: 3.142 Vali Acc: 0.506 Test Loss: 3.142 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.189360857009888
Epoch: 6, Steps: 13 | Train Loss: 0.411 Vali Loss: 2.947 Vali Acc: 0.467 Test Loss: 2.947 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.951573848724365
Epoch: 7, Steps: 13 | Train Loss: 0.187 Vali Loss: 3.559 Vali Acc: 0.494 Test Loss: 3.559 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.457359075546265
Epoch: 8, Steps: 13 | Train Loss: 0.334 Vali Loss: 4.189 Vali Acc: 0.494 Test Loss: 4.189 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 11.911520719528198
Epoch: 9, Steps: 13 | Train Loss: 0.168 Vali Loss: 7.549 Vali Acc: 0.500 Test Loss: 7.549 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 11.207927465438843
Epoch: 10, Steps: 13 | Train Loss: 1.322 Vali Loss: 4.756 Vali Acc: 0.506 Test Loss: 4.756 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.370951414108276
Epoch: 11, Steps: 13 | Train Loss: 0.555 Vali Loss: 5.998 Vali Acc: 0.456 Test Loss: 5.998 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 14.95175838470459
Epoch: 12, Steps: 13 | Train Loss: 0.195 Vali Loss: 6.704 Vali Acc: 0.483 Test Loss: 6.704 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 3425794
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 14.01730465888977
Epoch: 1, Steps: 13 | Train Loss: 0.990 Vali Loss: 1.777 Vali Acc: 0.500 Test Loss: 1.777 Test Acc: 0.500
Validation loss decreased (inf --> -0.499982).  Saving model ...
Epoch: 2 cost time: 11.102701187133789
Epoch: 2, Steps: 13 | Train Loss: 0.745 Vali Loss: 1.248 Vali Acc: 0.494 Test Loss: 1.248 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.119312763214111
Epoch: 3, Steps: 13 | Train Loss: 0.530 Vali Loss: 1.469 Vali Acc: 0.522 Test Loss: 1.469 Test Acc: 0.522
Validation loss decreased (-0.499982 --> -0.522208).  Saving model ...
Epoch: 4 cost time: 11.424760341644287
Epoch: 4, Steps: 13 | Train Loss: 0.371 Vali Loss: 2.302 Vali Acc: 0.478 Test Loss: 2.302 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.671600341796875
Epoch: 5, Steps: 13 | Train Loss: 0.513 Vali Loss: 3.532 Vali Acc: 0.489 Test Loss: 3.532 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.226869583129883
Epoch: 6, Steps: 13 | Train Loss: 0.722 Vali Loss: 3.861 Vali Acc: 0.461 Test Loss: 3.861 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.603124856948853
Epoch: 7, Steps: 13 | Train Loss: 0.534 Vali Loss: 5.986 Vali Acc: 0.500 Test Loss: 5.986 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.484555006027222
Epoch: 8, Steps: 13 | Train Loss: 0.478 Vali Loss: 6.402 Vali Acc: 0.506 Test Loss: 6.402 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.696472883224487
Epoch: 9, Steps: 13 | Train Loss: 1.031 Vali Loss: 6.300 Vali Acc: 0.472 Test Loss: 6.300 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.799030542373657
Epoch: 10, Steps: 13 | Train Loss: 0.745 Vali Loss: 6.593 Vali Acc: 0.472 Test Loss: 6.593 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.426709413528442
Epoch: 11, Steps: 13 | Train Loss: 0.443 Vali Loss: 7.804 Vali Acc: 0.472 Test Loss: 7.804 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.94400668144226
Epoch: 12, Steps: 13 | Train Loss: 0.811 Vali Loss: 6.843 Vali Acc: 0.461 Test Loss: 6.843 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.119585275650024
Epoch: 13, Steps: 13 | Train Loss: 0.740 Vali Loss: 6.896 Vali Acc: 0.433 Test Loss: 6.896 Test Acc: 0.433
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 3425794
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 12.643028736114502
Epoch: 1, Steps: 13 | Train Loss: 0.891 Vali Loss: 1.097 Vali Acc: 0.506 Test Loss: 1.097 Test Acc: 0.506
Validation loss decreased (inf --> -0.505545).  Saving model ...
Epoch: 2 cost time: 9.388791561126709
Epoch: 2, Steps: 13 | Train Loss: 1.068 Vali Loss: 2.568 Vali Acc: 0.539 Test Loss: 2.568 Test Acc: 0.539
Validation loss decreased (-0.505545 --> -0.538863).  Saving model ...
Epoch: 3 cost time: 11.008317708969116
Epoch: 3, Steps: 13 | Train Loss: 1.485 Vali Loss: 1.884 Vali Acc: 0.450 Test Loss: 1.884 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.098006248474121
Epoch: 4, Steps: 13 | Train Loss: 1.062 Vali Loss: 2.177 Vali Acc: 0.478 Test Loss: 2.177 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.589321374893188
Epoch: 5, Steps: 13 | Train Loss: 0.549 Vali Loss: 3.182 Vali Acc: 0.550 Test Loss: 3.182 Test Acc: 0.550
Validation loss decreased (-0.538863 --> -0.549968).  Saving model ...
Epoch: 6 cost time: 9.624969005584717
Epoch: 6, Steps: 13 | Train Loss: 0.403 Vali Loss: 3.021 Vali Acc: 0.511 Test Loss: 3.021 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.988309621810913
Epoch: 7, Steps: 13 | Train Loss: 0.335 Vali Loss: 3.584 Vali Acc: 0.467 Test Loss: 3.584 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.332450151443481
Epoch: 8, Steps: 13 | Train Loss: 0.223 Vali Loss: 3.732 Vali Acc: 0.506 Test Loss: 3.732 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.881913185119629
Epoch: 9, Steps: 13 | Train Loss: 0.172 Vali Loss: 4.400 Vali Acc: 0.506 Test Loss: 4.400 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.775050163269043
Epoch: 10, Steps: 13 | Train Loss: 0.210 Vali Loss: 4.753 Vali Acc: 0.494 Test Loss: 4.753 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.968442916870117
Epoch: 11, Steps: 13 | Train Loss: 0.115 Vali Loss: 7.324 Vali Acc: 0.500 Test Loss: 7.324 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.318491458892822
Epoch: 12, Steps: 13 | Train Loss: 0.402 Vali Loss: 5.807 Vali Acc: 0.539 Test Loss: 5.807 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.291712522506714
Epoch: 13, Steps: 13 | Train Loss: 0.549 Vali Loss: 6.263 Vali Acc: 0.528 Test Loss: 6.263 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.05377984046936
Epoch: 14, Steps: 13 | Train Loss: 0.215 Vali Loss: 7.609 Vali Acc: 0.528 Test Loss: 7.609 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.124015092849731
Epoch: 15, Steps: 13 | Train Loss: 0.135 Vali Loss: 7.348 Vali Acc: 0.511 Test Loss: 7.348 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 3425794
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.33181357383728
Epoch: 1, Steps: 13 | Train Loss: 0.843 Vali Loss: 0.807 Vali Acc: 0.533 Test Loss: 0.807 Test Acc: 0.533
Validation loss decreased (inf --> -0.533325).  Saving model ...
Epoch: 2 cost time: 8.905554056167603
Epoch: 2, Steps: 13 | Train Loss: 0.561 Vali Loss: 1.321 Vali Acc: 0.533 Test Loss: 1.321 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.123893737792969
Epoch: 3, Steps: 13 | Train Loss: 0.543 Vali Loss: 2.360 Vali Acc: 0.506 Test Loss: 2.360 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.644773960113525
Epoch: 4, Steps: 13 | Train Loss: 0.528 Vali Loss: 2.068 Vali Acc: 0.467 Test Loss: 2.068 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.608158588409424
Epoch: 5, Steps: 13 | Train Loss: 0.549 Vali Loss: 2.558 Vali Acc: 0.478 Test Loss: 2.558 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.393449306488037
Epoch: 6, Steps: 13 | Train Loss: 0.593 Vali Loss: 3.991 Vali Acc: 0.467 Test Loss: 3.991 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.000909566879272
Epoch: 7, Steps: 13 | Train Loss: 0.331 Vali Loss: 2.957 Vali Acc: 0.494 Test Loss: 2.957 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.213481664657593
Epoch: 8, Steps: 13 | Train Loss: 0.176 Vali Loss: 3.490 Vali Acc: 0.494 Test Loss: 3.490 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.147819757461548
Epoch: 9, Steps: 13 | Train Loss: 0.499 Vali Loss: 5.325 Vali Acc: 0.494 Test Loss: 5.325 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.278979778289795
Epoch: 10, Steps: 13 | Train Loss: 0.426 Vali Loss: 5.231 Vali Acc: 0.506 Test Loss: 5.231 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.538364887237549
Epoch: 11, Steps: 13 | Train Loss: 1.110 Vali Loss: 6.362 Vali Acc: 0.472 Test Loss: 6.362 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 3425794
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.088331937789917
Epoch: 1, Steps: 13 | Train Loss: 0.896 Vali Loss: 1.023 Vali Acc: 0.506 Test Loss: 1.023 Test Acc: 0.506
Validation loss decreased (inf --> -0.505545).  Saving model ...
Epoch: 2 cost time: 7.179041624069214
Epoch: 2, Steps: 13 | Train Loss: 0.623 Vali Loss: 1.268 Vali Acc: 0.533 Test Loss: 1.268 Test Acc: 0.533
Validation loss decreased (-0.505545 --> -0.533321).  Saving model ...
Epoch: 3 cost time: 5.78477668762207
Epoch: 3, Steps: 13 | Train Loss: 0.549 Vali Loss: 1.976 Vali Acc: 0.494 Test Loss: 1.976 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.0118162631988525
Epoch: 4, Steps: 13 | Train Loss: 0.466 Vali Loss: 2.115 Vali Acc: 0.522 Test Loss: 2.115 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.088808536529541
Epoch: 5, Steps: 13 | Train Loss: 0.610 Vali Loss: 2.771 Vali Acc: 0.472 Test Loss: 2.771 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.919170141220093
Epoch: 6, Steps: 13 | Train Loss: 0.326 Vali Loss: 4.318 Vali Acc: 0.506 Test Loss: 4.318 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.601892709732056
Epoch: 7, Steps: 13 | Train Loss: 0.677 Vali Loss: 3.118 Vali Acc: 0.522 Test Loss: 3.118 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.622921705245972
Epoch: 8, Steps: 13 | Train Loss: 0.131 Vali Loss: 5.050 Vali Acc: 0.483 Test Loss: 5.050 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.839226007461548
Epoch: 9, Steps: 13 | Train Loss: 0.308 Vali Loss: 4.596 Vali Acc: 0.494 Test Loss: 4.596 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.067087650299072
Epoch: 10, Steps: 13 | Train Loss: 0.160 Vali Loss: 5.239 Vali Acc: 0.539 Test Loss: 5.239 Test Acc: 0.539
Validation loss decreased (-0.533321 --> -0.538837).  Saving model ...
Epoch: 11 cost time: 8.163851976394653
Epoch: 11, Steps: 13 | Train Loss: 0.608 Vali Loss: 7.356 Vali Acc: 0.483 Test Loss: 7.356 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.118473052978516
Epoch: 12, Steps: 13 | Train Loss: 0.596 Vali Loss: 6.843 Vali Acc: 0.517 Test Loss: 6.843 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.609273195266724
Epoch: 13, Steps: 13 | Train Loss: 0.271 Vali Loss: 6.102 Vali Acc: 0.533 Test Loss: 6.102 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.651338815689087
Epoch: 14, Steps: 13 | Train Loss: 0.266 Vali Loss: 6.938 Vali Acc: 0.528 Test Loss: 6.938 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.1064817905426025
Epoch: 15, Steps: 13 | Train Loss: 0.159 Vali Loss: 7.282 Vali Acc: 0.522 Test Loss: 7.282 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.389098167419434
Epoch: 16, Steps: 13 | Train Loss: 0.068 Vali Loss: 7.699 Vali Acc: 0.494 Test Loss: 7.699 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.255125045776367
Epoch: 17, Steps: 13 | Train Loss: 0.082 Vali Loss: 8.644 Vali Acc: 0.539 Test Loss: 8.644 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.852240800857544
Epoch: 18, Steps: 13 | Train Loss: 0.141 Vali Loss: 8.723 Vali Acc: 0.522 Test Loss: 8.723 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.994391918182373
Epoch: 19, Steps: 13 | Train Loss: 0.187 Vali Loss: 9.284 Vali Acc: 0.539 Test Loss: 9.284 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.294487953186035
Epoch: 20, Steps: 13 | Train Loss: 0.239 Vali Loss: 12.172 Vali Acc: 0.467 Test Loss: 12.172 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 3425794
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.774366855621338
Epoch: 1, Steps: 13 | Train Loss: 0.943 Vali Loss: 1.459 Vali Acc: 0.506 Test Loss: 1.459 Test Acc: 0.506
Validation loss decreased (inf --> -0.505541).  Saving model ...
Epoch: 2 cost time: 6.42514443397522
Epoch: 2, Steps: 13 | Train Loss: 0.999 Vali Loss: 2.405 Vali Acc: 0.511 Test Loss: 2.405 Test Acc: 0.511
Validation loss decreased (-0.505541 --> -0.511087).  Saving model ...
Epoch: 3 cost time: 6.108163595199585
Epoch: 3, Steps: 13 | Train Loss: 1.047 Vali Loss: 1.999 Vali Acc: 0.506 Test Loss: 1.999 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.618511199951172
Epoch: 4, Steps: 13 | Train Loss: 0.482 Vali Loss: 1.872 Vali Acc: 0.556 Test Loss: 1.872 Test Acc: 0.556
Validation loss decreased (-0.511087 --> -0.555537).  Saving model ...
Epoch: 5 cost time: 5.52847146987915
Epoch: 5, Steps: 13 | Train Loss: 0.316 Vali Loss: 2.292 Vali Acc: 0.467 Test Loss: 2.292 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.751055479049683
Epoch: 6, Steps: 13 | Train Loss: 0.296 Vali Loss: 2.875 Vali Acc: 0.489 Test Loss: 2.875 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.156605005264282
Epoch: 7, Steps: 13 | Train Loss: 0.186 Vali Loss: 3.113 Vali Acc: 0.517 Test Loss: 3.113 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.390378713607788
Epoch: 8, Steps: 13 | Train Loss: 0.144 Vali Loss: 3.411 Vali Acc: 0.506 Test Loss: 3.411 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.57029914855957
Epoch: 9, Steps: 13 | Train Loss: 0.171 Vali Loss: 4.320 Vali Acc: 0.528 Test Loss: 4.320 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.90530800819397
Epoch: 10, Steps: 13 | Train Loss: 0.102 Vali Loss: 4.611 Vali Acc: 0.494 Test Loss: 4.611 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.320811748504639
Epoch: 11, Steps: 13 | Train Loss: 0.235 Vali Loss: 4.394 Vali Acc: 0.506 Test Loss: 4.394 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.661281108856201
Epoch: 12, Steps: 13 | Train Loss: 0.338 Vali Loss: 5.212 Vali Acc: 0.483 Test Loss: 5.212 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.91497015953064
Epoch: 13, Steps: 13 | Train Loss: 0.311 Vali Loss: 8.313 Vali Acc: 0.500 Test Loss: 8.313 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.607610464096069
Epoch: 14, Steps: 13 | Train Loss: 0.898 Vali Loss: 7.494 Vali Acc: 0.500 Test Loss: 7.494 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 3425794
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.576758861541748
Epoch: 1, Steps: 13 | Train Loss: 0.844 Vali Loss: 1.238 Vali Acc: 0.494 Test Loss: 1.238 Test Acc: 0.494
Validation loss decreased (inf --> -0.494432).  Saving model ...
Epoch: 2 cost time: 6.126142263412476
Epoch: 2, Steps: 13 | Train Loss: 1.074 Vali Loss: 2.804 Vali Acc: 0.494 Test Loss: 2.804 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.363960266113281
Epoch: 3, Steps: 13 | Train Loss: 1.547 Vali Loss: 2.212 Vali Acc: 0.433 Test Loss: 2.212 Test Acc: 0.433
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.771222352981567
Epoch: 4, Steps: 13 | Train Loss: 0.819 Vali Loss: 2.374 Vali Acc: 0.444 Test Loss: 2.374 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.720127105712891
Epoch: 5, Steps: 13 | Train Loss: 0.901 Vali Loss: 2.804 Vali Acc: 0.461 Test Loss: 2.804 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.10252833366394
Epoch: 6, Steps: 13 | Train Loss: 0.668 Vali Loss: 3.025 Vali Acc: 0.467 Test Loss: 3.025 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.152912378311157
Epoch: 7, Steps: 13 | Train Loss: 0.981 Vali Loss: 3.223 Vali Acc: 0.494 Test Loss: 3.223 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.437868118286133
Epoch: 8, Steps: 13 | Train Loss: 0.918 Vali Loss: 6.657 Vali Acc: 0.528 Test Loss: 6.657 Test Acc: 0.528
Validation loss decreased (-0.494432 --> -0.527711).  Saving model ...
Epoch: 9 cost time: 6.7590553760528564
Epoch: 9, Steps: 13 | Train Loss: 1.788 Vali Loss: 6.786 Vali Acc: 0.500 Test Loss: 6.786 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.8065876960754395
Epoch: 10, Steps: 13 | Train Loss: 1.632 Vali Loss: 6.591 Vali Acc: 0.489 Test Loss: 6.591 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.081691265106201
Epoch: 11, Steps: 13 | Train Loss: 1.273 Vali Loss: 5.860 Vali Acc: 0.428 Test Loss: 5.860 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.533078670501709
Epoch: 12, Steps: 13 | Train Loss: 0.976 Vali Loss: 6.992 Vali Acc: 0.444 Test Loss: 6.992 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.644252061843872
Epoch: 13, Steps: 13 | Train Loss: 0.377 Vali Loss: 6.988 Vali Acc: 0.444 Test Loss: 6.988 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.06931471824646
Epoch: 14, Steps: 13 | Train Loss: 0.215 Vali Loss: 6.885 Vali Acc: 0.444 Test Loss: 6.885 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.386425733566284
Epoch: 15, Steps: 13 | Train Loss: 0.219 Vali Loss: 6.828 Vali Acc: 0.478 Test Loss: 6.828 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.154963731765747
Epoch: 16, Steps: 13 | Train Loss: 0.301 Vali Loss: 6.817 Vali Acc: 0.500 Test Loss: 6.817 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.7915284633636475
Epoch: 17, Steps: 13 | Train Loss: 0.137 Vali Loss: 7.011 Vali Acc: 0.494 Test Loss: 7.011 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.932066917419434
Epoch: 18, Steps: 13 | Train Loss: 0.220 Vali Loss: 7.431 Vali Acc: 0.494 Test Loss: 7.431 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 3425794
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.911276340484619
Epoch: 1, Steps: 13 | Train Loss: 0.870 Vali Loss: 1.508 Vali Acc: 0.494 Test Loss: 1.508 Test Acc: 0.494
Validation loss decreased (inf --> -0.494429).  Saving model ...
Epoch: 2 cost time: 6.0735650062561035
Epoch: 2, Steps: 13 | Train Loss: 0.833 Vali Loss: 1.783 Vali Acc: 0.517 Test Loss: 1.783 Test Acc: 0.517
Validation loss decreased (-0.494429 --> -0.516649).  Saving model ...
Epoch: 3 cost time: 6.211603879928589
Epoch: 3, Steps: 13 | Train Loss: 1.119 Vali Loss: 2.039 Vali Acc: 0.489 Test Loss: 2.039 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.138771057128906
Epoch: 4, Steps: 13 | Train Loss: 0.934 Vali Loss: 2.517 Vali Acc: 0.494 Test Loss: 2.517 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.9616475105285645
Epoch: 5, Steps: 13 | Train Loss: 0.901 Vali Loss: 2.920 Vali Acc: 0.483 Test Loss: 2.920 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.0027079582214355
Epoch: 6, Steps: 13 | Train Loss: 0.383 Vali Loss: 3.227 Vali Acc: 0.461 Test Loss: 3.227 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.120617866516113
Epoch: 7, Steps: 13 | Train Loss: 0.668 Vali Loss: 3.249 Vali Acc: 0.467 Test Loss: 3.249 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.080571889877319
Epoch: 8, Steps: 13 | Train Loss: 0.334 Vali Loss: 4.190 Vali Acc: 0.494 Test Loss: 4.190 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.982605695724487
Epoch: 9, Steps: 13 | Train Loss: 0.307 Vali Loss: 3.849 Vali Acc: 0.494 Test Loss: 3.849 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.105743169784546
Epoch: 10, Steps: 13 | Train Loss: 0.198 Vali Loss: 4.565 Vali Acc: 0.506 Test Loss: 4.565 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.252953052520752
Epoch: 11, Steps: 13 | Train Loss: 0.296 Vali Loss: 5.080 Vali Acc: 0.411 Test Loss: 5.080 Test Acc: 0.411
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.841991186141968
Epoch: 12, Steps: 13 | Train Loss: 0.172 Vali Loss: 5.032 Vali Acc: 0.433 Test Loss: 5.032 Test Acc: 0.433
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 3425794
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.507376194000244
Epoch: 1, Steps: 13 | Train Loss: 0.868 Vali Loss: 1.441 Vali Acc: 0.500 Test Loss: 1.441 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 5.826602220535278
Epoch: 2, Steps: 13 | Train Loss: 0.918 Vali Loss: 1.301 Vali Acc: 0.506 Test Loss: 1.301 Test Acc: 0.506
Validation loss decreased (-0.499986 --> -0.505543).  Saving model ...
Epoch: 3 cost time: 6.086638450622559
Epoch: 3, Steps: 13 | Train Loss: 0.895 Vali Loss: 1.019 Vali Acc: 0.511 Test Loss: 1.019 Test Acc: 0.511
Validation loss decreased (-0.505543 --> -0.511101).  Saving model ...
Epoch: 4 cost time: 6.491792678833008
Epoch: 4, Steps: 13 | Train Loss: 0.585 Vali Loss: 1.008 Vali Acc: 0.539 Test Loss: 1.008 Test Acc: 0.539
Validation loss decreased (-0.511101 --> -0.538879).  Saving model ...
Epoch: 5 cost time: 6.425691604614258
Epoch: 5, Steps: 13 | Train Loss: 0.537 Vali Loss: 1.211 Vali Acc: 0.539 Test Loss: 1.211 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.30424690246582
Epoch: 6, Steps: 13 | Train Loss: 0.455 Vali Loss: 2.257 Vali Acc: 0.528 Test Loss: 2.257 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.608368396759033
Epoch: 7, Steps: 13 | Train Loss: 1.134 Vali Loss: 2.098 Vali Acc: 0.522 Test Loss: 2.098 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.0770087242126465
Epoch: 8, Steps: 13 | Train Loss: 1.333 Vali Loss: 2.676 Vali Acc: 0.522 Test Loss: 2.676 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.302358865737915
Epoch: 9, Steps: 13 | Train Loss: 0.199 Vali Loss: 2.450 Vali Acc: 0.528 Test Loss: 2.450 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.274116039276123
Epoch: 10, Steps: 13 | Train Loss: 0.257 Vali Loss: 2.469 Vali Acc: 0.533 Test Loss: 2.469 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.284235715866089
Epoch: 11, Steps: 13 | Train Loss: 0.283 Vali Loss: 2.613 Vali Acc: 0.539 Test Loss: 2.613 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.717483043670654
Epoch: 12, Steps: 13 | Train Loss: 0.121 Vali Loss: 2.742 Vali Acc: 0.517 Test Loss: 2.742 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.908992052078247
Epoch: 13, Steps: 13 | Train Loss: 0.239 Vali Loss: 3.901 Vali Acc: 0.533 Test Loss: 3.901 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.152137994766235
Epoch: 14, Steps: 13 | Train Loss: 0.711 Vali Loss: 3.724 Vali Acc: 0.539 Test Loss: 3.724 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 3425794
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.31757116317749
Epoch: 1, Steps: 13 | Train Loss: 0.785 Vali Loss: 1.250 Vali Acc: 0.539 Test Loss: 1.250 Test Acc: 0.539
Validation loss decreased (inf --> -0.538876).  Saving model ...
Epoch: 2 cost time: 5.808722734451294
Epoch: 2, Steps: 13 | Train Loss: 0.809 Vali Loss: 1.397 Vali Acc: 0.550 Test Loss: 1.397 Test Acc: 0.550
Validation loss decreased (-0.538876 --> -0.549986).  Saving model ...
Epoch: 3 cost time: 6.397125720977783
Epoch: 3, Steps: 13 | Train Loss: 0.887 Vali Loss: 1.475 Vali Acc: 0.511 Test Loss: 1.475 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.450334787368774
Epoch: 4, Steps: 13 | Train Loss: 0.773 Vali Loss: 1.553 Vali Acc: 0.517 Test Loss: 1.553 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.823014974594116
Epoch: 5, Steps: 13 | Train Loss: 0.633 Vali Loss: 1.076 Vali Acc: 0.478 Test Loss: 1.076 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.7478718757629395
Epoch: 6, Steps: 13 | Train Loss: 0.832 Vali Loss: 2.317 Vali Acc: 0.539 Test Loss: 2.317 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.2188355922698975
Epoch: 7, Steps: 13 | Train Loss: 0.967 Vali Loss: 1.404 Vali Acc: 0.544 Test Loss: 1.404 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.308256387710571
Epoch: 8, Steps: 13 | Train Loss: 0.715 Vali Loss: 2.739 Vali Acc: 0.528 Test Loss: 2.739 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.963487148284912
Epoch: 9, Steps: 13 | Train Loss: 0.802 Vali Loss: 2.913 Vali Acc: 0.533 Test Loss: 2.913 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.705090761184692
Epoch: 10, Steps: 13 | Train Loss: 0.985 Vali Loss: 3.260 Vali Acc: 0.583 Test Loss: 3.260 Test Acc: 0.583
Validation loss decreased (-0.549986 --> -0.583301).  Saving model ...
Epoch: 11 cost time: 5.676120281219482
Epoch: 11, Steps: 13 | Train Loss: 1.167 Vali Loss: 2.682 Vali Acc: 0.544 Test Loss: 2.682 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.032273054122925
Epoch: 12, Steps: 13 | Train Loss: 0.680 Vali Loss: 2.302 Vali Acc: 0.517 Test Loss: 2.302 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.001258134841919
Epoch: 13, Steps: 13 | Train Loss: 0.896 Vali Loss: 2.194 Vali Acc: 0.483 Test Loss: 2.194 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.406626462936401
Epoch: 14, Steps: 13 | Train Loss: 0.445 Vali Loss: 3.345 Vali Acc: 0.506 Test Loss: 3.345 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.057063102722168
Epoch: 15, Steps: 13 | Train Loss: 0.646 Vali Loss: 2.299 Vali Acc: 0.572 Test Loss: 2.299 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.517148971557617
Epoch: 16, Steps: 13 | Train Loss: 0.616 Vali Loss: 2.321 Vali Acc: 0.522 Test Loss: 2.321 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.141235589981079
Epoch: 17, Steps: 13 | Train Loss: 0.625 Vali Loss: 3.191 Vali Acc: 0.517 Test Loss: 3.191 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.428658962249756
Epoch: 18, Steps: 13 | Train Loss: 0.657 Vali Loss: 3.136 Vali Acc: 0.533 Test Loss: 3.136 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.785671949386597
Epoch: 19, Steps: 13 | Train Loss: 0.688 Vali Loss: 3.594 Vali Acc: 0.556 Test Loss: 3.594 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.6263182163238525
Epoch: 20, Steps: 13 | Train Loss: 0.817 Vali Loss: 4.888 Vali Acc: 0.489 Test Loss: 4.888 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 3425794
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.756385564804077
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.729 Vali Acc: 0.539 Test Loss: 0.729 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 6.42426872253418
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.938 Vali Acc: 0.478 Test Loss: 0.938 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.6801979541778564
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.321168661117554
Epoch: 4, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.572 Vali Acc: 0.506 Test Loss: 1.572 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.085026502609253
Epoch: 5, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.818 Vali Acc: 0.461 Test Loss: 1.818 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.703821659088135
Epoch: 6, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.886 Vali Acc: 0.450 Test Loss: 1.886 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.704158544540405
Epoch: 7, Steps: 13 | Train Loss: 0.147 Vali Loss: 2.495 Vali Acc: 0.461 Test Loss: 2.495 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.728467702865601
Epoch: 8, Steps: 13 | Train Loss: 0.101 Vali Loss: 3.261 Vali Acc: 0.461 Test Loss: 3.261 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.407317399978638
Epoch: 9, Steps: 13 | Train Loss: 0.129 Vali Loss: 3.559 Vali Acc: 0.483 Test Loss: 3.559 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.115700244903564
Epoch: 10, Steps: 13 | Train Loss: 0.152 Vali Loss: 3.774 Vali Acc: 0.539 Test Loss: 3.774 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.707558631896973
Epoch: 11, Steps: 13 | Train Loss: 0.170 Vali Loss: 3.992 Vali Acc: 0.461 Test Loss: 3.992 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 2532098
model size : 14.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.771769523620605
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.730 Vali Acc: 0.567 Test Loss: 0.730 Test Acc: 0.567
Validation loss decreased (inf --> -0.566659).  Saving model ...
Epoch: 2 cost time: 8.263815641403198
Epoch: 2, Steps: 13 | Train Loss: 0.611 Vali Loss: 1.014 Vali Acc: 0.472 Test Loss: 1.014 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.922474145889282
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 1.221 Vali Acc: 0.456 Test Loss: 1.221 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.54586672782898
Epoch: 4, Steps: 13 | Train Loss: 0.481 Vali Loss: 1.461 Vali Acc: 0.450 Test Loss: 1.461 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.724564790725708
Epoch: 5, Steps: 13 | Train Loss: 0.253 Vali Loss: 1.924 Vali Acc: 0.506 Test Loss: 1.924 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.822635173797607
Epoch: 6, Steps: 13 | Train Loss: 0.215 Vali Loss: 2.361 Vali Acc: 0.578 Test Loss: 2.361 Test Acc: 0.578
Validation loss decreased (-0.566659 --> -0.577754).  Saving model ...
Epoch: 7 cost time: 7.090700149536133
Epoch: 7, Steps: 13 | Train Loss: 0.239 Vali Loss: 2.284 Vali Acc: 0.472 Test Loss: 2.284 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.998096704483032
Epoch: 8, Steps: 13 | Train Loss: 0.128 Vali Loss: 2.681 Vali Acc: 0.478 Test Loss: 2.681 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.951706409454346
Epoch: 9, Steps: 13 | Train Loss: 0.128 Vali Loss: 3.539 Vali Acc: 0.511 Test Loss: 3.539 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.578280210494995
Epoch: 10, Steps: 13 | Train Loss: 0.334 Vali Loss: 3.623 Vali Acc: 0.522 Test Loss: 3.623 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.886636018753052
Epoch: 11, Steps: 13 | Train Loss: 0.234 Vali Loss: 3.445 Vali Acc: 0.456 Test Loss: 3.445 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.310715198516846
Epoch: 12, Steps: 13 | Train Loss: 0.124 Vali Loss: 3.647 Vali Acc: 0.472 Test Loss: 3.647 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.745192289352417
Epoch: 13, Steps: 13 | Train Loss: 0.299 Vali Loss: 6.613 Vali Acc: 0.500 Test Loss: 6.613 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.076050519943237
Epoch: 14, Steps: 13 | Train Loss: 0.178 Vali Loss: 6.392 Vali Acc: 0.511 Test Loss: 6.392 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.424546480178833
Epoch: 15, Steps: 13 | Train Loss: 0.098 Vali Loss: 5.891 Vali Acc: 0.489 Test Loss: 5.891 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.685703039169312
Epoch: 16, Steps: 13 | Train Loss: 0.101 Vali Loss: 6.381 Vali Acc: 0.489 Test Loss: 6.381 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 2532098
model size : 14.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 9.025598049163818
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.730 Vali Acc: 0.544 Test Loss: 0.730 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 7.305986166000366
Epoch: 2, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.901 Vali Acc: 0.483 Test Loss: 0.901 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.689828634262085
Epoch: 3, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.267 Vali Acc: 0.478 Test Loss: 1.267 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.309128999710083
Epoch: 4, Steps: 13 | Train Loss: 0.442 Vali Loss: 1.427 Vali Acc: 0.494 Test Loss: 1.427 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.330420732498169
Epoch: 5, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.683 Vali Acc: 0.483 Test Loss: 1.683 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.533576250076294
Epoch: 6, Steps: 13 | Train Loss: 0.147 Vali Loss: 2.143 Vali Acc: 0.494 Test Loss: 2.143 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.158135175704956
Epoch: 7, Steps: 13 | Train Loss: 0.149 Vali Loss: 2.310 Vali Acc: 0.483 Test Loss: 2.310 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.545422315597534
Epoch: 8, Steps: 13 | Train Loss: 0.123 Vali Loss: 2.469 Vali Acc: 0.522 Test Loss: 2.469 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.517825603485107
Epoch: 9, Steps: 13 | Train Loss: 0.121 Vali Loss: 2.648 Vali Acc: 0.467 Test Loss: 2.648 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.222490072250366
Epoch: 10, Steps: 13 | Train Loss: 0.075 Vali Loss: 3.339 Vali Acc: 0.489 Test Loss: 3.339 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.031287431716919
Epoch: 11, Steps: 13 | Train Loss: 0.163 Vali Loss: 3.944 Vali Acc: 0.478 Test Loss: 3.944 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 2532098
model size : 14.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.741353750228882
Epoch: 1, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.744 Vali Acc: 0.522 Test Loss: 0.744 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 7.2435688972473145
Epoch: 2, Steps: 13 | Train Loss: 0.601 Vali Loss: 1.061 Vali Acc: 0.489 Test Loss: 1.061 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.1888346672058105
Epoch: 3, Steps: 13 | Train Loss: 0.596 Vali Loss: 1.985 Vali Acc: 0.506 Test Loss: 1.985 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.2941977977752686
Epoch: 4, Steps: 13 | Train Loss: 0.462 Vali Loss: 1.356 Vali Acc: 0.450 Test Loss: 1.356 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.368910551071167
Epoch: 5, Steps: 13 | Train Loss: 0.266 Vali Loss: 2.061 Vali Acc: 0.483 Test Loss: 2.061 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.220051288604736
Epoch: 6, Steps: 13 | Train Loss: 0.278 Vali Loss: 1.970 Vali Acc: 0.494 Test Loss: 1.970 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.454638957977295
Epoch: 7, Steps: 13 | Train Loss: 0.143 Vali Loss: 2.095 Vali Acc: 0.467 Test Loss: 2.095 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.51289176940918
Epoch: 8, Steps: 13 | Train Loss: 0.148 Vali Loss: 2.764 Vali Acc: 0.450 Test Loss: 2.764 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.149771690368652
Epoch: 9, Steps: 13 | Train Loss: 0.099 Vali Loss: 3.737 Vali Acc: 0.478 Test Loss: 3.737 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.770000696182251
Epoch: 10, Steps: 13 | Train Loss: 0.093 Vali Loss: 3.011 Vali Acc: 0.461 Test Loss: 3.011 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.869309186935425
Epoch: 11, Steps: 13 | Train Loss: 0.147 Vali Loss: 4.113 Vali Acc: 0.500 Test Loss: 4.113 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 2532098
model size : 14.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.067793130874634
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.742 Vali Acc: 0.522 Test Loss: 0.742 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 5.9606029987335205
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 1.065 Vali Acc: 0.539 Test Loss: 1.065 Test Acc: 0.539
Validation loss decreased (-0.522215 --> -0.538878).  Saving model ...
Epoch: 3 cost time: 5.948249101638794
Epoch: 3, Steps: 13 | Train Loss: 0.568 Vali Loss: 1.911 Vali Acc: 0.522 Test Loss: 1.911 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.979755640029907
Epoch: 4, Steps: 13 | Train Loss: 0.461 Vali Loss: 1.384 Vali Acc: 0.483 Test Loss: 1.384 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.216271638870239
Epoch: 5, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.714 Vali Acc: 0.533 Test Loss: 1.714 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.913312196731567
Epoch: 6, Steps: 13 | Train Loss: 0.160 Vali Loss: 2.022 Vali Acc: 0.478 Test Loss: 2.022 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.2378013134002686
Epoch: 7, Steps: 13 | Train Loss: 0.112 Vali Loss: 2.346 Vali Acc: 0.528 Test Loss: 2.346 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.434297800064087
Epoch: 8, Steps: 13 | Train Loss: 0.104 Vali Loss: 3.008 Vali Acc: 0.467 Test Loss: 3.008 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.146169424057007
Epoch: 9, Steps: 13 | Train Loss: 0.139 Vali Loss: 3.087 Vali Acc: 0.522 Test Loss: 3.087 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.806796073913574
Epoch: 10, Steps: 13 | Train Loss: 0.131 Vali Loss: 3.943 Vali Acc: 0.500 Test Loss: 3.943 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.460118055343628
Epoch: 11, Steps: 13 | Train Loss: 0.176 Vali Loss: 4.070 Vali Acc: 0.506 Test Loss: 4.070 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.922036409378052
Epoch: 12, Steps: 13 | Train Loss: 0.132 Vali Loss: 4.074 Vali Acc: 0.450 Test Loss: 4.074 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 2532098
model size : 14.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.654259443283081
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 5.7983925342559814
Epoch: 2, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.914 Vali Acc: 0.461 Test Loss: 0.914 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.11048150062561
Epoch: 3, Steps: 13 | Train Loss: 0.494 Vali Loss: 1.564 Vali Acc: 0.528 Test Loss: 1.564 Test Acc: 0.528
Validation loss decreased (-0.499992 --> -0.527762).  Saving model ...
Epoch: 4 cost time: 5.614914655685425
Epoch: 4, Steps: 13 | Train Loss: 0.416 Vali Loss: 1.333 Vali Acc: 0.483 Test Loss: 1.333 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.435269832611084
Epoch: 5, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.861 Vali Acc: 0.533 Test Loss: 1.861 Test Acc: 0.533
Validation loss decreased (-0.527762 --> -0.533315).  Saving model ...
Epoch: 6 cost time: 5.881969451904297
Epoch: 6, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.876 Vali Acc: 0.528 Test Loss: 1.876 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.744529724121094
Epoch: 7, Steps: 13 | Train Loss: 0.295 Vali Loss: 2.735 Vali Acc: 0.461 Test Loss: 2.735 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.3984386920928955
Epoch: 8, Steps: 13 | Train Loss: 0.271 Vali Loss: 2.572 Vali Acc: 0.500 Test Loss: 2.572 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.959164381027222
Epoch: 9, Steps: 13 | Train Loss: 0.194 Vali Loss: 2.797 Vali Acc: 0.517 Test Loss: 2.797 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.869664907455444
Epoch: 10, Steps: 13 | Train Loss: 0.062 Vali Loss: 3.112 Vali Acc: 0.500 Test Loss: 3.112 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.790076971054077
Epoch: 11, Steps: 13 | Train Loss: 0.042 Vali Loss: 3.327 Vali Acc: 0.494 Test Loss: 3.327 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.8001580238342285
Epoch: 12, Steps: 13 | Train Loss: 0.108 Vali Loss: 3.676 Vali Acc: 0.500 Test Loss: 3.676 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.763997316360474
Epoch: 13, Steps: 13 | Train Loss: 0.053 Vali Loss: 4.123 Vali Acc: 0.528 Test Loss: 4.123 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.7833757400512695
Epoch: 14, Steps: 13 | Train Loss: 0.109 Vali Loss: 4.487 Vali Acc: 0.478 Test Loss: 4.487 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.757985830307007
Epoch: 15, Steps: 13 | Train Loss: 0.104 Vali Loss: 4.714 Vali Acc: 0.500 Test Loss: 4.714 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 2532098
model size : 14.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.192816734313965
Epoch: 1, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.827 Vali Acc: 0.506 Test Loss: 0.827 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 5.621395826339722
Epoch: 2, Steps: 13 | Train Loss: 0.628 Vali Loss: 1.122 Vali Acc: 0.478 Test Loss: 1.122 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.5817601680755615
Epoch: 3, Steps: 13 | Train Loss: 0.593 Vali Loss: 2.025 Vali Acc: 0.517 Test Loss: 2.025 Test Acc: 0.517
Validation loss decreased (-0.505547 --> -0.516646).  Saving model ...
Epoch: 4 cost time: 5.240573167800903
Epoch: 4, Steps: 13 | Train Loss: 0.575 Vali Loss: 1.433 Vali Acc: 0.478 Test Loss: 1.433 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.713565826416016
Epoch: 5, Steps: 13 | Train Loss: 0.419 Vali Loss: 1.712 Vali Acc: 0.489 Test Loss: 1.712 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.308717489242554
Epoch: 6, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.904 Vali Acc: 0.472 Test Loss: 1.904 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.413835525512695
Epoch: 7, Steps: 13 | Train Loss: 0.394 Vali Loss: 2.295 Vali Acc: 0.489 Test Loss: 2.295 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.577272176742554
Epoch: 8, Steps: 13 | Train Loss: 0.416 Vali Loss: 2.437 Vali Acc: 0.467 Test Loss: 2.437 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.5421059131622314
Epoch: 9, Steps: 13 | Train Loss: 0.266 Vali Loss: 2.803 Vali Acc: 0.472 Test Loss: 2.803 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.870930433273315
Epoch: 10, Steps: 13 | Train Loss: 0.200 Vali Loss: 2.531 Vali Acc: 0.478 Test Loss: 2.531 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.17259407043457
Epoch: 11, Steps: 13 | Train Loss: 0.357 Vali Loss: 3.497 Vali Acc: 0.450 Test Loss: 3.497 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.82276177406311
Epoch: 12, Steps: 13 | Train Loss: 0.386 Vali Loss: 3.809 Vali Acc: 0.494 Test Loss: 3.809 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.490684509277344
Epoch: 13, Steps: 13 | Train Loss: 0.148 Vali Loss: 3.881 Vali Acc: 0.428 Test Loss: 3.881 Test Acc: 0.428
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 2532098
model size : 14.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.02276611328125
Epoch: 1, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.783 Vali Acc: 0.539 Test Loss: 0.783 Test Acc: 0.539
Validation loss decreased (inf --> -0.538881).  Saving model ...
Epoch: 2 cost time: 5.204070568084717
Epoch: 2, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.986 Vali Acc: 0.478 Test Loss: 0.986 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.992610931396484
Epoch: 3, Steps: 13 | Train Loss: 0.421 Vali Loss: 1.388 Vali Acc: 0.489 Test Loss: 1.388 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.987649917602539
Epoch: 4, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.421 Vali Acc: 0.489 Test Loss: 1.421 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.675360202789307
Epoch: 5, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.776 Vali Acc: 0.494 Test Loss: 1.776 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.24835729598999
Epoch: 6, Steps: 13 | Train Loss: 0.312 Vali Loss: 2.591 Vali Acc: 0.478 Test Loss: 2.591 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.672679662704468
Epoch: 7, Steps: 13 | Train Loss: 0.210 Vali Loss: 2.481 Vali Acc: 0.511 Test Loss: 2.481 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.791177749633789
Epoch: 8, Steps: 13 | Train Loss: 0.191 Vali Loss: 2.779 Vali Acc: 0.478 Test Loss: 2.779 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.295182228088379
Epoch: 9, Steps: 13 | Train Loss: 0.338 Vali Loss: 2.585 Vali Acc: 0.494 Test Loss: 2.585 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.573606491088867
Epoch: 10, Steps: 13 | Train Loss: 0.136 Vali Loss: 3.030 Vali Acc: 0.478 Test Loss: 3.030 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.639289617538452
Epoch: 11, Steps: 13 | Train Loss: 0.127 Vali Loss: 3.363 Vali Acc: 0.450 Test Loss: 3.363 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 2532098
model size : 14.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.241120338439941
Epoch: 1, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.729 Vali Acc: 0.550 Test Loss: 0.729 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 5.64320182800293
Epoch: 2, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.692 Vali Acc: 0.533 Test Loss: 0.692 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.752969741821289
Epoch: 3, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.849 Vali Acc: 0.522 Test Loss: 0.849 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.462798357009888
Epoch: 4, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.845 Vali Acc: 0.567 Test Loss: 0.845 Test Acc: 0.567
Validation loss decreased (-0.549993 --> -0.566658).  Saving model ...
Epoch: 5 cost time: 5.36666202545166
Epoch: 5, Steps: 13 | Train Loss: 0.421 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.595200777053833
Epoch: 6, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.148 Vali Acc: 0.556 Test Loss: 1.148 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.269082307815552
Epoch: 7, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.368 Vali Acc: 0.556 Test Loss: 1.368 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.469294309616089
Epoch: 8, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.582 Vali Acc: 0.556 Test Loss: 1.582 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.230046510696411
Epoch: 9, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.872 Vali Acc: 0.544 Test Loss: 1.872 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.339857578277588
Epoch: 10, Steps: 13 | Train Loss: 0.181 Vali Loss: 2.330 Vali Acc: 0.567 Test Loss: 2.330 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.904735565185547
Epoch: 11, Steps: 13 | Train Loss: 0.193 Vali Loss: 2.516 Vali Acc: 0.556 Test Loss: 2.516 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.966798305511475
Epoch: 12, Steps: 13 | Train Loss: 0.097 Vali Loss: 2.789 Vali Acc: 0.544 Test Loss: 2.789 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.881482362747192
Epoch: 13, Steps: 13 | Train Loss: 0.095 Vali Loss: 3.444 Vali Acc: 0.539 Test Loss: 3.444 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.434903144836426
Epoch: 14, Steps: 13 | Train Loss: 0.237 Vali Loss: 3.431 Vali Acc: 0.533 Test Loss: 3.431 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 2532098
model size : 14.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.862844228744507
Epoch: 1, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.939 Vali Acc: 0.500 Test Loss: 0.939 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 5.484177350997925
Epoch: 2, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.844 Vali Acc: 0.528 Test Loss: 0.844 Test Acc: 0.528
Validation loss decreased (-0.499991 --> -0.527769).  Saving model ...
Epoch: 3 cost time: 5.487059831619263
Epoch: 3, Steps: 13 | Train Loss: 0.710 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.527769 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 5.701156377792358
Epoch: 4, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.886 Vali Acc: 0.544 Test Loss: 0.886 Test Acc: 0.544
Validation loss decreased (-0.533323 --> -0.544436).  Saving model ...
Epoch: 5 cost time: 5.312284469604492
Epoch: 5, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.979 Vali Acc: 0.517 Test Loss: 0.979 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.134849786758423
Epoch: 6, Steps: 13 | Train Loss: 0.625 Vali Loss: 1.069 Vali Acc: 0.578 Test Loss: 1.069 Test Acc: 0.578
Validation loss decreased (-0.544436 --> -0.577767).  Saving model ...
Epoch: 7 cost time: 5.472408771514893
Epoch: 7, Steps: 13 | Train Loss: 0.527 Vali Loss: 1.074 Vali Acc: 0.583 Test Loss: 1.074 Test Acc: 0.583
Validation loss decreased (-0.577767 --> -0.583323).  Saving model ...
Epoch: 8 cost time: 5.129140138626099
Epoch: 8, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.566 Vali Acc: 0.506 Test Loss: 1.566 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.511708736419678
Epoch: 9, Steps: 13 | Train Loss: 0.592 Vali Loss: 1.185 Vali Acc: 0.550 Test Loss: 1.185 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.619527816772461
Epoch: 10, Steps: 13 | Train Loss: 0.474 Vali Loss: 1.723 Vali Acc: 0.533 Test Loss: 1.723 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.686385154724121
Epoch: 11, Steps: 13 | Train Loss: 0.572 Vali Loss: 1.089 Vali Acc: 0.506 Test Loss: 1.089 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.790857315063477
Epoch: 12, Steps: 13 | Train Loss: 0.549 Vali Loss: 1.080 Vali Acc: 0.550 Test Loss: 1.080 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.721737623214722
Epoch: 13, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.524 Vali Acc: 0.550 Test Loss: 1.524 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.837586402893066
Epoch: 14, Steps: 13 | Train Loss: 0.528 Vali Loss: 2.221 Vali Acc: 0.533 Test Loss: 2.221 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.6678080558776855
Epoch: 15, Steps: 13 | Train Loss: 0.612 Vali Loss: 2.083 Vali Acc: 0.500 Test Loss: 2.083 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.900547027587891
Epoch: 16, Steps: 13 | Train Loss: 0.644 Vali Loss: 2.213 Vali Acc: 0.544 Test Loss: 2.213 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.364323377609253
Epoch: 17, Steps: 13 | Train Loss: 0.571 Vali Loss: 3.408 Vali Acc: 0.511 Test Loss: 3.408 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 2532098
model size : 14.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.0935704708099365
Epoch: 1, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.747 Vali Acc: 0.550 Test Loss: 0.747 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 7.444929838180542
Epoch: 2, Steps: 13 | Train Loss: 0.660 Vali Loss: 1.058 Vali Acc: 0.544 Test Loss: 1.058 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.775970458984375
Epoch: 3, Steps: 13 | Train Loss: 0.452 Vali Loss: 1.439 Vali Acc: 0.483 Test Loss: 1.439 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.954559087753296
Epoch: 4, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.497 Vali Acc: 0.511 Test Loss: 1.497 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.992794036865234
Epoch: 5, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.680 Vali Acc: 0.461 Test Loss: 1.680 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.6285645961761475
Epoch: 6, Steps: 13 | Train Loss: 0.248 Vali Loss: 2.676 Vali Acc: 0.544 Test Loss: 2.676 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.633068799972534
Epoch: 7, Steps: 13 | Train Loss: 0.342 Vali Loss: 2.457 Vali Acc: 0.461 Test Loss: 2.457 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.265087127685547
Epoch: 8, Steps: 13 | Train Loss: 0.472 Vali Loss: 3.641 Vali Acc: 0.517 Test Loss: 3.641 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.511675357818604
Epoch: 9, Steps: 13 | Train Loss: 0.480 Vali Loss: 2.858 Vali Acc: 0.511 Test Loss: 2.858 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.817041635513306
Epoch: 10, Steps: 13 | Train Loss: 0.073 Vali Loss: 3.716 Vali Acc: 0.433 Test Loss: 3.716 Test Acc: 0.433
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.159156084060669
Epoch: 11, Steps: 13 | Train Loss: 0.203 Vali Loss: 4.220 Vali Acc: 0.461 Test Loss: 4.220 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1745666
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.333706855773926
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 7.420560121536255
Epoch: 2, Steps: 13 | Train Loss: 0.629 Vali Loss: 1.081 Vali Acc: 0.456 Test Loss: 1.081 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.482363700866699
Epoch: 3, Steps: 13 | Train Loss: 0.402 Vali Loss: 1.475 Vali Acc: 0.478 Test Loss: 1.475 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.540072679519653
Epoch: 4, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.526 Vali Acc: 0.511 Test Loss: 1.526 Test Acc: 0.511
Validation loss decreased (-0.499993 --> -0.511096).  Saving model ...
Epoch: 5 cost time: 7.669990301132202
Epoch: 5, Steps: 13 | Train Loss: 0.287 Vali Loss: 2.006 Vali Acc: 0.478 Test Loss: 2.006 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.2395594120025635
Epoch: 6, Steps: 13 | Train Loss: 0.174 Vali Loss: 2.022 Vali Acc: 0.556 Test Loss: 2.022 Test Acc: 0.556
Validation loss decreased (-0.511096 --> -0.555535).  Saving model ...
Epoch: 7 cost time: 6.499981880187988
Epoch: 7, Steps: 13 | Train Loss: 0.214 Vali Loss: 2.686 Vali Acc: 0.472 Test Loss: 2.686 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.1999359130859375
Epoch: 8, Steps: 13 | Train Loss: 0.252 Vali Loss: 2.749 Vali Acc: 0.433 Test Loss: 2.749 Test Acc: 0.433
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.972831964492798
Epoch: 9, Steps: 13 | Train Loss: 0.149 Vali Loss: 3.047 Vali Acc: 0.478 Test Loss: 3.047 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.502176523208618
Epoch: 10, Steps: 13 | Train Loss: 0.129 Vali Loss: 3.539 Vali Acc: 0.472 Test Loss: 3.539 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.060661554336548
Epoch: 11, Steps: 13 | Train Loss: 0.079 Vali Loss: 3.692 Vali Acc: 0.439 Test Loss: 3.692 Test Acc: 0.439
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.369285821914673
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 4.472 Vali Acc: 0.489 Test Loss: 4.472 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.748974084854126
Epoch: 13, Steps: 13 | Train Loss: 0.061 Vali Loss: 4.686 Vali Acc: 0.478 Test Loss: 4.686 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.48884654045105
Epoch: 14, Steps: 13 | Train Loss: 0.078 Vali Loss: 5.052 Vali Acc: 0.544 Test Loss: 5.052 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.292090892791748
Epoch: 15, Steps: 13 | Train Loss: 0.150 Vali Loss: 4.890 Vali Acc: 0.467 Test Loss: 4.890 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.953720331192017
Epoch: 16, Steps: 13 | Train Loss: 0.103 Vali Loss: 4.932 Vali Acc: 0.478 Test Loss: 4.932 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 1745666
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.00421929359436
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.716 Vali Acc: 0.533 Test Loss: 0.716 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 6.629549980163574
Epoch: 2, Steps: 13 | Train Loss: 0.639 Vali Loss: 1.005 Vali Acc: 0.506 Test Loss: 1.005 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.519634962081909
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.6058080196380615
Epoch: 4, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.584 Vali Acc: 0.533 Test Loss: 1.584 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.675787687301636
Epoch: 5, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.665 Vali Acc: 0.511 Test Loss: 1.665 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.761931419372559
Epoch: 6, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.877 Vali Acc: 0.539 Test Loss: 1.877 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538870).  Saving model ...
Epoch: 7 cost time: 6.282839298248291
Epoch: 7, Steps: 13 | Train Loss: 0.214 Vali Loss: 2.213 Vali Acc: 0.500 Test Loss: 2.213 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.854186534881592
Epoch: 8, Steps: 13 | Train Loss: 0.124 Vali Loss: 2.659 Vali Acc: 0.478 Test Loss: 2.659 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.838976621627808
Epoch: 9, Steps: 13 | Train Loss: 0.084 Vali Loss: 2.648 Vali Acc: 0.483 Test Loss: 2.648 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.712353467941284
Epoch: 10, Steps: 13 | Train Loss: 0.173 Vali Loss: 4.278 Vali Acc: 0.494 Test Loss: 4.278 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.230317831039429
Epoch: 11, Steps: 13 | Train Loss: 0.177 Vali Loss: 4.065 Vali Acc: 0.511 Test Loss: 4.065 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.69307279586792
Epoch: 12, Steps: 13 | Train Loss: 0.154 Vali Loss: 3.910 Vali Acc: 0.461 Test Loss: 3.910 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.782350778579712
Epoch: 13, Steps: 13 | Train Loss: 0.062 Vali Loss: 4.011 Vali Acc: 0.494 Test Loss: 4.011 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.597386598587036
Epoch: 14, Steps: 13 | Train Loss: 0.030 Vali Loss: 4.370 Vali Acc: 0.478 Test Loss: 4.370 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.974008321762085
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 4.931 Vali Acc: 0.483 Test Loss: 4.931 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.615760803222656
Epoch: 16, Steps: 13 | Train Loss: 0.026 Vali Loss: 5.380 Vali Acc: 0.494 Test Loss: 5.380 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 1745666
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.668912649154663
Epoch: 1, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.736 Vali Acc: 0.522 Test Loss: 0.736 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 6.309917688369751
Epoch: 2, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.926 Vali Acc: 0.506 Test Loss: 0.926 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.748371362686157
Epoch: 3, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.184 Vali Acc: 0.489 Test Loss: 1.184 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.969564199447632
Epoch: 4, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.535 Vali Acc: 0.522 Test Loss: 1.535 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.567513942718506
Epoch: 5, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.528 Vali Acc: 0.522 Test Loss: 1.528 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.904029369354248
Epoch: 6, Steps: 13 | Train Loss: 0.245 Vali Loss: 2.490 Vali Acc: 0.539 Test Loss: 2.490 Test Acc: 0.539
Validation loss decreased (-0.522215 --> -0.538864).  Saving model ...
Epoch: 7 cost time: 5.595314025878906
Epoch: 7, Steps: 13 | Train Loss: 0.366 Vali Loss: 2.306 Vali Acc: 0.444 Test Loss: 2.306 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.2515997886657715
Epoch: 8, Steps: 13 | Train Loss: 0.244 Vali Loss: 2.266 Vali Acc: 0.494 Test Loss: 2.266 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.6457319259643555
Epoch: 9, Steps: 13 | Train Loss: 0.203 Vali Loss: 2.515 Vali Acc: 0.461 Test Loss: 2.515 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.885097980499268
Epoch: 10, Steps: 13 | Train Loss: 0.082 Vali Loss: 2.775 Vali Acc: 0.483 Test Loss: 2.775 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.007592439651489
Epoch: 11, Steps: 13 | Train Loss: 0.234 Vali Loss: 4.196 Vali Acc: 0.450 Test Loss: 4.196 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.083941459655762
Epoch: 12, Steps: 13 | Train Loss: 0.458 Vali Loss: 3.909 Vali Acc: 0.439 Test Loss: 3.909 Test Acc: 0.439
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.225511074066162
Epoch: 13, Steps: 13 | Train Loss: 0.154 Vali Loss: 4.656 Vali Acc: 0.506 Test Loss: 4.656 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.679548740386963
Epoch: 14, Steps: 13 | Train Loss: 0.029 Vali Loss: 4.750 Vali Acc: 0.472 Test Loss: 4.750 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.805670261383057
Epoch: 15, Steps: 13 | Train Loss: 0.119 Vali Loss: 4.952 Vali Acc: 0.439 Test Loss: 4.952 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.230081796646118
Epoch: 16, Steps: 13 | Train Loss: 0.137 Vali Loss: 5.814 Vali Acc: 0.461 Test Loss: 5.814 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 1745666
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.12157130241394
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 5.391724109649658
Epoch: 2, Steps: 13 | Train Loss: 0.621 Vali Loss: 1.488 Vali Acc: 0.539 Test Loss: 1.488 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.737874984741211
Epoch: 3, Steps: 13 | Train Loss: 0.524 Vali Loss: 1.160 Vali Acc: 0.517 Test Loss: 1.160 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.100087642669678
Epoch: 4, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.388 Vali Acc: 0.533 Test Loss: 1.388 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.734123468399048
Epoch: 5, Steps: 13 | Train Loss: 0.256 Vali Loss: 1.616 Vali Acc: 0.528 Test Loss: 1.616 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.211241722106934
Epoch: 6, Steps: 13 | Train Loss: 0.189 Vali Loss: 2.249 Vali Acc: 0.528 Test Loss: 2.249 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.302095413208008
Epoch: 7, Steps: 13 | Train Loss: 0.244 Vali Loss: 2.782 Vali Acc: 0.544 Test Loss: 2.782 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.46430230140686
Epoch: 8, Steps: 13 | Train Loss: 0.269 Vali Loss: 3.173 Vali Acc: 0.544 Test Loss: 3.173 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.533265113830566
Epoch: 9, Steps: 13 | Train Loss: 0.200 Vali Loss: 3.489 Vali Acc: 0.500 Test Loss: 3.489 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.42676854133606
Epoch: 10, Steps: 13 | Train Loss: 0.151 Vali Loss: 3.354 Vali Acc: 0.489 Test Loss: 3.354 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.190807104110718
Epoch: 11, Steps: 13 | Train Loss: 0.109 Vali Loss: 3.943 Vali Acc: 0.522 Test Loss: 3.943 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1745666
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.158474683761597
Epoch: 1, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.735 Vali Acc: 0.478 Test Loss: 0.735 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 4.830701112747192
Epoch: 2, Steps: 13 | Train Loss: 0.624 Vali Loss: 1.060 Vali Acc: 0.539 Test Loss: 1.060 Test Acc: 0.539
Validation loss decreased (-0.477770 --> -0.538878).  Saving model ...
Epoch: 3 cost time: 4.674585342407227
Epoch: 3, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.113 Vali Acc: 0.539 Test Loss: 1.113 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.642765998840332
Epoch: 4, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.247 Vali Acc: 0.539 Test Loss: 1.247 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.711062908172607
Epoch: 5, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.459 Vali Acc: 0.494 Test Loss: 1.459 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.494808197021484
Epoch: 6, Steps: 13 | Train Loss: 0.169 Vali Loss: 1.988 Vali Acc: 0.511 Test Loss: 1.988 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.93220853805542
Epoch: 7, Steps: 13 | Train Loss: 0.156 Vali Loss: 2.211 Vali Acc: 0.506 Test Loss: 2.211 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.019975900650024
Epoch: 8, Steps: 13 | Train Loss: 0.086 Vali Loss: 2.712 Vali Acc: 0.467 Test Loss: 2.712 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.567559242248535
Epoch: 9, Steps: 13 | Train Loss: 0.099 Vali Loss: 2.618 Vali Acc: 0.511 Test Loss: 2.618 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.7284767627716064
Epoch: 10, Steps: 13 | Train Loss: 0.136 Vali Loss: 3.125 Vali Acc: 0.500 Test Loss: 3.125 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.973414897918701
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 3.301 Vali Acc: 0.528 Test Loss: 3.301 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.669784784317017
Epoch: 12, Steps: 13 | Train Loss: 0.117 Vali Loss: 3.342 Vali Acc: 0.533 Test Loss: 3.342 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 1745666
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.826296806335449
Epoch: 1, Steps: 13 | Train Loss: 0.796 Vali Loss: 0.893 Vali Acc: 0.472 Test Loss: 0.893 Test Acc: 0.472
Validation loss decreased (inf --> -0.472213).  Saving model ...
Epoch: 2 cost time: 4.573039293289185
Epoch: 2, Steps: 13 | Train Loss: 0.731 Vali Loss: 1.539 Vali Acc: 0.511 Test Loss: 1.539 Test Acc: 0.511
Validation loss decreased (-0.472213 --> -0.511096).  Saving model ...
Epoch: 3 cost time: 4.495651006698608
Epoch: 3, Steps: 13 | Train Loss: 0.683 Vali Loss: 1.391 Vali Acc: 0.517 Test Loss: 1.391 Test Acc: 0.517
Validation loss decreased (-0.511096 --> -0.516653).  Saving model ...
Epoch: 4 cost time: 4.400218725204468
Epoch: 4, Steps: 13 | Train Loss: 0.564 Vali Loss: 2.020 Vali Acc: 0.489 Test Loss: 2.020 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.452469110488892
Epoch: 5, Steps: 13 | Train Loss: 0.485 Vali Loss: 1.499 Vali Acc: 0.489 Test Loss: 1.499 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.733723878860474
Epoch: 6, Steps: 13 | Train Loss: 0.427 Vali Loss: 2.080 Vali Acc: 0.467 Test Loss: 2.080 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.084139585494995
Epoch: 7, Steps: 13 | Train Loss: 0.469 Vali Loss: 2.192 Vali Acc: 0.444 Test Loss: 2.192 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.774359464645386
Epoch: 8, Steps: 13 | Train Loss: 0.239 Vali Loss: 2.290 Vali Acc: 0.450 Test Loss: 2.290 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.059390544891357
Epoch: 9, Steps: 13 | Train Loss: 0.347 Vali Loss: 2.462 Vali Acc: 0.478 Test Loss: 2.462 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.789393186569214
Epoch: 10, Steps: 13 | Train Loss: 0.276 Vali Loss: 3.171 Vali Acc: 0.472 Test Loss: 3.171 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.590857267379761
Epoch: 11, Steps: 13 | Train Loss: 0.289 Vali Loss: 3.019 Vali Acc: 0.461 Test Loss: 3.019 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.046291351318359
Epoch: 12, Steps: 13 | Train Loss: 0.363 Vali Loss: 3.674 Vali Acc: 0.472 Test Loss: 3.674 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.401265621185303
Epoch: 13, Steps: 13 | Train Loss: 0.061 Vali Loss: 3.548 Vali Acc: 0.511 Test Loss: 3.548 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 1745666
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.194476842880249
Epoch: 1, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.805 Vali Acc: 0.506 Test Loss: 0.805 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 4.47417688369751
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 1.418 Vali Acc: 0.517 Test Loss: 1.418 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516652).  Saving model ...
Epoch: 3 cost time: 4.48139214515686
Epoch: 3, Steps: 13 | Train Loss: 0.566 Vali Loss: 1.275 Vali Acc: 0.567 Test Loss: 1.275 Test Acc: 0.567
Validation loss decreased (-0.516652 --> -0.566654).  Saving model ...
Epoch: 4 cost time: 4.817819595336914
Epoch: 4, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.501 Vali Acc: 0.489 Test Loss: 1.501 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.607914686203003
Epoch: 5, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.645 Vali Acc: 0.472 Test Loss: 1.645 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.909707546234131
Epoch: 6, Steps: 13 | Train Loss: 0.400 Vali Loss: 2.609 Vali Acc: 0.472 Test Loss: 2.609 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.747129201889038
Epoch: 7, Steps: 13 | Train Loss: 0.358 Vali Loss: 2.450 Vali Acc: 0.506 Test Loss: 2.450 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.357903242111206
Epoch: 8, Steps: 13 | Train Loss: 0.358 Vali Loss: 2.598 Vali Acc: 0.478 Test Loss: 2.598 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.888600826263428
Epoch: 9, Steps: 13 | Train Loss: 0.261 Vali Loss: 3.846 Vali Acc: 0.456 Test Loss: 3.846 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.336736440658569
Epoch: 10, Steps: 13 | Train Loss: 0.287 Vali Loss: 3.033 Vali Acc: 0.478 Test Loss: 3.033 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.750065565109253
Epoch: 11, Steps: 13 | Train Loss: 0.266 Vali Loss: 3.738 Vali Acc: 0.478 Test Loss: 3.738 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.041446924209595
Epoch: 12, Steps: 13 | Train Loss: 0.233 Vali Loss: 3.850 Vali Acc: 0.483 Test Loss: 3.850 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.704939603805542
Epoch: 13, Steps: 13 | Train Loss: 0.085 Vali Loss: 3.969 Vali Acc: 0.467 Test Loss: 3.969 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 1745666
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.303480625152588
Epoch: 1, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.876 Vali Acc: 0.500 Test Loss: 0.876 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 5.018174886703491
Epoch: 2, Steps: 13 | Train Loss: 0.790 Vali Loss: 0.935 Vali Acc: 0.511 Test Loss: 0.935 Test Acc: 0.511
Validation loss decreased (-0.499991 --> -0.511102).  Saving model ...
Epoch: 3 cost time: 4.7011682987213135
Epoch: 3, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.756 Vali Acc: 0.528 Test Loss: 0.756 Test Acc: 0.528
Validation loss decreased (-0.511102 --> -0.527770).  Saving model ...
Epoch: 4 cost time: 4.853193759918213
Epoch: 4, Steps: 13 | Train Loss: 0.628 Vali Loss: 1.103 Vali Acc: 0.511 Test Loss: 1.103 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.60619044303894
Epoch: 5, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.958 Vali Acc: 0.550 Test Loss: 0.958 Test Acc: 0.550
Validation loss decreased (-0.527770 --> -0.549990).  Saving model ...
Epoch: 6 cost time: 5.013012886047363
Epoch: 6, Steps: 13 | Train Loss: 0.487 Vali Loss: 1.769 Vali Acc: 0.511 Test Loss: 1.769 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.750292778015137
Epoch: 7, Steps: 13 | Train Loss: 0.491 Vali Loss: 1.890 Vali Acc: 0.522 Test Loss: 1.890 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.113596439361572
Epoch: 8, Steps: 13 | Train Loss: 0.544 Vali Loss: 1.473 Vali Acc: 0.533 Test Loss: 1.473 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.054452180862427
Epoch: 9, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.654 Vali Acc: 0.522 Test Loss: 1.654 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.13976263999939
Epoch: 10, Steps: 13 | Train Loss: 0.343 Vali Loss: 2.318 Vali Acc: 0.511 Test Loss: 2.318 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.835683345794678
Epoch: 11, Steps: 13 | Train Loss: 0.278 Vali Loss: 2.245 Vali Acc: 0.556 Test Loss: 2.245 Test Acc: 0.556
Validation loss decreased (-0.549990 --> -0.555533).  Saving model ...
Epoch: 12 cost time: 4.832661151885986
Epoch: 12, Steps: 13 | Train Loss: 0.192 Vali Loss: 2.653 Vali Acc: 0.556 Test Loss: 2.653 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.96241021156311
Epoch: 13, Steps: 13 | Train Loss: 0.124 Vali Loss: 2.805 Vali Acc: 0.517 Test Loss: 2.805 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.091832160949707
Epoch: 14, Steps: 13 | Train Loss: 0.118 Vali Loss: 3.041 Vali Acc: 0.533 Test Loss: 3.041 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.759554147720337
Epoch: 15, Steps: 13 | Train Loss: 0.082 Vali Loss: 3.420 Vali Acc: 0.539 Test Loss: 3.420 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.20061731338501
Epoch: 16, Steps: 13 | Train Loss: 0.085 Vali Loss: 3.856 Vali Acc: 0.506 Test Loss: 3.856 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.823525905609131
Epoch: 17, Steps: 13 | Train Loss: 0.074 Vali Loss: 4.352 Vali Acc: 0.556 Test Loss: 4.352 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.079446315765381
Epoch: 18, Steps: 13 | Train Loss: 0.081 Vali Loss: 4.660 Vali Acc: 0.533 Test Loss: 4.660 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.3568267822265625
Epoch: 19, Steps: 13 | Train Loss: 0.138 Vali Loss: 4.786 Vali Acc: 0.556 Test Loss: 4.786 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.9996397495269775
Epoch: 20, Steps: 13 | Train Loss: 0.080 Vali Loss: 5.066 Vali Acc: 0.583 Test Loss: 5.066 Test Acc: 0.583
Validation loss decreased (-0.555533 --> -0.583283).  Saving model ...
Epoch: 21 cost time: 5.035926818847656
Epoch: 21, Steps: 13 | Train Loss: 0.091 Vali Loss: 5.326 Vali Acc: 0.528 Test Loss: 5.326 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.81923770904541
Epoch: 22, Steps: 13 | Train Loss: 0.066 Vali Loss: 6.590 Vali Acc: 0.528 Test Loss: 6.590 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.763041973114014
Epoch: 23, Steps: 13 | Train Loss: 0.104 Vali Loss: 6.187 Vali Acc: 0.522 Test Loss: 6.187 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.959458351135254
Epoch: 24, Steps: 13 | Train Loss: 0.093 Vali Loss: 8.202 Vali Acc: 0.506 Test Loss: 8.202 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.491621017456055
Epoch: 25, Steps: 13 | Train Loss: 0.114 Vali Loss: 7.618 Vali Acc: 0.511 Test Loss: 7.618 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.861198902130127
Epoch: 26, Steps: 13 | Train Loss: 0.137 Vali Loss: 7.224 Vali Acc: 0.522 Test Loss: 7.224 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.7611494064331055
Epoch: 27, Steps: 13 | Train Loss: 0.166 Vali Loss: 7.120 Vali Acc: 0.561 Test Loss: 7.120 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.631660223007202
Epoch: 28, Steps: 13 | Train Loss: 0.137 Vali Loss: 7.688 Vali Acc: 0.528 Test Loss: 7.688 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.615403413772583
Epoch: 29, Steps: 13 | Train Loss: 0.091 Vali Loss: 7.842 Vali Acc: 0.533 Test Loss: 7.842 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.985103607177734
Epoch: 30, Steps: 13 | Train Loss: 0.078 Vali Loss: 8.209 Vali Acc: 0.500 Test Loss: 8.209 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 1745666
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.102749347686768
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 1.059 Vali Acc: 0.517 Test Loss: 1.059 Test Acc: 0.517
Validation loss decreased (inf --> -0.516656).  Saving model ...
Epoch: 2 cost time: 4.284818649291992
Epoch: 2, Steps: 13 | Train Loss: 0.821 Vali Loss: 0.846 Vali Acc: 0.561 Test Loss: 0.846 Test Acc: 0.561
Validation loss decreased (-0.516656 --> -0.561103).  Saving model ...
Epoch: 3 cost time: 4.439852237701416
Epoch: 3, Steps: 13 | Train Loss: 0.786 Vali Loss: 0.935 Vali Acc: 0.561 Test Loss: 0.935 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.616863012313843
Epoch: 4, Steps: 13 | Train Loss: 0.683 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.381434679031372
Epoch: 5, Steps: 13 | Train Loss: 0.671 Vali Loss: 1.350 Vali Acc: 0.478 Test Loss: 1.350 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.429340839385986
Epoch: 6, Steps: 13 | Train Loss: 0.762 Vali Loss: 1.680 Vali Acc: 0.528 Test Loss: 1.680 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.5025458335876465
Epoch: 7, Steps: 13 | Train Loss: 0.619 Vali Loss: 1.463 Vali Acc: 0.556 Test Loss: 1.463 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.433115482330322
Epoch: 8, Steps: 13 | Train Loss: 0.713 Vali Loss: 1.770 Vali Acc: 0.528 Test Loss: 1.770 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.6800172328948975
Epoch: 9, Steps: 13 | Train Loss: 0.526 Vali Loss: 1.389 Vali Acc: 0.517 Test Loss: 1.389 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.663269996643066
Epoch: 10, Steps: 13 | Train Loss: 0.520 Vali Loss: 1.141 Vali Acc: 0.539 Test Loss: 1.141 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.2677161693573
Epoch: 11, Steps: 13 | Train Loss: 0.660 Vali Loss: 1.276 Vali Acc: 0.533 Test Loss: 1.276 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.626210927963257
Epoch: 12, Steps: 13 | Train Loss: 0.545 Vali Loss: 1.800 Vali Acc: 0.556 Test Loss: 1.800 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 1745666
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.934674978256226
Epoch: 1, Steps: 13 | Train Loss: 0.747 Vali Loss: 0.904 Vali Acc: 0.528 Test Loss: 0.904 Test Acc: 0.528
Validation loss decreased (inf --> -0.527769).  Saving model ...
Epoch: 2 cost time: 6.610577821731567
Epoch: 2, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.899 Vali Acc: 0.450 Test Loss: 0.899 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.114238262176514
Epoch: 3, Steps: 13 | Train Loss: 0.489 Vali Loss: 1.229 Vali Acc: 0.533 Test Loss: 1.229 Test Acc: 0.533
Validation loss decreased (-0.527769 --> -0.533321).  Saving model ...
Epoch: 4 cost time: 6.302666902542114
Epoch: 4, Steps: 13 | Train Loss: 0.422 Vali Loss: 2.171 Vali Acc: 0.528 Test Loss: 2.171 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.8178205490112305
Epoch: 5, Steps: 13 | Train Loss: 0.544 Vali Loss: 1.836 Vali Acc: 0.483 Test Loss: 1.836 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.081813812255859
Epoch: 6, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.830 Vali Acc: 0.522 Test Loss: 1.830 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.462540149688721
Epoch: 7, Steps: 13 | Train Loss: 0.222 Vali Loss: 2.245 Vali Acc: 0.461 Test Loss: 2.245 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.1163177490234375
Epoch: 8, Steps: 13 | Train Loss: 0.281 Vali Loss: 2.430 Vali Acc: 0.494 Test Loss: 2.430 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.176005125045776
Epoch: 9, Steps: 13 | Train Loss: 0.187 Vali Loss: 2.662 Vali Acc: 0.494 Test Loss: 2.662 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.330074310302734
Epoch: 10, Steps: 13 | Train Loss: 0.167 Vali Loss: 3.292 Vali Acc: 0.511 Test Loss: 3.292 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.5206828117370605
Epoch: 11, Steps: 13 | Train Loss: 0.193 Vali Loss: 3.533 Vali Acc: 0.517 Test Loss: 3.533 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.561928033828735
Epoch: 12, Steps: 13 | Train Loss: 0.099 Vali Loss: 3.609 Vali Acc: 0.506 Test Loss: 3.609 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.524324178695679
Epoch: 13, Steps: 13 | Train Loss: 0.198 Vali Loss: 4.454 Vali Acc: 0.500 Test Loss: 4.454 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 1352450
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.894503355026245
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.920 Vali Acc: 0.500 Test Loss: 0.920 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 6.4167375564575195
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.949 Vali Acc: 0.500 Test Loss: 0.949 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.480879068374634
Epoch: 3, Steps: 13 | Train Loss: 0.469 Vali Loss: 1.073 Vali Acc: 0.506 Test Loss: 1.073 Test Acc: 0.506
Validation loss decreased (-0.499991 --> -0.505545).  Saving model ...
Epoch: 4 cost time: 5.41376805305481
Epoch: 4, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.501 Vali Acc: 0.444 Test Loss: 1.501 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.672056436538696
Epoch: 5, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.617 Vali Acc: 0.528 Test Loss: 1.617 Test Acc: 0.528
Validation loss decreased (-0.505545 --> -0.527762).  Saving model ...
Epoch: 6 cost time: 7.1439619064331055
Epoch: 6, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.744 Vali Acc: 0.450 Test Loss: 1.744 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.624481201171875
Epoch: 7, Steps: 13 | Train Loss: 0.182 Vali Loss: 2.587 Vali Acc: 0.483 Test Loss: 2.587 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.584099769592285
Epoch: 8, Steps: 13 | Train Loss: 0.374 Vali Loss: 2.646 Vali Acc: 0.444 Test Loss: 2.646 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.317759275436401
Epoch: 9, Steps: 13 | Train Loss: 0.170 Vali Loss: 2.762 Vali Acc: 0.517 Test Loss: 2.762 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.836640119552612
Epoch: 10, Steps: 13 | Train Loss: 0.240 Vali Loss: 3.185 Vali Acc: 0.450 Test Loss: 3.185 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.415001153945923
Epoch: 11, Steps: 13 | Train Loss: 0.121 Vali Loss: 3.188 Vali Acc: 0.500 Test Loss: 3.188 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.8845133781433105
Epoch: 12, Steps: 13 | Train Loss: 0.135 Vali Loss: 4.051 Vali Acc: 0.444 Test Loss: 4.051 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.059712171554565
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 3.697 Vali Acc: 0.461 Test Loss: 3.697 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.311300277709961
Epoch: 14, Steps: 13 | Train Loss: 0.079 Vali Loss: 4.644 Vali Acc: 0.472 Test Loss: 4.644 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.911483287811279
Epoch: 15, Steps: 13 | Train Loss: 0.041 Vali Loss: 4.941 Vali Acc: 0.467 Test Loss: 4.941 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 1352450
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.015729665756226
Epoch: 1, Steps: 13 | Train Loss: 0.743 Vali Loss: 1.042 Vali Acc: 0.500 Test Loss: 1.042 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 6.014798402786255
Epoch: 2, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.898 Vali Acc: 0.467 Test Loss: 0.898 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.7082602977752686
Epoch: 3, Steps: 13 | Train Loss: 0.466 Vali Loss: 1.070 Vali Acc: 0.494 Test Loss: 1.070 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.68266749382019
Epoch: 4, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.312 Vali Acc: 0.478 Test Loss: 1.312 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.957893371582031
Epoch: 5, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.715 Vali Acc: 0.556 Test Loss: 1.715 Test Acc: 0.556
Validation loss decreased (-0.499990 --> -0.555538).  Saving model ...
Epoch: 6 cost time: 5.9347264766693115
Epoch: 6, Steps: 13 | Train Loss: 0.163 Vali Loss: 2.006 Vali Acc: 0.472 Test Loss: 2.006 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.6232688426971436
Epoch: 7, Steps: 13 | Train Loss: 0.105 Vali Loss: 2.217 Vali Acc: 0.489 Test Loss: 2.217 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.391744375228882
Epoch: 8, Steps: 13 | Train Loss: 0.081 Vali Loss: 2.654 Vali Acc: 0.494 Test Loss: 2.654 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.643754005432129
Epoch: 9, Steps: 13 | Train Loss: 0.114 Vali Loss: 2.754 Vali Acc: 0.489 Test Loss: 2.754 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.770269155502319
Epoch: 10, Steps: 13 | Train Loss: 0.140 Vali Loss: 2.831 Vali Acc: 0.511 Test Loss: 2.831 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.8250181674957275
Epoch: 11, Steps: 13 | Train Loss: 0.062 Vali Loss: 3.028 Vali Acc: 0.506 Test Loss: 3.028 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.264064788818359
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 3.544 Vali Acc: 0.511 Test Loss: 3.544 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.778251647949219
Epoch: 13, Steps: 13 | Train Loss: 0.053 Vali Loss: 3.870 Vali Acc: 0.461 Test Loss: 3.870 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.429389953613281
Epoch: 14, Steps: 13 | Train Loss: 0.072 Vali Loss: 4.196 Vali Acc: 0.506 Test Loss: 4.196 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.872896432876587
Epoch: 15, Steps: 13 | Train Loss: 0.029 Vali Loss: 6.874 Vali Acc: 0.506 Test Loss: 6.874 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 1352450
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.142710208892822
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.946 Vali Acc: 0.500 Test Loss: 0.946 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 4.921731233596802
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.877 Vali Acc: 0.539 Test Loss: 0.877 Test Acc: 0.539
Validation loss decreased (-0.499991 --> -0.538880).  Saving model ...
Epoch: 3 cost time: 5.163177728652954
Epoch: 3, Steps: 13 | Train Loss: 0.461 Vali Loss: 1.001 Vali Acc: 0.544 Test Loss: 1.001 Test Acc: 0.544
Validation loss decreased (-0.538880 --> -0.544434).  Saving model ...
Epoch: 4 cost time: 5.441166162490845
Epoch: 4, Steps: 13 | Train Loss: 0.555 Vali Loss: 1.218 Vali Acc: 0.544 Test Loss: 1.218 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.124999761581421
Epoch: 5, Steps: 13 | Train Loss: 0.499 Vali Loss: 2.578 Vali Acc: 0.483 Test Loss: 2.578 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.037907123565674
Epoch: 6, Steps: 13 | Train Loss: 0.656 Vali Loss: 2.098 Vali Acc: 0.483 Test Loss: 2.098 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.75297999382019
Epoch: 7, Steps: 13 | Train Loss: 0.308 Vali Loss: 2.632 Vali Acc: 0.500 Test Loss: 2.632 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.351175308227539
Epoch: 8, Steps: 13 | Train Loss: 0.204 Vali Loss: 2.420 Vali Acc: 0.489 Test Loss: 2.420 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.316687107086182
Epoch: 9, Steps: 13 | Train Loss: 0.196 Vali Loss: 2.926 Vali Acc: 0.511 Test Loss: 2.926 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.48083758354187
Epoch: 10, Steps: 13 | Train Loss: 0.072 Vali Loss: 3.959 Vali Acc: 0.483 Test Loss: 3.959 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.9006736278533936
Epoch: 11, Steps: 13 | Train Loss: 0.263 Vali Loss: 3.287 Vali Acc: 0.511 Test Loss: 3.287 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.2622973918914795
Epoch: 12, Steps: 13 | Train Loss: 0.173 Vali Loss: 3.437 Vali Acc: 0.539 Test Loss: 3.437 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.526233434677124
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 3.583 Vali Acc: 0.483 Test Loss: 3.583 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 1352450
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.918710708618164
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.875 Vali Acc: 0.500 Test Loss: 0.875 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 4.509521722793579
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.932 Vali Acc: 0.539 Test Loss: 0.932 Test Acc: 0.539
Validation loss decreased (-0.499991 --> -0.538880).  Saving model ...
Epoch: 3 cost time: 4.622354984283447
Epoch: 3, Steps: 13 | Train Loss: 0.462 Vali Loss: 1.203 Vali Acc: 0.478 Test Loss: 1.203 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.553540945053101
Epoch: 4, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.492 Vali Acc: 0.539 Test Loss: 1.492 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.802685022354126
Epoch: 5, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.792 Vali Acc: 0.483 Test Loss: 1.792 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.543098449707031
Epoch: 6, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.888 Vali Acc: 0.506 Test Loss: 1.888 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.915344953536987
Epoch: 7, Steps: 13 | Train Loss: 0.080 Vali Loss: 2.244 Vali Acc: 0.494 Test Loss: 2.244 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.784563779830933
Epoch: 8, Steps: 13 | Train Loss: 0.062 Vali Loss: 2.483 Vali Acc: 0.539 Test Loss: 2.483 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.965988636016846
Epoch: 9, Steps: 13 | Train Loss: 0.141 Vali Loss: 2.908 Vali Acc: 0.533 Test Loss: 2.908 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.089012145996094
Epoch: 10, Steps: 13 | Train Loss: 0.060 Vali Loss: 3.122 Vali Acc: 0.511 Test Loss: 3.122 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.490265369415283
Epoch: 11, Steps: 13 | Train Loss: 0.072 Vali Loss: 3.314 Vali Acc: 0.533 Test Loss: 3.314 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.880751848220825
Epoch: 12, Steps: 13 | Train Loss: 0.077 Vali Loss: 4.075 Vali Acc: 0.478 Test Loss: 4.075 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 1352450
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.1738340854644775
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.897 Vali Acc: 0.511 Test Loss: 0.897 Test Acc: 0.511
Validation loss decreased (inf --> -0.511102).  Saving model ...
Epoch: 2 cost time: 4.9981749057769775
Epoch: 2, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.875 Vali Acc: 0.528 Test Loss: 0.875 Test Acc: 0.528
Validation loss decreased (-0.511102 --> -0.527769).  Saving model ...
Epoch: 3 cost time: 4.78688645362854
Epoch: 3, Steps: 13 | Train Loss: 0.461 Vali Loss: 1.102 Vali Acc: 0.494 Test Loss: 1.102 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.395949840545654
Epoch: 4, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.358 Vali Acc: 0.511 Test Loss: 1.358 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.689114809036255
Epoch: 5, Steps: 13 | Train Loss: 0.242 Vali Loss: 1.520 Vali Acc: 0.544 Test Loss: 1.520 Test Acc: 0.544
Validation loss decreased (-0.527769 --> -0.544429).  Saving model ...
Epoch: 6 cost time: 4.648303508758545
Epoch: 6, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.684 Vali Acc: 0.533 Test Loss: 1.684 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.619405508041382
Epoch: 7, Steps: 13 | Train Loss: 0.165 Vali Loss: 2.474 Vali Acc: 0.500 Test Loss: 2.474 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.401591777801514
Epoch: 8, Steps: 13 | Train Loss: 0.094 Vali Loss: 2.178 Vali Acc: 0.561 Test Loss: 2.178 Test Acc: 0.561
Validation loss decreased (-0.544429 --> -0.561089).  Saving model ...
Epoch: 9 cost time: 4.9239232540130615
Epoch: 9, Steps: 13 | Train Loss: 0.118 Vali Loss: 2.471 Vali Acc: 0.572 Test Loss: 2.471 Test Acc: 0.572
Validation loss decreased (-0.561089 --> -0.572198).  Saving model ...
Epoch: 10 cost time: 4.533540725708008
Epoch: 10, Steps: 13 | Train Loss: 0.111 Vali Loss: 2.585 Vali Acc: 0.511 Test Loss: 2.585 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.909353256225586
Epoch: 11, Steps: 13 | Train Loss: 0.088 Vali Loss: 2.866 Vali Acc: 0.528 Test Loss: 2.866 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.853549003601074
Epoch: 12, Steps: 13 | Train Loss: 0.080 Vali Loss: 3.322 Vali Acc: 0.533 Test Loss: 3.322 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.724622011184692
Epoch: 13, Steps: 13 | Train Loss: 0.071 Vali Loss: 3.652 Vali Acc: 0.489 Test Loss: 3.652 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.874275207519531
Epoch: 14, Steps: 13 | Train Loss: 0.068 Vali Loss: 3.939 Vali Acc: 0.472 Test Loss: 3.939 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.759488344192505
Epoch: 15, Steps: 13 | Train Loss: 0.019 Vali Loss: 4.193 Vali Acc: 0.517 Test Loss: 4.193 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.667531251907349
Epoch: 16, Steps: 13 | Train Loss: 0.086 Vali Loss: 4.281 Vali Acc: 0.500 Test Loss: 4.281 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.514343500137329
Epoch: 17, Steps: 13 | Train Loss: 0.045 Vali Loss: 5.853 Vali Acc: 0.500 Test Loss: 5.853 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.7213122844696045
Epoch: 18, Steps: 13 | Train Loss: 0.288 Vali Loss: 5.111 Vali Acc: 0.528 Test Loss: 5.111 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.758315563201904
Epoch: 19, Steps: 13 | Train Loss: 0.114 Vali Loss: 6.134 Vali Acc: 0.528 Test Loss: 6.134 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 1352450
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.7193334102630615
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.929 Vali Acc: 0.467 Test Loss: 0.929 Test Acc: 0.467
Validation loss decreased (inf --> -0.466657).  Saving model ...
Epoch: 2 cost time: 3.985006809234619
Epoch: 2, Steps: 13 | Train Loss: 0.634 Vali Loss: 1.107 Vali Acc: 0.444 Test Loss: 1.107 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.466399669647217
Epoch: 3, Steps: 13 | Train Loss: 0.539 Vali Loss: 1.591 Vali Acc: 0.467 Test Loss: 1.591 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.362144470214844
Epoch: 4, Steps: 13 | Train Loss: 0.541 Vali Loss: 1.415 Vali Acc: 0.483 Test Loss: 1.415 Test Acc: 0.483
Validation loss decreased (-0.466657 --> -0.483319).  Saving model ...
Epoch: 5 cost time: 4.373270034790039
Epoch: 5, Steps: 13 | Train Loss: 0.447 Vali Loss: 1.570 Vali Acc: 0.511 Test Loss: 1.570 Test Acc: 0.511
Validation loss decreased (-0.483319 --> -0.511095).  Saving model ...
Epoch: 6 cost time: 4.493926763534546
Epoch: 6, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.724 Vali Acc: 0.483 Test Loss: 1.724 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.665434837341309
Epoch: 7, Steps: 13 | Train Loss: 0.327 Vali Loss: 2.218 Vali Acc: 0.456 Test Loss: 2.218 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.95885443687439
Epoch: 8, Steps: 13 | Train Loss: 0.322 Vali Loss: 2.272 Vali Acc: 0.506 Test Loss: 2.272 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.537144899368286
Epoch: 9, Steps: 13 | Train Loss: 0.162 Vali Loss: 2.494 Vali Acc: 0.500 Test Loss: 2.494 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.726083517074585
Epoch: 10, Steps: 13 | Train Loss: 0.281 Vali Loss: 2.451 Vali Acc: 0.522 Test Loss: 2.451 Test Acc: 0.522
Validation loss decreased (-0.511095 --> -0.522198).  Saving model ...
Epoch: 11 cost time: 4.19960618019104
Epoch: 11, Steps: 13 | Train Loss: 0.188 Vali Loss: 3.081 Vali Acc: 0.544 Test Loss: 3.081 Test Acc: 0.544
Validation loss decreased (-0.522198 --> -0.544414).  Saving model ...
Epoch: 12 cost time: 3.66973614692688
Epoch: 12, Steps: 13 | Train Loss: 0.252 Vali Loss: 3.309 Vali Acc: 0.467 Test Loss: 3.309 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.049147129058838
Epoch: 13, Steps: 13 | Train Loss: 0.477 Vali Loss: 3.359 Vali Acc: 0.467 Test Loss: 3.359 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.937849283218384
Epoch: 14, Steps: 13 | Train Loss: 0.241 Vali Loss: 3.806 Vali Acc: 0.483 Test Loss: 3.806 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.9137308597564697
Epoch: 15, Steps: 13 | Train Loss: 0.171 Vali Loss: 3.633 Vali Acc: 0.517 Test Loss: 3.633 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.372468709945679
Epoch: 16, Steps: 13 | Train Loss: 0.130 Vali Loss: 3.881 Vali Acc: 0.511 Test Loss: 3.881 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.431930065155029
Epoch: 17, Steps: 13 | Train Loss: 0.118 Vali Loss: 4.512 Vali Acc: 0.450 Test Loss: 4.512 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.586719751358032
Epoch: 18, Steps: 13 | Train Loss: 0.160 Vali Loss: 5.739 Vali Acc: 0.522 Test Loss: 5.739 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.724155902862549
Epoch: 19, Steps: 13 | Train Loss: 0.145 Vali Loss: 4.777 Vali Acc: 0.511 Test Loss: 4.777 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.525449514389038
Epoch: 20, Steps: 13 | Train Loss: 0.147 Vali Loss: 5.008 Vali Acc: 0.522 Test Loss: 5.008 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.387556314468384
Epoch: 21, Steps: 13 | Train Loss: 0.139 Vali Loss: 6.114 Vali Acc: 0.506 Test Loss: 6.114 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 1352450
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.977349042892456
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.938 Vali Acc: 0.483 Test Loss: 0.938 Test Acc: 0.483
Validation loss decreased (inf --> -0.483324).  Saving model ...
Epoch: 2 cost time: 4.310424327850342
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.929 Vali Acc: 0.517 Test Loss: 0.929 Test Acc: 0.517
Validation loss decreased (-0.483324 --> -0.516657).  Saving model ...
Epoch: 3 cost time: 4.284579277038574
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 1.398 Vali Acc: 0.483 Test Loss: 1.398 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.61088752746582
Epoch: 4, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.432 Vali Acc: 0.517 Test Loss: 1.432 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.6515820026397705
Epoch: 5, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.526 Vali Acc: 0.456 Test Loss: 1.526 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.680306911468506
Epoch: 6, Steps: 13 | Train Loss: 0.236 Vali Loss: 2.169 Vali Acc: 0.433 Test Loss: 2.169 Test Acc: 0.433
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.350768089294434
Epoch: 7, Steps: 13 | Train Loss: 0.267 Vali Loss: 2.296 Vali Acc: 0.517 Test Loss: 2.296 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.381969213485718
Epoch: 8, Steps: 13 | Train Loss: 0.481 Vali Loss: 2.332 Vali Acc: 0.500 Test Loss: 2.332 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.661712884902954
Epoch: 9, Steps: 13 | Train Loss: 0.154 Vali Loss: 3.006 Vali Acc: 0.489 Test Loss: 3.006 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.361330986022949
Epoch: 10, Steps: 13 | Train Loss: 0.166 Vali Loss: 2.753 Vali Acc: 0.483 Test Loss: 2.753 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.77790904045105
Epoch: 11, Steps: 13 | Train Loss: 0.084 Vali Loss: 3.073 Vali Acc: 0.478 Test Loss: 3.073 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.829512596130371
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 3.206 Vali Acc: 0.472 Test Loss: 3.206 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 1352450
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.181294679641724
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.928 Vali Acc: 0.500 Test Loss: 0.928 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 4.3344597816467285
Epoch: 2, Steps: 13 | Train Loss: 0.747 Vali Loss: 0.728 Vali Acc: 0.511 Test Loss: 0.728 Test Acc: 0.511
Validation loss decreased (-0.499991 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 4.420079231262207
Epoch: 3, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.833 Vali Acc: 0.539 Test Loss: 0.833 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538881).  Saving model ...
Epoch: 4 cost time: 3.9703526496887207
Epoch: 4, Steps: 13 | Train Loss: 0.506 Vali Loss: 1.231 Vali Acc: 0.528 Test Loss: 1.231 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.01859712600708
Epoch: 5, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.891 Vali Acc: 0.572 Test Loss: 0.891 Test Acc: 0.572
Validation loss decreased (-0.538881 --> -0.572213).  Saving model ...
Epoch: 6 cost time: 4.067774295806885
Epoch: 6, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.049 Vali Acc: 0.550 Test Loss: 1.049 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.193367004394531
Epoch: 7, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.500 Vali Acc: 0.550 Test Loss: 1.500 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.962888479232788
Epoch: 8, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.986 Vali Acc: 0.533 Test Loss: 1.986 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.062601804733276
Epoch: 9, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.753 Vali Acc: 0.533 Test Loss: 1.753 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.469629764556885
Epoch: 10, Steps: 13 | Train Loss: 0.287 Vali Loss: 2.232 Vali Acc: 0.550 Test Loss: 2.232 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.56686544418335
Epoch: 11, Steps: 13 | Train Loss: 0.213 Vali Loss: 2.005 Vali Acc: 0.556 Test Loss: 2.005 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.567403793334961
Epoch: 12, Steps: 13 | Train Loss: 0.167 Vali Loss: 2.390 Vali Acc: 0.522 Test Loss: 2.390 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.590346813201904
Epoch: 13, Steps: 13 | Train Loss: 0.099 Vali Loss: 2.822 Vali Acc: 0.517 Test Loss: 2.822 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.377958536148071
Epoch: 14, Steps: 13 | Train Loss: 0.171 Vali Loss: 2.733 Vali Acc: 0.522 Test Loss: 2.733 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.409307956695557
Epoch: 15, Steps: 13 | Train Loss: 0.151 Vali Loss: 2.849 Vali Acc: 0.550 Test Loss: 2.849 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 1352450
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.653825521469116
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.941 Vali Acc: 0.528 Test Loss: 0.941 Test Acc: 0.528
Validation loss decreased (inf --> -0.527768).  Saving model ...
Epoch: 2 cost time: 4.404253005981445
Epoch: 2, Steps: 13 | Train Loss: 0.811 Vali Loss: 0.897 Vali Acc: 0.511 Test Loss: 0.897 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.18196702003479
Epoch: 3, Steps: 13 | Train Loss: 0.794 Vali Loss: 0.976 Vali Acc: 0.550 Test Loss: 0.976 Test Acc: 0.550
Validation loss decreased (-0.527768 --> -0.549990).  Saving model ...
Epoch: 4 cost time: 4.2279582023620605
Epoch: 4, Steps: 13 | Train Loss: 0.687 Vali Loss: 1.952 Vali Acc: 0.500 Test Loss: 1.952 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.290597438812256
Epoch: 5, Steps: 13 | Train Loss: 0.858 Vali Loss: 0.922 Vali Acc: 0.544 Test Loss: 0.922 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.124992609024048
Epoch: 6, Steps: 13 | Train Loss: 0.618 Vali Loss: 1.370 Vali Acc: 0.522 Test Loss: 1.370 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.5968992710113525
Epoch: 7, Steps: 13 | Train Loss: 0.566 Vali Loss: 1.521 Vali Acc: 0.539 Test Loss: 1.521 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.709710359573364
Epoch: 8, Steps: 13 | Train Loss: 0.523 Vali Loss: 1.030 Vali Acc: 0.550 Test Loss: 1.030 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.9530932903289795
Epoch: 9, Steps: 13 | Train Loss: 0.645 Vali Loss: 1.556 Vali Acc: 0.539 Test Loss: 1.556 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.826983451843262
Epoch: 10, Steps: 13 | Train Loss: 0.714 Vali Loss: 1.084 Vali Acc: 0.539 Test Loss: 1.084 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.629045248031616
Epoch: 11, Steps: 13 | Train Loss: 0.542 Vali Loss: 1.426 Vali Acc: 0.567 Test Loss: 1.426 Test Acc: 0.567
Validation loss decreased (-0.549990 --> -0.566652).  Saving model ...
Epoch: 12 cost time: 4.846945524215698
Epoch: 12, Steps: 13 | Train Loss: 0.514 Vali Loss: 1.608 Vali Acc: 0.533 Test Loss: 1.608 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.667541027069092
Epoch: 13, Steps: 13 | Train Loss: 0.583 Vali Loss: 1.919 Vali Acc: 0.594 Test Loss: 1.919 Test Acc: 0.594
Validation loss decreased (-0.566652 --> -0.594425).  Saving model ...
Epoch: 14 cost time: 4.817833662033081
Epoch: 14, Steps: 13 | Train Loss: 0.543 Vali Loss: 1.898 Vali Acc: 0.511 Test Loss: 1.898 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.596185684204102
Epoch: 15, Steps: 13 | Train Loss: 0.528 Vali Loss: 1.374 Vali Acc: 0.528 Test Loss: 1.374 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.4353203773498535
Epoch: 16, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.600 Vali Acc: 0.539 Test Loss: 1.600 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.868034839630127
Epoch: 17, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.438 Vali Acc: 0.533 Test Loss: 1.438 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.436748504638672
Epoch: 18, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.636 Vali Acc: 0.589 Test Loss: 1.636 Test Acc: 0.589
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.696699619293213
Epoch: 19, Steps: 13 | Train Loss: 0.508 Vali Loss: 2.004 Vali Acc: 0.544 Test Loss: 2.004 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.652315616607666
Epoch: 20, Steps: 13 | Train Loss: 0.651 Vali Loss: 2.556 Vali Acc: 0.561 Test Loss: 2.556 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.804030418395996
Epoch: 21, Steps: 13 | Train Loss: 0.468 Vali Loss: 2.835 Vali Acc: 0.511 Test Loss: 2.835 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.951719045639038
Epoch: 22, Steps: 13 | Train Loss: 0.299 Vali Loss: 2.250 Vali Acc: 0.533 Test Loss: 2.250 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.161401987075806
Epoch: 23, Steps: 13 | Train Loss: 0.385 Vali Loss: 3.347 Vali Acc: 0.506 Test Loss: 3.347 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5944444444444444
model parameter : 1352450
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.311981439590454
Epoch: 1, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.765 Vali Acc: 0.528 Test Loss: 0.765 Test Acc: 0.528
Validation loss decreased (inf --> -0.527770).  Saving model ...
Epoch: 2 cost time: 6.6325531005859375
Epoch: 2, Steps: 13 | Train Loss: 0.607 Vali Loss: 1.042 Vali Acc: 0.500 Test Loss: 1.042 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.944489002227783
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 1.389 Vali Acc: 0.556 Test Loss: 1.389 Test Acc: 0.556
Validation loss decreased (-0.527770 --> -0.555542).  Saving model ...
Epoch: 4 cost time: 5.9676597118377686
Epoch: 4, Steps: 13 | Train Loss: 0.548 Vali Loss: 1.601 Vali Acc: 0.539 Test Loss: 1.601 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.302745819091797
Epoch: 5, Steps: 13 | Train Loss: 0.525 Vali Loss: 1.797 Vali Acc: 0.517 Test Loss: 1.797 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.788230657577515
Epoch: 6, Steps: 13 | Train Loss: 0.538 Vali Loss: 2.361 Vali Acc: 0.539 Test Loss: 2.361 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.497915267944336
Epoch: 7, Steps: 13 | Train Loss: 0.342 Vali Loss: 2.275 Vali Acc: 0.483 Test Loss: 2.275 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.671206474304199
Epoch: 8, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.986 Vali Acc: 0.500 Test Loss: 1.986 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.108168601989746
Epoch: 9, Steps: 13 | Train Loss: 0.168 Vali Loss: 2.702 Vali Acc: 0.517 Test Loss: 2.702 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.613715887069702
Epoch: 10, Steps: 13 | Train Loss: 0.111 Vali Loss: 3.029 Vali Acc: 0.533 Test Loss: 3.029 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.291990518569946
Epoch: 11, Steps: 13 | Train Loss: 0.094 Vali Loss: 3.367 Vali Acc: 0.506 Test Loss: 3.367 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.48587441444397
Epoch: 12, Steps: 13 | Train Loss: 0.093 Vali Loss: 3.701 Vali Acc: 0.500 Test Loss: 3.701 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.681654930114746
Epoch: 13, Steps: 13 | Train Loss: 0.328 Vali Loss: 5.157 Vali Acc: 0.494 Test Loss: 5.157 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 1155842
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.356563568115234
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.746 Vali Acc: 0.544 Test Loss: 0.746 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 5.22113823890686
Epoch: 2, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.982 Vali Acc: 0.544 Test Loss: 0.982 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.337639570236206
Epoch: 3, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.265 Vali Acc: 0.550 Test Loss: 1.265 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 5.6426637172698975
Epoch: 4, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.647 Vali Acc: 0.539 Test Loss: 1.647 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.5535454750061035
Epoch: 5, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.720 Vali Acc: 0.472 Test Loss: 1.720 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.9375364780426025
Epoch: 6, Steps: 13 | Train Loss: 0.285 Vali Loss: 2.303 Vali Acc: 0.467 Test Loss: 2.303 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.061535358428955
Epoch: 7, Steps: 13 | Train Loss: 0.156 Vali Loss: 2.250 Vali Acc: 0.478 Test Loss: 2.250 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.882019758224487
Epoch: 8, Steps: 13 | Train Loss: 0.164 Vali Loss: 2.325 Vali Acc: 0.500 Test Loss: 2.325 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.687928676605225
Epoch: 9, Steps: 13 | Train Loss: 0.088 Vali Loss: 3.146 Vali Acc: 0.528 Test Loss: 3.146 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.832719564437866
Epoch: 10, Steps: 13 | Train Loss: 0.202 Vali Loss: 3.540 Vali Acc: 0.494 Test Loss: 3.540 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.847919225692749
Epoch: 11, Steps: 13 | Train Loss: 0.132 Vali Loss: 5.198 Vali Acc: 0.517 Test Loss: 5.198 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.078656196594238
Epoch: 12, Steps: 13 | Train Loss: 0.563 Vali Loss: 4.728 Vali Acc: 0.511 Test Loss: 4.728 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.9756574630737305
Epoch: 13, Steps: 13 | Train Loss: 0.090 Vali Loss: 4.043 Vali Acc: 0.450 Test Loss: 4.043 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1155842
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.715368032455444
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.796 Vali Acc: 0.550 Test Loss: 0.796 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 5.18572473526001
Epoch: 2, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.988 Vali Acc: 0.489 Test Loss: 0.988 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.160703182220459
Epoch: 3, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.289 Vali Acc: 0.539 Test Loss: 1.289 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.693402528762817
Epoch: 4, Steps: 13 | Train Loss: 0.431 Vali Loss: 1.353 Vali Acc: 0.539 Test Loss: 1.353 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.833766222000122
Epoch: 5, Steps: 13 | Train Loss: 0.432 Vali Loss: 2.268 Vali Acc: 0.533 Test Loss: 2.268 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.647202968597412
Epoch: 6, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.891 Vali Acc: 0.494 Test Loss: 1.891 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.854935884475708
Epoch: 7, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.985 Vali Acc: 0.483 Test Loss: 1.985 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.606115818023682
Epoch: 8, Steps: 13 | Train Loss: 0.114 Vali Loss: 2.264 Vali Acc: 0.533 Test Loss: 2.264 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.469868898391724
Epoch: 9, Steps: 13 | Train Loss: 0.076 Vali Loss: 2.568 Vali Acc: 0.494 Test Loss: 2.568 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.213746786117554
Epoch: 10, Steps: 13 | Train Loss: 0.058 Vali Loss: 3.319 Vali Acc: 0.472 Test Loss: 3.319 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.257326364517212
Epoch: 11, Steps: 13 | Train Loss: 0.085 Vali Loss: 3.248 Vali Acc: 0.478 Test Loss: 3.248 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1155842
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.427685976028442
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.792 Vali Acc: 0.567 Test Loss: 0.792 Test Acc: 0.567
Validation loss decreased (inf --> -0.566659).  Saving model ...
Epoch: 2 cost time: 4.7360999584198
Epoch: 2, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.952 Vali Acc: 0.472 Test Loss: 0.952 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.794938087463379
Epoch: 3, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.021510124206543
Epoch: 4, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.652 Vali Acc: 0.544 Test Loss: 1.652 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.574792146682739
Epoch: 5, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.580 Vali Acc: 0.478 Test Loss: 1.580 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.358357191085815
Epoch: 6, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.823 Vali Acc: 0.494 Test Loss: 1.823 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.327031850814819
Epoch: 7, Steps: 13 | Train Loss: 0.153 Vali Loss: 2.078 Vali Acc: 0.472 Test Loss: 2.078 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.204734563827515
Epoch: 8, Steps: 13 | Train Loss: 0.113 Vali Loss: 2.750 Vali Acc: 0.511 Test Loss: 2.750 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.883191108703613
Epoch: 9, Steps: 13 | Train Loss: 0.072 Vali Loss: 2.589 Vali Acc: 0.489 Test Loss: 2.589 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.781408309936523
Epoch: 10, Steps: 13 | Train Loss: 0.457 Vali Loss: 2.966 Vali Acc: 0.439 Test Loss: 2.966 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.2343010902404785
Epoch: 11, Steps: 13 | Train Loss: 0.243 Vali Loss: 4.215 Vali Acc: 0.522 Test Loss: 4.215 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 1155842
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.906553030014038
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.953 Vali Acc: 0.500 Test Loss: 0.953 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 4.263492107391357
Epoch: 2, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.995 Vali Acc: 0.461 Test Loss: 0.995 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.457706928253174
Epoch: 3, Steps: 13 | Train Loss: 0.466 Vali Loss: 1.092 Vali Acc: 0.522 Test Loss: 1.092 Test Acc: 0.522
Validation loss decreased (-0.499990 --> -0.522211).  Saving model ...
Epoch: 4 cost time: 4.337077617645264
Epoch: 4, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.544 Vali Acc: 0.517 Test Loss: 1.544 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.649113655090332
Epoch: 5, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.666 Vali Acc: 0.483 Test Loss: 1.666 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.662846088409424
Epoch: 6, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.824 Vali Acc: 0.522 Test Loss: 1.824 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.2350852489471436
Epoch: 7, Steps: 13 | Train Loss: 0.148 Vali Loss: 2.158 Vali Acc: 0.517 Test Loss: 2.158 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.54105806350708
Epoch: 8, Steps: 13 | Train Loss: 0.170 Vali Loss: 2.374 Vali Acc: 0.517 Test Loss: 2.374 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.288390159606934
Epoch: 9, Steps: 13 | Train Loss: 0.066 Vali Loss: 2.653 Vali Acc: 0.528 Test Loss: 2.653 Test Acc: 0.528
Validation loss decreased (-0.522211 --> -0.527751).  Saving model ...
Epoch: 10 cost time: 4.096569538116455
Epoch: 10, Steps: 13 | Train Loss: 0.080 Vali Loss: 2.792 Vali Acc: 0.528 Test Loss: 2.792 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.969480991363525
Epoch: 11, Steps: 13 | Train Loss: 0.051 Vali Loss: 3.057 Vali Acc: 0.522 Test Loss: 3.057 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.148864030838013
Epoch: 12, Steps: 13 | Train Loss: 0.018 Vali Loss: 3.327 Vali Acc: 0.517 Test Loss: 3.327 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.037254333496094
Epoch: 13, Steps: 13 | Train Loss: 0.062 Vali Loss: 4.270 Vali Acc: 0.517 Test Loss: 4.270 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.761247873306274
Epoch: 14, Steps: 13 | Train Loss: 0.079 Vali Loss: 4.439 Vali Acc: 0.539 Test Loss: 4.439 Test Acc: 0.539
Validation loss decreased (-0.527751 --> -0.538845).  Saving model ...
Epoch: 15 cost time: 4.9349119663238525
Epoch: 15, Steps: 13 | Train Loss: 0.102 Vali Loss: 4.471 Vali Acc: 0.528 Test Loss: 4.471 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.284092664718628
Epoch: 16, Steps: 13 | Train Loss: 0.070 Vali Loss: 4.968 Vali Acc: 0.522 Test Loss: 4.968 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.333921432495117
Epoch: 17, Steps: 13 | Train Loss: 0.050 Vali Loss: 5.602 Vali Acc: 0.483 Test Loss: 5.602 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.584939241409302
Epoch: 18, Steps: 13 | Train Loss: 0.018 Vali Loss: 5.515 Vali Acc: 0.489 Test Loss: 5.515 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.770995616912842
Epoch: 19, Steps: 13 | Train Loss: 0.020 Vali Loss: 5.618 Vali Acc: 0.478 Test Loss: 5.618 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.750222206115723
Epoch: 20, Steps: 13 | Train Loss: 0.038 Vali Loss: 6.456 Vali Acc: 0.500 Test Loss: 6.456 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.614226818084717
Epoch: 21, Steps: 13 | Train Loss: 0.030 Vali Loss: 6.373 Vali Acc: 0.478 Test Loss: 6.373 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.703903436660767
Epoch: 22, Steps: 13 | Train Loss: 0.004 Vali Loss: 6.006 Vali Acc: 0.517 Test Loss: 6.006 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.7620460987091064
Epoch: 23, Steps: 13 | Train Loss: 0.013 Vali Loss: 6.126 Vali Acc: 0.483 Test Loss: 6.126 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.748901128768921
Epoch: 24, Steps: 13 | Train Loss: 0.005 Vali Loss: 6.364 Vali Acc: 0.478 Test Loss: 6.364 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 1155842
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.123374938964844
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.948 Vali Acc: 0.506 Test Loss: 0.948 Test Acc: 0.506
Validation loss decreased (inf --> -0.505546).  Saving model ...
Epoch: 2 cost time: 4.289507627487183
Epoch: 2, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.957 Vali Acc: 0.461 Test Loss: 0.957 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.637924909591675
Epoch: 3, Steps: 13 | Train Loss: 0.534 Vali Loss: 1.053 Vali Acc: 0.528 Test Loss: 1.053 Test Acc: 0.528
Validation loss decreased (-0.505546 --> -0.527767).  Saving model ...
Epoch: 4 cost time: 4.5728349685668945
Epoch: 4, Steps: 13 | Train Loss: 0.562 Vali Loss: 1.231 Vali Acc: 0.583 Test Loss: 1.231 Test Acc: 0.583
Validation loss decreased (-0.527767 --> -0.583321).  Saving model ...
Epoch: 5 cost time: 4.57272481918335
Epoch: 5, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.454 Vali Acc: 0.539 Test Loss: 1.454 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.1812708377838135
Epoch: 6, Steps: 13 | Train Loss: 0.319 Vali Loss: 1.652 Vali Acc: 0.528 Test Loss: 1.652 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.440979242324829
Epoch: 7, Steps: 13 | Train Loss: 0.164 Vali Loss: 2.216 Vali Acc: 0.500 Test Loss: 2.216 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.347832441329956
Epoch: 8, Steps: 13 | Train Loss: 0.191 Vali Loss: 2.348 Vali Acc: 0.528 Test Loss: 2.348 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.616475820541382
Epoch: 9, Steps: 13 | Train Loss: 0.420 Vali Loss: 2.452 Vali Acc: 0.528 Test Loss: 2.452 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.014651536941528
Epoch: 10, Steps: 13 | Train Loss: 0.522 Vali Loss: 3.700 Vali Acc: 0.517 Test Loss: 3.700 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.827201843261719
Epoch: 11, Steps: 13 | Train Loss: 0.520 Vali Loss: 4.067 Vali Acc: 0.494 Test Loss: 4.067 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.6983582973480225
Epoch: 12, Steps: 13 | Train Loss: 0.195 Vali Loss: 3.303 Vali Acc: 0.511 Test Loss: 3.303 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.7865471839904785
Epoch: 13, Steps: 13 | Train Loss: 0.048 Vali Loss: 3.533 Vali Acc: 0.539 Test Loss: 3.533 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.707606315612793
Epoch: 14, Steps: 13 | Train Loss: 0.173 Vali Loss: 5.521 Vali Acc: 0.500 Test Loss: 5.521 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 1155842
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.1282429695129395
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.906 Vali Acc: 0.500 Test Loss: 0.906 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 4.882216453552246
Epoch: 2, Steps: 13 | Train Loss: 0.763 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.336868524551392
Epoch: 3, Steps: 13 | Train Loss: 0.658 Vali Loss: 1.951 Vali Acc: 0.483 Test Loss: 1.951 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.3182761669158936
Epoch: 4, Steps: 13 | Train Loss: 0.585 Vali Loss: 1.451 Vali Acc: 0.483 Test Loss: 1.451 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.281968116760254
Epoch: 5, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.903 Vali Acc: 0.467 Test Loss: 1.903 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.592119932174683
Epoch: 6, Steps: 13 | Train Loss: 0.430 Vali Loss: 2.178 Vali Acc: 0.467 Test Loss: 2.178 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.507972955703735
Epoch: 7, Steps: 13 | Train Loss: 0.299 Vali Loss: 2.204 Vali Acc: 0.517 Test Loss: 2.204 Test Acc: 0.517
Validation loss decreased (-0.499991 --> -0.516645).  Saving model ...
Epoch: 8 cost time: 4.89280891418457
Epoch: 8, Steps: 13 | Train Loss: 0.238 Vali Loss: 2.368 Vali Acc: 0.511 Test Loss: 2.368 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.4126646518707275
Epoch: 9, Steps: 13 | Train Loss: 0.243 Vali Loss: 2.397 Vali Acc: 0.506 Test Loss: 2.397 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.459522247314453
Epoch: 10, Steps: 13 | Train Loss: 0.252 Vali Loss: 2.677 Vali Acc: 0.472 Test Loss: 2.677 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.6041224002838135
Epoch: 11, Steps: 13 | Train Loss: 0.178 Vali Loss: 2.643 Vali Acc: 0.489 Test Loss: 2.643 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.682862758636475
Epoch: 12, Steps: 13 | Train Loss: 0.140 Vali Loss: 3.217 Vali Acc: 0.489 Test Loss: 3.217 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.670512914657593
Epoch: 13, Steps: 13 | Train Loss: 0.188 Vali Loss: 3.581 Vali Acc: 0.511 Test Loss: 3.581 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.041719675064087
Epoch: 14, Steps: 13 | Train Loss: 0.136 Vali Loss: 3.486 Vali Acc: 0.517 Test Loss: 3.486 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.6654956340789795
Epoch: 15, Steps: 13 | Train Loss: 0.049 Vali Loss: 4.017 Vali Acc: 0.506 Test Loss: 4.017 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.078192949295044
Epoch: 16, Steps: 13 | Train Loss: 0.092 Vali Loss: 4.239 Vali Acc: 0.439 Test Loss: 4.239 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.4835991859436035
Epoch: 17, Steps: 13 | Train Loss: 0.038 Vali Loss: 4.772 Vali Acc: 0.450 Test Loss: 4.772 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 1155842
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.3087158203125
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.866 Vali Acc: 0.522 Test Loss: 0.866 Test Acc: 0.522
Validation loss decreased (inf --> -0.522214).  Saving model ...
Epoch: 2 cost time: 4.5842437744140625
Epoch: 2, Steps: 13 | Train Loss: 0.610 Vali Loss: 1.023 Vali Acc: 0.489 Test Loss: 1.023 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.6207873821258545
Epoch: 3, Steps: 13 | Train Loss: 0.516 Vali Loss: 1.166 Vali Acc: 0.478 Test Loss: 1.166 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.547167062759399
Epoch: 4, Steps: 13 | Train Loss: 0.527 Vali Loss: 1.396 Vali Acc: 0.500 Test Loss: 1.396 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.6880176067352295
Epoch: 5, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.644 Vali Acc: 0.511 Test Loss: 1.644 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.635828495025635
Epoch: 6, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.889 Vali Acc: 0.511 Test Loss: 1.889 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.761883974075317
Epoch: 7, Steps: 13 | Train Loss: 0.202 Vali Loss: 2.485 Vali Acc: 0.483 Test Loss: 2.485 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.888753414154053
Epoch: 8, Steps: 13 | Train Loss: 0.206 Vali Loss: 2.154 Vali Acc: 0.494 Test Loss: 2.154 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.294707298278809
Epoch: 9, Steps: 13 | Train Loss: 0.197 Vali Loss: 2.562 Vali Acc: 0.450 Test Loss: 2.562 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.2483134269714355
Epoch: 10, Steps: 13 | Train Loss: 0.132 Vali Loss: 2.897 Vali Acc: 0.483 Test Loss: 2.897 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.322629928588867
Epoch: 11, Steps: 13 | Train Loss: 0.274 Vali Loss: 4.128 Vali Acc: 0.433 Test Loss: 4.128 Test Acc: 0.433
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 1155842
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.239216327667236
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.717 Vali Acc: 0.506 Test Loss: 0.717 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 4.328834772109985
Epoch: 2, Steps: 13 | Train Loss: 0.808 Vali Loss: 0.704 Vali Acc: 0.528 Test Loss: 0.704 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 4.207186698913574
Epoch: 3, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.820 Vali Acc: 0.533 Test Loss: 0.820 Test Acc: 0.533
Validation loss decreased (-0.527771 --> -0.533325).  Saving model ...
Epoch: 4 cost time: 4.515928506851196
Epoch: 4, Steps: 13 | Train Loss: 0.785 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.676361560821533
Epoch: 5, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.895 Vali Acc: 0.539 Test Loss: 0.895 Test Acc: 0.539
Validation loss decreased (-0.533325 --> -0.538880).  Saving model ...
Epoch: 6 cost time: 4.733145713806152
Epoch: 6, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.967 Vali Acc: 0.517 Test Loss: 0.967 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.9989542961120605
Epoch: 7, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.052 Vali Acc: 0.539 Test Loss: 1.052 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.5843634605407715
Epoch: 8, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.138 Vali Acc: 0.539 Test Loss: 1.138 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.704345703125
Epoch: 9, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.345 Vali Acc: 0.572 Test Loss: 1.345 Test Acc: 0.572
Validation loss decreased (-0.538880 --> -0.572209).  Saving model ...
Epoch: 10 cost time: 4.407637357711792
Epoch: 10, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.665 Vali Acc: 0.539 Test Loss: 1.665 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.586628198623657
Epoch: 11, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.912 Vali Acc: 0.533 Test Loss: 1.912 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.775171756744385
Epoch: 12, Steps: 13 | Train Loss: 0.595 Vali Loss: 2.057 Vali Acc: 0.533 Test Loss: 2.057 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.583776235580444
Epoch: 13, Steps: 13 | Train Loss: 0.226 Vali Loss: 2.110 Vali Acc: 0.550 Test Loss: 2.110 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.151683568954468
Epoch: 14, Steps: 13 | Train Loss: 0.139 Vali Loss: 2.277 Vali Acc: 0.544 Test Loss: 2.277 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.522327661514282
Epoch: 15, Steps: 13 | Train Loss: 0.089 Vali Loss: 2.364 Vali Acc: 0.522 Test Loss: 2.364 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.585239410400391
Epoch: 16, Steps: 13 | Train Loss: 0.190 Vali Loss: 2.578 Vali Acc: 0.550 Test Loss: 2.578 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.741802215576172
Epoch: 17, Steps: 13 | Train Loss: 0.206 Vali Loss: 3.093 Vali Acc: 0.539 Test Loss: 3.093 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.651226758956909
Epoch: 18, Steps: 13 | Train Loss: 0.106 Vali Loss: 3.567 Vali Acc: 0.533 Test Loss: 3.567 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.709110498428345
Epoch: 19, Steps: 13 | Train Loss: 0.144 Vali Loss: 4.178 Vali Acc: 0.522 Test Loss: 4.178 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 1155842
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.32110595703125
Epoch: 1, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.823 Vali Acc: 0.461 Test Loss: 0.823 Test Acc: 0.461
Validation loss decreased (inf --> -0.461103).  Saving model ...
Epoch: 2 cost time: 4.566568851470947
Epoch: 2, Steps: 13 | Train Loss: 0.784 Vali Loss: 0.744 Vali Acc: 0.544 Test Loss: 0.744 Test Acc: 0.544
Validation loss decreased (-0.461103 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 4.864511966705322
Epoch: 3, Steps: 13 | Train Loss: 0.687 Vali Loss: 1.494 Vali Acc: 0.528 Test Loss: 1.494 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.690579414367676
Epoch: 4, Steps: 13 | Train Loss: 0.774 Vali Loss: 0.869 Vali Acc: 0.533 Test Loss: 0.869 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.949429035186768
Epoch: 5, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.937 Vali Acc: 0.522 Test Loss: 0.937 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.17230749130249
Epoch: 6, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.910 Vali Acc: 0.522 Test Loss: 0.910 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.560466051101685
Epoch: 7, Steps: 13 | Train Loss: 0.541 Vali Loss: 1.028 Vali Acc: 0.494 Test Loss: 1.028 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.2877726554870605
Epoch: 8, Steps: 13 | Train Loss: 0.604 Vali Loss: 1.153 Vali Acc: 0.561 Test Loss: 1.153 Test Acc: 0.561
Validation loss decreased (-0.544437 --> -0.561100).  Saving model ...
Epoch: 9 cost time: 4.881619930267334
Epoch: 9, Steps: 13 | Train Loss: 0.572 Vali Loss: 1.125 Vali Acc: 0.561 Test Loss: 1.125 Test Acc: 0.561
Validation loss decreased (-0.561100 --> -0.561100).  Saving model ...
Epoch: 10 cost time: 4.870574951171875
Epoch: 10, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.126 Vali Acc: 0.556 Test Loss: 1.126 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.7420759201049805
Epoch: 11, Steps: 13 | Train Loss: 0.518 Vali Loss: 1.224 Vali Acc: 0.489 Test Loss: 1.224 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.692559480667114
Epoch: 12, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.196 Vali Acc: 0.589 Test Loss: 1.196 Test Acc: 0.589
Validation loss decreased (-0.561100 --> -0.588877).  Saving model ...
Epoch: 13 cost time: 4.6866161823272705
Epoch: 13, Steps: 13 | Train Loss: 0.488 Vali Loss: 1.985 Vali Acc: 0.489 Test Loss: 1.985 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.3160014152526855
Epoch: 14, Steps: 13 | Train Loss: 0.569 Vali Loss: 1.349 Vali Acc: 0.550 Test Loss: 1.349 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.283931016921997
Epoch: 15, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.479 Vali Acc: 0.511 Test Loss: 1.479 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.362916707992554
Epoch: 16, Steps: 13 | Train Loss: 0.463 Vali Loss: 1.651 Vali Acc: 0.533 Test Loss: 1.651 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.020989894866943
Epoch: 17, Steps: 13 | Train Loss: 0.491 Vali Loss: 1.518 Vali Acc: 0.494 Test Loss: 1.518 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.283247232437134
Epoch: 18, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.925 Vali Acc: 0.567 Test Loss: 1.925 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.623967409133911
Epoch: 19, Steps: 13 | Train Loss: 0.399 Vali Loss: 1.602 Vali Acc: 0.528 Test Loss: 1.602 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.711406469345093
Epoch: 20, Steps: 13 | Train Loss: 0.389 Vali Loss: 3.181 Vali Acc: 0.539 Test Loss: 3.181 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.9796931743621826
Epoch: 21, Steps: 13 | Train Loss: 0.670 Vali Loss: 3.115 Vali Acc: 0.522 Test Loss: 3.115 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.454712390899658
Epoch: 22, Steps: 13 | Train Loss: 0.615 Vali Loss: 2.900 Vali Acc: 0.550 Test Loss: 2.900 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 1155842
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.321026802062988
Epoch: 1, Steps: 13 | Train Loss: 0.801 Vali Loss: 0.806 Vali Acc: 0.450 Test Loss: 0.806 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 7.251267910003662
Epoch: 2, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.923 Vali Acc: 0.478 Test Loss: 0.923 Test Acc: 0.478
Validation loss decreased (-0.449992 --> -0.477769).  Saving model ...
Epoch: 3 cost time: 6.965843677520752
Epoch: 3, Steps: 13 | Train Loss: 0.613 Vali Loss: 1.427 Vali Acc: 0.500 Test Loss: 1.427 Test Acc: 0.500
Validation loss decreased (-0.477769 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 6.034486293792725
Epoch: 4, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.428 Vali Acc: 0.461 Test Loss: 1.428 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.034716367721558
Epoch: 5, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.565 Vali Acc: 0.450 Test Loss: 1.565 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.298647165298462
Epoch: 6, Steps: 13 | Train Loss: 0.240 Vali Loss: 1.737 Vali Acc: 0.500 Test Loss: 1.737 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.163914680480957
Epoch: 7, Steps: 13 | Train Loss: 0.133 Vali Loss: 2.209 Vali Acc: 0.506 Test Loss: 2.209 Test Acc: 0.506
Validation loss decreased (-0.499986 --> -0.505533).  Saving model ...
Epoch: 8 cost time: 6.157333850860596
Epoch: 8, Steps: 13 | Train Loss: 0.106 Vali Loss: 2.413 Vali Acc: 0.461 Test Loss: 2.413 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.4576497077941895
Epoch: 9, Steps: 13 | Train Loss: 0.203 Vali Loss: 3.144 Vali Acc: 0.533 Test Loss: 3.144 Test Acc: 0.533
Validation loss decreased (-0.505533 --> -0.533302).  Saving model ...
Epoch: 10 cost time: 6.660496473312378
Epoch: 10, Steps: 13 | Train Loss: 0.302 Vali Loss: 3.249 Vali Acc: 0.500 Test Loss: 3.249 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.54297137260437
Epoch: 11, Steps: 13 | Train Loss: 0.164 Vali Loss: 3.397 Vali Acc: 0.478 Test Loss: 3.397 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.520259857177734
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 4.065 Vali Acc: 0.483 Test Loss: 4.065 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.025130271911621
Epoch: 13, Steps: 13 | Train Loss: 0.167 Vali Loss: 3.976 Vali Acc: 0.472 Test Loss: 3.976 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.14806604385376
Epoch: 14, Steps: 13 | Train Loss: 0.163 Vali Loss: 4.315 Vali Acc: 0.444 Test Loss: 4.315 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.619166374206543
Epoch: 15, Steps: 13 | Train Loss: 0.040 Vali Loss: 4.412 Vali Acc: 0.472 Test Loss: 4.412 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.614017009735107
Epoch: 16, Steps: 13 | Train Loss: 0.105 Vali Loss: 4.805 Vali Acc: 0.456 Test Loss: 4.805 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.70508337020874
Epoch: 17, Steps: 13 | Train Loss: 0.083 Vali Loss: 4.882 Vali Acc: 0.433 Test Loss: 4.882 Test Acc: 0.433
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.8117241859436035
Epoch: 18, Steps: 13 | Train Loss: 0.004 Vali Loss: 5.156 Vali Acc: 0.489 Test Loss: 5.156 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.497853994369507
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 5.410 Vali Acc: 0.489 Test Loss: 5.410 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 1057538
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.857039213180542
Epoch: 1, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.748 Vali Acc: 0.483 Test Loss: 0.748 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 5.587796211242676
Epoch: 2, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.897 Vali Acc: 0.506 Test Loss: 0.897 Test Acc: 0.506
Validation loss decreased (-0.483326 --> -0.505547).  Saving model ...
Epoch: 3 cost time: 5.698460340499878
Epoch: 3, Steps: 13 | Train Loss: 0.611 Vali Loss: 2.061 Vali Acc: 0.517 Test Loss: 2.061 Test Acc: 0.517
Validation loss decreased (-0.505547 --> -0.516646).  Saving model ...
Epoch: 4 cost time: 6.09044337272644
Epoch: 4, Steps: 13 | Train Loss: 0.579 Vali Loss: 1.633 Vali Acc: 0.478 Test Loss: 1.633 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.514954090118408
Epoch: 5, Steps: 13 | Train Loss: 0.389 Vali Loss: 2.044 Vali Acc: 0.517 Test Loss: 2.044 Test Acc: 0.517
Validation loss decreased (-0.516646 --> -0.516646).  Saving model ...
Epoch: 6 cost time: 5.83372950553894
Epoch: 6, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.785 Vali Acc: 0.478 Test Loss: 1.785 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.892224311828613
Epoch: 7, Steps: 13 | Train Loss: 0.192 Vali Loss: 2.751 Vali Acc: 0.472 Test Loss: 2.751 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.72261905670166
Epoch: 8, Steps: 13 | Train Loss: 0.257 Vali Loss: 2.958 Vali Acc: 0.522 Test Loss: 2.958 Test Acc: 0.522
Validation loss decreased (-0.516646 --> -0.522193).  Saving model ...
Epoch: 9 cost time: 5.679842948913574
Epoch: 9, Steps: 13 | Train Loss: 0.235 Vali Loss: 3.140 Vali Acc: 0.472 Test Loss: 3.140 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.40244722366333
Epoch: 10, Steps: 13 | Train Loss: 0.111 Vali Loss: 3.170 Vali Acc: 0.483 Test Loss: 3.170 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.402104377746582
Epoch: 11, Steps: 13 | Train Loss: 0.271 Vali Loss: 3.423 Vali Acc: 0.478 Test Loss: 3.423 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.419977426528931
Epoch: 12, Steps: 13 | Train Loss: 0.075 Vali Loss: 3.550 Vali Acc: 0.472 Test Loss: 3.550 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.596980571746826
Epoch: 13, Steps: 13 | Train Loss: 0.074 Vali Loss: 3.757 Vali Acc: 0.494 Test Loss: 3.757 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.804569244384766
Epoch: 14, Steps: 13 | Train Loss: 0.087 Vali Loss: 5.101 Vali Acc: 0.494 Test Loss: 5.101 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.821399450302124
Epoch: 15, Steps: 13 | Train Loss: 0.183 Vali Loss: 4.030 Vali Acc: 0.517 Test Loss: 4.030 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.595037221908569
Epoch: 16, Steps: 13 | Train Loss: 0.033 Vali Loss: 4.731 Vali Acc: 0.522 Test Loss: 4.731 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.964880704879761
Epoch: 17, Steps: 13 | Train Loss: 0.008 Vali Loss: 5.425 Vali Acc: 0.489 Test Loss: 5.425 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.843997955322266
Epoch: 18, Steps: 13 | Train Loss: 0.083 Vali Loss: 5.670 Vali Acc: 0.494 Test Loss: 5.670 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 1057538
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.503788948059082
Epoch: 1, Steps: 13 | Train Loss: 0.784 Vali Loss: 0.752 Vali Acc: 0.522 Test Loss: 0.752 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 4.881750106811523
Epoch: 2, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.910 Vali Acc: 0.494 Test Loss: 0.910 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.9312639236450195
Epoch: 3, Steps: 13 | Train Loss: 0.594 Vali Loss: 1.971 Vali Acc: 0.506 Test Loss: 1.971 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.035619258880615
Epoch: 4, Steps: 13 | Train Loss: 0.620 Vali Loss: 1.485 Vali Acc: 0.483 Test Loss: 1.485 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.254087209701538
Epoch: 5, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.617 Vali Acc: 0.511 Test Loss: 1.617 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.088243722915649
Epoch: 6, Steps: 13 | Train Loss: 0.435 Vali Loss: 1.885 Vali Acc: 0.489 Test Loss: 1.885 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.231961011886597
Epoch: 7, Steps: 13 | Train Loss: 0.242 Vali Loss: 2.172 Vali Acc: 0.517 Test Loss: 2.172 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.415724039077759
Epoch: 8, Steps: 13 | Train Loss: 0.179 Vali Loss: 2.309 Vali Acc: 0.456 Test Loss: 2.309 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.732103109359741
Epoch: 9, Steps: 13 | Train Loss: 0.099 Vali Loss: 3.270 Vali Acc: 0.500 Test Loss: 3.270 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.677966833114624
Epoch: 10, Steps: 13 | Train Loss: 0.290 Vali Loss: 2.681 Vali Acc: 0.500 Test Loss: 2.681 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.680690288543701
Epoch: 11, Steps: 13 | Train Loss: 0.352 Vali Loss: 3.067 Vali Acc: 0.456 Test Loss: 3.067 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 1057538
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.573224067687988
Epoch: 1, Steps: 13 | Train Loss: 0.775 Vali Loss: 0.787 Vali Acc: 0.539 Test Loss: 0.787 Test Acc: 0.539
Validation loss decreased (inf --> -0.538881).  Saving model ...
Epoch: 2 cost time: 4.310742139816284
Epoch: 2, Steps: 13 | Train Loss: 0.603 Vali Loss: 1.000 Vali Acc: 0.528 Test Loss: 1.000 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.608985185623169
Epoch: 3, Steps: 13 | Train Loss: 0.523 Vali Loss: 1.541 Vali Acc: 0.494 Test Loss: 1.541 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.710826396942139
Epoch: 4, Steps: 13 | Train Loss: 0.402 Vali Loss: 1.347 Vali Acc: 0.522 Test Loss: 1.347 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.943992853164673
Epoch: 5, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.585 Vali Acc: 0.483 Test Loss: 1.585 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.447937488555908
Epoch: 6, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.769 Vali Acc: 0.500 Test Loss: 1.769 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.7821760177612305
Epoch: 7, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.919 Vali Acc: 0.472 Test Loss: 1.919 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.984287738800049
Epoch: 8, Steps: 13 | Train Loss: 0.124 Vali Loss: 2.596 Vali Acc: 0.517 Test Loss: 2.596 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.275591135025024
Epoch: 9, Steps: 13 | Train Loss: 0.224 Vali Loss: 2.319 Vali Acc: 0.478 Test Loss: 2.319 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.982304811477661
Epoch: 10, Steps: 13 | Train Loss: 0.330 Vali Loss: 3.598 Vali Acc: 0.522 Test Loss: 3.598 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.221559762954712
Epoch: 11, Steps: 13 | Train Loss: 0.161 Vali Loss: 3.542 Vali Acc: 0.550 Test Loss: 3.542 Test Acc: 0.550
Validation loss decreased (-0.538881 --> -0.549965).  Saving model ...
Epoch: 12 cost time: 5.089701890945435
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 3.510 Vali Acc: 0.500 Test Loss: 3.510 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.327039003372192
Epoch: 13, Steps: 13 | Train Loss: 0.088 Vali Loss: 4.017 Vali Acc: 0.500 Test Loss: 4.017 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.906935453414917
Epoch: 14, Steps: 13 | Train Loss: 0.085 Vali Loss: 3.663 Vali Acc: 0.456 Test Loss: 3.663 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.486525058746338
Epoch: 15, Steps: 13 | Train Loss: 0.069 Vali Loss: 3.787 Vali Acc: 0.483 Test Loss: 3.787 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.934765815734863
Epoch: 16, Steps: 13 | Train Loss: 0.051 Vali Loss: 4.204 Vali Acc: 0.467 Test Loss: 4.204 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.010628938674927
Epoch: 17, Steps: 13 | Train Loss: 0.041 Vali Loss: 4.633 Vali Acc: 0.517 Test Loss: 4.633 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.879750967025757
Epoch: 18, Steps: 13 | Train Loss: 0.139 Vali Loss: 5.502 Vali Acc: 0.506 Test Loss: 5.502 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.59851336479187
Epoch: 19, Steps: 13 | Train Loss: 0.043 Vali Loss: 4.751 Vali Acc: 0.467 Test Loss: 4.751 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.957474946975708
Epoch: 20, Steps: 13 | Train Loss: 0.038 Vali Loss: 5.539 Vali Acc: 0.478 Test Loss: 5.539 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.075873613357544
Epoch: 21, Steps: 13 | Train Loss: 0.007 Vali Loss: 5.363 Vali Acc: 0.439 Test Loss: 5.363 Test Acc: 0.439
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1057538
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.040644407272339
Epoch: 1, Steps: 13 | Train Loss: 0.783 Vali Loss: 0.769 Vali Acc: 0.528 Test Loss: 0.769 Test Acc: 0.528
Validation loss decreased (inf --> -0.527770).  Saving model ...
Epoch: 2 cost time: 4.806400537490845
Epoch: 2, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.903 Vali Acc: 0.506 Test Loss: 0.903 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.589980602264404
Epoch: 3, Steps: 13 | Train Loss: 0.533 Vali Loss: 1.740 Vali Acc: 0.517 Test Loss: 1.740 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.341991186141968
Epoch: 4, Steps: 13 | Train Loss: 0.503 Vali Loss: 1.538 Vali Acc: 0.539 Test Loss: 1.538 Test Acc: 0.539
Validation loss decreased (-0.527770 --> -0.538874).  Saving model ...
Epoch: 5 cost time: 4.434355735778809
Epoch: 5, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.515 Vali Acc: 0.483 Test Loss: 1.515 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.543252468109131
Epoch: 6, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.700 Vali Acc: 0.567 Test Loss: 1.700 Test Acc: 0.567
Validation loss decreased (-0.538874 --> -0.566650).  Saving model ...
Epoch: 7 cost time: 4.5472142696380615
Epoch: 7, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.947 Vali Acc: 0.556 Test Loss: 1.947 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.326416254043579
Epoch: 8, Steps: 13 | Train Loss: 0.145 Vali Loss: 2.264 Vali Acc: 0.467 Test Loss: 2.264 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.117834091186523
Epoch: 9, Steps: 13 | Train Loss: 0.300 Vali Loss: 2.787 Vali Acc: 0.544 Test Loss: 2.787 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.700410604476929
Epoch: 10, Steps: 13 | Train Loss: 0.151 Vali Loss: 2.856 Vali Acc: 0.494 Test Loss: 2.856 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.590651988983154
Epoch: 11, Steps: 13 | Train Loss: 0.071 Vali Loss: 3.172 Vali Acc: 0.544 Test Loss: 3.172 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.573222637176514
Epoch: 12, Steps: 13 | Train Loss: 0.098 Vali Loss: 3.831 Vali Acc: 0.528 Test Loss: 3.831 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.59993314743042
Epoch: 13, Steps: 13 | Train Loss: 0.139 Vali Loss: 4.273 Vali Acc: 0.500 Test Loss: 4.273 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.273986577987671
Epoch: 14, Steps: 13 | Train Loss: 0.248 Vali Loss: 4.655 Vali Acc: 0.522 Test Loss: 4.655 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.828702211380005
Epoch: 15, Steps: 13 | Train Loss: 0.143 Vali Loss: 4.442 Vali Acc: 0.533 Test Loss: 4.442 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.830236434936523
Epoch: 16, Steps: 13 | Train Loss: 0.139 Vali Loss: 4.926 Vali Acc: 0.511 Test Loss: 4.926 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 1057538
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.42549204826355
Epoch: 1, Steps: 13 | Train Loss: 0.809 Vali Loss: 0.753 Vali Acc: 0.517 Test Loss: 0.753 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 4.401620388031006
Epoch: 2, Steps: 13 | Train Loss: 0.625 Vali Loss: 1.042 Vali Acc: 0.506 Test Loss: 1.042 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.659172534942627
Epoch: 3, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.045 Vali Acc: 0.478 Test Loss: 1.045 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.4030492305755615
Epoch: 4, Steps: 13 | Train Loss: 0.323 Vali Loss: 1.289 Vali Acc: 0.506 Test Loss: 1.289 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.0760657787323
Epoch: 5, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.519 Vali Acc: 0.522 Test Loss: 1.519 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522207).  Saving model ...
Epoch: 6 cost time: 3.78296160697937
Epoch: 6, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.850 Vali Acc: 0.483 Test Loss: 1.850 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.222426891326904
Epoch: 7, Steps: 13 | Train Loss: 0.263 Vali Loss: 2.183 Vali Acc: 0.489 Test Loss: 2.183 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.3346898555755615
Epoch: 8, Steps: 13 | Train Loss: 0.197 Vali Loss: 2.387 Vali Acc: 0.489 Test Loss: 2.387 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.212752103805542
Epoch: 9, Steps: 13 | Train Loss: 0.068 Vali Loss: 3.334 Vali Acc: 0.461 Test Loss: 3.334 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.60956597328186
Epoch: 10, Steps: 13 | Train Loss: 0.318 Vali Loss: 3.720 Vali Acc: 0.478 Test Loss: 3.720 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.65820837020874
Epoch: 11, Steps: 13 | Train Loss: 0.304 Vali Loss: 2.851 Vali Acc: 0.483 Test Loss: 2.851 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.752256393432617
Epoch: 12, Steps: 13 | Train Loss: 0.190 Vali Loss: 3.420 Vali Acc: 0.461 Test Loss: 3.420 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.615876197814941
Epoch: 13, Steps: 13 | Train Loss: 0.063 Vali Loss: 3.547 Vali Acc: 0.506 Test Loss: 3.547 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.946075916290283
Epoch: 14, Steps: 13 | Train Loss: 0.041 Vali Loss: 3.746 Vali Acc: 0.489 Test Loss: 3.746 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.752659797668457
Epoch: 15, Steps: 13 | Train Loss: 0.010 Vali Loss: 4.007 Vali Acc: 0.539 Test Loss: 4.007 Test Acc: 0.539
Validation loss decreased (-0.522207 --> -0.538849).  Saving model ...
Epoch: 16 cost time: 4.360827922821045
Epoch: 16, Steps: 13 | Train Loss: 0.036 Vali Loss: 4.233 Vali Acc: 0.472 Test Loss: 4.233 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.768373727798462
Epoch: 17, Steps: 13 | Train Loss: 0.010 Vali Loss: 4.129 Vali Acc: 0.500 Test Loss: 4.129 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.956542015075684
Epoch: 18, Steps: 13 | Train Loss: 0.027 Vali Loss: 4.616 Vali Acc: 0.517 Test Loss: 4.616 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.479928731918335
Epoch: 19, Steps: 13 | Train Loss: 0.052 Vali Loss: 4.855 Vali Acc: 0.483 Test Loss: 4.855 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.705210208892822
Epoch: 20, Steps: 13 | Train Loss: 0.004 Vali Loss: 4.340 Vali Acc: 0.494 Test Loss: 4.340 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.780463218688965
Epoch: 21, Steps: 13 | Train Loss: 0.021 Vali Loss: 4.844 Vali Acc: 0.478 Test Loss: 4.844 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.213152885437012
Epoch: 22, Steps: 13 | Train Loss: 0.073 Vali Loss: 5.990 Vali Acc: 0.489 Test Loss: 5.990 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.777583599090576
Epoch: 23, Steps: 13 | Train Loss: 0.112 Vali Loss: 6.162 Vali Acc: 0.506 Test Loss: 6.162 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.111657381057739
Epoch: 24, Steps: 13 | Train Loss: 0.095 Vali Loss: 5.936 Vali Acc: 0.533 Test Loss: 5.936 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.998301029205322
Epoch: 25, Steps: 13 | Train Loss: 0.016 Vali Loss: 5.765 Vali Acc: 0.528 Test Loss: 5.765 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 1057538
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.60275936126709
Epoch: 1, Steps: 13 | Train Loss: 0.775 Vali Loss: 0.821 Vali Acc: 0.467 Test Loss: 0.821 Test Acc: 0.467
Validation loss decreased (inf --> -0.466658).  Saving model ...
Epoch: 2 cost time: 4.69528603553772
Epoch: 2, Steps: 13 | Train Loss: 0.642 Vali Loss: 1.088 Vali Acc: 0.478 Test Loss: 1.088 Test Acc: 0.478
Validation loss decreased (-0.466658 --> -0.477767).  Saving model ...
Epoch: 3 cost time: 4.5670294761657715
Epoch: 3, Steps: 13 | Train Loss: 0.585 Vali Loss: 1.448 Vali Acc: 0.472 Test Loss: 1.448 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.390126705169678
Epoch: 4, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.422 Vali Acc: 0.506 Test Loss: 1.422 Test Acc: 0.506
Validation loss decreased (-0.477767 --> -0.505541).  Saving model ...
Epoch: 5 cost time: 4.004091739654541
Epoch: 5, Steps: 13 | Train Loss: 0.287 Vali Loss: 1.838 Vali Acc: 0.494 Test Loss: 1.838 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.524582862854004
Epoch: 6, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.764 Vali Acc: 0.456 Test Loss: 1.764 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.541152000427246
Epoch: 7, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.925 Vali Acc: 0.522 Test Loss: 1.925 Test Acc: 0.522
Validation loss decreased (-0.505541 --> -0.522203).  Saving model ...
Epoch: 8 cost time: 3.820283889770508
Epoch: 8, Steps: 13 | Train Loss: 0.279 Vali Loss: 2.450 Vali Acc: 0.467 Test Loss: 2.450 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.877166271209717
Epoch: 9, Steps: 13 | Train Loss: 0.182 Vali Loss: 2.688 Vali Acc: 0.517 Test Loss: 2.688 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.603521108627319
Epoch: 10, Steps: 13 | Train Loss: 0.111 Vali Loss: 2.702 Vali Acc: 0.483 Test Loss: 2.702 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.737934112548828
Epoch: 11, Steps: 13 | Train Loss: 0.236 Vali Loss: 3.479 Vali Acc: 0.461 Test Loss: 3.479 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.026525974273682
Epoch: 12, Steps: 13 | Train Loss: 0.490 Vali Loss: 3.094 Vali Acc: 0.506 Test Loss: 3.094 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.115249872207642
Epoch: 13, Steps: 13 | Train Loss: 0.304 Vali Loss: 3.869 Vali Acc: 0.483 Test Loss: 3.869 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.56494140625
Epoch: 14, Steps: 13 | Train Loss: 0.195 Vali Loss: 3.969 Vali Acc: 0.428 Test Loss: 3.969 Test Acc: 0.428
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.6143999099731445
Epoch: 15, Steps: 13 | Train Loss: 0.283 Vali Loss: 4.293 Vali Acc: 0.467 Test Loss: 4.293 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.342314958572388
Epoch: 16, Steps: 13 | Train Loss: 0.448 Vali Loss: 4.134 Vali Acc: 0.439 Test Loss: 4.134 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.791492462158203
Epoch: 17, Steps: 13 | Train Loss: 0.259 Vali Loss: 4.629 Vali Acc: 0.467 Test Loss: 4.629 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 1057538
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.540995836257935
Epoch: 1, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.771 Vali Acc: 0.506 Test Loss: 0.771 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 4.944794654846191
Epoch: 2, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.992 Vali Acc: 0.472 Test Loss: 0.992 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.985863208770752
Epoch: 3, Steps: 13 | Train Loss: 0.452 Vali Loss: 1.143 Vali Acc: 0.478 Test Loss: 1.143 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.906143665313721
Epoch: 4, Steps: 13 | Train Loss: 0.380 Vali Loss: 1.413 Vali Acc: 0.478 Test Loss: 1.413 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.2708165645599365
Epoch: 5, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.697 Vali Acc: 0.483 Test Loss: 1.697 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.729023456573486
Epoch: 6, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.837 Vali Acc: 0.467 Test Loss: 1.837 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.909472703933716
Epoch: 7, Steps: 13 | Train Loss: 0.201 Vali Loss: 2.163 Vali Acc: 0.450 Test Loss: 2.163 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.003480434417725
Epoch: 8, Steps: 13 | Train Loss: 0.110 Vali Loss: 2.166 Vali Acc: 0.478 Test Loss: 2.166 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.139336347579956
Epoch: 9, Steps: 13 | Train Loss: 0.080 Vali Loss: 2.951 Vali Acc: 0.467 Test Loss: 2.951 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.030156135559082
Epoch: 10, Steps: 13 | Train Loss: 0.201 Vali Loss: 2.709 Vali Acc: 0.450 Test Loss: 2.709 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.0041728019714355
Epoch: 11, Steps: 13 | Train Loss: 0.333 Vali Loss: 3.405 Vali Acc: 0.511 Test Loss: 3.405 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511077).  Saving model ...
Epoch: 12 cost time: 4.409929275512695
Epoch: 12, Steps: 13 | Train Loss: 0.260 Vali Loss: 3.713 Vali Acc: 0.478 Test Loss: 3.713 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.715698957443237
Epoch: 13, Steps: 13 | Train Loss: 0.163 Vali Loss: 3.635 Vali Acc: 0.489 Test Loss: 3.635 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.0505475997924805
Epoch: 14, Steps: 13 | Train Loss: 0.060 Vali Loss: 3.413 Vali Acc: 0.489 Test Loss: 3.413 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.221775770187378
Epoch: 15, Steps: 13 | Train Loss: 0.055 Vali Loss: 3.872 Vali Acc: 0.467 Test Loss: 3.872 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.456187963485718
Epoch: 16, Steps: 13 | Train Loss: 0.097 Vali Loss: 4.412 Vali Acc: 0.439 Test Loss: 4.412 Test Acc: 0.439
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.321038007736206
Epoch: 17, Steps: 13 | Train Loss: 0.047 Vali Loss: 4.709 Vali Acc: 0.422 Test Loss: 4.709 Test Acc: 0.422
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.4471728801727295
Epoch: 18, Steps: 13 | Train Loss: 0.058 Vali Loss: 4.836 Vali Acc: 0.417 Test Loss: 4.836 Test Acc: 0.417
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.935902118682861
Epoch: 19, Steps: 13 | Train Loss: 0.041 Vali Loss: 4.813 Vali Acc: 0.467 Test Loss: 4.813 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.206870794296265
Epoch: 20, Steps: 13 | Train Loss: 0.090 Vali Loss: 5.191 Vali Acc: 0.478 Test Loss: 5.191 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.811323642730713
Epoch: 21, Steps: 13 | Train Loss: 0.031 Vali Loss: 5.665 Vali Acc: 0.450 Test Loss: 5.665 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 1057538
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.412465333938599
Epoch: 1, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.704 Vali Acc: 0.517 Test Loss: 0.704 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 4.253960847854614
Epoch: 2, Steps: 13 | Train Loss: 0.676 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.784066677093506
Epoch: 3, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.875 Vali Acc: 0.511 Test Loss: 0.875 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.740168571472168
Epoch: 4, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.867 Vali Acc: 0.561 Test Loss: 0.867 Test Acc: 0.561
Validation loss decreased (-0.516660 --> -0.561102).  Saving model ...
Epoch: 5 cost time: 4.556941986083984
Epoch: 5, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.909 Vali Acc: 0.583 Test Loss: 0.909 Test Acc: 0.583
Validation loss decreased (-0.561102 --> -0.583324).  Saving model ...
Epoch: 6 cost time: 4.123963356018066
Epoch: 6, Steps: 13 | Train Loss: 0.446 Vali Loss: 1.076 Vali Acc: 0.561 Test Loss: 1.076 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.656821966171265
Epoch: 7, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.094 Vali Acc: 0.583 Test Loss: 1.094 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.660838842391968
Epoch: 8, Steps: 13 | Train Loss: 0.278 Vali Loss: 1.268 Vali Acc: 0.511 Test Loss: 1.268 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.209657907485962
Epoch: 9, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.877 Vali Acc: 0.517 Test Loss: 1.877 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.209261178970337
Epoch: 10, Steps: 13 | Train Loss: 0.500 Vali Loss: 1.553 Vali Acc: 0.550 Test Loss: 1.553 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.599401235580444
Epoch: 11, Steps: 13 | Train Loss: 0.500 Vali Loss: 1.795 Vali Acc: 0.522 Test Loss: 1.795 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.306152105331421
Epoch: 12, Steps: 13 | Train Loss: 0.362 Vali Loss: 3.481 Vali Acc: 0.506 Test Loss: 3.481 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.054709434509277
Epoch: 13, Steps: 13 | Train Loss: 0.570 Vali Loss: 1.867 Vali Acc: 0.572 Test Loss: 1.867 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.623682498931885
Epoch: 14, Steps: 13 | Train Loss: 0.108 Vali Loss: 2.080 Vali Acc: 0.528 Test Loss: 2.080 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.715925216674805
Epoch: 15, Steps: 13 | Train Loss: 0.228 Vali Loss: 2.568 Vali Acc: 0.539 Test Loss: 2.568 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 1057538
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.182536363601685
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.801 Vali Acc: 0.517 Test Loss: 0.801 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 5.0640342235565186
Epoch: 2, Steps: 13 | Train Loss: 0.742 Vali Loss: 1.034 Vali Acc: 0.517 Test Loss: 1.034 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.437197923660278
Epoch: 3, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.975 Vali Acc: 0.494 Test Loss: 0.975 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.887777090072632
Epoch: 4, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.898 Vali Acc: 0.528 Test Loss: 0.898 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527769).  Saving model ...
Epoch: 5 cost time: 4.503093004226685
Epoch: 5, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.881 Vali Acc: 0.544 Test Loss: 0.881 Test Acc: 0.544
Validation loss decreased (-0.527769 --> -0.544436).  Saving model ...
Epoch: 6 cost time: 4.442617654800415
Epoch: 6, Steps: 13 | Train Loss: 0.641 Vali Loss: 1.347 Vali Acc: 0.472 Test Loss: 1.347 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.932383060455322
Epoch: 7, Steps: 13 | Train Loss: 0.800 Vali Loss: 1.196 Vali Acc: 0.533 Test Loss: 1.196 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.711932182312012
Epoch: 8, Steps: 13 | Train Loss: 0.591 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.325253963470459
Epoch: 9, Steps: 13 | Train Loss: 0.691 Vali Loss: 1.433 Vali Acc: 0.500 Test Loss: 1.433 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.9958412647247314
Epoch: 10, Steps: 13 | Train Loss: 0.749 Vali Loss: 1.699 Vali Acc: 0.556 Test Loss: 1.699 Test Acc: 0.556
Validation loss decreased (-0.544436 --> -0.555539).  Saving model ...
Epoch: 11 cost time: 4.634001731872559
Epoch: 11, Steps: 13 | Train Loss: 0.553 Vali Loss: 1.665 Vali Acc: 0.550 Test Loss: 1.665 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.452514410018921
Epoch: 12, Steps: 13 | Train Loss: 0.526 Vali Loss: 1.383 Vali Acc: 0.494 Test Loss: 1.383 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.32623553276062
Epoch: 13, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.789 Vali Acc: 0.539 Test Loss: 1.789 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.07584285736084
Epoch: 14, Steps: 13 | Train Loss: 0.483 Vali Loss: 2.088 Vali Acc: 0.517 Test Loss: 2.088 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.527355909347534
Epoch: 15, Steps: 13 | Train Loss: 0.437 Vali Loss: 2.118 Vali Acc: 0.539 Test Loss: 2.118 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.230921030044556
Epoch: 16, Steps: 13 | Train Loss: 0.667 Vali Loss: 2.379 Vali Acc: 0.539 Test Loss: 2.379 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.984579563140869
Epoch: 17, Steps: 13 | Train Loss: 0.479 Vali Loss: 1.898 Vali Acc: 0.506 Test Loss: 1.898 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.789546728134155
Epoch: 18, Steps: 13 | Train Loss: 0.430 Vali Loss: 2.139 Vali Acc: 0.544 Test Loss: 2.139 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.5410661697387695
Epoch: 19, Steps: 13 | Train Loss: 0.469 Vali Loss: 2.019 Vali Acc: 0.506 Test Loss: 2.019 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.066331624984741
Epoch: 20, Steps: 13 | Train Loss: 0.535 Vali Loss: 1.849 Vali Acc: 0.489 Test Loss: 1.849 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 1057538
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.5062575340271
Epoch: 1, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.734 Vali Acc: 0.511 Test Loss: 0.734 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 5.337784290313721
Epoch: 2, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.831 Vali Acc: 0.467 Test Loss: 0.831 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.973556280136108
Epoch: 3, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.944 Vali Acc: 0.500 Test Loss: 0.944 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.522469997406006
Epoch: 4, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.198 Vali Acc: 0.506 Test Loss: 1.198 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.2493979930877686
Epoch: 5, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.300 Vali Acc: 0.483 Test Loss: 1.300 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.260799169540405
Epoch: 6, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.469 Vali Acc: 0.444 Test Loss: 1.469 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.174804925918579
Epoch: 7, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.653 Vali Acc: 0.494 Test Loss: 1.653 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.0471532344818115
Epoch: 8, Steps: 13 | Train Loss: 0.098 Vali Loss: 2.069 Vali Acc: 0.500 Test Loss: 2.069 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.79564905166626
Epoch: 9, Steps: 13 | Train Loss: 0.075 Vali Loss: 2.208 Vali Acc: 0.472 Test Loss: 2.208 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.241908073425293
Epoch: 10, Steps: 13 | Train Loss: 0.038 Vali Loss: 2.435 Vali Acc: 0.456 Test Loss: 2.435 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.756799936294556
Epoch: 11, Steps: 13 | Train Loss: 0.033 Vali Loss: 2.479 Vali Acc: 0.461 Test Loss: 2.479 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 1102210
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.640852689743042
Epoch: 1, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 5.180271148681641
Epoch: 2, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.330509185791016
Epoch: 3, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.965 Vali Acc: 0.522 Test Loss: 0.965 Test Acc: 0.522
Validation loss decreased (-0.499993 --> -0.522213).  Saving model ...
Epoch: 4 cost time: 5.14720892906189
Epoch: 4, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.167 Vali Acc: 0.511 Test Loss: 1.167 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.925353288650513
Epoch: 5, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.255 Vali Acc: 0.511 Test Loss: 1.255 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.188698053359985
Epoch: 6, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.577 Vali Acc: 0.428 Test Loss: 1.577 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.099637031555176
Epoch: 7, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.572 Vali Acc: 0.500 Test Loss: 1.572 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.858488082885742
Epoch: 8, Steps: 13 | Train Loss: 0.146 Vali Loss: 2.217 Vali Acc: 0.478 Test Loss: 2.217 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.017869472503662
Epoch: 9, Steps: 13 | Train Loss: 0.107 Vali Loss: 2.231 Vali Acc: 0.450 Test Loss: 2.231 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.671139240264893
Epoch: 10, Steps: 13 | Train Loss: 0.045 Vali Loss: 2.220 Vali Acc: 0.461 Test Loss: 2.220 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.428582429885864
Epoch: 11, Steps: 13 | Train Loss: 0.040 Vali Loss: 2.358 Vali Acc: 0.450 Test Loss: 2.358 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.094816207885742
Epoch: 12, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.694 Vali Acc: 0.450 Test Loss: 2.694 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.03776478767395
Epoch: 13, Steps: 13 | Train Loss: 0.013 Vali Loss: 3.023 Vali Acc: 0.478 Test Loss: 3.023 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 1102210
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.692278146743774
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.722 Vali Acc: 0.517 Test Loss: 0.722 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 5.2818121910095215
Epoch: 2, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.821 Vali Acc: 0.483 Test Loss: 0.821 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.390830039978027
Epoch: 3, Steps: 13 | Train Loss: 0.458 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 5.249347686767578
Epoch: 4, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.144 Vali Acc: 0.472 Test Loss: 1.144 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.1687376499176025
Epoch: 5, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.332 Vali Acc: 0.461 Test Loss: 1.332 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.074719667434692
Epoch: 6, Steps: 13 | Train Loss: 0.225 Vali Loss: 1.456 Vali Acc: 0.467 Test Loss: 1.456 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.707163333892822
Epoch: 7, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.639 Vali Acc: 0.472 Test Loss: 1.639 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.8557658195495605
Epoch: 8, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.978 Vali Acc: 0.478 Test Loss: 1.978 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.856821298599243
Epoch: 9, Steps: 13 | Train Loss: 0.081 Vali Loss: 2.086 Vali Acc: 0.489 Test Loss: 2.086 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.0529584884643555
Epoch: 10, Steps: 13 | Train Loss: 0.097 Vali Loss: 2.229 Vali Acc: 0.461 Test Loss: 2.229 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.8901989459991455
Epoch: 11, Steps: 13 | Train Loss: 0.041 Vali Loss: 2.626 Vali Acc: 0.478 Test Loss: 2.626 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.1645989418029785
Epoch: 12, Steps: 13 | Train Loss: 0.037 Vali Loss: 2.653 Vali Acc: 0.439 Test Loss: 2.653 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.3033287525177
Epoch: 13, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.855 Vali Acc: 0.461 Test Loss: 2.855 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 1102210
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.86036229133606
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.714 Vali Acc: 0.528 Test Loss: 0.714 Test Acc: 0.528
Validation loss decreased (inf --> -0.527771).  Saving model ...
Epoch: 2 cost time: 4.806745529174805
Epoch: 2, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.137788772583008
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.948 Vali Acc: 0.550 Test Loss: 0.948 Test Acc: 0.550
Validation loss decreased (-0.527771 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 5.060575008392334
Epoch: 4, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.034 Vali Acc: 0.500 Test Loss: 1.034 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.781343936920166
Epoch: 5, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.281 Vali Acc: 0.472 Test Loss: 1.281 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.498206377029419
Epoch: 6, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.389 Vali Acc: 0.489 Test Loss: 1.389 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.37779974937439
Epoch: 7, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.557 Vali Acc: 0.494 Test Loss: 1.557 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.866128444671631
Epoch: 8, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.948 Vali Acc: 0.461 Test Loss: 1.948 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.637279272079468
Epoch: 9, Steps: 13 | Train Loss: 0.094 Vali Loss: 2.038 Vali Acc: 0.472 Test Loss: 2.038 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.869697570800781
Epoch: 10, Steps: 13 | Train Loss: 0.040 Vali Loss: 2.425 Vali Acc: 0.500 Test Loss: 2.425 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.459225416183472
Epoch: 11, Steps: 13 | Train Loss: 0.047 Vali Loss: 2.348 Vali Acc: 0.489 Test Loss: 2.348 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.1377880573272705
Epoch: 12, Steps: 13 | Train Loss: 0.017 Vali Loss: 2.510 Vali Acc: 0.483 Test Loss: 2.510 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.819814682006836
Epoch: 13, Steps: 13 | Train Loss: 0.019 Vali Loss: 2.554 Vali Acc: 0.472 Test Loss: 2.554 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1102210
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.103013515472412
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.728 Vali Acc: 0.528 Test Loss: 0.728 Test Acc: 0.528
Validation loss decreased (inf --> -0.527770).  Saving model ...
Epoch: 2 cost time: 4.685885906219482
Epoch: 2, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.839 Vali Acc: 0.550 Test Loss: 0.839 Test Acc: 0.550
Validation loss decreased (-0.527770 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 4.934914827346802
Epoch: 3, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.941 Vali Acc: 0.478 Test Loss: 0.941 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.7962305545806885
Epoch: 4, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.116 Vali Acc: 0.461 Test Loss: 1.116 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.788557767868042
Epoch: 5, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.264 Vali Acc: 0.533 Test Loss: 1.264 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.612397193908691
Epoch: 6, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.594 Vali Acc: 0.522 Test Loss: 1.594 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.591246604919434
Epoch: 7, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.581 Vali Acc: 0.483 Test Loss: 1.581 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.688857555389404
Epoch: 8, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.897 Vali Acc: 0.483 Test Loss: 1.897 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.637010335922241
Epoch: 9, Steps: 13 | Train Loss: 0.068 Vali Loss: 2.159 Vali Acc: 0.472 Test Loss: 2.159 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.6144256591796875
Epoch: 10, Steps: 13 | Train Loss: 0.094 Vali Loss: 2.547 Vali Acc: 0.500 Test Loss: 2.547 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.444959402084351
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 2.635 Vali Acc: 0.500 Test Loss: 2.635 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.473655939102173
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 2.606 Vali Acc: 0.489 Test Loss: 2.606 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1102210
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.097893714904785
Epoch: 1, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.742 Vali Acc: 0.506 Test Loss: 0.742 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 4.2502219676971436
Epoch: 2, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.778 Vali Acc: 0.533 Test Loss: 0.778 Test Acc: 0.533
Validation loss decreased (-0.505548 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 4.311010837554932
Epoch: 3, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.981 Vali Acc: 0.500 Test Loss: 0.981 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.434431076049805
Epoch: 4, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.980 Vali Acc: 0.517 Test Loss: 0.980 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.600988149642944
Epoch: 5, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.120 Vali Acc: 0.506 Test Loss: 1.120 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.054042100906372
Epoch: 6, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.282 Vali Acc: 0.517 Test Loss: 1.282 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.12417197227478
Epoch: 7, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.445 Vali Acc: 0.544 Test Loss: 1.445 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544430).  Saving model ...
Epoch: 8 cost time: 4.132320404052734
Epoch: 8, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.714 Vali Acc: 0.489 Test Loss: 1.714 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.092775583267212
Epoch: 9, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.904 Vali Acc: 0.517 Test Loss: 1.904 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.27104377746582
Epoch: 10, Steps: 13 | Train Loss: 0.045 Vali Loss: 2.040 Vali Acc: 0.489 Test Loss: 2.040 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.249135494232178
Epoch: 11, Steps: 13 | Train Loss: 0.095 Vali Loss: 2.492 Vali Acc: 0.489 Test Loss: 2.492 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.224700212478638
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 2.601 Vali Acc: 0.494 Test Loss: 2.601 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.29342794418335
Epoch: 13, Steps: 13 | Train Loss: 0.045 Vali Loss: 2.784 Vali Acc: 0.472 Test Loss: 2.784 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.319092273712158
Epoch: 14, Steps: 13 | Train Loss: 0.051 Vali Loss: 3.231 Vali Acc: 0.444 Test Loss: 3.231 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.323919057846069
Epoch: 15, Steps: 13 | Train Loss: 0.071 Vali Loss: 3.728 Vali Acc: 0.483 Test Loss: 3.728 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.456874132156372
Epoch: 16, Steps: 13 | Train Loss: 0.101 Vali Loss: 3.041 Vali Acc: 0.561 Test Loss: 3.041 Test Acc: 0.561
Validation loss decreased (-0.544430 --> -0.561081).  Saving model ...
Epoch: 17 cost time: 4.588795185089111
Epoch: 17, Steps: 13 | Train Loss: 0.012 Vali Loss: 3.103 Vali Acc: 0.522 Test Loss: 3.103 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.393031120300293
Epoch: 18, Steps: 13 | Train Loss: 0.021 Vali Loss: 3.366 Vali Acc: 0.478 Test Loss: 3.366 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.577211141586304
Epoch: 19, Steps: 13 | Train Loss: 0.007 Vali Loss: 3.560 Vali Acc: 0.478 Test Loss: 3.560 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.271295547485352
Epoch: 20, Steps: 13 | Train Loss: 0.008 Vali Loss: 3.801 Vali Acc: 0.483 Test Loss: 3.801 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.168221712112427
Epoch: 21, Steps: 13 | Train Loss: 0.032 Vali Loss: 3.937 Vali Acc: 0.472 Test Loss: 3.937 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.274951934814453
Epoch: 22, Steps: 13 | Train Loss: 0.045 Vali Loss: 3.813 Vali Acc: 0.494 Test Loss: 3.813 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.30765438079834
Epoch: 23, Steps: 13 | Train Loss: 0.024 Vali Loss: 4.191 Vali Acc: 0.489 Test Loss: 4.191 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.108084678649902
Epoch: 24, Steps: 13 | Train Loss: 0.033 Vali Loss: 4.334 Vali Acc: 0.478 Test Loss: 4.334 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.2960522174835205
Epoch: 25, Steps: 13 | Train Loss: 0.033 Vali Loss: 4.250 Vali Acc: 0.472 Test Loss: 4.250 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.12477445602417
Epoch: 26, Steps: 13 | Train Loss: 0.032 Vali Loss: 5.260 Vali Acc: 0.500 Test Loss: 5.260 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 1102210
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.452863454818726
Epoch: 1, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.800 Vali Acc: 0.494 Test Loss: 0.800 Test Acc: 0.494
Validation loss decreased (inf --> -0.494436).  Saving model ...
Epoch: 2 cost time: 4.166173458099365
Epoch: 2, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.947 Vali Acc: 0.450 Test Loss: 0.947 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.47075080871582
Epoch: 3, Steps: 13 | Train Loss: 0.527 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.50108790397644
Epoch: 4, Steps: 13 | Train Loss: 0.429 Vali Loss: 1.186 Vali Acc: 0.456 Test Loss: 1.186 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.072464942932129
Epoch: 5, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.266 Vali Acc: 0.433 Test Loss: 1.266 Test Acc: 0.433
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.4199535846710205
Epoch: 6, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.350 Vali Acc: 0.433 Test Loss: 1.350 Test Acc: 0.433
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.257673025131226
Epoch: 7, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.427 Vali Acc: 0.472 Test Loss: 1.427 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.1961798667907715
Epoch: 8, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.811 Vali Acc: 0.478 Test Loss: 1.811 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.222323894500732
Epoch: 9, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.848 Vali Acc: 0.494 Test Loss: 1.848 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.15106463432312
Epoch: 10, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.890 Vali Acc: 0.461 Test Loss: 1.890 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.9666552543640137
Epoch: 11, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.886 Vali Acc: 0.417 Test Loss: 1.886 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.49444444444444446
model parameter : 1102210
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.411844491958618
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 4.396042823791504
Epoch: 2, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.852 Vali Acc: 0.439 Test Loss: 0.852 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.265134334564209
Epoch: 3, Steps: 13 | Train Loss: 0.470 Vali Loss: 1.069 Vali Acc: 0.494 Test Loss: 1.069 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.082859992980957
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 1.171 Vali Acc: 0.483 Test Loss: 1.171 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.425380229949951
Epoch: 5, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.440 Vali Acc: 0.472 Test Loss: 1.440 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.266804456710815
Epoch: 6, Steps: 13 | Train Loss: 0.234 Vali Loss: 1.394 Vali Acc: 0.506 Test Loss: 1.394 Test Acc: 0.506
Validation loss decreased (-0.499993 --> -0.505542).  Saving model ...
Epoch: 7 cost time: 4.006204605102539
Epoch: 7, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.576 Vali Acc: 0.472 Test Loss: 1.576 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.199970722198486
Epoch: 8, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.797 Vali Acc: 0.472 Test Loss: 1.797 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.232437610626221
Epoch: 9, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.953 Vali Acc: 0.478 Test Loss: 1.953 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.2310709953308105
Epoch: 10, Steps: 13 | Train Loss: 0.205 Vali Loss: 2.229 Vali Acc: 0.472 Test Loss: 2.229 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.082764387130737
Epoch: 11, Steps: 13 | Train Loss: 0.113 Vali Loss: 2.517 Vali Acc: 0.494 Test Loss: 2.517 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.291152715682983
Epoch: 12, Steps: 13 | Train Loss: 0.088 Vali Loss: 3.057 Vali Acc: 0.472 Test Loss: 3.057 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.1248908042907715
Epoch: 13, Steps: 13 | Train Loss: 0.077 Vali Loss: 2.747 Vali Acc: 0.467 Test Loss: 2.747 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.183011293411255
Epoch: 14, Steps: 13 | Train Loss: 0.023 Vali Loss: 2.942 Vali Acc: 0.494 Test Loss: 2.942 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.13976526260376
Epoch: 15, Steps: 13 | Train Loss: 0.080 Vali Loss: 3.948 Vali Acc: 0.483 Test Loss: 3.948 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.13881516456604
Epoch: 16, Steps: 13 | Train Loss: 0.126 Vali Loss: 3.452 Vali Acc: 0.456 Test Loss: 3.452 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5055555555555555
model parameter : 1102210
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.2916154861450195
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.707 Vali Acc: 0.533 Test Loss: 0.707 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 4.0868682861328125
Epoch: 2, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.732 Vali Acc: 0.506 Test Loss: 0.732 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.0261030197143555
Epoch: 3, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.784 Vali Acc: 0.528 Test Loss: 0.784 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7637393474578857
Epoch: 4, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.814 Vali Acc: 0.544 Test Loss: 0.814 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544436).  Saving model ...
Epoch: 5 cost time: 4.183589696884155
Epoch: 5, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.881 Vali Acc: 0.544 Test Loss: 0.881 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.165422677993774
Epoch: 6, Steps: 13 | Train Loss: 0.440 Vali Loss: 1.070 Vali Acc: 0.539 Test Loss: 1.070 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.985564947128296
Epoch: 7, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.067 Vali Acc: 0.556 Test Loss: 1.067 Test Acc: 0.556
Validation loss decreased (-0.544436 --> -0.555545).  Saving model ...
Epoch: 8 cost time: 4.105454921722412
Epoch: 8, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.240 Vali Acc: 0.533 Test Loss: 1.240 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.062901496887207
Epoch: 9, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.610 Vali Acc: 0.544 Test Loss: 1.610 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.1238789558410645
Epoch: 10, Steps: 13 | Train Loss: 0.599 Vali Loss: 1.672 Vali Acc: 0.539 Test Loss: 1.672 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.313431262969971
Epoch: 11, Steps: 13 | Train Loss: 0.288 Vali Loss: 2.111 Vali Acc: 0.506 Test Loss: 2.111 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.1910789012908936
Epoch: 12, Steps: 13 | Train Loss: 0.198 Vali Loss: 2.183 Vali Acc: 0.506 Test Loss: 2.183 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.117997884750366
Epoch: 13, Steps: 13 | Train Loss: 0.167 Vali Loss: 2.397 Vali Acc: 0.511 Test Loss: 2.397 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.201649904251099
Epoch: 14, Steps: 13 | Train Loss: 0.157 Vali Loss: 2.638 Vali Acc: 0.489 Test Loss: 2.638 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.467656373977661
Epoch: 15, Steps: 13 | Train Loss: 0.159 Vali Loss: 2.797 Vali Acc: 0.506 Test Loss: 2.797 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.077905893325806
Epoch: 16, Steps: 13 | Train Loss: 0.107 Vali Loss: 2.901 Vali Acc: 0.494 Test Loss: 2.901 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.8162360191345215
Epoch: 17, Steps: 13 | Train Loss: 0.113 Vali Loss: 3.059 Vali Acc: 0.506 Test Loss: 3.059 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 1102210
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.6789021492004395
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.757 Vali Acc: 0.467 Test Loss: 0.757 Test Acc: 0.467
Validation loss decreased (inf --> -0.466659).  Saving model ...
Epoch: 2 cost time: 4.088821172714233
Epoch: 2, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.859 Vali Acc: 0.511 Test Loss: 0.859 Test Acc: 0.511
Validation loss decreased (-0.466659 --> -0.511103).  Saving model ...
Epoch: 3 cost time: 4.183796405792236
Epoch: 3, Steps: 13 | Train Loss: 0.699 Vali Loss: 1.265 Vali Acc: 0.511 Test Loss: 1.265 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.092405080795288
Epoch: 4, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.803 Vali Acc: 0.511 Test Loss: 0.803 Test Acc: 0.511
Validation loss decreased (-0.511103 --> -0.511103).  Saving model ...
Epoch: 5 cost time: 4.383876085281372
Epoch: 5, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.889 Vali Acc: 0.533 Test Loss: 0.889 Test Acc: 0.533
Validation loss decreased (-0.511103 --> -0.533324).  Saving model ...
Epoch: 6 cost time: 4.517260789871216
Epoch: 6, Steps: 13 | Train Loss: 0.625 Vali Loss: 1.098 Vali Acc: 0.539 Test Loss: 1.098 Test Acc: 0.539
Validation loss decreased (-0.533324 --> -0.538878).  Saving model ...
Epoch: 7 cost time: 4.454937696456909
Epoch: 7, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.868 Vali Acc: 0.533 Test Loss: 0.868 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.152084112167358
Epoch: 8, Steps: 13 | Train Loss: 0.650 Vali Loss: 1.200 Vali Acc: 0.517 Test Loss: 1.200 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.285017013549805
Epoch: 9, Steps: 13 | Train Loss: 0.732 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.458395719528198
Epoch: 10, Steps: 13 | Train Loss: 1.216 Vali Loss: 1.686 Vali Acc: 0.506 Test Loss: 1.686 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.504226922988892
Epoch: 11, Steps: 13 | Train Loss: 0.885 Vali Loss: 1.155 Vali Acc: 0.533 Test Loss: 1.155 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.2969372272491455
Epoch: 12, Steps: 13 | Train Loss: 0.699 Vali Loss: 1.062 Vali Acc: 0.578 Test Loss: 1.062 Test Acc: 0.578
Validation loss decreased (-0.538878 --> -0.577767).  Saving model ...
Epoch: 13 cost time: 4.118581295013428
Epoch: 13, Steps: 13 | Train Loss: 0.642 Vali Loss: 1.141 Vali Acc: 0.522 Test Loss: 1.141 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.277915000915527
Epoch: 14, Steps: 13 | Train Loss: 0.654 Vali Loss: 1.432 Vali Acc: 0.544 Test Loss: 1.432 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.421109914779663
Epoch: 15, Steps: 13 | Train Loss: 0.735 Vali Loss: 1.332 Vali Acc: 0.539 Test Loss: 1.332 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.390530109405518
Epoch: 16, Steps: 13 | Train Loss: 0.510 Vali Loss: 1.196 Vali Acc: 0.522 Test Loss: 1.196 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.532774925231934
Epoch: 17, Steps: 13 | Train Loss: 0.584 Vali Loss: 1.077 Vali Acc: 0.522 Test Loss: 1.077 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.41011381149292
Epoch: 18, Steps: 13 | Train Loss: 0.599 Vali Loss: 1.706 Vali Acc: 0.528 Test Loss: 1.706 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.191702127456665
Epoch: 19, Steps: 13 | Train Loss: 0.748 Vali Loss: 2.093 Vali Acc: 0.517 Test Loss: 2.093 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.2951905727386475
Epoch: 20, Steps: 13 | Train Loss: 0.763 Vali Loss: 1.658 Vali Acc: 0.522 Test Loss: 1.658 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.4254820346832275
Epoch: 21, Steps: 13 | Train Loss: 0.745 Vali Loss: 2.022 Vali Acc: 0.550 Test Loss: 2.022 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.436816453933716
Epoch: 22, Steps: 13 | Train Loss: 0.542 Vali Loss: 1.415 Vali Acc: 0.489 Test Loss: 1.415 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 1102210
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.730182647705078
Epoch: 1, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.693 Vali Acc: 0.556 Test Loss: 0.693 Test Acc: 0.556
Validation loss decreased (inf --> -0.555549).  Saving model ...
Epoch: 2 cost time: 4.69701075553894
Epoch: 2, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.801 Vali Acc: 0.528 Test Loss: 0.801 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.663344621658325
Epoch: 3, Steps: 13 | Train Loss: 0.605 Vali Loss: 1.013 Vali Acc: 0.528 Test Loss: 1.013 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.3278796672821045
Epoch: 4, Steps: 13 | Train Loss: 0.572 Vali Loss: 1.029 Vali Acc: 0.517 Test Loss: 1.029 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.757117986679077
Epoch: 5, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.131 Vali Acc: 0.483 Test Loss: 1.131 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.602806091308594
Epoch: 6, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.435 Vali Acc: 0.483 Test Loss: 1.435 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.403327703475952
Epoch: 7, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.428 Vali Acc: 0.478 Test Loss: 1.428 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.908264398574829
Epoch: 8, Steps: 13 | Train Loss: 0.188 Vali Loss: 1.683 Vali Acc: 0.483 Test Loss: 1.683 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.206308603286743
Epoch: 9, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.948 Vali Acc: 0.494 Test Loss: 1.948 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.113015413284302
Epoch: 10, Steps: 13 | Train Loss: 0.120 Vali Loss: 2.011 Vali Acc: 0.506 Test Loss: 2.011 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.8856422901153564
Epoch: 11, Steps: 13 | Train Loss: 0.086 Vali Loss: 2.357 Vali Acc: 0.478 Test Loss: 2.357 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 708994
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.065354347229004
Epoch: 1, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.698 Vali Acc: 0.567 Test Loss: 0.698 Test Acc: 0.567
Validation loss decreased (inf --> -0.566660).  Saving model ...
Epoch: 2 cost time: 4.2809247970581055
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.816 Vali Acc: 0.544 Test Loss: 0.816 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.482736825942993
Epoch: 3, Steps: 13 | Train Loss: 0.661 Vali Loss: 1.104 Vali Acc: 0.539 Test Loss: 1.104 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.468133211135864
Epoch: 4, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.966 Vali Acc: 0.511 Test Loss: 0.966 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.593841552734375
Epoch: 5, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.111 Vali Acc: 0.456 Test Loss: 1.111 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.545176267623901
Epoch: 6, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.287 Vali Acc: 0.461 Test Loss: 1.287 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.646115303039551
Epoch: 7, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.367 Vali Acc: 0.506 Test Loss: 1.367 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.820569038391113
Epoch: 8, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.828 Vali Acc: 0.517 Test Loss: 1.828 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.183080673217773
Epoch: 9, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.888 Vali Acc: 0.439 Test Loss: 1.888 Test Acc: 0.439
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.467553615570068
Epoch: 10, Steps: 13 | Train Loss: 0.122 Vali Loss: 2.254 Vali Acc: 0.478 Test Loss: 2.254 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.823488473892212
Epoch: 11, Steps: 13 | Train Loss: 0.058 Vali Loss: 2.448 Vali Acc: 0.467 Test Loss: 2.448 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 708994
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.9859020709991455
Epoch: 1, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.708 Vali Acc: 0.550 Test Loss: 0.708 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 4.537324905395508
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.781 Vali Acc: 0.544 Test Loss: 0.781 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.552313566207886
Epoch: 3, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.960 Vali Acc: 0.550 Test Loss: 0.960 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.656293153762817
Epoch: 4, Steps: 13 | Train Loss: 0.607 Vali Loss: 1.174 Vali Acc: 0.533 Test Loss: 1.174 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.490085601806641
Epoch: 5, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.216 Vali Acc: 0.489 Test Loss: 1.216 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.750543117523193
Epoch: 6, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.268 Vali Acc: 0.472 Test Loss: 1.268 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.754413843154907
Epoch: 7, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.389 Vali Acc: 0.500 Test Loss: 1.389 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.54369592666626
Epoch: 8, Steps: 13 | Train Loss: 0.197 Vali Loss: 2.118 Vali Acc: 0.517 Test Loss: 2.118 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.632988691329956
Epoch: 9, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.792 Vali Acc: 0.483 Test Loss: 1.792 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.510767936706543
Epoch: 10, Steps: 13 | Train Loss: 0.077 Vali Loss: 2.177 Vali Acc: 0.494 Test Loss: 2.177 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.745628595352173
Epoch: 11, Steps: 13 | Train Loss: 0.054 Vali Loss: 2.461 Vali Acc: 0.506 Test Loss: 2.461 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 708994
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.956362247467041
Epoch: 1, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.708 Vali Acc: 0.539 Test Loss: 0.708 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 4.3948211669921875
Epoch: 2, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.790 Vali Acc: 0.522 Test Loss: 0.790 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.630397319793701
Epoch: 3, Steps: 13 | Train Loss: 0.543 Vali Loss: 1.069 Vali Acc: 0.522 Test Loss: 1.069 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.7676708698272705
Epoch: 4, Steps: 13 | Train Loss: 0.507 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.353264331817627
Epoch: 5, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.092 Vali Acc: 0.489 Test Loss: 1.092 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.373614311218262
Epoch: 6, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.318214654922485
Epoch: 7, Steps: 13 | Train Loss: 0.200 Vali Loss: 1.389 Vali Acc: 0.472 Test Loss: 1.389 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.290899038314819
Epoch: 8, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.917 Vali Acc: 0.472 Test Loss: 1.917 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.4160685539245605
Epoch: 9, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.858 Vali Acc: 0.467 Test Loss: 1.858 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.465577125549316
Epoch: 10, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.985 Vali Acc: 0.472 Test Loss: 1.985 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.200183391571045
Epoch: 11, Steps: 13 | Train Loss: 0.052 Vali Loss: 2.604 Vali Acc: 0.500 Test Loss: 2.604 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 708994
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.975672483444214
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.703 Vali Acc: 0.522 Test Loss: 0.703 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 4.3800389766693115
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.791 Vali Acc: 0.544 Test Loss: 0.791 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 4.265159368515015
Epoch: 3, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.944 Vali Acc: 0.533 Test Loss: 0.944 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.491556406021118
Epoch: 4, Steps: 13 | Train Loss: 0.543 Vali Loss: 1.262 Vali Acc: 0.494 Test Loss: 1.262 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.215100288391113
Epoch: 5, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.316 Vali Acc: 0.483 Test Loss: 1.316 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.030563831329346
Epoch: 6, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.308 Vali Acc: 0.528 Test Loss: 1.308 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.294563293457031
Epoch: 7, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.442 Vali Acc: 0.539 Test Loss: 1.442 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.3407416343688965
Epoch: 8, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.694 Vali Acc: 0.500 Test Loss: 1.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.299426555633545
Epoch: 9, Steps: 13 | Train Loss: 0.165 Vali Loss: 1.866 Vali Acc: 0.544 Test Loss: 1.866 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.07393741607666
Epoch: 10, Steps: 13 | Train Loss: 0.129 Vali Loss: 2.348 Vali Acc: 0.489 Test Loss: 2.348 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.046778678894043
Epoch: 11, Steps: 13 | Train Loss: 0.086 Vali Loss: 2.251 Vali Acc: 0.528 Test Loss: 2.251 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.987061023712158
Epoch: 12, Steps: 13 | Train Loss: 0.032 Vali Loss: 2.591 Vali Acc: 0.511 Test Loss: 2.591 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 708994
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.1558685302734375
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.738 Vali Acc: 0.544 Test Loss: 0.738 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 3.972832202911377
Epoch: 2, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.784 Vali Acc: 0.494 Test Loss: 0.784 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9848289489746094
Epoch: 3, Steps: 13 | Train Loss: 0.523 Vali Loss: 1.013 Vali Acc: 0.489 Test Loss: 1.013 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.138401031494141
Epoch: 4, Steps: 13 | Train Loss: 0.550 Vali Loss: 1.053 Vali Acc: 0.483 Test Loss: 1.053 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.2838356494903564
Epoch: 5, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.097 Vali Acc: 0.472 Test Loss: 1.097 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.326558828353882
Epoch: 6, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.216 Vali Acc: 0.511 Test Loss: 1.216 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.119838237762451
Epoch: 7, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.404 Vali Acc: 0.517 Test Loss: 1.404 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.162246465682983
Epoch: 8, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.865 Vali Acc: 0.506 Test Loss: 1.865 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.111802816390991
Epoch: 9, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.695 Vali Acc: 0.494 Test Loss: 1.695 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.751804828643799
Epoch: 10, Steps: 13 | Train Loss: 0.051 Vali Loss: 2.062 Vali Acc: 0.511 Test Loss: 2.062 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.641489028930664
Epoch: 11, Steps: 13 | Train Loss: 0.055 Vali Loss: 2.378 Vali Acc: 0.461 Test Loss: 2.378 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 708994
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.2448813915252686
Epoch: 1, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 4.049377202987671
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.929 Vali Acc: 0.494 Test Loss: 0.929 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.775524616241455
Epoch: 3, Steps: 13 | Train Loss: 0.574 Vali Loss: 1.175 Vali Acc: 0.483 Test Loss: 1.175 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.997187614440918
Epoch: 4, Steps: 13 | Train Loss: 0.571 Vali Loss: 1.252 Vali Acc: 0.483 Test Loss: 1.252 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.402273416519165
Epoch: 5, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.278 Vali Acc: 0.450 Test Loss: 1.278 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.383724212646484
Epoch: 6, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.385 Vali Acc: 0.478 Test Loss: 1.385 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.419921159744263
Epoch: 7, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.490 Vali Acc: 0.506 Test Loss: 1.490 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505541).  Saving model ...
Epoch: 8 cost time: 4.19749116897583
Epoch: 8, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.870 Vali Acc: 0.483 Test Loss: 1.870 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.019317150115967
Epoch: 9, Steps: 13 | Train Loss: 0.242 Vali Loss: 1.785 Vali Acc: 0.506 Test Loss: 1.785 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.3672356605529785
Epoch: 10, Steps: 13 | Train Loss: 0.167 Vali Loss: 1.966 Vali Acc: 0.506 Test Loss: 1.966 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.445291757583618
Epoch: 11, Steps: 13 | Train Loss: 0.161 Vali Loss: 2.080 Vali Acc: 0.461 Test Loss: 2.080 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.178751468658447
Epoch: 12, Steps: 13 | Train Loss: 0.095 Vali Loss: 2.240 Vali Acc: 0.506 Test Loss: 2.240 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.413929462432861
Epoch: 13, Steps: 13 | Train Loss: 0.257 Vali Loss: 2.560 Vali Acc: 0.483 Test Loss: 2.560 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.7538115978240967
Epoch: 14, Steps: 13 | Train Loss: 0.219 Vali Loss: 2.674 Vali Acc: 0.456 Test Loss: 2.674 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.9477450847625732
Epoch: 15, Steps: 13 | Train Loss: 0.078 Vali Loss: 2.931 Vali Acc: 0.478 Test Loss: 2.931 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.8067994117736816
Epoch: 16, Steps: 13 | Train Loss: 0.085 Vali Loss: 3.158 Vali Acc: 0.461 Test Loss: 3.158 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.198108196258545
Epoch: 17, Steps: 13 | Train Loss: 0.030 Vali Loss: 3.025 Vali Acc: 0.472 Test Loss: 3.025 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5055555555555555
model parameter : 708994
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.487373352050781
Epoch: 1, Steps: 13 | Train Loss: 0.785 Vali Loss: 0.751 Vali Acc: 0.522 Test Loss: 0.751 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 4.296453237533569
Epoch: 2, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.780 Vali Acc: 0.494 Test Loss: 0.780 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.107526540756226
Epoch: 3, Steps: 13 | Train Loss: 0.508 Vali Loss: 1.123 Vali Acc: 0.472 Test Loss: 1.123 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.407488107681274
Epoch: 4, Steps: 13 | Train Loss: 0.468 Vali Loss: 1.114 Vali Acc: 0.494 Test Loss: 1.114 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.509337902069092
Epoch: 5, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.213 Vali Acc: 0.489 Test Loss: 1.213 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.329610347747803
Epoch: 6, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.479 Vali Acc: 0.494 Test Loss: 1.479 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.475498676300049
Epoch: 7, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.551 Vali Acc: 0.517 Test Loss: 1.551 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.282156944274902
Epoch: 8, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.790 Vali Acc: 0.456 Test Loss: 1.790 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.174458980560303
Epoch: 9, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.960 Vali Acc: 0.467 Test Loss: 1.960 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.199855804443359
Epoch: 10, Steps: 13 | Train Loss: 0.158 Vali Loss: 2.089 Vali Acc: 0.467 Test Loss: 2.089 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.177770376205444
Epoch: 11, Steps: 13 | Train Loss: 0.134 Vali Loss: 2.655 Vali Acc: 0.422 Test Loss: 2.655 Test Acc: 0.422
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 708994
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.798098564147949
Epoch: 1, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 4.230943202972412
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.686 Vali Acc: 0.517 Test Loss: 0.686 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516660).  Saving model ...
Epoch: 3 cost time: 4.204791307449341
Epoch: 3, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.283506155014038
Epoch: 4, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.868 Vali Acc: 0.489 Test Loss: 0.868 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.094868421554565
Epoch: 5, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.792 Vali Acc: 0.539 Test Loss: 0.792 Test Acc: 0.539
Validation loss decreased (-0.516660 --> -0.538881).  Saving model ...
Epoch: 6 cost time: 4.25514554977417
Epoch: 6, Steps: 13 | Train Loss: 0.552 Vali Loss: 1.065 Vali Acc: 0.522 Test Loss: 1.065 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.280193328857422
Epoch: 7, Steps: 13 | Train Loss: 0.474 Vali Loss: 1.134 Vali Acc: 0.550 Test Loss: 1.134 Test Acc: 0.550
Validation loss decreased (-0.538881 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 4.276658296585083
Epoch: 8, Steps: 13 | Train Loss: 0.453 Vali Loss: 1.570 Vali Acc: 0.511 Test Loss: 1.570 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.14680290222168
Epoch: 9, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.177 Vali Acc: 0.511 Test Loss: 1.177 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.180265665054321
Epoch: 10, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.733 Vali Acc: 0.533 Test Loss: 1.733 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.035330772399902
Epoch: 11, Steps: 13 | Train Loss: 0.402 Vali Loss: 1.665 Vali Acc: 0.483 Test Loss: 1.665 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9572508335113525
Epoch: 12, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.892 Vali Acc: 0.550 Test Loss: 1.892 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.074982643127441
Epoch: 13, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.981 Vali Acc: 0.550 Test Loss: 1.981 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.980231285095215
Epoch: 14, Steps: 13 | Train Loss: 0.322 Vali Loss: 2.914 Vali Acc: 0.511 Test Loss: 2.914 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.178591728210449
Epoch: 15, Steps: 13 | Train Loss: 0.319 Vali Loss: 2.379 Vali Acc: 0.517 Test Loss: 2.379 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.0697972774505615
Epoch: 16, Steps: 13 | Train Loss: 0.214 Vali Loss: 2.616 Vali Acc: 0.528 Test Loss: 2.616 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.106337308883667
Epoch: 17, Steps: 13 | Train Loss: 0.307 Vali Loss: 2.851 Vali Acc: 0.561 Test Loss: 2.851 Test Acc: 0.561
Validation loss decreased (-0.549989 --> -0.561083).  Saving model ...
Epoch: 18 cost time: 4.666054725646973
Epoch: 18, Steps: 13 | Train Loss: 0.088 Vali Loss: 3.200 Vali Acc: 0.506 Test Loss: 3.200 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.673784494400024
Epoch: 19, Steps: 13 | Train Loss: 0.125 Vali Loss: 3.276 Vali Acc: 0.544 Test Loss: 3.276 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.377303600311279
Epoch: 20, Steps: 13 | Train Loss: 0.130 Vali Loss: 3.317 Vali Acc: 0.550 Test Loss: 3.317 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.420687913894653
Epoch: 21, Steps: 13 | Train Loss: 0.087 Vali Loss: 3.528 Vali Acc: 0.539 Test Loss: 3.528 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.4362571239471436
Epoch: 22, Steps: 13 | Train Loss: 0.103 Vali Loss: 3.697 Vali Acc: 0.550 Test Loss: 3.697 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.343644380569458
Epoch: 23, Steps: 13 | Train Loss: 0.096 Vali Loss: 3.739 Vali Acc: 0.567 Test Loss: 3.739 Test Acc: 0.567
Validation loss decreased (-0.561083 --> -0.566629).  Saving model ...
Epoch: 24 cost time: 4.4951701164245605
Epoch: 24, Steps: 13 | Train Loss: 0.038 Vali Loss: 4.229 Vali Acc: 0.522 Test Loss: 4.229 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.119783401489258
Epoch: 25, Steps: 13 | Train Loss: 0.214 Vali Loss: 4.035 Vali Acc: 0.544 Test Loss: 4.035 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.253777742385864
Epoch: 26, Steps: 13 | Train Loss: 0.116 Vali Loss: 4.588 Vali Acc: 0.517 Test Loss: 4.588 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.420487642288208
Epoch: 27, Steps: 13 | Train Loss: 0.078 Vali Loss: 4.499 Vali Acc: 0.539 Test Loss: 4.499 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.239156007766724
Epoch: 28, Steps: 13 | Train Loss: 0.037 Vali Loss: 4.441 Vali Acc: 0.533 Test Loss: 4.441 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.332558870315552
Epoch: 29, Steps: 13 | Train Loss: 0.063 Vali Loss: 4.611 Vali Acc: 0.533 Test Loss: 4.611 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.439811706542969
Epoch: 30, Steps: 13 | Train Loss: 0.085 Vali Loss: 4.486 Vali Acc: 0.567 Test Loss: 4.486 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.5371129512786865
Epoch: 31, Steps: 13 | Train Loss: 0.171 Vali Loss: 5.766 Vali Acc: 0.544 Test Loss: 5.766 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.480569124221802
Epoch: 32, Steps: 13 | Train Loss: 0.199 Vali Loss: 5.919 Vali Acc: 0.539 Test Loss: 5.919 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.820996522903442
Epoch: 33, Steps: 13 | Train Loss: 0.142 Vali Loss: 5.677 Vali Acc: 0.533 Test Loss: 5.677 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 708994
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.620584964752197
Epoch: 1, Steps: 13 | Train Loss: 0.772 Vali Loss: 0.747 Vali Acc: 0.528 Test Loss: 0.747 Test Acc: 0.528
Validation loss decreased (inf --> -0.527770).  Saving model ...
Epoch: 2 cost time: 4.326887607574463
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.1021223068237305
Epoch: 3, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.792 Vali Acc: 0.561 Test Loss: 0.792 Test Acc: 0.561
Validation loss decreased (-0.527770 --> -0.561103).  Saving model ...
Epoch: 4 cost time: 4.419569253921509
Epoch: 4, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.934 Vali Acc: 0.517 Test Loss: 0.934 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.278748273849487
Epoch: 5, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.946 Vali Acc: 0.533 Test Loss: 0.946 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.119795322418213
Epoch: 6, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.974 Vali Acc: 0.522 Test Loss: 0.974 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9116578102111816
Epoch: 7, Steps: 13 | Train Loss: 0.672 Vali Loss: 1.463 Vali Acc: 0.511 Test Loss: 1.463 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.229684591293335
Epoch: 8, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.876 Vali Acc: 0.522 Test Loss: 0.876 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.781385898590088
Epoch: 9, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.957 Vali Acc: 0.500 Test Loss: 0.957 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.9791486263275146
Epoch: 10, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.879 Vali Acc: 0.572 Test Loss: 0.879 Test Acc: 0.572
Validation loss decreased (-0.561103 --> -0.572213).  Saving model ...
Epoch: 11 cost time: 4.510339021682739
Epoch: 11, Steps: 13 | Train Loss: 0.603 Vali Loss: 1.249 Vali Acc: 0.511 Test Loss: 1.249 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.063982248306274
Epoch: 12, Steps: 13 | Train Loss: 0.601 Vali Loss: 1.207 Vali Acc: 0.544 Test Loss: 1.207 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.6954193115234375
Epoch: 13, Steps: 13 | Train Loss: 0.600 Vali Loss: 1.114 Vali Acc: 0.550 Test Loss: 1.114 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.093315839767456
Epoch: 14, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.947 Vali Acc: 0.494 Test Loss: 0.947 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.268348455429077
Epoch: 15, Steps: 13 | Train Loss: 0.572 Vali Loss: 1.762 Vali Acc: 0.544 Test Loss: 1.762 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.521181344985962
Epoch: 16, Steps: 13 | Train Loss: 0.639 Vali Loss: 1.394 Vali Acc: 0.556 Test Loss: 1.394 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.683677434921265
Epoch: 17, Steps: 13 | Train Loss: 0.586 Vali Loss: 1.923 Vali Acc: 0.522 Test Loss: 1.923 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.275184392929077
Epoch: 18, Steps: 13 | Train Loss: 0.614 Vali Loss: 1.361 Vali Acc: 0.572 Test Loss: 1.361 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.8899688720703125
Epoch: 19, Steps: 13 | Train Loss: 0.533 Vali Loss: 1.149 Vali Acc: 0.517 Test Loss: 1.149 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.0471556186676025
Epoch: 20, Steps: 13 | Train Loss: 0.491 Vali Loss: 1.152 Vali Acc: 0.567 Test Loss: 1.152 Test Acc: 0.567
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 708994
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.942865371704102
Epoch: 1, Steps: 13 | Train Loss: 0.802 Vali Loss: 0.711 Vali Acc: 0.522 Test Loss: 0.711 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 4.746912717819214
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.199492454528809
Epoch: 3, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.862 Vali Acc: 0.500 Test Loss: 0.862 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.125759840011597
Epoch: 4, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.991 Vali Acc: 0.472 Test Loss: 0.991 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.093939542770386
Epoch: 5, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.262 Vali Acc: 0.522 Test Loss: 1.262 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.298365592956543
Epoch: 6, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.272 Vali Acc: 0.506 Test Loss: 1.272 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.898983716964722
Epoch: 7, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.809 Vali Acc: 0.544 Test Loss: 1.809 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544426).  Saving model ...
Epoch: 8 cost time: 5.002535820007324
Epoch: 8, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.525 Vali Acc: 0.483 Test Loss: 1.525 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.337534666061401
Epoch: 9, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.846 Vali Acc: 0.444 Test Loss: 1.846 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.958352565765381
Epoch: 10, Steps: 13 | Train Loss: 0.161 Vali Loss: 1.983 Vali Acc: 0.472 Test Loss: 1.983 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.951223850250244
Epoch: 11, Steps: 13 | Train Loss: 0.072 Vali Loss: 2.264 Vali Acc: 0.500 Test Loss: 2.264 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.967637777328491
Epoch: 12, Steps: 13 | Train Loss: 0.054 Vali Loss: 2.571 Vali Acc: 0.511 Test Loss: 2.571 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.0100202560424805
Epoch: 13, Steps: 13 | Train Loss: 0.100 Vali Loss: 2.711 Vali Acc: 0.483 Test Loss: 2.711 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.331171274185181
Epoch: 14, Steps: 13 | Train Loss: 0.070 Vali Loss: 2.905 Vali Acc: 0.494 Test Loss: 2.905 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.176635026931763
Epoch: 15, Steps: 13 | Train Loss: 0.112 Vali Loss: 3.615 Vali Acc: 0.478 Test Loss: 3.615 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.28961968421936
Epoch: 16, Steps: 13 | Train Loss: 0.044 Vali Loss: 3.506 Vali Acc: 0.483 Test Loss: 3.506 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.263060092926025
Epoch: 17, Steps: 13 | Train Loss: 0.014 Vali Loss: 3.445 Vali Acc: 0.456 Test Loss: 3.445 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 512386
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.229549169540405
Epoch: 1, Steps: 13 | Train Loss: 0.791 Vali Loss: 0.726 Vali Acc: 0.517 Test Loss: 0.726 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 4.7855446338653564
Epoch: 2, Steps: 13 | Train Loss: 0.719 Vali Loss: 1.020 Vali Acc: 0.539 Test Loss: 1.020 Test Acc: 0.539
Validation loss decreased (-0.516659 --> -0.538879).  Saving model ...
Epoch: 3 cost time: 4.966549396514893
Epoch: 3, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.939 Vali Acc: 0.506 Test Loss: 0.939 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.0006561279296875
Epoch: 4, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.989 Vali Acc: 0.500 Test Loss: 0.989 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.005423545837402
Epoch: 5, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.445 Vali Acc: 0.489 Test Loss: 1.445 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.878558158874512
Epoch: 6, Steps: 13 | Train Loss: 0.464 Vali Loss: 1.932 Vali Acc: 0.511 Test Loss: 1.932 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.756868124008179
Epoch: 7, Steps: 13 | Train Loss: 0.430 Vali Loss: 1.563 Vali Acc: 0.506 Test Loss: 1.563 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.822251796722412
Epoch: 8, Steps: 13 | Train Loss: 0.196 Vali Loss: 1.606 Vali Acc: 0.483 Test Loss: 1.606 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.084429979324341
Epoch: 9, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.859 Vali Acc: 0.483 Test Loss: 1.859 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.155802488327026
Epoch: 10, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.903 Vali Acc: 0.517 Test Loss: 1.903 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.67457127571106
Epoch: 11, Steps: 13 | Train Loss: 0.100 Vali Loss: 2.113 Vali Acc: 0.483 Test Loss: 2.113 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.782928943634033
Epoch: 12, Steps: 13 | Train Loss: 0.035 Vali Loss: 2.443 Vali Acc: 0.500 Test Loss: 2.443 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 512386
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.3827996253967285
Epoch: 1, Steps: 13 | Train Loss: 0.790 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 4.356341361999512
Epoch: 2, Steps: 13 | Train Loss: 0.736 Vali Loss: 1.001 Vali Acc: 0.539 Test Loss: 1.001 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.107450485229492
Epoch: 3, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.861 Vali Acc: 0.478 Test Loss: 0.861 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.141980886459351
Epoch: 4, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.979 Vali Acc: 0.478 Test Loss: 0.979 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.086963415145874
Epoch: 5, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.161 Vali Acc: 0.506 Test Loss: 1.161 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.011712551116943
Epoch: 6, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.017292022705078
Epoch: 7, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.444 Vali Acc: 0.517 Test Loss: 1.444 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.962830066680908
Epoch: 8, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.569 Vali Acc: 0.500 Test Loss: 1.569 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.120278835296631
Epoch: 9, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.799 Vali Acc: 0.489 Test Loss: 1.799 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.255285263061523
Epoch: 10, Steps: 13 | Train Loss: 0.076 Vali Loss: 2.027 Vali Acc: 0.461 Test Loss: 2.027 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.5206382274627686
Epoch: 11, Steps: 13 | Train Loss: 0.053 Vali Loss: 2.141 Vali Acc: 0.500 Test Loss: 2.141 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 512386
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.446548938751221
Epoch: 1, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.750 Vali Acc: 0.494 Test Loss: 0.750 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 3.9983022212982178
Epoch: 2, Steps: 13 | Train Loss: 0.706 Vali Loss: 1.011 Vali Acc: 0.522 Test Loss: 1.011 Test Acc: 0.522
Validation loss decreased (-0.494437 --> -0.522212).  Saving model ...
Epoch: 3 cost time: 3.8062329292297363
Epoch: 3, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.962 Vali Acc: 0.511 Test Loss: 0.962 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.275772571563721
Epoch: 4, Steps: 13 | Train Loss: 0.414 Vali Loss: 1.038 Vali Acc: 0.506 Test Loss: 1.038 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.084603548049927
Epoch: 5, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.162 Vali Acc: 0.478 Test Loss: 1.162 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.9586915969848633
Epoch: 6, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.980757236480713
Epoch: 7, Steps: 13 | Train Loss: 0.260 Vali Loss: 2.095 Vali Acc: 0.528 Test Loss: 2.095 Test Acc: 0.528
Validation loss decreased (-0.522212 --> -0.527757).  Saving model ...
Epoch: 8 cost time: 3.991236925125122
Epoch: 8, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.474 Vali Acc: 0.528 Test Loss: 1.474 Test Acc: 0.528
Validation loss decreased (-0.527757 --> -0.527763).  Saving model ...
Epoch: 9 cost time: 3.948096752166748
Epoch: 9, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.756 Vali Acc: 0.472 Test Loss: 1.756 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.1804890632629395
Epoch: 10, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.895 Vali Acc: 0.489 Test Loss: 1.895 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.094603061676025
Epoch: 11, Steps: 13 | Train Loss: 0.104 Vali Loss: 2.075 Vali Acc: 0.517 Test Loss: 2.075 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.113048791885376
Epoch: 12, Steps: 13 | Train Loss: 0.042 Vali Loss: 2.291 Vali Acc: 0.500 Test Loss: 2.291 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.146509885787964
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.514 Vali Acc: 0.494 Test Loss: 2.514 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.330617427825928
Epoch: 14, Steps: 13 | Train Loss: 0.076 Vali Loss: 2.794 Vali Acc: 0.444 Test Loss: 2.794 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.493421792984009
Epoch: 15, Steps: 13 | Train Loss: 0.067 Vali Loss: 3.398 Vali Acc: 0.489 Test Loss: 3.398 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.152697324752808
Epoch: 16, Steps: 13 | Train Loss: 0.076 Vali Loss: 4.275 Vali Acc: 0.506 Test Loss: 4.275 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.104632377624512
Epoch: 17, Steps: 13 | Train Loss: 0.132 Vali Loss: 3.684 Vali Acc: 0.500 Test Loss: 3.684 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.254196405410767
Epoch: 18, Steps: 13 | Train Loss: 0.059 Vali Loss: 3.464 Vali Acc: 0.461 Test Loss: 3.464 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 512386
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.46552848815918
Epoch: 1, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.729 Vali Acc: 0.528 Test Loss: 0.729 Test Acc: 0.528
Validation loss decreased (inf --> -0.527770).  Saving model ...
Epoch: 2 cost time: 4.3120503425598145
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.527770 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 3.982030153274536
Epoch: 3, Steps: 13 | Train Loss: 0.638 Vali Loss: 1.153 Vali Acc: 0.522 Test Loss: 1.153 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.597421169281006
Epoch: 4, Steps: 13 | Train Loss: 0.423 Vali Loss: 1.043 Vali Acc: 0.472 Test Loss: 1.043 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.520298957824707
Epoch: 5, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.392 Vali Acc: 0.500 Test Loss: 1.392 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.53833794593811
Epoch: 6, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.355 Vali Acc: 0.561 Test Loss: 1.355 Test Acc: 0.561
Validation loss decreased (-0.533323 --> -0.561098).  Saving model ...
Epoch: 7 cost time: 4.2127845287323
Epoch: 7, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.494 Vali Acc: 0.500 Test Loss: 1.494 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.228586912155151
Epoch: 8, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.608 Vali Acc: 0.522 Test Loss: 1.608 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.382372140884399
Epoch: 9, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.839 Vali Acc: 0.522 Test Loss: 1.839 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.236555814743042
Epoch: 10, Steps: 13 | Train Loss: 0.048 Vali Loss: 2.120 Vali Acc: 0.517 Test Loss: 2.120 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.313430070877075
Epoch: 11, Steps: 13 | Train Loss: 0.071 Vali Loss: 2.498 Vali Acc: 0.478 Test Loss: 2.498 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.547787427902222
Epoch: 12, Steps: 13 | Train Loss: 0.042 Vali Loss: 2.575 Vali Acc: 0.489 Test Loss: 2.575 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.345285654067993
Epoch: 13, Steps: 13 | Train Loss: 0.038 Vali Loss: 2.560 Vali Acc: 0.511 Test Loss: 2.560 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.89321231842041
Epoch: 14, Steps: 13 | Train Loss: 0.013 Vali Loss: 2.799 Vali Acc: 0.494 Test Loss: 2.799 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.272858142852783
Epoch: 15, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.896 Vali Acc: 0.506 Test Loss: 2.896 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.358008623123169
Epoch: 16, Steps: 13 | Train Loss: 0.006 Vali Loss: 3.028 Vali Acc: 0.506 Test Loss: 3.028 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 512386
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.780988454818726
Epoch: 1, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.757 Vali Acc: 0.456 Test Loss: 0.757 Test Acc: 0.456
Validation loss decreased (inf --> -0.455548).  Saving model ...
Epoch: 2 cost time: 4.660824298858643
Epoch: 2, Steps: 13 | Train Loss: 0.725 Vali Loss: 1.098 Vali Acc: 0.511 Test Loss: 1.098 Test Acc: 0.511
Validation loss decreased (-0.455548 --> -0.511100).  Saving model ...
Epoch: 3 cost time: 4.649251222610474
Epoch: 3, Steps: 13 | Train Loss: 0.651 Vali Loss: 1.191 Vali Acc: 0.517 Test Loss: 1.191 Test Acc: 0.517
Validation loss decreased (-0.511100 --> -0.516655).  Saving model ...
Epoch: 4 cost time: 4.277104616165161
Epoch: 4, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.947 Vali Acc: 0.522 Test Loss: 0.947 Test Acc: 0.522
Validation loss decreased (-0.516655 --> -0.522213).  Saving model ...
Epoch: 5 cost time: 4.589783668518066
Epoch: 5, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.096 Vali Acc: 0.511 Test Loss: 1.096 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.301556587219238
Epoch: 6, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.531 Vali Acc: 0.500 Test Loss: 1.531 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9406068325042725
Epoch: 7, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.551 Vali Acc: 0.478 Test Loss: 1.551 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.858330488204956
Epoch: 8, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.507 Vali Acc: 0.533 Test Loss: 1.507 Test Acc: 0.533
Validation loss decreased (-0.522213 --> -0.533318).  Saving model ...
Epoch: 9 cost time: 4.373214960098267
Epoch: 9, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.689 Vali Acc: 0.517 Test Loss: 1.689 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.0471720695495605
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.838 Vali Acc: 0.544 Test Loss: 1.838 Test Acc: 0.544
Validation loss decreased (-0.533318 --> -0.544426).  Saving model ...
Epoch: 11 cost time: 4.512070417404175
Epoch: 11, Steps: 13 | Train Loss: 0.094 Vali Loss: 2.275 Vali Acc: 0.489 Test Loss: 2.275 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.729809284210205
Epoch: 12, Steps: 13 | Train Loss: 0.042 Vali Loss: 2.392 Vali Acc: 0.511 Test Loss: 2.392 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.170998811721802
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 2.380 Vali Acc: 0.544 Test Loss: 2.380 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.328444957733154
Epoch: 14, Steps: 13 | Train Loss: 0.017 Vali Loss: 2.554 Vali Acc: 0.511 Test Loss: 2.554 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.488744258880615
Epoch: 15, Steps: 13 | Train Loss: 0.021 Vali Loss: 2.806 Vali Acc: 0.500 Test Loss: 2.806 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.5150086879730225
Epoch: 16, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.840 Vali Acc: 0.528 Test Loss: 2.840 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.250733375549316
Epoch: 17, Steps: 13 | Train Loss: 0.068 Vali Loss: 3.129 Vali Acc: 0.522 Test Loss: 3.129 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.200244426727295
Epoch: 18, Steps: 13 | Train Loss: 0.011 Vali Loss: 3.127 Vali Acc: 0.572 Test Loss: 3.127 Test Acc: 0.572
Validation loss decreased (-0.544426 --> -0.572191).  Saving model ...
Epoch: 19 cost time: 4.2460103034973145
Epoch: 19, Steps: 13 | Train Loss: 0.035 Vali Loss: 3.306 Vali Acc: 0.556 Test Loss: 3.306 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.281249761581421
Epoch: 20, Steps: 13 | Train Loss: 0.012 Vali Loss: 3.353 Vali Acc: 0.500 Test Loss: 3.353 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.102027654647827
Epoch: 21, Steps: 13 | Train Loss: 0.013 Vali Loss: 3.587 Vali Acc: 0.544 Test Loss: 3.587 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.9498348236083984
Epoch: 22, Steps: 13 | Train Loss: 0.005 Vali Loss: 3.624 Vali Acc: 0.517 Test Loss: 3.624 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.459790945053101
Epoch: 23, Steps: 13 | Train Loss: 0.009 Vali Loss: 3.706 Vali Acc: 0.517 Test Loss: 3.706 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.230407238006592
Epoch: 24, Steps: 13 | Train Loss: 0.003 Vali Loss: 3.778 Vali Acc: 0.522 Test Loss: 3.778 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.913149118423462
Epoch: 25, Steps: 13 | Train Loss: 0.002 Vali Loss: 4.029 Vali Acc: 0.511 Test Loss: 4.029 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.9617245197296143
Epoch: 26, Steps: 13 | Train Loss: 0.005 Vali Loss: 4.048 Vali Acc: 0.494 Test Loss: 4.048 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.892519474029541
Epoch: 27, Steps: 13 | Train Loss: 0.006 Vali Loss: 4.239 Vali Acc: 0.489 Test Loss: 4.239 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.773474216461182
Epoch: 28, Steps: 13 | Train Loss: 0.012 Vali Loss: 4.362 Vali Acc: 0.483 Test Loss: 4.362 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 512386
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.262037754058838
Epoch: 1, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 4.075267791748047
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 1.076 Vali Acc: 0.506 Test Loss: 1.076 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505545).  Saving model ...
Epoch: 3 cost time: 4.058570861816406
Epoch: 3, Steps: 13 | Train Loss: 0.678 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7842321395874023
Epoch: 4, Steps: 13 | Train Loss: 0.496 Vali Loss: 1.198 Vali Acc: 0.478 Test Loss: 1.198 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.825143814086914
Epoch: 5, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.295 Vali Acc: 0.456 Test Loss: 1.295 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.66802716255188
Epoch: 6, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.584 Vali Acc: 0.489 Test Loss: 1.584 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.006223201751709
Epoch: 7, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.522 Vali Acc: 0.478 Test Loss: 1.522 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.6686630249023438
Epoch: 8, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.442 Vali Acc: 0.450 Test Loss: 1.442 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.832155704498291
Epoch: 9, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.608 Vali Acc: 0.494 Test Loss: 1.608 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.77085018157959
Epoch: 10, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.901 Vali Acc: 0.500 Test Loss: 1.901 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.067425489425659
Epoch: 11, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.841 Vali Acc: 0.467 Test Loss: 1.841 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.213244676589966
Epoch: 12, Steps: 13 | Train Loss: 0.148 Vali Loss: 2.100 Vali Acc: 0.483 Test Loss: 2.100 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5055555555555555
model parameter : 512386
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.074093341827393
Epoch: 1, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.762 Vali Acc: 0.467 Test Loss: 0.762 Test Acc: 0.467
Validation loss decreased (inf --> -0.466659).  Saving model ...
Epoch: 2 cost time: 4.466133117675781
Epoch: 2, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.976 Vali Acc: 0.517 Test Loss: 0.976 Test Acc: 0.517
Validation loss decreased (-0.466659 --> -0.516657).  Saving model ...
Epoch: 3 cost time: 4.462651014328003
Epoch: 3, Steps: 13 | Train Loss: 0.618 Vali Loss: 1.133 Vali Acc: 0.539 Test Loss: 1.133 Test Acc: 0.539
Validation loss decreased (-0.516657 --> -0.538878).  Saving model ...
Epoch: 4 cost time: 4.6161415576934814
Epoch: 4, Steps: 13 | Train Loss: 0.424 Vali Loss: 1.066 Vali Acc: 0.478 Test Loss: 1.066 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.424547910690308
Epoch: 5, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.385 Vali Acc: 0.511 Test Loss: 1.385 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.106721878051758
Epoch: 6, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.936 Vali Acc: 0.511 Test Loss: 1.936 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.388202667236328
Epoch: 7, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.567 Vali Acc: 0.456 Test Loss: 1.567 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.0493104457855225
Epoch: 8, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.692 Vali Acc: 0.522 Test Loss: 1.692 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.4347522258758545
Epoch: 9, Steps: 13 | Train Loss: 0.234 Vali Loss: 1.863 Vali Acc: 0.478 Test Loss: 1.863 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.3492043018341064
Epoch: 10, Steps: 13 | Train Loss: 0.126 Vali Loss: 2.087 Vali Acc: 0.461 Test Loss: 2.087 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.4730799198150635
Epoch: 11, Steps: 13 | Train Loss: 0.128 Vali Loss: 2.324 Vali Acc: 0.461 Test Loss: 2.324 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.3291847705841064
Epoch: 12, Steps: 13 | Train Loss: 0.077 Vali Loss: 2.522 Vali Acc: 0.467 Test Loss: 2.522 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.207980155944824
Epoch: 13, Steps: 13 | Train Loss: 0.085 Vali Loss: 2.738 Vali Acc: 0.528 Test Loss: 2.738 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 512386
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.3277881145477295
Epoch: 1, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.713 Vali Acc: 0.494 Test Loss: 0.713 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 4.174867868423462
Epoch: 2, Steps: 13 | Train Loss: 0.791 Vali Loss: 0.730 Vali Acc: 0.522 Test Loss: 0.730 Test Acc: 0.522
Validation loss decreased (-0.494437 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 4.193475723266602
Epoch: 3, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.751 Vali Acc: 0.539 Test Loss: 0.751 Test Acc: 0.539
Validation loss decreased (-0.522215 --> -0.538881).  Saving model ...
Epoch: 4 cost time: 4.0685107707977295
Epoch: 4, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.775 Vali Acc: 0.506 Test Loss: 0.775 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.299530744552612
Epoch: 5, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.769 Vali Acc: 0.544 Test Loss: 0.769 Test Acc: 0.544
Validation loss decreased (-0.538881 --> -0.544437).  Saving model ...
Epoch: 6 cost time: 3.7852578163146973
Epoch: 6, Steps: 13 | Train Loss: 0.607 Vali Loss: 1.281 Vali Acc: 0.506 Test Loss: 1.281 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.766972064971924
Epoch: 7, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.889 Vali Acc: 0.578 Test Loss: 0.889 Test Acc: 0.578
Validation loss decreased (-0.544437 --> -0.577769).  Saving model ...
Epoch: 8 cost time: 3.7710306644439697
Epoch: 8, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.975 Vali Acc: 0.556 Test Loss: 0.975 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.014309644699097
Epoch: 9, Steps: 13 | Train Loss: 0.425 Vali Loss: 1.290 Vali Acc: 0.539 Test Loss: 1.290 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.295317888259888
Epoch: 10, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.318 Vali Acc: 0.533 Test Loss: 1.318 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.861060380935669
Epoch: 11, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.335 Vali Acc: 0.522 Test Loss: 1.335 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.899604082107544
Epoch: 12, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.600 Vali Acc: 0.539 Test Loss: 1.600 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.006838798522949
Epoch: 13, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.716 Vali Acc: 0.533 Test Loss: 1.716 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.117706060409546
Epoch: 14, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.878 Vali Acc: 0.550 Test Loss: 1.878 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.387621641159058
Epoch: 15, Steps: 13 | Train Loss: 0.184 Vali Loss: 2.141 Vali Acc: 0.522 Test Loss: 2.141 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.129225492477417
Epoch: 16, Steps: 13 | Train Loss: 0.126 Vali Loss: 2.246 Vali Acc: 0.539 Test Loss: 2.246 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.501363039016724
Epoch: 17, Steps: 13 | Train Loss: 0.152 Vali Loss: 2.493 Vali Acc: 0.550 Test Loss: 2.493 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 512386
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.426957845687866
Epoch: 1, Steps: 13 | Train Loss: 0.783 Vali Loss: 0.709 Vali Acc: 0.528 Test Loss: 0.709 Test Acc: 0.528
Validation loss decreased (inf --> -0.527771).  Saving model ...
Epoch: 2 cost time: 4.078394412994385
Epoch: 2, Steps: 13 | Train Loss: 0.833 Vali Loss: 0.810 Vali Acc: 0.500 Test Loss: 0.810 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.0991291999816895
Epoch: 3, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.755 Vali Acc: 0.544 Test Loss: 0.755 Test Acc: 0.544
Validation loss decreased (-0.527771 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 4.044947385787964
Epoch: 4, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.792 Vali Acc: 0.533 Test Loss: 0.792 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.262723684310913
Epoch: 5, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.787 Vali Acc: 0.528 Test Loss: 0.787 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9223949909210205
Epoch: 6, Steps: 13 | Train Loss: 0.698 Vali Loss: 1.239 Vali Acc: 0.494 Test Loss: 1.239 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.111006498336792
Epoch: 7, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.904 Vali Acc: 0.556 Test Loss: 0.904 Test Acc: 0.556
Validation loss decreased (-0.544437 --> -0.555547).  Saving model ...
Epoch: 8 cost time: 4.231539964675903
Epoch: 8, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.982 Vali Acc: 0.500 Test Loss: 0.982 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.331892251968384
Epoch: 9, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.878 Vali Acc: 0.578 Test Loss: 0.878 Test Acc: 0.578
Validation loss decreased (-0.555547 --> -0.577769).  Saving model ...
Epoch: 10 cost time: 4.361294746398926
Epoch: 10, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.988 Vali Acc: 0.500 Test Loss: 0.988 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.324544906616211
Epoch: 11, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.932 Vali Acc: 0.483 Test Loss: 0.932 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.352897882461548
Epoch: 12, Steps: 13 | Train Loss: 0.579 Vali Loss: 1.072 Vali Acc: 0.544 Test Loss: 1.072 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.542215824127197
Epoch: 13, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.947 Vali Acc: 0.533 Test Loss: 0.947 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.329117059707642
Epoch: 14, Steps: 13 | Train Loss: 0.598 Vali Loss: 1.075 Vali Acc: 0.517 Test Loss: 1.075 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.305688381195068
Epoch: 15, Steps: 13 | Train Loss: 0.578 Vali Loss: 1.272 Vali Acc: 0.533 Test Loss: 1.272 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.216699600219727
Epoch: 16, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.345 Vali Acc: 0.550 Test Loss: 1.345 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.152112722396851
Epoch: 17, Steps: 13 | Train Loss: 0.496 Vali Loss: 1.080 Vali Acc: 0.572 Test Loss: 1.080 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.1200714111328125
Epoch: 18, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.191 Vali Acc: 0.517 Test Loss: 1.191 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.2486255168914795
Epoch: 19, Steps: 13 | Train Loss: 0.454 Vali Loss: 1.288 Vali Acc: 0.494 Test Loss: 1.288 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 512386
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.6944804191589355
Epoch: 1, Steps: 13 | Train Loss: 0.806 Vali Loss: 0.731 Vali Acc: 0.522 Test Loss: 0.731 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 4.592028617858887
Epoch: 2, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.671739816665649
Epoch: 3, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.945 Vali Acc: 0.550 Test Loss: 0.945 Test Acc: 0.550
Validation loss decreased (-0.522215 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 4.659637212753296
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.194 Vali Acc: 0.544 Test Loss: 1.194 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.999756574630737
Epoch: 5, Steps: 13 | Train Loss: 0.385 Vali Loss: 1.218 Vali Acc: 0.494 Test Loss: 1.218 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.754087209701538
Epoch: 6, Steps: 13 | Train Loss: 0.252 Vali Loss: 1.346 Vali Acc: 0.478 Test Loss: 1.346 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.598981857299805
Epoch: 7, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.397 Vali Acc: 0.489 Test Loss: 1.397 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.673962831497192
Epoch: 8, Steps: 13 | Train Loss: 0.169 Vali Loss: 1.597 Vali Acc: 0.511 Test Loss: 1.597 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.3231236934661865
Epoch: 9, Steps: 13 | Train Loss: 0.129 Vali Loss: 2.226 Vali Acc: 0.489 Test Loss: 2.226 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.450090169906616
Epoch: 10, Steps: 13 | Train Loss: 0.144 Vali Loss: 2.185 Vali Acc: 0.489 Test Loss: 2.185 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.273361444473267
Epoch: 11, Steps: 13 | Train Loss: 0.054 Vali Loss: 2.085 Vali Acc: 0.511 Test Loss: 2.085 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.705729007720947
Epoch: 12, Steps: 13 | Train Loss: 0.032 Vali Loss: 2.209 Vali Acc: 0.456 Test Loss: 2.209 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.599725008010864
Epoch: 13, Steps: 13 | Train Loss: 0.062 Vali Loss: 2.889 Vali Acc: 0.517 Test Loss: 2.889 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 414082
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.829312086105347
Epoch: 1, Steps: 13 | Train Loss: 0.811 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 4.625246286392212
Epoch: 2, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.774 Vali Acc: 0.483 Test Loss: 0.774 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.7823145389556885
Epoch: 3, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.930 Vali Acc: 0.506 Test Loss: 0.930 Test Acc: 0.506
Validation loss decreased (-0.499993 --> -0.505546).  Saving model ...
Epoch: 4 cost time: 4.651970624923706
Epoch: 4, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.269 Vali Acc: 0.556 Test Loss: 1.269 Test Acc: 0.556
Validation loss decreased (-0.505546 --> -0.555543).  Saving model ...
Epoch: 5 cost time: 4.8603575229644775
Epoch: 5, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.265 Vali Acc: 0.533 Test Loss: 1.265 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.722500324249268
Epoch: 6, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.345 Vali Acc: 0.467 Test Loss: 1.345 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.5577757358551025
Epoch: 7, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.374 Vali Acc: 0.511 Test Loss: 1.374 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.5280468463897705
Epoch: 8, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.714 Vali Acc: 0.544 Test Loss: 1.714 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.936702013015747
Epoch: 9, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.764 Vali Acc: 0.478 Test Loss: 1.764 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.216551303863525
Epoch: 10, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.967 Vali Acc: 0.467 Test Loss: 1.967 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.455242872238159
Epoch: 11, Steps: 13 | Train Loss: 0.048 Vali Loss: 2.126 Vali Acc: 0.461 Test Loss: 2.126 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.4847798347473145
Epoch: 12, Steps: 13 | Train Loss: 0.029 Vali Loss: 2.269 Vali Acc: 0.522 Test Loss: 2.269 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.357685565948486
Epoch: 13, Steps: 13 | Train Loss: 0.038 Vali Loss: 2.628 Vali Acc: 0.472 Test Loss: 2.628 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.615239143371582
Epoch: 14, Steps: 13 | Train Loss: 0.027 Vali Loss: 2.578 Vali Acc: 0.489 Test Loss: 2.578 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 414082
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.175260543823242
Epoch: 1, Steps: 13 | Train Loss: 0.822 Vali Loss: 0.708 Vali Acc: 0.483 Test Loss: 0.708 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 4.403669834136963
Epoch: 2, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
Validation loss decreased (-0.483326 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 4.469722747802734
Epoch: 3, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.876 Vali Acc: 0.528 Test Loss: 0.876 Test Acc: 0.528
Validation loss decreased (-0.499993 --> -0.527769).  Saving model ...
Epoch: 4 cost time: 4.468761682510376
Epoch: 4, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.189 Vali Acc: 0.539 Test Loss: 1.189 Test Acc: 0.539
Validation loss decreased (-0.527769 --> -0.538877).  Saving model ...
Epoch: 5 cost time: 4.419133186340332
Epoch: 5, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.789544343948364
Epoch: 6, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.412 Vali Acc: 0.494 Test Loss: 1.412 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.511074542999268
Epoch: 7, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.446 Vali Acc: 0.550 Test Loss: 1.446 Test Acc: 0.550
Validation loss decreased (-0.538877 --> -0.549986).  Saving model ...
Epoch: 8 cost time: 4.6275787353515625
Epoch: 8, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.625 Vali Acc: 0.533 Test Loss: 1.625 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.605567932128906
Epoch: 9, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.721 Vali Acc: 0.522 Test Loss: 1.721 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.059205770492554
Epoch: 10, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.972 Vali Acc: 0.450 Test Loss: 1.972 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.479415416717529
Epoch: 11, Steps: 13 | Train Loss: 0.084 Vali Loss: 2.026 Vali Acc: 0.506 Test Loss: 2.026 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.116567611694336
Epoch: 12, Steps: 13 | Train Loss: 0.059 Vali Loss: 2.378 Vali Acc: 0.500 Test Loss: 2.378 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.105309963226318
Epoch: 13, Steps: 13 | Train Loss: 0.048 Vali Loss: 2.535 Vali Acc: 0.478 Test Loss: 2.535 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.060513019561768
Epoch: 14, Steps: 13 | Train Loss: 0.035 Vali Loss: 2.514 Vali Acc: 0.506 Test Loss: 2.514 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.260850667953491
Epoch: 15, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.685 Vali Acc: 0.500 Test Loss: 2.685 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.316122531890869
Epoch: 16, Steps: 13 | Train Loss: 0.010 Vali Loss: 3.177 Vali Acc: 0.489 Test Loss: 3.177 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.3180437088012695
Epoch: 17, Steps: 13 | Train Loss: 0.013 Vali Loss: 3.144 Vali Acc: 0.500 Test Loss: 3.144 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 414082
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.398236989974976
Epoch: 1, Steps: 13 | Train Loss: 0.814 Vali Loss: 0.702 Vali Acc: 0.522 Test Loss: 0.702 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 4.069513320922852
Epoch: 2, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.758 Vali Acc: 0.544 Test Loss: 0.758 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 4.263366937637329
Epoch: 3, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.943 Vali Acc: 0.528 Test Loss: 0.943 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.238026857376099
Epoch: 4, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.768267869949341
Epoch: 5, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.361 Vali Acc: 0.528 Test Loss: 1.361 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.5936524868011475
Epoch: 6, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.282 Vali Acc: 0.500 Test Loss: 1.282 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.128834962844849
Epoch: 7, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.344 Vali Acc: 0.511 Test Loss: 1.344 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.272386312484741
Epoch: 8, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.643 Vali Acc: 0.500 Test Loss: 1.643 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.9184699058532715
Epoch: 9, Steps: 13 | Train Loss: 0.148 Vali Loss: 1.642 Vali Acc: 0.489 Test Loss: 1.642 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.9179489612579346
Epoch: 10, Steps: 13 | Train Loss: 0.090 Vali Loss: 1.774 Vali Acc: 0.467 Test Loss: 1.774 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.459549427032471
Epoch: 11, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.928 Vali Acc: 0.517 Test Loss: 1.928 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.724447727203369
Epoch: 12, Steps: 13 | Train Loss: 0.045 Vali Loss: 2.100 Vali Acc: 0.500 Test Loss: 2.100 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 414082
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.673583269119263
Epoch: 1, Steps: 13 | Train Loss: 0.815 Vali Loss: 0.701 Vali Acc: 0.533 Test Loss: 0.701 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 4.480906963348389
Epoch: 2, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.744 Vali Acc: 0.556 Test Loss: 0.744 Test Acc: 0.556
Validation loss decreased (-0.533326 --> -0.555548).  Saving model ...
Epoch: 3 cost time: 4.453791618347168
Epoch: 3, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.994 Vali Acc: 0.533 Test Loss: 0.994 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.325676441192627
Epoch: 4, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.177 Vali Acc: 0.517 Test Loss: 1.177 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.560254335403442
Epoch: 5, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.341 Vali Acc: 0.494 Test Loss: 1.341 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.12108850479126
Epoch: 6, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.334 Vali Acc: 0.550 Test Loss: 1.334 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.117462635040283
Epoch: 7, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.467 Vali Acc: 0.506 Test Loss: 1.467 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.353492021560669
Epoch: 8, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.815 Vali Acc: 0.511 Test Loss: 1.815 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.48300576210022
Epoch: 9, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.815 Vali Acc: 0.478 Test Loss: 1.815 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.21094274520874
Epoch: 10, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.928 Vali Acc: 0.522 Test Loss: 1.928 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.489729166030884
Epoch: 11, Steps: 13 | Train Loss: 0.062 Vali Loss: 2.060 Vali Acc: 0.544 Test Loss: 2.060 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.254164695739746
Epoch: 12, Steps: 13 | Train Loss: 0.038 Vali Loss: 2.336 Vali Acc: 0.506 Test Loss: 2.336 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 414082
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.995539903640747
Epoch: 1, Steps: 13 | Train Loss: 0.823 Vali Loss: 0.727 Vali Acc: 0.511 Test Loss: 0.727 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 3.977494478225708
Epoch: 2, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.753 Vali Acc: 0.533 Test Loss: 0.753 Test Acc: 0.533
Validation loss decreased (-0.511104 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 4.25522255897522
Epoch: 3, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.980 Vali Acc: 0.539 Test Loss: 0.980 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538879).  Saving model ...
Epoch: 4 cost time: 3.928466320037842
Epoch: 4, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.388 Vali Acc: 0.511 Test Loss: 1.388 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9104397296905518
Epoch: 5, Steps: 13 | Train Loss: 0.533 Vali Loss: 1.105 Vali Acc: 0.517 Test Loss: 1.105 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.0225443840026855
Epoch: 6, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.264 Vali Acc: 0.528 Test Loss: 1.264 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9902753829956055
Epoch: 7, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.403 Vali Acc: 0.539 Test Loss: 1.403 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.9499876499176025
Epoch: 8, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.791 Vali Acc: 0.467 Test Loss: 1.791 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.0500328540802
Epoch: 9, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.875 Vali Acc: 0.528 Test Loss: 1.875 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.819333553314209
Epoch: 10, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.981 Vali Acc: 0.506 Test Loss: 1.981 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.175689697265625
Epoch: 11, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.990 Vali Acc: 0.511 Test Loss: 1.990 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.918159008026123
Epoch: 12, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.967 Vali Acc: 0.561 Test Loss: 1.967 Test Acc: 0.561
Validation loss decreased (-0.538879 --> -0.561091).  Saving model ...
Epoch: 13 cost time: 3.8333699703216553
Epoch: 13, Steps: 13 | Train Loss: 0.064 Vali Loss: 2.321 Vali Acc: 0.528 Test Loss: 2.321 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.25239634513855
Epoch: 14, Steps: 13 | Train Loss: 0.029 Vali Loss: 2.581 Vali Acc: 0.500 Test Loss: 2.581 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8944060802459717
Epoch: 15, Steps: 13 | Train Loss: 0.044 Vali Loss: 2.617 Vali Acc: 0.517 Test Loss: 2.617 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.083672285079956
Epoch: 16, Steps: 13 | Train Loss: 0.088 Vali Loss: 2.577 Vali Acc: 0.528 Test Loss: 2.577 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.13079833984375
Epoch: 17, Steps: 13 | Train Loss: 0.039 Vali Loss: 2.697 Vali Acc: 0.539 Test Loss: 2.697 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.252654314041138
Epoch: 18, Steps: 13 | Train Loss: 0.017 Vali Loss: 2.728 Vali Acc: 0.506 Test Loss: 2.728 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.852818012237549
Epoch: 19, Steps: 13 | Train Loss: 0.027 Vali Loss: 2.820 Vali Acc: 0.533 Test Loss: 2.820 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.029267311096191
Epoch: 20, Steps: 13 | Train Loss: 0.010 Vali Loss: 3.012 Vali Acc: 0.522 Test Loss: 3.012 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.7491893768310547
Epoch: 21, Steps: 13 | Train Loss: 0.008 Vali Loss: 3.226 Vali Acc: 0.506 Test Loss: 3.226 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.7785441875457764
Epoch: 22, Steps: 13 | Train Loss: 0.003 Vali Loss: 3.308 Vali Acc: 0.539 Test Loss: 3.308 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 414082
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.426770925521851
Epoch: 1, Steps: 13 | Train Loss: 0.800 Vali Loss: 0.712 Vali Acc: 0.511 Test Loss: 0.712 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 4.358845233917236
Epoch: 2, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.818 Vali Acc: 0.483 Test Loss: 0.818 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.372174263000488
Epoch: 3, Steps: 13 | Train Loss: 0.578 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.25449800491333
Epoch: 4, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.159 Vali Acc: 0.494 Test Loss: 1.159 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.3892717361450195
Epoch: 5, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.241 Vali Acc: 0.494 Test Loss: 1.241 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.524078130722046
Epoch: 6, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.235 Vali Acc: 0.467 Test Loss: 1.235 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.436426162719727
Epoch: 7, Steps: 13 | Train Loss: 0.431 Vali Loss: 1.378 Vali Acc: 0.494 Test Loss: 1.378 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.532564878463745
Epoch: 8, Steps: 13 | Train Loss: 0.236 Vali Loss: 1.653 Vali Acc: 0.478 Test Loss: 1.653 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.243995904922485
Epoch: 9, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.706 Vali Acc: 0.483 Test Loss: 1.706 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.25862455368042
Epoch: 10, Steps: 13 | Train Loss: 0.252 Vali Loss: 1.800 Vali Acc: 0.494 Test Loss: 1.800 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.328846454620361
Epoch: 11, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.886 Vali Acc: 0.472 Test Loss: 1.886 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 414082
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.05107855796814
Epoch: 1, Steps: 13 | Train Loss: 0.801 Vali Loss: 0.742 Vali Acc: 0.494 Test Loss: 0.742 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 3.9641449451446533
Epoch: 2, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.747 Vali Acc: 0.456 Test Loss: 0.747 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.119548797607422
Epoch: 3, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.942 Vali Acc: 0.550 Test Loss: 0.942 Test Acc: 0.550
Validation loss decreased (-0.494437 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 3.874497890472412
Epoch: 4, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.134 Vali Acc: 0.478 Test Loss: 1.134 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9219791889190674
Epoch: 5, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9229187965393066
Epoch: 6, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.425 Vali Acc: 0.483 Test Loss: 1.425 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.895589590072632
Epoch: 7, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.553 Vali Acc: 0.467 Test Loss: 1.553 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.9230263233184814
Epoch: 8, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.867 Vali Acc: 0.439 Test Loss: 1.867 Test Acc: 0.439
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.002603530883789
Epoch: 9, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.915 Vali Acc: 0.500 Test Loss: 1.915 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.6882641315460205
Epoch: 10, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.971 Vali Acc: 0.494 Test Loss: 1.971 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.889207363128662
Epoch: 11, Steps: 13 | Train Loss: 0.248 Vali Loss: 2.027 Vali Acc: 0.467 Test Loss: 2.027 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.982192277908325
Epoch: 12, Steps: 13 | Train Loss: 0.128 Vali Loss: 2.142 Vali Acc: 0.478 Test Loss: 2.142 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.8593060970306396
Epoch: 13, Steps: 13 | Train Loss: 0.098 Vali Loss: 2.407 Vali Acc: 0.439 Test Loss: 2.407 Test Acc: 0.439
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 414082
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.256169080734253
Epoch: 1, Steps: 13 | Train Loss: 0.816 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 4.098219156265259
Epoch: 2, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.725 Vali Acc: 0.506 Test Loss: 0.725 Test Acc: 0.506
Validation loss decreased (-0.499993 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 4.4444379806518555
Epoch: 3, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.722 Vali Acc: 0.533 Test Loss: 0.722 Test Acc: 0.533
Validation loss decreased (-0.505548 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 4.210406303405762
Epoch: 4, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.947 Vali Acc: 0.494 Test Loss: 0.947 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.44640040397644
Epoch: 5, Steps: 13 | Train Loss: 0.549 Vali Loss: 1.033 Vali Acc: 0.506 Test Loss: 1.033 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.000141382217407
Epoch: 6, Steps: 13 | Train Loss: 0.498 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.359229564666748
Epoch: 7, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.946 Vali Acc: 0.544 Test Loss: 0.946 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544435).  Saving model ...
Epoch: 8 cost time: 4.361051082611084
Epoch: 8, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.087 Vali Acc: 0.544 Test Loss: 1.087 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.078068256378174
Epoch: 9, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.226 Vali Acc: 0.544 Test Loss: 1.226 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.996683120727539
Epoch: 10, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.160 Vali Acc: 0.544 Test Loss: 1.160 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.011088132858276
Epoch: 11, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.322 Vali Acc: 0.533 Test Loss: 1.322 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.071728944778442
Epoch: 12, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.735 Vali Acc: 0.533 Test Loss: 1.735 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.320711851119995
Epoch: 13, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.728 Vali Acc: 0.556 Test Loss: 1.728 Test Acc: 0.556
Validation loss decreased (-0.544435 --> -0.555538).  Saving model ...
Epoch: 14 cost time: 4.085768699645996
Epoch: 14, Steps: 13 | Train Loss: 0.192 Vali Loss: 1.897 Vali Acc: 0.500 Test Loss: 1.897 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8399784564971924
Epoch: 15, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.884 Vali Acc: 0.506 Test Loss: 1.884 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.263760089874268
Epoch: 16, Steps: 13 | Train Loss: 0.145 Vali Loss: 2.020 Vali Acc: 0.528 Test Loss: 2.020 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.2134644985198975
Epoch: 17, Steps: 13 | Train Loss: 0.122 Vali Loss: 2.150 Vali Acc: 0.528 Test Loss: 2.150 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.142519474029541
Epoch: 18, Steps: 13 | Train Loss: 0.141 Vali Loss: 2.442 Vali Acc: 0.528 Test Loss: 2.442 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.202233791351318
Epoch: 19, Steps: 13 | Train Loss: 0.114 Vali Loss: 2.660 Vali Acc: 0.522 Test Loss: 2.660 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.24869179725647
Epoch: 20, Steps: 13 | Train Loss: 0.119 Vali Loss: 2.865 Vali Acc: 0.511 Test Loss: 2.865 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.450568675994873
Epoch: 21, Steps: 13 | Train Loss: 0.119 Vali Loss: 2.906 Vali Acc: 0.550 Test Loss: 2.906 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.2798755168914795
Epoch: 22, Steps: 13 | Train Loss: 0.055 Vali Loss: 3.566 Vali Acc: 0.517 Test Loss: 3.566 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.662396669387817
Epoch: 23, Steps: 13 | Train Loss: 0.182 Vali Loss: 3.550 Vali Acc: 0.539 Test Loss: 3.550 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 414082
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.090408802032471
Epoch: 1, Steps: 13 | Train Loss: 0.778 Vali Loss: 0.813 Vali Acc: 0.539 Test Loss: 0.813 Test Acc: 0.539
Validation loss decreased (inf --> -0.538881).  Saving model ...
Epoch: 2 cost time: 3.9878387451171875
Epoch: 2, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.765 Vali Acc: 0.533 Test Loss: 0.765 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.044372081756592
Epoch: 3, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.720 Vali Acc: 0.528 Test Loss: 0.720 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.034128189086914
Epoch: 4, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.920 Vali Acc: 0.544 Test Loss: 0.920 Test Acc: 0.544
Validation loss decreased (-0.538881 --> -0.544435).  Saving model ...
Epoch: 5 cost time: 3.759516716003418
Epoch: 5, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.895 Vali Acc: 0.511 Test Loss: 0.895 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.0158774852752686
Epoch: 6, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.757 Vali Acc: 0.561 Test Loss: 0.757 Test Acc: 0.561
Validation loss decreased (-0.544435 --> -0.561104).  Saving model ...
Epoch: 7 cost time: 4.197266578674316
Epoch: 7, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.822 Vali Acc: 0.578 Test Loss: 0.822 Test Acc: 0.578
Validation loss decreased (-0.561104 --> -0.577770).  Saving model ...
Epoch: 8 cost time: 3.9656982421875
Epoch: 8, Steps: 13 | Train Loss: 0.625 Vali Loss: 1.130 Vali Acc: 0.522 Test Loss: 1.130 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.081953287124634
Epoch: 9, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.939 Vali Acc: 0.567 Test Loss: 0.939 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9534316062927246
Epoch: 10, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.940 Vali Acc: 0.561 Test Loss: 0.940 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.9666662216186523
Epoch: 11, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.860 Vali Acc: 0.517 Test Loss: 0.860 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.073017358779907
Epoch: 12, Steps: 13 | Train Loss: 0.576 Vali Loss: 1.076 Vali Acc: 0.567 Test Loss: 1.076 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.805203914642334
Epoch: 13, Steps: 13 | Train Loss: 0.691 Vali Loss: 1.508 Vali Acc: 0.528 Test Loss: 1.508 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.9364960193634033
Epoch: 14, Steps: 13 | Train Loss: 0.512 Vali Loss: 1.306 Vali Acc: 0.528 Test Loss: 1.306 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.936084508895874
Epoch: 15, Steps: 13 | Train Loss: 0.432 Vali Loss: 1.224 Vali Acc: 0.522 Test Loss: 1.224 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.8496146202087402
Epoch: 16, Steps: 13 | Train Loss: 0.466 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.74151873588562
Epoch: 17, Steps: 13 | Train Loss: 0.487 Vali Loss: 1.313 Vali Acc: 0.522 Test Loss: 1.313 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 414082
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.585188388824463
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.700 Vali Acc: 0.567 Test Loss: 0.700 Test Acc: 0.567
Validation loss decreased (inf --> -0.566660).  Saving model ...
Epoch: 2 cost time: 4.201256990432739
Epoch: 2, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.802 Vali Acc: 0.511 Test Loss: 0.802 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.429809808731079
Epoch: 3, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.957 Vali Acc: 0.544 Test Loss: 0.957 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.511793375015259
Epoch: 4, Steps: 13 | Train Loss: 0.417 Vali Loss: 1.026 Vali Acc: 0.456 Test Loss: 1.026 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.7254462242126465
Epoch: 5, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.440855979919434
Epoch: 6, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.258 Vali Acc: 0.467 Test Loss: 1.258 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.724698781967163
Epoch: 7, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.602 Vali Acc: 0.539 Test Loss: 1.602 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.936007261276245
Epoch: 8, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.782 Vali Acc: 0.528 Test Loss: 1.782 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.777637720108032
Epoch: 9, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.826 Vali Acc: 0.500 Test Loss: 1.826 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.5719122886657715
Epoch: 10, Steps: 13 | Train Loss: 0.132 Vali Loss: 2.094 Vali Acc: 0.456 Test Loss: 2.094 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.443782806396484
Epoch: 11, Steps: 13 | Train Loss: 0.103 Vali Loss: 2.128 Vali Acc: 0.500 Test Loss: 2.128 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 364930
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.8808815479278564
Epoch: 1, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.701 Vali Acc: 0.578 Test Loss: 0.701 Test Acc: 0.578
Validation loss decreased (inf --> -0.577771).  Saving model ...
Epoch: 2 cost time: 4.519961833953857
Epoch: 2, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.778 Vali Acc: 0.517 Test Loss: 0.778 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.596823692321777
Epoch: 3, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.907 Vali Acc: 0.511 Test Loss: 0.907 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.791216135025024
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.083 Vali Acc: 0.461 Test Loss: 1.083 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.6249940395355225
Epoch: 5, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.209 Vali Acc: 0.461 Test Loss: 1.209 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.506121635437012
Epoch: 6, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.273 Vali Acc: 0.478 Test Loss: 1.273 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.551461696624756
Epoch: 7, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.619 Vali Acc: 0.439 Test Loss: 1.619 Test Acc: 0.439
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.9963202476501465
Epoch: 8, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.748 Vali Acc: 0.528 Test Loss: 1.748 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.929311275482178
Epoch: 9, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.746 Vali Acc: 0.461 Test Loss: 1.746 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.51108193397522
Epoch: 10, Steps: 13 | Train Loss: 0.147 Vali Loss: 2.070 Vali Acc: 0.450 Test Loss: 2.070 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.907021760940552
Epoch: 11, Steps: 13 | Train Loss: 0.133 Vali Loss: 2.397 Vali Acc: 0.550 Test Loss: 2.397 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 364930
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.9317686557769775
Epoch: 1, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.695 Vali Acc: 0.561 Test Loss: 0.695 Test Acc: 0.561
Validation loss decreased (inf --> -0.561104).  Saving model ...
Epoch: 2 cost time: 4.164182662963867
Epoch: 2, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.753 Vali Acc: 0.483 Test Loss: 0.753 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9926254749298096
Epoch: 3, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.883 Vali Acc: 0.494 Test Loss: 0.883 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.38347864151001
Epoch: 4, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.981 Vali Acc: 0.500 Test Loss: 0.981 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.77423882484436
Epoch: 5, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.168 Vali Acc: 0.494 Test Loss: 1.168 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.376092433929443
Epoch: 6, Steps: 13 | Train Loss: 0.236 Vali Loss: 1.256 Vali Acc: 0.467 Test Loss: 1.256 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.649345874786377
Epoch: 7, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.418 Vali Acc: 0.500 Test Loss: 1.418 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.306607007980347
Epoch: 8, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.547 Vali Acc: 0.489 Test Loss: 1.547 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.888219356536865
Epoch: 9, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.732 Vali Acc: 0.478 Test Loss: 1.732 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.552626132965088
Epoch: 10, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.841 Vali Acc: 0.500 Test Loss: 1.841 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.2380452156066895
Epoch: 11, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.916 Vali Acc: 0.483 Test Loss: 1.916 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 364930
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.1768598556518555
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.699 Vali Acc: 0.544 Test Loss: 0.699 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 3.8293466567993164
Epoch: 2, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.774 Vali Acc: 0.528 Test Loss: 0.774 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7036569118499756
Epoch: 3, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.993 Vali Acc: 0.517 Test Loss: 0.993 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.874894380569458
Epoch: 4, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.005012512207031
Epoch: 5, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.139 Vali Acc: 0.539 Test Loss: 1.139 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.037853240966797
Epoch: 6, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.255 Vali Acc: 0.528 Test Loss: 1.255 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.089961290359497
Epoch: 7, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.442 Vali Acc: 0.483 Test Loss: 1.442 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.128463268280029
Epoch: 8, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.795 Vali Acc: 0.494 Test Loss: 1.795 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.17693567276001
Epoch: 9, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.814 Vali Acc: 0.483 Test Loss: 1.814 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.161495208740234
Epoch: 10, Steps: 13 | Train Loss: 0.178 Vali Loss: 2.141 Vali Acc: 0.467 Test Loss: 2.141 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.205289125442505
Epoch: 11, Steps: 13 | Train Loss: 0.273 Vali Loss: 2.725 Vali Acc: 0.494 Test Loss: 2.725 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 364930
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.681734561920166
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.706 Vali Acc: 0.567 Test Loss: 0.706 Test Acc: 0.567
Validation loss decreased (inf --> -0.566660).  Saving model ...
Epoch: 2 cost time: 4.313716411590576
Epoch: 2, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.770 Vali Acc: 0.517 Test Loss: 0.770 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.531415939331055
Epoch: 3, Steps: 13 | Train Loss: 0.433 Vali Loss: 1.052 Vali Acc: 0.528 Test Loss: 1.052 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.311713933944702
Epoch: 4, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.044 Vali Acc: 0.517 Test Loss: 1.044 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.05438232421875
Epoch: 5, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.140 Vali Acc: 0.511 Test Loss: 1.140 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.206357955932617
Epoch: 6, Steps: 13 | Train Loss: 0.225 Vali Loss: 1.344 Vali Acc: 0.506 Test Loss: 1.344 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.497324705123901
Epoch: 7, Steps: 13 | Train Loss: 0.161 Vali Loss: 1.466 Vali Acc: 0.533 Test Loss: 1.466 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.965970754623413
Epoch: 8, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.657 Vali Acc: 0.483 Test Loss: 1.657 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.640182018280029
Epoch: 9, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.858 Vali Acc: 0.478 Test Loss: 1.858 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.722821950912476
Epoch: 10, Steps: 13 | Train Loss: 0.093 Vali Loss: 2.129 Vali Acc: 0.522 Test Loss: 2.129 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.589253664016724
Epoch: 11, Steps: 13 | Train Loss: 0.194 Vali Loss: 2.710 Vali Acc: 0.528 Test Loss: 2.710 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 364930
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.700955867767334
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.734 Vali Acc: 0.511 Test Loss: 0.734 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 4.506991624832153
Epoch: 2, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.802 Vali Acc: 0.539 Test Loss: 0.802 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538881).  Saving model ...
Epoch: 3 cost time: 3.7594082355499268
Epoch: 3, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.966 Vali Acc: 0.494 Test Loss: 0.966 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.325543642044067
Epoch: 4, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.951 Vali Acc: 0.528 Test Loss: 0.951 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8454718589782715
Epoch: 5, Steps: 13 | Train Loss: 0.319 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.446291923522949
Epoch: 6, Steps: 13 | Train Loss: 0.252 Vali Loss: 1.183 Vali Acc: 0.522 Test Loss: 1.183 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.88273024559021
Epoch: 7, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.314 Vali Acc: 0.544 Test Loss: 1.314 Test Acc: 0.544
Validation loss decreased (-0.538881 --> -0.544431).  Saving model ...
Epoch: 8 cost time: 3.89420223236084
Epoch: 8, Steps: 13 | Train Loss: 0.195 Vali Loss: 2.248 Vali Acc: 0.511 Test Loss: 2.248 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.2525107860565186
Epoch: 9, Steps: 13 | Train Loss: 0.289 Vali Loss: 2.126 Vali Acc: 0.461 Test Loss: 2.126 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.055681943893433
Epoch: 10, Steps: 13 | Train Loss: 0.187 Vali Loss: 2.081 Vali Acc: 0.511 Test Loss: 2.081 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.113932847976685
Epoch: 11, Steps: 13 | Train Loss: 0.069 Vali Loss: 2.051 Vali Acc: 0.517 Test Loss: 2.051 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.459079265594482
Epoch: 12, Steps: 13 | Train Loss: 0.101 Vali Loss: 2.034 Vali Acc: 0.511 Test Loss: 2.034 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.2090373039245605
Epoch: 13, Steps: 13 | Train Loss: 0.053 Vali Loss: 2.255 Vali Acc: 0.506 Test Loss: 2.255 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.299300909042358
Epoch: 14, Steps: 13 | Train Loss: 0.031 Vali Loss: 2.401 Vali Acc: 0.522 Test Loss: 2.401 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.537514686584473
Epoch: 15, Steps: 13 | Train Loss: 0.063 Vali Loss: 2.581 Vali Acc: 0.522 Test Loss: 2.581 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.105912923812866
Epoch: 16, Steps: 13 | Train Loss: 0.034 Vali Loss: 2.750 Vali Acc: 0.511 Test Loss: 2.750 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.965721845626831
Epoch: 17, Steps: 13 | Train Loss: 0.031 Vali Loss: 2.826 Vali Acc: 0.494 Test Loss: 2.826 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 364930
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.999445915222168
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.743 Vali Acc: 0.483 Test Loss: 0.743 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 4.019882917404175
Epoch: 2, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.898 Vali Acc: 0.489 Test Loss: 0.898 Test Acc: 0.489
Validation loss decreased (-0.483326 --> -0.488880).  Saving model ...
Epoch: 3 cost time: 4.1078941822052
Epoch: 3, Steps: 13 | Train Loss: 0.498 Vali Loss: 1.137 Vali Acc: 0.456 Test Loss: 1.137 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.063755035400391
Epoch: 4, Steps: 13 | Train Loss: 0.469 Vali Loss: 1.137 Vali Acc: 0.450 Test Loss: 1.137 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.0270020961761475
Epoch: 5, Steps: 13 | Train Loss: 0.431 Vali Loss: 1.370 Vali Acc: 0.461 Test Loss: 1.370 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.074679374694824
Epoch: 6, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.420 Vali Acc: 0.444 Test Loss: 1.420 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.260686635971069
Epoch: 7, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.392 Vali Acc: 0.506 Test Loss: 1.392 Test Acc: 0.506
Validation loss decreased (-0.488880 --> -0.505542).  Saving model ...
Epoch: 8 cost time: 4.67073130607605
Epoch: 8, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.699 Vali Acc: 0.511 Test Loss: 1.699 Test Acc: 0.511
Validation loss decreased (-0.505542 --> -0.511094).  Saving model ...
Epoch: 9 cost time: 4.535609722137451
Epoch: 9, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.856 Vali Acc: 0.478 Test Loss: 1.856 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.105885982513428
Epoch: 10, Steps: 13 | Train Loss: 0.431 Vali Loss: 1.977 Vali Acc: 0.489 Test Loss: 1.977 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.451716661453247
Epoch: 11, Steps: 13 | Train Loss: 0.399 Vali Loss: 1.990 Vali Acc: 0.506 Test Loss: 1.990 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.304074287414551
Epoch: 12, Steps: 13 | Train Loss: 0.149 Vali Loss: 2.153 Vali Acc: 0.489 Test Loss: 2.153 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.308858633041382
Epoch: 13, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.902 Vali Acc: 0.550 Test Loss: 1.902 Test Acc: 0.550
Validation loss decreased (-0.511094 --> -0.549981).  Saving model ...
Epoch: 14 cost time: 4.162466287612915
Epoch: 14, Steps: 13 | Train Loss: 0.070 Vali Loss: 2.000 Vali Acc: 0.511 Test Loss: 2.000 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.1172685623168945
Epoch: 15, Steps: 13 | Train Loss: 0.127 Vali Loss: 2.239 Vali Acc: 0.517 Test Loss: 2.239 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.003802537918091
Epoch: 16, Steps: 13 | Train Loss: 0.111 Vali Loss: 2.430 Vali Acc: 0.517 Test Loss: 2.430 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.010309934616089
Epoch: 17, Steps: 13 | Train Loss: 0.067 Vali Loss: 2.614 Vali Acc: 0.483 Test Loss: 2.614 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.9783828258514404
Epoch: 18, Steps: 13 | Train Loss: 0.066 Vali Loss: 3.098 Vali Acc: 0.483 Test Loss: 3.098 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.8682708740234375
Epoch: 19, Steps: 13 | Train Loss: 0.076 Vali Loss: 2.908 Vali Acc: 0.500 Test Loss: 2.908 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.7098376750946045
Epoch: 20, Steps: 13 | Train Loss: 0.020 Vali Loss: 2.819 Vali Acc: 0.517 Test Loss: 2.819 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.8504533767700195
Epoch: 21, Steps: 13 | Train Loss: 0.017 Vali Loss: 2.922 Vali Acc: 0.511 Test Loss: 2.922 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.281433820724487
Epoch: 22, Steps: 13 | Train Loss: 0.013 Vali Loss: 3.204 Vali Acc: 0.494 Test Loss: 3.204 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.026293754577637
Epoch: 23, Steps: 13 | Train Loss: 0.022 Vali Loss: 3.412 Vali Acc: 0.456 Test Loss: 3.412 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 364930
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.136321306228638
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.725 Vali Acc: 0.506 Test Loss: 0.725 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 3.8371760845184326
Epoch: 2, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.778 Vali Acc: 0.494 Test Loss: 0.778 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.011899471282959
Epoch: 3, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.967 Vali Acc: 0.461 Test Loss: 0.967 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8793513774871826
Epoch: 4, Steps: 13 | Train Loss: 0.388 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7004902362823486
Epoch: 5, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.530536651611328
Epoch: 6, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.396 Vali Acc: 0.478 Test Loss: 1.396 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.5720696449279785
Epoch: 7, Steps: 13 | Train Loss: 0.226 Vali Loss: 1.391 Vali Acc: 0.483 Test Loss: 1.391 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.803133487701416
Epoch: 8, Steps: 13 | Train Loss: 0.261 Vali Loss: 2.354 Vali Acc: 0.483 Test Loss: 2.354 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.6250696182250977
Epoch: 9, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.889 Vali Acc: 0.411 Test Loss: 1.889 Test Acc: 0.411
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.4499430656433105
Epoch: 10, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.917 Vali Acc: 0.422 Test Loss: 1.917 Test Acc: 0.422
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.707421064376831
Epoch: 11, Steps: 13 | Train Loss: 0.178 Vali Loss: 2.024 Vali Acc: 0.506 Test Loss: 2.024 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5055555555555555
model parameter : 364930
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.282022714614868
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 4.015287637710571
Epoch: 2, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.716 Vali Acc: 0.511 Test Loss: 0.716 Test Acc: 0.511
Validation loss decreased (-0.499992 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 3.9707560539245605
Epoch: 3, Steps: 13 | Train Loss: 0.634 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.253974676132202
Epoch: 4, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.725 Vali Acc: 0.556 Test Loss: 0.725 Test Acc: 0.556
Validation loss decreased (-0.511104 --> -0.555548).  Saving model ...
Epoch: 5 cost time: 4.22330117225647
Epoch: 5, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.762 Vali Acc: 0.528 Test Loss: 0.762 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.342600107192993
Epoch: 6, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.807 Vali Acc: 0.561 Test Loss: 0.807 Test Acc: 0.561
Validation loss decreased (-0.555548 --> -0.561103).  Saving model ...
Epoch: 7 cost time: 4.2162394523620605
Epoch: 7, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.879 Vali Acc: 0.544 Test Loss: 0.879 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9240477085113525
Epoch: 8, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.949 Vali Acc: 0.544 Test Loss: 0.949 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.463783025741577
Epoch: 9, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.003 Vali Acc: 0.517 Test Loss: 1.003 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.21762228012085
Epoch: 10, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.336 Vali Acc: 0.544 Test Loss: 1.336 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.646733999252319
Epoch: 11, Steps: 13 | Train Loss: 0.390 Vali Loss: 1.173 Vali Acc: 0.561 Test Loss: 1.173 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.0824339389801025
Epoch: 12, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.287 Vali Acc: 0.544 Test Loss: 1.287 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.168457746505737
Epoch: 13, Steps: 13 | Train Loss: 0.248 Vali Loss: 1.451 Vali Acc: 0.528 Test Loss: 1.451 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.9080302715301514
Epoch: 14, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.493 Vali Acc: 0.528 Test Loss: 1.493 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.383468389511108
Epoch: 15, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.861 Vali Acc: 0.572 Test Loss: 1.861 Test Acc: 0.572
Validation loss decreased (-0.561103 --> -0.572204).  Saving model ...
Epoch: 16 cost time: 4.351745128631592
Epoch: 16, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.746 Vali Acc: 0.556 Test Loss: 1.746 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.51931357383728
Epoch: 17, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.910 Vali Acc: 0.556 Test Loss: 1.910 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.304065942764282
Epoch: 18, Steps: 13 | Train Loss: 0.166 Vali Loss: 2.055 Vali Acc: 0.528 Test Loss: 2.055 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.363629341125488
Epoch: 19, Steps: 13 | Train Loss: 0.091 Vali Loss: 2.335 Vali Acc: 0.544 Test Loss: 2.335 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.135724067687988
Epoch: 20, Steps: 13 | Train Loss: 0.101 Vali Loss: 2.435 Vali Acc: 0.539 Test Loss: 2.435 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.3481361865997314
Epoch: 21, Steps: 13 | Train Loss: 0.084 Vali Loss: 2.555 Vali Acc: 0.556 Test Loss: 2.555 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.770660161972046
Epoch: 22, Steps: 13 | Train Loss: 0.098 Vali Loss: 3.022 Vali Acc: 0.556 Test Loss: 3.022 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.7007200717926025
Epoch: 23, Steps: 13 | Train Loss: 0.053 Vali Loss: 2.764 Vali Acc: 0.550 Test Loss: 2.764 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.877169370651245
Epoch: 24, Steps: 13 | Train Loss: 0.037 Vali Loss: 2.984 Vali Acc: 0.550 Test Loss: 2.984 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.8605146408081055
Epoch: 25, Steps: 13 | Train Loss: 0.046 Vali Loss: 3.450 Vali Acc: 0.522 Test Loss: 3.450 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 364930
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.463417053222656
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.760 Vali Acc: 0.517 Test Loss: 0.760 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 4.045229434967041
Epoch: 2, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.760 Vali Acc: 0.572 Test Loss: 0.760 Test Acc: 0.572
Validation loss decreased (-0.516659 --> -0.572215).  Saving model ...
Epoch: 3 cost time: 4.083545923233032
Epoch: 3, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.944 Vali Acc: 0.517 Test Loss: 0.944 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.221216917037964
Epoch: 4, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.772 Vali Acc: 0.556 Test Loss: 0.772 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.219515562057495
Epoch: 5, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.836 Vali Acc: 0.544 Test Loss: 0.836 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.385633945465088
Epoch: 6, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.764 Vali Acc: 0.517 Test Loss: 0.764 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.277430772781372
Epoch: 7, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.890 Vali Acc: 0.506 Test Loss: 0.890 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.04451584815979
Epoch: 8, Steps: 13 | Train Loss: 0.664 Vali Loss: 1.111 Vali Acc: 0.506 Test Loss: 1.111 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.055337905883789
Epoch: 9, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.903 Vali Acc: 0.583 Test Loss: 0.903 Test Acc: 0.583
Validation loss decreased (-0.572215 --> -0.583324).  Saving model ...
Epoch: 10 cost time: 3.869340419769287
Epoch: 10, Steps: 13 | Train Loss: 0.676 Vali Loss: 1.251 Vali Acc: 0.572 Test Loss: 1.251 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8129844665527344
Epoch: 11, Steps: 13 | Train Loss: 0.742 Vali Loss: 1.008 Vali Acc: 0.522 Test Loss: 1.008 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8222436904907227
Epoch: 12, Steps: 13 | Train Loss: 0.603 Vali Loss: 1.234 Vali Acc: 0.533 Test Loss: 1.234 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.9359350204467773
Epoch: 13, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.972 Vali Acc: 0.517 Test Loss: 0.972 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.010404825210571
Epoch: 14, Steps: 13 | Train Loss: 0.488 Vali Loss: 1.083 Vali Acc: 0.517 Test Loss: 1.083 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.734957695007324
Epoch: 15, Steps: 13 | Train Loss: 0.495 Vali Loss: 1.204 Vali Acc: 0.572 Test Loss: 1.204 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.954183340072632
Epoch: 16, Steps: 13 | Train Loss: 0.589 Vali Loss: 1.810 Vali Acc: 0.489 Test Loss: 1.810 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.3034844398498535
Epoch: 17, Steps: 13 | Train Loss: 0.440 Vali Loss: 1.227 Vali Acc: 0.556 Test Loss: 1.227 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.54259729385376
Epoch: 18, Steps: 13 | Train Loss: 0.466 Vali Loss: 1.385 Vali Acc: 0.544 Test Loss: 1.385 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.413508892059326
Epoch: 19, Steps: 13 | Train Loss: 0.493 Vali Loss: 1.290 Vali Acc: 0.506 Test Loss: 1.290 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 364930
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.8122828006744385
Epoch: 1, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.694 Vali Acc: 0.517 Test Loss: 0.694 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 4.749192476272583
Epoch: 2, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
Validation loss decreased (-0.516660 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 5.059507846832275
Epoch: 3, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.783 Vali Acc: 0.467 Test Loss: 0.783 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.724973201751709
Epoch: 4, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.941 Vali Acc: 0.511 Test Loss: 0.941 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.325109958648682
Epoch: 5, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.936 Vali Acc: 0.489 Test Loss: 0.936 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.856353521347046
Epoch: 6, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.045 Vali Acc: 0.494 Test Loss: 1.045 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.598368406295776
Epoch: 7, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.131 Vali Acc: 0.483 Test Loss: 1.131 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.302969932556152
Epoch: 8, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.470 Vali Acc: 0.556 Test Loss: 1.470 Test Acc: 0.556
Validation loss decreased (-0.549993 --> -0.555541).  Saving model ...
Epoch: 9 cost time: 4.686171770095825
Epoch: 9, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.556 Vali Acc: 0.533 Test Loss: 1.556 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.7152252197265625
Epoch: 10, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.793 Vali Acc: 0.528 Test Loss: 1.793 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.579988718032837
Epoch: 11, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.648 Vali Acc: 0.467 Test Loss: 1.648 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.572384357452393
Epoch: 12, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.827 Vali Acc: 0.544 Test Loss: 1.827 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.536238431930542
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.978 Vali Acc: 0.500 Test Loss: 1.978 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.269294261932373
Epoch: 14, Steps: 13 | Train Loss: 0.027 Vali Loss: 2.034 Vali Acc: 0.517 Test Loss: 2.034 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.336323261260986
Epoch: 15, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.191 Vali Acc: 0.472 Test Loss: 2.191 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.510814428329468
Epoch: 16, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.423 Vali Acc: 0.483 Test Loss: 2.423 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.336116790771484
Epoch: 17, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.392 Vali Acc: 0.478 Test Loss: 2.392 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.474109411239624
Epoch: 18, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.364 Vali Acc: 0.483 Test Loss: 2.364 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 510146
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.797492265701294
Epoch: 1, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.691 Vali Acc: 0.522 Test Loss: 0.691 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 4.486806631088257
Epoch: 2, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.729 Vali Acc: 0.533 Test Loss: 0.729 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 4.4334046840667725
Epoch: 3, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.805 Vali Acc: 0.506 Test Loss: 0.805 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.555552005767822
Epoch: 4, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.975 Vali Acc: 0.544 Test Loss: 0.975 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544435).  Saving model ...
Epoch: 5 cost time: 4.487596035003662
Epoch: 5, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.910 Vali Acc: 0.500 Test Loss: 0.910 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.328554153442383
Epoch: 6, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.105 Vali Acc: 0.500 Test Loss: 1.105 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.412768363952637
Epoch: 7, Steps: 13 | Train Loss: 0.248 Vali Loss: 1.112 Vali Acc: 0.494 Test Loss: 1.112 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.480849981307983
Epoch: 8, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.416 Vali Acc: 0.517 Test Loss: 1.416 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.334733486175537
Epoch: 9, Steps: 13 | Train Loss: 0.163 Vali Loss: 1.517 Vali Acc: 0.550 Test Loss: 1.517 Test Acc: 0.550
Validation loss decreased (-0.544435 --> -0.549985).  Saving model ...
Epoch: 10 cost time: 4.513512372970581
Epoch: 10, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.630 Vali Acc: 0.483 Test Loss: 1.630 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.658936262130737
Epoch: 11, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.654 Vali Acc: 0.489 Test Loss: 1.654 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.577932357788086
Epoch: 12, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.825 Vali Acc: 0.500 Test Loss: 1.825 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.496315956115723
Epoch: 13, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.892 Vali Acc: 0.478 Test Loss: 1.892 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.606935501098633
Epoch: 14, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.114 Vali Acc: 0.478 Test Loss: 2.114 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.688800811767578
Epoch: 15, Steps: 13 | Train Loss: 0.036 Vali Loss: 2.188 Vali Acc: 0.494 Test Loss: 2.188 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.733578443527222
Epoch: 16, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.282 Vali Acc: 0.489 Test Loss: 2.282 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.553142547607422
Epoch: 17, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.309 Vali Acc: 0.489 Test Loss: 2.309 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.562955856323242
Epoch: 18, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.294 Vali Acc: 0.506 Test Loss: 2.294 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.455540657043457
Epoch: 19, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.302 Vali Acc: 0.506 Test Loss: 2.302 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 510146
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.870021104812622
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.691 Vali Acc: 0.544 Test Loss: 0.691 Test Acc: 0.544
Validation loss decreased (inf --> -0.544438).  Saving model ...
Epoch: 2 cost time: 3.9970760345458984
Epoch: 2, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
Validation loss decreased (-0.544438 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 4.0156872272491455
Epoch: 3, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.49621844291687
Epoch: 4, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.880 Vali Acc: 0.539 Test Loss: 0.880 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.7098424434661865
Epoch: 5, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.896 Vali Acc: 0.483 Test Loss: 0.896 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.230894565582275
Epoch: 6, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.993 Vali Acc: 0.528 Test Loss: 0.993 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.404199838638306
Epoch: 7, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.364121913909912
Epoch: 8, Steps: 13 | Train Loss: 0.248 Vali Loss: 1.287 Vali Acc: 0.539 Test Loss: 1.287 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.563111066818237
Epoch: 9, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.378 Vali Acc: 0.528 Test Loss: 1.378 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.408923864364624
Epoch: 10, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.708 Vali Acc: 0.561 Test Loss: 1.708 Test Acc: 0.561
Validation loss decreased (-0.549992 --> -0.561094).  Saving model ...
Epoch: 11 cost time: 4.192206859588623
Epoch: 11, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.663 Vali Acc: 0.506 Test Loss: 1.663 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.5878846645355225
Epoch: 12, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.782 Vali Acc: 0.511 Test Loss: 1.782 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.192339897155762
Epoch: 13, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.876 Vali Acc: 0.483 Test Loss: 1.876 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.152807235717773
Epoch: 14, Steps: 13 | Train Loss: 0.023 Vali Loss: 2.058 Vali Acc: 0.539 Test Loss: 2.058 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.31221604347229
Epoch: 15, Steps: 13 | Train Loss: 0.019 Vali Loss: 2.138 Vali Acc: 0.533 Test Loss: 2.138 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.029818534851074
Epoch: 16, Steps: 13 | Train Loss: 0.013 Vali Loss: 2.251 Vali Acc: 0.517 Test Loss: 2.251 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.370311498641968
Epoch: 17, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.327 Vali Acc: 0.517 Test Loss: 2.327 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.2179505825042725
Epoch: 18, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.324 Vali Acc: 0.533 Test Loss: 2.324 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.34930682182312
Epoch: 19, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.353 Vali Acc: 0.500 Test Loss: 2.353 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.017646074295044
Epoch: 20, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.367 Vali Acc: 0.500 Test Loss: 2.367 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 510146
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.519274711608887
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.700 Vali Acc: 0.522 Test Loss: 0.700 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 4.379977226257324
Epoch: 2, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.763 Vali Acc: 0.528 Test Loss: 0.763 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 4.466908693313599
Epoch: 3, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.803 Vali Acc: 0.506 Test Loss: 0.803 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.416548728942871
Epoch: 4, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.869 Vali Acc: 0.522 Test Loss: 0.869 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.661988973617554
Epoch: 5, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.893 Vali Acc: 0.522 Test Loss: 0.893 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.612910747528076
Epoch: 6, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.990 Vali Acc: 0.517 Test Loss: 0.990 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.5273027420043945
Epoch: 7, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.090 Vali Acc: 0.556 Test Loss: 1.090 Test Acc: 0.556
Validation loss decreased (-0.527770 --> -0.555545).  Saving model ...
Epoch: 8 cost time: 4.650743722915649
Epoch: 8, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.235 Vali Acc: 0.544 Test Loss: 1.235 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.23848295211792
Epoch: 9, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.411 Vali Acc: 0.511 Test Loss: 1.411 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.013177871704102
Epoch: 10, Steps: 13 | Train Loss: 0.150 Vali Loss: 1.683 Vali Acc: 0.494 Test Loss: 1.683 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.894954204559326
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.518 Vali Acc: 0.500 Test Loss: 1.518 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.235098361968994
Epoch: 12, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.657 Vali Acc: 0.506 Test Loss: 1.657 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.282137393951416
Epoch: 13, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.680 Vali Acc: 0.494 Test Loss: 1.680 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.583176851272583
Epoch: 14, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.811 Vali Acc: 0.511 Test Loss: 1.811 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.634912967681885
Epoch: 15, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.939 Vali Acc: 0.478 Test Loss: 1.939 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.435766220092773
Epoch: 16, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.978 Vali Acc: 0.494 Test Loss: 1.978 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.602798938751221
Epoch: 17, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.042 Vali Acc: 0.506 Test Loss: 2.042 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 510146
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.082508325576782
Epoch: 1, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.741654634475708
Epoch: 2, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.792 Vali Acc: 0.550 Test Loss: 0.792 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 3.9222025871276855
Epoch: 3, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.793 Vali Acc: 0.483 Test Loss: 0.793 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.110804319381714
Epoch: 4, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9048871994018555
Epoch: 5, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.983 Vali Acc: 0.522 Test Loss: 0.983 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.9194629192352295
Epoch: 6, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.049 Vali Acc: 0.528 Test Loss: 1.049 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.8152663707733154
Epoch: 7, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.135 Vali Acc: 0.533 Test Loss: 1.135 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.026787281036377
Epoch: 8, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.332 Vali Acc: 0.511 Test Loss: 1.332 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.097636699676514
Epoch: 9, Steps: 13 | Train Loss: 0.163 Vali Loss: 1.473 Vali Acc: 0.500 Test Loss: 1.473 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.410653829574585
Epoch: 10, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.666 Vali Acc: 0.517 Test Loss: 1.666 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.058068752288818
Epoch: 11, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.641 Vali Acc: 0.567 Test Loss: 1.641 Test Acc: 0.567
Validation loss decreased (-0.549992 --> -0.566650).  Saving model ...
Epoch: 12 cost time: 3.914572238922119
Epoch: 12, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.782 Vali Acc: 0.556 Test Loss: 1.782 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.1327948570251465
Epoch: 13, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.898 Vali Acc: 0.517 Test Loss: 1.898 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.113785028457642
Epoch: 14, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.003 Vali Acc: 0.539 Test Loss: 2.003 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.150963068008423
Epoch: 15, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.070 Vali Acc: 0.528 Test Loss: 2.070 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.352691173553467
Epoch: 16, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.090 Vali Acc: 0.506 Test Loss: 2.090 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.236863374710083
Epoch: 17, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.162 Vali Acc: 0.522 Test Loss: 2.162 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.2572126388549805
Epoch: 18, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.226 Vali Acc: 0.528 Test Loss: 2.226 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.0416905879974365
Epoch: 19, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.271 Vali Acc: 0.539 Test Loss: 2.271 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.0553998947143555
Epoch: 20, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.268 Vali Acc: 0.544 Test Loss: 2.268 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.259428024291992
Epoch: 21, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.340 Vali Acc: 0.533 Test Loss: 2.340 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 510146
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.5064239501953125
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.722 Vali Acc: 0.483 Test Loss: 0.722 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 4.253779888153076
Epoch: 2, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.844 Vali Acc: 0.500 Test Loss: 0.844 Test Acc: 0.500
Validation loss decreased (-0.483326 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 4.213306427001953
Epoch: 3, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.868 Vali Acc: 0.511 Test Loss: 0.868 Test Acc: 0.511
Validation loss decreased (-0.499992 --> -0.511102).  Saving model ...
Epoch: 4 cost time: 4.0551598072052
Epoch: 4, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.928 Vali Acc: 0.500 Test Loss: 0.928 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.4194536209106445
Epoch: 5, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.900 Vali Acc: 0.511 Test Loss: 0.900 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.263132095336914
Epoch: 6, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.008 Vali Acc: 0.522 Test Loss: 1.008 Test Acc: 0.522
Validation loss decreased (-0.511102 --> -0.522212).  Saving model ...
Epoch: 7 cost time: 4.3821961879730225
Epoch: 7, Steps: 13 | Train Loss: 0.266 Vali Loss: 1.062 Vali Acc: 0.528 Test Loss: 1.062 Test Acc: 0.528
Validation loss decreased (-0.522212 --> -0.527767).  Saving model ...
Epoch: 8 cost time: 4.166154861450195
Epoch: 8, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.204 Vali Acc: 0.517 Test Loss: 1.204 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.505816221237183
Epoch: 9, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.290 Vali Acc: 0.511 Test Loss: 1.290 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.61208963394165
Epoch: 10, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.438 Vali Acc: 0.500 Test Loss: 1.438 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.294498443603516
Epoch: 11, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.551 Vali Acc: 0.494 Test Loss: 1.551 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.250595569610596
Epoch: 12, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.705 Vali Acc: 0.506 Test Loss: 1.705 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.122580051422119
Epoch: 13, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.759 Vali Acc: 0.489 Test Loss: 1.759 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.1562488079071045
Epoch: 14, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.856 Vali Acc: 0.511 Test Loss: 1.856 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.83644437789917
Epoch: 15, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.003 Vali Acc: 0.506 Test Loss: 2.003 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.446032285690308
Epoch: 16, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.105 Vali Acc: 0.489 Test Loss: 2.105 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.088251829147339
Epoch: 17, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.182 Vali Acc: 0.522 Test Loss: 2.182 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 510146
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.841565132141113
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.741 Vali Acc: 0.522 Test Loss: 0.741 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 4.696160793304443
Epoch: 2, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.842 Vali Acc: 0.467 Test Loss: 0.842 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.026354551315308
Epoch: 3, Steps: 13 | Train Loss: 0.643 Vali Loss: 1.088 Vali Acc: 0.472 Test Loss: 1.088 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.74514627456665
Epoch: 4, Steps: 13 | Train Loss: 0.579 Vali Loss: 1.150 Vali Acc: 0.472 Test Loss: 1.150 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.250718593597412
Epoch: 5, Steps: 13 | Train Loss: 0.491 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.096480131149292
Epoch: 6, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.113 Vali Acc: 0.483 Test Loss: 1.113 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.99044132232666
Epoch: 7, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.160 Vali Acc: 0.472 Test Loss: 1.160 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.029651403427124
Epoch: 8, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.241 Vali Acc: 0.444 Test Loss: 1.241 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.9980950355529785
Epoch: 9, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.293 Vali Acc: 0.489 Test Loss: 1.293 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.9075582027435303
Epoch: 10, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.586 Vali Acc: 0.483 Test Loss: 1.586 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.860586643218994
Epoch: 11, Steps: 13 | Train Loss: 0.197 Vali Loss: 1.512 Vali Acc: 0.483 Test Loss: 1.512 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 510146
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.097785949707031
Epoch: 1, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.743 Vali Acc: 0.489 Test Loss: 0.743 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 4.430171489715576
Epoch: 2, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.828 Vali Acc: 0.511 Test Loss: 0.828 Test Acc: 0.511
Validation loss decreased (-0.488881 --> -0.511103).  Saving model ...
Epoch: 3 cost time: 4.418795824050903
Epoch: 3, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.913 Vali Acc: 0.489 Test Loss: 0.913 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.669718980789185
Epoch: 4, Steps: 13 | Train Loss: 0.530 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.6853625774383545
Epoch: 5, Steps: 13 | Train Loss: 0.500 Vali Loss: 1.005 Vali Acc: 0.444 Test Loss: 1.005 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.185835838317871
Epoch: 6, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.130 Vali Acc: 0.456 Test Loss: 1.130 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.519684314727783
Epoch: 7, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.204 Vali Acc: 0.450 Test Loss: 1.204 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.35791540145874
Epoch: 8, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.357 Vali Acc: 0.500 Test Loss: 1.357 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.464789628982544
Epoch: 9, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.607 Vali Acc: 0.489 Test Loss: 1.607 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.109870433807373
Epoch: 10, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.504 Vali Acc: 0.506 Test Loss: 1.504 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.984476089477539
Epoch: 11, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.599 Vali Acc: 0.478 Test Loss: 1.599 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.101613521575928
Epoch: 12, Steps: 13 | Train Loss: 0.131 Vali Loss: 1.743 Vali Acc: 0.489 Test Loss: 1.743 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 510146
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.992717027664185
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.700 Vali Acc: 0.494 Test Loss: 0.700 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 4.295323371887207
Epoch: 2, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 4.440343856811523
Epoch: 3, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.951 Vali Acc: 0.500 Test Loss: 0.951 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.192508697509766
Epoch: 4, Steps: 13 | Train Loss: 0.703 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.543193578720093
Epoch: 5, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.788 Vali Acc: 0.517 Test Loss: 0.788 Test Acc: 0.517
Validation loss decreased (-0.499992 --> -0.516659).  Saving model ...
Epoch: 6 cost time: 4.410127878189087
Epoch: 6, Steps: 13 | Train Loss: 0.536 Vali Loss: 1.027 Vali Acc: 0.500 Test Loss: 1.027 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.222933530807495
Epoch: 7, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.776 Vali Acc: 0.578 Test Loss: 0.776 Test Acc: 0.578
Validation loss decreased (-0.516659 --> -0.577770).  Saving model ...
Epoch: 8 cost time: 4.132627487182617
Epoch: 8, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.867 Vali Acc: 0.556 Test Loss: 0.867 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.243949890136719
Epoch: 9, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.958 Vali Acc: 0.561 Test Loss: 0.958 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9246456623077393
Epoch: 10, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.308 Vali Acc: 0.528 Test Loss: 1.308 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.66591477394104
Epoch: 11, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.199 Vali Acc: 0.539 Test Loss: 1.199 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9326725006103516
Epoch: 12, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.308 Vali Acc: 0.528 Test Loss: 1.308 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.408898830413818
Epoch: 13, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.492 Vali Acc: 0.506 Test Loss: 1.492 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.939148426055908
Epoch: 14, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.499 Vali Acc: 0.517 Test Loss: 1.499 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.188319206237793
Epoch: 15, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.579 Vali Acc: 0.517 Test Loss: 1.579 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.295199871063232
Epoch: 16, Steps: 13 | Train Loss: 0.235 Vali Loss: 1.605 Vali Acc: 0.494 Test Loss: 1.605 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.21867299079895
Epoch: 17, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.777 Vali Acc: 0.500 Test Loss: 1.777 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 510146
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.315243244171143
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.727 Vali Acc: 0.489 Test Loss: 0.727 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 4.074556827545166
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.719 Vali Acc: 0.522 Test Loss: 0.719 Test Acc: 0.522
Validation loss decreased (-0.488882 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 3.61409068107605
Epoch: 3, Steps: 13 | Train Loss: 0.831 Vali Loss: 1.328 Vali Acc: 0.500 Test Loss: 1.328 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6485583782196045
Epoch: 4, Steps: 13 | Train Loss: 0.869 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
Validation loss decreased (-0.522215 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 3.7613518238067627
Epoch: 5, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.675 Vali Acc: 0.544 Test Loss: 0.675 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8869376182556152
Epoch: 6, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.865 Vali Acc: 0.533 Test Loss: 0.865 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8003451824188232
Epoch: 7, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.770 Vali Acc: 0.544 Test Loss: 0.770 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.9960811138153076
Epoch: 8, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.787 Vali Acc: 0.544 Test Loss: 0.787 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.111250638961792
Epoch: 9, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.798 Vali Acc: 0.494 Test Loss: 0.798 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.811976432800293
Epoch: 10, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.954 Vali Acc: 0.528 Test Loss: 0.954 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.103067398071289
Epoch: 11, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.813 Vali Acc: 0.572 Test Loss: 0.813 Test Acc: 0.572
Validation loss decreased (-0.549993 --> -0.572214).  Saving model ...
Epoch: 12 cost time: 3.8999435901641846
Epoch: 12, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.857 Vali Acc: 0.550 Test Loss: 0.857 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.5196754932403564
Epoch: 13, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.953 Vali Acc: 0.556 Test Loss: 0.953 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.316476345062256
Epoch: 14, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.803 Vali Acc: 0.556 Test Loss: 0.803 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.443178653717041
Epoch: 15, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.854 Vali Acc: 0.528 Test Loss: 0.854 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.196367263793945
Epoch: 16, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.859 Vali Acc: 0.511 Test Loss: 0.859 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.18994665145874
Epoch: 17, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.801 Vali Acc: 0.511 Test Loss: 0.801 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.9251604080200195
Epoch: 18, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.926 Vali Acc: 0.494 Test Loss: 0.926 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.1739583015441895
Epoch: 19, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.886 Vali Acc: 0.511 Test Loss: 0.886 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.72495698928833
Epoch: 20, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.928 Vali Acc: 0.506 Test Loss: 0.928 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.901801586151123
Epoch: 21, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.970 Vali Acc: 0.561 Test Loss: 0.970 Test Acc: 0.561
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 510146
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.227080821990967
Epoch: 1, Steps: 13 | Train Loss: 0.790 Vali Loss: 0.735 Vali Acc: 0.494 Test Loss: 0.735 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 4.694603204727173
Epoch: 2, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.762 Vali Acc: 0.511 Test Loss: 0.762 Test Acc: 0.511
Validation loss decreased (-0.494437 --> -0.511103).  Saving model ...
Epoch: 3 cost time: 4.434799432754517
Epoch: 3, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.760 Vali Acc: 0.511 Test Loss: 0.760 Test Acc: 0.511
Validation loss decreased (-0.511103 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 4.140881538391113
Epoch: 4, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.884 Vali Acc: 0.539 Test Loss: 0.884 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538880).  Saving model ...
Epoch: 5 cost time: 4.374990940093994
Epoch: 5, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.903 Vali Acc: 0.483 Test Loss: 0.903 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.896886110305786
Epoch: 6, Steps: 13 | Train Loss: 0.373 Vali Loss: 1.000 Vali Acc: 0.494 Test Loss: 1.000 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.008275985717773
Epoch: 7, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.050837278366089
Epoch: 8, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.223 Vali Acc: 0.511 Test Loss: 1.223 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.9559974670410156
Epoch: 9, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.394 Vali Acc: 0.494 Test Loss: 1.394 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.9871976375579834
Epoch: 10, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.352 Vali Acc: 0.511 Test Loss: 1.352 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.365589141845703
Epoch: 11, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.753 Vali Acc: 0.533 Test Loss: 1.753 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.9706618785858154
Epoch: 12, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.687 Vali Acc: 0.522 Test Loss: 1.687 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.236036539077759
Epoch: 13, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.962 Vali Acc: 0.472 Test Loss: 1.962 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.388268709182739
Epoch: 14, Steps: 13 | Train Loss: 0.036 Vali Loss: 2.016 Vali Acc: 0.483 Test Loss: 2.016 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 313538
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.190211057662964
Epoch: 1, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.734 Vali Acc: 0.506 Test Loss: 0.734 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 4.410438537597656
Epoch: 2, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.742 Vali Acc: 0.494 Test Loss: 0.742 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.615702867507935
Epoch: 3, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.446279048919678
Epoch: 4, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.869 Vali Acc: 0.539 Test Loss: 0.869 Test Acc: 0.539
Validation loss decreased (-0.505548 --> -0.538880).  Saving model ...
Epoch: 5 cost time: 4.323580265045166
Epoch: 5, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.941 Vali Acc: 0.489 Test Loss: 0.941 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.001995086669922
Epoch: 6, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.099 Vali Acc: 0.483 Test Loss: 1.099 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.320806980133057
Epoch: 7, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.067 Vali Acc: 0.511 Test Loss: 1.067 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.030112266540527
Epoch: 8, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.277 Vali Acc: 0.483 Test Loss: 1.277 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.8915352821350098
Epoch: 9, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.383 Vali Acc: 0.478 Test Loss: 1.383 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.903766393661499
Epoch: 10, Steps: 13 | Train Loss: 0.202 Vali Loss: 1.388 Vali Acc: 0.528 Test Loss: 1.388 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.037822484970093
Epoch: 11, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.934 Vali Acc: 0.567 Test Loss: 1.934 Test Acc: 0.567
Validation loss decreased (-0.538880 --> -0.566647).  Saving model ...
Epoch: 12 cost time: 3.9040942192077637
Epoch: 12, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.674 Vali Acc: 0.511 Test Loss: 1.674 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.249006271362305
Epoch: 13, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.842 Vali Acc: 0.494 Test Loss: 1.842 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.062248945236206
Epoch: 14, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.954 Vali Acc: 0.500 Test Loss: 1.954 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.151641130447388
Epoch: 15, Steps: 13 | Train Loss: 0.028 Vali Loss: 2.089 Vali Acc: 0.500 Test Loss: 2.089 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.024291276931763
Epoch: 16, Steps: 13 | Train Loss: 0.023 Vali Loss: 2.136 Vali Acc: 0.511 Test Loss: 2.136 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.547256231307983
Epoch: 17, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.319 Vali Acc: 0.500 Test Loss: 2.319 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.28711724281311
Epoch: 18, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.412 Vali Acc: 0.467 Test Loss: 2.412 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.147049427032471
Epoch: 19, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.347 Vali Acc: 0.494 Test Loss: 2.347 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.204217910766602
Epoch: 20, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.384 Vali Acc: 0.478 Test Loss: 2.384 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.1317408084869385
Epoch: 21, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.437 Vali Acc: 0.478 Test Loss: 2.437 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 313538
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.434963941574097
Epoch: 1, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.740 Vali Acc: 0.511 Test Loss: 0.740 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 4.299043893814087
Epoch: 2, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.350218296051025
Epoch: 3, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.729 Vali Acc: 0.517 Test Loss: 0.729 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 4.5850653648376465
Epoch: 4, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.868 Vali Acc: 0.567 Test Loss: 0.868 Test Acc: 0.567
Validation loss decreased (-0.516659 --> -0.566658).  Saving model ...
Epoch: 5 cost time: 4.515354156494141
Epoch: 5, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.846 Vali Acc: 0.494 Test Loss: 0.846 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.370911121368408
Epoch: 6, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.970 Vali Acc: 0.472 Test Loss: 0.970 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.177077293395996
Epoch: 7, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.050 Vali Acc: 0.528 Test Loss: 1.050 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.398357391357422
Epoch: 8, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.141 Vali Acc: 0.489 Test Loss: 1.141 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.1444056034088135
Epoch: 9, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.304 Vali Acc: 0.472 Test Loss: 1.304 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.372318506240845
Epoch: 10, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.340 Vali Acc: 0.533 Test Loss: 1.340 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.081143379211426
Epoch: 11, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.542 Vali Acc: 0.517 Test Loss: 1.542 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.994523286819458
Epoch: 12, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.611 Vali Acc: 0.517 Test Loss: 1.611 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.830300807952881
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.874 Vali Acc: 0.517 Test Loss: 1.874 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.087020635604858
Epoch: 14, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.904 Vali Acc: 0.522 Test Loss: 1.904 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 313538
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.004533290863037
Epoch: 1, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.747 Vali Acc: 0.544 Test Loss: 0.747 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 3.9494166374206543
Epoch: 2, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.761 Vali Acc: 0.478 Test Loss: 0.761 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.2811384201049805
Epoch: 3, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.780 Vali Acc: 0.511 Test Loss: 0.780 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.404433250427246
Epoch: 4, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.811 Vali Acc: 0.517 Test Loss: 0.811 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.268331050872803
Epoch: 5, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.933 Vali Acc: 0.500 Test Loss: 0.933 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.282498598098755
Epoch: 6, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.105 Vali Acc: 0.506 Test Loss: 1.105 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.523303747177124
Epoch: 7, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.988 Vali Acc: 0.556 Test Loss: 0.988 Test Acc: 0.556
Validation loss decreased (-0.544437 --> -0.555546).  Saving model ...
Epoch: 8 cost time: 4.52694296836853
Epoch: 8, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.05193829536438
Epoch: 9, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9309611320495605
Epoch: 10, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.348 Vali Acc: 0.483 Test Loss: 1.348 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.539844751358032
Epoch: 11, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.618 Vali Acc: 0.517 Test Loss: 1.618 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.26345419883728
Epoch: 12, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.599 Vali Acc: 0.511 Test Loss: 1.599 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.203679800033569
Epoch: 13, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.678 Vali Acc: 0.511 Test Loss: 1.678 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.08001184463501
Epoch: 14, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.834 Vali Acc: 0.522 Test Loss: 1.834 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.427638053894043
Epoch: 15, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.960 Vali Acc: 0.489 Test Loss: 1.960 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.25546407699585
Epoch: 16, Steps: 13 | Train Loss: 0.027 Vali Loss: 2.206 Vali Acc: 0.500 Test Loss: 2.206 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.470245599746704
Epoch: 17, Steps: 13 | Train Loss: 0.019 Vali Loss: 2.045 Vali Acc: 0.489 Test Loss: 2.045 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 313538
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.517618656158447
Epoch: 1, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.743 Vali Acc: 0.533 Test Loss: 0.743 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 4.4773781299591064
Epoch: 2, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.724 Vali Acc: 0.511 Test Loss: 0.724 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.725100755691528
Epoch: 3, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.771 Vali Acc: 0.511 Test Loss: 0.771 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.471357822418213
Epoch: 4, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.927 Vali Acc: 0.528 Test Loss: 0.927 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.411484241485596
Epoch: 5, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.941 Vali Acc: 0.517 Test Loss: 0.941 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.253239393234253
Epoch: 6, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.081 Vali Acc: 0.528 Test Loss: 1.081 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.9758193492889404
Epoch: 7, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.077 Vali Acc: 0.556 Test Loss: 1.077 Test Acc: 0.556
Validation loss decreased (-0.533326 --> -0.555545).  Saving model ...
Epoch: 8 cost time: 3.6474833488464355
Epoch: 8, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.185 Vali Acc: 0.544 Test Loss: 1.185 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9906625747680664
Epoch: 9, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.326 Vali Acc: 0.539 Test Loss: 1.326 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.866203546524048
Epoch: 10, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.428 Vali Acc: 0.522 Test Loss: 1.428 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.112041473388672
Epoch: 11, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.564 Vali Acc: 0.544 Test Loss: 1.564 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.039831638336182
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.737 Vali Acc: 0.522 Test Loss: 1.737 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.991894483566284
Epoch: 13, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.937 Vali Acc: 0.544 Test Loss: 1.937 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.075782775878906
Epoch: 14, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.927 Vali Acc: 0.556 Test Loss: 1.927 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.261029243469238
Epoch: 15, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.995 Vali Acc: 0.550 Test Loss: 1.995 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.220029354095459
Epoch: 16, Steps: 13 | Train Loss: 0.019 Vali Loss: 2.069 Vali Acc: 0.544 Test Loss: 2.069 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.712335824966431
Epoch: 17, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.204 Vali Acc: 0.528 Test Loss: 2.204 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 313538
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.113789081573486
Epoch: 1, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.5590600967407227
Epoch: 2, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.726 Vali Acc: 0.528 Test Loss: 0.726 Test Acc: 0.528
Validation loss decreased (-0.499992 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 3.711853504180908
Epoch: 3, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.753 Vali Acc: 0.544 Test Loss: 0.753 Test Acc: 0.544
Validation loss decreased (-0.527771 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 3.9212727546691895
Epoch: 4, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.889 Vali Acc: 0.522 Test Loss: 0.889 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.963102340698242
Epoch: 5, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.991 Vali Acc: 0.511 Test Loss: 0.991 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.241743326187134
Epoch: 6, Steps: 13 | Train Loss: 0.438 Vali Loss: 1.198 Vali Acc: 0.528 Test Loss: 1.198 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.28229832649231
Epoch: 7, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.990 Vali Acc: 0.528 Test Loss: 0.990 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.105018377304077
Epoch: 8, Steps: 13 | Train Loss: 0.292 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.949660539627075
Epoch: 9, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.387 Vali Acc: 0.489 Test Loss: 1.387 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.508026838302612
Epoch: 10, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.429 Vali Acc: 0.539 Test Loss: 1.429 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.308915376663208
Epoch: 11, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.399 Vali Acc: 0.539 Test Loss: 1.399 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.343612432479858
Epoch: 12, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.565 Vali Acc: 0.528 Test Loss: 1.565 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.8403356075286865
Epoch: 13, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.702 Vali Acc: 0.500 Test Loss: 1.702 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 313538
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.048200845718384
Epoch: 1, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.747 Vali Acc: 0.489 Test Loss: 0.747 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 3.775235652923584
Epoch: 2, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
Validation loss decreased (-0.488881 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 3.900799036026001
Epoch: 3, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.831 Vali Acc: 0.478 Test Loss: 0.831 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6960678100585938
Epoch: 4, Steps: 13 | Train Loss: 0.503 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9967246055603027
Epoch: 5, Steps: 13 | Train Loss: 0.608 Vali Loss: 1.117 Vali Acc: 0.500 Test Loss: 1.117 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.359806537628174
Epoch: 6, Steps: 13 | Train Loss: 0.460 Vali Loss: 1.226 Vali Acc: 0.506 Test Loss: 1.226 Test Acc: 0.506
Validation loss decreased (-0.499993 --> -0.505543).  Saving model ...
Epoch: 7 cost time: 4.244949579238892
Epoch: 7, Steps: 13 | Train Loss: 0.388 Vali Loss: 1.199 Vali Acc: 0.461 Test Loss: 1.199 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.565870046615601
Epoch: 8, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.238 Vali Acc: 0.450 Test Loss: 1.238 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.114681959152222
Epoch: 9, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.296 Vali Acc: 0.461 Test Loss: 1.296 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.518179178237915
Epoch: 10, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.382 Vali Acc: 0.450 Test Loss: 1.382 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.495975494384766
Epoch: 11, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.399 Vali Acc: 0.494 Test Loss: 1.399 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.639464378356934
Epoch: 12, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.648 Vali Acc: 0.522 Test Loss: 1.648 Test Acc: 0.522
Validation loss decreased (-0.505543 --> -0.522206).  Saving model ...
Epoch: 13 cost time: 4.013168573379517
Epoch: 13, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.846 Vali Acc: 0.483 Test Loss: 1.846 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7326812744140625
Epoch: 14, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.780 Vali Acc: 0.494 Test Loss: 1.780 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7492401599884033
Epoch: 15, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.995 Vali Acc: 0.489 Test Loss: 1.995 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.8006045818328857
Epoch: 16, Steps: 13 | Train Loss: 0.131 Vali Loss: 2.093 Vali Acc: 0.483 Test Loss: 2.093 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.895191192626953
Epoch: 17, Steps: 13 | Train Loss: 0.089 Vali Loss: 2.018 Vali Acc: 0.444 Test Loss: 2.018 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.6589243412017822
Epoch: 18, Steps: 13 | Train Loss: 0.038 Vali Loss: 2.181 Vali Acc: 0.467 Test Loss: 2.181 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.6373190879821777
Epoch: 19, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.255 Vali Acc: 0.461 Test Loss: 2.255 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.462897777557373
Epoch: 20, Steps: 13 | Train Loss: 0.020 Vali Loss: 2.297 Vali Acc: 0.467 Test Loss: 2.297 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.038193464279175
Epoch: 21, Steps: 13 | Train Loss: 0.025 Vali Loss: 2.342 Vali Acc: 0.494 Test Loss: 2.342 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.29264760017395
Epoch: 22, Steps: 13 | Train Loss: 0.020 Vali Loss: 2.340 Vali Acc: 0.494 Test Loss: 2.340 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 313538
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.4820716381073
Epoch: 1, Steps: 13 | Train Loss: 0.774 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 4.022918224334717
Epoch: 2, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 4.105057954788208
Epoch: 3, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.787 Vali Acc: 0.478 Test Loss: 0.787 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9528021812438965
Epoch: 4, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.869 Vali Acc: 0.428 Test Loss: 0.869 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6753273010253906
Epoch: 5, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.996 Vali Acc: 0.506 Test Loss: 0.996 Test Acc: 0.506
Validation loss decreased (-0.499993 --> -0.505546).  Saving model ...
Epoch: 6 cost time: 3.8560752868652344
Epoch: 6, Steps: 13 | Train Loss: 0.417 Vali Loss: 1.150 Vali Acc: 0.511 Test Loss: 1.150 Test Acc: 0.511
Validation loss decreased (-0.505546 --> -0.511100).  Saving model ...
Epoch: 7 cost time: 3.7996950149536133
Epoch: 7, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.236 Vali Acc: 0.511 Test Loss: 1.236 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.779958486557007
Epoch: 8, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.242 Vali Acc: 0.461 Test Loss: 1.242 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.047459363937378
Epoch: 9, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.341 Vali Acc: 0.444 Test Loss: 1.341 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5999703407287598
Epoch: 10, Steps: 13 | Train Loss: 0.226 Vali Loss: 1.467 Vali Acc: 0.500 Test Loss: 1.467 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.5423743724823
Epoch: 11, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.518 Vali Acc: 0.483 Test Loss: 1.518 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.6638119220733643
Epoch: 12, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.680 Vali Acc: 0.439 Test Loss: 1.680 Test Acc: 0.439
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.130425214767456
Epoch: 13, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.711 Vali Acc: 0.467 Test Loss: 1.711 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.120195388793945
Epoch: 14, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.822 Vali Acc: 0.461 Test Loss: 1.822 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.1608381271362305
Epoch: 15, Steps: 13 | Train Loss: 0.083 Vali Loss: 2.286 Vali Acc: 0.461 Test Loss: 2.286 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.139174699783325
Epoch: 16, Steps: 13 | Train Loss: 0.136 Vali Loss: 2.252 Vali Acc: 0.461 Test Loss: 2.252 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 313538
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.259831428527832
Epoch: 1, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 4.311408996582031
Epoch: 2, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.720 Vali Acc: 0.517 Test Loss: 0.720 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 3.94775128364563
Epoch: 3, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.724 Vali Acc: 0.528 Test Loss: 0.724 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527771).  Saving model ...
Epoch: 4 cost time: 3.9546732902526855
Epoch: 4, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.810 Vali Acc: 0.506 Test Loss: 0.810 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8324151039123535
Epoch: 5, Steps: 13 | Train Loss: 0.801 Vali Loss: 0.754 Vali Acc: 0.528 Test Loss: 0.754 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7610437870025635
Epoch: 6, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.995 Vali Acc: 0.511 Test Loss: 0.995 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.1391236782073975
Epoch: 7, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.778 Vali Acc: 0.561 Test Loss: 0.778 Test Acc: 0.561
Validation loss decreased (-0.527771 --> -0.561103).  Saving model ...
Epoch: 8 cost time: 3.863525390625
Epoch: 8, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.839 Vali Acc: 0.567 Test Loss: 0.839 Test Acc: 0.567
Validation loss decreased (-0.561103 --> -0.566658).  Saving model ...
Epoch: 9 cost time: 3.851928234100342
Epoch: 9, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.844 Vali Acc: 0.556 Test Loss: 0.844 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.0870795249938965
Epoch: 10, Steps: 13 | Train Loss: 0.417 Vali Loss: 1.005 Vali Acc: 0.583 Test Loss: 1.005 Test Acc: 0.583
Validation loss decreased (-0.566658 --> -0.583323).  Saving model ...
Epoch: 11 cost time: 4.215000867843628
Epoch: 11, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.125 Vali Acc: 0.550 Test Loss: 1.125 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.290113687515259
Epoch: 12, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.333 Vali Acc: 0.544 Test Loss: 1.333 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.163455963134766
Epoch: 13, Steps: 13 | Train Loss: 0.424 Vali Loss: 1.247 Vali Acc: 0.561 Test Loss: 1.247 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.079176425933838
Epoch: 14, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.296 Vali Acc: 0.589 Test Loss: 1.296 Test Acc: 0.589
Validation loss decreased (-0.583323 --> -0.588876).  Saving model ...
Epoch: 15 cost time: 4.273470640182495
Epoch: 15, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.537 Vali Acc: 0.556 Test Loss: 1.537 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.187368869781494
Epoch: 16, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.525 Vali Acc: 0.556 Test Loss: 1.525 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.427660703659058
Epoch: 17, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.640 Vali Acc: 0.533 Test Loss: 1.640 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.135281562805176
Epoch: 18, Steps: 13 | Train Loss: 0.209 Vali Loss: 1.787 Vali Acc: 0.544 Test Loss: 1.787 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.8291146755218506
Epoch: 19, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.998 Vali Acc: 0.539 Test Loss: 1.998 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.9174344539642334
Epoch: 20, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.973 Vali Acc: 0.567 Test Loss: 1.973 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6252901554107666
Epoch: 21, Steps: 13 | Train Loss: 0.191 Vali Loss: 2.050 Vali Acc: 0.561 Test Loss: 2.050 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.026203155517578
Epoch: 22, Steps: 13 | Train Loss: 0.161 Vali Loss: 2.122 Vali Acc: 0.561 Test Loss: 2.122 Test Acc: 0.561
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.077737092971802
Epoch: 23, Steps: 13 | Train Loss: 0.141 Vali Loss: 2.303 Vali Acc: 0.533 Test Loss: 2.303 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.734138250350952
Epoch: 24, Steps: 13 | Train Loss: 0.212 Vali Loss: 2.749 Vali Acc: 0.511 Test Loss: 2.749 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 313538
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.148082733154297
Epoch: 1, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.768 Vali Acc: 0.494 Test Loss: 0.768 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 4.248884677886963
Epoch: 2, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.834 Vali Acc: 0.556 Test Loss: 0.834 Test Acc: 0.556
Validation loss decreased (-0.494437 --> -0.555547).  Saving model ...
Epoch: 3 cost time: 4.281912088394165
Epoch: 3, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.763 Vali Acc: 0.550 Test Loss: 0.763 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.225217819213867
Epoch: 4, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.742 Vali Acc: 0.528 Test Loss: 0.742 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8539621829986572
Epoch: 5, Steps: 13 | Train Loss: 0.832 Vali Loss: 0.775 Vali Acc: 0.533 Test Loss: 0.775 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8687708377838135
Epoch: 6, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.785 Vali Acc: 0.539 Test Loss: 0.785 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.9132587909698486
Epoch: 7, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.793 Vali Acc: 0.517 Test Loss: 0.793 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.806304693222046
Epoch: 8, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.890 Vali Acc: 0.533 Test Loss: 0.890 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.101147174835205
Epoch: 9, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.781 Vali Acc: 0.539 Test Loss: 0.781 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.9419045448303223
Epoch: 10, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.801 Vali Acc: 0.550 Test Loss: 0.801 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.980450391769409
Epoch: 11, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.993 Vali Acc: 0.489 Test Loss: 0.993 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.8629751205444336
Epoch: 12, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.854 Vali Acc: 0.550 Test Loss: 0.854 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 313538
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.788316011428833
Epoch: 1, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.710 Vali Acc: 0.483 Test Loss: 0.710 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 4.620856523513794
Epoch: 2, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
Validation loss decreased (-0.483326 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 4.369600057601929
Epoch: 3, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.777 Vali Acc: 0.478 Test Loss: 0.777 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.385324001312256
Epoch: 4, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.845 Vali Acc: 0.500 Test Loss: 0.845 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.251867771148682
Epoch: 5, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.943 Vali Acc: 0.472 Test Loss: 0.943 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.322924613952637
Epoch: 6, Steps: 13 | Train Loss: 0.401 Vali Loss: 1.084 Vali Acc: 0.483 Test Loss: 1.084 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.480706214904785
Epoch: 7, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.142 Vali Acc: 0.483 Test Loss: 1.142 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.9857516288757324
Epoch: 8, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.256 Vali Acc: 0.556 Test Loss: 1.256 Test Acc: 0.556
Validation loss decreased (-0.499993 --> -0.555543).  Saving model ...
Epoch: 9 cost time: 4.1007630825042725
Epoch: 9, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.486 Vali Acc: 0.539 Test Loss: 1.486 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.0001630783081055
Epoch: 10, Steps: 13 | Train Loss: 0.169 Vali Loss: 1.393 Vali Acc: 0.467 Test Loss: 1.393 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8601396083831787
Epoch: 11, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.657 Vali Acc: 0.494 Test Loss: 1.657 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8602254390716553
Epoch: 12, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.654 Vali Acc: 0.461 Test Loss: 1.654 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.8200137615203857
Epoch: 13, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.860 Vali Acc: 0.517 Test Loss: 1.860 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.232414960861206
Epoch: 14, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.889 Vali Acc: 0.494 Test Loss: 1.889 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.158825635910034
Epoch: 15, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.172 Vali Acc: 0.461 Test Loss: 2.172 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.154123544692993
Epoch: 16, Steps: 13 | Train Loss: 0.030 Vali Loss: 2.203 Vali Acc: 0.489 Test Loss: 2.203 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.112550973892212
Epoch: 17, Steps: 13 | Train Loss: 0.020 Vali Loss: 2.219 Vali Acc: 0.489 Test Loss: 2.219 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.454236745834351
Epoch: 18, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.472 Vali Acc: 0.494 Test Loss: 2.472 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 215234
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.374929189682007
Epoch: 1, Steps: 13 | Train Loss: 0.769 Vali Loss: 0.706 Vali Acc: 0.489 Test Loss: 0.706 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 3.901535987854004
Epoch: 2, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
Validation loss decreased (-0.488882 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 4.069542646408081
Epoch: 3, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.782 Vali Acc: 0.494 Test Loss: 0.782 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.067591667175293
Epoch: 4, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.834 Vali Acc: 0.489 Test Loss: 0.834 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.691927433013916
Epoch: 5, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.929 Vali Acc: 0.456 Test Loss: 0.929 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.112791299819946
Epoch: 6, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.032 Vali Acc: 0.483 Test Loss: 1.032 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.012356281280518
Epoch: 7, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.232 Vali Acc: 0.511 Test Loss: 1.232 Test Acc: 0.511
Validation loss decreased (-0.499993 --> -0.511099).  Saving model ...
Epoch: 8 cost time: 3.8581953048706055
Epoch: 8, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.148 Vali Acc: 0.506 Test Loss: 1.148 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.228600978851318
Epoch: 9, Steps: 13 | Train Loss: 0.235 Vali Loss: 1.334 Vali Acc: 0.461 Test Loss: 1.334 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.343404293060303
Epoch: 10, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.334 Vali Acc: 0.517 Test Loss: 1.334 Test Acc: 0.517
Validation loss decreased (-0.511099 --> -0.516653).  Saving model ...
Epoch: 11 cost time: 4.177880525588989
Epoch: 11, Steps: 13 | Train Loss: 0.151 Vali Loss: 1.713 Vali Acc: 0.528 Test Loss: 1.713 Test Acc: 0.528
Validation loss decreased (-0.516653 --> -0.527761).  Saving model ...
Epoch: 12 cost time: 4.6241466999053955
Epoch: 12, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.697 Vali Acc: 0.506 Test Loss: 1.697 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.1077775955200195
Epoch: 13, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.682 Vali Acc: 0.478 Test Loss: 1.682 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.712335109710693
Epoch: 14, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.864 Vali Acc: 0.494 Test Loss: 1.864 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.0248918533325195
Epoch: 15, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.035 Vali Acc: 0.511 Test Loss: 2.035 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.253712892532349
Epoch: 16, Steps: 13 | Train Loss: 0.019 Vali Loss: 2.075 Vali Acc: 0.500 Test Loss: 2.075 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.147462844848633
Epoch: 17, Steps: 13 | Train Loss: 0.015 Vali Loss: 2.099 Vali Acc: 0.500 Test Loss: 2.099 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.069432258605957
Epoch: 18, Steps: 13 | Train Loss: 0.013 Vali Loss: 2.190 Vali Acc: 0.489 Test Loss: 2.190 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.222122669219971
Epoch: 19, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.262 Vali Acc: 0.489 Test Loss: 2.262 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.251421928405762
Epoch: 20, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.334 Vali Acc: 0.500 Test Loss: 2.334 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.3860039710998535
Epoch: 21, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.381 Vali Acc: 0.500 Test Loss: 2.381 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 215234
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.433020830154419
Epoch: 1, Steps: 13 | Train Loss: 0.777 Vali Loss: 0.699 Vali Acc: 0.489 Test Loss: 0.699 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 4.000282049179077
Epoch: 2, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.724 Vali Acc: 0.489 Test Loss: 0.724 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.450565576553345
Epoch: 3, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
Validation loss decreased (-0.488882 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 4.294584512710571
Epoch: 4, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.804 Vali Acc: 0.500 Test Loss: 0.804 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.165607929229736
Epoch: 5, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.882 Vali Acc: 0.483 Test Loss: 0.882 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.029242515563965
Epoch: 6, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.019 Vali Acc: 0.461 Test Loss: 1.019 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9207589626312256
Epoch: 7, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.061 Vali Acc: 0.517 Test Loss: 1.061 Test Acc: 0.517
Validation loss decreased (-0.499992 --> -0.516656).  Saving model ...
Epoch: 8 cost time: 4.29930567741394
Epoch: 8, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.347 Vali Acc: 0.539 Test Loss: 1.347 Test Acc: 0.539
Validation loss decreased (-0.516656 --> -0.538875).  Saving model ...
Epoch: 9 cost time: 4.155384540557861
Epoch: 9, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.328 Vali Acc: 0.528 Test Loss: 1.328 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.016337633132935
Epoch: 10, Steps: 13 | Train Loss: 0.163 Vali Loss: 1.356 Vali Acc: 0.522 Test Loss: 1.356 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.021052598953247
Epoch: 11, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.440 Vali Acc: 0.500 Test Loss: 1.440 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8574204444885254
Epoch: 12, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.593 Vali Acc: 0.506 Test Loss: 1.593 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.1468188762664795
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.770 Vali Acc: 0.511 Test Loss: 1.770 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.341113805770874
Epoch: 14, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.850 Vali Acc: 0.533 Test Loss: 1.850 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.8637654781341553
Epoch: 15, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.972 Vali Acc: 0.511 Test Loss: 1.972 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.244935512542725
Epoch: 16, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.052 Vali Acc: 0.511 Test Loss: 2.052 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.128853797912598
Epoch: 17, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.066 Vali Acc: 0.517 Test Loss: 2.066 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.240419864654541
Epoch: 18, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.119 Vali Acc: 0.511 Test Loss: 2.119 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 215234
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.932423830032349
Epoch: 1, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.713 Vali Acc: 0.511 Test Loss: 0.713 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 3.8696415424346924
Epoch: 2, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.735 Vali Acc: 0.506 Test Loss: 0.735 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.788145065307617
Epoch: 3, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.996701955795288
Epoch: 4, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.827 Vali Acc: 0.522 Test Loss: 0.827 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522214).  Saving model ...
Epoch: 5 cost time: 3.905435800552368
Epoch: 5, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.883 Vali Acc: 0.511 Test Loss: 0.883 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.1584789752960205
Epoch: 6, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.058 Vali Acc: 0.494 Test Loss: 1.058 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6220462322235107
Epoch: 7, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.036 Vali Acc: 0.494 Test Loss: 1.036 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.301259756088257
Epoch: 8, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.711 Vali Acc: 0.500 Test Loss: 1.711 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.840187311172485
Epoch: 9, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.408 Vali Acc: 0.528 Test Loss: 1.408 Test Acc: 0.528
Validation loss decreased (-0.522214 --> -0.527764).  Saving model ...
Epoch: 10 cost time: 4.213311195373535
Epoch: 10, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.442 Vali Acc: 0.544 Test Loss: 1.442 Test Acc: 0.544
Validation loss decreased (-0.527764 --> -0.544430).  Saving model ...
Epoch: 11 cost time: 4.1228203773498535
Epoch: 11, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.400 Vali Acc: 0.483 Test Loss: 1.400 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.356808185577393
Epoch: 12, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.583 Vali Acc: 0.506 Test Loss: 1.583 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.278148651123047
Epoch: 13, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.643 Vali Acc: 0.500 Test Loss: 1.643 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.3982110023498535
Epoch: 14, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.756 Vali Acc: 0.500 Test Loss: 1.756 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.237765312194824
Epoch: 15, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.802 Vali Acc: 0.494 Test Loss: 1.802 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.198851585388184
Epoch: 16, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.937 Vali Acc: 0.500 Test Loss: 1.937 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.181380033493042
Epoch: 17, Steps: 13 | Train Loss: 0.015 Vali Loss: 2.010 Vali Acc: 0.539 Test Loss: 2.010 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.295976400375366
Epoch: 18, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.061 Vali Acc: 0.517 Test Loss: 2.061 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.805804491043091
Epoch: 19, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.206 Vali Acc: 0.467 Test Loss: 2.206 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.182180643081665
Epoch: 20, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.282 Vali Acc: 0.511 Test Loss: 2.282 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 215234
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.671676158905029
Epoch: 1, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.710 Vali Acc: 0.556 Test Loss: 0.710 Test Acc: 0.556
Validation loss decreased (inf --> -0.555548).  Saving model ...
Epoch: 2 cost time: 4.353756904602051
Epoch: 2, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.723 Vali Acc: 0.522 Test Loss: 0.723 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.978379487991333
Epoch: 3, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.777 Vali Acc: 0.511 Test Loss: 0.777 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.127273321151733
Epoch: 4, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.859 Vali Acc: 0.517 Test Loss: 0.859 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.263673782348633
Epoch: 5, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.927 Vali Acc: 0.539 Test Loss: 0.927 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.14612078666687
Epoch: 6, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.030 Vali Acc: 0.550 Test Loss: 1.030 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.082151651382446
Epoch: 7, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.105 Vali Acc: 0.500 Test Loss: 1.105 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.919546604156494
Epoch: 8, Steps: 13 | Train Loss: 0.242 Vali Loss: 1.281 Vali Acc: 0.483 Test Loss: 1.281 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.957062244415283
Epoch: 9, Steps: 13 | Train Loss: 0.242 Vali Loss: 1.291 Vali Acc: 0.517 Test Loss: 1.291 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.8927979469299316
Epoch: 10, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.411 Vali Acc: 0.500 Test Loss: 1.411 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.9542737007141113
Epoch: 11, Steps: 13 | Train Loss: 0.102 Vali Loss: 1.541 Vali Acc: 0.500 Test Loss: 1.541 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 215234
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.914717674255371
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.711 Vali Acc: 0.478 Test Loss: 0.711 Test Acc: 0.478
Validation loss decreased (inf --> -0.477771).  Saving model ...
Epoch: 2 cost time: 4.479573011398315
Epoch: 2, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.739 Vali Acc: 0.506 Test Loss: 0.739 Test Acc: 0.506
Validation loss decreased (-0.477771 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 3.8581271171569824
Epoch: 3, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.898 Vali Acc: 0.494 Test Loss: 0.898 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.166733026504517
Epoch: 4, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.897 Vali Acc: 0.522 Test Loss: 0.897 Test Acc: 0.522
Validation loss decreased (-0.505548 --> -0.522213).  Saving model ...
Epoch: 5 cost time: 4.25960373878479
Epoch: 5, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.193143606185913
Epoch: 6, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.039 Vali Acc: 0.539 Test Loss: 1.039 Test Acc: 0.539
Validation loss decreased (-0.522213 --> -0.538879).  Saving model ...
Epoch: 7 cost time: 4.322574615478516
Epoch: 7, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.031 Vali Acc: 0.522 Test Loss: 1.031 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.019079923629761
Epoch: 8, Steps: 13 | Train Loss: 0.253 Vali Loss: 1.228 Vali Acc: 0.483 Test Loss: 1.228 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.323471784591675
Epoch: 9, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.806699514389038
Epoch: 10, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.363 Vali Acc: 0.472 Test Loss: 1.363 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.038544178009033
Epoch: 11, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.525 Vali Acc: 0.478 Test Loss: 1.525 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.009183645248413
Epoch: 12, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.732 Vali Acc: 0.500 Test Loss: 1.732 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.979485273361206
Epoch: 13, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.699 Vali Acc: 0.489 Test Loss: 1.699 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.167562484741211
Epoch: 14, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.927 Vali Acc: 0.478 Test Loss: 1.927 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.32465386390686
Epoch: 15, Steps: 13 | Train Loss: 0.032 Vali Loss: 2.017 Vali Acc: 0.506 Test Loss: 2.017 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.135464906692505
Epoch: 16, Steps: 13 | Train Loss: 0.027 Vali Loss: 2.102 Vali Acc: 0.489 Test Loss: 2.102 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 215234
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.687903642654419
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.711 Vali Acc: 0.506 Test Loss: 0.711 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 4.208156585693359
Epoch: 2, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.768 Vali Acc: 0.483 Test Loss: 0.768 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.047365427017212
Epoch: 3, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.977 Vali Acc: 0.472 Test Loss: 0.977 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9875612258911133
Epoch: 4, Steps: 13 | Train Loss: 0.553 Vali Loss: 1.056 Vali Acc: 0.461 Test Loss: 1.056 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6842024326324463
Epoch: 5, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.990 Vali Acc: 0.472 Test Loss: 0.990 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9711062908172607
Epoch: 6, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.060 Vali Acc: 0.483 Test Loss: 1.060 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.7301979064941406
Epoch: 7, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.138 Vali Acc: 0.456 Test Loss: 1.138 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.4955124855041504
Epoch: 8, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.411 Vali Acc: 0.511 Test Loss: 1.411 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511097).  Saving model ...
Epoch: 9 cost time: 3.5552093982696533
Epoch: 9, Steps: 13 | Train Loss: 0.363 Vali Loss: 1.348 Vali Acc: 0.517 Test Loss: 1.348 Test Acc: 0.517
Validation loss decreased (-0.511097 --> -0.516653).  Saving model ...
Epoch: 10 cost time: 3.576831817626953
Epoch: 10, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.353 Vali Acc: 0.489 Test Loss: 1.353 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.784811019897461
Epoch: 11, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.454 Vali Acc: 0.461 Test Loss: 1.454 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9545769691467285
Epoch: 12, Steps: 13 | Train Loss: 0.161 Vali Loss: 1.471 Vali Acc: 0.472 Test Loss: 1.471 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.69281005859375
Epoch: 13, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.566 Vali Acc: 0.461 Test Loss: 1.566 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.9935824871063232
Epoch: 14, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.676 Vali Acc: 0.494 Test Loss: 1.676 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.000168085098267
Epoch: 15, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.697 Vali Acc: 0.478 Test Loss: 1.697 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.8051095008850098
Epoch: 16, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.734 Vali Acc: 0.489 Test Loss: 1.734 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.76842999458313
Epoch: 17, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.912 Vali Acc: 0.483 Test Loss: 1.912 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.931706428527832
Epoch: 18, Steps: 13 | Train Loss: 0.057 Vali Loss: 2.108 Vali Acc: 0.472 Test Loss: 2.108 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.5498833656311035
Epoch: 19, Steps: 13 | Train Loss: 0.068 Vali Loss: 2.073 Vali Acc: 0.500 Test Loss: 2.073 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 215234
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.880140066146851
Epoch: 1, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.704 Vali Acc: 0.483 Test Loss: 0.704 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 3.893609046936035
Epoch: 2, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.716 Vali Acc: 0.472 Test Loss: 0.716 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.035182476043701
Epoch: 3, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.914 Vali Acc: 0.483 Test Loss: 0.914 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.885509490966797
Epoch: 4, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.927 Vali Acc: 0.472 Test Loss: 0.927 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.8255460262298584
Epoch: 5, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.926 Vali Acc: 0.489 Test Loss: 0.926 Test Acc: 0.489
Validation loss decreased (-0.483326 --> -0.488880).  Saving model ...
Epoch: 6 cost time: 4.124305963516235
Epoch: 6, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.998 Vali Acc: 0.478 Test Loss: 0.998 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.13549542427063
Epoch: 7, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.145 Vali Acc: 0.489 Test Loss: 1.145 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.055083274841309
Epoch: 8, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.577 Vali Acc: 0.478 Test Loss: 1.577 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.2886803150177
Epoch: 9, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.535 Vali Acc: 0.478 Test Loss: 1.535 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.244084596633911
Epoch: 10, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.662 Vali Acc: 0.461 Test Loss: 1.662 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.829915761947632
Epoch: 11, Steps: 13 | Train Loss: 0.214 Vali Loss: 1.696 Vali Acc: 0.467 Test Loss: 1.696 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.074856519699097
Epoch: 12, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.628 Vali Acc: 0.472 Test Loss: 1.628 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.05046534538269
Epoch: 13, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.821 Vali Acc: 0.450 Test Loss: 1.821 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.7877235412597656
Epoch: 14, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.793 Vali Acc: 0.450 Test Loss: 1.793 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.9012041091918945
Epoch: 15, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.983 Vali Acc: 0.444 Test Loss: 1.983 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.4888888888888889
model parameter : 215234
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.299111604690552
Epoch: 1, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.696 Vali Acc: 0.506 Test Loss: 0.696 Test Acc: 0.506
Validation loss decreased (inf --> -0.505549).  Saving model ...
Epoch: 2 cost time: 4.2663493156433105
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.264580011367798
Epoch: 3, Steps: 13 | Train Loss: 0.795 Vali Loss: 1.035 Vali Acc: 0.500 Test Loss: 1.035 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.181482315063477
Epoch: 4, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.985 Vali Acc: 0.500 Test Loss: 0.985 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.137085676193237
Epoch: 5, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.827 Vali Acc: 0.494 Test Loss: 0.827 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.1501922607421875
Epoch: 6, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.718 Vali Acc: 0.572 Test Loss: 0.718 Test Acc: 0.572
Validation loss decreased (-0.505549 --> -0.572215).  Saving model ...
Epoch: 7 cost time: 4.1896185874938965
Epoch: 7, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.741 Vali Acc: 0.561 Test Loss: 0.741 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.073156118392944
Epoch: 8, Steps: 13 | Train Loss: 0.516 Vali Loss: 1.066 Vali Acc: 0.522 Test Loss: 1.066 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.143725633621216
Epoch: 9, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.874 Vali Acc: 0.544 Test Loss: 0.874 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8200716972351074
Epoch: 10, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.900 Vali Acc: 0.572 Test Loss: 0.900 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.8665273189544678
Epoch: 11, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.004 Vali Acc: 0.544 Test Loss: 1.004 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.730287551879883
Epoch: 12, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.144 Vali Acc: 0.550 Test Loss: 1.144 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.8003509044647217
Epoch: 13, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.148 Vali Acc: 0.578 Test Loss: 1.148 Test Acc: 0.578
Validation loss decreased (-0.572215 --> -0.577766).  Saving model ...
Epoch: 14 cost time: 3.5789003372192383
Epoch: 14, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.290 Vali Acc: 0.556 Test Loss: 1.290 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5984184741973877
Epoch: 15, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.536 Vali Acc: 0.544 Test Loss: 1.536 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.522115468978882
Epoch: 16, Steps: 13 | Train Loss: 0.214 Vali Loss: 1.504 Vali Acc: 0.511 Test Loss: 1.504 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.593515634536743
Epoch: 17, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.601 Vali Acc: 0.556 Test Loss: 1.601 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.673506736755371
Epoch: 18, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.730 Vali Acc: 0.533 Test Loss: 1.730 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.896963357925415
Epoch: 19, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.818 Vali Acc: 0.539 Test Loss: 1.818 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.000071287155151
Epoch: 20, Steps: 13 | Train Loss: 0.147 Vali Loss: 2.037 Vali Acc: 0.528 Test Loss: 2.037 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.965602159500122
Epoch: 21, Steps: 13 | Train Loss: 0.151 Vali Loss: 2.102 Vali Acc: 0.539 Test Loss: 2.102 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.05806303024292
Epoch: 22, Steps: 13 | Train Loss: 0.213 Vali Loss: 2.177 Vali Acc: 0.533 Test Loss: 2.177 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.7682316303253174
Epoch: 23, Steps: 13 | Train Loss: 0.103 Vali Loss: 2.273 Vali Acc: 0.544 Test Loss: 2.273 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 215234
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.167134523391724
Epoch: 1, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.9022305011749268
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.762 Vali Acc: 0.544 Test Loss: 0.762 Test Acc: 0.544
Validation loss decreased (-0.499993 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 3.7410759925842285
Epoch: 3, Steps: 13 | Train Loss: 0.760 Vali Loss: 1.050 Vali Acc: 0.506 Test Loss: 1.050 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6974520683288574
Epoch: 4, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.946 Vali Acc: 0.517 Test Loss: 0.946 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.909569263458252
Epoch: 5, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.907 Vali Acc: 0.511 Test Loss: 0.907 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8425981998443604
Epoch: 6, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.751 Vali Acc: 0.533 Test Loss: 0.751 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.586947441101074
Epoch: 7, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.710 Vali Acc: 0.561 Test Loss: 0.710 Test Acc: 0.561
Validation loss decreased (-0.544437 --> -0.561104).  Saving model ...
Epoch: 8 cost time: 3.7710280418395996
Epoch: 8, Steps: 13 | Train Loss: 0.662 Vali Loss: 1.028 Vali Acc: 0.517 Test Loss: 1.028 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.828927755355835
Epoch: 9, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.881 Vali Acc: 0.528 Test Loss: 0.881 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.240854501724243
Epoch: 10, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.751 Vali Acc: 0.572 Test Loss: 0.751 Test Acc: 0.572
Validation loss decreased (-0.561104 --> -0.572215).  Saving model ...
Epoch: 11 cost time: 3.9260573387145996
Epoch: 11, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.758 Vali Acc: 0.550 Test Loss: 0.758 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.948711633682251
Epoch: 12, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.931 Vali Acc: 0.544 Test Loss: 0.931 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.065994739532471
Epoch: 13, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.804 Vali Acc: 0.583 Test Loss: 0.804 Test Acc: 0.583
Validation loss decreased (-0.572215 --> -0.583325).  Saving model ...
Epoch: 14 cost time: 4.081030607223511
Epoch: 14, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.837 Vali Acc: 0.578 Test Loss: 0.837 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.041572093963623
Epoch: 15, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.891 Vali Acc: 0.550 Test Loss: 0.891 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.9770381450653076
Epoch: 16, Steps: 13 | Train Loss: 0.569 Vali Loss: 1.067 Vali Acc: 0.522 Test Loss: 1.067 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.923607110977173
Epoch: 17, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.969 Vali Acc: 0.572 Test Loss: 0.969 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.916135787963867
Epoch: 18, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.919 Vali Acc: 0.494 Test Loss: 0.919 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.937880516052246
Epoch: 19, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.885 Vali Acc: 0.589 Test Loss: 0.885 Test Acc: 0.589
Validation loss decreased (-0.583325 --> -0.588880).  Saving model ...
Epoch: 20 cost time: 3.8447265625
Epoch: 20, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.906 Vali Acc: 0.511 Test Loss: 0.906 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7074472904205322
Epoch: 21, Steps: 13 | Train Loss: 0.568 Vali Loss: 1.058 Vali Acc: 0.539 Test Loss: 1.058 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.8179538249969482
Epoch: 22, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.882 Vali Acc: 0.550 Test Loss: 0.882 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.9226367473602295
Epoch: 23, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.922 Vali Acc: 0.561 Test Loss: 0.922 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.7330455780029297
Epoch: 24, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.922 Vali Acc: 0.550 Test Loss: 0.922 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.9937169551849365
Epoch: 25, Steps: 13 | Train Loss: 0.506 Vali Loss: 1.025 Vali Acc: 0.556 Test Loss: 1.025 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.796304941177368
Epoch: 26, Steps: 13 | Train Loss: 0.616 Vali Loss: 1.054 Vali Acc: 0.528 Test Loss: 1.054 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.810633420944214
Epoch: 27, Steps: 13 | Train Loss: 0.541 Vali Loss: 1.468 Vali Acc: 0.511 Test Loss: 1.468 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.047189235687256
Epoch: 28, Steps: 13 | Train Loss: 0.722 Vali Loss: 1.191 Vali Acc: 0.533 Test Loss: 1.191 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.8310728073120117
Epoch: 29, Steps: 13 | Train Loss: 0.686 Vali Loss: 1.152 Vali Acc: 0.522 Test Loss: 1.152 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 215234
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.321321487426758
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.732 Vali Acc: 0.506 Test Loss: 0.732 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 3.9962239265441895
Epoch: 2, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.719 Vali Acc: 0.522 Test Loss: 0.719 Test Acc: 0.522
Validation loss decreased (-0.505548 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 4.118027687072754
Epoch: 3, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.756 Vali Acc: 0.522 Test Loss: 0.756 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9379189014434814
Epoch: 4, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.817 Vali Acc: 0.489 Test Loss: 0.817 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.092224836349487
Epoch: 5, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.914 Vali Acc: 0.494 Test Loss: 0.914 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.136857271194458
Epoch: 6, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.070 Vali Acc: 0.522 Test Loss: 1.070 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.120373487472534
Epoch: 7, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.338 Vali Acc: 0.556 Test Loss: 1.338 Test Acc: 0.556
Validation loss decreased (-0.522215 --> -0.555542).  Saving model ...
Epoch: 8 cost time: 4.115278005599976
Epoch: 8, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.197 Vali Acc: 0.533 Test Loss: 1.197 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.2855305671691895
Epoch: 9, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.238 Vali Acc: 0.483 Test Loss: 1.238 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.3560075759887695
Epoch: 10, Steps: 13 | Train Loss: 0.168 Vali Loss: 1.416 Vali Acc: 0.428 Test Loss: 1.416 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.225947141647339
Epoch: 11, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.501 Vali Acc: 0.467 Test Loss: 1.501 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.589743137359619
Epoch: 12, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.530 Vali Acc: 0.467 Test Loss: 1.530 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.163438081741333
Epoch: 13, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.747 Vali Acc: 0.461 Test Loss: 1.747 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.247112274169922
Epoch: 14, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.913 Vali Acc: 0.539 Test Loss: 1.913 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.001621961593628
Epoch: 15, Steps: 13 | Train Loss: 0.099 Vali Loss: 2.216 Vali Acc: 0.556 Test Loss: 2.216 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.210179805755615
Epoch: 16, Steps: 13 | Train Loss: 0.084 Vali Loss: 2.295 Vali Acc: 0.533 Test Loss: 2.295 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.00630259513855
Epoch: 17, Steps: 13 | Train Loss: 0.036 Vali Loss: 2.284 Vali Acc: 0.517 Test Loss: 2.284 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 166082
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.954857349395752
Epoch: 1, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.746 Vali Acc: 0.506 Test Loss: 0.746 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 3.82279372215271
Epoch: 2, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7301721572875977
Epoch: 3, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.765 Vali Acc: 0.506 Test Loss: 0.765 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7976555824279785
Epoch: 4, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.825 Vali Acc: 0.506 Test Loss: 0.825 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9843180179595947
Epoch: 5, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.892 Vali Acc: 0.517 Test Loss: 0.892 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516658).  Saving model ...
Epoch: 6 cost time: 3.994567394256592
Epoch: 6, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.118 Vali Acc: 0.528 Test Loss: 1.118 Test Acc: 0.528
Validation loss decreased (-0.516658 --> -0.527767).  Saving model ...
Epoch: 7 cost time: 3.974273204803467
Epoch: 7, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.400 Vali Acc: 0.572 Test Loss: 1.400 Test Acc: 0.572
Validation loss decreased (-0.527767 --> -0.572208).  Saving model ...
Epoch: 8 cost time: 4.00439190864563
Epoch: 8, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.178 Vali Acc: 0.556 Test Loss: 1.178 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.23521614074707
Epoch: 9, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.248 Vali Acc: 0.506 Test Loss: 1.248 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.060885667800903
Epoch: 10, Steps: 13 | Train Loss: 0.163 Vali Loss: 1.449 Vali Acc: 0.483 Test Loss: 1.449 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7918944358825684
Epoch: 11, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.425 Vali Acc: 0.472 Test Loss: 1.425 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.7710185050964355
Epoch: 12, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.591 Vali Acc: 0.517 Test Loss: 1.591 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.9050374031066895
Epoch: 13, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.649 Vali Acc: 0.483 Test Loss: 1.649 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.8605451583862305
Epoch: 14, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.942 Vali Acc: 0.528 Test Loss: 1.942 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.050509691238403
Epoch: 15, Steps: 13 | Train Loss: 0.058 Vali Loss: 2.052 Vali Acc: 0.522 Test Loss: 2.052 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.5143959522247314
Epoch: 16, Steps: 13 | Train Loss: 0.042 Vali Loss: 2.490 Vali Acc: 0.556 Test Loss: 2.490 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.9924092292785645
Epoch: 17, Steps: 13 | Train Loss: 0.029 Vali Loss: 2.322 Vali Acc: 0.511 Test Loss: 2.322 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 166082
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.766131639480591
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.743 Vali Acc: 0.494 Test Loss: 0.743 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 4.268882513046265
Epoch: 2, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.730 Vali Acc: 0.533 Test Loss: 0.730 Test Acc: 0.533
Validation loss decreased (-0.494437 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 4.133625745773315
Epoch: 3, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.749 Vali Acc: 0.506 Test Loss: 0.749 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.256046533584595
Epoch: 4, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.801 Vali Acc: 0.494 Test Loss: 0.801 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.43498682975769
Epoch: 5, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.886 Vali Acc: 0.494 Test Loss: 0.886 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.7498795986175537
Epoch: 6, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.089 Vali Acc: 0.528 Test Loss: 1.089 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.692288875579834
Epoch: 7, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.202 Vali Acc: 0.544 Test Loss: 1.202 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544432).  Saving model ...
Epoch: 8 cost time: 4.117984294891357
Epoch: 8, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.084 Vali Acc: 0.506 Test Loss: 1.084 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.155565500259399
Epoch: 9, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.180 Vali Acc: 0.494 Test Loss: 1.180 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.367814540863037
Epoch: 10, Steps: 13 | Train Loss: 0.160 Vali Loss: 1.288 Vali Acc: 0.511 Test Loss: 1.288 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.810741424560547
Epoch: 11, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.458 Vali Acc: 0.494 Test Loss: 1.458 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8687798976898193
Epoch: 12, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.501 Vali Acc: 0.483 Test Loss: 1.501 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.254851579666138
Epoch: 13, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.656 Vali Acc: 0.483 Test Loss: 1.656 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.417001247406006
Epoch: 14, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.735 Vali Acc: 0.506 Test Loss: 1.735 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.339567422866821
Epoch: 15, Steps: 13 | Train Loss: 0.109 Vali Loss: 2.110 Vali Acc: 0.511 Test Loss: 2.110 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.122795581817627
Epoch: 16, Steps: 13 | Train Loss: 0.113 Vali Loss: 2.114 Vali Acc: 0.483 Test Loss: 2.114 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.947774648666382
Epoch: 17, Steps: 13 | Train Loss: 0.028 Vali Loss: 2.316 Vali Acc: 0.511 Test Loss: 2.316 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 166082
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.300203800201416
Epoch: 1, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.739 Vali Acc: 0.522 Test Loss: 0.739 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 4.198266983032227
Epoch: 2, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.716 Vali Acc: 0.544 Test Loss: 0.716 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 4.274166107177734
Epoch: 3, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.760 Vali Acc: 0.556 Test Loss: 0.760 Test Acc: 0.556
Validation loss decreased (-0.544437 --> -0.555548).  Saving model ...
Epoch: 4 cost time: 4.6797707080841064
Epoch: 4, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.811 Vali Acc: 0.539 Test Loss: 0.811 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.485412120819092
Epoch: 5, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.857 Vali Acc: 0.528 Test Loss: 0.857 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.008147954940796
Epoch: 6, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.025 Vali Acc: 0.539 Test Loss: 1.025 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.61311411857605
Epoch: 7, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.251 Vali Acc: 0.533 Test Loss: 1.251 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.0932745933532715
Epoch: 8, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.075 Vali Acc: 0.544 Test Loss: 1.075 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.103328227996826
Epoch: 9, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.144 Vali Acc: 0.517 Test Loss: 1.144 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.589503049850464
Epoch: 10, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.253 Vali Acc: 0.506 Test Loss: 1.253 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.618106126785278
Epoch: 11, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.452 Vali Acc: 0.511 Test Loss: 1.452 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.520941257476807
Epoch: 12, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.431 Vali Acc: 0.517 Test Loss: 1.431 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.619304656982422
Epoch: 13, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.634 Vali Acc: 0.478 Test Loss: 1.634 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 166082
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.854205131530762
Epoch: 1, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.786695957183838
Epoch: 2, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.729 Vali Acc: 0.539 Test Loss: 0.729 Test Acc: 0.539
Validation loss decreased (-0.499993 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 3.769362449645996
Epoch: 3, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.782 Vali Acc: 0.539 Test Loss: 0.782 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.756018877029419
Epoch: 4, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.826 Vali Acc: 0.539 Test Loss: 0.826 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.62861704826355
Epoch: 5, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.916 Vali Acc: 0.517 Test Loss: 0.916 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.6666879653930664
Epoch: 6, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.140 Vali Acc: 0.528 Test Loss: 1.140 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.012500762939453
Epoch: 7, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.489 Vali Acc: 0.528 Test Loss: 1.489 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.369717597961426
Epoch: 8, Steps: 13 | Train Loss: 0.411 Vali Loss: 1.235 Vali Acc: 0.533 Test Loss: 1.235 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.439161062240601
Epoch: 9, Steps: 13 | Train Loss: 0.222 Vali Loss: 1.262 Vali Acc: 0.528 Test Loss: 1.262 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.9360406398773193
Epoch: 10, Steps: 13 | Train Loss: 0.178 Vali Loss: 1.461 Vali Acc: 0.533 Test Loss: 1.461 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.37698769569397
Epoch: 11, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.417 Vali Acc: 0.528 Test Loss: 1.417 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.1824867725372314
Epoch: 12, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.503 Vali Acc: 0.533 Test Loss: 1.503 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 166082
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.042878150939941
Epoch: 1, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.721 Vali Acc: 0.506 Test Loss: 0.721 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 3.8669955730438232
Epoch: 2, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.720 Vali Acc: 0.539 Test Loss: 0.720 Test Acc: 0.539
Validation loss decreased (-0.505548 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 3.9312329292297363
Epoch: 3, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.763 Vali Acc: 0.517 Test Loss: 0.763 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.218709707260132
Epoch: 4, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.802 Vali Acc: 0.539 Test Loss: 0.802 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.915545701980591
Epoch: 5, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.862 Vali Acc: 0.539 Test Loss: 0.862 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.9115207195281982
Epoch: 6, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.981 Vali Acc: 0.511 Test Loss: 0.981 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.32405424118042
Epoch: 7, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.379 Vali Acc: 0.483 Test Loss: 1.379 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.30751895904541
Epoch: 8, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.126 Vali Acc: 0.494 Test Loss: 1.126 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.093743562698364
Epoch: 9, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.141 Vali Acc: 0.522 Test Loss: 1.141 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.038404703140259
Epoch: 10, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.296 Vali Acc: 0.550 Test Loss: 1.296 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549987).  Saving model ...
Epoch: 11 cost time: 3.8077728748321533
Epoch: 11, Steps: 13 | Train Loss: 0.188 Vali Loss: 1.405 Vali Acc: 0.517 Test Loss: 1.405 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8729114532470703
Epoch: 12, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.423 Vali Acc: 0.522 Test Loss: 1.423 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.51642632484436
Epoch: 13, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.586 Vali Acc: 0.522 Test Loss: 1.586 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.299175262451172
Epoch: 14, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.708 Vali Acc: 0.489 Test Loss: 1.708 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.094292402267456
Epoch: 15, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.995 Vali Acc: 0.506 Test Loss: 1.995 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.7811553478240967
Epoch: 16, Steps: 13 | Train Loss: 0.064 Vali Loss: 2.068 Vali Acc: 0.506 Test Loss: 2.068 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.3942461013793945
Epoch: 17, Steps: 13 | Train Loss: 0.039 Vali Loss: 2.202 Vali Acc: 0.472 Test Loss: 2.202 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.0912744998931885
Epoch: 18, Steps: 13 | Train Loss: 0.040 Vali Loss: 2.155 Vali Acc: 0.483 Test Loss: 2.155 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.043752908706665
Epoch: 19, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.228 Vali Acc: 0.494 Test Loss: 2.228 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.004852771759033
Epoch: 20, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.185 Vali Acc: 0.522 Test Loss: 2.185 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 166082
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.818002939224243
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.706 Vali Acc: 0.467 Test Loss: 0.706 Test Acc: 0.467
Validation loss decreased (inf --> -0.466660).  Saving model ...
Epoch: 2 cost time: 4.7705090045928955
Epoch: 2, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
Validation loss decreased (-0.466660 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 4.443732738494873
Epoch: 3, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.847 Vali Acc: 0.494 Test Loss: 0.847 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.337034463882446
Epoch: 4, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.933 Vali Acc: 0.489 Test Loss: 0.933 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.3556859493255615
Epoch: 5, Steps: 13 | Train Loss: 0.470 Vali Loss: 1.031 Vali Acc: 0.472 Test Loss: 1.031 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.285774230957031
Epoch: 6, Steps: 13 | Train Loss: 0.399 Vali Loss: 1.091 Vali Acc: 0.472 Test Loss: 1.091 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.424993276596069
Epoch: 7, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.588 Vali Acc: 0.472 Test Loss: 1.588 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.18253493309021
Epoch: 8, Steps: 13 | Train Loss: 0.433 Vali Loss: 1.341 Vali Acc: 0.489 Test Loss: 1.341 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.6596858501434326
Epoch: 9, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.471 Vali Acc: 0.478 Test Loss: 1.471 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.009138107299805
Epoch: 10, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.532 Vali Acc: 0.478 Test Loss: 1.532 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.890536069869995
Epoch: 11, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.492 Vali Acc: 0.478 Test Loss: 1.492 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.175214052200317
Epoch: 12, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.547 Vali Acc: 0.472 Test Loss: 1.547 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5
model parameter : 166082
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.26378321647644
Epoch: 1, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.680 Vali Acc: 0.539 Test Loss: 0.680 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 3.992290735244751
Epoch: 2, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.708 Vali Acc: 0.528 Test Loss: 0.708 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.976958990097046
Epoch: 3, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.798 Vali Acc: 0.517 Test Loss: 0.798 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.870121717453003
Epoch: 4, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.824 Vali Acc: 0.517 Test Loss: 0.824 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.8859758377075195
Epoch: 5, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.912 Vali Acc: 0.472 Test Loss: 0.912 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.806093692779541
Epoch: 6, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.011 Vali Acc: 0.494 Test Loss: 1.011 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.902055025100708
Epoch: 7, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.449 Vali Acc: 0.500 Test Loss: 1.449 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.522972345352173
Epoch: 8, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.310 Vali Acc: 0.456 Test Loss: 1.310 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.5865542888641357
Epoch: 9, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.529 Vali Acc: 0.483 Test Loss: 1.529 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.5769095420837402
Epoch: 10, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.754 Vali Acc: 0.472 Test Loss: 1.754 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.790923833847046
Epoch: 11, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.515 Vali Acc: 0.461 Test Loss: 1.515 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 166082
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.6101250648498535
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.696 Vali Acc: 0.489 Test Loss: 0.696 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 3.5962562561035156
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.700 Vali Acc: 0.533 Test Loss: 0.700 Test Acc: 0.533
Validation loss decreased (-0.488882 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 3.6035048961639404
Epoch: 3, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.679 Vali Acc: 0.539 Test Loss: 0.679 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 4.0977513790130615
Epoch: 4, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.893 Vali Acc: 0.500 Test Loss: 0.893 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.969202995300293
Epoch: 5, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.815 Vali Acc: 0.522 Test Loss: 0.815 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.187832355499268
Epoch: 6, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.943 Vali Acc: 0.500 Test Loss: 0.943 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9262497425079346
Epoch: 7, Steps: 13 | Train Loss: 0.512 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.147531270980835
Epoch: 8, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.914 Vali Acc: 0.511 Test Loss: 0.914 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.112990856170654
Epoch: 9, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.839 Vali Acc: 0.544 Test Loss: 0.839 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544436).  Saving model ...
Epoch: 10 cost time: 4.040347576141357
Epoch: 10, Steps: 13 | Train Loss: 0.580 Vali Loss: 1.301 Vali Acc: 0.517 Test Loss: 1.301 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8950753211975098
Epoch: 11, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.913 Vali Acc: 0.561 Test Loss: 0.913 Test Acc: 0.561
Validation loss decreased (-0.544436 --> -0.561102).  Saving model ...
Epoch: 12 cost time: 4.215989828109741
Epoch: 12, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.028 Vali Acc: 0.494 Test Loss: 1.028 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8128864765167236
Epoch: 13, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.153 Vali Acc: 0.511 Test Loss: 1.153 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.027357578277588
Epoch: 14, Steps: 13 | Train Loss: 0.399 Vali Loss: 1.149 Vali Acc: 0.544 Test Loss: 1.149 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.7959117889404297
Epoch: 15, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.571 Vali Acc: 0.544 Test Loss: 1.571 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.238773345947266
Epoch: 16, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.644 Vali Acc: 0.539 Test Loss: 1.644 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.06006383895874
Epoch: 17, Steps: 13 | Train Loss: 0.236 Vali Loss: 1.607 Vali Acc: 0.511 Test Loss: 1.607 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.049688100814819
Epoch: 18, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.552 Vali Acc: 0.544 Test Loss: 1.552 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.186253070831299
Epoch: 19, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.795 Vali Acc: 0.556 Test Loss: 1.795 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.059844493865967
Epoch: 20, Steps: 13 | Train Loss: 0.240 Vali Loss: 1.639 Vali Acc: 0.589 Test Loss: 1.639 Test Acc: 0.589
Validation loss decreased (-0.561102 --> -0.588872).  Saving model ...
Epoch: 21 cost time: 4.352079629898071
Epoch: 21, Steps: 13 | Train Loss: 0.252 Vali Loss: 1.850 Vali Acc: 0.522 Test Loss: 1.850 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.329827308654785
Epoch: 22, Steps: 13 | Train Loss: 0.239 Vali Loss: 2.019 Vali Acc: 0.550 Test Loss: 2.019 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.272559404373169
Epoch: 23, Steps: 13 | Train Loss: 0.243 Vali Loss: 2.377 Vali Acc: 0.544 Test Loss: 2.377 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.024563550949097
Epoch: 24, Steps: 13 | Train Loss: 0.204 Vali Loss: 2.128 Vali Acc: 0.528 Test Loss: 2.128 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.00557017326355
Epoch: 25, Steps: 13 | Train Loss: 0.153 Vali Loss: 2.302 Vali Acc: 0.517 Test Loss: 2.302 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.914649248123169
Epoch: 26, Steps: 13 | Train Loss: 0.101 Vali Loss: 2.285 Vali Acc: 0.517 Test Loss: 2.285 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.8530938625335693
Epoch: 27, Steps: 13 | Train Loss: 0.129 Vali Loss: 2.408 Vali Acc: 0.533 Test Loss: 2.408 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.719226121902466
Epoch: 28, Steps: 13 | Train Loss: 0.139 Vali Loss: 2.485 Vali Acc: 0.544 Test Loss: 2.485 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.9501638412475586
Epoch: 29, Steps: 13 | Train Loss: 0.093 Vali Loss: 2.570 Vali Acc: 0.522 Test Loss: 2.570 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.938087224960327
Epoch: 30, Steps: 13 | Train Loss: 0.085 Vali Loss: 2.686 Vali Acc: 0.506 Test Loss: 2.686 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 166082
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.841837406158447
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.720 Vali Acc: 0.506 Test Loss: 0.720 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 4.001516342163086
Epoch: 2, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.243451118469238
Epoch: 3, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.708 Vali Acc: 0.561 Test Loss: 0.708 Test Acc: 0.561
Validation loss decreased (-0.505548 --> -0.561104).  Saving model ...
Epoch: 4 cost time: 4.257713556289673
Epoch: 4, Steps: 13 | Train Loss: 0.698 Vali Loss: 1.199 Vali Acc: 0.511 Test Loss: 1.199 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.1806042194366455
Epoch: 5, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.937 Vali Acc: 0.522 Test Loss: 0.937 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.20301079750061
Epoch: 6, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.724 Vali Acc: 0.533 Test Loss: 0.724 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.8453638553619385
Epoch: 7, Steps: 13 | Train Loss: 0.663 Vali Loss: 1.216 Vali Acc: 0.511 Test Loss: 1.216 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.9786083698272705
Epoch: 8, Steps: 13 | Train Loss: 0.858 Vali Loss: 0.830 Vali Acc: 0.506 Test Loss: 0.830 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.030665874481201
Epoch: 9, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.871 Vali Acc: 0.539 Test Loss: 0.871 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.801786184310913
Epoch: 10, Steps: 13 | Train Loss: 0.701 Vali Loss: 1.053 Vali Acc: 0.522 Test Loss: 1.053 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.5439846515655518
Epoch: 11, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.797 Vali Acc: 0.539 Test Loss: 0.797 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.819162368774414
Epoch: 12, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.908 Vali Acc: 0.533 Test Loss: 0.908 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.830932140350342
Epoch: 13, Steps: 13 | Train Loss: 0.610 Vali Loss: 1.502 Vali Acc: 0.528 Test Loss: 1.502 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 166082
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         576                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma576_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.156023979187012
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.705 Vali Acc: 0.533 Test Loss: 0.705 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 3.9932057857513428
Epoch: 2, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.771 Vali Acc: 0.539 Test Loss: 0.771 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538881).  Saving model ...
Epoch: 3 cost time: 4.3797287940979
Epoch: 3, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.3376851081848145
Epoch: 4, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.793 Vali Acc: 0.489 Test Loss: 0.793 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9144678115844727
Epoch: 5, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.848 Vali Acc: 0.483 Test Loss: 0.848 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.176774740219116
Epoch: 6, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.926 Vali Acc: 0.494 Test Loss: 0.926 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.992213249206543
Epoch: 7, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.984 Vali Acc: 0.511 Test Loss: 0.984 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.077686071395874
Epoch: 8, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.133 Vali Acc: 0.472 Test Loss: 1.133 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.965104579925537
Epoch: 9, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.158 Vali Acc: 0.506 Test Loss: 1.158 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.8135740756988525
Epoch: 10, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.295 Vali Acc: 0.511 Test Loss: 1.295 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.84274959564209
Epoch: 11, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.383 Vali Acc: 0.522 Test Loss: 1.383 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.220192909240723
Epoch: 12, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.537 Vali Acc: 0.522 Test Loss: 1.537 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma576_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 141506
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         461                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma461_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.399850606918335
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.715 Vali Acc: 0.506 Test Loss: 0.715 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 4.057495832443237
Epoch: 2, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.767 Vali Acc: 0.522 Test Loss: 0.767 Test Acc: 0.522
Validation loss decreased (-0.505548 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 4.233600378036499
Epoch: 3, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.807 Vali Acc: 0.511 Test Loss: 0.807 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.3680901527404785
Epoch: 4, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.790 Vali Acc: 0.494 Test Loss: 0.790 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.439525127410889
Epoch: 5, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.893 Vali Acc: 0.489 Test Loss: 0.893 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.183403968811035
Epoch: 6, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.922 Vali Acc: 0.511 Test Loss: 0.922 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.243964910507202
Epoch: 7, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.994 Vali Acc: 0.472 Test Loss: 0.994 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.315282106399536
Epoch: 8, Steps: 13 | Train Loss: 0.292 Vali Loss: 1.139 Vali Acc: 0.478 Test Loss: 1.139 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.362509727478027
Epoch: 9, Steps: 13 | Train Loss: 0.205 Vali Loss: 1.195 Vali Acc: 0.478 Test Loss: 1.195 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.305572271347046
Epoch: 10, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.320 Vali Acc: 0.494 Test Loss: 1.320 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.063180923461914
Epoch: 11, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.398 Vali Acc: 0.494 Test Loss: 1.398 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.24380350112915
Epoch: 12, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.605 Vali Acc: 0.483 Test Loss: 1.605 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma461_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 141506
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         346                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.334786891937256
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.707 Vali Acc: 0.494 Test Loss: 0.707 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 4.429815053939819
Epoch: 2, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.745 Vali Acc: 0.539 Test Loss: 0.745 Test Acc: 0.539
Validation loss decreased (-0.494437 --> -0.538881).  Saving model ...
Epoch: 3 cost time: 4.331082820892334
Epoch: 3, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.833 Vali Acc: 0.550 Test Loss: 0.833 Test Acc: 0.550
Validation loss decreased (-0.538881 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 4.414252758026123
Epoch: 4, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.788 Vali Acc: 0.528 Test Loss: 0.788 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.367186784744263
Epoch: 5, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.841 Vali Acc: 0.522 Test Loss: 0.841 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.268297433853149
Epoch: 6, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.910 Vali Acc: 0.539 Test Loss: 0.910 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.163730621337891
Epoch: 7, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.994 Vali Acc: 0.561 Test Loss: 0.994 Test Acc: 0.561
Validation loss decreased (-0.549992 --> -0.561101).  Saving model ...
Epoch: 8 cost time: 4.488697290420532
Epoch: 8, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.111 Vali Acc: 0.494 Test Loss: 1.111 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.184450149536133
Epoch: 9, Steps: 13 | Train Loss: 0.240 Vali Loss: 1.150 Vali Acc: 0.506 Test Loss: 1.150 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.0936503410339355
Epoch: 10, Steps: 13 | Train Loss: 0.192 Vali Loss: 1.222 Vali Acc: 0.494 Test Loss: 1.222 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.946467399597168
Epoch: 11, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.426 Vali Acc: 0.522 Test Loss: 1.426 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9434189796447754
Epoch: 12, Steps: 13 | Train Loss: 0.120 Vali Loss: 1.502 Vali Acc: 0.533 Test Loss: 1.502 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.070476055145264
Epoch: 13, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.520 Vali Acc: 0.528 Test Loss: 1.520 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.232772588729858
Epoch: 14, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.671 Vali Acc: 0.517 Test Loss: 1.671 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.188929796218872
Epoch: 15, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.848 Vali Acc: 0.500 Test Loss: 1.848 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.125695705413818
Epoch: 16, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.903 Vali Acc: 0.517 Test Loss: 1.903 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.2475481033325195
Epoch: 17, Steps: 13 | Train Loss: 0.023 Vali Loss: 2.029 Vali Acc: 0.522 Test Loss: 2.029 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 141506
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         231                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.720707893371582
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.709 Vali Acc: 0.511 Test Loss: 0.709 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 4.421689033508301
Epoch: 2, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.737 Vali Acc: 0.539 Test Loss: 0.737 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 4.382833003997803
Epoch: 3, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.787 Vali Acc: 0.522 Test Loss: 0.787 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.414631366729736
Epoch: 4, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.801 Vali Acc: 0.506 Test Loss: 0.801 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9407005310058594
Epoch: 5, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.871 Vali Acc: 0.511 Test Loss: 0.871 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.127983570098877
Epoch: 6, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.999 Vali Acc: 0.528 Test Loss: 0.999 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.104517459869385
Epoch: 7, Steps: 13 | Train Loss: 0.527 Vali Loss: 1.435 Vali Acc: 0.506 Test Loss: 1.435 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.004262208938599
Epoch: 8, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.082 Vali Acc: 0.522 Test Loss: 1.082 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.7113113403320312
Epoch: 9, Steps: 13 | Train Loss: 0.234 Vali Loss: 1.115 Vali Acc: 0.506 Test Loss: 1.115 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.916717767715454
Epoch: 10, Steps: 13 | Train Loss: 0.201 Vali Loss: 1.218 Vali Acc: 0.528 Test Loss: 1.218 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.7167539596557617
Epoch: 11, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.453 Vali Acc: 0.522 Test Loss: 1.453 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.686204433441162
Epoch: 12, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.423 Vali Acc: 0.539 Test Loss: 1.423 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 141506
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         116                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.407240629196167
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.713 Vali Acc: 0.511 Test Loss: 0.713 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 4.226355075836182
Epoch: 2, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.762 Vali Acc: 0.539 Test Loss: 0.762 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538881).  Saving model ...
Epoch: 3 cost time: 4.09473729133606
Epoch: 3, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.780 Vali Acc: 0.528 Test Loss: 0.780 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.711648941040039
Epoch: 4, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.827 Vali Acc: 0.494 Test Loss: 0.827 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9764761924743652
Epoch: 5, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.894 Vali Acc: 0.539 Test Loss: 0.894 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.9374563694000244
Epoch: 6, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.964 Vali Acc: 0.511 Test Loss: 0.964 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.1624915599823
Epoch: 7, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.057 Vali Acc: 0.544 Test Loss: 1.057 Test Acc: 0.544
Validation loss decreased (-0.538881 --> -0.544434).  Saving model ...
Epoch: 8 cost time: 4.252864837646484
Epoch: 8, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.173 Vali Acc: 0.533 Test Loss: 1.173 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.1509177684783936
Epoch: 9, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.281 Vali Acc: 0.528 Test Loss: 1.281 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8954885005950928
Epoch: 10, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.337 Vali Acc: 0.533 Test Loss: 1.337 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.0433313846588135
Epoch: 11, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.448 Vali Acc: 0.539 Test Loss: 1.448 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.934175491333008
Epoch: 12, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.545 Vali Acc: 0.539 Test Loss: 1.545 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.24418568611145
Epoch: 13, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.732 Vali Acc: 0.511 Test Loss: 1.732 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.334200143814087
Epoch: 14, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.829 Vali Acc: 0.522 Test Loss: 1.829 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.041553735733032
Epoch: 15, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.927 Vali Acc: 0.522 Test Loss: 1.927 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.376549005508423
Epoch: 16, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.986 Vali Acc: 0.533 Test Loss: 1.986 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.3047332763671875
Epoch: 17, Steps: 13 | Train Loss: 0.025 Vali Loss: 2.029 Vali Acc: 0.544 Test Loss: 2.029 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 141506
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.154378175735474
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.711 Vali Acc: 0.533 Test Loss: 0.711 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 4.314592361450195
Epoch: 2, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.764 Vali Acc: 0.511 Test Loss: 0.764 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.17757773399353
Epoch: 3, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.757 Vali Acc: 0.506 Test Loss: 0.757 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.4870994091033936
Epoch: 4, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.883 Vali Acc: 0.522 Test Loss: 0.883 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.99049711227417
Epoch: 5, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.898 Vali Acc: 0.533 Test Loss: 0.898 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.8749074935913086
Epoch: 6, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.914 Vali Acc: 0.522 Test Loss: 0.914 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.007505416870117
Epoch: 7, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.058 Vali Acc: 0.494 Test Loss: 1.058 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.347526550292969
Epoch: 8, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.164 Vali Acc: 0.528 Test Loss: 1.164 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.534928798675537
Epoch: 9, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.130 Vali Acc: 0.539 Test Loss: 1.130 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538878).  Saving model ...
Epoch: 10 cost time: 4.330488204956055
Epoch: 10, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.186 Vali Acc: 0.528 Test Loss: 1.186 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.695228338241577
Epoch: 11, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.476 Vali Acc: 0.511 Test Loss: 1.476 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.440021991729736
Epoch: 12, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.445 Vali Acc: 0.544 Test Loss: 1.445 Test Acc: 0.544
Validation loss decreased (-0.538878 --> -0.544430).  Saving model ...
Epoch: 13 cost time: 4.170628786087036
Epoch: 13, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.514 Vali Acc: 0.494 Test Loss: 1.514 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.158263683319092
Epoch: 14, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.631 Vali Acc: 0.522 Test Loss: 1.631 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.116462230682373
Epoch: 15, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.739 Vali Acc: 0.511 Test Loss: 1.739 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.897240161895752
Epoch: 16, Steps: 13 | Train Loss: 0.082 Vali Loss: 2.140 Vali Acc: 0.483 Test Loss: 2.140 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.510074615478516
Epoch: 17, Steps: 13 | Train Loss: 0.048 Vali Loss: 2.099 Vali Acc: 0.494 Test Loss: 2.099 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.171287298202515
Epoch: 18, Steps: 13 | Train Loss: 0.046 Vali Loss: 2.113 Vali Acc: 0.517 Test Loss: 2.113 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.031116962432861
Epoch: 19, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.127 Vali Acc: 0.533 Test Loss: 2.127 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.9900355339050293
Epoch: 20, Steps: 13 | Train Loss: 0.032 Vali Loss: 2.201 Vali Acc: 0.511 Test Loss: 2.201 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.1067633628845215
Epoch: 21, Steps: 13 | Train Loss: 0.017 Vali Loss: 2.335 Vali Acc: 0.489 Test Loss: 2.335 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.7390377521514893
Epoch: 22, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.390 Vali Acc: 0.506 Test Loss: 2.390 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 141506
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.828832387924194
Epoch: 1, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.738 Vali Acc: 0.494 Test Loss: 0.738 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 3.791050434112549
Epoch: 2, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.793 Vali Acc: 0.511 Test Loss: 0.793 Test Acc: 0.511
Validation loss decreased (-0.494437 --> -0.511103).  Saving model ...
Epoch: 3 cost time: 3.786381244659424
Epoch: 3, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.860 Vali Acc: 0.500 Test Loss: 0.860 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.619580507278442
Epoch: 4, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.958 Vali Acc: 0.489 Test Loss: 0.958 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.266490459442139
Epoch: 5, Steps: 13 | Train Loss: 0.455 Vali Loss: 1.055 Vali Acc: 0.456 Test Loss: 1.055 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.047892332077026
Epoch: 6, Steps: 13 | Train Loss: 0.422 Vali Loss: 1.106 Vali Acc: 0.494 Test Loss: 1.106 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.037545919418335
Epoch: 7, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.223 Vali Acc: 0.478 Test Loss: 1.223 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.180079460144043
Epoch: 8, Steps: 13 | Train Loss: 0.432 Vali Loss: 1.184 Vali Acc: 0.450 Test Loss: 1.184 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.8652074337005615
Epoch: 9, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.282 Vali Acc: 0.483 Test Loss: 1.282 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.9879539012908936
Epoch: 10, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.447 Vali Acc: 0.461 Test Loss: 1.447 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.944718837738037
Epoch: 11, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.860 Vali Acc: 0.489 Test Loss: 1.860 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.838972330093384
Epoch: 12, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 141506
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.033651351928711
Epoch: 1, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.722 Vali Acc: 0.472 Test Loss: 0.722 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 3.6403329372406006
Epoch: 2, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.742 Vali Acc: 0.483 Test Loss: 0.742 Test Acc: 0.483
Validation loss decreased (-0.472215 --> -0.483326).  Saving model ...
Epoch: 3 cost time: 3.7742412090301514
Epoch: 3, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.777 Vali Acc: 0.478 Test Loss: 0.777 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.003654956817627
Epoch: 4, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.835 Vali Acc: 0.494 Test Loss: 0.835 Test Acc: 0.494
Validation loss decreased (-0.483326 --> -0.494436).  Saving model ...
Epoch: 5 cost time: 4.133147716522217
Epoch: 5, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.925 Vali Acc: 0.478 Test Loss: 0.925 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.204109191894531
Epoch: 6, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.998 Vali Acc: 0.450 Test Loss: 0.998 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.377795934677124
Epoch: 7, Steps: 13 | Train Loss: 0.380 Vali Loss: 1.057 Vali Acc: 0.478 Test Loss: 1.057 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.253582954406738
Epoch: 8, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.157 Vali Acc: 0.489 Test Loss: 1.157 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.128256797790527
Epoch: 9, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.228 Vali Acc: 0.461 Test Loss: 1.228 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.267077207565308
Epoch: 10, Steps: 13 | Train Loss: 0.242 Vali Loss: 1.313 Vali Acc: 0.472 Test Loss: 1.313 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.437015533447266
Epoch: 11, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.561 Vali Acc: 0.450 Test Loss: 1.561 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.052363872528076
Epoch: 12, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.511 Vali Acc: 0.450 Test Loss: 1.511 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.181258201599121
Epoch: 13, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.592 Vali Acc: 0.472 Test Loss: 1.592 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.1684770584106445
Epoch: 14, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.727 Vali Acc: 0.478 Test Loss: 1.727 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.49444444444444446
model parameter : 141506
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.017021894454956
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.725 Vali Acc: 0.494 Test Loss: 0.725 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 4.0895819664001465
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 4.200491666793823
Epoch: 3, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.711 Vali Acc: 0.483 Test Loss: 0.711 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.980496883392334
Epoch: 4, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.694 Vali Acc: 0.561 Test Loss: 0.694 Test Acc: 0.561
Validation loss decreased (-0.499992 --> -0.561104).  Saving model ...
Epoch: 5 cost time: 4.094349384307861
Epoch: 5, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.701 Vali Acc: 0.528 Test Loss: 0.701 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8480947017669678
Epoch: 6, Steps: 13 | Train Loss: 0.586 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.5418291091918945
Epoch: 7, Steps: 13 | Train Loss: 0.731 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.382845878601074
Epoch: 8, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.765 Vali Acc: 0.550 Test Loss: 0.765 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.387321472167969
Epoch: 9, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.800 Vali Acc: 0.539 Test Loss: 0.800 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.328540563583374
Epoch: 10, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.863 Vali Acc: 0.522 Test Loss: 0.863 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.533728361129761
Epoch: 11, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.004 Vali Acc: 0.522 Test Loss: 1.004 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.754185676574707
Epoch: 12, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.233124494552612
Epoch: 13, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.970 Vali Acc: 0.544 Test Loss: 0.970 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.2766265869140625
Epoch: 14, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.310 Vali Acc: 0.528 Test Loss: 1.310 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 141506
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.170599937438965
Epoch: 1, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.735 Vali Acc: 0.467 Test Loss: 0.735 Test Acc: 0.467
Validation loss decreased (inf --> -0.466659).  Saving model ...
Epoch: 2 cost time: 3.7456512451171875
Epoch: 2, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.729 Vali Acc: 0.539 Test Loss: 0.729 Test Acc: 0.539
Validation loss decreased (-0.466659 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 4.31872296333313
Epoch: 3, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.732 Vali Acc: 0.567 Test Loss: 0.732 Test Acc: 0.567
Validation loss decreased (-0.538882 --> -0.566659).  Saving model ...
Epoch: 4 cost time: 4.105140209197998
Epoch: 4, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.731 Vali Acc: 0.539 Test Loss: 0.731 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.657699108123779
Epoch: 5, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.242168426513672
Epoch: 6, Steps: 13 | Train Loss: 0.684 Vali Loss: 1.085 Vali Acc: 0.511 Test Loss: 1.085 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.631915330886841
Epoch: 7, Steps: 13 | Train Loss: 0.785 Vali Loss: 1.069 Vali Acc: 0.517 Test Loss: 1.069 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.5121870040893555
Epoch: 8, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.738 Vali Acc: 0.544 Test Loss: 0.738 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.334476709365845
Epoch: 9, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.847 Vali Acc: 0.511 Test Loss: 0.847 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.418935775756836
Epoch: 10, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.948 Vali Acc: 0.517 Test Loss: 0.948 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.115392208099365
Epoch: 11, Steps: 13 | Train Loss: 0.651 Vali Loss: 1.346 Vali Acc: 0.517 Test Loss: 1.346 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.902846336364746
Epoch: 12, Steps: 13 | Train Loss: 0.801 Vali Loss: 1.255 Vali Acc: 0.522 Test Loss: 1.255 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.4185380935668945
Epoch: 13, Steps: 13 | Train Loss: 0.879 Vali Loss: 1.188 Vali Acc: 0.472 Test Loss: 1.188 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 141506
model size : 1.78MB
