Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.094442367553711
Epoch: 1, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.342 Vali Acc: 0.119 Test Loss: 3.342 Test Acc: 0.119
Validation loss decreased (inf --> -0.118790).  Saving model ...
Epoch: 2 cost time: 4.203312635421753
Epoch: 2, Steps: 10 | Train Loss: 2.194 Vali Loss: 3.266 Vali Acc: 0.211 Test Loss: 3.266 Test Acc: 0.211
Validation loss decreased (-0.118790 --> -0.210556).  Saving model ...
Epoch: 3 cost time: 4.491440773010254
Epoch: 3, Steps: 10 | Train Loss: 1.016 Vali Loss: 3.591 Vali Acc: 0.236 Test Loss: 3.591 Test Acc: 0.236
Validation loss decreased (-0.210556 --> -0.236435).  Saving model ...
Epoch: 4 cost time: 4.690179347991943
Epoch: 4, Steps: 10 | Train Loss: 0.407 Vali Loss: 4.218 Vali Acc: 0.252 Test Loss: 4.218 Test Acc: 0.252
Validation loss decreased (-0.236435 --> -0.251723).  Saving model ...
Epoch: 5 cost time: 4.993504524230957
Epoch: 5, Steps: 10 | Train Loss: 0.206 Vali Loss: 4.736 Vali Acc: 0.261 Test Loss: 4.736 Test Acc: 0.261
Validation loss decreased (-0.251723 --> -0.261129).  Saving model ...
Epoch: 6 cost time: 4.7899250984191895
Epoch: 6, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.961 Vali Acc: 0.242 Test Loss: 4.961 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.95395302772522
Epoch: 7, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.693 Vali Acc: 0.229 Test Loss: 5.693 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.61713719367981
Epoch: 8, Steps: 10 | Train Loss: 0.085 Vali Loss: 5.812 Vali Acc: 0.254 Test Loss: 5.812 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.9403955936431885
Epoch: 9, Steps: 10 | Train Loss: 0.055 Vali Loss: 5.732 Vali Acc: 0.274 Test Loss: 5.732 Test Acc: 0.274
Validation loss decreased (-0.261129 --> -0.274060).  Saving model ...
Epoch: 10 cost time: 4.108024835586548
Epoch: 10, Steps: 10 | Train Loss: 0.029 Vali Loss: 6.680 Vali Acc: 0.254 Test Loss: 6.680 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.144682884216309
Epoch: 11, Steps: 10 | Train Loss: 0.090 Vali Loss: 7.043 Vali Acc: 0.233 Test Loss: 7.043 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.65739369392395
Epoch: 12, Steps: 10 | Train Loss: 0.128 Vali Loss: 7.530 Vali Acc: 0.244 Test Loss: 7.530 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.061990261077881
Epoch: 13, Steps: 10 | Train Loss: 0.188 Vali Loss: 7.388 Vali Acc: 0.254 Test Loss: 7.388 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.956837177276611
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 7.985 Vali Acc: 0.251 Test Loss: 7.985 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.950613498687744
Epoch: 15, Steps: 10 | Train Loss: 0.171 Vali Loss: 8.284 Vali Acc: 0.229 Test Loss: 8.284 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.209324359893799
Epoch: 16, Steps: 10 | Train Loss: 0.070 Vali Loss: 9.175 Vali Acc: 0.224 Test Loss: 9.175 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.756099700927734
Epoch: 17, Steps: 10 | Train Loss: 0.335 Vali Loss: 11.344 Vali Acc: 0.225 Test Loss: 11.344 Test Acc: 0.225
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.97179102897644
Epoch: 18, Steps: 10 | Train Loss: 0.360 Vali Loss: 12.156 Vali Acc: 0.218 Test Loss: 12.156 Test Acc: 0.218
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.8219525814056396
Epoch: 19, Steps: 10 | Train Loss: 0.339 Vali Loss: 12.188 Vali Acc: 0.205 Test Loss: 12.188 Test Acc: 0.205
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 18830362
model size : 91.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.080857992172241
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.341 Vali Acc: 0.107 Test Loss: 3.341 Test Acc: 0.107
Validation loss decreased (inf --> -0.107025).  Saving model ...
Epoch: 2 cost time: 4.211748838424683
Epoch: 2, Steps: 10 | Train Loss: 2.175 Vali Loss: 3.222 Vali Acc: 0.206 Test Loss: 3.222 Test Acc: 0.206
Validation loss decreased (-0.107025 --> -0.205850).  Saving model ...
Epoch: 3 cost time: 4.533702373504639
Epoch: 3, Steps: 10 | Train Loss: 1.035 Vali Loss: 3.570 Vali Acc: 0.247 Test Loss: 3.570 Test Acc: 0.247
Validation loss decreased (-0.205850 --> -0.247023).  Saving model ...
Epoch: 4 cost time: 4.4857423305511475
Epoch: 4, Steps: 10 | Train Loss: 0.382 Vali Loss: 4.098 Vali Acc: 0.273 Test Loss: 4.098 Test Acc: 0.273
Validation loss decreased (-0.247023 --> -0.272900).  Saving model ...
Epoch: 5 cost time: 4.200763463973999
Epoch: 5, Steps: 10 | Train Loss: 0.236 Vali Loss: 4.621 Vali Acc: 0.266 Test Loss: 4.621 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.458660364151001
Epoch: 6, Steps: 10 | Train Loss: 0.133 Vali Loss: 5.290 Vali Acc: 0.227 Test Loss: 5.290 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.618627309799194
Epoch: 7, Steps: 10 | Train Loss: 0.040 Vali Loss: 5.550 Vali Acc: 0.255 Test Loss: 5.550 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.9258856773376465
Epoch: 8, Steps: 10 | Train Loss: 0.054 Vali Loss: 5.772 Vali Acc: 0.271 Test Loss: 5.772 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.773595571517944
Epoch: 9, Steps: 10 | Train Loss: 0.033 Vali Loss: 6.085 Vali Acc: 0.269 Test Loss: 6.085 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.053390741348267
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.472 Vali Acc: 0.271 Test Loss: 6.472 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.1925578117370605
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 7.082 Vali Acc: 0.261 Test Loss: 7.082 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.7699878215789795
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.129 Vali Acc: 0.266 Test Loss: 7.129 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.833070516586304
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.931 Vali Acc: 0.280 Test Loss: 6.931 Test Acc: 0.280
Validation loss decreased (-0.272900 --> -0.279931).  Saving model ...
Epoch: 14 cost time: 3.836367607116699
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.979 Vali Acc: 0.280 Test Loss: 6.979 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.4339354038238525
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.938 Vali Acc: 0.289 Test Loss: 6.938 Test Acc: 0.289
Validation loss decreased (-0.279931 --> -0.289342).  Saving model ...
Epoch: 16 cost time: 4.480801582336426
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.894 Vali Acc: 0.295 Test Loss: 6.894 Test Acc: 0.295
Validation loss decreased (-0.289342 --> -0.295225).  Saving model ...
Epoch: 17 cost time: 4.799864768981934
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.859 Vali Acc: 0.298 Test Loss: 6.859 Test Acc: 0.298
Validation loss decreased (-0.295225 --> -0.297578).  Saving model ...
Epoch: 18 cost time: 4.743852376937866
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.837 Vali Acc: 0.292 Test Loss: 6.837 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.087713718414307
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.820 Vali Acc: 0.295 Test Loss: 6.820 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.724578619003296
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.811 Vali Acc: 0.298 Test Loss: 6.811 Test Acc: 0.298
Validation loss decreased (-0.297578 --> -0.297579).  Saving model ...
Epoch: 21 cost time: 4.622703552246094
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.805 Vali Acc: 0.300 Test Loss: 6.805 Test Acc: 0.300
Validation loss decreased (-0.297579 --> -0.299932).  Saving model ...
Epoch: 22 cost time: 4.225236654281616
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.800 Vali Acc: 0.300 Test Loss: 6.800 Test Acc: 0.300
Validation loss decreased (-0.299932 --> -0.299932).  Saving model ...
Epoch: 23 cost time: 4.589425802230835
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.798 Vali Acc: 0.299 Test Loss: 6.798 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.2612669467926025
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.798 Vali Acc: 0.299 Test Loss: 6.798 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.584976673126221
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.797 Vali Acc: 0.300 Test Loss: 6.797 Test Acc: 0.300
Validation loss decreased (-0.299932 --> -0.299932).  Saving model ...
Epoch: 26 cost time: 4.274045467376709
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.796 Vali Acc: 0.300 Test Loss: 6.796 Test Acc: 0.300
Validation loss decreased (-0.299932 --> -0.299932).  Saving model ...
Epoch: 27 cost time: 4.063923120498657
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.794 Vali Acc: 0.296 Test Loss: 6.794 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.176706075668335
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.794 Vali Acc: 0.298 Test Loss: 6.794 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.113993406295776
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.797 Vali Acc: 0.299 Test Loss: 6.797 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.28400444984436
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.798 Vali Acc: 0.299 Test Loss: 6.798 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.073166608810425
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.800 Vali Acc: 0.300 Test Loss: 6.800 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.44503116607666
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.801 Vali Acc: 0.299 Test Loss: 6.801 Test Acc: 0.299
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.823270797729492
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.802 Vali Acc: 0.299 Test Loss: 6.802 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.770093202590942
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.802 Vali Acc: 0.299 Test Loss: 6.802 Test Acc: 0.299
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.869894981384277
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.804 Vali Acc: 0.298 Test Loss: 6.804 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.7638449668884277
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.803 Vali Acc: 0.300 Test Loss: 6.803 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3
model parameter : 18830362
model size : 91.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.219044208526611
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.337 Vali Acc: 0.124 Test Loss: 3.337 Test Acc: 0.124
Validation loss decreased (inf --> -0.123496).  Saving model ...
Epoch: 2 cost time: 3.749624252319336
Epoch: 2, Steps: 10 | Train Loss: 2.229 Vali Loss: 3.335 Vali Acc: 0.228 Test Loss: 3.335 Test Acc: 0.228
Validation loss decreased (-0.123496 --> -0.228202).  Saving model ...
Epoch: 3 cost time: 3.900723934173584
Epoch: 3, Steps: 10 | Train Loss: 1.182 Vali Loss: 3.717 Vali Acc: 0.258 Test Loss: 3.717 Test Acc: 0.258
Validation loss decreased (-0.228202 --> -0.257610).  Saving model ...
Epoch: 4 cost time: 4.746934652328491
Epoch: 4, Steps: 10 | Train Loss: 0.493 Vali Loss: 4.174 Vali Acc: 0.264 Test Loss: 4.174 Test Acc: 0.264
Validation loss decreased (-0.257610 --> -0.263488).  Saving model ...
Epoch: 5 cost time: 4.412206411361694
Epoch: 5, Steps: 10 | Train Loss: 0.237 Vali Loss: 4.484 Vali Acc: 0.291 Test Loss: 4.484 Test Acc: 0.291
Validation loss decreased (-0.263488 --> -0.290543).  Saving model ...
Epoch: 6 cost time: 4.218141555786133
Epoch: 6, Steps: 10 | Train Loss: 0.152 Vali Loss: 5.304 Vali Acc: 0.218 Test Loss: 5.304 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8314788341522217
Epoch: 7, Steps: 10 | Train Loss: 0.110 Vali Loss: 5.193 Vali Acc: 0.274 Test Loss: 5.193 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.809641361236572
Epoch: 8, Steps: 10 | Train Loss: 0.067 Vali Loss: 5.504 Vali Acc: 0.287 Test Loss: 5.504 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.091138124465942
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.803 Vali Acc: 0.284 Test Loss: 5.803 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.366978406906128
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 6.292 Vali Acc: 0.256 Test Loss: 6.292 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.044492483139038
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 6.915 Vali Acc: 0.231 Test Loss: 6.915 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.471722841262817
Epoch: 12, Steps: 10 | Train Loss: 0.078 Vali Loss: 7.606 Vali Acc: 0.248 Test Loss: 7.606 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.7076380252838135
Epoch: 13, Steps: 10 | Train Loss: 0.165 Vali Loss: 7.830 Vali Acc: 0.236 Test Loss: 7.830 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.891099691390991
Epoch: 14, Steps: 10 | Train Loss: 0.146 Vali Loss: 7.766 Vali Acc: 0.233 Test Loss: 7.766 Test Acc: 0.233
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.3433616161346436
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 8.277 Vali Acc: 0.253 Test Loss: 8.277 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 18830362
model size : 91.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.3289475440979
Epoch: 1, Steps: 10 | Train Loss: 3.358 Vali Loss: 3.387 Vali Acc: 0.095 Test Loss: 3.387 Test Acc: 0.095
Validation loss decreased (inf --> -0.095260).  Saving model ...
Epoch: 2 cost time: 4.314640045166016
Epoch: 2, Steps: 10 | Train Loss: 2.327 Vali Loss: 3.500 Vali Acc: 0.167 Test Loss: 3.500 Test Acc: 0.167
Validation loss decreased (-0.095260 --> -0.167024).  Saving model ...
Epoch: 3 cost time: 3.8931052684783936
Epoch: 3, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.912 Vali Acc: 0.182 Test Loss: 3.912 Test Acc: 0.182
Validation loss decreased (-0.167024 --> -0.182314).  Saving model ...
Epoch: 4 cost time: 3.767652750015259
Epoch: 4, Steps: 10 | Train Loss: 0.542 Vali Loss: 4.512 Vali Acc: 0.208 Test Loss: 4.512 Test Acc: 0.208
Validation loss decreased (-0.182314 --> -0.208190).  Saving model ...
Epoch: 5 cost time: 4.704822301864624
Epoch: 5, Steps: 10 | Train Loss: 0.208 Vali Loss: 4.911 Vali Acc: 0.232 Test Loss: 4.911 Test Acc: 0.232
Validation loss decreased (-0.208190 --> -0.231716).  Saving model ...
Epoch: 6 cost time: 4.583601713180542
Epoch: 6, Steps: 10 | Train Loss: 0.120 Vali Loss: 5.509 Vali Acc: 0.181 Test Loss: 5.509 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.649156808853149
Epoch: 7, Steps: 10 | Train Loss: 0.075 Vali Loss: 6.158 Vali Acc: 0.195 Test Loss: 6.158 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.223223924636841
Epoch: 8, Steps: 10 | Train Loss: 0.051 Vali Loss: 6.515 Vali Acc: 0.204 Test Loss: 6.515 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.446678400039673
Epoch: 9, Steps: 10 | Train Loss: 0.115 Vali Loss: 7.136 Vali Acc: 0.192 Test Loss: 7.136 Test Acc: 0.192
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.228469610214233
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 7.762 Vali Acc: 0.234 Test Loss: 7.762 Test Acc: 0.234
Validation loss decreased (-0.231716 --> -0.234040).  Saving model ...
Epoch: 11 cost time: 4.801289796829224
Epoch: 11, Steps: 10 | Train Loss: 0.106 Vali Loss: 8.123 Vali Acc: 0.216 Test Loss: 8.123 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.141249895095825
Epoch: 12, Steps: 10 | Train Loss: 0.058 Vali Loss: 8.456 Vali Acc: 0.206 Test Loss: 8.456 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.507943153381348
Epoch: 13, Steps: 10 | Train Loss: 0.076 Vali Loss: 8.587 Vali Acc: 0.213 Test Loss: 8.587 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.2914719581604
Epoch: 14, Steps: 10 | Train Loss: 0.074 Vali Loss: 8.942 Vali Acc: 0.214 Test Loss: 8.942 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.401657342910767
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 9.400 Vali Acc: 0.216 Test Loss: 9.400 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.33858060836792
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 9.559 Vali Acc: 0.224 Test Loss: 9.559 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.343162298202515
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 10.511 Vali Acc: 0.204 Test Loss: 10.511 Test Acc: 0.204
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.05024528503418
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 10.689 Vali Acc: 0.201 Test Loss: 10.689 Test Acc: 0.201
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.7147133350372314
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 11.920 Vali Acc: 0.161 Test Loss: 11.920 Test Acc: 0.161
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.731709957122803
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 11.295 Vali Acc: 0.188 Test Loss: 11.295 Test Acc: 0.188
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23411764705882354
model parameter : 18830362
model size : 91.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.341436862945557
Epoch: 1, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.443 Vali Acc: 0.073 Test Loss: 3.443 Test Acc: 0.073
Validation loss decreased (inf --> -0.072907).  Saving model ...
Epoch: 2 cost time: 4.479738235473633
Epoch: 2, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.477 Vali Acc: 0.112 Test Loss: 3.477 Test Acc: 0.112
Validation loss decreased (-0.072907 --> -0.111730).  Saving model ...
Epoch: 3 cost time: 4.419240951538086
Epoch: 3, Steps: 10 | Train Loss: 1.189 Vali Loss: 3.932 Vali Acc: 0.129 Test Loss: 3.932 Test Acc: 0.129
Validation loss decreased (-0.111730 --> -0.129372).  Saving model ...
Epoch: 4 cost time: 4.044514894485474
Epoch: 4, Steps: 10 | Train Loss: 0.429 Vali Loss: 4.697 Vali Acc: 0.111 Test Loss: 4.697 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.944917678833008
Epoch: 5, Steps: 10 | Train Loss: 0.133 Vali Loss: 5.348 Vali Acc: 0.133 Test Loss: 5.348 Test Acc: 0.133
Validation loss decreased (-0.129372 --> -0.132888).  Saving model ...
Epoch: 6 cost time: 4.57837176322937
Epoch: 6, Steps: 10 | Train Loss: 0.056 Vali Loss: 6.088 Vali Acc: 0.112 Test Loss: 6.088 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.290371894836426
Epoch: 7, Steps: 10 | Train Loss: 0.047 Vali Loss: 6.322 Vali Acc: 0.154 Test Loss: 6.322 Test Acc: 0.154
Validation loss decreased (-0.132888 --> -0.154054).  Saving model ...
Epoch: 8 cost time: 4.321229457855225
Epoch: 8, Steps: 10 | Train Loss: 0.056 Vali Loss: 6.857 Vali Acc: 0.120 Test Loss: 6.857 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.071599006652832
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 7.127 Vali Acc: 0.112 Test Loss: 7.127 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.42656135559082
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 6.862 Vali Acc: 0.132 Test Loss: 6.862 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.3670690059661865
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 7.333 Vali Acc: 0.134 Test Loss: 7.333 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.663579940795898
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 7.737 Vali Acc: 0.118 Test Loss: 7.737 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.875957727432251
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.574 Vali Acc: 0.122 Test Loss: 7.574 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.8750228881835938
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.538 Vali Acc: 0.132 Test Loss: 7.538 Test Acc: 0.132
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.258968114852905
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.607 Vali Acc: 0.148 Test Loss: 7.607 Test Acc: 0.148
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.168989658355713
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.705 Vali Acc: 0.140 Test Loss: 7.705 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.395056962966919
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.734 Vali Acc: 0.144 Test Loss: 7.734 Test Acc: 0.144
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15411764705882353
model parameter : 18830362
model size : 91.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.860633850097656
Epoch: 1, Steps: 10 | Train Loss: 3.349 Vali Loss: 3.466 Vali Acc: 0.060 Test Loss: 3.466 Test Acc: 0.060
Validation loss decreased (inf --> -0.059965).  Saving model ...
Epoch: 2 cost time: 4.427020072937012
Epoch: 2, Steps: 10 | Train Loss: 2.674 Vali Loss: 3.483 Vali Acc: 0.091 Test Loss: 3.483 Test Acc: 0.091
Validation loss decreased (-0.059965 --> -0.090553).  Saving model ...
Epoch: 3 cost time: 3.829547882080078
Epoch: 3, Steps: 10 | Train Loss: 1.511 Vali Loss: 3.655 Vali Acc: 0.089 Test Loss: 3.655 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.21220850944519
Epoch: 4, Steps: 10 | Train Loss: 0.670 Vali Loss: 4.182 Vali Acc: 0.092 Test Loss: 4.182 Test Acc: 0.092
Validation loss decreased (-0.090553 --> -0.091723).  Saving model ...
Epoch: 5 cost time: 4.2558434009552
Epoch: 5, Steps: 10 | Train Loss: 0.203 Vali Loss: 4.795 Vali Acc: 0.109 Test Loss: 4.795 Test Acc: 0.109
Validation loss decreased (-0.091723 --> -0.109364).  Saving model ...
Epoch: 6 cost time: 4.172316551208496
Epoch: 6, Steps: 10 | Train Loss: 0.045 Vali Loss: 5.474 Vali Acc: 0.102 Test Loss: 5.474 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.343665599822998
Epoch: 7, Steps: 10 | Train Loss: 0.026 Vali Loss: 6.121 Vali Acc: 0.119 Test Loss: 6.121 Test Acc: 0.119
Validation loss decreased (-0.109364 --> -0.118762).  Saving model ...
Epoch: 8 cost time: 4.302185773849487
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 6.026 Vali Acc: 0.107 Test Loss: 6.026 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.1123199462890625
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 6.326 Vali Acc: 0.106 Test Loss: 6.326 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.277938604354858
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.342 Vali Acc: 0.106 Test Loss: 6.342 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.8660547733306885
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.619 Vali Acc: 0.118 Test Loss: 6.619 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.045976638793945
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.704 Vali Acc: 0.115 Test Loss: 6.704 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.250787019729614
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.673 Vali Acc: 0.116 Test Loss: 6.673 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.568869590759277
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.617 Vali Acc: 0.114 Test Loss: 6.617 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.294645547866821
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.585 Vali Acc: 0.115 Test Loss: 6.585 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.161488771438599
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.572 Vali Acc: 0.118 Test Loss: 6.572 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.4310808181762695
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.565 Vali Acc: 0.118 Test Loss: 6.565 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1188235294117647
model parameter : 18830362
model size : 91.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.318923711776733
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.429 Vali Acc: 0.049 Test Loss: 3.429 Test Acc: 0.049
Validation loss decreased (inf --> -0.049377).  Saving model ...
Epoch: 2 cost time: 4.02981972694397
Epoch: 2, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.490 Vali Acc: 0.079 Test Loss: 3.490 Test Acc: 0.079
Validation loss decreased (-0.049377 --> -0.078789).  Saving model ...
Epoch: 3 cost time: 4.530574798583984
Epoch: 3, Steps: 10 | Train Loss: 2.039 Vali Loss: 3.543 Vali Acc: 0.101 Test Loss: 3.543 Test Acc: 0.101
Validation loss decreased (-0.078789 --> -0.101141).  Saving model ...
Epoch: 4 cost time: 4.3830647468566895
Epoch: 4, Steps: 10 | Train Loss: 1.093 Vali Loss: 4.021 Vali Acc: 0.105 Test Loss: 4.021 Test Acc: 0.105
Validation loss decreased (-0.101141 --> -0.104666).  Saving model ...
Epoch: 5 cost time: 4.876823663711548
Epoch: 5, Steps: 10 | Train Loss: 0.390 Vali Loss: 4.869 Vali Acc: 0.092 Test Loss: 4.869 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.138790607452393
Epoch: 6, Steps: 10 | Train Loss: 0.144 Vali Loss: 5.340 Vali Acc: 0.116 Test Loss: 5.340 Test Acc: 0.116
Validation loss decreased (-0.104666 --> -0.116417).  Saving model ...
Epoch: 7 cost time: 4.1669816970825195
Epoch: 7, Steps: 10 | Train Loss: 0.032 Vali Loss: 5.950 Vali Acc: 0.102 Test Loss: 5.950 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.514387607574463
Epoch: 8, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.256 Vali Acc: 0.119 Test Loss: 6.256 Test Acc: 0.119
Validation loss decreased (-0.116417 --> -0.118761).  Saving model ...
Epoch: 9 cost time: 4.305098295211792
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.238 Vali Acc: 0.112 Test Loss: 6.238 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.908029556274414
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.608 Vali Acc: 0.112 Test Loss: 6.608 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.70512056350708
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.658 Vali Acc: 0.101 Test Loss: 6.658 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.859889268875122
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.628 Vali Acc: 0.104 Test Loss: 6.628 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.955388784408569
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.643 Vali Acc: 0.104 Test Loss: 6.643 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.008649826049805
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.636 Vali Acc: 0.102 Test Loss: 6.636 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.724745512008667
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.649 Vali Acc: 0.105 Test Loss: 6.649 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.8543035984039307
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.665 Vali Acc: 0.106 Test Loss: 6.665 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.37919020652771
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.681 Vali Acc: 0.106 Test Loss: 6.681 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.014117956161499
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.697 Vali Acc: 0.106 Test Loss: 6.697 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1188235294117647
model parameter : 18830362
model size : 91.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.703382968902588
Epoch: 1, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.400 Vali Acc: 0.046 Test Loss: 3.400 Test Acc: 0.046
Validation loss decreased (inf --> -0.045848).  Saving model ...
Epoch: 2 cost time: 4.088796138763428
Epoch: 2, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.471 Vali Acc: 0.085 Test Loss: 3.471 Test Acc: 0.085
Validation loss decreased (-0.045848 --> -0.084671).  Saving model ...
Epoch: 3 cost time: 4.447287321090698
Epoch: 3, Steps: 10 | Train Loss: 2.341 Vali Loss: 3.450 Vali Acc: 0.112 Test Loss: 3.450 Test Acc: 0.112
Validation loss decreased (-0.084671 --> -0.111730).  Saving model ...
Epoch: 4 cost time: 4.048686504364014
Epoch: 4, Steps: 10 | Train Loss: 1.418 Vali Loss: 3.759 Vali Acc: 0.108 Test Loss: 3.759 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.411182880401611
Epoch: 5, Steps: 10 | Train Loss: 0.625 Vali Loss: 4.423 Vali Acc: 0.092 Test Loss: 4.423 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.182165145874023
Epoch: 6, Steps: 10 | Train Loss: 0.251 Vali Loss: 4.855 Vali Acc: 0.124 Test Loss: 4.855 Test Acc: 0.124
Validation loss decreased (-0.111730 --> -0.123481).  Saving model ...
Epoch: 7 cost time: 4.261882066726685
Epoch: 7, Steps: 10 | Train Loss: 0.062 Vali Loss: 5.542 Vali Acc: 0.111 Test Loss: 5.542 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.72182035446167
Epoch: 8, Steps: 10 | Train Loss: 0.046 Vali Loss: 5.895 Vali Acc: 0.107 Test Loss: 5.895 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.472414016723633
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 6.364 Vali Acc: 0.118 Test Loss: 6.364 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.2227888107299805
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.066 Vali Acc: 0.132 Test Loss: 6.066 Test Acc: 0.132
Validation loss decreased (-0.123481 --> -0.131704).  Saving model ...
Epoch: 11 cost time: 4.604671239852905
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.099 Vali Acc: 0.125 Test Loss: 6.099 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.596541881561279
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.127 Vali Acc: 0.127 Test Loss: 6.127 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.193588018417358
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.136 Vali Acc: 0.128 Test Loss: 6.136 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.9565365314483643
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.126 Vali Acc: 0.128 Test Loss: 6.126 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.118363380432129
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.126 Vali Acc: 0.127 Test Loss: 6.126 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.565319299697876
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.127 Vali Acc: 0.128 Test Loss: 6.127 Test Acc: 0.128
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.913177490234375
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.131 Vali Acc: 0.128 Test Loss: 6.131 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.118216514587402
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.149 Vali Acc: 0.129 Test Loss: 6.149 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.7508556842803955
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.160 Vali Acc: 0.128 Test Loss: 6.160 Test Acc: 0.128
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.7690558433532715
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.182 Vali Acc: 0.129 Test Loss: 6.182 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13176470588235295
model parameter : 18830362
model size : 91.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.162184000015259
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.435 Vali Acc: 0.049 Test Loss: 3.435 Test Acc: 0.049
Validation loss decreased (inf --> -0.049377).  Saving model ...
Epoch: 2 cost time: 4.164579391479492
Epoch: 2, Steps: 10 | Train Loss: 3.082 Vali Loss: 3.549 Vali Acc: 0.075 Test Loss: 3.549 Test Acc: 0.075
Validation loss decreased (-0.049377 --> -0.075259).  Saving model ...
Epoch: 3 cost time: 3.942997694015503
Epoch: 3, Steps: 10 | Train Loss: 2.452 Vali Loss: 3.455 Vali Acc: 0.087 Test Loss: 3.455 Test Acc: 0.087
Validation loss decreased (-0.075259 --> -0.087024).  Saving model ...
Epoch: 4 cost time: 4.175078392028809
Epoch: 4, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.736 Vali Acc: 0.108 Test Loss: 3.736 Test Acc: 0.108
Validation loss decreased (-0.087024 --> -0.108198).  Saving model ...
Epoch: 5 cost time: 4.064232587814331
Epoch: 5, Steps: 10 | Train Loss: 0.840 Vali Loss: 4.311 Vali Acc: 0.107 Test Loss: 4.311 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.283583641052246
Epoch: 6, Steps: 10 | Train Loss: 0.355 Vali Loss: 4.903 Vali Acc: 0.144 Test Loss: 4.903 Test Acc: 0.144
Validation loss decreased (-0.108198 --> -0.143480).  Saving model ...
Epoch: 7 cost time: 4.318760395050049
Epoch: 7, Steps: 10 | Train Loss: 0.109 Vali Loss: 5.494 Vali Acc: 0.120 Test Loss: 5.494 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9822707176208496
Epoch: 8, Steps: 10 | Train Loss: 0.050 Vali Loss: 5.925 Vali Acc: 0.132 Test Loss: 5.925 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.891642808914185
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.882 Vali Acc: 0.131 Test Loss: 5.882 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.389688730239868
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.516 Vali Acc: 0.142 Test Loss: 6.516 Test Acc: 0.142
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.769746780395508
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.428 Vali Acc: 0.149 Test Loss: 6.428 Test Acc: 0.149
Validation loss decreased (-0.143480 --> -0.149347).  Saving model ...
Epoch: 12 cost time: 4.429252862930298
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.460 Vali Acc: 0.138 Test Loss: 6.460 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.807240962982178
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.439 Vali Acc: 0.142 Test Loss: 6.439 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.208611011505127
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.390 Vali Acc: 0.139 Test Loss: 6.390 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.2329277992248535
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.353 Vali Acc: 0.138 Test Loss: 6.353 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.490394592285156
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.336 Vali Acc: 0.140 Test Loss: 6.336 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.573070287704468
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.334 Vali Acc: 0.142 Test Loss: 6.334 Test Acc: 0.142
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.149545192718506
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.346 Vali Acc: 0.144 Test Loss: 6.346 Test Acc: 0.144
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.812768220901489
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.349 Vali Acc: 0.145 Test Loss: 6.349 Test Acc: 0.145
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.111741065979004
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.350 Vali Acc: 0.141 Test Loss: 6.350 Test Acc: 0.141
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.222017526626587
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.357 Vali Acc: 0.145 Test Loss: 6.357 Test Acc: 0.145
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14941176470588236
model parameter : 18830362
model size : 91.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.683664083480835
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 4.150206565856934
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.037614 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 4.145676612854004
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 4 cost time: 4.304240703582764
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.300145387649536
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.188879489898682
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.223551511764526
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.281118154525757
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.499599933624268
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.807927370071411
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.467726469039917
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.397065162658691
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.445398330688477
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.042352941176470586
model parameter : 18830362
model size : 91.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.453186750411987
Epoch: 1, Steps: 10 | Train Loss: 3.426 Vali Loss: 3.406 Vali Acc: 0.108 Test Loss: 3.406 Test Acc: 0.108
Validation loss decreased (inf --> -0.108201).  Saving model ...
Epoch: 2 cost time: 4.115777969360352
Epoch: 2, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.247 Vali Acc: 0.196 Test Loss: 3.247 Test Acc: 0.196
Validation loss decreased (-0.108201 --> -0.196438).  Saving model ...
Epoch: 3 cost time: 4.020134449005127
Epoch: 3, Steps: 10 | Train Loss: 1.038 Vali Loss: 3.645 Vali Acc: 0.225 Test Loss: 3.645 Test Acc: 0.225
Validation loss decreased (-0.196438 --> -0.224669).  Saving model ...
Epoch: 4 cost time: 4.585087060928345
Epoch: 4, Steps: 10 | Train Loss: 0.460 Vali Loss: 4.172 Vali Acc: 0.248 Test Loss: 4.172 Test Acc: 0.248
Validation loss decreased (-0.224669 --> -0.248194).  Saving model ...
Epoch: 5 cost time: 4.527673959732056
Epoch: 5, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.583 Vali Acc: 0.235 Test Loss: 4.583 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.1010353565216064
Epoch: 6, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.906 Vali Acc: 0.281 Test Loss: 4.906 Test Acc: 0.281
Validation loss decreased (-0.248194 --> -0.281127).  Saving model ...
Epoch: 7 cost time: 3.823356866836548
Epoch: 7, Steps: 10 | Train Loss: 0.079 Vali Loss: 5.399 Vali Acc: 0.256 Test Loss: 5.399 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.246212720870972
Epoch: 8, Steps: 10 | Train Loss: 0.056 Vali Loss: 5.536 Vali Acc: 0.268 Test Loss: 5.536 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9180908203125
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 6.178 Vali Acc: 0.258 Test Loss: 6.178 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.014974355697632
Epoch: 10, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.957 Vali Acc: 0.289 Test Loss: 5.957 Test Acc: 0.289
Validation loss decreased (-0.281127 --> -0.289352).  Saving model ...
Epoch: 11 cost time: 4.280652284622192
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.088 Vali Acc: 0.291 Test Loss: 6.088 Test Acc: 0.291
Validation loss decreased (-0.289352 --> -0.290527).  Saving model ...
Epoch: 12 cost time: 4.085335969924927
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.129 Vali Acc: 0.288 Test Loss: 6.129 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.968449115753174
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.117 Vali Acc: 0.289 Test Loss: 6.117 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.023343086242676
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.092 Vali Acc: 0.294 Test Loss: 6.092 Test Acc: 0.294
Validation loss decreased (-0.290527 --> -0.294057).  Saving model ...
Epoch: 15 cost time: 4.06450080871582
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.089 Vali Acc: 0.302 Test Loss: 6.089 Test Acc: 0.302
Validation loss decreased (-0.294057 --> -0.302292).  Saving model ...
Epoch: 16 cost time: 4.179366588592529
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.104 Vali Acc: 0.300 Test Loss: 6.104 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.5788352489471436
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.102 Vali Acc: 0.308 Test Loss: 6.102 Test Acc: 0.308
Validation loss decreased (-0.302292 --> -0.308174).  Saving model ...
Epoch: 18 cost time: 4.750387668609619
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.110 Vali Acc: 0.307 Test Loss: 6.110 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9466593265533447
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.111 Vali Acc: 0.307 Test Loss: 6.111 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.057226181030273
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.109 Vali Acc: 0.305 Test Loss: 6.109 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.162736654281616
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.111 Vali Acc: 0.302 Test Loss: 6.111 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.019204139709473
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.114 Vali Acc: 0.301 Test Loss: 6.114 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.410515308380127
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.115 Vali Acc: 0.300 Test Loss: 6.115 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.370618581771851
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.117 Vali Acc: 0.299 Test Loss: 6.117 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.102158784866333
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.117 Vali Acc: 0.299 Test Loss: 6.117 Test Acc: 0.299
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.133627653121948
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.120 Vali Acc: 0.300 Test Loss: 6.120 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.154916286468506
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.124 Vali Acc: 0.301 Test Loss: 6.124 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30823529411764705
model parameter : 15684634
model size : 79.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.952117681503296
Epoch: 1, Steps: 10 | Train Loss: 3.431 Vali Loss: 3.393 Vali Acc: 0.098 Test Loss: 3.393 Test Acc: 0.098
Validation loss decreased (inf --> -0.097613).  Saving model ...
Epoch: 2 cost time: 3.945582628250122
Epoch: 2, Steps: 10 | Train Loss: 2.338 Vali Loss: 3.255 Vali Acc: 0.213 Test Loss: 3.255 Test Acc: 0.213
Validation loss decreased (-0.097613 --> -0.212909).  Saving model ...
Epoch: 3 cost time: 4.204123020172119
Epoch: 3, Steps: 10 | Train Loss: 1.023 Vali Loss: 3.619 Vali Acc: 0.233 Test Loss: 3.619 Test Acc: 0.233
Validation loss decreased (-0.212909 --> -0.232905).  Saving model ...
Epoch: 4 cost time: 4.168245553970337
Epoch: 4, Steps: 10 | Train Loss: 0.404 Vali Loss: 4.200 Vali Acc: 0.244 Test Loss: 4.200 Test Acc: 0.244
Validation loss decreased (-0.232905 --> -0.243487).  Saving model ...
Epoch: 5 cost time: 4.218491792678833
Epoch: 5, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.668 Vali Acc: 0.236 Test Loss: 4.668 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.44551420211792
Epoch: 6, Steps: 10 | Train Loss: 0.091 Vali Loss: 5.169 Vali Acc: 0.281 Test Loss: 5.169 Test Acc: 0.281
Validation loss decreased (-0.243487 --> -0.281125).  Saving model ...
Epoch: 7 cost time: 4.4020843505859375
Epoch: 7, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.654 Vali Acc: 0.269 Test Loss: 5.654 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.353422164916992
Epoch: 8, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.791 Vali Acc: 0.268 Test Loss: 5.791 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.510911464691162
Epoch: 9, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.862 Vali Acc: 0.274 Test Loss: 5.862 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.735650300979614
Epoch: 10, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.803 Vali Acc: 0.294 Test Loss: 5.803 Test Acc: 0.294
Validation loss decreased (-0.281125 --> -0.294060).  Saving model ...
Epoch: 11 cost time: 4.511143207550049
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 6.212 Vali Acc: 0.286 Test Loss: 6.212 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.405847787857056
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.484 Vali Acc: 0.272 Test Loss: 6.484 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.274184942245483
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.685 Vali Acc: 0.276 Test Loss: 6.685 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.267729997634888
Epoch: 14, Steps: 10 | Train Loss: 0.071 Vali Loss: 6.544 Vali Acc: 0.298 Test Loss: 6.544 Test Acc: 0.298
Validation loss decreased (-0.294060 --> -0.297582).  Saving model ...
Epoch: 15 cost time: 4.334858655929565
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 7.115 Vali Acc: 0.275 Test Loss: 7.115 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.732187747955322
Epoch: 16, Steps: 10 | Train Loss: 0.115 Vali Loss: 8.271 Vali Acc: 0.252 Test Loss: 8.271 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.652062892913818
Epoch: 17, Steps: 10 | Train Loss: 0.125 Vali Loss: 8.522 Vali Acc: 0.240 Test Loss: 8.522 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.323098421096802
Epoch: 18, Steps: 10 | Train Loss: 0.127 Vali Loss: 9.464 Vali Acc: 0.216 Test Loss: 9.464 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.337886571884155
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 9.832 Vali Acc: 0.235 Test Loss: 9.832 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.268755912780762
Epoch: 20, Steps: 10 | Train Loss: 0.282 Vali Loss: 10.279 Vali Acc: 0.216 Test Loss: 10.279 Test Acc: 0.216
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.587145805358887
Epoch: 21, Steps: 10 | Train Loss: 0.271 Vali Loss: 11.394 Vali Acc: 0.193 Test Loss: 11.394 Test Acc: 0.193
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.160525560379028
Epoch: 22, Steps: 10 | Train Loss: 0.319 Vali Loss: 11.694 Vali Acc: 0.185 Test Loss: 11.694 Test Acc: 0.185
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.3504860401153564
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 12.607 Vali Acc: 0.216 Test Loss: 12.607 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.277191400527954
Epoch: 24, Steps: 10 | Train Loss: 0.345 Vali Loss: 13.853 Vali Acc: 0.206 Test Loss: 13.853 Test Acc: 0.206
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 15684634
model size : 79.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.576664209365845
Epoch: 1, Steps: 10 | Train Loss: 3.442 Vali Loss: 3.388 Vali Acc: 0.115 Test Loss: 3.388 Test Acc: 0.115
Validation loss decreased (inf --> -0.115260).  Saving model ...
Epoch: 2 cost time: 4.191327810287476
Epoch: 2, Steps: 10 | Train Loss: 2.384 Vali Loss: 3.380 Vali Acc: 0.213 Test Loss: 3.380 Test Acc: 0.213
Validation loss decreased (-0.115260 --> -0.212907).  Saving model ...
Epoch: 3 cost time: 4.216982364654541
Epoch: 3, Steps: 10 | Train Loss: 1.247 Vali Loss: 3.750 Vali Acc: 0.246 Test Loss: 3.750 Test Acc: 0.246
Validation loss decreased (-0.212907 --> -0.245845).  Saving model ...
Epoch: 4 cost time: 4.451117038726807
Epoch: 4, Steps: 10 | Train Loss: 0.544 Vali Loss: 4.156 Vali Acc: 0.269 Test Loss: 4.156 Test Acc: 0.269
Validation loss decreased (-0.245845 --> -0.269370).  Saving model ...
Epoch: 5 cost time: 4.361827850341797
Epoch: 5, Steps: 10 | Train Loss: 0.176 Vali Loss: 4.532 Vali Acc: 0.259 Test Loss: 4.532 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.063369512557983
Epoch: 6, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.930 Vali Acc: 0.271 Test Loss: 4.930 Test Acc: 0.271
Validation loss decreased (-0.269370 --> -0.270539).  Saving model ...
Epoch: 7 cost time: 3.9947314262390137
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 5.770 Vali Acc: 0.248 Test Loss: 5.770 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.737246751785278
Epoch: 8, Steps: 10 | Train Loss: 0.121 Vali Loss: 6.170 Vali Acc: 0.247 Test Loss: 6.170 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.228492021560669
Epoch: 9, Steps: 10 | Train Loss: 0.054 Vali Loss: 6.345 Vali Acc: 0.222 Test Loss: 6.345 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.344141006469727
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 6.752 Vali Acc: 0.259 Test Loss: 6.752 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.774122953414917
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 6.409 Vali Acc: 0.288 Test Loss: 6.409 Test Acc: 0.288
Validation loss decreased (-0.270539 --> -0.288171).  Saving model ...
Epoch: 12 cost time: 4.026777505874634
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 6.873 Vali Acc: 0.269 Test Loss: 6.873 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.4026877880096436
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 7.415 Vali Acc: 0.251 Test Loss: 7.415 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.34762167930603
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 7.687 Vali Acc: 0.262 Test Loss: 7.687 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.459752082824707
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 8.309 Vali Acc: 0.245 Test Loss: 8.309 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.846743106842041
Epoch: 16, Steps: 10 | Train Loss: 0.120 Vali Loss: 8.569 Vali Acc: 0.247 Test Loss: 8.569 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.130129814147949
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 9.733 Vali Acc: 0.254 Test Loss: 9.733 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.4477152824401855
Epoch: 18, Steps: 10 | Train Loss: 0.139 Vali Loss: 9.062 Vali Acc: 0.256 Test Loss: 9.062 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.902423858642578
Epoch: 19, Steps: 10 | Train Loss: 0.049 Vali Loss: 10.799 Vali Acc: 0.247 Test Loss: 10.799 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.23816180229187
Epoch: 20, Steps: 10 | Train Loss: 0.175 Vali Loss: 10.344 Vali Acc: 0.258 Test Loss: 10.344 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.278008460998535
Epoch: 21, Steps: 10 | Train Loss: 0.228 Vali Loss: 10.757 Vali Acc: 0.228 Test Loss: 10.757 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28823529411764703
model parameter : 15684634
model size : 79.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.9035608768463135
Epoch: 1, Steps: 10 | Train Loss: 3.434 Vali Loss: 3.436 Vali Acc: 0.088 Test Loss: 3.436 Test Acc: 0.088
Validation loss decreased (inf --> -0.088201).  Saving model ...
Epoch: 2 cost time: 4.008421182632446
Epoch: 2, Steps: 10 | Train Loss: 2.402 Vali Loss: 3.490 Vali Acc: 0.151 Test Loss: 3.490 Test Acc: 0.151
Validation loss decreased (-0.088201 --> -0.150553).  Saving model ...
Epoch: 3 cost time: 4.145774841308594
Epoch: 3, Steps: 10 | Train Loss: 1.243 Vali Loss: 4.020 Vali Acc: 0.166 Test Loss: 4.020 Test Acc: 0.166
Validation loss decreased (-0.150553 --> -0.165842).  Saving model ...
Epoch: 4 cost time: 4.203557729721069
Epoch: 4, Steps: 10 | Train Loss: 0.668 Vali Loss: 4.414 Vali Acc: 0.216 Test Loss: 4.414 Test Acc: 0.216
Validation loss decreased (-0.165842 --> -0.216426).  Saving model ...
Epoch: 5 cost time: 3.8678784370422363
Epoch: 5, Steps: 10 | Train Loss: 0.233 Vali Loss: 5.085 Vali Acc: 0.184 Test Loss: 5.085 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.80889630317688
Epoch: 6, Steps: 10 | Train Loss: 0.240 Vali Loss: 5.476 Vali Acc: 0.202 Test Loss: 5.476 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.838876247406006
Epoch: 7, Steps: 10 | Train Loss: 0.184 Vali Loss: 5.950 Vali Acc: 0.226 Test Loss: 5.950 Test Acc: 0.226
Validation loss decreased (-0.216426 --> -0.225823).  Saving model ...
Epoch: 8 cost time: 4.769434213638306
Epoch: 8, Steps: 10 | Train Loss: 0.111 Vali Loss: 6.263 Vali Acc: 0.213 Test Loss: 6.263 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.133916854858398
Epoch: 9, Steps: 10 | Train Loss: 0.038 Vali Loss: 6.255 Vali Acc: 0.212 Test Loss: 6.255 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.207828760147095
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 6.935 Vali Acc: 0.214 Test Loss: 6.935 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.9484703540802
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 7.095 Vali Acc: 0.220 Test Loss: 7.095 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.403509140014648
Epoch: 12, Steps: 10 | Train Loss: 0.028 Vali Loss: 7.544 Vali Acc: 0.216 Test Loss: 7.544 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.8058154582977295
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 8.359 Vali Acc: 0.174 Test Loss: 8.359 Test Acc: 0.174
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.661793947219849
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 7.997 Vali Acc: 0.205 Test Loss: 7.997 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.04128098487854
Epoch: 15, Steps: 10 | Train Loss: 0.142 Vali Loss: 8.835 Vali Acc: 0.202 Test Loss: 8.835 Test Acc: 0.202
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.034949541091919
Epoch: 16, Steps: 10 | Train Loss: 0.089 Vali Loss: 8.882 Vali Acc: 0.209 Test Loss: 8.882 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.9507150650024414
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 9.343 Vali Acc: 0.222 Test Loss: 9.343 Test Acc: 0.222
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22588235294117648
model parameter : 15684634
model size : 79.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.308572292327881
Epoch: 1, Steps: 10 | Train Loss: 3.419 Vali Loss: 3.472 Vali Acc: 0.046 Test Loss: 3.472 Test Acc: 0.046
Validation loss decreased (inf --> -0.045848).  Saving model ...
Epoch: 2 cost time: 3.9177944660186768
Epoch: 2, Steps: 10 | Train Loss: 2.511 Vali Loss: 3.479 Vali Acc: 0.101 Test Loss: 3.479 Test Acc: 0.101
Validation loss decreased (-0.045848 --> -0.101142).  Saving model ...
Epoch: 3 cost time: 4.329283952713013
Epoch: 3, Steps: 10 | Train Loss: 1.189 Vali Loss: 3.869 Vali Acc: 0.114 Test Loss: 3.869 Test Acc: 0.114
Validation loss decreased (-0.101142 --> -0.114079).  Saving model ...
Epoch: 4 cost time: 4.197599649429321
Epoch: 4, Steps: 10 | Train Loss: 0.453 Vali Loss: 4.590 Vali Acc: 0.118 Test Loss: 4.590 Test Acc: 0.118
Validation loss decreased (-0.114079 --> -0.117601).  Saving model ...
Epoch: 5 cost time: 3.8433539867401123
Epoch: 5, Steps: 10 | Train Loss: 0.121 Vali Loss: 5.150 Vali Acc: 0.132 Test Loss: 5.150 Test Acc: 0.132
Validation loss decreased (-0.117601 --> -0.131713).  Saving model ...
Epoch: 6 cost time: 4.305858850479126
Epoch: 6, Steps: 10 | Train Loss: 0.041 Vali Loss: 5.667 Vali Acc: 0.145 Test Loss: 5.667 Test Acc: 0.145
Validation loss decreased (-0.131713 --> -0.144649).  Saving model ...
Epoch: 7 cost time: 3.680288791656494
Epoch: 7, Steps: 10 | Train Loss: 0.027 Vali Loss: 6.176 Vali Acc: 0.132 Test Loss: 6.176 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.135239839553833
Epoch: 8, Steps: 10 | Train Loss: 0.015 Vali Loss: 6.699 Vali Acc: 0.126 Test Loss: 6.699 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.344496965408325
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 6.624 Vali Acc: 0.139 Test Loss: 6.624 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.927920341491699
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.611 Vali Acc: 0.145 Test Loss: 6.611 Test Acc: 0.145
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.9571573734283447
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 6.999 Vali Acc: 0.138 Test Loss: 6.999 Test Acc: 0.138
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.4743781089782715
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 7.861 Vali Acc: 0.127 Test Loss: 7.861 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.246274471282959
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 7.672 Vali Acc: 0.145 Test Loss: 7.672 Test Acc: 0.145
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.133024454116821
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 8.143 Vali Acc: 0.141 Test Loss: 8.143 Test Acc: 0.141
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.9606025218963623
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 10.182 Vali Acc: 0.108 Test Loss: 10.182 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.386835336685181
Epoch: 16, Steps: 10 | Train Loss: 0.119 Vali Loss: 10.055 Vali Acc: 0.133 Test Loss: 10.055 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14470588235294118
model parameter : 15684634
model size : 79.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.652022361755371
Epoch: 1, Steps: 10 | Train Loss: 3.405 Vali Loss: 3.443 Vali Acc: 0.052 Test Loss: 3.443 Test Acc: 0.052
Validation loss decreased (inf --> -0.051730).  Saving model ...
Epoch: 2 cost time: 3.8606693744659424
Epoch: 2, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.478 Vali Acc: 0.073 Test Loss: 3.478 Test Acc: 0.073
Validation loss decreased (-0.051730 --> -0.072906).  Saving model ...
Epoch: 3 cost time: 4.186595916748047
Epoch: 3, Steps: 10 | Train Loss: 1.551 Vali Loss: 3.602 Vali Acc: 0.085 Test Loss: 3.602 Test Acc: 0.085
Validation loss decreased (-0.072906 --> -0.084670).  Saving model ...
Epoch: 4 cost time: 4.213510036468506
Epoch: 4, Steps: 10 | Train Loss: 0.718 Vali Loss: 4.167 Vali Acc: 0.106 Test Loss: 4.167 Test Acc: 0.106
Validation loss decreased (-0.084670 --> -0.105841).  Saving model ...
Epoch: 5 cost time: 4.072569370269775
Epoch: 5, Steps: 10 | Train Loss: 0.239 Vali Loss: 4.735 Vali Acc: 0.098 Test Loss: 4.735 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.306769371032715
Epoch: 6, Steps: 10 | Train Loss: 0.080 Vali Loss: 5.173 Vali Acc: 0.107 Test Loss: 5.173 Test Acc: 0.107
Validation loss decreased (-0.105841 --> -0.107007).  Saving model ...
Epoch: 7 cost time: 4.074167966842651
Epoch: 7, Steps: 10 | Train Loss: 0.044 Vali Loss: 6.064 Vali Acc: 0.105 Test Loss: 6.064 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.173007011413574
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 6.176 Vali Acc: 0.109 Test Loss: 6.176 Test Acc: 0.109
Validation loss decreased (-0.107007 --> -0.109350).  Saving model ...
Epoch: 9 cost time: 3.846259117126465
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.178 Vali Acc: 0.109 Test Loss: 6.178 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8328115940093994
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.594 Vali Acc: 0.118 Test Loss: 6.594 Test Acc: 0.118
Validation loss decreased (-0.109350 --> -0.117581).  Saving model ...
Epoch: 11 cost time: 4.077349901199341
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.513 Vali Acc: 0.107 Test Loss: 6.513 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.111797094345093
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.491 Vali Acc: 0.107 Test Loss: 6.491 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.425686597824097
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.473 Vali Acc: 0.107 Test Loss: 6.473 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.388686418533325
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.462 Vali Acc: 0.107 Test Loss: 6.462 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.6058647632598877
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.463 Vali Acc: 0.109 Test Loss: 6.463 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.7494513988494873
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.469 Vali Acc: 0.113 Test Loss: 6.469 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.4904491901397705
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.478 Vali Acc: 0.112 Test Loss: 6.478 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.1494481563568115
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.491 Vali Acc: 0.112 Test Loss: 6.491 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.3129472732543945
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.502 Vali Acc: 0.113 Test Loss: 6.502 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.177765369415283
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.510 Vali Acc: 0.114 Test Loss: 6.510 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.11764705882352941
model parameter : 15684634
model size : 79.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.545078754425049
Epoch: 1, Steps: 10 | Train Loss: 3.420 Vali Loss: 3.422 Vali Acc: 0.038 Test Loss: 3.422 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 4.316365718841553
Epoch: 2, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.487 Vali Acc: 0.084 Test Loss: 3.487 Test Acc: 0.084
Validation loss decreased (-0.037613 --> -0.083495).  Saving model ...
Epoch: 3 cost time: 4.207119941711426
Epoch: 3, Steps: 10 | Train Loss: 2.030 Vali Loss: 3.488 Vali Acc: 0.096 Test Loss: 3.488 Test Acc: 0.096
Validation loss decreased (-0.083495 --> -0.096436).  Saving model ...
Epoch: 4 cost time: 3.9597253799438477
Epoch: 4, Steps: 10 | Train Loss: 1.094 Vali Loss: 4.083 Vali Acc: 0.101 Test Loss: 4.083 Test Acc: 0.101
Validation loss decreased (-0.096436 --> -0.101136).  Saving model ...
Epoch: 5 cost time: 4.37546968460083
Epoch: 5, Steps: 10 | Train Loss: 0.455 Vali Loss: 4.572 Vali Acc: 0.101 Test Loss: 4.572 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.038638353347778
Epoch: 6, Steps: 10 | Train Loss: 0.152 Vali Loss: 5.558 Vali Acc: 0.105 Test Loss: 5.558 Test Acc: 0.105
Validation loss decreased (-0.101136 --> -0.104650).  Saving model ...
Epoch: 7 cost time: 4.015208721160889
Epoch: 7, Steps: 10 | Train Loss: 0.049 Vali Loss: 6.122 Vali Acc: 0.124 Test Loss: 6.122 Test Acc: 0.124
Validation loss decreased (-0.104650 --> -0.123468).  Saving model ...
Epoch: 8 cost time: 4.02998948097229
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.272 Vali Acc: 0.104 Test Loss: 6.272 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.1919639110565186
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.623 Vali Acc: 0.114 Test Loss: 6.623 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7089755535125732
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.790 Vali Acc: 0.121 Test Loss: 6.790 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.214092254638672
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.855 Vali Acc: 0.126 Test Loss: 6.855 Test Acc: 0.126
Validation loss decreased (-0.123468 --> -0.125814).  Saving model ...
Epoch: 12 cost time: 3.8228578567504883
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.736 Vali Acc: 0.125 Test Loss: 6.736 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.436620712280273
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.752 Vali Acc: 0.128 Test Loss: 6.752 Test Acc: 0.128
Validation loss decreased (-0.125814 --> -0.128168).  Saving model ...
Epoch: 14 cost time: 4.140586614608765
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.776 Vali Acc: 0.129 Test Loss: 6.776 Test Acc: 0.129
Validation loss decreased (-0.128168 --> -0.129344).  Saving model ...
Epoch: 15 cost time: 4.30133318901062
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.809 Vali Acc: 0.133 Test Loss: 6.809 Test Acc: 0.133
Validation loss decreased (-0.129344 --> -0.132873).  Saving model ...
Epoch: 16 cost time: 4.375178098678589
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.831 Vali Acc: 0.132 Test Loss: 6.831 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.147317171096802
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.845 Vali Acc: 0.131 Test Loss: 6.845 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.363371849060059
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.868 Vali Acc: 0.133 Test Loss: 6.868 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.197868585586548
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.886 Vali Acc: 0.133 Test Loss: 6.886 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.964669704437256
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.892 Vali Acc: 0.133 Test Loss: 6.892 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.494877576828003
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.894 Vali Acc: 0.135 Test Loss: 6.894 Test Acc: 0.135
Validation loss decreased (-0.132873 --> -0.135225).  Saving model ...
Epoch: 22 cost time: 3.7681589126586914
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.912 Vali Acc: 0.135 Test Loss: 6.912 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.553054332733154
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.927 Vali Acc: 0.133 Test Loss: 6.927 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.852281093597412
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.942 Vali Acc: 0.131 Test Loss: 6.942 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.949517011642456
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.951 Vali Acc: 0.131 Test Loss: 6.951 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.8439745903015137
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.966 Vali Acc: 0.129 Test Loss: 6.966 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.096983432769775
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.973 Vali Acc: 0.131 Test Loss: 6.973 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.177259683609009
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.982 Vali Acc: 0.128 Test Loss: 6.982 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.2868406772613525
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.992 Vali Acc: 0.127 Test Loss: 6.992 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.9208452701568604
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.003 Vali Acc: 0.127 Test Loss: 7.003 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.202223777770996
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.018 Vali Acc: 0.127 Test Loss: 7.018 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13529411764705881
model parameter : 15684634
model size : 79.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.91249680519104
Epoch: 1, Steps: 10 | Train Loss: 3.449 Vali Loss: 3.420 Vali Acc: 0.045 Test Loss: 3.420 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 4.293081998825073
Epoch: 2, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.519 Vali Acc: 0.062 Test Loss: 3.519 Test Acc: 0.062
Validation loss decreased (-0.044672 --> -0.062318).  Saving model ...
Epoch: 3 cost time: 4.3502137660980225
Epoch: 3, Steps: 10 | Train Loss: 2.307 Vali Loss: 3.425 Vali Acc: 0.100 Test Loss: 3.425 Test Acc: 0.100
Validation loss decreased (-0.062318 --> -0.099966).  Saving model ...
Epoch: 4 cost time: 4.322764873504639
Epoch: 4, Steps: 10 | Train Loss: 1.451 Vali Loss: 3.867 Vali Acc: 0.105 Test Loss: 3.867 Test Acc: 0.105
Validation loss decreased (-0.099966 --> -0.104667).  Saving model ...
Epoch: 5 cost time: 4.12194561958313
Epoch: 5, Steps: 10 | Train Loss: 0.725 Vali Loss: 4.246 Vali Acc: 0.100 Test Loss: 4.246 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.342442750930786
Epoch: 6, Steps: 10 | Train Loss: 0.270 Vali Loss: 5.216 Vali Acc: 0.109 Test Loss: 5.216 Test Acc: 0.109
Validation loss decreased (-0.104667 --> -0.109360).  Saving model ...
Epoch: 7 cost time: 4.2691545486450195
Epoch: 7, Steps: 10 | Train Loss: 0.104 Vali Loss: 5.575 Vali Acc: 0.122 Test Loss: 5.575 Test Acc: 0.122
Validation loss decreased (-0.109360 --> -0.122297).  Saving model ...
Epoch: 8 cost time: 4.200066566467285
Epoch: 8, Steps: 10 | Train Loss: 0.047 Vali Loss: 6.235 Vali Acc: 0.102 Test Loss: 6.235 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.273825407028198
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.245 Vali Acc: 0.122 Test Loss: 6.245 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.998570203781128
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 6.276 Vali Acc: 0.115 Test Loss: 6.276 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.571818828582764
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 6.587 Vali Acc: 0.107 Test Loss: 6.587 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.849116563796997
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.959 Vali Acc: 0.100 Test Loss: 6.959 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.100521564483643
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.709 Vali Acc: 0.106 Test Loss: 6.709 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.9140825271606445
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.690 Vali Acc: 0.101 Test Loss: 6.690 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.955076217651367
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.706 Vali Acc: 0.104 Test Loss: 6.706 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.08624529838562
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.724 Vali Acc: 0.106 Test Loss: 6.724 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.229994535446167
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.720 Vali Acc: 0.106 Test Loss: 6.720 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1223529411764706
model parameter : 15684634
model size : 79.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.764880418777466
Epoch: 1, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.378 Vali Acc: 0.053 Test Loss: 3.378 Test Acc: 0.053
Validation loss decreased (inf --> -0.052907).  Saving model ...
Epoch: 2 cost time: 3.7942676544189453
Epoch: 2, Steps: 10 | Train Loss: 3.144 Vali Loss: 3.511 Vali Acc: 0.069 Test Loss: 3.511 Test Acc: 0.069
Validation loss decreased (-0.052907 --> -0.069377).  Saving model ...
Epoch: 3 cost time: 4.249306917190552
Epoch: 3, Steps: 10 | Train Loss: 2.400 Vali Loss: 3.393 Vali Acc: 0.111 Test Loss: 3.393 Test Acc: 0.111
Validation loss decreased (-0.069377 --> -0.110554).  Saving model ...
Epoch: 4 cost time: 3.576249599456787
Epoch: 4, Steps: 10 | Train Loss: 1.707 Vali Loss: 3.791 Vali Acc: 0.101 Test Loss: 3.791 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.093702793121338
Epoch: 5, Steps: 10 | Train Loss: 0.922 Vali Loss: 4.148 Vali Acc: 0.132 Test Loss: 4.148 Test Acc: 0.132
Validation loss decreased (-0.110554 --> -0.131723).  Saving model ...
Epoch: 6 cost time: 3.5003821849823
Epoch: 6, Steps: 10 | Train Loss: 0.439 Vali Loss: 5.067 Vali Acc: 0.104 Test Loss: 5.067 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.0376503467559814
Epoch: 7, Steps: 10 | Train Loss: 0.184 Vali Loss: 5.235 Vali Acc: 0.139 Test Loss: 5.235 Test Acc: 0.139
Validation loss decreased (-0.131723 --> -0.138771).  Saving model ...
Epoch: 8 cost time: 4.142071962356567
Epoch: 8, Steps: 10 | Train Loss: 0.082 Vali Loss: 5.894 Vali Acc: 0.142 Test Loss: 5.894 Test Acc: 0.142
Validation loss decreased (-0.138771 --> -0.142294).  Saving model ...
Epoch: 9 cost time: 4.394923448562622
Epoch: 9, Steps: 10 | Train Loss: 0.039 Vali Loss: 6.043 Vali Acc: 0.144 Test Loss: 6.043 Test Acc: 0.144
Validation loss decreased (-0.142294 --> -0.143469).  Saving model ...
Epoch: 10 cost time: 4.127898931503296
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.386 Vali Acc: 0.131 Test Loss: 6.386 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.22236704826355
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 6.825 Vali Acc: 0.122 Test Loss: 6.825 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.953871726989746
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 6.697 Vali Acc: 0.145 Test Loss: 6.697 Test Acc: 0.145
Validation loss decreased (-0.143469 --> -0.144639).  Saving model ...
Epoch: 13 cost time: 3.6365387439727783
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.343 Vali Acc: 0.118 Test Loss: 7.343 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.615348815917969
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.278 Vali Acc: 0.120 Test Loss: 7.278 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.005064249038696
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.247 Vali Acc: 0.116 Test Loss: 7.247 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.176484823226929
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.220 Vali Acc: 0.121 Test Loss: 7.220 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.240460634231567
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.293 Vali Acc: 0.125 Test Loss: 7.293 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.187269687652588
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.354 Vali Acc: 0.126 Test Loss: 7.354 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.6784024238586426
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.396 Vali Acc: 0.129 Test Loss: 7.396 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.124741792678833
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.388 Vali Acc: 0.133 Test Loss: 7.388 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.9303691387176514
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.350 Vali Acc: 0.134 Test Loss: 7.350 Test Acc: 0.134
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.9973132610321045
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.318 Vali Acc: 0.131 Test Loss: 7.318 Test Acc: 0.131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14470588235294118
model parameter : 15684634
model size : 79.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.940719842910767
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 4.179109334945679
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 3 cost time: 4.0082714557647705
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 4 cost time: 4.7993128299713135
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 5 cost time: 5.797076225280762
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 6 cost time: 5.302403450012207
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 7 cost time: 4.612627029418945
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 8 cost time: 4.6146321296691895
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 9 cost time: 4.52004337310791
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 10 cost time: 4.030012369155884
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 11 cost time: 4.637527227401733
Epoch: 11, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 12 cost time: 4.302438735961914
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 13 cost time: 4.285146713256836
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 14 cost time: 4.023876428604126
Epoch: 14, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 15 cost time: 4.2287938594818115
Epoch: 15, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 16 cost time: 3.8289778232574463
Epoch: 16, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 17 cost time: 3.9512217044830322
Epoch: 17, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 18 cost time: 4.1008689403533936
Epoch: 18, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 19 cost time: 4.251021862030029
Epoch: 19, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 20 cost time: 3.874584674835205
Epoch: 20, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 21 cost time: 4.1258704662323
Epoch: 21, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 22 cost time: 4.407484769821167
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.034085 --> -0.050556).  Saving model ...
Epoch: 23 cost time: 4.436451196670532
Epoch: 23, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 24 cost time: 4.700220108032227
Epoch: 24, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 25 cost time: 4.636935234069824
Epoch: 25, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.731693506240845
Epoch: 26, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.8413245677948
Epoch: 27, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.171593189239502
Epoch: 28, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.645016193389893
Epoch: 29, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.7655980587005615
Epoch: 30, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.640095949172974
Epoch: 31, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.619077920913696
Epoch: 32, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.66972541809082
Epoch: 33, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.999327182769775
Epoch: 34, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.05058823529411765
model parameter : 15684634
model size : 79.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.735738754272461
Epoch: 1, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.396 Vali Acc: 0.101 Test Loss: 3.396 Test Acc: 0.101
Validation loss decreased (inf --> -0.101143).  Saving model ...
Epoch: 2 cost time: 4.734590768814087
Epoch: 2, Steps: 10 | Train Loss: 2.368 Vali Loss: 3.352 Vali Acc: 0.202 Test Loss: 3.352 Test Acc: 0.202
Validation loss decreased (-0.101143 --> -0.202319).  Saving model ...
Epoch: 3 cost time: 4.616712331771851
Epoch: 3, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.641 Vali Acc: 0.214 Test Loss: 3.641 Test Acc: 0.214
Validation loss decreased (-0.202319 --> -0.214081).  Saving model ...
Epoch: 4 cost time: 4.533185958862305
Epoch: 4, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.975 Vali Acc: 0.272 Test Loss: 3.975 Test Acc: 0.272
Validation loss decreased (-0.214081 --> -0.271725).  Saving model ...
Epoch: 5 cost time: 4.385580062866211
Epoch: 5, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.560 Vali Acc: 0.244 Test Loss: 4.560 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.469106912612915
Epoch: 6, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.999 Vali Acc: 0.245 Test Loss: 4.999 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.586338043212891
Epoch: 7, Steps: 10 | Train Loss: 0.089 Vali Loss: 5.728 Vali Acc: 0.265 Test Loss: 5.728 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.652902603149414
Epoch: 8, Steps: 10 | Train Loss: 0.049 Vali Loss: 5.413 Vali Acc: 0.298 Test Loss: 5.413 Test Acc: 0.298
Validation loss decreased (-0.271725 --> -0.297593).  Saving model ...
Epoch: 9 cost time: 4.833562612533569
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.656 Vali Acc: 0.280 Test Loss: 5.656 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.43141770362854
Epoch: 10, Steps: 10 | Train Loss: 0.042 Vali Loss: 6.464 Vali Acc: 0.236 Test Loss: 6.464 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.855241537094116
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.375 Vali Acc: 0.254 Test Loss: 6.375 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.480233430862427
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.313 Vali Acc: 0.272 Test Loss: 6.313 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.591846466064453
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.317 Vali Acc: 0.272 Test Loss: 6.317 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.370874881744385
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.343 Vali Acc: 0.275 Test Loss: 6.343 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.747084617614746
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.331 Vali Acc: 0.276 Test Loss: 6.331 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.746860504150391
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.309 Vali Acc: 0.276 Test Loss: 6.309 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.757360458374023
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.296 Vali Acc: 0.279 Test Loss: 6.296 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.538702011108398
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.284 Vali Acc: 0.279 Test Loss: 6.284 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 14111770
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.414201736450195
Epoch: 1, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.396 Vali Acc: 0.094 Test Loss: 3.396 Test Acc: 0.094
Validation loss decreased (inf --> -0.094084).  Saving model ...
Epoch: 2 cost time: 4.343613862991333
Epoch: 2, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.350 Vali Acc: 0.189 Test Loss: 3.350 Test Acc: 0.189
Validation loss decreased (-0.094084 --> -0.189378).  Saving model ...
Epoch: 3 cost time: 4.042460918426514
Epoch: 3, Steps: 10 | Train Loss: 1.045 Vali Loss: 3.575 Vali Acc: 0.244 Test Loss: 3.575 Test Acc: 0.244
Validation loss decreased (-0.189378 --> -0.243494).  Saving model ...
Epoch: 4 cost time: 4.271548509597778
Epoch: 4, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.932 Vali Acc: 0.291 Test Loss: 3.932 Test Acc: 0.291
Validation loss decreased (-0.243494 --> -0.290549).  Saving model ...
Epoch: 5 cost time: 4.537508249282837
Epoch: 5, Steps: 10 | Train Loss: 0.112 Vali Loss: 4.450 Vali Acc: 0.272 Test Loss: 4.450 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.37263298034668
Epoch: 6, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.827 Vali Acc: 0.286 Test Loss: 4.827 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.208446264266968
Epoch: 7, Steps: 10 | Train Loss: 0.057 Vali Loss: 5.436 Vali Acc: 0.272 Test Loss: 5.436 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.381546258926392
Epoch: 8, Steps: 10 | Train Loss: 0.069 Vali Loss: 5.525 Vali Acc: 0.288 Test Loss: 5.525 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.8527867794036865
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 5.819 Vali Acc: 0.262 Test Loss: 5.819 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.4786975383758545
Epoch: 10, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.888 Vali Acc: 0.279 Test Loss: 5.888 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.520936489105225
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.119 Vali Acc: 0.265 Test Loss: 6.119 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.354825735092163
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.242 Vali Acc: 0.267 Test Loss: 6.242 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.11599588394165
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.245 Vali Acc: 0.273 Test Loss: 6.245 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.271291732788086
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.142 Vali Acc: 0.286 Test Loss: 6.142 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 14111770
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.28210711479187
Epoch: 1, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.380 Vali Acc: 0.100 Test Loss: 3.380 Test Acc: 0.100
Validation loss decreased (inf --> -0.099966).  Saving model ...
Epoch: 2 cost time: 4.601072072982788
Epoch: 2, Steps: 10 | Train Loss: 2.374 Vali Loss: 3.452 Vali Acc: 0.198 Test Loss: 3.452 Test Acc: 0.198
Validation loss decreased (-0.099966 --> -0.197613).  Saving model ...
Epoch: 3 cost time: 4.718218088150024
Epoch: 3, Steps: 10 | Train Loss: 1.212 Vali Loss: 3.710 Vali Acc: 0.224 Test Loss: 3.710 Test Acc: 0.224
Validation loss decreased (-0.197613 --> -0.223492).  Saving model ...
Epoch: 4 cost time: 4.598809242248535
Epoch: 4, Steps: 10 | Train Loss: 0.502 Vali Loss: 4.004 Vali Acc: 0.280 Test Loss: 4.004 Test Acc: 0.280
Validation loss decreased (-0.223492 --> -0.279960).  Saving model ...
Epoch: 5 cost time: 4.450531482696533
Epoch: 5, Steps: 10 | Train Loss: 0.184 Vali Loss: 4.499 Vali Acc: 0.269 Test Loss: 4.499 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.327147722244263
Epoch: 6, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.872 Vali Acc: 0.281 Test Loss: 4.872 Test Acc: 0.281
Validation loss decreased (-0.279960 --> -0.281128).  Saving model ...
Epoch: 7 cost time: 4.190049648284912
Epoch: 7, Steps: 10 | Train Loss: 0.107 Vali Loss: 5.379 Vali Acc: 0.256 Test Loss: 5.379 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.295734405517578
Epoch: 8, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.525 Vali Acc: 0.287 Test Loss: 5.525 Test Acc: 0.287
Validation loss decreased (-0.281128 --> -0.287004).  Saving model ...
Epoch: 9 cost time: 4.575292587280273
Epoch: 9, Steps: 10 | Train Loss: 0.071 Vali Loss: 6.382 Vali Acc: 0.266 Test Loss: 6.382 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.552942752838135
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 6.195 Vali Acc: 0.255 Test Loss: 6.195 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.896464109420776
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 6.884 Vali Acc: 0.252 Test Loss: 6.884 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.929060459136963
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 6.575 Vali Acc: 0.273 Test Loss: 6.575 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.68585991859436
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 6.901 Vali Acc: 0.248 Test Loss: 6.901 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.572993278503418
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 6.805 Vali Acc: 0.272 Test Loss: 6.805 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.814263820648193
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 7.004 Vali Acc: 0.254 Test Loss: 7.004 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.6418070793151855
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 7.200 Vali Acc: 0.265 Test Loss: 7.200 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.515725612640381
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 6.964 Vali Acc: 0.275 Test Loss: 6.964 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.317061424255371
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 8.881 Vali Acc: 0.236 Test Loss: 8.881 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 14111770
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 7.016874074935913
Epoch: 1, Steps: 10 | Train Loss: 3.281 Vali Loss: 3.428 Vali Acc: 0.095 Test Loss: 3.428 Test Acc: 0.095
Validation loss decreased (inf --> -0.095260).  Saving model ...
Epoch: 2 cost time: 4.898930549621582
Epoch: 2, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.594 Vali Acc: 0.151 Test Loss: 3.594 Test Acc: 0.151
Validation loss decreased (-0.095260 --> -0.150552).  Saving model ...
Epoch: 3 cost time: 4.2472147941589355
Epoch: 3, Steps: 10 | Train Loss: 1.304 Vali Loss: 4.010 Vali Acc: 0.160 Test Loss: 4.010 Test Acc: 0.160
Validation loss decreased (-0.150552 --> -0.159960).  Saving model ...
Epoch: 4 cost time: 4.230627059936523
Epoch: 4, Steps: 10 | Train Loss: 0.570 Vali Loss: 4.317 Vali Acc: 0.215 Test Loss: 4.317 Test Acc: 0.215
Validation loss decreased (-0.159960 --> -0.215251).  Saving model ...
Epoch: 5 cost time: 4.3694446086883545
Epoch: 5, Steps: 10 | Train Loss: 0.213 Vali Loss: 4.922 Vali Acc: 0.200 Test Loss: 4.922 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.543925046920776
Epoch: 6, Steps: 10 | Train Loss: 0.139 Vali Loss: 5.288 Vali Acc: 0.216 Test Loss: 5.288 Test Acc: 0.216
Validation loss decreased (-0.215251 --> -0.216418).  Saving model ...
Epoch: 7 cost time: 4.611077070236206
Epoch: 7, Steps: 10 | Train Loss: 0.134 Vali Loss: 5.681 Vali Acc: 0.215 Test Loss: 5.681 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.427533388137817
Epoch: 8, Steps: 10 | Train Loss: 0.048 Vali Loss: 6.272 Vali Acc: 0.220 Test Loss: 6.272 Test Acc: 0.220
Validation loss decreased (-0.216418 --> -0.219937).  Saving model ...
Epoch: 9 cost time: 4.565077781677246
Epoch: 9, Steps: 10 | Train Loss: 0.115 Vali Loss: 7.176 Vali Acc: 0.205 Test Loss: 7.176 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.382821559906006
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 7.027 Vali Acc: 0.214 Test Loss: 7.027 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.236708402633667
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 7.165 Vali Acc: 0.228 Test Loss: 7.165 Test Acc: 0.228
Validation loss decreased (-0.219937 --> -0.228164).  Saving model ...
Epoch: 12 cost time: 4.708032131195068
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 7.472 Vali Acc: 0.218 Test Loss: 7.472 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.380076169967651
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 8.088 Vali Acc: 0.227 Test Loss: 8.088 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.305589199066162
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 8.239 Vali Acc: 0.204 Test Loss: 8.239 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.640692710876465
Epoch: 15, Steps: 10 | Train Loss: 0.077 Vali Loss: 8.612 Vali Acc: 0.212 Test Loss: 8.612 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.152497053146362
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 9.864 Vali Acc: 0.191 Test Loss: 9.864 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.230967283248901
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 9.407 Vali Acc: 0.213 Test Loss: 9.407 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.620597839355469
Epoch: 18, Steps: 10 | Train Loss: 0.122 Vali Loss: 9.894 Vali Acc: 0.202 Test Loss: 9.894 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.181782007217407
Epoch: 19, Steps: 10 | Train Loss: 0.164 Vali Loss: 10.656 Vali Acc: 0.189 Test Loss: 10.656 Test Acc: 0.189
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.9650561809539795
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 10.538 Vali Acc: 0.200 Test Loss: 10.538 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.529916763305664
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 11.301 Vali Acc: 0.196 Test Loss: 11.301 Test Acc: 0.196
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22823529411764706
model parameter : 14111770
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.1646645069122314
Epoch: 1, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.449 Vali Acc: 0.055 Test Loss: 3.449 Test Acc: 0.055
Validation loss decreased (inf --> -0.055260).  Saving model ...
Epoch: 2 cost time: 4.597023963928223
Epoch: 2, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.563 Vali Acc: 0.089 Test Loss: 3.563 Test Acc: 0.089
Validation loss decreased (-0.055260 --> -0.089376).  Saving model ...
Epoch: 3 cost time: 4.181149244308472
Epoch: 3, Steps: 10 | Train Loss: 1.234 Vali Loss: 3.780 Vali Acc: 0.116 Test Loss: 3.780 Test Acc: 0.116
Validation loss decreased (-0.089376 --> -0.116433).  Saving model ...
Epoch: 4 cost time: 4.0033183097839355
Epoch: 4, Steps: 10 | Train Loss: 0.453 Vali Loss: 4.485 Vali Acc: 0.127 Test Loss: 4.485 Test Acc: 0.127
Validation loss decreased (-0.116433 --> -0.127014).  Saving model ...
Epoch: 5 cost time: 4.10358190536499
Epoch: 5, Steps: 10 | Train Loss: 0.106 Vali Loss: 5.255 Vali Acc: 0.127 Test Loss: 5.255 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.095353126525879
Epoch: 6, Steps: 10 | Train Loss: 0.038 Vali Loss: 5.724 Vali Acc: 0.129 Test Loss: 5.724 Test Acc: 0.129
Validation loss decreased (-0.127014 --> -0.129355).  Saving model ...
Epoch: 7 cost time: 3.927515745162964
Epoch: 7, Steps: 10 | Train Loss: 0.017 Vali Loss: 6.125 Vali Acc: 0.140 Test Loss: 6.125 Test Acc: 0.140
Validation loss decreased (-0.129355 --> -0.139939).  Saving model ...
Epoch: 8 cost time: 4.132671117782593
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.573 Vali Acc: 0.134 Test Loss: 6.573 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.129518747329712
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.742 Vali Acc: 0.136 Test Loss: 6.742 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.289435863494873
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.673 Vali Acc: 0.145 Test Loss: 6.673 Test Acc: 0.145
Validation loss decreased (-0.139939 --> -0.144639).  Saving model ...
Epoch: 11 cost time: 4.198442697525024
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.655 Vali Acc: 0.151 Test Loss: 6.655 Test Acc: 0.151
Validation loss decreased (-0.144639 --> -0.150522).  Saving model ...
Epoch: 12 cost time: 4.256306409835815
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.680 Vali Acc: 0.153 Test Loss: 6.680 Test Acc: 0.153
Validation loss decreased (-0.150522 --> -0.152874).  Saving model ...
Epoch: 13 cost time: 3.9569809436798096
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.687 Vali Acc: 0.152 Test Loss: 6.687 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.733409881591797
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.689 Vali Acc: 0.149 Test Loss: 6.689 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.074123382568359
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.693 Vali Acc: 0.149 Test Loss: 6.693 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.547313451766968
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.700 Vali Acc: 0.151 Test Loss: 6.700 Test Acc: 0.151
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.64352822303772
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.708 Vali Acc: 0.152 Test Loss: 6.708 Test Acc: 0.152
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.295509576797485
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.718 Vali Acc: 0.152 Test Loss: 6.718 Test Acc: 0.152
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.312467813491821
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.731 Vali Acc: 0.153 Test Loss: 6.731 Test Acc: 0.153
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.394163131713867
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.743 Vali Acc: 0.152 Test Loss: 6.743 Test Acc: 0.152
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.31230616569519
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.751 Vali Acc: 0.153 Test Loss: 6.751 Test Acc: 0.153
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.908934593200684
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.760 Vali Acc: 0.152 Test Loss: 6.760 Test Acc: 0.152
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15294117647058825
model parameter : 14111770
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.5747153759002686
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.440 Vali Acc: 0.041 Test Loss: 3.440 Test Acc: 0.041
Validation loss decreased (inf --> -0.041142).  Saving model ...
Epoch: 2 cost time: 4.240444898605347
Epoch: 2, Steps: 10 | Train Loss: 2.800 Vali Loss: 3.592 Vali Acc: 0.076 Test Loss: 3.592 Test Acc: 0.076
Validation loss decreased (-0.041142 --> -0.076435).  Saving model ...
Epoch: 3 cost time: 4.066040992736816
Epoch: 3, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.581 Vali Acc: 0.078 Test Loss: 3.581 Test Acc: 0.078
Validation loss decreased (-0.076435 --> -0.077611).  Saving model ...
Epoch: 4 cost time: 4.190265655517578
Epoch: 4, Steps: 10 | Train Loss: 0.707 Vali Loss: 4.096 Vali Acc: 0.100 Test Loss: 4.096 Test Acc: 0.100
Validation loss decreased (-0.077611 --> -0.099959).  Saving model ...
Epoch: 5 cost time: 4.194939374923706
Epoch: 5, Steps: 10 | Train Loss: 0.213 Vali Loss: 4.735 Vali Acc: 0.096 Test Loss: 4.735 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.411057949066162
Epoch: 6, Steps: 10 | Train Loss: 0.080 Vali Loss: 5.738 Vali Acc: 0.096 Test Loss: 5.738 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.428237438201904
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 5.800 Vali Acc: 0.106 Test Loss: 5.800 Test Acc: 0.106
Validation loss decreased (-0.099959 --> -0.105824).  Saving model ...
Epoch: 8 cost time: 4.829036474227905
Epoch: 8, Steps: 10 | Train Loss: 0.027 Vali Loss: 6.458 Vali Acc: 0.106 Test Loss: 6.458 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.819185972213745
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 6.558 Vali Acc: 0.120 Test Loss: 6.558 Test Acc: 0.120
Validation loss decreased (-0.105824 --> -0.119934).  Saving model ...
Epoch: 10 cost time: 4.439835786819458
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.588 Vali Acc: 0.113 Test Loss: 6.588 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.37000036239624
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.736 Vali Acc: 0.113 Test Loss: 6.736 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.358847379684448
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.882 Vali Acc: 0.105 Test Loss: 6.882 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.443156480789185
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.816 Vali Acc: 0.112 Test Loss: 6.816 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.399640321731567
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.753 Vali Acc: 0.115 Test Loss: 6.753 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.660040378570557
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.729 Vali Acc: 0.118 Test Loss: 6.729 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.9949796199798584
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.730 Vali Acc: 0.120 Test Loss: 6.730 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.135101318359375
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.745 Vali Acc: 0.119 Test Loss: 6.745 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.116403102874756
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.762 Vali Acc: 0.121 Test Loss: 6.762 Test Acc: 0.121
Validation loss decreased (-0.119934 --> -0.121109).  Saving model ...
Epoch: 19 cost time: 4.013512372970581
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.777 Vali Acc: 0.118 Test Loss: 6.777 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7047605514526367
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.784 Vali Acc: 0.116 Test Loss: 6.784 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.2934184074401855
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.792 Vali Acc: 0.119 Test Loss: 6.792 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.236874580383301
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.799 Vali Acc: 0.122 Test Loss: 6.799 Test Acc: 0.122
Validation loss decreased (-0.121109 --> -0.122285).  Saving model ...
Epoch: 23 cost time: 4.573446989059448
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.804 Vali Acc: 0.120 Test Loss: 6.804 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.058028936386108
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.815 Vali Acc: 0.118 Test Loss: 6.815 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.0557475090026855
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.825 Vali Acc: 0.119 Test Loss: 6.825 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.090420722961426
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.836 Vali Acc: 0.118 Test Loss: 6.836 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.053917646408081
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.844 Vali Acc: 0.118 Test Loss: 6.844 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.159785270690918
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.854 Vali Acc: 0.119 Test Loss: 6.854 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.239087343215942
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.866 Vali Acc: 0.118 Test Loss: 6.866 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.259321451187134
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.875 Vali Acc: 0.118 Test Loss: 6.875 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.922757387161255
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.884 Vali Acc: 0.116 Test Loss: 6.884 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.003188371658325
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.894 Vali Acc: 0.116 Test Loss: 6.894 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1223529411764706
model parameter : 14111770
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.028086185455322
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.433 Vali Acc: 0.048 Test Loss: 3.433 Test Acc: 0.048
Validation loss decreased (inf --> -0.048201).  Saving model ...
Epoch: 2 cost time: 4.3774402141571045
Epoch: 2, Steps: 10 | Train Loss: 2.980 Vali Loss: 3.660 Vali Acc: 0.074 Test Loss: 3.660 Test Acc: 0.074
Validation loss decreased (-0.048201 --> -0.074081).  Saving model ...
Epoch: 3 cost time: 4.079259634017944
Epoch: 3, Steps: 10 | Train Loss: 2.025 Vali Loss: 3.500 Vali Acc: 0.095 Test Loss: 3.500 Test Acc: 0.095
Validation loss decreased (-0.074081 --> -0.095259).  Saving model ...
Epoch: 4 cost time: 4.859531879425049
Epoch: 4, Steps: 10 | Train Loss: 1.109 Vali Loss: 4.070 Vali Acc: 0.099 Test Loss: 4.070 Test Acc: 0.099
Validation loss decreased (-0.095259 --> -0.098783).  Saving model ...
Epoch: 5 cost time: 4.294990539550781
Epoch: 5, Steps: 10 | Train Loss: 0.443 Vali Loss: 4.657 Vali Acc: 0.101 Test Loss: 4.657 Test Acc: 0.101
Validation loss decreased (-0.098783 --> -0.101130).  Saving model ...
Epoch: 6 cost time: 4.348267078399658
Epoch: 6, Steps: 10 | Train Loss: 0.177 Vali Loss: 5.490 Vali Acc: 0.105 Test Loss: 5.490 Test Acc: 0.105
Validation loss decreased (-0.101130 --> -0.104651).  Saving model ...
Epoch: 7 cost time: 4.229981899261475
Epoch: 7, Steps: 10 | Train Loss: 0.069 Vali Loss: 5.991 Vali Acc: 0.114 Test Loss: 5.991 Test Acc: 0.114
Validation loss decreased (-0.104651 --> -0.114058).  Saving model ...
Epoch: 8 cost time: 4.02392315864563
Epoch: 8, Steps: 10 | Train Loss: 0.032 Vali Loss: 6.450 Vali Acc: 0.127 Test Loss: 6.450 Test Acc: 0.127
Validation loss decreased (-0.114058 --> -0.126994).  Saving model ...
Epoch: 9 cost time: 4.64890456199646
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.730 Vali Acc: 0.107 Test Loss: 6.730 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.370646238327026
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.921 Vali Acc: 0.111 Test Loss: 6.921 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.316345930099487
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.027 Vali Acc: 0.113 Test Loss: 7.027 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.786360025405884
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.040 Vali Acc: 0.116 Test Loss: 7.040 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.34963583946228
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.031 Vali Acc: 0.118 Test Loss: 7.031 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.297377109527588
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.017 Vali Acc: 0.122 Test Loss: 7.017 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.226181507110596
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.016 Vali Acc: 0.124 Test Loss: 7.016 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.523923635482788
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.020 Vali Acc: 0.127 Test Loss: 7.020 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.342843294143677
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.033 Vali Acc: 0.125 Test Loss: 7.033 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.268000841140747
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.045 Vali Acc: 0.126 Test Loss: 7.045 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12705882352941175
model parameter : 14111770
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.040862560272217
Epoch: 1, Steps: 10 | Train Loss: 3.343 Vali Loss: 3.402 Vali Acc: 0.035 Test Loss: 3.402 Test Acc: 0.035
Validation loss decreased (inf --> -0.035260).  Saving model ...
Epoch: 2 cost time: 4.434918642044067
Epoch: 2, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.645 Vali Acc: 0.069 Test Loss: 3.645 Test Acc: 0.069
Validation loss decreased (-0.035260 --> -0.069375).  Saving model ...
Epoch: 3 cost time: 4.406832933425903
Epoch: 3, Steps: 10 | Train Loss: 2.261 Vali Loss: 3.468 Vali Acc: 0.111 Test Loss: 3.468 Test Acc: 0.111
Validation loss decreased (-0.069375 --> -0.110554).  Saving model ...
Epoch: 4 cost time: 4.295536041259766
Epoch: 4, Steps: 10 | Train Loss: 1.449 Vali Loss: 3.886 Vali Acc: 0.085 Test Loss: 3.886 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.346844911575317
Epoch: 5, Steps: 10 | Train Loss: 0.784 Vali Loss: 4.317 Vali Acc: 0.105 Test Loss: 4.317 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.6790711879730225
Epoch: 6, Steps: 10 | Train Loss: 0.368 Vali Loss: 5.042 Vali Acc: 0.105 Test Loss: 5.042 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.724966526031494
Epoch: 7, Steps: 10 | Train Loss: 0.138 Vali Loss: 5.453 Vali Acc: 0.113 Test Loss: 5.453 Test Acc: 0.113
Validation loss decreased (-0.110554 --> -0.112887).  Saving model ...
Epoch: 8 cost time: 4.653189420700073
Epoch: 8, Steps: 10 | Train Loss: 0.072 Vali Loss: 5.824 Vali Acc: 0.127 Test Loss: 5.824 Test Acc: 0.127
Validation loss decreased (-0.112887 --> -0.127001).  Saving model ...
Epoch: 9 cost time: 4.504104852676392
Epoch: 9, Steps: 10 | Train Loss: 0.035 Vali Loss: 6.643 Vali Acc: 0.125 Test Loss: 6.643 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.13623833656311
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 6.820 Vali Acc: 0.115 Test Loss: 6.820 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.001459360122681
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 6.989 Vali Acc: 0.114 Test Loss: 6.989 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.13101863861084
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.043 Vali Acc: 0.112 Test Loss: 7.043 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.432071924209595
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.174 Vali Acc: 0.113 Test Loss: 7.174 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.220180511474609
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.130 Vali Acc: 0.125 Test Loss: 7.130 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.3083672523498535
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.152 Vali Acc: 0.121 Test Loss: 7.152 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.157923460006714
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.143 Vali Acc: 0.122 Test Loss: 7.143 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.125150203704834
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.133 Vali Acc: 0.125 Test Loss: 7.133 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.051561594009399
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.124 Vali Acc: 0.126 Test Loss: 7.124 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12705882352941175
model parameter : 14111770
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.722387075424194
Epoch: 1, Steps: 10 | Train Loss: 3.415 Vali Loss: 3.374 Vali Acc: 0.053 Test Loss: 3.374 Test Acc: 0.053
Validation loss decreased (inf --> -0.052907).  Saving model ...
Epoch: 2 cost time: 4.792547702789307
Epoch: 2, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.692 Vali Acc: 0.076 Test Loss: 3.692 Test Acc: 0.076
Validation loss decreased (-0.052907 --> -0.076434).  Saving model ...
Epoch: 3 cost time: 5.126713752746582
Epoch: 3, Steps: 10 | Train Loss: 2.472 Vali Loss: 3.443 Vali Acc: 0.102 Test Loss: 3.443 Test Acc: 0.102
Validation loss decreased (-0.076434 --> -0.102319).  Saving model ...
Epoch: 4 cost time: 4.220881223678589
Epoch: 4, Steps: 10 | Train Loss: 1.681 Vali Loss: 3.736 Vali Acc: 0.095 Test Loss: 3.736 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.2785444259643555
Epoch: 5, Steps: 10 | Train Loss: 0.963 Vali Loss: 4.195 Vali Acc: 0.112 Test Loss: 4.195 Test Acc: 0.112
Validation loss decreased (-0.102319 --> -0.111723).  Saving model ...
Epoch: 6 cost time: 4.4400293827056885
Epoch: 6, Steps: 10 | Train Loss: 0.556 Vali Loss: 4.814 Vali Acc: 0.127 Test Loss: 4.814 Test Acc: 0.127
Validation loss decreased (-0.111723 --> -0.127011).  Saving model ...
Epoch: 7 cost time: 4.693679571151733
Epoch: 7, Steps: 10 | Train Loss: 0.205 Vali Loss: 5.218 Vali Acc: 0.125 Test Loss: 5.218 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.634528875350952
Epoch: 8, Steps: 10 | Train Loss: 0.092 Vali Loss: 5.551 Vali Acc: 0.153 Test Loss: 5.551 Test Acc: 0.153
Validation loss decreased (-0.127011 --> -0.152886).  Saving model ...
Epoch: 9 cost time: 4.747693777084351
Epoch: 9, Steps: 10 | Train Loss: 0.056 Vali Loss: 6.508 Vali Acc: 0.138 Test Loss: 6.508 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.794100284576416
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 6.503 Vali Acc: 0.131 Test Loss: 6.503 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.3264148235321045
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.421 Vali Acc: 0.140 Test Loss: 6.421 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.361867427825928
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.508 Vali Acc: 0.149 Test Loss: 6.508 Test Acc: 0.149
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.478270769119263
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.617 Vali Acc: 0.160 Test Loss: 6.617 Test Acc: 0.160
Validation loss decreased (-0.152886 --> -0.159934).  Saving model ...
Epoch: 14 cost time: 4.406779766082764
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.606 Vali Acc: 0.154 Test Loss: 6.606 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.447567939758301
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.620 Vali Acc: 0.152 Test Loss: 6.620 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.52913236618042
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.598 Vali Acc: 0.149 Test Loss: 6.598 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.72010064125061
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.586 Vali Acc: 0.151 Test Loss: 6.586 Test Acc: 0.151
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.290035963058472
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.575 Vali Acc: 0.147 Test Loss: 6.575 Test Acc: 0.147
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.9455082416534424
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.574 Vali Acc: 0.147 Test Loss: 6.574 Test Acc: 0.147
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.453250885009766
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.581 Vali Acc: 0.146 Test Loss: 6.581 Test Acc: 0.146
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.3333518505096436
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.599 Vali Acc: 0.151 Test Loss: 6.599 Test Acc: 0.151
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.574704647064209
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.614 Vali Acc: 0.154 Test Loss: 6.614 Test Acc: 0.154
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.424000263214111
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.621 Vali Acc: 0.153 Test Loss: 6.621 Test Acc: 0.153
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16
model parameter : 14111770
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.120938539505005
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 4.2888853549957275
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 3 cost time: 4.273863077163696
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 4 cost time: 4.444662094116211
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 5 cost time: 4.569911956787109
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 6 cost time: 4.812083721160889
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 7 cost time: 4.2704596519470215
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.034085 --> -0.037614).  Saving model ...
Epoch: 8 cost time: 4.180655241012573
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 9 cost time: 4.240544319152832
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 10 cost time: 4.4295735359191895
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 11 cost time: 4.307138204574585
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 12 cost time: 4.5568201541900635
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 13 cost time: 4.290719509124756
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 14 cost time: 4.28619647026062
Epoch: 14, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 15 cost time: 4.165663480758667
Epoch: 15, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 16 cost time: 4.590900659561157
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 17 cost time: 4.974908113479614
Epoch: 17, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 18 cost time: 4.707199573516846
Epoch: 18, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 19 cost time: 4.485505819320679
Epoch: 19, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 20 cost time: 4.74667763710022
Epoch: 20, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 21 cost time: 4.284750461578369
Epoch: 21, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 22 cost time: 4.271432161331177
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 23 cost time: 4.853753566741943
Epoch: 23, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 24 cost time: 4.370070457458496
Epoch: 24, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 25 cost time: 4.847290515899658
Epoch: 25, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 26 cost time: 4.341305732727051
Epoch: 26, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.25288987159729
Epoch: 27, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 28 cost time: 4.362221002578735
Epoch: 28, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 29 cost time: 4.39420485496521
Epoch: 29, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 30 cost time: 4.474999666213989
Epoch: 30, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 31 cost time: 4.484194993972778
Epoch: 31, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 32 cost time: 4.118265390396118
Epoch: 32, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 33 cost time: 3.851752996444702
Epoch: 33, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 34 cost time: 4.493913173675537
Epoch: 34, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 35 cost time: 4.132042407989502
Epoch: 35, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 36 cost time: 4.204517364501953
Epoch: 36, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 37 cost time: 4.4408392906188965
Epoch: 37, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 38 cost time: 3.9671266078948975
Epoch: 38, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 39 cost time: 4.041943788528442
Epoch: 39, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 40 cost time: 3.9386708736419678
Epoch: 40, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 41 cost time: 4.386235237121582
Epoch: 41, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 4.623818635940552
Epoch: 42, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 43 cost time: 4.90568470954895
Epoch: 43, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 44 cost time: 4.526244163513184
Epoch: 44, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 4.256179571151733
Epoch: 45, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 4.069095849990845
Epoch: 46, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 4.149889230728149
Epoch: 47, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 4.19417929649353
Epoch: 48, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 4.4006736278533936
Epoch: 49, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 4.562122583389282
Epoch: 50, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 4.400438070297241
Epoch: 51, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 4.25952935218811
Epoch: 52, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 4.232705116271973
Epoch: 53, Steps: 10 | Train Loss: 3.239 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.03764705882352941
model parameter : 14111770
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.999984264373779
Epoch: 1, Steps: 10 | Train Loss: 3.410 Vali Loss: 3.422 Vali Acc: 0.113 Test Loss: 3.422 Test Acc: 0.113
Validation loss decreased (inf --> -0.112907).  Saving model ...
Epoch: 2 cost time: 4.463437080383301
Epoch: 2, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.318 Vali Acc: 0.211 Test Loss: 3.318 Test Acc: 0.211
Validation loss decreased (-0.112907 --> -0.210555).  Saving model ...
Epoch: 3 cost time: 4.4210662841796875
Epoch: 3, Steps: 10 | Train Loss: 1.009 Vali Loss: 3.576 Vali Acc: 0.208 Test Loss: 3.576 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.0700156688690186
Epoch: 4, Steps: 10 | Train Loss: 0.430 Vali Loss: 4.219 Vali Acc: 0.238 Test Loss: 4.219 Test Acc: 0.238
Validation loss decreased (-0.210555 --> -0.237605).  Saving model ...
Epoch: 5 cost time: 4.32839298248291
Epoch: 5, Steps: 10 | Train Loss: 0.299 Vali Loss: 4.322 Vali Acc: 0.280 Test Loss: 4.322 Test Acc: 0.280
Validation loss decreased (-0.237605 --> -0.279957).  Saving model ...
Epoch: 6 cost time: 4.3169777393341064
Epoch: 6, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.870 Vali Acc: 0.268 Test Loss: 4.870 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.523463010787964
Epoch: 7, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.243 Vali Acc: 0.262 Test Loss: 5.243 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.240665674209595
Epoch: 8, Steps: 10 | Train Loss: 0.022 Vali Loss: 5.584 Vali Acc: 0.251 Test Loss: 5.584 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.477658033370972
Epoch: 9, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.931 Vali Acc: 0.253 Test Loss: 5.931 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.534326076507568
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.924 Vali Acc: 0.265 Test Loss: 5.924 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.429280757904053
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 6.310 Vali Acc: 0.269 Test Loss: 6.310 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.060230731964111
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 6.068 Vali Acc: 0.284 Test Loss: 6.068 Test Acc: 0.284
Validation loss decreased (-0.279957 --> -0.283469).  Saving model ...
Epoch: 13 cost time: 4.354772329330444
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.320 Vali Acc: 0.294 Test Loss: 6.320 Test Acc: 0.294
Validation loss decreased (-0.283469 --> -0.294054).  Saving model ...
Epoch: 14 cost time: 4.395719528198242
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 6.835 Vali Acc: 0.258 Test Loss: 6.835 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.440694332122803
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.305 Vali Acc: 0.253 Test Loss: 7.305 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.3637049198150635
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 7.576 Vali Acc: 0.259 Test Loss: 7.576 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.002302169799805
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.260 Vali Acc: 0.231 Test Loss: 8.260 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.450430870056152
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 8.377 Vali Acc: 0.261 Test Loss: 8.377 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.9490859508514404
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 8.425 Vali Acc: 0.266 Test Loss: 8.425 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.6258556842803955
Epoch: 20, Steps: 10 | Train Loss: 0.078 Vali Loss: 8.573 Vali Acc: 0.266 Test Loss: 8.573 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.187044858932495
Epoch: 21, Steps: 10 | Train Loss: 0.060 Vali Loss: 8.673 Vali Acc: 0.288 Test Loss: 8.673 Test Acc: 0.288
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.462828636169434
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 9.992 Vali Acc: 0.219 Test Loss: 9.992 Test Acc: 0.219
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.272597074508667
Epoch: 23, Steps: 10 | Train Loss: 0.145 Vali Loss: 10.126 Vali Acc: 0.212 Test Loss: 10.126 Test Acc: 0.212
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29411764705882354
model parameter : 13325338
model size : 70.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.079213380813599
Epoch: 1, Steps: 10 | Train Loss: 3.381 Vali Loss: 3.407 Vali Acc: 0.085 Test Loss: 3.407 Test Acc: 0.085
Validation loss decreased (inf --> -0.084672).  Saving model ...
Epoch: 2 cost time: 4.233264446258545
Epoch: 2, Steps: 10 | Train Loss: 2.307 Vali Loss: 3.307 Vali Acc: 0.214 Test Loss: 3.307 Test Acc: 0.214
Validation loss decreased (-0.084672 --> -0.214085).  Saving model ...
Epoch: 3 cost time: 4.338999271392822
Epoch: 3, Steps: 10 | Train Loss: 1.005 Vali Loss: 3.568 Vali Acc: 0.228 Test Loss: 3.568 Test Acc: 0.228
Validation loss decreased (-0.214085 --> -0.228200).  Saving model ...
Epoch: 4 cost time: 5.085883140563965
Epoch: 4, Steps: 10 | Train Loss: 0.397 Vali Loss: 4.189 Vali Acc: 0.256 Test Loss: 4.189 Test Acc: 0.256
Validation loss decreased (-0.228200 --> -0.256429).  Saving model ...
Epoch: 5 cost time: 4.611126661300659
Epoch: 5, Steps: 10 | Train Loss: 0.209 Vali Loss: 4.399 Vali Acc: 0.291 Test Loss: 4.399 Test Acc: 0.291
Validation loss decreased (-0.256429 --> -0.290544).  Saving model ...
Epoch: 6 cost time: 4.43105673789978
Epoch: 6, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.969 Vali Acc: 0.285 Test Loss: 4.969 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.621544599533081
Epoch: 7, Steps: 10 | Train Loss: 0.037 Vali Loss: 5.315 Vali Acc: 0.284 Test Loss: 5.315 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.399480104446411
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.181 Vali Acc: 0.300 Test Loss: 5.181 Test Acc: 0.300
Validation loss decreased (-0.290544 --> -0.299948).  Saving model ...
Epoch: 9 cost time: 4.560314893722534
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.712 Vali Acc: 0.291 Test Loss: 5.712 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.383517026901245
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.981 Vali Acc: 0.280 Test Loss: 5.981 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.958073854446411
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 6.362 Vali Acc: 0.253 Test Loss: 6.362 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.784152984619141
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 6.070 Vali Acc: 0.296 Test Loss: 6.070 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.6504998207092285
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 6.625 Vali Acc: 0.282 Test Loss: 6.625 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.456507205963135
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 7.105 Vali Acc: 0.261 Test Loss: 7.105 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.845428466796875
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 7.459 Vali Acc: 0.253 Test Loss: 7.459 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.989788293838501
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 9.168 Vali Acc: 0.219 Test Loss: 9.168 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.242603778839111
Epoch: 17, Steps: 10 | Train Loss: 0.165 Vali Loss: 8.026 Vali Acc: 0.267 Test Loss: 8.026 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.301593542098999
Epoch: 18, Steps: 10 | Train Loss: 0.204 Vali Loss: 9.204 Vali Acc: 0.247 Test Loss: 9.204 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3
model parameter : 13325338
model size : 70.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.1677937507629395
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.383 Vali Acc: 0.101 Test Loss: 3.383 Test Acc: 0.101
Validation loss decreased (inf --> -0.101143).  Saving model ...
Epoch: 2 cost time: 4.7375404834747314
Epoch: 2, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.427 Vali Acc: 0.216 Test Loss: 3.427 Test Acc: 0.216
Validation loss decreased (-0.101143 --> -0.216436).  Saving model ...
Epoch: 3 cost time: 4.413231372833252
Epoch: 3, Steps: 10 | Train Loss: 1.127 Vali Loss: 3.755 Vali Acc: 0.209 Test Loss: 3.755 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.608485698699951
Epoch: 4, Steps: 10 | Train Loss: 0.557 Vali Loss: 4.415 Vali Acc: 0.239 Test Loss: 4.415 Test Acc: 0.239
Validation loss decreased (-0.216436 --> -0.238779).  Saving model ...
Epoch: 5 cost time: 4.182700872421265
Epoch: 5, Steps: 10 | Train Loss: 0.434 Vali Loss: 4.672 Vali Acc: 0.264 Test Loss: 4.672 Test Acc: 0.264
Validation loss decreased (-0.238779 --> -0.263483).  Saving model ...
Epoch: 6 cost time: 4.031705856323242
Epoch: 6, Steps: 10 | Train Loss: 0.158 Vali Loss: 4.984 Vali Acc: 0.251 Test Loss: 4.984 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.072449445724487
Epoch: 7, Steps: 10 | Train Loss: 0.069 Vali Loss: 5.424 Vali Acc: 0.267 Test Loss: 5.424 Test Acc: 0.267
Validation loss decreased (-0.263483 --> -0.267005).  Saving model ...
Epoch: 8 cost time: 4.033980846405029
Epoch: 8, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.728 Vali Acc: 0.253 Test Loss: 5.728 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.184946775436401
Epoch: 9, Steps: 10 | Train Loss: 0.101 Vali Loss: 5.609 Vali Acc: 0.287 Test Loss: 5.609 Test Acc: 0.287
Validation loss decreased (-0.267005 --> -0.287003).  Saving model ...
Epoch: 10 cost time: 4.276620388031006
Epoch: 10, Steps: 10 | Train Loss: 0.052 Vali Loss: 6.055 Vali Acc: 0.286 Test Loss: 6.055 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.411003828048706
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 6.301 Vali Acc: 0.247 Test Loss: 6.301 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.202399492263794
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 6.240 Vali Acc: 0.285 Test Loss: 6.240 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.071459770202637
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.802 Vali Acc: 0.269 Test Loss: 6.802 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.33012843132019
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 6.875 Vali Acc: 0.267 Test Loss: 6.875 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.42108416557312
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 7.405 Vali Acc: 0.254 Test Loss: 7.405 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.80354380607605
Epoch: 16, Steps: 10 | Train Loss: 0.070 Vali Loss: 7.248 Vali Acc: 0.280 Test Loss: 7.248 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.638424873352051
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 8.178 Vali Acc: 0.245 Test Loss: 8.178 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.5559117794036865
Epoch: 18, Steps: 10 | Train Loss: 0.052 Vali Loss: 9.043 Vali Acc: 0.225 Test Loss: 9.043 Test Acc: 0.225
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.882401704788208
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 10.117 Vali Acc: 0.218 Test Loss: 10.117 Test Acc: 0.218
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 13325338
model size : 70.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.839498281478882
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.428 Vali Acc: 0.107 Test Loss: 3.428 Test Acc: 0.107
Validation loss decreased (inf --> -0.107025).  Saving model ...
Epoch: 2 cost time: 4.352218389511108
Epoch: 2, Steps: 10 | Train Loss: 2.385 Vali Loss: 3.545 Vali Acc: 0.156 Test Loss: 3.545 Test Acc: 0.156
Validation loss decreased (-0.107025 --> -0.156435).  Saving model ...
Epoch: 3 cost time: 4.341184616088867
Epoch: 3, Steps: 10 | Train Loss: 1.226 Vali Loss: 3.941 Vali Acc: 0.181 Test Loss: 3.941 Test Acc: 0.181
Validation loss decreased (-0.156435 --> -0.181137).  Saving model ...
Epoch: 4 cost time: 4.611835718154907
Epoch: 4, Steps: 10 | Train Loss: 0.587 Vali Loss: 4.591 Vali Acc: 0.188 Test Loss: 4.591 Test Acc: 0.188
Validation loss decreased (-0.181137 --> -0.188189).  Saving model ...
Epoch: 5 cost time: 4.291120290756226
Epoch: 5, Steps: 10 | Train Loss: 0.501 Vali Loss: 4.897 Vali Acc: 0.220 Test Loss: 4.897 Test Acc: 0.220
Validation loss decreased (-0.188189 --> -0.219951).  Saving model ...
Epoch: 6 cost time: 4.066503524780273
Epoch: 6, Steps: 10 | Train Loss: 0.138 Vali Loss: 5.341 Vali Acc: 0.202 Test Loss: 5.341 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.358585357666016
Epoch: 7, Steps: 10 | Train Loss: 0.148 Vali Loss: 5.775 Vali Acc: 0.218 Test Loss: 5.775 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.3218302726745605
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 6.602 Vali Acc: 0.211 Test Loss: 6.602 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.220288991928101
Epoch: 9, Steps: 10 | Train Loss: 0.131 Vali Loss: 6.677 Vali Acc: 0.202 Test Loss: 6.677 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.342007637023926
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 7.350 Vali Acc: 0.220 Test Loss: 7.350 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.264085292816162
Epoch: 11, Steps: 10 | Train Loss: 0.087 Vali Loss: 7.843 Vali Acc: 0.219 Test Loss: 7.843 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.427001953125
Epoch: 12, Steps: 10 | Train Loss: 0.040 Vali Loss: 7.805 Vali Acc: 0.216 Test Loss: 7.805 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.139469146728516
Epoch: 13, Steps: 10 | Train Loss: 0.071 Vali Loss: 7.770 Vali Acc: 0.225 Test Loss: 7.770 Test Acc: 0.225
Validation loss decreased (-0.219951 --> -0.224628).  Saving model ...
Epoch: 14 cost time: 3.9356296062469482
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 8.221 Vali Acc: 0.219 Test Loss: 8.221 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.292066812515259
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 8.446 Vali Acc: 0.212 Test Loss: 8.446 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.823204517364502
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 9.039 Vali Acc: 0.213 Test Loss: 9.039 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.170973777770996
Epoch: 17, Steps: 10 | Train Loss: 0.058 Vali Loss: 9.306 Vali Acc: 0.205 Test Loss: 9.306 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.797447204589844
Epoch: 18, Steps: 10 | Train Loss: 0.117 Vali Loss: 9.869 Vali Acc: 0.207 Test Loss: 9.869 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.378315448760986
Epoch: 19, Steps: 10 | Train Loss: 0.092 Vali Loss: 10.913 Vali Acc: 0.185 Test Loss: 10.913 Test Acc: 0.185
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.100528955459595
Epoch: 20, Steps: 10 | Train Loss: 0.515 Vali Loss: 11.266 Vali Acc: 0.205 Test Loss: 11.266 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.196604490280151
Epoch: 21, Steps: 10 | Train Loss: 0.140 Vali Loss: 12.723 Vali Acc: 0.204 Test Loss: 12.723 Test Acc: 0.204
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.030269622802734
Epoch: 22, Steps: 10 | Train Loss: 0.254 Vali Loss: 13.566 Vali Acc: 0.171 Test Loss: 13.566 Test Acc: 0.171
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.811268091201782
Epoch: 23, Steps: 10 | Train Loss: 0.318 Vali Loss: 15.490 Vali Acc: 0.153 Test Loss: 15.490 Test Acc: 0.153
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22470588235294117
model parameter : 13325338
model size : 70.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.916110038757324
Epoch: 1, Steps: 10 | Train Loss: 3.429 Vali Loss: 3.446 Vali Acc: 0.062 Test Loss: 3.446 Test Acc: 0.062
Validation loss decreased (inf --> -0.062318).  Saving model ...
Epoch: 2 cost time: 4.410863876342773
Epoch: 2, Steps: 10 | Train Loss: 2.544 Vali Loss: 3.504 Vali Acc: 0.096 Test Loss: 3.504 Test Acc: 0.096
Validation loss decreased (-0.062318 --> -0.096436).  Saving model ...
Epoch: 3 cost time: 3.9234540462493896
Epoch: 3, Steps: 10 | Train Loss: 1.244 Vali Loss: 3.805 Vali Acc: 0.101 Test Loss: 3.805 Test Acc: 0.101
Validation loss decreased (-0.096436 --> -0.101138).  Saving model ...
Epoch: 4 cost time: 3.988389253616333
Epoch: 4, Steps: 10 | Train Loss: 0.496 Vali Loss: 4.529 Vali Acc: 0.122 Test Loss: 4.529 Test Acc: 0.122
Validation loss decreased (-0.101138 --> -0.122308).  Saving model ...
Epoch: 5 cost time: 4.448919773101807
Epoch: 5, Steps: 10 | Train Loss: 0.180 Vali Loss: 5.178 Vali Acc: 0.119 Test Loss: 5.178 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.231549501419067
Epoch: 6, Steps: 10 | Train Loss: 0.042 Vali Loss: 5.532 Vali Acc: 0.149 Test Loss: 5.532 Test Acc: 0.149
Validation loss decreased (-0.122308 --> -0.149356).  Saving model ...
Epoch: 7 cost time: 4.624093532562256
Epoch: 7, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.914 Vali Acc: 0.142 Test Loss: 5.914 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.3668153285980225
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.191 Vali Acc: 0.149 Test Loss: 6.191 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.10625433921814
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 6.370 Vali Acc: 0.148 Test Loss: 6.370 Test Acc: 0.148
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.084226608276367
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 6.340 Vali Acc: 0.144 Test Loss: 6.340 Test Acc: 0.144
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.798875570297241
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.505 Vali Acc: 0.139 Test Loss: 6.505 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.150468826293945
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.574 Vali Acc: 0.133 Test Loss: 6.574 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.409356355667114
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.552 Vali Acc: 0.140 Test Loss: 6.552 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.51465368270874
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.534 Vali Acc: 0.140 Test Loss: 6.534 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.767978668212891
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.527 Vali Acc: 0.144 Test Loss: 6.527 Test Acc: 0.144
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.7398998737335205
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.526 Vali Acc: 0.145 Test Loss: 6.526 Test Acc: 0.145
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14941176470588236
model parameter : 13325338
model size : 70.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.619212627410889
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.449 Vali Acc: 0.039 Test Loss: 3.449 Test Acc: 0.039
Validation loss decreased (inf --> -0.038789).  Saving model ...
Epoch: 2 cost time: 4.4518468379974365
Epoch: 2, Steps: 10 | Train Loss: 2.727 Vali Loss: 3.500 Vali Acc: 0.073 Test Loss: 3.500 Test Acc: 0.073
Validation loss decreased (-0.038789 --> -0.072906).  Saving model ...
Epoch: 3 cost time: 4.716890335083008
Epoch: 3, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.597 Vali Acc: 0.078 Test Loss: 3.597 Test Acc: 0.078
Validation loss decreased (-0.072906 --> -0.077611).  Saving model ...
Epoch: 4 cost time: 4.884610176086426
Epoch: 4, Steps: 10 | Train Loss: 0.720 Vali Loss: 4.111 Vali Acc: 0.092 Test Loss: 4.111 Test Acc: 0.092
Validation loss decreased (-0.077611 --> -0.091724).  Saving model ...
Epoch: 5 cost time: 4.471388816833496
Epoch: 5, Steps: 10 | Train Loss: 0.252 Vali Loss: 4.612 Vali Acc: 0.101 Test Loss: 4.612 Test Acc: 0.101
Validation loss decreased (-0.091724 --> -0.101130).  Saving model ...
Epoch: 6 cost time: 4.168957233428955
Epoch: 6, Steps: 10 | Train Loss: 0.062 Vali Loss: 5.392 Vali Acc: 0.102 Test Loss: 5.392 Test Acc: 0.102
Validation loss decreased (-0.101130 --> -0.102299).  Saving model ...
Epoch: 7 cost time: 4.428427696228027
Epoch: 7, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.745 Vali Acc: 0.107 Test Loss: 5.745 Test Acc: 0.107
Validation loss decreased (-0.102299 --> -0.107001).  Saving model ...
Epoch: 8 cost time: 4.579269170761108
Epoch: 8, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.141 Vali Acc: 0.106 Test Loss: 6.141 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.200859308242798
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 6.231 Vali Acc: 0.107 Test Loss: 6.231 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.7090232372283936
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 6.164 Vali Acc: 0.119 Test Loss: 6.164 Test Acc: 0.119
Validation loss decreased (-0.107001 --> -0.118762).  Saving model ...
Epoch: 11 cost time: 4.3773274421691895
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.274 Vali Acc: 0.115 Test Loss: 6.274 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.041743040084839
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.271 Vali Acc: 0.111 Test Loss: 6.271 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8457658290863037
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.306 Vali Acc: 0.113 Test Loss: 6.306 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.85180401802063
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.309 Vali Acc: 0.114 Test Loss: 6.309 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.371713638305664
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.322 Vali Acc: 0.119 Test Loss: 6.322 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.699153184890747
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.340 Vali Acc: 0.121 Test Loss: 6.340 Test Acc: 0.121
Validation loss decreased (-0.118762 --> -0.121113).  Saving model ...
Epoch: 17 cost time: 4.677404880523682
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.360 Vali Acc: 0.122 Test Loss: 6.360 Test Acc: 0.122
Validation loss decreased (-0.121113 --> -0.122289).  Saving model ...
Epoch: 18 cost time: 4.143960237503052
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.389 Vali Acc: 0.120 Test Loss: 6.389 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.277376174926758
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.422 Vali Acc: 0.120 Test Loss: 6.422 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.023675441741943
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.442 Vali Acc: 0.120 Test Loss: 6.442 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.872073411941528
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.464 Vali Acc: 0.121 Test Loss: 6.464 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.97920036315918
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.480 Vali Acc: 0.121 Test Loss: 6.480 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.480017185211182
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.498 Vali Acc: 0.121 Test Loss: 6.498 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.255988359451294
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.517 Vali Acc: 0.120 Test Loss: 6.517 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.5351881980896
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.537 Vali Acc: 0.121 Test Loss: 6.537 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.415494680404663
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.551 Vali Acc: 0.125 Test Loss: 6.551 Test Acc: 0.125
Validation loss decreased (-0.122289 --> -0.124640).  Saving model ...
Epoch: 27 cost time: 5.062987327575684
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.569 Vali Acc: 0.124 Test Loss: 6.569 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.20084810256958
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.595 Vali Acc: 0.124 Test Loss: 6.595 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.606018781661987
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.609 Vali Acc: 0.122 Test Loss: 6.609 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.596582412719727
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.614 Vali Acc: 0.124 Test Loss: 6.614 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.804471015930176
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.627 Vali Acc: 0.125 Test Loss: 6.627 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.544497966766357
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.645 Vali Acc: 0.125 Test Loss: 6.645 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.281962156295776
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.657 Vali Acc: 0.122 Test Loss: 6.657 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.694345474243164
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.666 Vali Acc: 0.125 Test Loss: 6.666 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.5566418170928955
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.686 Vali Acc: 0.124 Test Loss: 6.686 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.36409854888916
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.702 Vali Acc: 0.126 Test Loss: 6.702 Test Acc: 0.126
Validation loss decreased (-0.124640 --> -0.125815).  Saving model ...
Epoch: 37 cost time: 4.562321186065674
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.717 Vali Acc: 0.124 Test Loss: 6.717 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.981909990310669
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.734 Vali Acc: 0.125 Test Loss: 6.734 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 4.724832057952881
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.751 Vali Acc: 0.125 Test Loss: 6.751 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 4.330987930297852
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.769 Vali Acc: 0.125 Test Loss: 6.769 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 4.7434186935424805
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.785 Vali Acc: 0.127 Test Loss: 6.785 Test Acc: 0.127
Validation loss decreased (-0.125815 --> -0.126991).  Saving model ...
Epoch: 42 cost time: 4.447001934051514
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.796 Vali Acc: 0.128 Test Loss: 6.796 Test Acc: 0.128
Validation loss decreased (-0.126991 --> -0.128167).  Saving model ...
Epoch: 43 cost time: 4.8218607902526855
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.807 Vali Acc: 0.128 Test Loss: 6.807 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.575850009918213
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.817 Vali Acc: 0.128 Test Loss: 6.817 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 4.269150495529175
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.826 Vali Acc: 0.127 Test Loss: 6.826 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 4.983386039733887
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.841 Vali Acc: 0.127 Test Loss: 6.841 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 4.591326475143433
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.856 Vali Acc: 0.127 Test Loss: 6.856 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 4.648570775985718
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.866 Vali Acc: 0.128 Test Loss: 6.866 Test Acc: 0.128
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 4.415521860122681
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.878 Vali Acc: 0.129 Test Loss: 6.878 Test Acc: 0.129
Validation loss decreased (-0.128167 --> -0.129343).  Saving model ...
Epoch: 50 cost time: 4.290555238723755
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.889 Vali Acc: 0.131 Test Loss: 6.889 Test Acc: 0.131
Validation loss decreased (-0.129343 --> -0.130519).  Saving model ...
Epoch: 51 cost time: 4.5729286670684814
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.903 Vali Acc: 0.128 Test Loss: 6.903 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 4.4075024127960205
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.913 Vali Acc: 0.128 Test Loss: 6.913 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 4.292454481124878
Epoch: 53, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.922 Vali Acc: 0.128 Test Loss: 6.922 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 4.56196665763855
Epoch: 54, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.935 Vali Acc: 0.128 Test Loss: 6.935 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 4.37972092628479
Epoch: 55, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.948 Vali Acc: 0.127 Test Loss: 6.948 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 4.699501991271973
Epoch: 56, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.958 Vali Acc: 0.128 Test Loss: 6.958 Test Acc: 0.128
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 4.553966283798218
Epoch: 57, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.967 Vali Acc: 0.128 Test Loss: 6.967 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 4.58294415473938
Epoch: 58, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.975 Vali Acc: 0.128 Test Loss: 6.975 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 4.5655295848846436
Epoch: 59, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.985 Vali Acc: 0.128 Test Loss: 6.985 Test Acc: 0.128
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 4.762625217437744
Epoch: 60, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.997 Vali Acc: 0.128 Test Loss: 6.997 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13058823529411764
model parameter : 13325338
model size : 70.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.8074822425842285
Epoch: 1, Steps: 10 | Train Loss: 3.370 Vali Loss: 3.435 Vali Acc: 0.047 Test Loss: 3.435 Test Acc: 0.047
Validation loss decreased (inf --> -0.047024).  Saving model ...
Epoch: 2 cost time: 4.242830038070679
Epoch: 2, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.555 Vali Acc: 0.075 Test Loss: 3.555 Test Acc: 0.075
Validation loss decreased (-0.047024 --> -0.075259).  Saving model ...
Epoch: 3 cost time: 4.573012590408325
Epoch: 3, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.487 Vali Acc: 0.084 Test Loss: 3.487 Test Acc: 0.084
Validation loss decreased (-0.075259 --> -0.083495).  Saving model ...
Epoch: 4 cost time: 4.389571905136108
Epoch: 4, Steps: 10 | Train Loss: 1.111 Vali Loss: 4.073 Vali Acc: 0.085 Test Loss: 4.073 Test Acc: 0.085
Validation loss decreased (-0.083495 --> -0.084665).  Saving model ...
Epoch: 5 cost time: 4.205502271652222
Epoch: 5, Steps: 10 | Train Loss: 0.512 Vali Loss: 4.646 Vali Acc: 0.095 Test Loss: 4.646 Test Acc: 0.095
Validation loss decreased (-0.084665 --> -0.095248).  Saving model ...
Epoch: 6 cost time: 4.17334508895874
Epoch: 6, Steps: 10 | Train Loss: 0.170 Vali Loss: 5.571 Vali Acc: 0.099 Test Loss: 5.571 Test Acc: 0.099
Validation loss decreased (-0.095248 --> -0.098768).  Saving model ...
Epoch: 7 cost time: 4.016770124435425
Epoch: 7, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.768 Vali Acc: 0.116 Test Loss: 5.768 Test Acc: 0.116
Validation loss decreased (-0.098768 --> -0.116413).  Saving model ...
Epoch: 8 cost time: 3.898841619491577
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.177 Vali Acc: 0.111 Test Loss: 6.177 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.408974885940552
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.366 Vali Acc: 0.116 Test Loss: 6.366 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.182842493057251
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 7.132 Vali Acc: 0.099 Test Loss: 7.132 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.237842082977295
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.908 Vali Acc: 0.121 Test Loss: 6.908 Test Acc: 0.121
Validation loss decreased (-0.116413 --> -0.121107).  Saving model ...
Epoch: 12 cost time: 4.1298840045928955
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.946 Vali Acc: 0.116 Test Loss: 6.946 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.057936668395996
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 7.214 Vali Acc: 0.107 Test Loss: 7.214 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.9414350986480713
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.789 Vali Acc: 0.102 Test Loss: 7.789 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.161295175552368
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.958 Vali Acc: 0.093 Test Loss: 7.958 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.311613082885742
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.758 Vali Acc: 0.098 Test Loss: 7.758 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.295045614242554
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.657 Vali Acc: 0.112 Test Loss: 7.657 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.215442895889282
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.598 Vali Acc: 0.115 Test Loss: 7.598 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.087616682052612
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.573 Vali Acc: 0.118 Test Loss: 7.573 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.030242919921875
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.572 Vali Acc: 0.114 Test Loss: 7.572 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.002497673034668
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.564 Vali Acc: 0.114 Test Loss: 7.564 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12117647058823529
model parameter : 13325338
model size : 70.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.1371283531188965
Epoch: 1, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.395 Vali Acc: 0.036 Test Loss: 3.395 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 4.589360952377319
Epoch: 2, Steps: 10 | Train Loss: 3.062 Vali Loss: 3.551 Vali Acc: 0.079 Test Loss: 3.551 Test Acc: 0.079
Validation loss decreased (-0.036437 --> -0.078788).  Saving model ...
Epoch: 3 cost time: 4.588374376296997
Epoch: 3, Steps: 10 | Train Loss: 2.287 Vali Loss: 3.405 Vali Acc: 0.093 Test Loss: 3.405 Test Acc: 0.093
Validation loss decreased (-0.078788 --> -0.092907).  Saving model ...
Epoch: 4 cost time: 4.421162128448486
Epoch: 4, Steps: 10 | Train Loss: 1.451 Vali Loss: 3.881 Vali Acc: 0.085 Test Loss: 3.881 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.3094704151153564
Epoch: 5, Steps: 10 | Train Loss: 0.775 Vali Loss: 4.399 Vali Acc: 0.096 Test Loss: 4.399 Test Acc: 0.096
Validation loss decreased (-0.092907 --> -0.096427).  Saving model ...
Epoch: 6 cost time: 4.694872140884399
Epoch: 6, Steps: 10 | Train Loss: 0.339 Vali Loss: 5.278 Vali Acc: 0.104 Test Loss: 5.278 Test Acc: 0.104
Validation loss decreased (-0.096427 --> -0.103477).  Saving model ...
Epoch: 7 cost time: 4.639841079711914
Epoch: 7, Steps: 10 | Train Loss: 0.114 Vali Loss: 5.262 Vali Acc: 0.122 Test Loss: 5.262 Test Acc: 0.122
Validation loss decreased (-0.103477 --> -0.122300).  Saving model ...
Epoch: 8 cost time: 5.008955240249634
Epoch: 8, Steps: 10 | Train Loss: 0.040 Vali Loss: 6.071 Vali Acc: 0.116 Test Loss: 6.071 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.5906665325164795
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 6.331 Vali Acc: 0.126 Test Loss: 6.331 Test Acc: 0.126
Validation loss decreased (-0.122300 --> -0.125819).  Saving model ...
Epoch: 10 cost time: 4.433820009231567
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 7.145 Vali Acc: 0.119 Test Loss: 7.145 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.819079637527466
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.615 Vali Acc: 0.131 Test Loss: 6.615 Test Acc: 0.131
Validation loss decreased (-0.125819 --> -0.130522).  Saving model ...
Epoch: 12 cost time: 4.622524976730347
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.696 Vali Acc: 0.127 Test Loss: 6.696 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.881427526473999
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.001 Vali Acc: 0.129 Test Loss: 7.001 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.085180044174194
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.175 Vali Acc: 0.132 Test Loss: 7.175 Test Acc: 0.132
Validation loss decreased (-0.130522 --> -0.131693).  Saving model ...
Epoch: 15 cost time: 4.834618806838989
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.110 Vali Acc: 0.131 Test Loss: 7.110 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.881705284118652
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.059 Vali Acc: 0.131 Test Loss: 7.059 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.64681339263916
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.022 Vali Acc: 0.132 Test Loss: 7.022 Test Acc: 0.132
Validation loss decreased (-0.131693 --> -0.131694).  Saving model ...
Epoch: 18 cost time: 4.289036273956299
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.009 Vali Acc: 0.132 Test Loss: 7.009 Test Acc: 0.132
Validation loss decreased (-0.131694 --> -0.131695).  Saving model ...
Epoch: 19 cost time: 4.51686954498291
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.014 Vali Acc: 0.134 Test Loss: 7.014 Test Acc: 0.134
Validation loss decreased (-0.131695 --> -0.134048).  Saving model ...
Epoch: 20 cost time: 4.310673952102661
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.023 Vali Acc: 0.133 Test Loss: 7.023 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.642502546310425
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.025 Vali Acc: 0.134 Test Loss: 7.025 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.416567087173462
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.026 Vali Acc: 0.133 Test Loss: 7.026 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.329777002334595
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.037 Vali Acc: 0.134 Test Loss: 7.037 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.8468072414398193
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.042 Vali Acc: 0.136 Test Loss: 7.042 Test Acc: 0.136
Validation loss decreased (-0.134048 --> -0.136400).  Saving model ...
Epoch: 25 cost time: 4.230590105056763
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.053 Vali Acc: 0.134 Test Loss: 7.053 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.568101406097412
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.065 Vali Acc: 0.132 Test Loss: 7.065 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.6283228397369385
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.079 Vali Acc: 0.133 Test Loss: 7.079 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.419840097427368
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.101 Vali Acc: 0.134 Test Loss: 7.101 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.0143256187438965
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.113 Vali Acc: 0.133 Test Loss: 7.113 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.230798959732056
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.121 Vali Acc: 0.132 Test Loss: 7.121 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.342651844024658
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.133 Vali Acc: 0.134 Test Loss: 7.133 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.1318519115448
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.142 Vali Acc: 0.135 Test Loss: 7.142 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.691089630126953
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.144 Vali Acc: 0.136 Test Loss: 7.144 Test Acc: 0.136
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.534555196762085
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.150 Vali Acc: 0.138 Test Loss: 7.150 Test Acc: 0.138
Validation loss decreased (-0.136400 --> -0.137576).  Saving model ...
Epoch: 35 cost time: 4.749380588531494
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.163 Vali Acc: 0.134 Test Loss: 7.163 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.36842155456543
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.171 Vali Acc: 0.133 Test Loss: 7.171 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.517269611358643
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.183 Vali Acc: 0.131 Test Loss: 7.183 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.2999773025512695
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.192 Vali Acc: 0.132 Test Loss: 7.192 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.952173233032227
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.207 Vali Acc: 0.131 Test Loss: 7.207 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.252323389053345
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.214 Vali Acc: 0.131 Test Loss: 7.214 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.329968452453613
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.223 Vali Acc: 0.131 Test Loss: 7.223 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.437807321548462
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.234 Vali Acc: 0.131 Test Loss: 7.234 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 4.397976636886597
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.244 Vali Acc: 0.132 Test Loss: 7.244 Test Acc: 0.132
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.5980424880981445
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.247 Vali Acc: 0.133 Test Loss: 7.247 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1376470588235294
model parameter : 13325338
model size : 70.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.168674945831299
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.389 Vali Acc: 0.054 Test Loss: 3.389 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 4.07141375541687
Epoch: 2, Steps: 10 | Train Loss: 3.086 Vali Loss: 3.590 Vali Acc: 0.085 Test Loss: 3.590 Test Acc: 0.085
Validation loss decreased (-0.054084 --> -0.084670).  Saving model ...
Epoch: 3 cost time: 3.6461312770843506
Epoch: 3, Steps: 10 | Train Loss: 2.414 Vali Loss: 3.403 Vali Acc: 0.100 Test Loss: 3.403 Test Acc: 0.100
Validation loss decreased (-0.084670 --> -0.099966).  Saving model ...
Epoch: 4 cost time: 4.125643491744995
Epoch: 4, Steps: 10 | Train Loss: 1.672 Vali Loss: 3.784 Vali Acc: 0.092 Test Loss: 3.784 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.595451354980469
Epoch: 5, Steps: 10 | Train Loss: 0.974 Vali Loss: 4.394 Vali Acc: 0.112 Test Loss: 4.394 Test Acc: 0.112
Validation loss decreased (-0.099966 --> -0.111721).  Saving model ...
Epoch: 6 cost time: 4.954317808151245
Epoch: 6, Steps: 10 | Train Loss: 0.499 Vali Loss: 4.953 Vali Acc: 0.125 Test Loss: 4.953 Test Acc: 0.125
Validation loss decreased (-0.111721 --> -0.124656).  Saving model ...
Epoch: 7 cost time: 4.839972734451294
Epoch: 7, Steps: 10 | Train Loss: 0.174 Vali Loss: 5.377 Vali Acc: 0.138 Test Loss: 5.377 Test Acc: 0.138
Validation loss decreased (-0.124656 --> -0.137593).  Saving model ...
Epoch: 8 cost time: 4.472194194793701
Epoch: 8, Steps: 10 | Train Loss: 0.091 Vali Loss: 5.947 Vali Acc: 0.145 Test Loss: 5.947 Test Acc: 0.145
Validation loss decreased (-0.137593 --> -0.144646).  Saving model ...
Epoch: 9 cost time: 4.0004189014434814
Epoch: 9, Steps: 10 | Train Loss: 0.057 Vali Loss: 5.904 Vali Acc: 0.141 Test Loss: 5.904 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.205343008041382
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.869 Vali Acc: 0.136 Test Loss: 6.869 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.102437496185303
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.729 Vali Acc: 0.142 Test Loss: 6.729 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.262189626693726
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 7.121 Vali Acc: 0.138 Test Loss: 7.121 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.551344394683838
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 7.164 Vali Acc: 0.139 Test Loss: 7.164 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.235461711883545
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 7.345 Vali Acc: 0.131 Test Loss: 7.345 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.314191579818726
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 7.302 Vali Acc: 0.136 Test Loss: 7.302 Test Acc: 0.136
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.994870185852051
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 7.177 Vali Acc: 0.139 Test Loss: 7.177 Test Acc: 0.139
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.9705090522766113
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 7.029 Vali Acc: 0.131 Test Loss: 7.029 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.553837060928345
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 7.034 Vali Acc: 0.122 Test Loss: 7.034 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14470588235294118
model parameter : 13325338
model size : 70.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.257802486419678
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (inf --> -0.050556).  Saving model ...
Epoch: 2 cost time: 3.9818177223205566
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 3 cost time: 4.012022495269775
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8530783653259277
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.473377704620361
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.420013904571533
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.271424770355225
Epoch: 7, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.487823009490967
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.24389910697937
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.031092643737793
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.461050748825073
Epoch: 11, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.522356271743774
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.05058823529411765
model parameter : 13325338
model size : 70.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.07681131362915
Epoch: 1, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.298 Vali Acc: 0.096 Test Loss: 3.298 Test Acc: 0.096
Validation loss decreased (inf --> -0.096438).  Saving model ...
Epoch: 2 cost time: 4.241032600402832
Epoch: 2, Steps: 10 | Train Loss: 2.385 Vali Loss: 3.336 Vali Acc: 0.204 Test Loss: 3.336 Test Acc: 0.204
Validation loss decreased (-0.096438 --> -0.203496).  Saving model ...
Epoch: 3 cost time: 4.6613733768463135
Epoch: 3, Steps: 10 | Train Loss: 0.949 Vali Loss: 3.587 Vali Acc: 0.225 Test Loss: 3.587 Test Acc: 0.225
Validation loss decreased (-0.203496 --> -0.224670).  Saving model ...
Epoch: 4 cost time: 3.9650583267211914
Epoch: 4, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.991 Vali Acc: 0.249 Test Loss: 3.991 Test Acc: 0.249
Validation loss decreased (-0.224670 --> -0.249372).  Saving model ...
Epoch: 5 cost time: 4.513631820678711
Epoch: 5, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.728 Vali Acc: 0.249 Test Loss: 4.728 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.078155755996704
Epoch: 6, Steps: 10 | Train Loss: 0.105 Vali Loss: 5.022 Vali Acc: 0.247 Test Loss: 5.022 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.996354818344116
Epoch: 7, Steps: 10 | Train Loss: 0.208 Vali Loss: 5.348 Vali Acc: 0.258 Test Loss: 5.348 Test Acc: 0.258
Validation loss decreased (-0.249372 --> -0.257594).  Saving model ...
Epoch: 8 cost time: 4.069682836532593
Epoch: 8, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.311 Vali Acc: 0.271 Test Loss: 5.311 Test Acc: 0.271
Validation loss decreased (-0.257594 --> -0.270535).  Saving model ...
Epoch: 9 cost time: 4.451139211654663
Epoch: 9, Steps: 10 | Train Loss: 0.080 Vali Loss: 5.776 Vali Acc: 0.274 Test Loss: 5.776 Test Acc: 0.274
Validation loss decreased (-0.270535 --> -0.274060).  Saving model ...
Epoch: 10 cost time: 3.963880777359009
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.754 Vali Acc: 0.280 Test Loss: 5.754 Test Acc: 0.280
Validation loss decreased (-0.274060 --> -0.279942).  Saving model ...
Epoch: 11 cost time: 4.405742883682251
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.202 Vali Acc: 0.259 Test Loss: 6.202 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.16985559463501
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 6.523 Vali Acc: 0.266 Test Loss: 6.523 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8882715702056885
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 6.605 Vali Acc: 0.282 Test Loss: 6.605 Test Acc: 0.282
Validation loss decreased (-0.279942 --> -0.282287).  Saving model ...
Epoch: 14 cost time: 4.417942762374878
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 6.925 Vali Acc: 0.252 Test Loss: 6.925 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.424333333969116
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 7.048 Vali Acc: 0.260 Test Loss: 7.048 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.630743741989136
Epoch: 16, Steps: 10 | Train Loss: 0.068 Vali Loss: 7.992 Vali Acc: 0.234 Test Loss: 7.992 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.477805852890015
Epoch: 17, Steps: 10 | Train Loss: 0.076 Vali Loss: 8.063 Vali Acc: 0.253 Test Loss: 8.063 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.756977081298828
Epoch: 18, Steps: 10 | Train Loss: 0.078 Vali Loss: 8.624 Vali Acc: 0.225 Test Loss: 8.624 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.185938358306885
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 9.282 Vali Acc: 0.238 Test Loss: 9.282 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.889545440673828
Epoch: 20, Steps: 10 | Train Loss: 0.188 Vali Loss: 9.428 Vali Acc: 0.234 Test Loss: 9.428 Test Acc: 0.234
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.196004390716553
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 9.844 Vali Acc: 0.214 Test Loss: 9.844 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.682777166366577
Epoch: 22, Steps: 10 | Train Loss: 0.275 Vali Loss: 10.560 Vali Acc: 0.236 Test Loss: 10.560 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.387816905975342
Epoch: 23, Steps: 10 | Train Loss: 0.054 Vali Loss: 11.425 Vali Acc: 0.227 Test Loss: 11.425 Test Acc: 0.227
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 12932122
model size : 68.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.516207933425903
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.298 Vali Acc: 0.106 Test Loss: 3.298 Test Acc: 0.106
Validation loss decreased (inf --> -0.105849).  Saving model ...
Epoch: 2 cost time: 4.297361373901367
Epoch: 2, Steps: 10 | Train Loss: 2.356 Vali Loss: 3.333 Vali Acc: 0.200 Test Loss: 3.333 Test Acc: 0.200
Validation loss decreased (-0.105849 --> -0.199967).  Saving model ...
Epoch: 3 cost time: 4.264847278594971
Epoch: 3, Steps: 10 | Train Loss: 0.985 Vali Loss: 3.536 Vali Acc: 0.227 Test Loss: 3.536 Test Acc: 0.227
Validation loss decreased (-0.199967 --> -0.227023).  Saving model ...
Epoch: 4 cost time: 4.649266958236694
Epoch: 4, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.988 Vali Acc: 0.259 Test Loss: 3.988 Test Acc: 0.259
Validation loss decreased (-0.227023 --> -0.258784).  Saving model ...
Epoch: 5 cost time: 4.295446395874023
Epoch: 5, Steps: 10 | Train Loss: 0.163 Vali Loss: 4.599 Vali Acc: 0.266 Test Loss: 4.599 Test Acc: 0.266
Validation loss decreased (-0.258784 --> -0.265836).  Saving model ...
Epoch: 6 cost time: 4.420745372772217
Epoch: 6, Steps: 10 | Train Loss: 0.096 Vali Loss: 5.039 Vali Acc: 0.246 Test Loss: 5.039 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.985018014907837
Epoch: 7, Steps: 10 | Train Loss: 0.091 Vali Loss: 5.563 Vali Acc: 0.266 Test Loss: 5.563 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.180021047592163
Epoch: 8, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.476 Vali Acc: 0.296 Test Loss: 5.476 Test Acc: 0.296
Validation loss decreased (-0.265836 --> -0.296416).  Saving model ...
Epoch: 9 cost time: 4.189634084701538
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.662 Vali Acc: 0.280 Test Loss: 5.662 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.5353991985321045
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.931 Vali Acc: 0.275 Test Loss: 5.931 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.559788465499878
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.874 Vali Acc: 0.282 Test Loss: 5.874 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.744663953781128
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.825 Vali Acc: 0.291 Test Loss: 5.825 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.149822950363159
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.773 Vali Acc: 0.300 Test Loss: 5.773 Test Acc: 0.300
Validation loss decreased (-0.296416 --> -0.299942).  Saving model ...
Epoch: 14 cost time: 4.169716835021973
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.750 Vali Acc: 0.300 Test Loss: 5.750 Test Acc: 0.300
Validation loss decreased (-0.299942 --> -0.299943).  Saving model ...
Epoch: 15 cost time: 4.3048107624053955
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.764 Vali Acc: 0.301 Test Loss: 5.764 Test Acc: 0.301
Validation loss decreased (-0.299943 --> -0.301119).  Saving model ...
Epoch: 16 cost time: 4.405462980270386
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.780 Vali Acc: 0.302 Test Loss: 5.780 Test Acc: 0.302
Validation loss decreased (-0.301119 --> -0.302295).  Saving model ...
Epoch: 17 cost time: 4.609638214111328
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.788 Vali Acc: 0.300 Test Loss: 5.788 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.832870006561279
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.796 Vali Acc: 0.298 Test Loss: 5.796 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.516866445541382
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.801 Vali Acc: 0.296 Test Loss: 5.801 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.759704113006592
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.809 Vali Acc: 0.299 Test Loss: 5.809 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.455488443374634
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.811 Vali Acc: 0.300 Test Loss: 5.811 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.756942510604858
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.816 Vali Acc: 0.300 Test Loss: 5.816 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.502816677093506
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.826 Vali Acc: 0.299 Test Loss: 5.826 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.410438060760498
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.833 Vali Acc: 0.301 Test Loss: 5.833 Test Acc: 0.301
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.4938342571258545
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.844 Vali Acc: 0.301 Test Loss: 5.844 Test Acc: 0.301
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.707480430603027
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.850 Vali Acc: 0.304 Test Loss: 5.850 Test Acc: 0.304
Validation loss decreased (-0.302295 --> -0.303471).  Saving model ...
Epoch: 27 cost time: 4.380753993988037
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.858 Vali Acc: 0.305 Test Loss: 5.858 Test Acc: 0.305
Validation loss decreased (-0.303471 --> -0.304647).  Saving model ...
Epoch: 28 cost time: 4.551534175872803
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.863 Vali Acc: 0.304 Test Loss: 5.863 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.950598955154419
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.869 Vali Acc: 0.305 Test Loss: 5.869 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.666503190994263
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.877 Vali Acc: 0.306 Test Loss: 5.877 Test Acc: 0.306
Validation loss decreased (-0.304647 --> -0.305824).  Saving model ...
Epoch: 31 cost time: 3.9348607063293457
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.886 Vali Acc: 0.306 Test Loss: 5.886 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.24936842918396
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.894 Vali Acc: 0.306 Test Loss: 5.894 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.946361780166626
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.901 Vali Acc: 0.308 Test Loss: 5.901 Test Acc: 0.308
Validation loss decreased (-0.305824 --> -0.308176).  Saving model ...
Epoch: 34 cost time: 4.427179574966431
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.909 Vali Acc: 0.307 Test Loss: 5.909 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.432438611984253
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.914 Vali Acc: 0.307 Test Loss: 5.914 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.478301525115967
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.922 Vali Acc: 0.307 Test Loss: 5.922 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.741697788238525
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.928 Vali Acc: 0.308 Test Loss: 5.928 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.3823018074035645
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.935 Vali Acc: 0.309 Test Loss: 5.935 Test Acc: 0.309
Validation loss decreased (-0.308176 --> -0.309352).  Saving model ...
Epoch: 39 cost time: 4.461621999740601
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.940 Vali Acc: 0.309 Test Loss: 5.940 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.607334136962891
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.945 Vali Acc: 0.309 Test Loss: 5.945 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 5.176707029342651
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.949 Vali Acc: 0.309 Test Loss: 5.949 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 4.642589807510376
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.956 Vali Acc: 0.309 Test Loss: 5.956 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 4.580454111099243
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.961 Vali Acc: 0.309 Test Loss: 5.961 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 4.346839189529419
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.967 Vali Acc: 0.308 Test Loss: 5.967 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 4.633376359939575
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.977 Vali Acc: 0.309 Test Loss: 5.977 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 4.587839841842651
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.983 Vali Acc: 0.309 Test Loss: 5.983 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 4.633711814880371
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.989 Vali Acc: 0.309 Test Loss: 5.989 Test Acc: 0.309
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 4.5191121101379395
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.997 Vali Acc: 0.309 Test Loss: 5.997 Test Acc: 0.309
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 12932122
model size : 68.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.9221954345703125
Epoch: 1, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.281 Vali Acc: 0.106 Test Loss: 3.281 Test Acc: 0.106
Validation loss decreased (inf --> -0.105850).  Saving model ...
Epoch: 2 cost time: 4.380950212478638
Epoch: 2, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.408 Vali Acc: 0.219 Test Loss: 3.408 Test Acc: 0.219
Validation loss decreased (-0.105850 --> -0.218789).  Saving model ...
Epoch: 3 cost time: 4.259403228759766
Epoch: 3, Steps: 10 | Train Loss: 1.109 Vali Loss: 3.710 Vali Acc: 0.228 Test Loss: 3.710 Test Acc: 0.228
Validation loss decreased (-0.218789 --> -0.228198).  Saving model ...
Epoch: 4 cost time: 4.563400983810425
Epoch: 4, Steps: 10 | Train Loss: 0.555 Vali Loss: 4.050 Vali Acc: 0.266 Test Loss: 4.050 Test Acc: 0.266
Validation loss decreased (-0.228198 --> -0.265842).  Saving model ...
Epoch: 5 cost time: 4.6604790687561035
Epoch: 5, Steps: 10 | Train Loss: 0.209 Vali Loss: 4.381 Vali Acc: 0.273 Test Loss: 4.381 Test Acc: 0.273
Validation loss decreased (-0.265842 --> -0.272897).  Saving model ...
Epoch: 6 cost time: 4.545048475265503
Epoch: 6, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.944 Vali Acc: 0.258 Test Loss: 4.944 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.331791162490845
Epoch: 7, Steps: 10 | Train Loss: 0.104 Vali Loss: 5.471 Vali Acc: 0.256 Test Loss: 5.471 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.374261140823364
Epoch: 8, Steps: 10 | Train Loss: 0.058 Vali Loss: 5.735 Vali Acc: 0.251 Test Loss: 5.735 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.70763087272644
Epoch: 9, Steps: 10 | Train Loss: 0.108 Vali Loss: 5.754 Vali Acc: 0.280 Test Loss: 5.754 Test Acc: 0.280
Validation loss decreased (-0.272897 --> -0.279942).  Saving model ...
Epoch: 10 cost time: 4.388522624969482
Epoch: 10, Steps: 10 | Train Loss: 0.068 Vali Loss: 6.173 Vali Acc: 0.271 Test Loss: 6.173 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.486965179443359
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.525 Vali Acc: 0.264 Test Loss: 6.525 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.294657468795776
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 6.550 Vali Acc: 0.276 Test Loss: 6.550 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.213861703872681
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 6.841 Vali Acc: 0.271 Test Loss: 6.841 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.184519529342651
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 7.232 Vali Acc: 0.262 Test Loss: 7.232 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.18922233581543
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 7.518 Vali Acc: 0.269 Test Loss: 7.518 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.353438138961792
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 8.507 Vali Acc: 0.238 Test Loss: 8.507 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.350749969482422
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 9.447 Vali Acc: 0.218 Test Loss: 9.447 Test Acc: 0.218
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.671058893203735
Epoch: 18, Steps: 10 | Train Loss: 0.115 Vali Loss: 9.972 Vali Acc: 0.239 Test Loss: 9.972 Test Acc: 0.239
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.977567195892334
Epoch: 19, Steps: 10 | Train Loss: 0.075 Vali Loss: 9.504 Vali Acc: 0.251 Test Loss: 9.504 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 12932122
model size : 68.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.344832420349121
Epoch: 1, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.330 Vali Acc: 0.079 Test Loss: 3.330 Test Acc: 0.079
Validation loss decreased (inf --> -0.078790).  Saving model ...
Epoch: 2 cost time: 4.469390392303467
Epoch: 2, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.531 Vali Acc: 0.153 Test Loss: 3.531 Test Acc: 0.153
Validation loss decreased (-0.078790 --> -0.152906).  Saving model ...
Epoch: 3 cost time: 4.452444553375244
Epoch: 3, Steps: 10 | Train Loss: 1.156 Vali Loss: 3.995 Vali Acc: 0.176 Test Loss: 3.995 Test Acc: 0.176
Validation loss decreased (-0.152906 --> -0.176431).  Saving model ...
Epoch: 4 cost time: 4.666128873825073
Epoch: 4, Steps: 10 | Train Loss: 0.604 Vali Loss: 4.367 Vali Acc: 0.201 Test Loss: 4.367 Test Acc: 0.201
Validation loss decreased (-0.176431 --> -0.201133).  Saving model ...
Epoch: 5 cost time: 4.364721775054932
Epoch: 5, Steps: 10 | Train Loss: 0.256 Vali Loss: 4.875 Vali Acc: 0.227 Test Loss: 4.875 Test Acc: 0.227
Validation loss decreased (-0.201133 --> -0.227010).  Saving model ...
Epoch: 6 cost time: 4.190149784088135
Epoch: 6, Steps: 10 | Train Loss: 0.118 Vali Loss: 5.331 Vali Acc: 0.212 Test Loss: 5.331 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.1556315422058105
Epoch: 7, Steps: 10 | Train Loss: 0.217 Vali Loss: 5.973 Vali Acc: 0.205 Test Loss: 5.973 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.904807806015015
Epoch: 8, Steps: 10 | Train Loss: 0.084 Vali Loss: 6.107 Vali Acc: 0.214 Test Loss: 6.107 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.244193077087402
Epoch: 9, Steps: 10 | Train Loss: 0.114 Vali Loss: 6.678 Vali Acc: 0.220 Test Loss: 6.678 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.821566820144653
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 6.999 Vali Acc: 0.215 Test Loss: 6.999 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.298849821090698
Epoch: 11, Steps: 10 | Train Loss: 0.127 Vali Loss: 6.911 Vali Acc: 0.227 Test Loss: 6.911 Test Acc: 0.227
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.438458442687988
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 7.161 Vali Acc: 0.224 Test Loss: 7.161 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.404125690460205
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 7.467 Vali Acc: 0.204 Test Loss: 7.467 Test Acc: 0.204
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.450091600418091
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 7.812 Vali Acc: 0.220 Test Loss: 7.812 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.674782752990723
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 8.270 Vali Acc: 0.214 Test Loss: 8.270 Test Acc: 0.214
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22705882352941176
model parameter : 12932122
model size : 68.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.195685863494873
Epoch: 1, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.397 Vali Acc: 0.060 Test Loss: 3.397 Test Acc: 0.060
Validation loss decreased (inf --> -0.059966).  Saving model ...
Epoch: 2 cost time: 4.271224021911621
Epoch: 2, Steps: 10 | Train Loss: 2.599 Vali Loss: 3.550 Vali Acc: 0.091 Test Loss: 3.550 Test Acc: 0.091
Validation loss decreased (-0.059966 --> -0.090553).  Saving model ...
Epoch: 3 cost time: 4.201374053955078
Epoch: 3, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.857 Vali Acc: 0.109 Test Loss: 3.857 Test Acc: 0.109
Validation loss decreased (-0.090553 --> -0.109373).  Saving model ...
Epoch: 4 cost time: 4.45836615562439
Epoch: 4, Steps: 10 | Train Loss: 0.495 Vali Loss: 4.498 Vali Acc: 0.108 Test Loss: 4.498 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.359544038772583
Epoch: 5, Steps: 10 | Train Loss: 0.134 Vali Loss: 5.166 Vali Acc: 0.126 Test Loss: 5.166 Test Acc: 0.126
Validation loss decreased (-0.109373 --> -0.125831).  Saving model ...
Epoch: 6 cost time: 4.456502437591553
Epoch: 6, Steps: 10 | Train Loss: 0.060 Vali Loss: 5.832 Vali Acc: 0.139 Test Loss: 5.832 Test Acc: 0.139
Validation loss decreased (-0.125831 --> -0.138765).  Saving model ...
Epoch: 7 cost time: 4.375473976135254
Epoch: 7, Steps: 10 | Train Loss: 0.022 Vali Loss: 6.061 Vali Acc: 0.132 Test Loss: 6.061 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.1595847606658936
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.520 Vali Acc: 0.126 Test Loss: 6.520 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.288232803344727
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.494 Vali Acc: 0.139 Test Loss: 6.494 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.051882743835449
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.468 Vali Acc: 0.139 Test Loss: 6.468 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.302008152008057
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.732 Vali Acc: 0.145 Test Loss: 6.732 Test Acc: 0.145
Validation loss decreased (-0.138765 --> -0.144639).  Saving model ...
Epoch: 12 cost time: 4.248232364654541
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 6.938 Vali Acc: 0.134 Test Loss: 6.938 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.163670778274536
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 7.271 Vali Acc: 0.129 Test Loss: 7.271 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.21353554725647
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 7.560 Vali Acc: 0.142 Test Loss: 7.560 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.050266742706299
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 7.812 Vali Acc: 0.145 Test Loss: 7.812 Test Acc: 0.145
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.338103294372559
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 8.076 Vali Acc: 0.139 Test Loss: 8.076 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.116390228271484
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 8.019 Vali Acc: 0.141 Test Loss: 8.019 Test Acc: 0.141
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.05647611618042
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 8.827 Vali Acc: 0.131 Test Loss: 8.827 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.702059507369995
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 9.575 Vali Acc: 0.122 Test Loss: 9.575 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.430396795272827
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 10.400 Vali Acc: 0.124 Test Loss: 10.400 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.195459842681885
Epoch: 21, Steps: 10 | Train Loss: 0.078 Vali Loss: 11.596 Vali Acc: 0.100 Test Loss: 11.596 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14470588235294118
model parameter : 12932122
model size : 68.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.885336399078369
Epoch: 1, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.407 Vali Acc: 0.047 Test Loss: 3.407 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 4.775685548782349
Epoch: 2, Steps: 10 | Train Loss: 2.780 Vali Loss: 3.557 Vali Acc: 0.072 Test Loss: 3.557 Test Acc: 0.072
Validation loss decreased (-0.047025 --> -0.071729).  Saving model ...
Epoch: 3 cost time: 4.886326551437378
Epoch: 3, Steps: 10 | Train Loss: 1.547 Vali Loss: 3.598 Vali Acc: 0.087 Test Loss: 3.598 Test Acc: 0.087
Validation loss decreased (-0.071729 --> -0.087023).  Saving model ...
Epoch: 4 cost time: 4.964200496673584
Epoch: 4, Steps: 10 | Train Loss: 0.729 Vali Loss: 4.124 Vali Acc: 0.094 Test Loss: 4.124 Test Acc: 0.094
Validation loss decreased (-0.087023 --> -0.094076).  Saving model ...
Epoch: 5 cost time: 4.194004058837891
Epoch: 5, Steps: 10 | Train Loss: 0.227 Vali Loss: 4.677 Vali Acc: 0.100 Test Loss: 4.677 Test Acc: 0.100
Validation loss decreased (-0.094076 --> -0.099953).  Saving model ...
Epoch: 6 cost time: 4.240812301635742
Epoch: 6, Steps: 10 | Train Loss: 0.063 Vali Loss: 5.310 Vali Acc: 0.111 Test Loss: 5.310 Test Acc: 0.111
Validation loss decreased (-0.099953 --> -0.110535).  Saving model ...
Epoch: 7 cost time: 4.239869832992554
Epoch: 7, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.802 Vali Acc: 0.101 Test Loss: 5.802 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.5865209102630615
Epoch: 8, Steps: 10 | Train Loss: 0.026 Vali Loss: 6.282 Vali Acc: 0.098 Test Loss: 6.282 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.555229902267456
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.314 Vali Acc: 0.127 Test Loss: 6.314 Test Acc: 0.127
Validation loss decreased (-0.110535 --> -0.126996).  Saving model ...
Epoch: 10 cost time: 4.716684579849243
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.456 Vali Acc: 0.111 Test Loss: 6.456 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.54999303817749
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.533 Vali Acc: 0.114 Test Loss: 6.533 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.379317045211792
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.364 Vali Acc: 0.126 Test Loss: 6.364 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.285465478897095
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.440 Vali Acc: 0.129 Test Loss: 6.440 Test Acc: 0.129
Validation loss decreased (-0.126996 --> -0.129347).  Saving model ...
Epoch: 14 cost time: 4.838383674621582
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.074 Vali Acc: 0.112 Test Loss: 7.074 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.605227947235107
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 7.013 Vali Acc: 0.109 Test Loss: 7.013 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.0473527908325195
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 7.437 Vali Acc: 0.100 Test Loss: 7.437 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.28629207611084
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 7.701 Vali Acc: 0.120 Test Loss: 7.701 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.60986065864563
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 8.182 Vali Acc: 0.105 Test Loss: 8.182 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.226755142211914
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 8.539 Vali Acc: 0.101 Test Loss: 8.539 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.427356004714966
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 9.600 Vali Acc: 0.082 Test Loss: 9.600 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.388733625411987
Epoch: 21, Steps: 10 | Train Loss: 0.090 Vali Loss: 10.048 Vali Acc: 0.085 Test Loss: 10.048 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.3741455078125
Epoch: 22, Steps: 10 | Train Loss: 0.155 Vali Loss: 10.339 Vali Acc: 0.094 Test Loss: 10.339 Test Acc: 0.094
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.37487006187439
Epoch: 23, Steps: 10 | Train Loss: 0.133 Vali Loss: 11.075 Vali Acc: 0.093 Test Loss: 11.075 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12941176470588237
model parameter : 12932122
model size : 68.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.717585325241089
Epoch: 1, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.399 Vali Acc: 0.066 Test Loss: 3.399 Test Acc: 0.066
Validation loss decreased (inf --> -0.065848).  Saving model ...
Epoch: 2 cost time: 4.745572090148926
Epoch: 2, Steps: 10 | Train Loss: 2.954 Vali Loss: 3.612 Vali Acc: 0.078 Test Loss: 3.612 Test Acc: 0.078
Validation loss decreased (-0.065848 --> -0.077611).  Saving model ...
Epoch: 3 cost time: 4.55052375793457
Epoch: 3, Steps: 10 | Train Loss: 2.022 Vali Loss: 3.506 Vali Acc: 0.106 Test Loss: 3.506 Test Acc: 0.106
Validation loss decreased (-0.077611 --> -0.105847).  Saving model ...
Epoch: 4 cost time: 4.374837636947632
Epoch: 4, Steps: 10 | Train Loss: 1.084 Vali Loss: 3.963 Vali Acc: 0.096 Test Loss: 3.963 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9740118980407715
Epoch: 5, Steps: 10 | Train Loss: 0.466 Vali Loss: 4.870 Vali Acc: 0.089 Test Loss: 4.870 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.0360846519470215
Epoch: 6, Steps: 10 | Train Loss: 0.217 Vali Loss: 5.483 Vali Acc: 0.105 Test Loss: 5.483 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.306077241897583
Epoch: 7, Steps: 10 | Train Loss: 0.083 Vali Loss: 6.073 Vali Acc: 0.112 Test Loss: 6.073 Test Acc: 0.112
Validation loss decreased (-0.105847 --> -0.111704).  Saving model ...
Epoch: 8 cost time: 4.541930198669434
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 6.388 Vali Acc: 0.115 Test Loss: 6.388 Test Acc: 0.115
Validation loss decreased (-0.111704 --> -0.115230).  Saving model ...
Epoch: 9 cost time: 4.5800940990448
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 7.295 Vali Acc: 0.101 Test Loss: 7.295 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.505577802658081
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 6.996 Vali Acc: 0.104 Test Loss: 6.996 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.546333074569702
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 7.483 Vali Acc: 0.099 Test Loss: 7.483 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.622873306274414
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 7.736 Vali Acc: 0.101 Test Loss: 7.736 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.72870659828186
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.497 Vali Acc: 0.102 Test Loss: 7.497 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.440314531326294
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.638 Vali Acc: 0.108 Test Loss: 7.638 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.129440784454346
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.730 Vali Acc: 0.115 Test Loss: 7.730 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.026542901992798
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.721 Vali Acc: 0.114 Test Loss: 7.721 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.721376419067383
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.692 Vali Acc: 0.109 Test Loss: 7.692 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.805022716522217
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.680 Vali Acc: 0.111 Test Loss: 7.680 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.11529411764705882
model parameter : 12932122
model size : 68.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.166202783584595
Epoch: 1, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.400 Vali Acc: 0.040 Test Loss: 3.400 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 4.277838706970215
Epoch: 2, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.620 Vali Acc: 0.068 Test Loss: 3.620 Test Acc: 0.068
Validation loss decreased (-0.039966 --> -0.068199).  Saving model ...
Epoch: 3 cost time: 4.214676856994629
Epoch: 3, Steps: 10 | Train Loss: 2.317 Vali Loss: 3.446 Vali Acc: 0.099 Test Loss: 3.446 Test Acc: 0.099
Validation loss decreased (-0.068199 --> -0.098789).  Saving model ...
Epoch: 4 cost time: 4.810583114624023
Epoch: 4, Steps: 10 | Train Loss: 1.405 Vali Loss: 3.745 Vali Acc: 0.100 Test Loss: 3.745 Test Acc: 0.100
Validation loss decreased (-0.098789 --> -0.099963).  Saving model ...
Epoch: 5 cost time: 4.389619588851929
Epoch: 5, Steps: 10 | Train Loss: 0.726 Vali Loss: 4.481 Vali Acc: 0.105 Test Loss: 4.481 Test Acc: 0.105
Validation loss decreased (-0.099963 --> -0.104661).  Saving model ...
Epoch: 6 cost time: 4.674270391464233
Epoch: 6, Steps: 10 | Train Loss: 0.353 Vali Loss: 5.013 Vali Acc: 0.125 Test Loss: 5.013 Test Acc: 0.125
Validation loss decreased (-0.104661 --> -0.124656).  Saving model ...
Epoch: 7 cost time: 4.606995105743408
Epoch: 7, Steps: 10 | Train Loss: 0.178 Vali Loss: 5.558 Vali Acc: 0.118 Test Loss: 5.558 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.796611547470093
Epoch: 8, Steps: 10 | Train Loss: 0.063 Vali Loss: 5.825 Vali Acc: 0.120 Test Loss: 5.825 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.695067644119263
Epoch: 9, Steps: 10 | Train Loss: 0.044 Vali Loss: 6.361 Vali Acc: 0.121 Test Loss: 6.361 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.547969579696655
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.323 Vali Acc: 0.133 Test Loss: 6.323 Test Acc: 0.133
Validation loss decreased (-0.124656 --> -0.132878).  Saving model ...
Epoch: 11 cost time: 4.427217721939087
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.665 Vali Acc: 0.124 Test Loss: 6.665 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.471950531005859
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.813 Vali Acc: 0.119 Test Loss: 6.813 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.0849292278289795
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.738 Vali Acc: 0.122 Test Loss: 6.738 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.9547624588012695
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.690 Vali Acc: 0.134 Test Loss: 6.690 Test Acc: 0.134
Validation loss decreased (-0.132878 --> -0.134051).  Saving model ...
Epoch: 15 cost time: 4.361331462860107
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.675 Vali Acc: 0.135 Test Loss: 6.675 Test Acc: 0.135
Validation loss decreased (-0.134051 --> -0.135227).  Saving model ...
Epoch: 16 cost time: 4.597500801086426
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.677 Vali Acc: 0.134 Test Loss: 6.677 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.273546457290649
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.678 Vali Acc: 0.133 Test Loss: 6.678 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.180036783218384
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.687 Vali Acc: 0.132 Test Loss: 6.687 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.217641353607178
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.698 Vali Acc: 0.129 Test Loss: 6.698 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.331167459487915
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.721 Vali Acc: 0.128 Test Loss: 6.721 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.570062637329102
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.742 Vali Acc: 0.132 Test Loss: 6.742 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.324460506439209
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.769 Vali Acc: 0.132 Test Loss: 6.769 Test Acc: 0.132
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.6660075187683105
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.796 Vali Acc: 0.131 Test Loss: 6.796 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.803927421569824
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.820 Vali Acc: 0.129 Test Loss: 6.820 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.972785472869873
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.852 Vali Acc: 0.128 Test Loss: 6.852 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13529411764705881
model parameter : 12932122
model size : 68.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.294809341430664
Epoch: 1, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.378 Vali Acc: 0.055 Test Loss: 3.378 Test Acc: 0.055
Validation loss decreased (inf --> -0.055260).  Saving model ...
Epoch: 2 cost time: 4.4299094676971436
Epoch: 2, Steps: 10 | Train Loss: 3.098 Vali Loss: 3.655 Vali Acc: 0.078 Test Loss: 3.655 Test Acc: 0.078
Validation loss decreased (-0.055260 --> -0.077611).  Saving model ...
Epoch: 3 cost time: 4.462117910385132
Epoch: 3, Steps: 10 | Train Loss: 2.461 Vali Loss: 3.459 Vali Acc: 0.094 Test Loss: 3.459 Test Acc: 0.094
Validation loss decreased (-0.077611 --> -0.094083).  Saving model ...
Epoch: 4 cost time: 4.539332151412964
Epoch: 4, Steps: 10 | Train Loss: 1.699 Vali Loss: 3.677 Vali Acc: 0.098 Test Loss: 3.677 Test Acc: 0.098
Validation loss decreased (-0.094083 --> -0.097610).  Saving model ...
Epoch: 5 cost time: 3.9676425457000732
Epoch: 5, Steps: 10 | Train Loss: 0.953 Vali Loss: 4.341 Vali Acc: 0.114 Test Loss: 4.341 Test Acc: 0.114
Validation loss decreased (-0.097610 --> -0.114074).  Saving model ...
Epoch: 6 cost time: 4.163687705993652
Epoch: 6, Steps: 10 | Train Loss: 0.531 Vali Loss: 4.864 Vali Acc: 0.121 Test Loss: 4.864 Test Acc: 0.121
Validation loss decreased (-0.114074 --> -0.121128).  Saving model ...
Epoch: 7 cost time: 4.19529914855957
Epoch: 7, Steps: 10 | Train Loss: 0.243 Vali Loss: 5.684 Vali Acc: 0.132 Test Loss: 5.684 Test Acc: 0.132
Validation loss decreased (-0.121128 --> -0.131708).  Saving model ...
Epoch: 8 cost time: 4.497590780258179
Epoch: 8, Steps: 10 | Train Loss: 0.147 Vali Loss: 5.675 Vali Acc: 0.141 Test Loss: 5.675 Test Acc: 0.141
Validation loss decreased (-0.131708 --> -0.141120).  Saving model ...
Epoch: 9 cost time: 4.021165370941162
Epoch: 9, Steps: 10 | Train Loss: 0.058 Vali Loss: 6.277 Vali Acc: 0.131 Test Loss: 6.277 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.349898099899292
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 6.312 Vali Acc: 0.156 Test Loss: 6.312 Test Acc: 0.156
Validation loss decreased (-0.141120 --> -0.156407).  Saving model ...
Epoch: 11 cost time: 3.931814670562744
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 6.890 Vali Acc: 0.144 Test Loss: 6.890 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.382591485977173
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 6.991 Vali Acc: 0.145 Test Loss: 6.991 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.952850341796875
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 7.082 Vali Acc: 0.142 Test Loss: 7.082 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.276426792144775
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.362 Vali Acc: 0.149 Test Loss: 7.362 Test Acc: 0.149
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.350274085998535
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.271 Vali Acc: 0.148 Test Loss: 7.271 Test Acc: 0.148
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.623932600021362
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.225 Vali Acc: 0.147 Test Loss: 7.225 Test Acc: 0.147
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.818086385726929
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.167 Vali Acc: 0.153 Test Loss: 7.167 Test Acc: 0.153
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.628533363342285
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.145 Vali Acc: 0.152 Test Loss: 7.145 Test Acc: 0.152
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.452591896057129
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.149 Vali Acc: 0.154 Test Loss: 7.149 Test Acc: 0.154
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.6848766803741455
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.168 Vali Acc: 0.152 Test Loss: 7.168 Test Acc: 0.152
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1564705882352941
model parameter : 12932122
model size : 68.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.67857813835144
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.039 Test Loss: 3.258 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 4.279558897018433
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.039 Test Loss: 3.258 Test Acc: 0.039
Validation loss decreased (-0.038791 --> -0.038791).  Saving model ...
Epoch: 3 cost time: 4.274190425872803
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.039 Test Loss: 3.258 Test Acc: 0.039
Validation loss decreased (-0.038791 --> -0.038791).  Saving model ...
Epoch: 4 cost time: 4.646237850189209
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.86106276512146
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.672707796096802
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.136712551116943
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.696368455886841
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.71842622756958
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.910163402557373
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.950462579727173
Epoch: 11, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.250112295150757
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.80724573135376
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.03882352941176471
model parameter : 12932122
model size : 68.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.4132890701293945
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.279 Vali Acc: 0.078 Test Loss: 3.279 Test Acc: 0.078
Validation loss decreased (inf --> -0.077614).  Saving model ...
Epoch: 2 cost time: 4.475220441818237
Epoch: 2, Steps: 10 | Train Loss: 2.678 Vali Loss: 3.308 Vali Acc: 0.151 Test Loss: 3.308 Test Acc: 0.151
Validation loss decreased (-0.077614 --> -0.150555).  Saving model ...
Epoch: 3 cost time: 4.977133512496948
Epoch: 3, Steps: 10 | Train Loss: 1.656 Vali Loss: 3.162 Vali Acc: 0.222 Test Loss: 3.162 Test Acc: 0.222
Validation loss decreased (-0.150555 --> -0.222321).  Saving model ...
Epoch: 4 cost time: 4.297456502914429
Epoch: 4, Steps: 10 | Train Loss: 0.886 Vali Loss: 3.324 Vali Acc: 0.231 Test Loss: 3.324 Test Acc: 0.231
Validation loss decreased (-0.222321 --> -0.230555).  Saving model ...
Epoch: 5 cost time: 4.263242721557617
Epoch: 5, Steps: 10 | Train Loss: 0.409 Vali Loss: 3.566 Vali Acc: 0.271 Test Loss: 3.566 Test Acc: 0.271
Validation loss decreased (-0.230555 --> -0.270553).  Saving model ...
Epoch: 6 cost time: 4.529779434204102
Epoch: 6, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.810 Vali Acc: 0.289 Test Loss: 3.810 Test Acc: 0.289
Validation loss decreased (-0.270553 --> -0.289374).  Saving model ...
Epoch: 7 cost time: 4.322002649307251
Epoch: 7, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.111 Vali Acc: 0.287 Test Loss: 4.111 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.485658645629883
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.299 Vali Acc: 0.272 Test Loss: 4.299 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.555826187133789
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.386 Vali Acc: 0.289 Test Loss: 4.386 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.810436725616455
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.473 Vali Acc: 0.292 Test Loss: 4.473 Test Acc: 0.292
Validation loss decreased (-0.289374 --> -0.291720).  Saving model ...
Epoch: 11 cost time: 4.20982551574707
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.543 Vali Acc: 0.301 Test Loss: 4.543 Test Acc: 0.301
Validation loss decreased (-0.291720 --> -0.301131).  Saving model ...
Epoch: 12 cost time: 4.2964653968811035
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.605 Vali Acc: 0.307 Test Loss: 4.605 Test Acc: 0.307
Validation loss decreased (-0.301131 --> -0.307013).  Saving model ...
Epoch: 13 cost time: 4.235129356384277
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.640 Vali Acc: 0.305 Test Loss: 4.640 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.526681184768677
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.650 Vali Acc: 0.300 Test Loss: 4.650 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.489399194717407
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.663 Vali Acc: 0.306 Test Loss: 4.663 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.607929468154907
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.673 Vali Acc: 0.305 Test Loss: 4.673 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.9166765213012695
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.684 Vali Acc: 0.304 Test Loss: 4.684 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.192478656768799
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.696 Vali Acc: 0.304 Test Loss: 4.696 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.435845613479614
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.713 Vali Acc: 0.306 Test Loss: 4.713 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.402961015701294
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.730 Vali Acc: 0.305 Test Loss: 4.730 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.801974296569824
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.745 Vali Acc: 0.304 Test Loss: 4.745 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.441502332687378
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.758 Vali Acc: 0.305 Test Loss: 4.758 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 6793754
model size : 35.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.423601388931274
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.301 Vali Acc: 0.075 Test Loss: 3.301 Test Acc: 0.075
Validation loss decreased (inf --> -0.075261).  Saving model ...
Epoch: 2 cost time: 4.016752481460571
Epoch: 2, Steps: 10 | Train Loss: 2.659 Vali Loss: 3.315 Vali Acc: 0.174 Test Loss: 3.315 Test Acc: 0.174
Validation loss decreased (-0.075261 --> -0.174085).  Saving model ...
Epoch: 3 cost time: 4.386288404464722
Epoch: 3, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.166 Vali Acc: 0.238 Test Loss: 3.166 Test Acc: 0.238
Validation loss decreased (-0.174085 --> -0.237615).  Saving model ...
Epoch: 4 cost time: 4.159739971160889
Epoch: 4, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.322 Vali Acc: 0.254 Test Loss: 3.322 Test Acc: 0.254
Validation loss decreased (-0.237615 --> -0.254084).  Saving model ...
Epoch: 5 cost time: 3.989464044570923
Epoch: 5, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.582 Vali Acc: 0.284 Test Loss: 3.582 Test Acc: 0.284
Validation loss decreased (-0.254084 --> -0.283494).  Saving model ...
Epoch: 6 cost time: 4.5614917278289795
Epoch: 6, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.884 Vali Acc: 0.301 Test Loss: 3.884 Test Acc: 0.301
Validation loss decreased (-0.283494 --> -0.301138).  Saving model ...
Epoch: 7 cost time: 4.4683568477630615
Epoch: 7, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.171 Vali Acc: 0.294 Test Loss: 4.171 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.705206394195557
Epoch: 8, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.424 Vali Acc: 0.298 Test Loss: 4.424 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.81470799446106
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.450 Vali Acc: 0.314 Test Loss: 4.450 Test Acc: 0.314
Validation loss decreased (-0.301138 --> -0.314073).  Saving model ...
Epoch: 10 cost time: 4.9139463901519775
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.646 Vali Acc: 0.301 Test Loss: 4.646 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.7622292041778564
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.658 Vali Acc: 0.305 Test Loss: 4.658 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.810867071151733
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.675 Vali Acc: 0.306 Test Loss: 4.675 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.285135507583618
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.683 Vali Acc: 0.309 Test Loss: 4.683 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.713050842285156
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.701 Vali Acc: 0.318 Test Loss: 4.701 Test Acc: 0.318
Validation loss decreased (-0.314073 --> -0.317600).  Saving model ...
Epoch: 15 cost time: 4.720225811004639
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.724 Vali Acc: 0.319 Test Loss: 4.724 Test Acc: 0.319
Validation loss decreased (-0.317600 --> -0.318776).  Saving model ...
Epoch: 16 cost time: 4.715006589889526
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.741 Vali Acc: 0.314 Test Loss: 4.741 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.948076248168945
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.745 Vali Acc: 0.315 Test Loss: 4.745 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.092253923416138
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.751 Vali Acc: 0.316 Test Loss: 4.751 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.362935304641724
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.759 Vali Acc: 0.318 Test Loss: 4.759 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.78840184211731
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.770 Vali Acc: 0.318 Test Loss: 4.770 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.781250715255737
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.789 Vali Acc: 0.319 Test Loss: 4.789 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.737399101257324
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.805 Vali Acc: 0.320 Test Loss: 4.805 Test Acc: 0.320
Validation loss decreased (-0.318776 --> -0.319952).  Saving model ...
Epoch: 23 cost time: 4.268595933914185
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.824 Vali Acc: 0.320 Test Loss: 4.824 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.012056350708008
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.842 Vali Acc: 0.321 Test Loss: 4.842 Test Acc: 0.321
Validation loss decreased (-0.319952 --> -0.321128).  Saving model ...
Epoch: 25 cost time: 4.237268686294556
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.857 Vali Acc: 0.321 Test Loss: 4.857 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.659079551696777
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.871 Vali Acc: 0.319 Test Loss: 4.871 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.504611015319824
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.886 Vali Acc: 0.320 Test Loss: 4.886 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.435003757476807
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.896 Vali Acc: 0.320 Test Loss: 4.896 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.136890649795532
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.905 Vali Acc: 0.320 Test Loss: 4.905 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.217225074768066
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.922 Vali Acc: 0.320 Test Loss: 4.922 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.2958550453186035
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.937 Vali Acc: 0.320 Test Loss: 4.937 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.463303089141846
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.957 Vali Acc: 0.320 Test Loss: 4.957 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.754657745361328
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.967 Vali Acc: 0.320 Test Loss: 4.967 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.470202207565308
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.980 Vali Acc: 0.320 Test Loss: 4.980 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 6793754
model size : 35.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.023952484130859
Epoch: 1, Steps: 10 | Train Loss: 3.311 Vali Loss: 3.271 Vali Acc: 0.091 Test Loss: 3.271 Test Acc: 0.091
Validation loss decreased (inf --> -0.090556).  Saving model ...
Epoch: 2 cost time: 4.596149921417236
Epoch: 2, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.320 Vali Acc: 0.161 Test Loss: 3.320 Test Acc: 0.161
Validation loss decreased (-0.090556 --> -0.161143).  Saving model ...
Epoch: 3 cost time: 4.100273847579956
Epoch: 3, Steps: 10 | Train Loss: 1.782 Vali Loss: 3.223 Vali Acc: 0.248 Test Loss: 3.223 Test Acc: 0.248
Validation loss decreased (-0.161143 --> -0.248203).  Saving model ...
Epoch: 4 cost time: 4.378161668777466
Epoch: 4, Steps: 10 | Train Loss: 1.000 Vali Loss: 3.376 Vali Acc: 0.252 Test Loss: 3.376 Test Acc: 0.252
Validation loss decreased (-0.248203 --> -0.251731).  Saving model ...
Epoch: 5 cost time: 4.176841974258423
Epoch: 5, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.604 Vali Acc: 0.276 Test Loss: 3.604 Test Acc: 0.276
Validation loss decreased (-0.251731 --> -0.276435).  Saving model ...
Epoch: 6 cost time: 4.793409824371338
Epoch: 6, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.791 Vali Acc: 0.294 Test Loss: 3.791 Test Acc: 0.294
Validation loss decreased (-0.276435 --> -0.294080).  Saving model ...
Epoch: 7 cost time: 4.03370475769043
Epoch: 7, Steps: 10 | Train Loss: 0.119 Vali Loss: 4.138 Vali Acc: 0.278 Test Loss: 4.138 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.527366876602173
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.413 Vali Acc: 0.282 Test Loss: 4.413 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.6822967529296875
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.573 Vali Acc: 0.311 Test Loss: 4.573 Test Acc: 0.311
Validation loss decreased (-0.294080 --> -0.310543).  Saving model ...
Epoch: 10 cost time: 4.645473480224609
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.586 Vali Acc: 0.300 Test Loss: 4.586 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.090530872344971
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.723 Vali Acc: 0.294 Test Loss: 4.723 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.880901336669922
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.952 Vali Acc: 0.301 Test Loss: 4.952 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.174796104431152
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.883 Vali Acc: 0.305 Test Loss: 4.883 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.040188312530518
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.908 Vali Acc: 0.306 Test Loss: 4.908 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.289433002471924
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.981 Vali Acc: 0.296 Test Loss: 4.981 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.466215133666992
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.966 Vali Acc: 0.301 Test Loss: 4.966 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.9078528881073
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.932 Vali Acc: 0.304 Test Loss: 4.932 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.036818742752075
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.921 Vali Acc: 0.312 Test Loss: 4.921 Test Acc: 0.312
Validation loss decreased (-0.310543 --> -0.311715).  Saving model ...
Epoch: 19 cost time: 4.4525041580200195
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.925 Vali Acc: 0.313 Test Loss: 4.925 Test Acc: 0.313
Validation loss decreased (-0.311715 --> -0.312892).  Saving model ...
Epoch: 20 cost time: 4.253212213516235
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.935 Vali Acc: 0.315 Test Loss: 4.935 Test Acc: 0.315
Validation loss decreased (-0.312892 --> -0.315245).  Saving model ...
Epoch: 21 cost time: 4.421493768692017
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.947 Vali Acc: 0.314 Test Loss: 4.947 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.445385217666626
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.960 Vali Acc: 0.314 Test Loss: 4.960 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.340087652206421
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.977 Vali Acc: 0.314 Test Loss: 4.977 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.939920425415039
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.990 Vali Acc: 0.316 Test Loss: 4.990 Test Acc: 0.316
Validation loss decreased (-0.315245 --> -0.316421).  Saving model ...
Epoch: 25 cost time: 4.339881181716919
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.996 Vali Acc: 0.319 Test Loss: 4.996 Test Acc: 0.319
Validation loss decreased (-0.316421 --> -0.318774).  Saving model ...
Epoch: 26 cost time: 5.119097471237183
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.005 Vali Acc: 0.316 Test Loss: 5.005 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.410955905914307
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.014 Vali Acc: 0.318 Test Loss: 5.014 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.547830104827881
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.025 Vali Acc: 0.319 Test Loss: 5.025 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.330339670181274
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.031 Vali Acc: 0.320 Test Loss: 5.031 Test Acc: 0.320
Validation loss decreased (-0.318774 --> -0.319950).  Saving model ...
Epoch: 30 cost time: 4.251414060592651
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.047 Vali Acc: 0.321 Test Loss: 5.047 Test Acc: 0.321
Validation loss decreased (-0.319950 --> -0.321126).  Saving model ...
Epoch: 31 cost time: 4.291484117507935
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.059 Vali Acc: 0.319 Test Loss: 5.059 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.3709399700164795
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.073 Vali Acc: 0.319 Test Loss: 5.073 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.598651647567749
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.079 Vali Acc: 0.320 Test Loss: 5.079 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.432133436203003
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.089 Vali Acc: 0.321 Test Loss: 5.089 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.8768224716186523
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.103 Vali Acc: 0.321 Test Loss: 5.103 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 4.363945722579956
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.112 Vali Acc: 0.321 Test Loss: 5.112 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.960775375366211
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.124 Vali Acc: 0.321 Test Loss: 5.124 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 4.225405693054199
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.134 Vali Acc: 0.322 Test Loss: 5.134 Test Acc: 0.322
Validation loss decreased (-0.321126 --> -0.322302).  Saving model ...
Epoch: 39 cost time: 4.315281629562378
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.144 Vali Acc: 0.321 Test Loss: 5.144 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.8616554737091064
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.151 Vali Acc: 0.320 Test Loss: 5.151 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.904207468032837
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.164 Vali Acc: 0.321 Test Loss: 5.164 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.810269832611084
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.174 Vali Acc: 0.320 Test Loss: 5.174 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 4.054273366928101
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.183 Vali Acc: 0.321 Test Loss: 5.183 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 4.407012224197388
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.191 Vali Acc: 0.321 Test Loss: 5.191 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 4.2038421630859375
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.197 Vali Acc: 0.321 Test Loss: 5.197 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.698681116104126
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.206 Vali Acc: 0.321 Test Loss: 5.206 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.9811179637908936
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.214 Vali Acc: 0.320 Test Loss: 5.214 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.6890344619750977
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.223 Vali Acc: 0.321 Test Loss: 5.223 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 6793754
model size : 35.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.253421068191528
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.298 Vali Acc: 0.074 Test Loss: 3.298 Test Acc: 0.074
Validation loss decreased (inf --> -0.074085).  Saving model ...
Epoch: 2 cost time: 4.147189140319824
Epoch: 2, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.426 Vali Acc: 0.124 Test Loss: 3.426 Test Acc: 0.124
Validation loss decreased (-0.074085 --> -0.123495).  Saving model ...
Epoch: 3 cost time: 4.139465808868408
Epoch: 3, Steps: 10 | Train Loss: 1.828 Vali Loss: 3.419 Vali Acc: 0.174 Test Loss: 3.419 Test Acc: 0.174
Validation loss decreased (-0.123495 --> -0.174083).  Saving model ...
Epoch: 4 cost time: 4.04393744468689
Epoch: 4, Steps: 10 | Train Loss: 1.119 Vali Loss: 3.612 Vali Acc: 0.178 Test Loss: 3.612 Test Acc: 0.178
Validation loss decreased (-0.174083 --> -0.177611).  Saving model ...
Epoch: 5 cost time: 4.197727203369141
Epoch: 5, Steps: 10 | Train Loss: 0.625 Vali Loss: 3.878 Vali Acc: 0.216 Test Loss: 3.878 Test Acc: 0.216
Validation loss decreased (-0.177611 --> -0.216432).  Saving model ...
Epoch: 6 cost time: 4.554515600204468
Epoch: 6, Steps: 10 | Train Loss: 0.324 Vali Loss: 4.115 Vali Acc: 0.242 Test Loss: 4.115 Test Acc: 0.242
Validation loss decreased (-0.216432 --> -0.242312).  Saving model ...
Epoch: 7 cost time: 4.975813627243042
Epoch: 7, Steps: 10 | Train Loss: 0.138 Vali Loss: 4.502 Vali Acc: 0.240 Test Loss: 4.502 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.382766008377075
Epoch: 8, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.740 Vali Acc: 0.241 Test Loss: 4.740 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.926691770553589
Epoch: 9, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.986 Vali Acc: 0.248 Test Loss: 4.986 Test Acc: 0.248
Validation loss decreased (-0.242312 --> -0.248185).  Saving model ...
Epoch: 10 cost time: 3.926326036453247
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.162 Vali Acc: 0.253 Test Loss: 5.162 Test Acc: 0.253
Validation loss decreased (-0.248185 --> -0.252890).  Saving model ...
Epoch: 11 cost time: 4.142606973648071
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 5.251 Vali Acc: 0.253 Test Loss: 5.251 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.20732045173645
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.248 Vali Acc: 0.249 Test Loss: 5.248 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.177504301071167
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.281 Vali Acc: 0.247 Test Loss: 5.281 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.9138736724853516
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.309 Vali Acc: 0.256 Test Loss: 5.309 Test Acc: 0.256
Validation loss decreased (-0.252890 --> -0.256417).  Saving model ...
Epoch: 15 cost time: 4.036296606063843
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 5.444 Vali Acc: 0.256 Test Loss: 5.444 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.866702079772949
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.607 Vali Acc: 0.247 Test Loss: 5.607 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.171687126159668
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.610 Vali Acc: 0.253 Test Loss: 5.610 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.993330478668213
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.608 Vali Acc: 0.256 Test Loss: 5.608 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.069189548492432
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.631 Vali Acc: 0.255 Test Loss: 5.631 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.211606740951538
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.649 Vali Acc: 0.256 Test Loss: 5.649 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.525715589523315
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.662 Vali Acc: 0.256 Test Loss: 5.662 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.327912092208862
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.670 Vali Acc: 0.256 Test Loss: 5.670 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.4957802295684814
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.687 Vali Acc: 0.256 Test Loss: 5.687 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.34057092666626
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.705 Vali Acc: 0.255 Test Loss: 5.705 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 6793754
model size : 35.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.8963072299957275
Epoch: 1, Steps: 10 | Train Loss: 3.371 Vali Loss: 3.336 Vali Acc: 0.044 Test Loss: 3.336 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 4.160769701004028
Epoch: 2, Steps: 10 | Train Loss: 2.805 Vali Loss: 3.479 Vali Acc: 0.071 Test Loss: 3.479 Test Acc: 0.071
Validation loss decreased (-0.043496 --> -0.070553).  Saving model ...
Epoch: 3 cost time: 4.5203399658203125
Epoch: 3, Steps: 10 | Train Loss: 1.953 Vali Loss: 3.444 Vali Acc: 0.104 Test Loss: 3.444 Test Acc: 0.104
Validation loss decreased (-0.070553 --> -0.103495).  Saving model ...
Epoch: 4 cost time: 4.207895517349243
Epoch: 4, Steps: 10 | Train Loss: 1.127 Vali Loss: 3.650 Vali Acc: 0.114 Test Loss: 3.650 Test Acc: 0.114
Validation loss decreased (-0.103495 --> -0.114081).  Saving model ...
Epoch: 5 cost time: 4.459517955780029
Epoch: 5, Steps: 10 | Train Loss: 0.561 Vali Loss: 4.033 Vali Acc: 0.127 Test Loss: 4.033 Test Acc: 0.127
Validation loss decreased (-0.114081 --> -0.127018).  Saving model ...
Epoch: 6 cost time: 4.268390655517578
Epoch: 6, Steps: 10 | Train Loss: 0.220 Vali Loss: 4.500 Vali Acc: 0.127 Test Loss: 4.500 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.091612339019775
Epoch: 7, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.823 Vali Acc: 0.128 Test Loss: 4.823 Test Acc: 0.128
Validation loss decreased (-0.127018 --> -0.128187).  Saving model ...
Epoch: 8 cost time: 4.336709976196289
Epoch: 8, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.245 Vali Acc: 0.136 Test Loss: 5.245 Test Acc: 0.136
Validation loss decreased (-0.128187 --> -0.136418).  Saving model ...
Epoch: 9 cost time: 4.146155118942261
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.377 Vali Acc: 0.141 Test Loss: 5.377 Test Acc: 0.141
Validation loss decreased (-0.136418 --> -0.141123).  Saving model ...
Epoch: 10 cost time: 4.2387073040008545
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.497 Vali Acc: 0.147 Test Loss: 5.497 Test Acc: 0.147
Validation loss decreased (-0.141123 --> -0.147004).  Saving model ...
Epoch: 11 cost time: 4.202299356460571
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.564 Vali Acc: 0.152 Test Loss: 5.564 Test Acc: 0.152
Validation loss decreased (-0.147004 --> -0.151709).  Saving model ...
Epoch: 12 cost time: 4.098931074142456
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.610 Vali Acc: 0.149 Test Loss: 5.610 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.48371148109436
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.651 Vali Acc: 0.148 Test Loss: 5.651 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.560545206069946
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.693 Vali Acc: 0.148 Test Loss: 5.693 Test Acc: 0.148
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.281296968460083
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.726 Vali Acc: 0.152 Test Loss: 5.726 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.9557318687438965
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.736 Vali Acc: 0.154 Test Loss: 5.736 Test Acc: 0.154
Validation loss decreased (-0.151709 --> -0.154060).  Saving model ...
Epoch: 17 cost time: 3.9373693466186523
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.747 Vali Acc: 0.155 Test Loss: 5.747 Test Acc: 0.155
Validation loss decreased (-0.154060 --> -0.155237).  Saving model ...
Epoch: 18 cost time: 4.216811418533325
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.759 Vali Acc: 0.158 Test Loss: 5.759 Test Acc: 0.158
Validation loss decreased (-0.155237 --> -0.157589).  Saving model ...
Epoch: 19 cost time: 4.289509534835815
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.773 Vali Acc: 0.160 Test Loss: 5.773 Test Acc: 0.160
Validation loss decreased (-0.157589 --> -0.159942).  Saving model ...
Epoch: 20 cost time: 4.236032009124756
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.783 Vali Acc: 0.161 Test Loss: 5.783 Test Acc: 0.161
Validation loss decreased (-0.159942 --> -0.161119).  Saving model ...
Epoch: 21 cost time: 4.5968499183654785
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.802 Vali Acc: 0.160 Test Loss: 5.802 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.299903631210327
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.825 Vali Acc: 0.158 Test Loss: 5.825 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.359472990036011
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.850 Vali Acc: 0.159 Test Loss: 5.850 Test Acc: 0.159
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.4899115562438965
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.876 Vali Acc: 0.159 Test Loss: 5.876 Test Acc: 0.159
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.546788454055786
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.894 Vali Acc: 0.159 Test Loss: 5.894 Test Acc: 0.159
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.671582221984863
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.914 Vali Acc: 0.159 Test Loss: 5.914 Test Acc: 0.159
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.160829067230225
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.931 Vali Acc: 0.159 Test Loss: 5.931 Test Acc: 0.159
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.179883718490601
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.944 Vali Acc: 0.161 Test Loss: 5.944 Test Acc: 0.161
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.089759588241577
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.957 Vali Acc: 0.161 Test Loss: 5.957 Test Acc: 0.161
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.074161529541016
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.982 Vali Acc: 0.162 Test Loss: 5.982 Test Acc: 0.162
Validation loss decreased (-0.161119 --> -0.162293).  Saving model ...
Epoch: 31 cost time: 4.1949944496154785
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.994 Vali Acc: 0.161 Test Loss: 5.994 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.234305381774902
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.013 Vali Acc: 0.161 Test Loss: 6.013 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.9027960300445557
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.031 Vali Acc: 0.161 Test Loss: 6.031 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.061838388442993
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.050 Vali Acc: 0.161 Test Loss: 6.050 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 4.163123369216919
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.069 Vali Acc: 0.161 Test Loss: 6.069 Test Acc: 0.161
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 4.458338499069214
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.081 Vali Acc: 0.160 Test Loss: 6.081 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 4.286214351654053
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.100 Vali Acc: 0.162 Test Loss: 6.100 Test Acc: 0.162
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 4.293582916259766
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.117 Vali Acc: 0.165 Test Loss: 6.117 Test Acc: 0.165
Validation loss decreased (-0.162293 --> -0.164645).  Saving model ...
Epoch: 39 cost time: 4.298862457275391
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.133 Vali Acc: 0.164 Test Loss: 6.133 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.1507532596588135
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.143 Vali Acc: 0.165 Test Loss: 6.143 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 4.206332206726074
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.156 Vali Acc: 0.166 Test Loss: 6.156 Test Acc: 0.166
Validation loss decreased (-0.164645 --> -0.165821).  Saving model ...
Epoch: 42 cost time: 4.123903036117554
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.169 Vali Acc: 0.167 Test Loss: 6.169 Test Acc: 0.167
Validation loss decreased (-0.165821 --> -0.166997).  Saving model ...
Epoch: 43 cost time: 4.397364139556885
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.179 Vali Acc: 0.164 Test Loss: 6.179 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.708791255950928
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.190 Vali Acc: 0.167 Test Loss: 6.190 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 4.308089256286621
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.202 Vali Acc: 0.166 Test Loss: 6.202 Test Acc: 0.166
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 4.141464471817017
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.218 Vali Acc: 0.165 Test Loss: 6.218 Test Acc: 0.165
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 4.415614128112793
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.227 Vali Acc: 0.165 Test Loss: 6.227 Test Acc: 0.165
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 4.665190935134888
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.239 Vali Acc: 0.167 Test Loss: 6.239 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 4.827274560928345
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.253 Vali Acc: 0.166 Test Loss: 6.253 Test Acc: 0.166
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 4.007211208343506
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.268 Vali Acc: 0.167 Test Loss: 6.268 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 4.576616048812866
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.285 Vali Acc: 0.169 Test Loss: 6.285 Test Acc: 0.169
Validation loss decreased (-0.166997 --> -0.169349).  Saving model ...
Epoch: 52 cost time: 3.7426724433898926
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.297 Vali Acc: 0.171 Test Loss: 6.297 Test Acc: 0.171
Validation loss decreased (-0.169349 --> -0.170525).  Saving model ...
Epoch: 53 cost time: 4.395113229751587
Epoch: 53, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.308 Vali Acc: 0.169 Test Loss: 6.308 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 4.270173788070679
Epoch: 54, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.317 Vali Acc: 0.168 Test Loss: 6.317 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 5.0756754875183105
Epoch: 55, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.329 Vali Acc: 0.168 Test Loss: 6.329 Test Acc: 0.168
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 4.918485164642334
Epoch: 56, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.338 Vali Acc: 0.169 Test Loss: 6.338 Test Acc: 0.169
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 4.385878801345825
Epoch: 57, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.347 Vali Acc: 0.168 Test Loss: 6.347 Test Acc: 0.168
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 4.2211925983428955
Epoch: 58, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.355 Vali Acc: 0.169 Test Loss: 6.355 Test Acc: 0.169
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 4.44517970085144
Epoch: 59, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.363 Vali Acc: 0.171 Test Loss: 6.363 Test Acc: 0.171
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 4.396519899368286
Epoch: 60, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.377 Vali Acc: 0.169 Test Loss: 6.377 Test Acc: 0.169
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 4.423594236373901
Epoch: 61, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.387 Vali Acc: 0.172 Test Loss: 6.387 Test Acc: 0.172
Validation loss decreased (-0.170525 --> -0.171701).  Saving model ...
Epoch: 62 cost time: 4.1084959506988525
Epoch: 62, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.396 Vali Acc: 0.172 Test Loss: 6.396 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 4.1223227977752686
Epoch: 63, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.406 Vali Acc: 0.172 Test Loss: 6.406 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 4.327635765075684
Epoch: 64, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.414 Vali Acc: 0.173 Test Loss: 6.414 Test Acc: 0.173
Validation loss decreased (-0.171701 --> -0.172877).  Saving model ...
Epoch: 65 cost time: 4.819000005722046
Epoch: 65, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.423 Vali Acc: 0.172 Test Loss: 6.423 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 4.90709924697876
Epoch: 66, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.434 Vali Acc: 0.173 Test Loss: 6.434 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 4.2198326587677
Epoch: 67, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.443 Vali Acc: 0.173 Test Loss: 6.443 Test Acc: 0.173
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 3.7396631240844727
Epoch: 68, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.452 Vali Acc: 0.173 Test Loss: 6.452 Test Acc: 0.173
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 4.232099294662476
Epoch: 69, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.461 Vali Acc: 0.173 Test Loss: 6.461 Test Acc: 0.173
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 4.600599527359009
Epoch: 70, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.470 Vali Acc: 0.173 Test Loss: 6.470 Test Acc: 0.173
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 4.35166072845459
Epoch: 71, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.479 Vali Acc: 0.172 Test Loss: 6.479 Test Acc: 0.172
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 4.446803331375122
Epoch: 72, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.488 Vali Acc: 0.172 Test Loss: 6.488 Test Acc: 0.172
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 4.371265649795532
Epoch: 73, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.496 Vali Acc: 0.172 Test Loss: 6.496 Test Acc: 0.172
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 4.089629888534546
Epoch: 74, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.505 Vali Acc: 0.173 Test Loss: 6.505 Test Acc: 0.173
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17294117647058824
model parameter : 6793754
model size : 35.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.251086473464966
Epoch: 1, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.328 Vali Acc: 0.047 Test Loss: 3.328 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 4.355835676193237
Epoch: 2, Steps: 10 | Train Loss: 2.970 Vali Loss: 3.470 Vali Acc: 0.066 Test Loss: 3.470 Test Acc: 0.066
Validation loss decreased (-0.047026 --> -0.065848).  Saving model ...
Epoch: 3 cost time: 4.530538558959961
Epoch: 3, Steps: 10 | Train Loss: 2.294 Vali Loss: 3.401 Vali Acc: 0.085 Test Loss: 3.401 Test Acc: 0.085
Validation loss decreased (-0.065848 --> -0.084672).  Saving model ...
Epoch: 4 cost time: 4.031612157821655
Epoch: 4, Steps: 10 | Train Loss: 1.577 Vali Loss: 3.465 Vali Acc: 0.086 Test Loss: 3.465 Test Acc: 0.086
Validation loss decreased (-0.084672 --> -0.085848).  Saving model ...
Epoch: 5 cost time: 4.470890760421753
Epoch: 5, Steps: 10 | Train Loss: 0.861 Vali Loss: 3.735 Vali Acc: 0.101 Test Loss: 3.735 Test Acc: 0.101
Validation loss decreased (-0.085848 --> -0.101139).  Saving model ...
Epoch: 6 cost time: 4.218106746673584
Epoch: 6, Steps: 10 | Train Loss: 0.394 Vali Loss: 4.062 Vali Acc: 0.100 Test Loss: 4.062 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.212084054946899
Epoch: 7, Steps: 10 | Train Loss: 0.133 Vali Loss: 4.598 Vali Acc: 0.104 Test Loss: 4.598 Test Acc: 0.104
Validation loss decreased (-0.101139 --> -0.103483).  Saving model ...
Epoch: 8 cost time: 3.980944871902466
Epoch: 8, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.902 Vali Acc: 0.113 Test Loss: 4.902 Test Acc: 0.113
Validation loss decreased (-0.103483 --> -0.112892).  Saving model ...
Epoch: 9 cost time: 4.012793302536011
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.206 Vali Acc: 0.111 Test Loss: 5.206 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.724935293197632
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.343 Vali Acc: 0.116 Test Loss: 5.343 Test Acc: 0.116
Validation loss decreased (-0.112892 --> -0.116417).  Saving model ...
Epoch: 11 cost time: 4.111090421676636
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.319 Vali Acc: 0.119 Test Loss: 5.319 Test Acc: 0.119
Validation loss decreased (-0.116417 --> -0.118770).  Saving model ...
Epoch: 12 cost time: 4.275916814804077
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.369 Vali Acc: 0.120 Test Loss: 5.369 Test Acc: 0.120
Validation loss decreased (-0.118770 --> -0.119946).  Saving model ...
Epoch: 13 cost time: 4.57373309135437
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.434 Vali Acc: 0.118 Test Loss: 5.434 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.400082588195801
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.496 Vali Acc: 0.114 Test Loss: 5.496 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.129757881164551
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.528 Vali Acc: 0.115 Test Loss: 5.528 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.02966046333313
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.541 Vali Acc: 0.118 Test Loss: 5.541 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.038349390029907
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.547 Vali Acc: 0.113 Test Loss: 5.547 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.56149435043335
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.568 Vali Acc: 0.116 Test Loss: 5.568 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.307917833328247
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.581 Vali Acc: 0.114 Test Loss: 5.581 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.180183410644531
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.597 Vali Acc: 0.114 Test Loss: 5.597 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.739309310913086
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.614 Vali Acc: 0.115 Test Loss: 5.614 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.9840190410614014
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.630 Vali Acc: 0.115 Test Loss: 5.630 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12
model parameter : 6793754
model size : 35.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.71632719039917
Epoch: 1, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.333 Vali Acc: 0.039 Test Loss: 3.333 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 3.9889206886291504
Epoch: 2, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.487 Vali Acc: 0.053 Test Loss: 3.487 Test Acc: 0.053
Validation loss decreased (-0.038790 --> -0.052906).  Saving model ...
Epoch: 3 cost time: 3.9407296180725098
Epoch: 3, Steps: 10 | Train Loss: 2.616 Vali Loss: 3.435 Vali Acc: 0.072 Test Loss: 3.435 Test Acc: 0.072
Validation loss decreased (-0.052906 --> -0.071730).  Saving model ...
Epoch: 4 cost time: 3.9425365924835205
Epoch: 4, Steps: 10 | Train Loss: 2.029 Vali Loss: 3.405 Vali Acc: 0.088 Test Loss: 3.405 Test Acc: 0.088
Validation loss decreased (-0.071730 --> -0.088201).  Saving model ...
Epoch: 5 cost time: 3.8219540119171143
Epoch: 5, Steps: 10 | Train Loss: 1.315 Vali Loss: 3.578 Vali Acc: 0.092 Test Loss: 3.578 Test Acc: 0.092
Validation loss decreased (-0.088201 --> -0.091729).  Saving model ...
Epoch: 6 cost time: 4.130573987960815
Epoch: 6, Steps: 10 | Train Loss: 0.774 Vali Loss: 3.850 Vali Acc: 0.092 Test Loss: 3.850 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8507513999938965
Epoch: 7, Steps: 10 | Train Loss: 0.330 Vali Loss: 4.350 Vali Acc: 0.100 Test Loss: 4.350 Test Acc: 0.100
Validation loss decreased (-0.091729 --> -0.099957).  Saving model ...
Epoch: 8 cost time: 3.7823805809020996
Epoch: 8, Steps: 10 | Train Loss: 0.120 Vali Loss: 4.761 Vali Acc: 0.102 Test Loss: 4.761 Test Acc: 0.102
Validation loss decreased (-0.099957 --> -0.102305).  Saving model ...
Epoch: 9 cost time: 4.15863299369812
Epoch: 9, Steps: 10 | Train Loss: 0.043 Vali Loss: 5.089 Vali Acc: 0.114 Test Loss: 5.089 Test Acc: 0.114
Validation loss decreased (-0.102305 --> -0.114067).  Saving model ...
Epoch: 10 cost time: 4.099169015884399
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.313 Vali Acc: 0.126 Test Loss: 5.313 Test Acc: 0.126
Validation loss decreased (-0.114067 --> -0.125829).  Saving model ...
Epoch: 11 cost time: 4.107531309127808
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.263 Vali Acc: 0.126 Test Loss: 5.263 Test Acc: 0.126
Validation loss decreased (-0.125829 --> -0.125830).  Saving model ...
Epoch: 12 cost time: 3.8773319721221924
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.310 Vali Acc: 0.131 Test Loss: 5.310 Test Acc: 0.131
Validation loss decreased (-0.125830 --> -0.130535).  Saving model ...
Epoch: 13 cost time: 3.5547289848327637
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.404 Vali Acc: 0.121 Test Loss: 5.404 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.098181486129761
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.495 Vali Acc: 0.116 Test Loss: 5.495 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.395352602005005
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.543 Vali Acc: 0.114 Test Loss: 5.543 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.199889659881592
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.560 Vali Acc: 0.115 Test Loss: 5.560 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.9601354598999023
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.578 Vali Acc: 0.116 Test Loss: 5.578 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.7418315410614014
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.591 Vali Acc: 0.121 Test Loss: 5.591 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.9841063022613525
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.605 Vali Acc: 0.124 Test Loss: 5.605 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.083139181137085
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.634 Vali Acc: 0.121 Test Loss: 5.634 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.080118656158447
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.663 Vali Acc: 0.120 Test Loss: 5.663 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.847930431365967
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.679 Vali Acc: 0.124 Test Loss: 5.679 Test Acc: 0.124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13058823529411764
model parameter : 6793754
model size : 35.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.24209189414978
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.343 Vali Acc: 0.035 Test Loss: 3.343 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 3.9509990215301514
Epoch: 2, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.491 Vali Acc: 0.059 Test Loss: 3.491 Test Acc: 0.059
Validation loss decreased (-0.035261 --> -0.058789).  Saving model ...
Epoch: 3 cost time: 3.935436248779297
Epoch: 3, Steps: 10 | Train Loss: 2.731 Vali Loss: 3.429 Vali Acc: 0.080 Test Loss: 3.429 Test Acc: 0.080
Validation loss decreased (-0.058789 --> -0.079966).  Saving model ...
Epoch: 4 cost time: 3.978289842605591
Epoch: 4, Steps: 10 | Train Loss: 2.250 Vali Loss: 3.353 Vali Acc: 0.087 Test Loss: 3.353 Test Acc: 0.087
Validation loss decreased (-0.079966 --> -0.087025).  Saving model ...
Epoch: 5 cost time: 4.280561923980713
Epoch: 5, Steps: 10 | Train Loss: 1.699 Vali Loss: 3.475 Vali Acc: 0.089 Test Loss: 3.475 Test Acc: 0.089
Validation loss decreased (-0.087025 --> -0.089377).  Saving model ...
Epoch: 6 cost time: 3.6495907306671143
Epoch: 6, Steps: 10 | Train Loss: 1.123 Vali Loss: 3.652 Vali Acc: 0.107 Test Loss: 3.652 Test Acc: 0.107
Validation loss decreased (-0.089377 --> -0.107022).  Saving model ...
Epoch: 7 cost time: 3.7604575157165527
Epoch: 7, Steps: 10 | Train Loss: 0.573 Vali Loss: 4.007 Vali Acc: 0.105 Test Loss: 4.007 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.005502223968506
Epoch: 8, Steps: 10 | Train Loss: 0.253 Vali Loss: 4.413 Vali Acc: 0.098 Test Loss: 4.413 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.049536943435669
Epoch: 9, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.768 Vali Acc: 0.121 Test Loss: 4.768 Test Acc: 0.121
Validation loss decreased (-0.107022 --> -0.121129).  Saving model ...
Epoch: 10 cost time: 4.0156941413879395
Epoch: 10, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.931 Vali Acc: 0.120 Test Loss: 4.931 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.758739709854126
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.035 Vali Acc: 0.115 Test Loss: 5.035 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5750997066497803
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.308 Vali Acc: 0.112 Test Loss: 5.308 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.656649112701416
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.243 Vali Acc: 0.112 Test Loss: 5.243 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.056140184402466
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.220 Vali Acc: 0.121 Test Loss: 5.220 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.376166343688965
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.246 Vali Acc: 0.124 Test Loss: 5.246 Test Acc: 0.124
Validation loss decreased (-0.121129 --> -0.123477).  Saving model ...
Epoch: 16 cost time: 4.242044687271118
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.238 Vali Acc: 0.127 Test Loss: 5.238 Test Acc: 0.127
Validation loss decreased (-0.123477 --> -0.127006).  Saving model ...
Epoch: 17 cost time: 3.8199265003204346
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.252 Vali Acc: 0.126 Test Loss: 5.252 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.9413435459136963
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.273 Vali Acc: 0.126 Test Loss: 5.273 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.8064231872558594
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.289 Vali Acc: 0.128 Test Loss: 5.289 Test Acc: 0.128
Validation loss decreased (-0.127006 --> -0.128182).  Saving model ...
Epoch: 20 cost time: 4.704707145690918
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.319 Vali Acc: 0.129 Test Loss: 5.319 Test Acc: 0.129
Validation loss decreased (-0.128182 --> -0.129359).  Saving model ...
Epoch: 21 cost time: 4.619625568389893
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.338 Vali Acc: 0.128 Test Loss: 5.338 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.54725980758667
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.349 Vali Acc: 0.128 Test Loss: 5.349 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7928028106689453
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.367 Vali Acc: 0.127 Test Loss: 5.367 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.8305840492248535
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.383 Vali Acc: 0.128 Test Loss: 5.383 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.1323301792144775
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.397 Vali Acc: 0.131 Test Loss: 5.397 Test Acc: 0.131
Validation loss decreased (-0.129359 --> -0.130534).  Saving model ...
Epoch: 26 cost time: 4.400249004364014
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.425 Vali Acc: 0.129 Test Loss: 5.425 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.497904062271118
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.455 Vali Acc: 0.128 Test Loss: 5.455 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.482038974761963
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.464 Vali Acc: 0.128 Test Loss: 5.464 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.052632808685303
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.463 Vali Acc: 0.128 Test Loss: 5.463 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.09304666519165
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.473 Vali Acc: 0.127 Test Loss: 5.473 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.493279457092285
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.483 Vali Acc: 0.127 Test Loss: 5.483 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.045450925827026
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.510 Vali Acc: 0.128 Test Loss: 5.510 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.9106006622314453
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.525 Vali Acc: 0.127 Test Loss: 5.525 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.5954151153564453
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.545 Vali Acc: 0.126 Test Loss: 5.545 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.8679039478302
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.561 Vali Acc: 0.126 Test Loss: 5.561 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13058823529411764
model parameter : 6793754
model size : 35.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.928899526596069
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.335 Vali Acc: 0.035 Test Loss: 3.335 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 4.355872631072998
Epoch: 2, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.500 Vali Acc: 0.041 Test Loss: 3.500 Test Acc: 0.041
Validation loss decreased (-0.035261 --> -0.041141).  Saving model ...
Epoch: 3 cost time: 3.9632315635681152
Epoch: 3, Steps: 10 | Train Loss: 2.891 Vali Loss: 3.471 Vali Acc: 0.076 Test Loss: 3.471 Test Acc: 0.076
Validation loss decreased (-0.041141 --> -0.076436).  Saving model ...
Epoch: 4 cost time: 3.912557601928711
Epoch: 4, Steps: 10 | Train Loss: 2.448 Vali Loss: 3.385 Vali Acc: 0.086 Test Loss: 3.385 Test Acc: 0.086
Validation loss decreased (-0.076436 --> -0.085849).  Saving model ...
Epoch: 5 cost time: 3.8320889472961426
Epoch: 5, Steps: 10 | Train Loss: 1.919 Vali Loss: 3.453 Vali Acc: 0.086 Test Loss: 3.453 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7541825771331787
Epoch: 6, Steps: 10 | Train Loss: 1.344 Vali Loss: 3.679 Vali Acc: 0.104 Test Loss: 3.679 Test Acc: 0.104
Validation loss decreased (-0.085849 --> -0.103493).  Saving model ...
Epoch: 7 cost time: 3.962463855743408
Epoch: 7, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.977 Vali Acc: 0.108 Test Loss: 3.977 Test Acc: 0.108
Validation loss decreased (-0.103493 --> -0.108196).  Saving model ...
Epoch: 8 cost time: 3.8936707973480225
Epoch: 8, Steps: 10 | Train Loss: 0.417 Vali Loss: 4.312 Vali Acc: 0.113 Test Loss: 4.312 Test Acc: 0.113
Validation loss decreased (-0.108196 --> -0.112898).  Saving model ...
Epoch: 9 cost time: 4.036263704299927
Epoch: 9, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.772 Vali Acc: 0.133 Test Loss: 4.772 Test Acc: 0.133
Validation loss decreased (-0.112898 --> -0.132893).  Saving model ...
Epoch: 10 cost time: 3.9320340156555176
Epoch: 10, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.809 Vali Acc: 0.139 Test Loss: 4.809 Test Acc: 0.139
Validation loss decreased (-0.132893 --> -0.138775).  Saving model ...
Epoch: 11 cost time: 3.738004207611084
Epoch: 11, Steps: 10 | Train Loss: 0.071 Vali Loss: 5.079 Vali Acc: 0.140 Test Loss: 5.079 Test Acc: 0.140
Validation loss decreased (-0.138775 --> -0.139949).  Saving model ...
Epoch: 12 cost time: 4.24635648727417
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 5.357 Vali Acc: 0.135 Test Loss: 5.357 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.967442750930786
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.482 Vali Acc: 0.131 Test Loss: 5.482 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.018996715545654
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.266 Vali Acc: 0.139 Test Loss: 5.266 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.161494731903076
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.383 Vali Acc: 0.138 Test Loss: 5.383 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.942436695098877
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.414 Vali Acc: 0.129 Test Loss: 5.414 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.005293369293213
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.433 Vali Acc: 0.136 Test Loss: 5.433 Test Acc: 0.136
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.543403148651123
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.473 Vali Acc: 0.138 Test Loss: 5.473 Test Acc: 0.138
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.193936347961426
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.483 Vali Acc: 0.139 Test Loss: 5.483 Test Acc: 0.139
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.54446005821228
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.463 Vali Acc: 0.140 Test Loss: 5.463 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.077940464019775
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.467 Vali Acc: 0.141 Test Loss: 5.467 Test Acc: 0.141
Validation loss decreased (-0.139949 --> -0.141122).  Saving model ...
Epoch: 22 cost time: 3.9867489337921143
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.472 Vali Acc: 0.144 Test Loss: 5.472 Test Acc: 0.144
Validation loss decreased (-0.141122 --> -0.143475).  Saving model ...
Epoch: 23 cost time: 4.117427825927734
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.469 Vali Acc: 0.140 Test Loss: 5.469 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.076273441314697
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.477 Vali Acc: 0.141 Test Loss: 5.477 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.325284719467163
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.481 Vali Acc: 0.142 Test Loss: 5.481 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.2978644371032715
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.499 Vali Acc: 0.145 Test Loss: 5.499 Test Acc: 0.145
Validation loss decreased (-0.143475 --> -0.144651).  Saving model ...
Epoch: 27 cost time: 4.277416706085205
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.512 Vali Acc: 0.146 Test Loss: 5.512 Test Acc: 0.146
Validation loss decreased (-0.144651 --> -0.145827).  Saving model ...
Epoch: 28 cost time: 4.157937288284302
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.521 Vali Acc: 0.145 Test Loss: 5.521 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.224230527877808
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.530 Vali Acc: 0.145 Test Loss: 5.530 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.047650098800659
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.544 Vali Acc: 0.146 Test Loss: 5.544 Test Acc: 0.146
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.10858416557312
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.547 Vali Acc: 0.147 Test Loss: 5.547 Test Acc: 0.147
Validation loss decreased (-0.145827 --> -0.147003).  Saving model ...
Epoch: 32 cost time: 4.099645376205444
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.562 Vali Acc: 0.146 Test Loss: 5.562 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.9775493144989014
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.577 Vali Acc: 0.142 Test Loss: 5.577 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.038647413253784
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.589 Vali Acc: 0.140 Test Loss: 5.589 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.532934188842773
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.601 Vali Acc: 0.139 Test Loss: 5.601 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 4.262437343597412
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.608 Vali Acc: 0.140 Test Loss: 5.608 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 4.3277177810668945
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.618 Vali Acc: 0.140 Test Loss: 5.618 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.204458475112915
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.623 Vali Acc: 0.140 Test Loss: 5.623 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.9917423725128174
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.629 Vali Acc: 0.141 Test Loss: 5.629 Test Acc: 0.141
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.7361292839050293
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.638 Vali Acc: 0.139 Test Loss: 5.638 Test Acc: 0.139
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 4.2420313358306885
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.651 Vali Acc: 0.139 Test Loss: 5.651 Test Acc: 0.139
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14705882352941177
model parameter : 6793754
model size : 35.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.222782135009766
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 3.6002533435821533
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 3.9545416831970215
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 3.8303778171539307
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 5 cost time: 4.1932361125946045
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 6 cost time: 4.396905183792114
Epoch: 6, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 7 cost time: 4.656694412231445
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 8 cost time: 4.270033836364746
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 9 cost time: 4.710283517837524
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 10 cost time: 4.628503799438477
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 11 cost time: 4.372986555099487
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 12 cost time: 3.8885538578033447
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 13 cost time: 3.895801544189453
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 14 cost time: 4.344517230987549
Epoch: 14, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 15 cost time: 4.114478349685669
Epoch: 15, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 16 cost time: 4.229370594024658
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 17 cost time: 4.071308851242065
Epoch: 17, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 18 cost time: 4.221994876861572
Epoch: 18, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 19 cost time: 4.507220506668091
Epoch: 19, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 20 cost time: 4.429769515991211
Epoch: 20, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 21 cost time: 4.392657041549683
Epoch: 21, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 22 cost time: 4.0604188442230225
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 23 cost time: 4.199182748794556
Epoch: 23, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 24 cost time: 4.125741720199585
Epoch: 24, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 25 cost time: 4.236469745635986
Epoch: 25, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 26 cost time: 4.561359643936157
Epoch: 26, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 27 cost time: 4.090770959854126
Epoch: 27, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 28 cost time: 3.977449655532837
Epoch: 28, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 29 cost time: 3.8921725749969482
Epoch: 29, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 30 cost time: 4.045354127883911
Epoch: 30, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 31 cost time: 3.979238271713257
Epoch: 31, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 32 cost time: 4.218740463256836
Epoch: 32, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 33 cost time: 4.322574615478516
Epoch: 33, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 34 cost time: 3.8588080406188965
Epoch: 34, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 35 cost time: 4.446089267730713
Epoch: 35, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.301982879638672
Epoch: 36, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.341885566711426
Epoch: 37, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.273820638656616
Epoch: 38, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.135348081588745
Epoch: 39, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.2580955028533936
Epoch: 40, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.054571628570557
Epoch: 41, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.4548444747924805
Epoch: 42, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.8944284915924072
Epoch: 43, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.7801156044006348
Epoch: 44, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.03764705882352941
model parameter : 6793754
model size : 35.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.111860990524292
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.281 Vali Acc: 0.069 Test Loss: 3.281 Test Acc: 0.069
Validation loss decreased (inf --> -0.069379).  Saving model ...
Epoch: 2 cost time: 4.014517545700073
Epoch: 2, Steps: 10 | Train Loss: 2.734 Vali Loss: 3.318 Vali Acc: 0.159 Test Loss: 3.318 Test Acc: 0.159
Validation loss decreased (-0.069379 --> -0.158790).  Saving model ...
Epoch: 3 cost time: 3.8440959453582764
Epoch: 3, Steps: 10 | Train Loss: 1.683 Vali Loss: 3.179 Vali Acc: 0.224 Test Loss: 3.179 Test Acc: 0.224
Validation loss decreased (-0.158790 --> -0.223498).  Saving model ...
Epoch: 4 cost time: 3.976793050765991
Epoch: 4, Steps: 10 | Train Loss: 0.941 Vali Loss: 3.362 Vali Acc: 0.245 Test Loss: 3.362 Test Acc: 0.245
Validation loss decreased (-0.223498 --> -0.244672).  Saving model ...
Epoch: 5 cost time: 3.805081844329834
Epoch: 5, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.546 Vali Acc: 0.275 Test Loss: 3.546 Test Acc: 0.275
Validation loss decreased (-0.244672 --> -0.275259).  Saving model ...
Epoch: 6 cost time: 3.7032811641693115
Epoch: 6, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.796 Vali Acc: 0.276 Test Loss: 3.796 Test Acc: 0.276
Validation loss decreased (-0.275259 --> -0.276433).  Saving model ...
Epoch: 7 cost time: 4.1573076248168945
Epoch: 7, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.173 Vali Acc: 0.272 Test Loss: 4.173 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9324259757995605
Epoch: 8, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.459 Vali Acc: 0.273 Test Loss: 4.459 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.1093220710754395
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.574 Vali Acc: 0.291 Test Loss: 4.574 Test Acc: 0.291
Validation loss decreased (-0.276433 --> -0.290542).  Saving model ...
Epoch: 10 cost time: 4.036453723907471
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.608 Vali Acc: 0.293 Test Loss: 4.608 Test Acc: 0.293
Validation loss decreased (-0.290542 --> -0.292895).  Saving model ...
Epoch: 11 cost time: 3.6347458362579346
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.550 Vali Acc: 0.294 Test Loss: 4.550 Test Acc: 0.294
Validation loss decreased (-0.292895 --> -0.294072).  Saving model ...
Epoch: 12 cost time: 3.7746100425720215
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.558 Vali Acc: 0.298 Test Loss: 4.558 Test Acc: 0.298
Validation loss decreased (-0.294072 --> -0.297601).  Saving model ...
Epoch: 13 cost time: 3.8588459491729736
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.595 Vali Acc: 0.305 Test Loss: 4.595 Test Acc: 0.305
Validation loss decreased (-0.297601 --> -0.304660).  Saving model ...
Epoch: 14 cost time: 3.765061140060425
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.643 Vali Acc: 0.305 Test Loss: 4.643 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.180461645126343
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.671 Vali Acc: 0.308 Test Loss: 4.671 Test Acc: 0.308
Validation loss decreased (-0.304660 --> -0.308189).  Saving model ...
Epoch: 16 cost time: 4.254783868789673
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.686 Vali Acc: 0.305 Test Loss: 4.686 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.150218486785889
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.695 Vali Acc: 0.305 Test Loss: 4.695 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.267853498458862
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.707 Vali Acc: 0.308 Test Loss: 4.707 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.400304079055786
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.725 Vali Acc: 0.311 Test Loss: 4.725 Test Acc: 0.311
Validation loss decreased (-0.308189 --> -0.310541).  Saving model ...
Epoch: 20 cost time: 4.209962844848633
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.745 Vali Acc: 0.311 Test Loss: 4.745 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.285163164138794
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.761 Vali Acc: 0.312 Test Loss: 4.761 Test Acc: 0.312
Validation loss decreased (-0.310541 --> -0.311717).  Saving model ...
Epoch: 22 cost time: 4.034154415130615
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.779 Vali Acc: 0.312 Test Loss: 4.779 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.222029685974121
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.794 Vali Acc: 0.311 Test Loss: 4.794 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.220422267913818
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.808 Vali Acc: 0.313 Test Loss: 4.808 Test Acc: 0.313
Validation loss decreased (-0.311717 --> -0.312893).  Saving model ...
Epoch: 25 cost time: 4.344812393188477
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.826 Vali Acc: 0.313 Test Loss: 4.826 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.5540337562561035
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.836 Vali Acc: 0.315 Test Loss: 4.836 Test Acc: 0.315
Validation loss decreased (-0.312893 --> -0.315246).  Saving model ...
Epoch: 27 cost time: 4.36826491355896
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.848 Vali Acc: 0.314 Test Loss: 4.848 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.0588812828063965
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.862 Vali Acc: 0.314 Test Loss: 4.862 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.969820976257324
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.882 Vali Acc: 0.313 Test Loss: 4.882 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.468609809875488
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.892 Vali Acc: 0.316 Test Loss: 4.892 Test Acc: 0.316
Validation loss decreased (-0.315246 --> -0.316422).  Saving model ...
Epoch: 31 cost time: 4.0652337074279785
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.901 Vali Acc: 0.319 Test Loss: 4.901 Test Acc: 0.319
Validation loss decreased (-0.316422 --> -0.318775).  Saving model ...
Epoch: 32 cost time: 4.226606369018555
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.909 Vali Acc: 0.320 Test Loss: 4.909 Test Acc: 0.320
Validation loss decreased (-0.318775 --> -0.319951).  Saving model ...
Epoch: 33 cost time: 4.157188653945923
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.921 Vali Acc: 0.319 Test Loss: 4.921 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.008609771728516
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.931 Vali Acc: 0.318 Test Loss: 4.931 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.806957244873047
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.947 Vali Acc: 0.316 Test Loss: 4.947 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.063754320144653
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.964 Vali Acc: 0.319 Test Loss: 4.964 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.177340984344482
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.978 Vali Acc: 0.316 Test Loss: 4.978 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 4.460764408111572
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.991 Vali Acc: 0.318 Test Loss: 4.991 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.956515312194824
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.002 Vali Acc: 0.320 Test Loss: 5.002 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.062588930130005
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.013 Vali Acc: 0.319 Test Loss: 5.013 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.095563650131226
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.026 Vali Acc: 0.319 Test Loss: 5.026 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 4.392715930938721
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.034 Vali Acc: 0.320 Test Loss: 5.034 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32
model parameter : 5220890
model size : 29.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.680093765258789
Epoch: 1, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.289 Vali Acc: 0.072 Test Loss: 3.289 Test Acc: 0.072
Validation loss decreased (inf --> -0.071732).  Saving model ...
Epoch: 2 cost time: 3.8585264682769775
Epoch: 2, Steps: 10 | Train Loss: 2.700 Vali Loss: 3.303 Vali Acc: 0.161 Test Loss: 3.303 Test Acc: 0.161
Validation loss decreased (-0.071732 --> -0.161143).  Saving model ...
Epoch: 3 cost time: 3.560633420944214
Epoch: 3, Steps: 10 | Train Loss: 1.665 Vali Loss: 3.177 Vali Acc: 0.218 Test Loss: 3.177 Test Acc: 0.218
Validation loss decreased (-0.161143 --> -0.217615).  Saving model ...
Epoch: 4 cost time: 3.7307565212249756
Epoch: 4, Steps: 10 | Train Loss: 0.928 Vali Loss: 3.334 Vali Acc: 0.249 Test Loss: 3.334 Test Acc: 0.249
Validation loss decreased (-0.217615 --> -0.249378).  Saving model ...
Epoch: 5 cost time: 4.059041261672974
Epoch: 5, Steps: 10 | Train Loss: 0.399 Vali Loss: 3.583 Vali Acc: 0.272 Test Loss: 3.583 Test Acc: 0.272
Validation loss decreased (-0.249378 --> -0.271729).  Saving model ...
Epoch: 6 cost time: 4.168022155761719
Epoch: 6, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.883 Vali Acc: 0.284 Test Loss: 3.883 Test Acc: 0.284
Validation loss decreased (-0.271729 --> -0.283491).  Saving model ...
Epoch: 7 cost time: 4.160199403762817
Epoch: 7, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.146 Vali Acc: 0.311 Test Loss: 4.146 Test Acc: 0.311
Validation loss decreased (-0.283491 --> -0.310547).  Saving model ...
Epoch: 8 cost time: 3.5933241844177246
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.579 Vali Acc: 0.281 Test Loss: 4.579 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.807115316390991
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.632 Vali Acc: 0.296 Test Loss: 4.632 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.959357261657715
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.586 Vali Acc: 0.308 Test Loss: 4.586 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.034418344497681
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.667 Vali Acc: 0.309 Test Loss: 4.667 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9303057193756104
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.712 Vali Acc: 0.305 Test Loss: 4.712 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.6983656883239746
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.801 Vali Acc: 0.311 Test Loss: 4.801 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.662062644958496
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.800 Vali Acc: 0.318 Test Loss: 4.800 Test Acc: 0.318
Validation loss decreased (-0.310547 --> -0.317599).  Saving model ...
Epoch: 15 cost time: 3.3254106044769287
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.783 Vali Acc: 0.320 Test Loss: 4.783 Test Acc: 0.320
Validation loss decreased (-0.317599 --> -0.319952).  Saving model ...
Epoch: 16 cost time: 3.6244468688964844
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.776 Vali Acc: 0.325 Test Loss: 4.776 Test Acc: 0.325
Validation loss decreased (-0.319952 --> -0.324658).  Saving model ...
Epoch: 17 cost time: 3.873389959335327
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.775 Vali Acc: 0.324 Test Loss: 4.775 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8616647720336914
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.792 Vali Acc: 0.325 Test Loss: 4.792 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.7119603157043457
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.816 Vali Acc: 0.321 Test Loss: 4.816 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.62634539604187
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.835 Vali Acc: 0.320 Test Loss: 4.835 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.5805065631866455
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.848 Vali Acc: 0.320 Test Loss: 4.848 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.641867637634277
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.866 Vali Acc: 0.321 Test Loss: 4.866 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.284191131591797
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.879 Vali Acc: 0.321 Test Loss: 4.879 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.704122304916382
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.899 Vali Acc: 0.325 Test Loss: 4.899 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.800082206726074
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.915 Vali Acc: 0.324 Test Loss: 4.915 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.7176718711853027
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.922 Vali Acc: 0.324 Test Loss: 4.922 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 5220890
model size : 29.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.120362043380737
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.261 Vali Acc: 0.084 Test Loss: 3.261 Test Acc: 0.084
Validation loss decreased (inf --> -0.083497).  Saving model ...
Epoch: 2 cost time: 4.185134410858154
Epoch: 2, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.325 Vali Acc: 0.165 Test Loss: 3.325 Test Acc: 0.165
Validation loss decreased (-0.083497 --> -0.164673).  Saving model ...
Epoch: 3 cost time: 4.09291934967041
Epoch: 3, Steps: 10 | Train Loss: 1.718 Vali Loss: 3.261 Vali Acc: 0.212 Test Loss: 3.261 Test Acc: 0.212
Validation loss decreased (-0.164673 --> -0.211732).  Saving model ...
Epoch: 4 cost time: 3.9407453536987305
Epoch: 4, Steps: 10 | Train Loss: 1.054 Vali Loss: 3.429 Vali Acc: 0.246 Test Loss: 3.429 Test Acc: 0.246
Validation loss decreased (-0.211732 --> -0.245848).  Saving model ...
Epoch: 5 cost time: 3.6289610862731934
Epoch: 5, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.558 Vali Acc: 0.285 Test Loss: 3.558 Test Acc: 0.285
Validation loss decreased (-0.245848 --> -0.284670).  Saving model ...
Epoch: 6 cost time: 4.452160835266113
Epoch: 6, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.844 Vali Acc: 0.261 Test Loss: 3.844 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.376214981079102
Epoch: 7, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.107 Vali Acc: 0.295 Test Loss: 4.107 Test Acc: 0.295
Validation loss decreased (-0.284670 --> -0.295253).  Saving model ...
Epoch: 8 cost time: 4.212468385696411
Epoch: 8, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.380 Vali Acc: 0.287 Test Loss: 4.380 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.080765724182129
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.568 Vali Acc: 0.289 Test Loss: 4.568 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.955345630645752
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.544 Vali Acc: 0.304 Test Loss: 4.544 Test Acc: 0.304
Validation loss decreased (-0.295253 --> -0.303484).  Saving model ...
Epoch: 11 cost time: 3.8659608364105225
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.608 Vali Acc: 0.305 Test Loss: 4.608 Test Acc: 0.305
Validation loss decreased (-0.303484 --> -0.304660).  Saving model ...
Epoch: 12 cost time: 3.85662579536438
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.746 Vali Acc: 0.299 Test Loss: 4.746 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4568819999694824
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.848 Vali Acc: 0.314 Test Loss: 4.848 Test Acc: 0.314
Validation loss decreased (-0.304660 --> -0.314069).  Saving model ...
Epoch: 14 cost time: 3.740993022918701
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.821 Vali Acc: 0.313 Test Loss: 4.821 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9216716289520264
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.803 Vali Acc: 0.318 Test Loss: 4.803 Test Acc: 0.318
Validation loss decreased (-0.314069 --> -0.317599).  Saving model ...
Epoch: 16 cost time: 3.855412721633911
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.811 Vali Acc: 0.319 Test Loss: 4.811 Test Acc: 0.319
Validation loss decreased (-0.317599 --> -0.318775).  Saving model ...
Epoch: 17 cost time: 3.5989890098571777
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.820 Vali Acc: 0.320 Test Loss: 4.820 Test Acc: 0.320
Validation loss decreased (-0.318775 --> -0.319952).  Saving model ...
Epoch: 18 cost time: 3.306570053100586
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.839 Vali Acc: 0.320 Test Loss: 4.839 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.333428382873535
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.864 Vali Acc: 0.320 Test Loss: 4.864 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.693833112716675
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.888 Vali Acc: 0.322 Test Loss: 4.888 Test Acc: 0.322
Validation loss decreased (-0.319952 --> -0.322304).  Saving model ...
Epoch: 21 cost time: 3.7494702339172363
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.909 Vali Acc: 0.320 Test Loss: 4.909 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7951672077178955
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.925 Vali Acc: 0.321 Test Loss: 4.925 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.013666868209839
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.946 Vali Acc: 0.320 Test Loss: 4.946 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.896317481994629
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.968 Vali Acc: 0.320 Test Loss: 4.968 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.6933226585388184
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.984 Vali Acc: 0.320 Test Loss: 4.984 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.115663528442383
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.999 Vali Acc: 0.321 Test Loss: 4.999 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.086336374282837
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.014 Vali Acc: 0.321 Test Loss: 5.014 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.8579928874969482
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.029 Vali Acc: 0.324 Test Loss: 5.029 Test Acc: 0.324
Validation loss decreased (-0.322304 --> -0.323479).  Saving model ...
Epoch: 29 cost time: 3.9645376205444336
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.051 Vali Acc: 0.322 Test Loss: 5.051 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.8668899536132812
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.066 Vali Acc: 0.321 Test Loss: 5.066 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.7226955890655518
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.080 Vali Acc: 0.321 Test Loss: 5.080 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.096672296524048
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.092 Vali Acc: 0.320 Test Loss: 5.092 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.678093194961548
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.109 Vali Acc: 0.319 Test Loss: 5.109 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.740203619003296
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.121 Vali Acc: 0.322 Test Loss: 5.121 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.7072911262512207
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.134 Vali Acc: 0.322 Test Loss: 5.134 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.8048036098480225
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.152 Vali Acc: 0.321 Test Loss: 5.152 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.4549715518951416
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.168 Vali Acc: 0.324 Test Loss: 5.168 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.6965084075927734
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.183 Vali Acc: 0.324 Test Loss: 5.183 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 5220890
model size : 29.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.273656368255615
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.274 Vali Acc: 0.078 Test Loss: 3.274 Test Acc: 0.078
Validation loss decreased (inf --> -0.077614).  Saving model ...
Epoch: 2 cost time: 3.6570334434509277
Epoch: 2, Steps: 10 | Train Loss: 2.702 Vali Loss: 3.399 Vali Acc: 0.155 Test Loss: 3.399 Test Acc: 0.155
Validation loss decreased (-0.077614 --> -0.155260).  Saving model ...
Epoch: 3 cost time: 3.8831064701080322
Epoch: 3, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.412 Vali Acc: 0.176 Test Loss: 3.412 Test Acc: 0.176
Validation loss decreased (-0.155260 --> -0.176436).  Saving model ...
Epoch: 4 cost time: 4.174165725708008
Epoch: 4, Steps: 10 | Train Loss: 1.124 Vali Loss: 3.657 Vali Acc: 0.196 Test Loss: 3.657 Test Acc: 0.196
Validation loss decreased (-0.176436 --> -0.196434).  Saving model ...
Epoch: 5 cost time: 3.9630181789398193
Epoch: 5, Steps: 10 | Train Loss: 0.597 Vali Loss: 3.874 Vali Acc: 0.214 Test Loss: 3.874 Test Acc: 0.214
Validation loss decreased (-0.196434 --> -0.214079).  Saving model ...
Epoch: 6 cost time: 4.480245351791382
Epoch: 6, Steps: 10 | Train Loss: 0.294 Vali Loss: 4.138 Vali Acc: 0.233 Test Loss: 4.138 Test Acc: 0.233
Validation loss decreased (-0.214079 --> -0.232900).  Saving model ...
Epoch: 7 cost time: 3.7169911861419678
Epoch: 7, Steps: 10 | Train Loss: 0.157 Vali Loss: 4.459 Vali Acc: 0.232 Test Loss: 4.459 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.940786838531494
Epoch: 8, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.658 Vali Acc: 0.259 Test Loss: 4.658 Test Acc: 0.259
Validation loss decreased (-0.232900 --> -0.258777).  Saving model ...
Epoch: 9 cost time: 3.7315640449523926
Epoch: 9, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.918 Vali Acc: 0.259 Test Loss: 4.918 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8240363597869873
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 5.032 Vali Acc: 0.248 Test Loss: 5.032 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8011741638183594
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.108 Vali Acc: 0.268 Test Loss: 5.108 Test Acc: 0.268
Validation loss decreased (-0.258777 --> -0.268184).  Saving model ...
Epoch: 12 cost time: 3.567028284072876
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 5.291 Vali Acc: 0.262 Test Loss: 5.291 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.170529842376709
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.455 Vali Acc: 0.268 Test Loss: 5.455 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6405982971191406
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.362 Vali Acc: 0.266 Test Loss: 5.362 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.7108469009399414
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.314 Vali Acc: 0.264 Test Loss: 5.314 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.972437620162964
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.350 Vali Acc: 0.259 Test Loss: 5.350 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.00346302986145
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.369 Vali Acc: 0.259 Test Loss: 5.369 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.801727056503296
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.396 Vali Acc: 0.267 Test Loss: 5.396 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.677233934402466
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.430 Vali Acc: 0.269 Test Loss: 5.430 Test Acc: 0.269
Validation loss decreased (-0.268184 --> -0.269357).  Saving model ...
Epoch: 20 cost time: 3.5371522903442383
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.461 Vali Acc: 0.268 Test Loss: 5.461 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.984711170196533
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.485 Vali Acc: 0.267 Test Loss: 5.485 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.7077579498291016
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.507 Vali Acc: 0.267 Test Loss: 5.507 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.9335176944732666
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.523 Vali Acc: 0.265 Test Loss: 5.523 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.7106165885925293
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.541 Vali Acc: 0.269 Test Loss: 5.541 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.066165447235107
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.568 Vali Acc: 0.269 Test Loss: 5.568 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.431490659713745
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.583 Vali Acc: 0.268 Test Loss: 5.583 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.413187026977539
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.597 Vali Acc: 0.269 Test Loss: 5.597 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.263327121734619
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.611 Vali Acc: 0.271 Test Loss: 5.611 Test Acc: 0.271
Validation loss decreased (-0.269357 --> -0.270532).  Saving model ...
Epoch: 29 cost time: 4.187364816665649
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.630 Vali Acc: 0.272 Test Loss: 5.630 Test Acc: 0.272
Validation loss decreased (-0.270532 --> -0.271708).  Saving model ...
Epoch: 30 cost time: 3.817631483078003
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.641 Vali Acc: 0.272 Test Loss: 5.641 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.962078809738159
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.654 Vali Acc: 0.272 Test Loss: 5.654 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.036453485488892
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.671 Vali Acc: 0.273 Test Loss: 5.671 Test Acc: 0.273
Validation loss decreased (-0.271708 --> -0.272884).  Saving model ...
Epoch: 33 cost time: 4.350474119186401
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.688 Vali Acc: 0.273 Test Loss: 5.688 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.455499172210693
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.700 Vali Acc: 0.272 Test Loss: 5.700 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.9062490463256836
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.716 Vali Acc: 0.273 Test Loss: 5.716 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.8977952003479004
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.733 Vali Acc: 0.273 Test Loss: 5.733 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.038124084472656
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.750 Vali Acc: 0.274 Test Loss: 5.750 Test Acc: 0.274
Validation loss decreased (-0.272884 --> -0.274060).  Saving model ...
Epoch: 38 cost time: 4.114290952682495
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.762 Vali Acc: 0.272 Test Loss: 5.762 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.862915515899658
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.772 Vali Acc: 0.274 Test Loss: 5.772 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.851684331893921
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.784 Vali Acc: 0.275 Test Loss: 5.784 Test Acc: 0.275
Validation loss decreased (-0.274060 --> -0.275236).  Saving model ...
Epoch: 41 cost time: 3.5069468021392822
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.797 Vali Acc: 0.274 Test Loss: 5.797 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.9383978843688965
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.810 Vali Acc: 0.274 Test Loss: 5.810 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.7474071979522705
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.830 Vali Acc: 0.275 Test Loss: 5.830 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.931931734085083
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.843 Vali Acc: 0.274 Test Loss: 5.843 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.7444064617156982
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.857 Vali Acc: 0.275 Test Loss: 5.857 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 4.005712032318115
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.870 Vali Acc: 0.275 Test Loss: 5.870 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.785269260406494
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.881 Vali Acc: 0.275 Test Loss: 5.881 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 4.109800577163696
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.893 Vali Acc: 0.274 Test Loss: 5.893 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 4.192878723144531
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.908 Vali Acc: 0.275 Test Loss: 5.908 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 4.270031452178955
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.920 Vali Acc: 0.275 Test Loss: 5.920 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 5220890
model size : 29.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.140204191207886
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.327 Vali Acc: 0.040 Test Loss: 3.327 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 4.260704040527344
Epoch: 2, Steps: 10 | Train Loss: 2.863 Vali Loss: 3.453 Vali Acc: 0.075 Test Loss: 3.453 Test Acc: 0.075
Validation loss decreased (-0.039967 --> -0.075260).  Saving model ...
Epoch: 3 cost time: 3.9998772144317627
Epoch: 3, Steps: 10 | Train Loss: 1.957 Vali Loss: 3.443 Vali Acc: 0.099 Test Loss: 3.443 Test Acc: 0.099
Validation loss decreased (-0.075260 --> -0.098789).  Saving model ...
Epoch: 4 cost time: 3.88285756111145
Epoch: 4, Steps: 10 | Train Loss: 1.141 Vali Loss: 3.664 Vali Acc: 0.114 Test Loss: 3.664 Test Acc: 0.114
Validation loss decreased (-0.098789 --> -0.114081).  Saving model ...
Epoch: 5 cost time: 3.656116008758545
Epoch: 5, Steps: 10 | Train Loss: 0.570 Vali Loss: 4.002 Vali Acc: 0.127 Test Loss: 4.002 Test Acc: 0.127
Validation loss decreased (-0.114081 --> -0.127019).  Saving model ...
Epoch: 6 cost time: 3.4312663078308105
Epoch: 6, Steps: 10 | Train Loss: 0.251 Vali Loss: 4.461 Vali Acc: 0.135 Test Loss: 4.461 Test Acc: 0.135
Validation loss decreased (-0.127019 --> -0.135250).  Saving model ...
Epoch: 7 cost time: 3.7341692447662354
Epoch: 7, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.804 Vali Acc: 0.125 Test Loss: 4.804 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9750120639801025
Epoch: 8, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.221 Vali Acc: 0.142 Test Loss: 5.221 Test Acc: 0.142
Validation loss decreased (-0.135250 --> -0.142301).  Saving model ...
Epoch: 9 cost time: 3.8857946395874023
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.328 Vali Acc: 0.149 Test Loss: 5.328 Test Acc: 0.149
Validation loss decreased (-0.142301 --> -0.149358).  Saving model ...
Epoch: 10 cost time: 3.7670586109161377
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.401 Vali Acc: 0.146 Test Loss: 5.401 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.792285203933716
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.418 Vali Acc: 0.153 Test Loss: 5.418 Test Acc: 0.153
Validation loss decreased (-0.149358 --> -0.152887).  Saving model ...
Epoch: 12 cost time: 4.2278361320495605
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.445 Vali Acc: 0.160 Test Loss: 5.445 Test Acc: 0.160
Validation loss decreased (-0.152887 --> -0.159946).  Saving model ...
Epoch: 13 cost time: 4.228135347366333
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.482 Vali Acc: 0.160 Test Loss: 5.482 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.9619109630584717
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.537 Vali Acc: 0.159 Test Loss: 5.537 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7740042209625244
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.580 Vali Acc: 0.158 Test Loss: 5.580 Test Acc: 0.158
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.470005989074707
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.616 Vali Acc: 0.155 Test Loss: 5.616 Test Acc: 0.155
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.5975213050842285
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.637 Vali Acc: 0.154 Test Loss: 5.637 Test Acc: 0.154
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.6373753547668457
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.667 Vali Acc: 0.156 Test Loss: 5.667 Test Acc: 0.156
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.869990348815918
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.699 Vali Acc: 0.158 Test Loss: 5.699 Test Acc: 0.158
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.389341354370117
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.726 Vali Acc: 0.161 Test Loss: 5.726 Test Acc: 0.161
Validation loss decreased (-0.159946 --> -0.161119).  Saving model ...
Epoch: 21 cost time: 3.9331722259521484
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.748 Vali Acc: 0.160 Test Loss: 5.748 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.096702575683594
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.779 Vali Acc: 0.160 Test Loss: 5.779 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.324524641036987
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.810 Vali Acc: 0.162 Test Loss: 5.810 Test Acc: 0.162
Validation loss decreased (-0.161119 --> -0.162295).  Saving model ...
Epoch: 24 cost time: 3.660400390625
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.840 Vali Acc: 0.161 Test Loss: 5.840 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.8146684169769287
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.868 Vali Acc: 0.161 Test Loss: 5.868 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.075860261917114
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.884 Vali Acc: 0.161 Test Loss: 5.884 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.9480433464050293
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.899 Vali Acc: 0.159 Test Loss: 5.899 Test Acc: 0.159
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.9576830863952637
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.919 Vali Acc: 0.162 Test Loss: 5.919 Test Acc: 0.162
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.7292797565460205
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.945 Vali Acc: 0.164 Test Loss: 5.945 Test Acc: 0.164
Validation loss decreased (-0.162295 --> -0.163470).  Saving model ...
Epoch: 30 cost time: 3.871392011642456
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.954 Vali Acc: 0.161 Test Loss: 5.954 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.634371280670166
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.969 Vali Acc: 0.161 Test Loss: 5.969 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.665552854537964
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.984 Vali Acc: 0.165 Test Loss: 5.984 Test Acc: 0.165
Validation loss decreased (-0.163470 --> -0.164646).  Saving model ...
Epoch: 33 cost time: 3.95578670501709
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.003 Vali Acc: 0.167 Test Loss: 6.003 Test Acc: 0.167
Validation loss decreased (-0.164646 --> -0.166999).  Saving model ...
Epoch: 34 cost time: 4.096138000488281
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.021 Vali Acc: 0.167 Test Loss: 6.021 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.894242525100708
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.041 Vali Acc: 0.165 Test Loss: 6.041 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.609478712081909
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.064 Vali Acc: 0.165 Test Loss: 6.064 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.114537239074707
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.086 Vali Acc: 0.164 Test Loss: 6.086 Test Acc: 0.164
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.244654417037964
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.102 Vali Acc: 0.164 Test Loss: 6.102 Test Acc: 0.164
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 4.166624069213867
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.114 Vali Acc: 0.164 Test Loss: 6.114 Test Acc: 0.164
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.9097635746002197
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.128 Vali Acc: 0.165 Test Loss: 6.128 Test Acc: 0.165
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.7565698623657227
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.146 Vali Acc: 0.165 Test Loss: 6.146 Test Acc: 0.165
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.9192137718200684
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.159 Vali Acc: 0.165 Test Loss: 6.159 Test Acc: 0.165
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.9316532611846924
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.177 Vali Acc: 0.167 Test Loss: 6.177 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16705882352941176
model parameter : 5220890
model size : 29.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.928973436355591
Epoch: 1, Steps: 10 | Train Loss: 3.334 Vali Loss: 3.327 Vali Acc: 0.049 Test Loss: 3.327 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 3.425288438796997
Epoch: 2, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.484 Vali Acc: 0.056 Test Loss: 3.484 Test Acc: 0.056
Validation loss decreased (-0.049378 --> -0.056436).  Saving model ...
Epoch: 3 cost time: 3.62900447845459
Epoch: 3, Steps: 10 | Train Loss: 2.334 Vali Loss: 3.426 Vali Acc: 0.069 Test Loss: 3.426 Test Acc: 0.069
Validation loss decreased (-0.056436 --> -0.069378).  Saving model ...
Epoch: 4 cost time: 3.8264079093933105
Epoch: 4, Steps: 10 | Train Loss: 1.539 Vali Loss: 3.511 Vali Acc: 0.084 Test Loss: 3.511 Test Acc: 0.084
Validation loss decreased (-0.069378 --> -0.083494).  Saving model ...
Epoch: 5 cost time: 4.047317743301392
Epoch: 5, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.718 Vali Acc: 0.086 Test Loss: 3.718 Test Acc: 0.086
Validation loss decreased (-0.083494 --> -0.085845).  Saving model ...
Epoch: 6 cost time: 3.9979004859924316
Epoch: 6, Steps: 10 | Train Loss: 0.469 Vali Loss: 4.047 Vali Acc: 0.094 Test Loss: 4.047 Test Acc: 0.094
Validation loss decreased (-0.085845 --> -0.094077).  Saving model ...
Epoch: 7 cost time: 3.6246094703674316
Epoch: 7, Steps: 10 | Train Loss: 0.184 Vali Loss: 4.390 Vali Acc: 0.105 Test Loss: 4.390 Test Acc: 0.105
Validation loss decreased (-0.094077 --> -0.104662).  Saving model ...
Epoch: 8 cost time: 3.7209270000457764
Epoch: 8, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.871 Vali Acc: 0.111 Test Loss: 4.871 Test Acc: 0.111
Validation loss decreased (-0.104662 --> -0.110540).  Saving model ...
Epoch: 9 cost time: 3.8966007232666016
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.057 Vali Acc: 0.116 Test Loss: 5.057 Test Acc: 0.116
Validation loss decreased (-0.110540 --> -0.116420).  Saving model ...
Epoch: 10 cost time: 3.6493027210235596
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.222 Vali Acc: 0.113 Test Loss: 5.222 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7590010166168213
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.290 Vali Acc: 0.119 Test Loss: 5.290 Test Acc: 0.119
Validation loss decreased (-0.116420 --> -0.118771).  Saving model ...
Epoch: 12 cost time: 3.5763540267944336
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.341 Vali Acc: 0.120 Test Loss: 5.341 Test Acc: 0.120
Validation loss decreased (-0.118771 --> -0.119947).  Saving model ...
Epoch: 13 cost time: 3.587613821029663
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.378 Vali Acc: 0.118 Test Loss: 5.378 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.42661714553833
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.413 Vali Acc: 0.119 Test Loss: 5.413 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.785154104232788
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.432 Vali Acc: 0.118 Test Loss: 5.432 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.840256452560425
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.457 Vali Acc: 0.119 Test Loss: 5.457 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7481775283813477
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.471 Vali Acc: 0.119 Test Loss: 5.471 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.220259428024292
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.490 Vali Acc: 0.120 Test Loss: 5.490 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.424971580505371
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.521 Vali Acc: 0.120 Test Loss: 5.521 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.7138824462890625
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.543 Vali Acc: 0.122 Test Loss: 5.543 Test Acc: 0.122
Validation loss decreased (-0.119947 --> -0.122298).  Saving model ...
Epoch: 21 cost time: 3.9417412281036377
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.567 Vali Acc: 0.122 Test Loss: 5.567 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.079602479934692
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.586 Vali Acc: 0.122 Test Loss: 5.586 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.9725852012634277
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.612 Vali Acc: 0.125 Test Loss: 5.612 Test Acc: 0.125
Validation loss decreased (-0.122298 --> -0.124650).  Saving model ...
Epoch: 24 cost time: 3.767503261566162
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.637 Vali Acc: 0.126 Test Loss: 5.637 Test Acc: 0.126
Validation loss decreased (-0.124650 --> -0.125826).  Saving model ...
Epoch: 25 cost time: 3.6938681602478027
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.659 Vali Acc: 0.126 Test Loss: 5.659 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.95889949798584
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.675 Vali Acc: 0.127 Test Loss: 5.675 Test Acc: 0.127
Validation loss decreased (-0.125826 --> -0.127002).  Saving model ...
Epoch: 27 cost time: 4.167431116104126
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.692 Vali Acc: 0.128 Test Loss: 5.692 Test Acc: 0.128
Validation loss decreased (-0.127002 --> -0.128178).  Saving model ...
Epoch: 28 cost time: 4.242461919784546
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.705 Vali Acc: 0.128 Test Loss: 5.705 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.6595985889434814
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.737 Vali Acc: 0.128 Test Loss: 5.737 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.9635095596313477
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.752 Vali Acc: 0.131 Test Loss: 5.752 Test Acc: 0.131
Validation loss decreased (-0.128178 --> -0.130531).  Saving model ...
Epoch: 31 cost time: 3.5221431255340576
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.762 Vali Acc: 0.129 Test Loss: 5.762 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.003124237060547
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.771 Vali Acc: 0.128 Test Loss: 5.771 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.941330909729004
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.784 Vali Acc: 0.128 Test Loss: 5.784 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.9093081951141357
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.791 Vali Acc: 0.131 Test Loss: 5.791 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.460322380065918
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.807 Vali Acc: 0.131 Test Loss: 5.807 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.8870511054992676
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.826 Vali Acc: 0.129 Test Loss: 5.826 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 4.4401092529296875
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.842 Vali Acc: 0.129 Test Loss: 5.842 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.9871981143951416
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.855 Vali Acc: 0.131 Test Loss: 5.855 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 4.447016477584839
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.869 Vali Acc: 0.132 Test Loss: 5.869 Test Acc: 0.132
Validation loss decreased (-0.130531 --> -0.131706).  Saving model ...
Epoch: 40 cost time: 3.858595371246338
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.879 Vali Acc: 0.134 Test Loss: 5.879 Test Acc: 0.134
Validation loss decreased (-0.131706 --> -0.134059).  Saving model ...
Epoch: 41 cost time: 3.625767707824707
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.891 Vali Acc: 0.133 Test Loss: 5.891 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.8636229038238525
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.900 Vali Acc: 0.133 Test Loss: 5.900 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.8590402603149414
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.916 Vali Acc: 0.134 Test Loss: 5.916 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.656522274017334
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.928 Vali Acc: 0.134 Test Loss: 5.928 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.7014265060424805
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.940 Vali Acc: 0.135 Test Loss: 5.940 Test Acc: 0.135
Validation loss decreased (-0.134059 --> -0.135235).  Saving model ...
Epoch: 46 cost time: 3.377030372619629
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.954 Vali Acc: 0.135 Test Loss: 5.954 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.4485867023468018
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.968 Vali Acc: 0.135 Test Loss: 5.968 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 4.094583034515381
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.982 Vali Acc: 0.134 Test Loss: 5.982 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 4.005772352218628
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.995 Vali Acc: 0.136 Test Loss: 5.995 Test Acc: 0.136
Validation loss decreased (-0.135235 --> -0.136411).  Saving model ...
Epoch: 50 cost time: 3.4751224517822266
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.007 Vali Acc: 0.136 Test Loss: 6.007 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.6867687702178955
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.020 Vali Acc: 0.134 Test Loss: 6.020 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.860837936401367
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.032 Vali Acc: 0.133 Test Loss: 6.032 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 4.015553951263428
Epoch: 53, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.042 Vali Acc: 0.132 Test Loss: 6.042 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 4.099806785583496
Epoch: 54, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.056 Vali Acc: 0.134 Test Loss: 6.056 Test Acc: 0.134
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.71593976020813
Epoch: 55, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.065 Vali Acc: 0.139 Test Loss: 6.065 Test Acc: 0.139
Validation loss decreased (-0.136411 --> -0.138763).  Saving model ...
Epoch: 56 cost time: 3.7778971195220947
Epoch: 56, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.070 Vali Acc: 0.138 Test Loss: 6.070 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 4.103480339050293
Epoch: 57, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.078 Vali Acc: 0.136 Test Loss: 6.078 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 4.02820086479187
Epoch: 58, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.091 Vali Acc: 0.138 Test Loss: 6.091 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 4.337649822235107
Epoch: 59, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.103 Vali Acc: 0.135 Test Loss: 6.103 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 3.537198305130005
Epoch: 60, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.116 Vali Acc: 0.135 Test Loss: 6.116 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 3.638339042663574
Epoch: 61, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.123 Vali Acc: 0.136 Test Loss: 6.123 Test Acc: 0.136
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 3.671574354171753
Epoch: 62, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.129 Vali Acc: 0.136 Test Loss: 6.129 Test Acc: 0.136
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 3.963625431060791
Epoch: 63, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.138 Vali Acc: 0.135 Test Loss: 6.138 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 4.229731798171997
Epoch: 64, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.145 Vali Acc: 0.138 Test Loss: 6.145 Test Acc: 0.138
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 4.36970067024231
Epoch: 65, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.156 Vali Acc: 0.136 Test Loss: 6.156 Test Acc: 0.136
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1388235294117647
model parameter : 5220890
model size : 29.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.688445806503296
Epoch: 1, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.327 Vali Acc: 0.047 Test Loss: 3.327 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 3.626758337020874
Epoch: 2, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.480 Vali Acc: 0.064 Test Loss: 3.480 Test Acc: 0.064
Validation loss decreased (-0.047026 --> -0.063495).  Saving model ...
Epoch: 3 cost time: 3.583329677581787
Epoch: 3, Steps: 10 | Train Loss: 2.609 Vali Loss: 3.408 Vali Acc: 0.086 Test Loss: 3.408 Test Acc: 0.086
Validation loss decreased (-0.063495 --> -0.085848).  Saving model ...
Epoch: 4 cost time: 3.50643253326416
Epoch: 4, Steps: 10 | Train Loss: 1.998 Vali Loss: 3.413 Vali Acc: 0.089 Test Loss: 3.413 Test Acc: 0.089
Validation loss decreased (-0.085848 --> -0.089378).  Saving model ...
Epoch: 5 cost time: 3.6264073848724365
Epoch: 5, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.533 Vali Acc: 0.104 Test Loss: 3.533 Test Acc: 0.104
Validation loss decreased (-0.089378 --> -0.103494).  Saving model ...
Epoch: 6 cost time: 3.4633255004882812
Epoch: 6, Steps: 10 | Train Loss: 0.869 Vali Loss: 3.918 Vali Acc: 0.100 Test Loss: 3.918 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.523148775100708
Epoch: 7, Steps: 10 | Train Loss: 0.423 Vali Loss: 4.349 Vali Acc: 0.096 Test Loss: 4.349 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4785780906677246
Epoch: 8, Steps: 10 | Train Loss: 0.153 Vali Loss: 4.702 Vali Acc: 0.107 Test Loss: 4.702 Test Acc: 0.107
Validation loss decreased (-0.103494 --> -0.107012).  Saving model ...
Epoch: 9 cost time: 3.4842491149902344
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 5.050 Vali Acc: 0.113 Test Loss: 5.050 Test Acc: 0.113
Validation loss decreased (-0.107012 --> -0.112891).  Saving model ...
Epoch: 10 cost time: 3.5714266300201416
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 5.358 Vali Acc: 0.120 Test Loss: 5.358 Test Acc: 0.120
Validation loss decreased (-0.112891 --> -0.119946).  Saving model ...
Epoch: 11 cost time: 3.6564927101135254
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.453 Vali Acc: 0.118 Test Loss: 5.453 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8142752647399902
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.521 Vali Acc: 0.124 Test Loss: 5.521 Test Acc: 0.124
Validation loss decreased (-0.119946 --> -0.123474).  Saving model ...
Epoch: 13 cost time: 3.44415020942688
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.543 Vali Acc: 0.125 Test Loss: 5.543 Test Acc: 0.125
Validation loss decreased (-0.123474 --> -0.124650).  Saving model ...
Epoch: 14 cost time: 3.6595842838287354
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.560 Vali Acc: 0.129 Test Loss: 5.560 Test Acc: 0.129
Validation loss decreased (-0.124650 --> -0.129356).  Saving model ...
Epoch: 15 cost time: 3.700083017349243
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.596 Vali Acc: 0.128 Test Loss: 5.596 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7306623458862305
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.629 Vali Acc: 0.133 Test Loss: 5.629 Test Acc: 0.133
Validation loss decreased (-0.129356 --> -0.132885).  Saving model ...
Epoch: 17 cost time: 3.9036407470703125
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.651 Vali Acc: 0.132 Test Loss: 5.651 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.171590328216553
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.677 Vali Acc: 0.134 Test Loss: 5.677 Test Acc: 0.134
Validation loss decreased (-0.132885 --> -0.134061).  Saving model ...
Epoch: 19 cost time: 3.623033046722412
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.696 Vali Acc: 0.132 Test Loss: 5.696 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6261227130889893
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.734 Vali Acc: 0.131 Test Loss: 5.734 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.8397209644317627
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.764 Vali Acc: 0.134 Test Loss: 5.764 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.8698172569274902
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.779 Vali Acc: 0.133 Test Loss: 5.779 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.7889277935028076
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.787 Vali Acc: 0.131 Test Loss: 5.787 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.549945592880249
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.813 Vali Acc: 0.133 Test Loss: 5.813 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.415687084197998
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.826 Vali Acc: 0.133 Test Loss: 5.826 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.7372541427612305
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.832 Vali Acc: 0.133 Test Loss: 5.832 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.0934038162231445
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.843 Vali Acc: 0.132 Test Loss: 5.843 Test Acc: 0.132
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.296268463134766
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.845 Vali Acc: 0.134 Test Loss: 5.845 Test Acc: 0.134
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13411764705882354
model parameter : 5220890
model size : 29.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.143783330917358
Epoch: 1, Steps: 10 | Train Loss: 3.359 Vali Loss: 3.341 Vali Acc: 0.062 Test Loss: 3.341 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 3.6864726543426514
Epoch: 2, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.522 Vali Acc: 0.072 Test Loss: 3.522 Test Acc: 0.072
Validation loss decreased (-0.062320 --> -0.071729).  Saving model ...
Epoch: 3 cost time: 3.888112783432007
Epoch: 3, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.458 Vali Acc: 0.075 Test Loss: 3.458 Test Acc: 0.075
Validation loss decreased (-0.071729 --> -0.075260).  Saving model ...
Epoch: 4 cost time: 3.79004168510437
Epoch: 4, Steps: 10 | Train Loss: 2.251 Vali Loss: 3.418 Vali Acc: 0.089 Test Loss: 3.418 Test Acc: 0.089
Validation loss decreased (-0.075260 --> -0.089378).  Saving model ...
Epoch: 5 cost time: 3.675891160964966
Epoch: 5, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.469 Vali Acc: 0.099 Test Loss: 3.469 Test Acc: 0.099
Validation loss decreased (-0.089378 --> -0.098789).  Saving model ...
Epoch: 6 cost time: 3.2791073322296143
Epoch: 6, Steps: 10 | Train Loss: 1.228 Vali Loss: 3.755 Vali Acc: 0.091 Test Loss: 3.755 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4076919555664062
Epoch: 7, Steps: 10 | Train Loss: 0.712 Vali Loss: 4.054 Vali Acc: 0.098 Test Loss: 4.054 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5407915115356445
Epoch: 8, Steps: 10 | Train Loss: 0.296 Vali Loss: 4.475 Vali Acc: 0.107 Test Loss: 4.475 Test Acc: 0.107
Validation loss decreased (-0.098789 --> -0.107014).  Saving model ...
Epoch: 9 cost time: 3.789320945739746
Epoch: 9, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.787 Vali Acc: 0.112 Test Loss: 4.787 Test Acc: 0.112
Validation loss decreased (-0.107014 --> -0.111717).  Saving model ...
Epoch: 10 cost time: 3.975642442703247
Epoch: 10, Steps: 10 | Train Loss: 0.052 Vali Loss: 5.078 Vali Acc: 0.104 Test Loss: 5.078 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.669133186340332
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.245 Vali Acc: 0.115 Test Loss: 5.245 Test Acc: 0.115
Validation loss decreased (-0.111717 --> -0.115242).  Saving model ...
Epoch: 12 cost time: 4.161127805709839
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.389 Vali Acc: 0.120 Test Loss: 5.389 Test Acc: 0.120
Validation loss decreased (-0.115242 --> -0.119946).  Saving model ...
Epoch: 13 cost time: 3.6013858318328857
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.392 Vali Acc: 0.121 Test Loss: 5.392 Test Acc: 0.121
Validation loss decreased (-0.119946 --> -0.121123).  Saving model ...
Epoch: 14 cost time: 3.629084825515747
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.412 Vali Acc: 0.124 Test Loss: 5.412 Test Acc: 0.124
Validation loss decreased (-0.121123 --> -0.123475).  Saving model ...
Epoch: 15 cost time: 3.8733158111572266
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.426 Vali Acc: 0.127 Test Loss: 5.426 Test Acc: 0.127
Validation loss decreased (-0.123475 --> -0.127005).  Saving model ...
Epoch: 16 cost time: 4.007774114608765
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.463 Vali Acc: 0.128 Test Loss: 5.463 Test Acc: 0.128
Validation loss decreased (-0.127005 --> -0.128181).  Saving model ...
Epoch: 17 cost time: 3.7292635440826416
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.484 Vali Acc: 0.131 Test Loss: 5.484 Test Acc: 0.131
Validation loss decreased (-0.128181 --> -0.130533).  Saving model ...
Epoch: 18 cost time: 3.5383498668670654
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.503 Vali Acc: 0.129 Test Loss: 5.503 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.899575710296631
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.517 Vali Acc: 0.127 Test Loss: 5.517 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.051541328430176
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.540 Vali Acc: 0.127 Test Loss: 5.540 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.7558064460754395
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.566 Vali Acc: 0.126 Test Loss: 5.566 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.705219268798828
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.585 Vali Acc: 0.127 Test Loss: 5.585 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.5619118213653564
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.596 Vali Acc: 0.132 Test Loss: 5.596 Test Acc: 0.132
Validation loss decreased (-0.130533 --> -0.131709).  Saving model ...
Epoch: 24 cost time: 3.7109129428863525
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.617 Vali Acc: 0.131 Test Loss: 5.617 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.658252000808716
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.622 Vali Acc: 0.129 Test Loss: 5.622 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.090289831161499
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.621 Vali Acc: 0.133 Test Loss: 5.621 Test Acc: 0.133
Validation loss decreased (-0.131709 --> -0.132885).  Saving model ...
Epoch: 27 cost time: 4.06378698348999
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.630 Vali Acc: 0.133 Test Loss: 5.630 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.743509292602539
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.637 Vali Acc: 0.133 Test Loss: 5.637 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.9601519107818604
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.680 Vali Acc: 0.132 Test Loss: 5.680 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.9055118560791016
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.696 Vali Acc: 0.131 Test Loss: 5.696 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.9218010902404785
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.698 Vali Acc: 0.131 Test Loss: 5.698 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.9206674098968506
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.693 Vali Acc: 0.129 Test Loss: 5.693 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.547926902770996
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.706 Vali Acc: 0.128 Test Loss: 5.706 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.4806225299835205
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.710 Vali Acc: 0.129 Test Loss: 5.710 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.7665109634399414
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.719 Vali Acc: 0.131 Test Loss: 5.719 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.696110725402832
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.740 Vali Acc: 0.131 Test Loss: 5.740 Test Acc: 0.131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13294117647058823
model parameter : 5220890
model size : 29.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.049444198608398
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.337 Vali Acc: 0.031 Test Loss: 3.337 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 3.5981664657592773
Epoch: 2, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.498 Vali Acc: 0.046 Test Loss: 3.498 Test Acc: 0.046
Validation loss decreased (-0.030555 --> -0.045847).  Saving model ...
Epoch: 3 cost time: 3.3572287559509277
Epoch: 3, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.454 Vali Acc: 0.071 Test Loss: 3.454 Test Acc: 0.071
Validation loss decreased (-0.045847 --> -0.070554).  Saving model ...
Epoch: 4 cost time: 3.8967535495758057
Epoch: 4, Steps: 10 | Train Loss: 2.447 Vali Loss: 3.433 Vali Acc: 0.078 Test Loss: 3.433 Test Acc: 0.078
Validation loss decreased (-0.070554 --> -0.077613).  Saving model ...
Epoch: 5 cost time: 3.664382219314575
Epoch: 5, Steps: 10 | Train Loss: 2.006 Vali Loss: 3.406 Vali Acc: 0.085 Test Loss: 3.406 Test Acc: 0.085
Validation loss decreased (-0.077613 --> -0.084672).  Saving model ...
Epoch: 6 cost time: 3.6936419010162354
Epoch: 6, Steps: 10 | Train Loss: 1.469 Vali Loss: 3.675 Vali Acc: 0.095 Test Loss: 3.675 Test Acc: 0.095
Validation loss decreased (-0.084672 --> -0.095257).  Saving model ...
Epoch: 7 cost time: 3.5839574337005615
Epoch: 7, Steps: 10 | Train Loss: 0.936 Vali Loss: 3.917 Vali Acc: 0.107 Test Loss: 3.917 Test Acc: 0.107
Validation loss decreased (-0.095257 --> -0.107020).  Saving model ...
Epoch: 8 cost time: 3.766841173171997
Epoch: 8, Steps: 10 | Train Loss: 0.501 Vali Loss: 4.186 Vali Acc: 0.122 Test Loss: 4.186 Test Acc: 0.122
Validation loss decreased (-0.107020 --> -0.122311).  Saving model ...
Epoch: 9 cost time: 3.4858736991882324
Epoch: 9, Steps: 10 | Train Loss: 0.240 Vali Loss: 4.499 Vali Acc: 0.131 Test Loss: 4.499 Test Acc: 0.131
Validation loss decreased (-0.122311 --> -0.130543).  Saving model ...
Epoch: 10 cost time: 3.534618377685547
Epoch: 10, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.737 Vali Acc: 0.139 Test Loss: 4.737 Test Acc: 0.139
Validation loss decreased (-0.130543 --> -0.138776).  Saving model ...
Epoch: 11 cost time: 3.8210997581481934
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.941 Vali Acc: 0.144 Test Loss: 4.941 Test Acc: 0.144
Validation loss decreased (-0.138776 --> -0.143480).  Saving model ...
Epoch: 12 cost time: 3.8377137184143066
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.172 Vali Acc: 0.140 Test Loss: 5.172 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5651509761810303
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.092 Vali Acc: 0.151 Test Loss: 5.092 Test Acc: 0.151
Validation loss decreased (-0.143480 --> -0.150537).  Saving model ...
Epoch: 14 cost time: 3.883146047592163
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.213 Vali Acc: 0.151 Test Loss: 5.213 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.964616060256958
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.243 Vali Acc: 0.149 Test Loss: 5.243 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.821430206298828
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.236 Vali Acc: 0.147 Test Loss: 5.236 Test Acc: 0.147
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5588858127593994
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.257 Vali Acc: 0.146 Test Loss: 5.257 Test Acc: 0.146
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6301863193511963
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.286 Vali Acc: 0.148 Test Loss: 5.286 Test Acc: 0.148
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.7643990516662598
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.306 Vali Acc: 0.149 Test Loss: 5.306 Test Acc: 0.149
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.906111478805542
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.323 Vali Acc: 0.148 Test Loss: 5.323 Test Acc: 0.148
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.839193105697632
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.336 Vali Acc: 0.148 Test Loss: 5.336 Test Acc: 0.148
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.853404998779297
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.360 Vali Acc: 0.149 Test Loss: 5.360 Test Acc: 0.149
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.448988914489746
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.382 Vali Acc: 0.148 Test Loss: 5.382 Test Acc: 0.148
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15058823529411763
model parameter : 5220890
model size : 29.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.8961567878723145
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 3.615453004837036
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 3.637561321258545
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 4 cost time: 3.3710696697235107
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 5 cost time: 3.5278353691101074
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 6 cost time: 3.783973455429077
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 7 cost time: 3.5978219509124756
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6491949558258057
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6354522705078125
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.6174099445343018
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.424912929534912
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.5480713844299316
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.332671642303467
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.3640143871307373
Epoch: 14, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.4353089332580566
Epoch: 15, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.4256479740142822
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.042352941176470586
model parameter : 5220890
model size : 29.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.631241083145142
Epoch: 1, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.240 Vali Acc: 0.087 Test Loss: 3.240 Test Acc: 0.087
Validation loss decreased (inf --> -0.087026).  Saving model ...
Epoch: 2 cost time: 3.5565268993377686
Epoch: 2, Steps: 10 | Train Loss: 2.616 Vali Loss: 3.273 Vali Acc: 0.162 Test Loss: 3.273 Test Acc: 0.162
Validation loss decreased (-0.087026 --> -0.162320).  Saving model ...
Epoch: 3 cost time: 3.8686392307281494
Epoch: 3, Steps: 10 | Train Loss: 1.645 Vali Loss: 3.151 Vali Acc: 0.233 Test Loss: 3.151 Test Acc: 0.233
Validation loss decreased (-0.162320 --> -0.232910).  Saving model ...
Epoch: 4 cost time: 3.707185745239258
Epoch: 4, Steps: 10 | Train Loss: 0.945 Vali Loss: 3.305 Vali Acc: 0.241 Test Loss: 3.305 Test Acc: 0.241
Validation loss decreased (-0.232910 --> -0.241143).  Saving model ...
Epoch: 5 cost time: 3.372730016708374
Epoch: 5, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.556 Vali Acc: 0.264 Test Loss: 3.556 Test Acc: 0.264
Validation loss decreased (-0.241143 --> -0.263494).  Saving model ...
Epoch: 6 cost time: 3.416999340057373
Epoch: 6, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.739 Vali Acc: 0.272 Test Loss: 3.739 Test Acc: 0.272
Validation loss decreased (-0.263494 --> -0.271727).  Saving model ...
Epoch: 7 cost time: 3.5968499183654785
Epoch: 7, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.091 Vali Acc: 0.273 Test Loss: 4.091 Test Acc: 0.273
Validation loss decreased (-0.271727 --> -0.272900).  Saving model ...
Epoch: 8 cost time: 3.8119380474090576
Epoch: 8, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.229 Vali Acc: 0.274 Test Loss: 4.229 Test Acc: 0.274
Validation loss decreased (-0.272900 --> -0.274075).  Saving model ...
Epoch: 9 cost time: 3.946803092956543
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.373 Vali Acc: 0.288 Test Loss: 4.373 Test Acc: 0.288
Validation loss decreased (-0.274075 --> -0.288192).  Saving model ...
Epoch: 10 cost time: 4.171642303466797
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.524 Vali Acc: 0.286 Test Loss: 4.524 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6237456798553467
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.452 Vali Acc: 0.295 Test Loss: 4.452 Test Acc: 0.295
Validation loss decreased (-0.288192 --> -0.295250).  Saving model ...
Epoch: 12 cost time: 3.671478509902954
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.496 Vali Acc: 0.299 Test Loss: 4.496 Test Acc: 0.299
Validation loss decreased (-0.295250 --> -0.298779).  Saving model ...
Epoch: 13 cost time: 3.8913540840148926
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.538 Vali Acc: 0.307 Test Loss: 4.538 Test Acc: 0.307
Validation loss decreased (-0.298779 --> -0.307013).  Saving model ...
Epoch: 14 cost time: 3.9970510005950928
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.588 Vali Acc: 0.302 Test Loss: 4.588 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.110291242599487
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.612 Vali Acc: 0.311 Test Loss: 4.612 Test Acc: 0.311
Validation loss decreased (-0.307013 --> -0.310542).  Saving model ...
Epoch: 16 cost time: 3.9515469074249268
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.616 Vali Acc: 0.312 Test Loss: 4.616 Test Acc: 0.312
Validation loss decreased (-0.310542 --> -0.311719).  Saving model ...
Epoch: 17 cost time: 3.8285019397735596
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.635 Vali Acc: 0.312 Test Loss: 4.635 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.848573684692383
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.660 Vali Acc: 0.307 Test Loss: 4.660 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.9934728145599365
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.679 Vali Acc: 0.307 Test Loss: 4.679 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.8491978645324707
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.691 Vali Acc: 0.309 Test Loss: 4.691 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.728403091430664
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.706 Vali Acc: 0.313 Test Loss: 4.706 Test Acc: 0.313
Validation loss decreased (-0.311719 --> -0.312894).  Saving model ...
Epoch: 22 cost time: 3.884251594543457
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.716 Vali Acc: 0.312 Test Loss: 4.716 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3927788734436035
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.736 Vali Acc: 0.314 Test Loss: 4.736 Test Acc: 0.314
Validation loss decreased (-0.312894 --> -0.314070).  Saving model ...
Epoch: 24 cost time: 4.19310998916626
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.758 Vali Acc: 0.309 Test Loss: 4.758 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.8706326484680176
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.778 Vali Acc: 0.312 Test Loss: 4.778 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.5682387351989746
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.796 Vali Acc: 0.309 Test Loss: 4.796 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.80047345161438
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.812 Vali Acc: 0.311 Test Loss: 4.812 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.4848110675811768
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.824 Vali Acc: 0.311 Test Loss: 4.824 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.045404434204102
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.843 Vali Acc: 0.313 Test Loss: 4.843 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.770087480545044
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.857 Vali Acc: 0.312 Test Loss: 4.857 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.446241855621338
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.869 Vali Acc: 0.309 Test Loss: 4.869 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.5893023014068604
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.880 Vali Acc: 0.309 Test Loss: 4.880 Test Acc: 0.309
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.931591749191284
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.893 Vali Acc: 0.309 Test Loss: 4.893 Test Acc: 0.309
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 4434458
model size : 26.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.021753787994385
Epoch: 1, Steps: 10 | Train Loss: 3.292 Vali Loss: 3.262 Vali Acc: 0.098 Test Loss: 3.262 Test Acc: 0.098
Validation loss decreased (inf --> -0.097614).  Saving model ...
Epoch: 2 cost time: 3.3049349784851074
Epoch: 2, Steps: 10 | Train Loss: 2.652 Vali Loss: 3.295 Vali Acc: 0.161 Test Loss: 3.295 Test Acc: 0.161
Validation loss decreased (-0.097614 --> -0.161144).  Saving model ...
Epoch: 3 cost time: 3.4527769088745117
Epoch: 3, Steps: 10 | Train Loss: 1.665 Vali Loss: 3.150 Vali Acc: 0.248 Test Loss: 3.150 Test Acc: 0.248
Validation loss decreased (-0.161144 --> -0.248204).  Saving model ...
Epoch: 4 cost time: 3.5111911296844482
Epoch: 4, Steps: 10 | Train Loss: 0.962 Vali Loss: 3.300 Vali Acc: 0.264 Test Loss: 3.300 Test Acc: 0.264
Validation loss decreased (-0.248204 --> -0.263496).  Saving model ...
Epoch: 5 cost time: 3.755868434906006
Epoch: 5, Steps: 10 | Train Loss: 0.497 Vali Loss: 3.554 Vali Acc: 0.284 Test Loss: 3.554 Test Acc: 0.284
Validation loss decreased (-0.263496 --> -0.283494).  Saving model ...
Epoch: 6 cost time: 3.8538753986358643
Epoch: 6, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.757 Vali Acc: 0.287 Test Loss: 3.757 Test Acc: 0.287
Validation loss decreased (-0.283494 --> -0.287021).  Saving model ...
Epoch: 7 cost time: 3.6854071617126465
Epoch: 7, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.099 Vali Acc: 0.287 Test Loss: 4.099 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.761431932449341
Epoch: 8, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.367 Vali Acc: 0.291 Test Loss: 4.367 Test Acc: 0.291
Validation loss decreased (-0.287021 --> -0.290545).  Saving model ...
Epoch: 9 cost time: 3.800442934036255
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.359 Vali Acc: 0.315 Test Loss: 4.359 Test Acc: 0.315
Validation loss decreased (-0.290545 --> -0.315251).  Saving model ...
Epoch: 10 cost time: 3.9999303817749023
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.641 Vali Acc: 0.288 Test Loss: 4.641 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9464550018310547
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.460 Vali Acc: 0.316 Test Loss: 4.460 Test Acc: 0.316
Validation loss decreased (-0.315251 --> -0.316426).  Saving model ...
Epoch: 12 cost time: 3.6977217197418213
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.540 Vali Acc: 0.319 Test Loss: 4.540 Test Acc: 0.319
Validation loss decreased (-0.316426 --> -0.318778).  Saving model ...
Epoch: 13 cost time: 3.7202301025390625
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.687 Vali Acc: 0.312 Test Loss: 4.687 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7828335762023926
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.721 Vali Acc: 0.309 Test Loss: 4.721 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6886720657348633
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.717 Vali Acc: 0.318 Test Loss: 4.717 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6876890659332275
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.710 Vali Acc: 0.320 Test Loss: 4.710 Test Acc: 0.320
Validation loss decreased (-0.318778 --> -0.319953).  Saving model ...
Epoch: 17 cost time: 3.6134657859802246
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.720 Vali Acc: 0.320 Test Loss: 4.720 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.533356189727783
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.738 Vali Acc: 0.322 Test Loss: 4.738 Test Acc: 0.322
Validation loss decreased (-0.319953 --> -0.322306).  Saving model ...
Epoch: 19 cost time: 3.6394150257110596
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.748 Vali Acc: 0.325 Test Loss: 4.748 Test Acc: 0.325
Validation loss decreased (-0.322306 --> -0.324658).  Saving model ...
Epoch: 20 cost time: 3.6756441593170166
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.757 Vali Acc: 0.327 Test Loss: 4.757 Test Acc: 0.327
Validation loss decreased (-0.324658 --> -0.327011).  Saving model ...
Epoch: 21 cost time: 3.8496687412261963
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.770 Vali Acc: 0.327 Test Loss: 4.770 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7611260414123535
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.777 Vali Acc: 0.328 Test Loss: 4.777 Test Acc: 0.328
Validation loss decreased (-0.327011 --> -0.328188).  Saving model ...
Epoch: 23 cost time: 3.6452457904815674
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.795 Vali Acc: 0.328 Test Loss: 4.795 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.994011163711548
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.815 Vali Acc: 0.327 Test Loss: 4.815 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.828070878982544
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.829 Vali Acc: 0.327 Test Loss: 4.829 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.805795192718506
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.845 Vali Acc: 0.327 Test Loss: 4.845 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.47654390335083
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.864 Vali Acc: 0.328 Test Loss: 4.864 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.761805534362793
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.880 Vali Acc: 0.328 Test Loss: 4.880 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.911599636077881
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.899 Vali Acc: 0.327 Test Loss: 4.899 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.7370123863220215
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.911 Vali Acc: 0.325 Test Loss: 4.911 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.9046695232391357
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.925 Vali Acc: 0.325 Test Loss: 4.925 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.7988150119781494
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.938 Vali Acc: 0.326 Test Loss: 4.938 Test Acc: 0.326
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32823529411764707
model parameter : 4434458
model size : 26.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.070692300796509
Epoch: 1, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.242 Vali Acc: 0.095 Test Loss: 3.242 Test Acc: 0.095
Validation loss decreased (inf --> -0.095262).  Saving model ...
Epoch: 2 cost time: 3.745495080947876
Epoch: 2, Steps: 10 | Train Loss: 2.640 Vali Loss: 3.316 Vali Acc: 0.145 Test Loss: 3.316 Test Acc: 0.145
Validation loss decreased (-0.095262 --> -0.144673).  Saving model ...
Epoch: 3 cost time: 3.743792772293091
Epoch: 3, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.236 Vali Acc: 0.234 Test Loss: 3.236 Test Acc: 0.234
Validation loss decreased (-0.144673 --> -0.234085).  Saving model ...
Epoch: 4 cost time: 3.417670249938965
Epoch: 4, Steps: 10 | Train Loss: 1.052 Vali Loss: 3.393 Vali Acc: 0.267 Test Loss: 3.393 Test Acc: 0.267
Validation loss decreased (-0.234085 --> -0.267025).  Saving model ...
Epoch: 5 cost time: 3.702936887741089
Epoch: 5, Steps: 10 | Train Loss: 0.592 Vali Loss: 3.604 Vali Acc: 0.285 Test Loss: 3.604 Test Acc: 0.285
Validation loss decreased (-0.267025 --> -0.284670).  Saving model ...
Epoch: 6 cost time: 3.778918981552124
Epoch: 6, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.829 Vali Acc: 0.275 Test Loss: 3.829 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.901049852371216
Epoch: 7, Steps: 10 | Train Loss: 0.159 Vali Loss: 4.206 Vali Acc: 0.275 Test Loss: 4.206 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.518462896347046
Epoch: 8, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.324 Vali Acc: 0.302 Test Loss: 4.324 Test Acc: 0.302
Validation loss decreased (-0.284670 --> -0.302310).  Saving model ...
Epoch: 9 cost time: 3.5479660034179688
Epoch: 9, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.429 Vali Acc: 0.307 Test Loss: 4.429 Test Acc: 0.307
Validation loss decreased (-0.302310 --> -0.307015).  Saving model ...
Epoch: 10 cost time: 4.084807634353638
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.861 Vali Acc: 0.278 Test Loss: 4.861 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.681854486465454
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.728 Vali Acc: 0.307 Test Loss: 4.728 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6187636852264404
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.855 Vali Acc: 0.305 Test Loss: 4.855 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.742694616317749
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.975 Vali Acc: 0.292 Test Loss: 4.975 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.5395820140838623
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.963 Vali Acc: 0.306 Test Loss: 4.963 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3661391735076904
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.922 Vali Acc: 0.315 Test Loss: 4.922 Test Acc: 0.315
Validation loss decreased (-0.307015 --> -0.315245).  Saving model ...
Epoch: 16 cost time: 3.820770502090454
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.885 Vali Acc: 0.322 Test Loss: 4.885 Test Acc: 0.322
Validation loss decreased (-0.315245 --> -0.322304).  Saving model ...
Epoch: 17 cost time: 3.9655141830444336
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.884 Vali Acc: 0.325 Test Loss: 4.884 Test Acc: 0.325
Validation loss decreased (-0.322304 --> -0.324657).  Saving model ...
Epoch: 18 cost time: 3.6522576808929443
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.892 Vali Acc: 0.328 Test Loss: 4.892 Test Acc: 0.328
Validation loss decreased (-0.324657 --> -0.328186).  Saving model ...
Epoch: 19 cost time: 3.2874324321746826
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.902 Vali Acc: 0.329 Test Loss: 4.902 Test Acc: 0.329
Validation loss decreased (-0.328186 --> -0.329363).  Saving model ...
Epoch: 20 cost time: 3.5487992763519287
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.911 Vali Acc: 0.328 Test Loss: 4.911 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4530956745147705
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.927 Vali Acc: 0.331 Test Loss: 4.927 Test Acc: 0.331
Validation loss decreased (-0.329363 --> -0.330539).  Saving model ...
Epoch: 22 cost time: 3.793229818344116
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.938 Vali Acc: 0.328 Test Loss: 4.938 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6228513717651367
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.953 Vali Acc: 0.328 Test Loss: 4.953 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5800576210021973
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.967 Vali Acc: 0.328 Test Loss: 4.967 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.4508047103881836
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.985 Vali Acc: 0.327 Test Loss: 4.985 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.4780211448669434
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.999 Vali Acc: 0.324 Test Loss: 4.999 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.988595962524414
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.018 Vali Acc: 0.321 Test Loss: 5.018 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.118733644485474
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.029 Vali Acc: 0.324 Test Loss: 5.029 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.6572492122650146
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.043 Vali Acc: 0.325 Test Loss: 5.043 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.455331325531006
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.057 Vali Acc: 0.325 Test Loss: 5.057 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.6257755756378174
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.069 Vali Acc: 0.322 Test Loss: 5.069 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3305882352941176
model parameter : 4434458
model size : 26.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.037815809249878
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.257 Vali Acc: 0.076 Test Loss: 3.257 Test Acc: 0.076
Validation loss decreased (inf --> -0.076438).  Saving model ...
Epoch: 2 cost time: 3.7283780574798584
Epoch: 2, Steps: 10 | Train Loss: 2.698 Vali Loss: 3.388 Vali Acc: 0.129 Test Loss: 3.388 Test Acc: 0.129
Validation loss decreased (-0.076438 --> -0.129378).  Saving model ...
Epoch: 3 cost time: 3.619459629058838
Epoch: 3, Steps: 10 | Train Loss: 1.802 Vali Loss: 3.396 Vali Acc: 0.174 Test Loss: 3.396 Test Acc: 0.174
Validation loss decreased (-0.129378 --> -0.174084).  Saving model ...
Epoch: 4 cost time: 3.896254539489746
Epoch: 4, Steps: 10 | Train Loss: 1.128 Vali Loss: 3.615 Vali Acc: 0.196 Test Loss: 3.615 Test Acc: 0.196
Validation loss decreased (-0.174084 --> -0.196434).  Saving model ...
Epoch: 5 cost time: 3.796664237976074
Epoch: 5, Steps: 10 | Train Loss: 0.685 Vali Loss: 3.871 Vali Acc: 0.199 Test Loss: 3.871 Test Acc: 0.199
Validation loss decreased (-0.196434 --> -0.198785).  Saving model ...
Epoch: 6 cost time: 3.687936544418335
Epoch: 6, Steps: 10 | Train Loss: 0.404 Vali Loss: 4.073 Vali Acc: 0.236 Test Loss: 4.073 Test Acc: 0.236
Validation loss decreased (-0.198785 --> -0.236430).  Saving model ...
Epoch: 7 cost time: 3.6830718517303467
Epoch: 7, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.428 Vali Acc: 0.241 Test Loss: 4.428 Test Acc: 0.241
Validation loss decreased (-0.236430 --> -0.241132).  Saving model ...
Epoch: 8 cost time: 3.4477272033691406
Epoch: 8, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.644 Vali Acc: 0.222 Test Loss: 4.644 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.306501865386963
Epoch: 9, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.831 Vali Acc: 0.245 Test Loss: 4.831 Test Acc: 0.245
Validation loss decreased (-0.241132 --> -0.244658).  Saving model ...
Epoch: 10 cost time: 3.9487109184265137
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 5.089 Vali Acc: 0.235 Test Loss: 5.089 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.766841411590576
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.270 Vali Acc: 0.231 Test Loss: 5.270 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8595352172851562
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.338 Vali Acc: 0.244 Test Loss: 5.338 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.382697820663452
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.681 Vali Acc: 0.234 Test Loss: 5.681 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.751859426498413
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.426 Vali Acc: 0.256 Test Loss: 5.426 Test Acc: 0.256
Validation loss decreased (-0.244658 --> -0.256416).  Saving model ...
Epoch: 15 cost time: 3.8042945861816406
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.654 Vali Acc: 0.231 Test Loss: 5.654 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.604444980621338
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.562 Vali Acc: 0.239 Test Loss: 5.562 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.922060251235962
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.485 Vali Acc: 0.252 Test Loss: 5.485 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6565358638763428
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.488 Vali Acc: 0.249 Test Loss: 5.488 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.4813694953918457
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.499 Vali Acc: 0.249 Test Loss: 5.499 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.4918649196624756
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.509 Vali Acc: 0.252 Test Loss: 5.509 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1872668266296387
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.526 Vali Acc: 0.253 Test Loss: 5.526 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.5564630031585693
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.536 Vali Acc: 0.256 Test Loss: 5.536 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.7644197940826416
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.553 Vali Acc: 0.253 Test Loss: 5.553 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.7758233547210693
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.569 Vali Acc: 0.255 Test Loss: 5.569 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 4434458
model size : 26.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.5532917976379395
Epoch: 1, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.308 Vali Acc: 0.046 Test Loss: 3.308 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 3.5256459712982178
Epoch: 2, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.468 Vali Acc: 0.075 Test Loss: 3.468 Test Acc: 0.075
Validation loss decreased (-0.045849 --> -0.075259).  Saving model ...
Epoch: 3 cost time: 3.4021904468536377
Epoch: 3, Steps: 10 | Train Loss: 1.957 Vali Loss: 3.408 Vali Acc: 0.102 Test Loss: 3.408 Test Acc: 0.102
Validation loss decreased (-0.075259 --> -0.102319).  Saving model ...
Epoch: 4 cost time: 3.6552329063415527
Epoch: 4, Steps: 10 | Train Loss: 1.201 Vali Loss: 3.607 Vali Acc: 0.121 Test Loss: 3.607 Test Acc: 0.121
Validation loss decreased (-0.102319 --> -0.121140).  Saving model ...
Epoch: 5 cost time: 3.5090157985687256
Epoch: 5, Steps: 10 | Train Loss: 0.615 Vali Loss: 4.003 Vali Acc: 0.115 Test Loss: 4.003 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2340846061706543
Epoch: 6, Steps: 10 | Train Loss: 0.301 Vali Loss: 4.364 Vali Acc: 0.125 Test Loss: 4.364 Test Acc: 0.125
Validation loss decreased (-0.121140 --> -0.124662).  Saving model ...
Epoch: 7 cost time: 3.253814458847046
Epoch: 7, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.769 Vali Acc: 0.135 Test Loss: 4.769 Test Acc: 0.135
Validation loss decreased (-0.124662 --> -0.135246).  Saving model ...
Epoch: 8 cost time: 3.5247011184692383
Epoch: 8, Steps: 10 | Train Loss: 0.037 Vali Loss: 5.003 Vali Acc: 0.139 Test Loss: 5.003 Test Acc: 0.139
Validation loss decreased (-0.135246 --> -0.138774).  Saving model ...
Epoch: 9 cost time: 3.823136806488037
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.119 Vali Acc: 0.146 Test Loss: 5.119 Test Acc: 0.146
Validation loss decreased (-0.138774 --> -0.145831).  Saving model ...
Epoch: 10 cost time: 3.716440439224243
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.387 Vali Acc: 0.153 Test Loss: 5.387 Test Acc: 0.153
Validation loss decreased (-0.145831 --> -0.152887).  Saving model ...
Epoch: 11 cost time: 3.7307991981506348
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.488 Vali Acc: 0.147 Test Loss: 5.488 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.343625783920288
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.497 Vali Acc: 0.149 Test Loss: 5.497 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4083542823791504
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.522 Vali Acc: 0.154 Test Loss: 5.522 Test Acc: 0.154
Validation loss decreased (-0.152887 --> -0.154062).  Saving model ...
Epoch: 14 cost time: 4.089756965637207
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.565 Vali Acc: 0.152 Test Loss: 5.565 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4999616146087646
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.600 Vali Acc: 0.154 Test Loss: 5.600 Test Acc: 0.154
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.56874942779541
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.622 Vali Acc: 0.153 Test Loss: 5.622 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.2108383178710938
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.656 Vali Acc: 0.153 Test Loss: 5.656 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.332836389541626
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.680 Vali Acc: 0.155 Test Loss: 5.680 Test Acc: 0.155
Validation loss decreased (-0.154062 --> -0.155237).  Saving model ...
Epoch: 19 cost time: 3.552509069442749
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.704 Vali Acc: 0.155 Test Loss: 5.704 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5917062759399414
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.726 Vali Acc: 0.153 Test Loss: 5.726 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6031014919281006
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.760 Vali Acc: 0.156 Test Loss: 5.760 Test Acc: 0.156
Validation loss decreased (-0.155237 --> -0.156413).  Saving model ...
Epoch: 22 cost time: 3.139498710632324
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.782 Vali Acc: 0.156 Test Loss: 5.782 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5771143436431885
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.807 Vali Acc: 0.155 Test Loss: 5.807 Test Acc: 0.155
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5648300647735596
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.835 Vali Acc: 0.156 Test Loss: 5.835 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.8145015239715576
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.865 Vali Acc: 0.156 Test Loss: 5.865 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.730591058731079
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.889 Vali Acc: 0.162 Test Loss: 5.889 Test Acc: 0.162
Validation loss decreased (-0.156413 --> -0.162294).  Saving model ...
Epoch: 27 cost time: 3.753300905227661
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.912 Vali Acc: 0.162 Test Loss: 5.912 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.560997486114502
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.935 Vali Acc: 0.164 Test Loss: 5.935 Test Acc: 0.164
Validation loss decreased (-0.162294 --> -0.163470).  Saving model ...
Epoch: 29 cost time: 3.5257225036621094
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.958 Vali Acc: 0.161 Test Loss: 5.958 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.9998247623443604
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.973 Vali Acc: 0.161 Test Loss: 5.973 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.839466094970703
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.990 Vali Acc: 0.164 Test Loss: 5.990 Test Acc: 0.164
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.8864526748657227
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.005 Vali Acc: 0.164 Test Loss: 6.005 Test Acc: 0.164
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.483175277709961
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.027 Vali Acc: 0.165 Test Loss: 6.027 Test Acc: 0.165
Validation loss decreased (-0.163470 --> -0.164646).  Saving model ...
Epoch: 34 cost time: 3.4161550998687744
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.045 Vali Acc: 0.166 Test Loss: 6.045 Test Acc: 0.166
Validation loss decreased (-0.164646 --> -0.165822).  Saving model ...
Epoch: 35 cost time: 3.8722715377807617
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.058 Vali Acc: 0.167 Test Loss: 6.058 Test Acc: 0.167
Validation loss decreased (-0.165822 --> -0.166998).  Saving model ...
Epoch: 36 cost time: 3.8526129722595215
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.073 Vali Acc: 0.166 Test Loss: 6.073 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.7645375728607178
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.094 Vali Acc: 0.165 Test Loss: 6.094 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.4322116374969482
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.114 Vali Acc: 0.166 Test Loss: 6.114 Test Acc: 0.166
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.3018639087677
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.137 Vali Acc: 0.165 Test Loss: 6.137 Test Acc: 0.165
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.8802640438079834
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.154 Vali Acc: 0.165 Test Loss: 6.154 Test Acc: 0.165
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.861893653869629
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.171 Vali Acc: 0.165 Test Loss: 6.171 Test Acc: 0.165
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.087189674377441
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.186 Vali Acc: 0.167 Test Loss: 6.186 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.5591835975646973
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.202 Vali Acc: 0.167 Test Loss: 6.202 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.582549810409546
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.217 Vali Acc: 0.166 Test Loss: 6.217 Test Acc: 0.166
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.5618669986724854
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.230 Vali Acc: 0.167 Test Loss: 6.230 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16705882352941176
model parameter : 4434458
model size : 26.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.980388164520264
Epoch: 1, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.342 Vali Acc: 0.040 Test Loss: 3.342 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.393164873123169
Epoch: 2, Steps: 10 | Train Loss: 2.997 Vali Loss: 3.498 Vali Acc: 0.040 Test Loss: 3.498 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.290572166442871
Epoch: 3, Steps: 10 | Train Loss: 2.311 Vali Loss: 3.414 Vali Acc: 0.065 Test Loss: 3.414 Test Acc: 0.065
Validation loss decreased (-0.039967 --> -0.064672).  Saving model ...
Epoch: 4 cost time: 3.640031337738037
Epoch: 4, Steps: 10 | Train Loss: 1.612 Vali Loss: 3.463 Vali Acc: 0.079 Test Loss: 3.463 Test Acc: 0.079
Validation loss decreased (-0.064672 --> -0.078789).  Saving model ...
Epoch: 5 cost time: 3.7175099849700928
Epoch: 5, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.741 Vali Acc: 0.088 Test Loss: 3.741 Test Acc: 0.088
Validation loss decreased (-0.078789 --> -0.088198).  Saving model ...
Epoch: 6 cost time: 3.565084218978882
Epoch: 6, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.966 Vali Acc: 0.089 Test Loss: 3.966 Test Acc: 0.089
Validation loss decreased (-0.088198 --> -0.089372).  Saving model ...
Epoch: 7 cost time: 3.483572006225586
Epoch: 7, Steps: 10 | Train Loss: 0.228 Vali Loss: 4.338 Vali Acc: 0.102 Test Loss: 4.338 Test Acc: 0.102
Validation loss decreased (-0.089372 --> -0.102310).  Saving model ...
Epoch: 8 cost time: 3.584635019302368
Epoch: 8, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.722 Vali Acc: 0.111 Test Loss: 4.722 Test Acc: 0.111
Validation loss decreased (-0.102310 --> -0.110541).  Saving model ...
Epoch: 9 cost time: 3.3381187915802
Epoch: 9, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.981 Vali Acc: 0.111 Test Loss: 4.981 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.430180788040161
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.441 Vali Acc: 0.122 Test Loss: 5.441 Test Acc: 0.122
Validation loss decreased (-0.110541 --> -0.122299).  Saving model ...
Epoch: 11 cost time: 3.8620710372924805
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.443 Vali Acc: 0.116 Test Loss: 5.443 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.735445261001587
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.391 Vali Acc: 0.115 Test Loss: 5.391 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5308759212493896
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.423 Vali Acc: 0.112 Test Loss: 5.423 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.7614877223968506
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.455 Vali Acc: 0.112 Test Loss: 5.455 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.9902944564819336
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.480 Vali Acc: 0.114 Test Loss: 5.480 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.865609645843506
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.497 Vali Acc: 0.118 Test Loss: 5.497 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.7202255725860596
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.527 Vali Acc: 0.116 Test Loss: 5.527 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.61682391166687
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.560 Vali Acc: 0.116 Test Loss: 5.560 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.6006360054016113
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.591 Vali Acc: 0.111 Test Loss: 5.591 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.7181193828582764
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.611 Vali Acc: 0.113 Test Loss: 5.611 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1223529411764706
model parameter : 4434458
model size : 26.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.889403820037842
Epoch: 1, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.350 Vali Acc: 0.028 Test Loss: 3.350 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 3.4056594371795654
Epoch: 2, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.531 Vali Acc: 0.052 Test Loss: 3.531 Test Acc: 0.052
Validation loss decreased (-0.028202 --> -0.051729).  Saving model ...
Epoch: 3 cost time: 3.62699556350708
Epoch: 3, Steps: 10 | Train Loss: 2.612 Vali Loss: 3.436 Vali Acc: 0.078 Test Loss: 3.436 Test Acc: 0.078
Validation loss decreased (-0.051729 --> -0.077613).  Saving model ...
Epoch: 4 cost time: 3.544677257537842
Epoch: 4, Steps: 10 | Train Loss: 2.086 Vali Loss: 3.411 Vali Acc: 0.089 Test Loss: 3.411 Test Acc: 0.089
Validation loss decreased (-0.077613 --> -0.089378).  Saving model ...
Epoch: 5 cost time: 3.8708395957946777
Epoch: 5, Steps: 10 | Train Loss: 1.457 Vali Loss: 3.591 Vali Acc: 0.104 Test Loss: 3.591 Test Acc: 0.104
Validation loss decreased (-0.089378 --> -0.103494).  Saving model ...
Epoch: 6 cost time: 3.729412317276001
Epoch: 6, Steps: 10 | Train Loss: 0.908 Vali Loss: 3.812 Vali Acc: 0.096 Test Loss: 3.812 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4360039234161377
Epoch: 7, Steps: 10 | Train Loss: 0.472 Vali Loss: 4.289 Vali Acc: 0.095 Test Loss: 4.289 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.263801336288452
Epoch: 8, Steps: 10 | Train Loss: 0.212 Vali Loss: 4.612 Vali Acc: 0.106 Test Loss: 4.612 Test Acc: 0.106
Validation loss decreased (-0.103494 --> -0.105836).  Saving model ...
Epoch: 9 cost time: 3.7875847816467285
Epoch: 9, Steps: 10 | Train Loss: 0.093 Vali Loss: 5.119 Vali Acc: 0.100 Test Loss: 5.119 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.75303316116333
Epoch: 10, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.435 Vali Acc: 0.114 Test Loss: 5.435 Test Acc: 0.114
Validation loss decreased (-0.105836 --> -0.114063).  Saving model ...
Epoch: 11 cost time: 3.7156269550323486
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.426 Vali Acc: 0.118 Test Loss: 5.426 Test Acc: 0.118
Validation loss decreased (-0.114063 --> -0.117593).  Saving model ...
Epoch: 12 cost time: 3.4330883026123047
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.511 Vali Acc: 0.121 Test Loss: 5.511 Test Acc: 0.121
Validation loss decreased (-0.117593 --> -0.121121).  Saving model ...
Epoch: 13 cost time: 3.485100507736206
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.632 Vali Acc: 0.121 Test Loss: 5.632 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6480519771575928
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.702 Vali Acc: 0.115 Test Loss: 5.702 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7770907878875732
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.721 Vali Acc: 0.124 Test Loss: 5.721 Test Acc: 0.124
Validation loss decreased (-0.121121 --> -0.123472).  Saving model ...
Epoch: 16 cost time: 3.905284881591797
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.739 Vali Acc: 0.126 Test Loss: 5.739 Test Acc: 0.126
Validation loss decreased (-0.123472 --> -0.125825).  Saving model ...
Epoch: 17 cost time: 3.948747396469116
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.762 Vali Acc: 0.125 Test Loss: 5.762 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.932494640350342
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.798 Vali Acc: 0.128 Test Loss: 5.798 Test Acc: 0.128
Validation loss decreased (-0.125825 --> -0.128177).  Saving model ...
Epoch: 19 cost time: 4.105953216552734
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.813 Vali Acc: 0.126 Test Loss: 5.813 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.545131206512451
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.821 Vali Acc: 0.127 Test Loss: 5.821 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5650930404663086
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.841 Vali Acc: 0.126 Test Loss: 5.841 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.583847761154175
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.859 Vali Acc: 0.125 Test Loss: 5.859 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.889392614364624
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.880 Vali Acc: 0.128 Test Loss: 5.880 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.5770204067230225
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.894 Vali Acc: 0.128 Test Loss: 5.894 Test Acc: 0.128
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.7180182933807373
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.912 Vali Acc: 0.127 Test Loss: 5.912 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.2020058631896973
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.922 Vali Acc: 0.131 Test Loss: 5.922 Test Acc: 0.131
Validation loss decreased (-0.128177 --> -0.130529).  Saving model ...
Epoch: 27 cost time: 3.4513163566589355
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.936 Vali Acc: 0.129 Test Loss: 5.936 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.829139471054077
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.953 Vali Acc: 0.128 Test Loss: 5.953 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.9476158618927
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.971 Vali Acc: 0.129 Test Loss: 5.971 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.6088764667510986
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.984 Vali Acc: 0.129 Test Loss: 5.984 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.4363276958465576
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.002 Vali Acc: 0.131 Test Loss: 6.002 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.809730291366577
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.009 Vali Acc: 0.133 Test Loss: 6.009 Test Acc: 0.133
Validation loss decreased (-0.130529 --> -0.132881).  Saving model ...
Epoch: 33 cost time: 3.5152130126953125
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.017 Vali Acc: 0.132 Test Loss: 6.017 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.5433835983276367
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.033 Vali Acc: 0.132 Test Loss: 6.033 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.6207995414733887
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.050 Vali Acc: 0.133 Test Loss: 6.050 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.1343250274658203
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.067 Vali Acc: 0.133 Test Loss: 6.067 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.4471850395202637
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.083 Vali Acc: 0.132 Test Loss: 6.083 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.614504814147949
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.097 Vali Acc: 0.133 Test Loss: 6.097 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.927950382232666
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.110 Vali Acc: 0.135 Test Loss: 6.110 Test Acc: 0.135
Validation loss decreased (-0.132881 --> -0.135233).  Saving model ...
Epoch: 40 cost time: 3.8903164863586426
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.120 Vali Acc: 0.135 Test Loss: 6.120 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.356309652328491
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.127 Vali Acc: 0.135 Test Loss: 6.127 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.7113637924194336
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.138 Vali Acc: 0.135 Test Loss: 6.138 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.4746222496032715
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.151 Vali Acc: 0.135 Test Loss: 6.151 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.665309190750122
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.165 Vali Acc: 0.133 Test Loss: 6.165 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.898364543914795
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.174 Vali Acc: 0.135 Test Loss: 6.174 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.671903371810913
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.181 Vali Acc: 0.134 Test Loss: 6.181 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.5802345275878906
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.202 Vali Acc: 0.134 Test Loss: 6.202 Test Acc: 0.134
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.4991564750671387
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.215 Vali Acc: 0.135 Test Loss: 6.215 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.5877692699432373
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.224 Vali Acc: 0.135 Test Loss: 6.224 Test Acc: 0.135
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13529411764705881
model parameter : 4434458
model size : 26.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.041243076324463
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.314 Vali Acc: 0.039 Test Loss: 3.314 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 3.4984474182128906
Epoch: 2, Steps: 10 | Train Loss: 3.110 Vali Loss: 3.504 Vali Acc: 0.067 Test Loss: 3.504 Test Acc: 0.067
Validation loss decreased (-0.038790 --> -0.067024).  Saving model ...
Epoch: 3 cost time: 3.420640468597412
Epoch: 3, Steps: 10 | Train Loss: 2.785 Vali Loss: 3.419 Vali Acc: 0.078 Test Loss: 3.419 Test Acc: 0.078
Validation loss decreased (-0.067024 --> -0.077613).  Saving model ...
Epoch: 4 cost time: 3.7275989055633545
Epoch: 4, Steps: 10 | Train Loss: 2.355 Vali Loss: 3.371 Vali Acc: 0.093 Test Loss: 3.371 Test Acc: 0.093
Validation loss decreased (-0.077613 --> -0.092907).  Saving model ...
Epoch: 5 cost time: 3.8063297271728516
Epoch: 5, Steps: 10 | Train Loss: 1.803 Vali Loss: 3.492 Vali Acc: 0.098 Test Loss: 3.492 Test Acc: 0.098
Validation loss decreased (-0.092907 --> -0.097612).  Saving model ...
Epoch: 6 cost time: 3.7849509716033936
Epoch: 6, Steps: 10 | Train Loss: 1.229 Vali Loss: 3.609 Vali Acc: 0.096 Test Loss: 3.609 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6361470222473145
Epoch: 7, Steps: 10 | Train Loss: 0.738 Vali Loss: 4.026 Vali Acc: 0.099 Test Loss: 4.026 Test Acc: 0.099
Validation loss decreased (-0.097612 --> -0.098783).  Saving model ...
Epoch: 8 cost time: 3.858739137649536
Epoch: 8, Steps: 10 | Train Loss: 0.384 Vali Loss: 4.257 Vali Acc: 0.114 Test Loss: 4.257 Test Acc: 0.114
Validation loss decreased (-0.098783 --> -0.114075).  Saving model ...
Epoch: 9 cost time: 3.9546854496002197
Epoch: 9, Steps: 10 | Train Loss: 0.188 Vali Loss: 4.703 Vali Acc: 0.113 Test Loss: 4.703 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.157590627670288
Epoch: 10, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.981 Vali Acc: 0.121 Test Loss: 4.981 Test Acc: 0.121
Validation loss decreased (-0.114075 --> -0.121127).  Saving model ...
Epoch: 11 cost time: 3.85113263130188
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.937 Vali Acc: 0.127 Test Loss: 4.937 Test Acc: 0.127
Validation loss decreased (-0.121127 --> -0.127009).  Saving model ...
Epoch: 12 cost time: 3.8896267414093018
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.115 Vali Acc: 0.136 Test Loss: 5.115 Test Acc: 0.136
Validation loss decreased (-0.127009 --> -0.136419).  Saving model ...
Epoch: 13 cost time: 3.948031187057495
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.393 Vali Acc: 0.121 Test Loss: 5.393 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.114539623260498
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.465 Vali Acc: 0.125 Test Loss: 5.465 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.889883518218994
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.450 Vali Acc: 0.116 Test Loss: 5.450 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.648477077484131
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.446 Vali Acc: 0.115 Test Loss: 5.446 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.5355257987976074
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.477 Vali Acc: 0.118 Test Loss: 5.477 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.7497754096984863
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.505 Vali Acc: 0.121 Test Loss: 5.505 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.7770285606384277
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.512 Vali Acc: 0.125 Test Loss: 5.512 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.049076557159424
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.516 Vali Acc: 0.124 Test Loss: 5.516 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.468923330307007
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.539 Vali Acc: 0.125 Test Loss: 5.539 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.6872920989990234
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.555 Vali Acc: 0.126 Test Loss: 5.555 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13647058823529412
model parameter : 4434458
model size : 26.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.863629579544067
Epoch: 1, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.350 Vali Acc: 0.039 Test Loss: 3.350 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 3.4895761013031006
Epoch: 2, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.551 Vali Acc: 0.058 Test Loss: 3.551 Test Acc: 0.058
Validation loss decreased (-0.038790 --> -0.057612).  Saving model ...
Epoch: 3 cost time: 3.3111419677734375
Epoch: 3, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.464 Vali Acc: 0.085 Test Loss: 3.464 Test Acc: 0.085
Validation loss decreased (-0.057612 --> -0.084671).  Saving model ...
Epoch: 4 cost time: 3.1946005821228027
Epoch: 4, Steps: 10 | Train Loss: 2.498 Vali Loss: 3.379 Vali Acc: 0.089 Test Loss: 3.379 Test Acc: 0.089
Validation loss decreased (-0.084671 --> -0.089378).  Saving model ...
Epoch: 5 cost time: 3.5216219425201416
Epoch: 5, Steps: 10 | Train Loss: 2.049 Vali Loss: 3.515 Vali Acc: 0.087 Test Loss: 3.515 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7083120346069336
Epoch: 6, Steps: 10 | Train Loss: 1.438 Vali Loss: 3.626 Vali Acc: 0.098 Test Loss: 3.626 Test Acc: 0.098
Validation loss decreased (-0.089378 --> -0.097611).  Saving model ...
Epoch: 7 cost time: 3.9769952297210693
Epoch: 7, Steps: 10 | Train Loss: 0.949 Vali Loss: 4.024 Vali Acc: 0.101 Test Loss: 4.024 Test Acc: 0.101
Validation loss decreased (-0.097611 --> -0.101136).  Saving model ...
Epoch: 8 cost time: 3.64288592338562
Epoch: 8, Steps: 10 | Train Loss: 0.534 Vali Loss: 4.240 Vali Acc: 0.118 Test Loss: 4.240 Test Acc: 0.118
Validation loss decreased (-0.101136 --> -0.117605).  Saving model ...
Epoch: 9 cost time: 4.023085355758667
Epoch: 9, Steps: 10 | Train Loss: 0.297 Vali Loss: 4.674 Vali Acc: 0.125 Test Loss: 4.674 Test Acc: 0.125
Validation loss decreased (-0.117605 --> -0.124659).  Saving model ...
Epoch: 10 cost time: 4.015773773193359
Epoch: 10, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.822 Vali Acc: 0.141 Test Loss: 4.822 Test Acc: 0.141
Validation loss decreased (-0.124659 --> -0.141128).  Saving model ...
Epoch: 11 cost time: 3.853684663772583
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 5.123 Vali Acc: 0.146 Test Loss: 5.123 Test Acc: 0.146
Validation loss decreased (-0.141128 --> -0.145831).  Saving model ...
Epoch: 12 cost time: 3.9464590549468994
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.286 Vali Acc: 0.144 Test Loss: 5.286 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7168021202087402
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.476 Vali Acc: 0.148 Test Loss: 5.476 Test Acc: 0.148
Validation loss decreased (-0.145831 --> -0.148181).  Saving model ...
Epoch: 14 cost time: 4.1078643798828125
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.663 Vali Acc: 0.154 Test Loss: 5.663 Test Acc: 0.154
Validation loss decreased (-0.148181 --> -0.154061).  Saving model ...
Epoch: 15 cost time: 3.6906566619873047
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.582 Vali Acc: 0.161 Test Loss: 5.582 Test Acc: 0.161
Validation loss decreased (-0.154061 --> -0.161121).  Saving model ...
Epoch: 16 cost time: 3.6876332759857178
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.518 Vali Acc: 0.156 Test Loss: 5.518 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4844274520874023
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.542 Vali Acc: 0.153 Test Loss: 5.542 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.5843148231506348
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.581 Vali Acc: 0.156 Test Loss: 5.581 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6504743099212646
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.593 Vali Acc: 0.159 Test Loss: 5.593 Test Acc: 0.159
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.8049697875976562
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.603 Vali Acc: 0.159 Test Loss: 5.603 Test Acc: 0.159
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.7854514122009277
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.634 Vali Acc: 0.155 Test Loss: 5.634 Test Acc: 0.155
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.7928295135498047
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.634 Vali Acc: 0.160 Test Loss: 5.634 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.6586408615112305
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.637 Vali Acc: 0.160 Test Loss: 5.637 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.8925299644470215
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.653 Vali Acc: 0.159 Test Loss: 5.653 Test Acc: 0.159
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.001406192779541
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.681 Vali Acc: 0.156 Test Loss: 5.681 Test Acc: 0.156
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16117647058823528
model parameter : 4434458
model size : 26.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.904198169708252
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 3.3733808994293213
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 3.1757349967956543
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 3.737917184829712
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 5 cost time: 3.4450936317443848
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 6 cost time: 3.7865867614746094
Epoch: 6, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 7 cost time: 3.5091614723205566
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 8 cost time: 3.7591066360473633
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 9 cost time: 4.01323676109314
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 10 cost time: 4.032764196395874
Epoch: 10, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 11 cost time: 3.597059726715088
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 12 cost time: 3.6788299083709717
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 13 cost time: 3.564586877822876
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 14 cost time: 3.667088270187378
Epoch: 14, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 15 cost time: 3.1403403282165527
Epoch: 15, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 16 cost time: 3.3642733097076416
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 17 cost time: 3.5402486324310303
Epoch: 17, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 18 cost time: 3.4474968910217285
Epoch: 18, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 19 cost time: 3.5833706855773926
Epoch: 19, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 20 cost time: 3.724903106689453
Epoch: 20, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 21 cost time: 3.417013168334961
Epoch: 21, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 22 cost time: 3.625969409942627
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 23 cost time: 3.7101287841796875
Epoch: 23, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 24 cost time: 3.6459922790527344
Epoch: 24, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 25 cost time: 3.4528584480285645
Epoch: 25, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 26 cost time: 3.7099010944366455
Epoch: 26, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.778876543045044
Epoch: 27, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 28 cost time: 3.812268018722534
Epoch: 28, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 29 cost time: 3.6517372131347656
Epoch: 29, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 30 cost time: 3.767624855041504
Epoch: 30, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 31 cost time: 3.3828413486480713
Epoch: 31, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 32 cost time: 3.722057819366455
Epoch: 32, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 33 cost time: 3.5025558471679688
Epoch: 33, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 34 cost time: 3.6567649841308594
Epoch: 34, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 35 cost time: 3.213979482650757
Epoch: 35, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 36 cost time: 3.4932658672332764
Epoch: 36, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 37 cost time: 3.425110340118408
Epoch: 37, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 38 cost time: 3.7078452110290527
Epoch: 38, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 39 cost time: 3.987104892730713
Epoch: 39, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 40 cost time: 3.316041946411133
Epoch: 40, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 41 cost time: 3.4456872940063477
Epoch: 41, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.508894681930542
Epoch: 42, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 43 cost time: 3.9130265712738037
Epoch: 43, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.585620641708374
Epoch: 44, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.6982345581054688
Epoch: 45, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.520869016647339
Epoch: 46, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.3783860206604004
Epoch: 47, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.7667768001556396
Epoch: 48, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.6450159549713135
Epoch: 49, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.60917329788208
Epoch: 50, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.4713234901428223
Epoch: 51, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.742156505584717
Epoch: 52, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.03764705882352941
model parameter : 4434458
model size : 26.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.344876527786255
Epoch: 1, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.289 Vali Acc: 0.065 Test Loss: 3.289 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 3.6356592178344727
Epoch: 2, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.289 Vali Acc: 0.125 Test Loss: 3.289 Test Acc: 0.125
Validation loss decreased (-0.064673 --> -0.124673).  Saving model ...
Epoch: 3 cost time: 3.305558204650879
Epoch: 3, Steps: 10 | Train Loss: 1.756 Vali Loss: 3.113 Vali Acc: 0.234 Test Loss: 3.113 Test Acc: 0.234
Validation loss decreased (-0.124673 --> -0.234087).  Saving model ...
Epoch: 4 cost time: 3.463960886001587
Epoch: 4, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.378 Vali Acc: 0.229 Test Loss: 3.378 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.547222375869751
Epoch: 5, Steps: 10 | Train Loss: 0.469 Vali Loss: 3.481 Vali Acc: 0.272 Test Loss: 3.481 Test Acc: 0.272
Validation loss decreased (-0.234087 --> -0.271730).  Saving model ...
Epoch: 6 cost time: 3.3936829566955566
Epoch: 6, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.801 Vali Acc: 0.272 Test Loss: 3.801 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6268789768218994
Epoch: 7, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.041 Vali Acc: 0.269 Test Loss: 4.041 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.609898090362549
Epoch: 8, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.255 Vali Acc: 0.271 Test Loss: 4.255 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2810728549957275
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.520 Vali Acc: 0.271 Test Loss: 4.520 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2730324268341064
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.524 Vali Acc: 0.274 Test Loss: 4.524 Test Acc: 0.274
Validation loss decreased (-0.271730 --> -0.274072).  Saving model ...
Epoch: 11 cost time: 3.515366315841675
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.488 Vali Acc: 0.288 Test Loss: 4.488 Test Acc: 0.288
Validation loss decreased (-0.274072 --> -0.288190).  Saving model ...
Epoch: 12 cost time: 3.670097589492798
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.498 Vali Acc: 0.311 Test Loss: 4.498 Test Acc: 0.311
Validation loss decreased (-0.288190 --> -0.310543).  Saving model ...
Epoch: 13 cost time: 3.4002346992492676
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.550 Vali Acc: 0.312 Test Loss: 4.550 Test Acc: 0.312
Validation loss decreased (-0.310543 --> -0.311719).  Saving model ...
Epoch: 14 cost time: 3.5178143978118896
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.591 Vali Acc: 0.309 Test Loss: 4.591 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3832647800445557
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.613 Vali Acc: 0.311 Test Loss: 4.613 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.663818597793579
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.625 Vali Acc: 0.314 Test Loss: 4.625 Test Acc: 0.314
Validation loss decreased (-0.311719 --> -0.314071).  Saving model ...
Epoch: 17 cost time: 3.8486220836639404
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.631 Vali Acc: 0.314 Test Loss: 4.631 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.758382558822632
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.644 Vali Acc: 0.316 Test Loss: 4.644 Test Acc: 0.316
Validation loss decreased (-0.314071 --> -0.316424).  Saving model ...
Epoch: 19 cost time: 3.2818589210510254
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.658 Vali Acc: 0.318 Test Loss: 4.658 Test Acc: 0.318
Validation loss decreased (-0.316424 --> -0.317600).  Saving model ...
Epoch: 20 cost time: 3.4185776710510254
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.671 Vali Acc: 0.316 Test Loss: 4.671 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7005505561828613
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.689 Vali Acc: 0.318 Test Loss: 4.689 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.773556709289551
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.706 Vali Acc: 0.316 Test Loss: 4.706 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.7846219539642334
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.728 Vali Acc: 0.316 Test Loss: 4.728 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.5012543201446533
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.744 Vali Acc: 0.318 Test Loss: 4.744 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.4151828289031982
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.756 Vali Acc: 0.314 Test Loss: 4.756 Test Acc: 0.314
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.396662950515747
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.771 Vali Acc: 0.316 Test Loss: 4.771 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.6571872234344482
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.778 Vali Acc: 0.314 Test Loss: 4.778 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.535426378250122
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.797 Vali Acc: 0.316 Test Loss: 4.797 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.817272663116455
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.819 Vali Acc: 0.316 Test Loss: 4.819 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 4041242
model size : 25.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.206539154052734
Epoch: 1, Steps: 10 | Train Loss: 3.332 Vali Loss: 3.291 Vali Acc: 0.064 Test Loss: 3.291 Test Acc: 0.064
Validation loss decreased (inf --> -0.063496).  Saving model ...
Epoch: 2 cost time: 3.6487836837768555
Epoch: 2, Steps: 10 | Train Loss: 2.685 Vali Loss: 3.299 Vali Acc: 0.136 Test Loss: 3.299 Test Acc: 0.136
Validation loss decreased (-0.063496 --> -0.136438).  Saving model ...
Epoch: 3 cost time: 3.9933128356933594
Epoch: 3, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.153 Vali Acc: 0.240 Test Loss: 3.153 Test Acc: 0.240
Validation loss decreased (-0.136438 --> -0.239968).  Saving model ...
Epoch: 4 cost time: 3.0894768238067627
Epoch: 4, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.384 Vali Acc: 0.238 Test Loss: 3.384 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3523812294006348
Epoch: 5, Steps: 10 | Train Loss: 0.488 Vali Loss: 3.488 Vali Acc: 0.293 Test Loss: 3.488 Test Acc: 0.293
Validation loss decreased (-0.239968 --> -0.292906).  Saving model ...
Epoch: 6 cost time: 3.656190872192383
Epoch: 6, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.800 Vali Acc: 0.285 Test Loss: 3.800 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6106116771698
Epoch: 7, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.096 Vali Acc: 0.298 Test Loss: 4.096 Test Acc: 0.298
Validation loss decreased (-0.292906 --> -0.297606).  Saving model ...
Epoch: 8 cost time: 3.632012367248535
Epoch: 8, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.229 Vali Acc: 0.296 Test Loss: 4.229 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6092653274536133
Epoch: 9, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.457 Vali Acc: 0.286 Test Loss: 4.457 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7617075443267822
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.591 Vali Acc: 0.293 Test Loss: 4.591 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.912137508392334
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.569 Vali Acc: 0.311 Test Loss: 4.569 Test Acc: 0.311
Validation loss decreased (-0.297606 --> -0.310543).  Saving model ...
Epoch: 12 cost time: 3.883746862411499
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.654 Vali Acc: 0.313 Test Loss: 4.654 Test Acc: 0.313
Validation loss decreased (-0.310543 --> -0.312895).  Saving model ...
Epoch: 13 cost time: 3.9643733501434326
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.732 Vali Acc: 0.316 Test Loss: 4.732 Test Acc: 0.316
Validation loss decreased (-0.312895 --> -0.316423).  Saving model ...
Epoch: 14 cost time: 3.798572301864624
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.755 Vali Acc: 0.313 Test Loss: 4.755 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7246251106262207
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.758 Vali Acc: 0.315 Test Loss: 4.758 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.116307020187378
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.761 Vali Acc: 0.312 Test Loss: 4.761 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.7112503051757812
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.764 Vali Acc: 0.319 Test Loss: 4.764 Test Acc: 0.319
Validation loss decreased (-0.316423 --> -0.318776).  Saving model ...
Epoch: 18 cost time: 3.802083969116211
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.776 Vali Acc: 0.320 Test Loss: 4.776 Test Acc: 0.320
Validation loss decreased (-0.318776 --> -0.319952).  Saving model ...
Epoch: 19 cost time: 3.5377564430236816
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.800 Vali Acc: 0.316 Test Loss: 4.800 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6672163009643555
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.818 Vali Acc: 0.316 Test Loss: 4.818 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.285325527191162
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.839 Vali Acc: 0.318 Test Loss: 4.839 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.6465330123901367
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.856 Vali Acc: 0.319 Test Loss: 4.856 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.1439926624298096
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.872 Vali Acc: 0.318 Test Loss: 4.872 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.3959600925445557
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.883 Vali Acc: 0.318 Test Loss: 4.883 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.3882834911346436
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.897 Vali Acc: 0.318 Test Loss: 4.897 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.8644347190856934
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.915 Vali Acc: 0.318 Test Loss: 4.915 Test Acc: 0.318
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.662010669708252
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.925 Vali Acc: 0.321 Test Loss: 4.925 Test Acc: 0.321
Validation loss decreased (-0.319952 --> -0.321127).  Saving model ...
Epoch: 28 cost time: 3.4072988033294678
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.944 Vali Acc: 0.322 Test Loss: 4.944 Test Acc: 0.322
Validation loss decreased (-0.321127 --> -0.322304).  Saving model ...
Epoch: 29 cost time: 3.5252668857574463
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.964 Vali Acc: 0.320 Test Loss: 4.964 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.6718008518218994
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.974 Vali Acc: 0.318 Test Loss: 4.974 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.573713541030884
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.983 Vali Acc: 0.316 Test Loss: 4.983 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.771557092666626
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.995 Vali Acc: 0.320 Test Loss: 4.995 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.6845080852508545
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.014 Vali Acc: 0.320 Test Loss: 5.014 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.6635189056396484
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.030 Vali Acc: 0.321 Test Loss: 5.030 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.450819492340088
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.040 Vali Acc: 0.320 Test Loss: 5.040 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.9377007484436035
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.054 Vali Acc: 0.321 Test Loss: 5.054 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.9326040744781494
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.069 Vali Acc: 0.322 Test Loss: 5.069 Test Acc: 0.322
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.790515899658203
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.085 Vali Acc: 0.321 Test Loss: 5.085 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 4041242
model size : 25.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.756006240844727
Epoch: 1, Steps: 10 | Train Loss: 3.306 Vali Loss: 3.265 Vali Acc: 0.092 Test Loss: 3.265 Test Acc: 0.092
Validation loss decreased (inf --> -0.091732).  Saving model ...
Epoch: 2 cost time: 3.658764123916626
Epoch: 2, Steps: 10 | Train Loss: 2.649 Vali Loss: 3.315 Vali Acc: 0.145 Test Loss: 3.315 Test Acc: 0.145
Validation loss decreased (-0.091732 --> -0.144673).  Saving model ...
Epoch: 3 cost time: 3.765071392059326
Epoch: 3, Steps: 10 | Train Loss: 1.792 Vali Loss: 3.223 Vali Acc: 0.246 Test Loss: 3.223 Test Acc: 0.246
Validation loss decreased (-0.144673 --> -0.245850).  Saving model ...
Epoch: 4 cost time: 3.512800693511963
Epoch: 4, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.489 Vali Acc: 0.242 Test Loss: 3.489 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3575875759124756
Epoch: 5, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.555 Vali Acc: 0.282 Test Loss: 3.555 Test Acc: 0.282
Validation loss decreased (-0.245850 --> -0.282317).  Saving model ...
Epoch: 6 cost time: 3.3609163761138916
Epoch: 6, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.878 Vali Acc: 0.279 Test Loss: 3.878 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.199023485183716
Epoch: 7, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.026 Vali Acc: 0.292 Test Loss: 4.026 Test Acc: 0.292
Validation loss decreased (-0.282317 --> -0.291724).  Saving model ...
Epoch: 8 cost time: 3.7177894115448
Epoch: 8, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.214 Vali Acc: 0.308 Test Loss: 4.214 Test Acc: 0.308
Validation loss decreased (-0.291724 --> -0.308193).  Saving model ...
Epoch: 9 cost time: 3.5939784049987793
Epoch: 9, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.322 Vali Acc: 0.300 Test Loss: 4.322 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.758063793182373
Epoch: 10, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.474 Vali Acc: 0.305 Test Loss: 4.474 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.429731607437134
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.608 Vali Acc: 0.309 Test Loss: 4.608 Test Acc: 0.309
Validation loss decreased (-0.308193 --> -0.309366).  Saving model ...
Epoch: 12 cost time: 3.653113842010498
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.601 Vali Acc: 0.313 Test Loss: 4.601 Test Acc: 0.313
Validation loss decreased (-0.309366 --> -0.312895).  Saving model ...
Epoch: 13 cost time: 3.803866386413574
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.651 Vali Acc: 0.320 Test Loss: 4.651 Test Acc: 0.320
Validation loss decreased (-0.312895 --> -0.319953).  Saving model ...
Epoch: 14 cost time: 3.8349123001098633
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.689 Vali Acc: 0.314 Test Loss: 4.689 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9748523235321045
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.704 Vali Acc: 0.311 Test Loss: 4.704 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7615091800689697
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.708 Vali Acc: 0.313 Test Loss: 4.708 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.690969228744507
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.719 Vali Acc: 0.314 Test Loss: 4.719 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.733384847640991
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.748 Vali Acc: 0.315 Test Loss: 4.748 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.586977958679199
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.787 Vali Acc: 0.318 Test Loss: 4.787 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.2894303798675537
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.805 Vali Acc: 0.322 Test Loss: 4.805 Test Acc: 0.322
Validation loss decreased (-0.319953 --> -0.322305).  Saving model ...
Epoch: 21 cost time: 3.5094845294952393
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.828 Vali Acc: 0.320 Test Loss: 4.828 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.352062225341797
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.845 Vali Acc: 0.325 Test Loss: 4.845 Test Acc: 0.325
Validation loss decreased (-0.322305 --> -0.324657).  Saving model ...
Epoch: 23 cost time: 3.8045079708099365
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.866 Vali Acc: 0.318 Test Loss: 4.866 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.135317802429199
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.882 Vali Acc: 0.321 Test Loss: 4.882 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.724534273147583
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.904 Vali Acc: 0.324 Test Loss: 4.904 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.9016709327697754
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.926 Vali Acc: 0.324 Test Loss: 4.926 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.802971839904785
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.938 Vali Acc: 0.326 Test Loss: 4.938 Test Acc: 0.326
Validation loss decreased (-0.324657 --> -0.325833).  Saving model ...
Epoch: 28 cost time: 4.068971157073975
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.955 Vali Acc: 0.325 Test Loss: 4.955 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.946072816848755
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.976 Vali Acc: 0.326 Test Loss: 4.976 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.4740841388702393
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.992 Vali Acc: 0.327 Test Loss: 4.992 Test Acc: 0.327
Validation loss decreased (-0.325833 --> -0.327009).  Saving model ...
Epoch: 31 cost time: 3.7823290824890137
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.008 Vali Acc: 0.324 Test Loss: 5.008 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.900655508041382
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.022 Vali Acc: 0.326 Test Loss: 5.022 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.4122071266174316
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.038 Vali Acc: 0.325 Test Loss: 5.038 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.9223599433898926
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.053 Vali Acc: 0.325 Test Loss: 5.053 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.598114013671875
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.065 Vali Acc: 0.325 Test Loss: 5.065 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.6381144523620605
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.084 Vali Acc: 0.325 Test Loss: 5.084 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.4344887733459473
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.099 Vali Acc: 0.324 Test Loss: 5.099 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.894862174987793
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.117 Vali Acc: 0.327 Test Loss: 5.117 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.6222805976867676
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.131 Vali Acc: 0.329 Test Loss: 5.131 Test Acc: 0.329
Validation loss decreased (-0.327009 --> -0.329360).  Saving model ...
Epoch: 40 cost time: 3.6490447521209717
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.150 Vali Acc: 0.325 Test Loss: 5.150 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.685157537460327
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.164 Vali Acc: 0.326 Test Loss: 5.164 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.5968456268310547
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.176 Vali Acc: 0.327 Test Loss: 5.176 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.004810094833374
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.185 Vali Acc: 0.326 Test Loss: 5.185 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.7654213905334473
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.196 Vali Acc: 0.327 Test Loss: 5.196 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.4861106872558594
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.211 Vali Acc: 0.325 Test Loss: 5.211 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.51469349861145
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.232 Vali Acc: 0.326 Test Loss: 5.232 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.4381277561187744
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.248 Vali Acc: 0.328 Test Loss: 5.248 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.863152027130127
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.261 Vali Acc: 0.328 Test Loss: 5.261 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.910193681716919
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.272 Vali Acc: 0.332 Test Loss: 5.272 Test Acc: 0.332
Validation loss decreased (-0.329360 --> -0.331712).  Saving model ...
Epoch: 50 cost time: 3.4863550662994385
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.283 Vali Acc: 0.331 Test Loss: 5.283 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.739778995513916
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.293 Vali Acc: 0.329 Test Loss: 5.293 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.4358160495758057
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.307 Vali Acc: 0.329 Test Loss: 5.307 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.6148111820220947
Epoch: 53, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.315 Vali Acc: 0.328 Test Loss: 5.315 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.7954673767089844
Epoch: 54, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.331 Vali Acc: 0.328 Test Loss: 5.331 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.6851701736450195
Epoch: 55, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.342 Vali Acc: 0.328 Test Loss: 5.342 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.508600950241089
Epoch: 56, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.354 Vali Acc: 0.327 Test Loss: 5.354 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.5164875984191895
Epoch: 57, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.365 Vali Acc: 0.327 Test Loss: 5.365 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.4464657306671143
Epoch: 58, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.375 Vali Acc: 0.328 Test Loss: 5.375 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.6574597358703613
Epoch: 59, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.389 Vali Acc: 0.326 Test Loss: 5.389 Test Acc: 0.326
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33176470588235296
model parameter : 4041242
model size : 25.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.767098426818848
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.291 Vali Acc: 0.076 Test Loss: 3.291 Test Acc: 0.076
Validation loss decreased (inf --> -0.076438).  Saving model ...
Epoch: 2 cost time: 3.7431178092956543
Epoch: 2, Steps: 10 | Train Loss: 2.732 Vali Loss: 3.386 Vali Acc: 0.119 Test Loss: 3.386 Test Acc: 0.119
Validation loss decreased (-0.076438 --> -0.118790).  Saving model ...
Epoch: 3 cost time: 3.47920298576355
Epoch: 3, Steps: 10 | Train Loss: 1.900 Vali Loss: 3.345 Vali Acc: 0.192 Test Loss: 3.345 Test Acc: 0.192
Validation loss decreased (-0.118790 --> -0.191731).  Saving model ...
Epoch: 4 cost time: 3.72160005569458
Epoch: 4, Steps: 10 | Train Loss: 1.120 Vali Loss: 3.698 Vali Acc: 0.176 Test Loss: 3.698 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5179624557495117
Epoch: 5, Steps: 10 | Train Loss: 0.658 Vali Loss: 3.839 Vali Acc: 0.224 Test Loss: 3.839 Test Acc: 0.224
Validation loss decreased (-0.191731 --> -0.223491).  Saving model ...
Epoch: 6 cost time: 3.4427783489227295
Epoch: 6, Steps: 10 | Train Loss: 0.345 Vali Loss: 4.161 Vali Acc: 0.220 Test Loss: 4.161 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3258473873138428
Epoch: 7, Steps: 10 | Train Loss: 0.181 Vali Loss: 4.411 Vali Acc: 0.236 Test Loss: 4.411 Test Acc: 0.236
Validation loss decreased (-0.223491 --> -0.236426).  Saving model ...
Epoch: 8 cost time: 3.6213886737823486
Epoch: 8, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.682 Vali Acc: 0.226 Test Loss: 4.682 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6329381465911865
Epoch: 9, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.869 Vali Acc: 0.236 Test Loss: 4.869 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8905975818634033
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.936 Vali Acc: 0.259 Test Loss: 4.936 Test Acc: 0.259
Validation loss decreased (-0.236426 --> -0.258774).  Saving model ...
Epoch: 11 cost time: 3.4037485122680664
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.049 Vali Acc: 0.254 Test Loss: 5.049 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.589958429336548
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.090 Vali Acc: 0.265 Test Loss: 5.090 Test Acc: 0.265
Validation loss decreased (-0.258774 --> -0.264655).  Saving model ...
Epoch: 13 cost time: 3.6607041358947754
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.183 Vali Acc: 0.268 Test Loss: 5.183 Test Acc: 0.268
Validation loss decreased (-0.264655 --> -0.268183).  Saving model ...
Epoch: 14 cost time: 3.410412073135376
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.257 Vali Acc: 0.266 Test Loss: 5.257 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.284712553024292
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.324 Vali Acc: 0.269 Test Loss: 5.324 Test Acc: 0.269
Validation loss decreased (-0.268183 --> -0.269359).  Saving model ...
Epoch: 16 cost time: 3.5612690448760986
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.358 Vali Acc: 0.267 Test Loss: 5.358 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.582451105117798
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.371 Vali Acc: 0.272 Test Loss: 5.371 Test Acc: 0.272
Validation loss decreased (-0.269359 --> -0.271711).  Saving model ...
Epoch: 18 cost time: 3.8596036434173584
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.382 Vali Acc: 0.272 Test Loss: 5.382 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8320186138153076
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.400 Vali Acc: 0.271 Test Loss: 5.400 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6073904037475586
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.422 Vali Acc: 0.271 Test Loss: 5.422 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.3793859481811523
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.441 Vali Acc: 0.271 Test Loss: 5.441 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.35453724861145
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.464 Vali Acc: 0.273 Test Loss: 5.464 Test Acc: 0.273
Validation loss decreased (-0.271711 --> -0.272887).  Saving model ...
Epoch: 23 cost time: 3.70561146736145
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.487 Vali Acc: 0.272 Test Loss: 5.487 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.701364755630493
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.501 Vali Acc: 0.272 Test Loss: 5.501 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.794877767562866
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.515 Vali Acc: 0.271 Test Loss: 5.515 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.741142988204956
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.534 Vali Acc: 0.272 Test Loss: 5.534 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.726597309112549
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.543 Vali Acc: 0.275 Test Loss: 5.543 Test Acc: 0.275
Validation loss decreased (-0.272887 --> -0.275239).  Saving model ...
Epoch: 28 cost time: 3.9744300842285156
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.562 Vali Acc: 0.274 Test Loss: 5.562 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.8609092235565186
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.582 Vali Acc: 0.276 Test Loss: 5.582 Test Acc: 0.276
Validation loss decreased (-0.275239 --> -0.276415).  Saving model ...
Epoch: 30 cost time: 3.799149990081787
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.593 Vali Acc: 0.273 Test Loss: 5.593 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.568004846572876
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.606 Vali Acc: 0.274 Test Loss: 5.606 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.6415159702301025
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.618 Vali Acc: 0.275 Test Loss: 5.618 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.1053290367126465
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.635 Vali Acc: 0.275 Test Loss: 5.635 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.8954827785491943
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.651 Vali Acc: 0.275 Test Loss: 5.651 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.3193447589874268
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.662 Vali Acc: 0.276 Test Loss: 5.662 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.5020713806152344
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.676 Vali Acc: 0.278 Test Loss: 5.676 Test Acc: 0.278
Validation loss decreased (-0.276415 --> -0.277590).  Saving model ...
Epoch: 37 cost time: 3.577293634414673
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.692 Vali Acc: 0.278 Test Loss: 5.692 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.179175615310669
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.709 Vali Acc: 0.279 Test Loss: 5.709 Test Acc: 0.279
Validation loss decreased (-0.277590 --> -0.278766).  Saving model ...
Epoch: 39 cost time: 3.4096519947052
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.720 Vali Acc: 0.280 Test Loss: 5.720 Test Acc: 0.280
Validation loss decreased (-0.278766 --> -0.279943).  Saving model ...
Epoch: 40 cost time: 3.4948549270629883
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.734 Vali Acc: 0.279 Test Loss: 5.734 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.016497373580933
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.741 Vali Acc: 0.278 Test Loss: 5.741 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.531529664993286
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.753 Vali Acc: 0.278 Test Loss: 5.753 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.396920919418335
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.765 Vali Acc: 0.279 Test Loss: 5.765 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.5399041175842285
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.779 Vali Acc: 0.279 Test Loss: 5.779 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.890352964401245
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.792 Vali Acc: 0.279 Test Loss: 5.792 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 4.133219957351685
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.806 Vali Acc: 0.279 Test Loss: 5.806 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.373087167739868
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.817 Vali Acc: 0.278 Test Loss: 5.817 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.6281259059906006
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.830 Vali Acc: 0.278 Test Loss: 5.830 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.4313037395477295
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.843 Vali Acc: 0.276 Test Loss: 5.843 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 4041242
model size : 25.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.720042943954468
Epoch: 1, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.321 Vali Acc: 0.051 Test Loss: 3.321 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 3.2632334232330322
Epoch: 2, Steps: 10 | Train Loss: 2.838 Vali Loss: 3.483 Vali Acc: 0.079 Test Loss: 3.483 Test Acc: 0.079
Validation loss decreased (-0.050555 --> -0.078789).  Saving model ...
Epoch: 3 cost time: 3.5012524127960205
Epoch: 3, Steps: 10 | Train Loss: 2.010 Vali Loss: 3.382 Vali Acc: 0.114 Test Loss: 3.382 Test Acc: 0.114
Validation loss decreased (-0.078789 --> -0.114084).  Saving model ...
Epoch: 4 cost time: 3.423053026199341
Epoch: 4, Steps: 10 | Train Loss: 1.229 Vali Loss: 3.657 Vali Acc: 0.118 Test Loss: 3.657 Test Acc: 0.118
Validation loss decreased (-0.114084 --> -0.117610).  Saving model ...
Epoch: 5 cost time: 3.5164363384246826
Epoch: 5, Steps: 10 | Train Loss: 0.623 Vali Loss: 3.963 Vali Acc: 0.124 Test Loss: 3.963 Test Acc: 0.124
Validation loss decreased (-0.117610 --> -0.123490).  Saving model ...
Epoch: 6 cost time: 3.611487865447998
Epoch: 6, Steps: 10 | Train Loss: 0.257 Vali Loss: 4.315 Vali Acc: 0.134 Test Loss: 4.315 Test Acc: 0.134
Validation loss decreased (-0.123490 --> -0.134074).  Saving model ...
Epoch: 7 cost time: 3.0677144527435303
Epoch: 7, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.713 Vali Acc: 0.142 Test Loss: 4.713 Test Acc: 0.142
Validation loss decreased (-0.134074 --> -0.142306).  Saving model ...
Epoch: 8 cost time: 3.328531503677368
Epoch: 8, Steps: 10 | Train Loss: 0.054 Vali Loss: 5.088 Vali Acc: 0.135 Test Loss: 5.088 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.427572250366211
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.268 Vali Acc: 0.144 Test Loss: 5.268 Test Acc: 0.144
Validation loss decreased (-0.142306 --> -0.143477).  Saving model ...
Epoch: 10 cost time: 3.841174840927124
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.431 Vali Acc: 0.147 Test Loss: 5.431 Test Acc: 0.147
Validation loss decreased (-0.143477 --> -0.147005).  Saving model ...
Epoch: 11 cost time: 3.4053337574005127
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.514 Vali Acc: 0.146 Test Loss: 5.514 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7712039947509766
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.500 Vali Acc: 0.156 Test Loss: 5.500 Test Acc: 0.156
Validation loss decreased (-0.147005 --> -0.156416).  Saving model ...
Epoch: 13 cost time: 3.2972958087921143
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.617 Vali Acc: 0.151 Test Loss: 5.617 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7115817070007324
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.650 Vali Acc: 0.151 Test Loss: 5.650 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6930341720581055
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.648 Vali Acc: 0.149 Test Loss: 5.648 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.4816019535064697
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.664 Vali Acc: 0.154 Test Loss: 5.664 Test Acc: 0.154
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7805259227752686
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.688 Vali Acc: 0.153 Test Loss: 5.688 Test Acc: 0.153
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.7909584045410156
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.724 Vali Acc: 0.153 Test Loss: 5.724 Test Acc: 0.153
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.820037841796875
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.760 Vali Acc: 0.153 Test Loss: 5.760 Test Acc: 0.153
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.830019474029541
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.781 Vali Acc: 0.153 Test Loss: 5.781 Test Acc: 0.153
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.7263848781585693
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.804 Vali Acc: 0.151 Test Loss: 5.804 Test Acc: 0.151
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.5924899578094482
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.829 Vali Acc: 0.149 Test Loss: 5.829 Test Acc: 0.149
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1564705882352941
model parameter : 4041242
model size : 25.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.104271650314331
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.351 Vali Acc: 0.040 Test Loss: 3.351 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 3.5936667919158936
Epoch: 2, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.516 Vali Acc: 0.054 Test Loss: 3.516 Test Acc: 0.054
Validation loss decreased (-0.039966 --> -0.054082).  Saving model ...
Epoch: 3 cost time: 3.407284736633301
Epoch: 3, Steps: 10 | Train Loss: 2.353 Vali Loss: 3.399 Vali Acc: 0.076 Test Loss: 3.399 Test Acc: 0.076
Validation loss decreased (-0.054082 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 3.673424243927002
Epoch: 4, Steps: 10 | Train Loss: 1.641 Vali Loss: 3.520 Vali Acc: 0.076 Test Loss: 3.520 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6655020713806152
Epoch: 5, Steps: 10 | Train Loss: 0.962 Vali Loss: 3.755 Vali Acc: 0.098 Test Loss: 3.755 Test Acc: 0.098
Validation loss decreased (-0.076437 --> -0.097610).  Saving model ...
Epoch: 6 cost time: 3.682586908340454
Epoch: 6, Steps: 10 | Train Loss: 0.496 Vali Loss: 4.039 Vali Acc: 0.099 Test Loss: 4.039 Test Acc: 0.099
Validation loss decreased (-0.097610 --> -0.098783).  Saving model ...
Epoch: 7 cost time: 3.55881404876709
Epoch: 7, Steps: 10 | Train Loss: 0.238 Vali Loss: 4.341 Vali Acc: 0.119 Test Loss: 4.341 Test Acc: 0.119
Validation loss decreased (-0.098783 --> -0.118780).  Saving model ...
Epoch: 8 cost time: 3.445850372314453
Epoch: 8, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.835 Vali Acc: 0.111 Test Loss: 4.835 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.321488618850708
Epoch: 9, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.964 Vali Acc: 0.115 Test Loss: 4.964 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8496923446655273
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.273 Vali Acc: 0.106 Test Loss: 5.273 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8844213485717773
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.425 Vali Acc: 0.109 Test Loss: 5.425 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.663661479949951
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.407 Vali Acc: 0.113 Test Loss: 5.407 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.775942802429199
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.431 Vali Acc: 0.120 Test Loss: 5.431 Test Acc: 0.120
Validation loss decreased (-0.118780 --> -0.119946).  Saving model ...
Epoch: 14 cost time: 4.110437393188477
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.499 Vali Acc: 0.118 Test Loss: 5.499 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.098411560058594
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.552 Vali Acc: 0.116 Test Loss: 5.552 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.0378258228302
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.590 Vali Acc: 0.119 Test Loss: 5.590 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5644049644470215
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.606 Vali Acc: 0.118 Test Loss: 5.606 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.903691053390503
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.635 Vali Acc: 0.120 Test Loss: 5.635 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.872936964035034
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.670 Vali Acc: 0.119 Test Loss: 5.670 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.850888729095459
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.693 Vali Acc: 0.119 Test Loss: 5.693 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.6243340969085693
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.716 Vali Acc: 0.122 Test Loss: 5.716 Test Acc: 0.122
Validation loss decreased (-0.119946 --> -0.122296).  Saving model ...
Epoch: 22 cost time: 3.5321037769317627
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.737 Vali Acc: 0.122 Test Loss: 5.737 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.943617820739746
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.748 Vali Acc: 0.122 Test Loss: 5.748 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.7994093894958496
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.754 Vali Acc: 0.121 Test Loss: 5.754 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.758305311203003
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.769 Vali Acc: 0.122 Test Loss: 5.769 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.67407488822937
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.793 Vali Acc: 0.124 Test Loss: 5.793 Test Acc: 0.124
Validation loss decreased (-0.122296 --> -0.123471).  Saving model ...
Epoch: 27 cost time: 3.4827980995178223
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.810 Vali Acc: 0.124 Test Loss: 5.810 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.580156087875366
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.841 Vali Acc: 0.125 Test Loss: 5.841 Test Acc: 0.125
Validation loss decreased (-0.123471 --> -0.124647).  Saving model ...
Epoch: 29 cost time: 4.190970182418823
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.862 Vali Acc: 0.125 Test Loss: 5.862 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.6354188919067383
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.878 Vali Acc: 0.125 Test Loss: 5.878 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.74938702583313
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.900 Vali Acc: 0.125 Test Loss: 5.900 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.3343923091888428
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.915 Vali Acc: 0.124 Test Loss: 5.915 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.8495001792907715
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.936 Vali Acc: 0.127 Test Loss: 5.936 Test Acc: 0.127
Validation loss decreased (-0.124647 --> -0.126999).  Saving model ...
Epoch: 34 cost time: 3.854522705078125
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.950 Vali Acc: 0.128 Test Loss: 5.950 Test Acc: 0.128
Validation loss decreased (-0.126999 --> -0.128176).  Saving model ...
Epoch: 35 cost time: 3.821201801300049
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.956 Vali Acc: 0.127 Test Loss: 5.956 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.782813310623169
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.970 Vali Acc: 0.128 Test Loss: 5.970 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.746286392211914
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.986 Vali Acc: 0.127 Test Loss: 5.986 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.039726734161377
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.999 Vali Acc: 0.127 Test Loss: 5.999 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.942976474761963
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.007 Vali Acc: 0.126 Test Loss: 6.007 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.553574323654175
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.023 Vali Acc: 0.126 Test Loss: 6.023 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.5297555923461914
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.041 Vali Acc: 0.126 Test Loss: 6.041 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.028430223464966
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.057 Vali Acc: 0.126 Test Loss: 6.057 Test Acc: 0.126
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.8449296951293945
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.069 Vali Acc: 0.126 Test Loss: 6.069 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.785156488418579
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.081 Vali Acc: 0.127 Test Loss: 6.081 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12823529411764706
model parameter : 4041242
model size : 25.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.796907186508179
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.354 Vali Acc: 0.042 Test Loss: 3.354 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 3.4301095008850098
Epoch: 2, Steps: 10 | Train Loss: 3.125 Vali Loss: 3.572 Vali Acc: 0.062 Test Loss: 3.572 Test Acc: 0.062
Validation loss decreased (-0.042319 --> -0.062317).  Saving model ...
Epoch: 3 cost time: 3.2861506938934326
Epoch: 3, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.419 Vali Acc: 0.078 Test Loss: 3.419 Test Acc: 0.078
Validation loss decreased (-0.062317 --> -0.077613).  Saving model ...
Epoch: 4 cost time: 3.784778356552124
Epoch: 4, Steps: 10 | Train Loss: 2.092 Vali Loss: 3.421 Vali Acc: 0.087 Test Loss: 3.421 Test Acc: 0.087
Validation loss decreased (-0.077613 --> -0.087025).  Saving model ...
Epoch: 5 cost time: 3.5955612659454346
Epoch: 5, Steps: 10 | Train Loss: 1.465 Vali Loss: 3.640 Vali Acc: 0.089 Test Loss: 3.640 Test Acc: 0.089
Validation loss decreased (-0.087025 --> -0.089375).  Saving model ...
Epoch: 6 cost time: 3.643739938735962
Epoch: 6, Steps: 10 | Train Loss: 0.930 Vali Loss: 3.808 Vali Acc: 0.095 Test Loss: 3.808 Test Acc: 0.095
Validation loss decreased (-0.089375 --> -0.095256).  Saving model ...
Epoch: 7 cost time: 3.4145240783691406
Epoch: 7, Steps: 10 | Train Loss: 0.524 Vali Loss: 4.179 Vali Acc: 0.101 Test Loss: 4.179 Test Acc: 0.101
Validation loss decreased (-0.095256 --> -0.101135).  Saving model ...
Epoch: 8 cost time: 3.0560481548309326
Epoch: 8, Steps: 10 | Train Loss: 0.241 Vali Loss: 4.614 Vali Acc: 0.106 Test Loss: 4.614 Test Acc: 0.106
Validation loss decreased (-0.101135 --> -0.105836).  Saving model ...
Epoch: 9 cost time: 3.3064723014831543
Epoch: 9, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.978 Vali Acc: 0.116 Test Loss: 4.978 Test Acc: 0.116
Validation loss decreased (-0.105836 --> -0.116421).  Saving model ...
Epoch: 10 cost time: 3.3866400718688965
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 5.272 Vali Acc: 0.121 Test Loss: 5.272 Test Acc: 0.121
Validation loss decreased (-0.116421 --> -0.121124).  Saving model ...
Epoch: 11 cost time: 3.4427521228790283
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.403 Vali Acc: 0.129 Test Loss: 5.403 Test Acc: 0.129
Validation loss decreased (-0.121124 --> -0.129358).  Saving model ...
Epoch: 12 cost time: 3.216686248779297
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.617 Vali Acc: 0.120 Test Loss: 5.617 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2520933151245117
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.686 Vali Acc: 0.128 Test Loss: 5.686 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3364362716674805
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.786 Vali Acc: 0.125 Test Loss: 5.786 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.5605385303497314
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.813 Vali Acc: 0.122 Test Loss: 5.813 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.6541101932525635
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.832 Vali Acc: 0.129 Test Loss: 5.832 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.553513765335083
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.822 Vali Acc: 0.127 Test Loss: 5.822 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.442474365234375
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.844 Vali Acc: 0.131 Test Loss: 5.844 Test Acc: 0.131
Validation loss decreased (-0.129358 --> -0.130530).  Saving model ...
Epoch: 19 cost time: 3.505582571029663
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.883 Vali Acc: 0.133 Test Loss: 5.883 Test Acc: 0.133
Validation loss decreased (-0.130530 --> -0.132882).  Saving model ...
Epoch: 20 cost time: 3.537374258041382
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.904 Vali Acc: 0.132 Test Loss: 5.904 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.450869083404541
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.914 Vali Acc: 0.132 Test Loss: 5.914 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.192067861557007
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.936 Vali Acc: 0.134 Test Loss: 5.936 Test Acc: 0.134
Validation loss decreased (-0.132882 --> -0.134058).  Saving model ...
Epoch: 23 cost time: 3.173203706741333
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.955 Vali Acc: 0.138 Test Loss: 5.955 Test Acc: 0.138
Validation loss decreased (-0.134058 --> -0.137588).  Saving model ...
Epoch: 24 cost time: 3.0209004878997803
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.977 Vali Acc: 0.141 Test Loss: 5.977 Test Acc: 0.141
Validation loss decreased (-0.137588 --> -0.141117).  Saving model ...
Epoch: 25 cost time: 3.808443307876587
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.991 Vali Acc: 0.141 Test Loss: 5.991 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7842516899108887
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.012 Vali Acc: 0.141 Test Loss: 6.012 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.7199392318725586
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.027 Vali Acc: 0.141 Test Loss: 6.027 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.714031219482422
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.059 Vali Acc: 0.141 Test Loss: 6.059 Test Acc: 0.141
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.742047071456909
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.084 Vali Acc: 0.139 Test Loss: 6.084 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.0684239864349365
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.085 Vali Acc: 0.140 Test Loss: 6.085 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.959871292114258
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.105 Vali Acc: 0.142 Test Loss: 6.105 Test Acc: 0.142
Validation loss decreased (-0.141117 --> -0.142292).  Saving model ...
Epoch: 32 cost time: 3.6723310947418213
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.111 Vali Acc: 0.145 Test Loss: 6.111 Test Acc: 0.145
Validation loss decreased (-0.142292 --> -0.144645).  Saving model ...
Epoch: 33 cost time: 3.676220178604126
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.130 Vali Acc: 0.145 Test Loss: 6.130 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.620016098022461
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.148 Vali Acc: 0.147 Test Loss: 6.148 Test Acc: 0.147
Validation loss decreased (-0.144645 --> -0.146997).  Saving model ...
Epoch: 35 cost time: 3.6827707290649414
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.157 Vali Acc: 0.146 Test Loss: 6.157 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.842892646789551
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.169 Vali Acc: 0.145 Test Loss: 6.169 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.5130667686462402
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.188 Vali Acc: 0.141 Test Loss: 6.188 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.474618673324585
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.209 Vali Acc: 0.139 Test Loss: 6.209 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.950845956802368
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.215 Vali Acc: 0.140 Test Loss: 6.215 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.9626541137695312
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.223 Vali Acc: 0.141 Test Loss: 6.223 Test Acc: 0.141
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.046594619750977
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.232 Vali Acc: 0.141 Test Loss: 6.232 Test Acc: 0.141
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.8191559314727783
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.240 Vali Acc: 0.140 Test Loss: 6.240 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.6209323406219482
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.255 Vali Acc: 0.142 Test Loss: 6.255 Test Acc: 0.142
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.905252456665039
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.268 Vali Acc: 0.142 Test Loss: 6.268 Test Acc: 0.142
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14705882352941177
model parameter : 4041242
model size : 25.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.553757667541504
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.332 Vali Acc: 0.046 Test Loss: 3.332 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 3.454719305038452
Epoch: 2, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.543 Vali Acc: 0.054 Test Loss: 3.543 Test Acc: 0.054
Validation loss decreased (-0.045849 --> -0.054082).  Saving model ...
Epoch: 3 cost time: 3.0927321910858154
Epoch: 3, Steps: 10 | Train Loss: 2.842 Vali Loss: 3.407 Vali Acc: 0.074 Test Loss: 3.407 Test Acc: 0.074
Validation loss decreased (-0.054082 --> -0.074084).  Saving model ...
Epoch: 4 cost time: 3.5573813915252686
Epoch: 4, Steps: 10 | Train Loss: 2.319 Vali Loss: 3.379 Vali Acc: 0.085 Test Loss: 3.379 Test Acc: 0.085
Validation loss decreased (-0.074084 --> -0.084672).  Saving model ...
Epoch: 5 cost time: 3.4450247287750244
Epoch: 5, Steps: 10 | Train Loss: 1.823 Vali Loss: 3.539 Vali Acc: 0.092 Test Loss: 3.539 Test Acc: 0.092
Validation loss decreased (-0.084672 --> -0.091729).  Saving model ...
Epoch: 6 cost time: 3.4381890296936035
Epoch: 6, Steps: 10 | Train Loss: 1.262 Vali Loss: 3.618 Vali Acc: 0.101 Test Loss: 3.618 Test Acc: 0.101
Validation loss decreased (-0.091729 --> -0.101140).  Saving model ...
Epoch: 7 cost time: 3.5632383823394775
Epoch: 7, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.923 Vali Acc: 0.101 Test Loss: 3.923 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.222822666168213
Epoch: 8, Steps: 10 | Train Loss: 0.449 Vali Loss: 4.264 Vali Acc: 0.114 Test Loss: 4.264 Test Acc: 0.114
Validation loss decreased (-0.101140 --> -0.114075).  Saving model ...
Epoch: 9 cost time: 3.341935634613037
Epoch: 9, Steps: 10 | Train Loss: 0.201 Vali Loss: 4.648 Vali Acc: 0.118 Test Loss: 4.648 Test Acc: 0.118
Validation loss decreased (-0.114075 --> -0.117601).  Saving model ...
Epoch: 10 cost time: 3.8473594188690186
Epoch: 10, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.875 Vali Acc: 0.124 Test Loss: 4.875 Test Acc: 0.124
Validation loss decreased (-0.117601 --> -0.123481).  Saving model ...
Epoch: 11 cost time: 3.3671581745147705
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 5.073 Vali Acc: 0.125 Test Loss: 5.073 Test Acc: 0.125
Validation loss decreased (-0.123481 --> -0.124655).  Saving model ...
Epoch: 12 cost time: 3.4631452560424805
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 5.282 Vali Acc: 0.139 Test Loss: 5.282 Test Acc: 0.139
Validation loss decreased (-0.124655 --> -0.138771).  Saving model ...
Epoch: 13 cost time: 3.7096166610717773
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.542 Vali Acc: 0.139 Test Loss: 5.542 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5237624645233154
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.490 Vali Acc: 0.142 Test Loss: 5.490 Test Acc: 0.142
Validation loss decreased (-0.138771 --> -0.142298).  Saving model ...
Epoch: 15 cost time: 4.045071601867676
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.618 Vali Acc: 0.136 Test Loss: 5.618 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.391287088394165
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.791 Vali Acc: 0.136 Test Loss: 5.791 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.500460624694824
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.765 Vali Acc: 0.135 Test Loss: 5.765 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.7771620750427246
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.715 Vali Acc: 0.134 Test Loss: 5.715 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.6199207305908203
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.712 Vali Acc: 0.136 Test Loss: 5.712 Test Acc: 0.136
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5781097412109375
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.715 Vali Acc: 0.135 Test Loss: 5.715 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3785617351531982
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.725 Vali Acc: 0.134 Test Loss: 5.725 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.4799444675445557
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.734 Vali Acc: 0.135 Test Loss: 5.734 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.668912649154663
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.749 Vali Acc: 0.138 Test Loss: 5.749 Test Acc: 0.138
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.247013807296753
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.761 Vali Acc: 0.139 Test Loss: 5.761 Test Acc: 0.139
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1423529411764706
model parameter : 4041242
model size : 25.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.524801731109619
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.339 Vali Acc: 0.053 Test Loss: 3.339 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 3.3771133422851562
Epoch: 2, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.572 Vali Acc: 0.075 Test Loss: 3.572 Test Acc: 0.075
Validation loss decreased (-0.052908 --> -0.075258).  Saving model ...
Epoch: 3 cost time: 3.6511948108673096
Epoch: 3, Steps: 10 | Train Loss: 2.869 Vali Loss: 3.459 Vali Acc: 0.080 Test Loss: 3.459 Test Acc: 0.080
Validation loss decreased (-0.075258 --> -0.079965).  Saving model ...
Epoch: 4 cost time: 3.5487287044525146
Epoch: 4, Steps: 10 | Train Loss: 2.491 Vali Loss: 3.388 Vali Acc: 0.092 Test Loss: 3.388 Test Acc: 0.092
Validation loss decreased (-0.079965 --> -0.091731).  Saving model ...
Epoch: 5 cost time: 3.5994229316711426
Epoch: 5, Steps: 10 | Train Loss: 2.007 Vali Loss: 3.512 Vali Acc: 0.088 Test Loss: 3.512 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3369154930114746
Epoch: 6, Steps: 10 | Train Loss: 1.525 Vali Loss: 3.592 Vali Acc: 0.100 Test Loss: 3.592 Test Acc: 0.100
Validation loss decreased (-0.091731 --> -0.099964).  Saving model ...
Epoch: 7 cost time: 3.2976484298706055
Epoch: 7, Steps: 10 | Train Loss: 1.073 Vali Loss: 3.822 Vali Acc: 0.107 Test Loss: 3.822 Test Acc: 0.107
Validation loss decreased (-0.099964 --> -0.107021).  Saving model ...
Epoch: 8 cost time: 3.751460075378418
Epoch: 8, Steps: 10 | Train Loss: 0.665 Vali Loss: 4.196 Vali Acc: 0.122 Test Loss: 4.196 Test Acc: 0.122
Validation loss decreased (-0.107021 --> -0.122311).  Saving model ...
Epoch: 9 cost time: 3.6361641883850098
Epoch: 9, Steps: 10 | Train Loss: 0.317 Vali Loss: 4.411 Vali Acc: 0.141 Test Loss: 4.411 Test Acc: 0.141
Validation loss decreased (-0.122311 --> -0.141132).  Saving model ...
Epoch: 10 cost time: 3.482451915740967
Epoch: 10, Steps: 10 | Train Loss: 0.141 Vali Loss: 4.816 Vali Acc: 0.153 Test Loss: 4.816 Test Acc: 0.153
Validation loss decreased (-0.141132 --> -0.152893).  Saving model ...
Epoch: 11 cost time: 3.153575897216797
Epoch: 11, Steps: 10 | Train Loss: 0.078 Vali Loss: 5.010 Vali Acc: 0.164 Test Loss: 5.010 Test Acc: 0.164
Validation loss decreased (-0.152893 --> -0.163479).  Saving model ...
Epoch: 12 cost time: 3.2188823223114014
Epoch: 12, Steps: 10 | Train Loss: 0.045 Vali Loss: 5.233 Vali Acc: 0.161 Test Loss: 5.233 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.689866304397583
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.473 Vali Acc: 0.158 Test Loss: 5.473 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6379282474517822
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.598 Vali Acc: 0.151 Test Loss: 5.598 Test Acc: 0.151
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.700124979019165
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.544 Vali Acc: 0.161 Test Loss: 5.544 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.49049711227417
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.582 Vali Acc: 0.164 Test Loss: 5.582 Test Acc: 0.164
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.3662595748901367
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.663 Vali Acc: 0.153 Test Loss: 5.663 Test Acc: 0.153
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.5292255878448486
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.678 Vali Acc: 0.156 Test Loss: 5.678 Test Acc: 0.156
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.834961175918579
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.675 Vali Acc: 0.161 Test Loss: 5.675 Test Acc: 0.161
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.4197568893432617
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.671 Vali Acc: 0.169 Test Loss: 5.671 Test Acc: 0.169
Validation loss decreased (-0.163479 --> -0.169355).  Saving model ...
Epoch: 21 cost time: 3.4809176921844482
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.705 Vali Acc: 0.169 Test Loss: 5.705 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7021026611328125
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.715 Vali Acc: 0.172 Test Loss: 5.715 Test Acc: 0.172
Validation loss decreased (-0.169355 --> -0.171708).  Saving model ...
Epoch: 23 cost time: 3.5972704887390137
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.725 Vali Acc: 0.176 Test Loss: 5.725 Test Acc: 0.176
Validation loss decreased (-0.171708 --> -0.176413).  Saving model ...
Epoch: 24 cost time: 3.74859881401062
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.755 Vali Acc: 0.173 Test Loss: 5.755 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3300204277038574
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.765 Vali Acc: 0.174 Test Loss: 5.765 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3547523021698
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.787 Vali Acc: 0.174 Test Loss: 5.787 Test Acc: 0.174
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.413456439971924
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.792 Vali Acc: 0.171 Test Loss: 5.792 Test Acc: 0.171
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.5574052333831787
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.794 Vali Acc: 0.173 Test Loss: 5.794 Test Acc: 0.173
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.3875744342803955
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.802 Vali Acc: 0.173 Test Loss: 5.802 Test Acc: 0.173
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.5922129154205322
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.793 Vali Acc: 0.172 Test Loss: 5.793 Test Acc: 0.172
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.3531978130340576
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.807 Vali Acc: 0.171 Test Loss: 5.807 Test Acc: 0.171
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.6680617332458496
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.820 Vali Acc: 0.173 Test Loss: 5.820 Test Acc: 0.173
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.837914228439331
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.848 Vali Acc: 0.171 Test Loss: 5.848 Test Acc: 0.171
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17647058823529413
model parameter : 4041242
model size : 25.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.0547637939453125
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 3.864588499069214
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 3 cost time: 3.672093629837036
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 4 cost time: 3.5051167011260986
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 5 cost time: 3.464677095413208
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 6 cost time: 3.498713731765747
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 7 cost time: 3.440711498260498
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 8 cost time: 3.664287567138672
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 9 cost time: 3.7256534099578857
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 10 cost time: 3.6440818309783936
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 11 cost time: 4.023867845535278
Epoch: 11, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 12 cost time: 3.7914271354675293
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 13 cost time: 4.054671287536621
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 14 cost time: 3.788482666015625
Epoch: 14, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 15 cost time: 3.5326342582702637
Epoch: 15, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 16 cost time: 3.403486967086792
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.034085 --> -0.037614).  Saving model ...
Epoch: 17 cost time: 3.779758930206299
Epoch: 17, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 18 cost time: 3.5424985885620117
Epoch: 18, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 19 cost time: 3.4960551261901855
Epoch: 19, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 20 cost time: 3.7852671146392822
Epoch: 20, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 21 cost time: 3.5196187496185303
Epoch: 21, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 22 cost time: 3.9803128242492676
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 23 cost time: 4.007073879241943
Epoch: 23, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 24 cost time: 3.5384976863861084
Epoch: 24, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 25 cost time: 3.659324884414673
Epoch: 25, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 26 cost time: 4.069180965423584
Epoch: 26, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 27 cost time: 3.537853479385376
Epoch: 27, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 28 cost time: 3.7409985065460205
Epoch: 28, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 29 cost time: 3.537283420562744
Epoch: 29, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 30 cost time: 3.5696606636047363
Epoch: 30, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.5872790813446045
Epoch: 31, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 32 cost time: 3.712895631790161
Epoch: 32, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 33 cost time: 3.6614973545074463
Epoch: 33, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 34 cost time: 3.8681695461273193
Epoch: 34, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 35 cost time: 3.86427640914917
Epoch: 35, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 36 cost time: 3.475529432296753
Epoch: 36, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 37 cost time: 3.6152091026306152
Epoch: 37, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 38 cost time: 3.8378827571868896
Epoch: 38, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 39 cost time: 3.927476167678833
Epoch: 39, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.071746349334717
Epoch: 40, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.539245367050171
Epoch: 41, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 42 cost time: 3.5780460834503174
Epoch: 42, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.938262701034546
Epoch: 43, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 44 cost time: 4.114344835281372
Epoch: 44, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 4.0528244972229
Epoch: 45, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.418501377105713
Epoch: 46, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.447744369506836
Epoch: 47, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.5820093154907227
Epoch: 48, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.660309076309204
Epoch: 49, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.5587351322174072
Epoch: 50, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 4.001591205596924
Epoch: 51, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.332977533340454
Epoch: 52, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 4.02451753616333
Epoch: 53, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.03764705882352941
model parameter : 4041242
model size : 25.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.522292375564575
Epoch: 1, Steps: 10 | Train Loss: 3.395 Vali Loss: 3.283 Vali Acc: 0.073 Test Loss: 3.283 Test Acc: 0.073
Validation loss decreased (inf --> -0.072908).  Saving model ...
Epoch: 2 cost time: 3.132826805114746
Epoch: 2, Steps: 10 | Train Loss: 2.686 Vali Loss: 3.369 Vali Acc: 0.142 Test Loss: 3.369 Test Acc: 0.142
Validation loss decreased (-0.072908 --> -0.142319).  Saving model ...
Epoch: 3 cost time: 3.3042612075805664
Epoch: 3, Steps: 10 | Train Loss: 1.780 Vali Loss: 3.169 Vali Acc: 0.216 Test Loss: 3.169 Test Acc: 0.216
Validation loss decreased (-0.142319 --> -0.216439).  Saving model ...
Epoch: 4 cost time: 3.848801851272583
Epoch: 4, Steps: 10 | Train Loss: 0.978 Vali Loss: 3.322 Vali Acc: 0.239 Test Loss: 3.322 Test Acc: 0.239
Validation loss decreased (-0.216439 --> -0.238790).  Saving model ...
Epoch: 5 cost time: 3.2932424545288086
Epoch: 5, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.480 Vali Acc: 0.261 Test Loss: 3.480 Test Acc: 0.261
Validation loss decreased (-0.238790 --> -0.261142).  Saving model ...
Epoch: 6 cost time: 3.5556726455688477
Epoch: 6, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.775 Vali Acc: 0.274 Test Loss: 3.775 Test Acc: 0.274
Validation loss decreased (-0.261142 --> -0.274080).  Saving model ...
Epoch: 7 cost time: 3.445486068725586
Epoch: 7, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.997 Vali Acc: 0.279 Test Loss: 3.997 Test Acc: 0.279
Validation loss decreased (-0.274080 --> -0.278784).  Saving model ...
Epoch: 8 cost time: 3.489983558654785
Epoch: 8, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.144 Vali Acc: 0.264 Test Loss: 4.144 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.952742099761963
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.467 Vali Acc: 0.267 Test Loss: 4.467 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7403616905212402
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.407 Vali Acc: 0.293 Test Loss: 4.407 Test Acc: 0.293
Validation loss decreased (-0.278784 --> -0.292897).  Saving model ...
Epoch: 11 cost time: 3.627660036087036
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.569 Vali Acc: 0.289 Test Loss: 4.569 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3920280933380127
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.519 Vali Acc: 0.296 Test Loss: 4.519 Test Acc: 0.296
Validation loss decreased (-0.292897 --> -0.296425).  Saving model ...
Epoch: 13 cost time: 3.426438093185425
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.593 Vali Acc: 0.298 Test Loss: 4.593 Test Acc: 0.298
Validation loss decreased (-0.296425 --> -0.297601).  Saving model ...
Epoch: 14 cost time: 3.6233315467834473
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.615 Vali Acc: 0.307 Test Loss: 4.615 Test Acc: 0.307
Validation loss decreased (-0.297601 --> -0.307013).  Saving model ...
Epoch: 15 cost time: 3.6256701946258545
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.632 Vali Acc: 0.305 Test Loss: 4.632 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.21455979347229
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.656 Vali Acc: 0.302 Test Loss: 4.656 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.426001787185669
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.663 Vali Acc: 0.305 Test Loss: 4.663 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.5662336349487305
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.669 Vali Acc: 0.308 Test Loss: 4.669 Test Acc: 0.308
Validation loss decreased (-0.307013 --> -0.308189).  Saving model ...
Epoch: 19 cost time: 3.4065604209899902
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.686 Vali Acc: 0.309 Test Loss: 4.686 Test Acc: 0.309
Validation loss decreased (-0.308189 --> -0.309365).  Saving model ...
Epoch: 20 cost time: 3.578542947769165
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.706 Vali Acc: 0.309 Test Loss: 4.706 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2490761280059814
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.716 Vali Acc: 0.312 Test Loss: 4.716 Test Acc: 0.312
Validation loss decreased (-0.309365 --> -0.311718).  Saving model ...
Epoch: 22 cost time: 3.4204001426696777
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.730 Vali Acc: 0.309 Test Loss: 4.730 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6602818965911865
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.742 Vali Acc: 0.312 Test Loss: 4.742 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5189239978790283
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.764 Vali Acc: 0.314 Test Loss: 4.764 Test Acc: 0.314
Validation loss decreased (-0.311718 --> -0.314070).  Saving model ...
Epoch: 25 cost time: 3.480546474456787
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.778 Vali Acc: 0.313 Test Loss: 4.778 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.396676778793335
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.790 Vali Acc: 0.314 Test Loss: 4.790 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2822539806365967
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.804 Vali Acc: 0.314 Test Loss: 4.804 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.5472402572631836
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.813 Vali Acc: 0.316 Test Loss: 4.813 Test Acc: 0.316
Validation loss decreased (-0.314070 --> -0.316422).  Saving model ...
Epoch: 29 cost time: 3.6764755249023438
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.835 Vali Acc: 0.315 Test Loss: 4.835 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.7066383361816406
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.850 Vali Acc: 0.315 Test Loss: 4.850 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.290179491043091
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.863 Vali Acc: 0.316 Test Loss: 4.863 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.4463720321655273
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.876 Vali Acc: 0.315 Test Loss: 4.876 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.6066343784332275
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.894 Vali Acc: 0.313 Test Loss: 4.894 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.884246587753296
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.914 Vali Acc: 0.315 Test Loss: 4.914 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.9014787673950195
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.930 Vali Acc: 0.316 Test Loss: 4.930 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.461683988571167
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.943 Vali Acc: 0.316 Test Loss: 4.943 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.6929614543914795
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.953 Vali Acc: 0.314 Test Loss: 4.953 Test Acc: 0.314
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.7292771339416504
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.962 Vali Acc: 0.313 Test Loss: 4.962 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 3844634
model size : 24.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.000034332275391
Epoch: 1, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.282 Vali Acc: 0.075 Test Loss: 3.282 Test Acc: 0.075
Validation loss decreased (inf --> -0.075261).  Saving model ...
Epoch: 2 cost time: 3.293256998062134
Epoch: 2, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.362 Vali Acc: 0.148 Test Loss: 3.362 Test Acc: 0.148
Validation loss decreased (-0.075261 --> -0.148202).  Saving model ...
Epoch: 3 cost time: 3.2413458824157715
Epoch: 3, Steps: 10 | Train Loss: 1.806 Vali Loss: 3.155 Vali Acc: 0.228 Test Loss: 3.155 Test Acc: 0.228
Validation loss decreased (-0.148202 --> -0.228204).  Saving model ...
Epoch: 4 cost time: 3.3046822547912598
Epoch: 4, Steps: 10 | Train Loss: 0.989 Vali Loss: 3.291 Vali Acc: 0.254 Test Loss: 3.291 Test Acc: 0.254
Validation loss decreased (-0.228204 --> -0.254085).  Saving model ...
Epoch: 5 cost time: 3.6558308601379395
Epoch: 5, Steps: 10 | Train Loss: 0.492 Vali Loss: 3.443 Vali Acc: 0.291 Test Loss: 3.443 Test Acc: 0.291
Validation loss decreased (-0.254085 --> -0.290554).  Saving model ...
Epoch: 6 cost time: 3.385786533355713
Epoch: 6, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.838 Vali Acc: 0.282 Test Loss: 3.838 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3319039344787598
Epoch: 7, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.008 Vali Acc: 0.286 Test Loss: 4.008 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.381927967071533
Epoch: 8, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.135 Vali Acc: 0.311 Test Loss: 4.135 Test Acc: 0.311
Validation loss decreased (-0.290554 --> -0.310547).  Saving model ...
Epoch: 9 cost time: 3.3680412769317627
Epoch: 9, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.456 Vali Acc: 0.296 Test Loss: 4.456 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.610893487930298
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.483 Vali Acc: 0.305 Test Loss: 4.483 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.795780658721924
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.604 Vali Acc: 0.305 Test Loss: 4.604 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.236569881439209
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.534 Vali Acc: 0.325 Test Loss: 4.534 Test Acc: 0.325
Validation loss decreased (-0.310547 --> -0.324661).  Saving model ...
Epoch: 13 cost time: 3.2477123737335205
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.566 Vali Acc: 0.326 Test Loss: 4.566 Test Acc: 0.326
Validation loss decreased (-0.324661 --> -0.325837).  Saving model ...
Epoch: 14 cost time: 3.274542808532715
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.586 Vali Acc: 0.322 Test Loss: 4.586 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6165738105773926
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.604 Vali Acc: 0.329 Test Loss: 4.604 Test Acc: 0.329
Validation loss decreased (-0.325837 --> -0.329366).  Saving model ...
Epoch: 16 cost time: 3.514864206314087
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.627 Vali Acc: 0.329 Test Loss: 4.627 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.394470691680908
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.643 Vali Acc: 0.328 Test Loss: 4.643 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.562469959259033
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.657 Vali Acc: 0.327 Test Loss: 4.657 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.468534231185913
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.682 Vali Acc: 0.327 Test Loss: 4.682 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.782738208770752
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.709 Vali Acc: 0.324 Test Loss: 4.709 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.535062551498413
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.726 Vali Acc: 0.324 Test Loss: 4.726 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.1245498657226562
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.740 Vali Acc: 0.322 Test Loss: 4.740 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.532421112060547
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.760 Vali Acc: 0.320 Test Loss: 4.760 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.550577163696289
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.781 Vali Acc: 0.325 Test Loss: 4.781 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.7358360290527344
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.797 Vali Acc: 0.322 Test Loss: 4.797 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 3844634
model size : 24.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.630082845687866
Epoch: 1, Steps: 10 | Train Loss: 3.414 Vali Loss: 3.270 Vali Acc: 0.082 Test Loss: 3.270 Test Acc: 0.082
Validation loss decreased (inf --> -0.082320).  Saving model ...
Epoch: 2 cost time: 3.412442445755005
Epoch: 2, Steps: 10 | Train Loss: 2.665 Vali Loss: 3.391 Vali Acc: 0.165 Test Loss: 3.391 Test Acc: 0.165
Validation loss decreased (-0.082320 --> -0.164672).  Saving model ...
Epoch: 3 cost time: 3.555462598800659
Epoch: 3, Steps: 10 | Train Loss: 1.821 Vali Loss: 3.273 Vali Acc: 0.234 Test Loss: 3.273 Test Acc: 0.234
Validation loss decreased (-0.164672 --> -0.234085).  Saving model ...
Epoch: 4 cost time: 3.8226747512817383
Epoch: 4, Steps: 10 | Train Loss: 1.073 Vali Loss: 3.416 Vali Acc: 0.248 Test Loss: 3.416 Test Acc: 0.248
Validation loss decreased (-0.234085 --> -0.248201).  Saving model ...
Epoch: 5 cost time: 3.8193929195404053
Epoch: 5, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.553 Vali Acc: 0.295 Test Loss: 3.553 Test Acc: 0.295
Validation loss decreased (-0.248201 --> -0.295259).  Saving model ...
Epoch: 6 cost time: 3.630592107772827
Epoch: 6, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.892 Vali Acc: 0.256 Test Loss: 3.892 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.581796646118164
Epoch: 7, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.987 Vali Acc: 0.285 Test Loss: 3.987 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6782851219177246
Epoch: 8, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.176 Vali Acc: 0.294 Test Loss: 4.176 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.564980983734131
Epoch: 9, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.522 Vali Acc: 0.285 Test Loss: 4.522 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.449169397354126
Epoch: 10, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.516 Vali Acc: 0.301 Test Loss: 4.516 Test Acc: 0.301
Validation loss decreased (-0.295259 --> -0.301131).  Saving model ...
Epoch: 11 cost time: 3.7050437927246094
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.752 Vali Acc: 0.311 Test Loss: 4.752 Test Acc: 0.311
Validation loss decreased (-0.301131 --> -0.310541).  Saving model ...
Epoch: 12 cost time: 3.649019479751587
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.854 Vali Acc: 0.307 Test Loss: 4.854 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6785387992858887
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.729 Vali Acc: 0.325 Test Loss: 4.729 Test Acc: 0.325
Validation loss decreased (-0.310541 --> -0.324659).  Saving model ...
Epoch: 14 cost time: 3.420943021774292
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.737 Vali Acc: 0.321 Test Loss: 4.737 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2760250568389893
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.782 Vali Acc: 0.315 Test Loss: 4.782 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5354115962982178
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.802 Vali Acc: 0.318 Test Loss: 4.802 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.792801856994629
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.820 Vali Acc: 0.322 Test Loss: 4.820 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.607177257537842
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.842 Vali Acc: 0.322 Test Loss: 4.842 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.895758628845215
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.865 Vali Acc: 0.324 Test Loss: 4.865 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.435645580291748
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.889 Vali Acc: 0.320 Test Loss: 4.889 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.5399532318115234
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.907 Vali Acc: 0.324 Test Loss: 4.907 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.8095946311950684
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.927 Vali Acc: 0.321 Test Loss: 4.927 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.4276905059814453
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.946 Vali Acc: 0.321 Test Loss: 4.946 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 3844634
model size : 24.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.816505670547485
Epoch: 1, Steps: 10 | Train Loss: 3.418 Vali Loss: 3.288 Vali Acc: 0.087 Test Loss: 3.288 Test Acc: 0.087
Validation loss decreased (inf --> -0.087026).  Saving model ...
Epoch: 2 cost time: 3.6898200511932373
Epoch: 2, Steps: 10 | Train Loss: 2.728 Vali Loss: 3.472 Vali Acc: 0.132 Test Loss: 3.472 Test Acc: 0.132
Validation loss decreased (-0.087026 --> -0.131730).  Saving model ...
Epoch: 3 cost time: 4.107801675796509
Epoch: 3, Steps: 10 | Train Loss: 1.916 Vali Loss: 3.403 Vali Acc: 0.161 Test Loss: 3.403 Test Acc: 0.161
Validation loss decreased (-0.131730 --> -0.161142).  Saving model ...
Epoch: 4 cost time: 3.883523464202881
Epoch: 4, Steps: 10 | Train Loss: 1.179 Vali Loss: 3.615 Vali Acc: 0.182 Test Loss: 3.615 Test Acc: 0.182
Validation loss decreased (-0.161142 --> -0.182317).  Saving model ...
Epoch: 5 cost time: 3.4962210655212402
Epoch: 5, Steps: 10 | Train Loss: 0.684 Vali Loss: 3.811 Vali Acc: 0.212 Test Loss: 3.811 Test Acc: 0.212
Validation loss decreased (-0.182317 --> -0.211727).  Saving model ...
Epoch: 6 cost time: 3.9514479637145996
Epoch: 6, Steps: 10 | Train Loss: 0.375 Vali Loss: 4.124 Vali Acc: 0.213 Test Loss: 4.124 Test Acc: 0.213
Validation loss decreased (-0.211727 --> -0.212900).  Saving model ...
Epoch: 7 cost time: 4.154094219207764
Epoch: 7, Steps: 10 | Train Loss: 0.255 Vali Loss: 4.337 Vali Acc: 0.236 Test Loss: 4.337 Test Acc: 0.236
Validation loss decreased (-0.212900 --> -0.236427).  Saving model ...
Epoch: 8 cost time: 3.8504886627197266
Epoch: 8, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.613 Vali Acc: 0.216 Test Loss: 4.613 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.462115526199341
Epoch: 9, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.799 Vali Acc: 0.241 Test Loss: 4.799 Test Acc: 0.241
Validation loss decreased (-0.236427 --> -0.241128).  Saving model ...
Epoch: 10 cost time: 3.4471371173858643
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.864 Vali Acc: 0.254 Test Loss: 4.864 Test Acc: 0.254
Validation loss decreased (-0.241128 --> -0.254069).  Saving model ...
Epoch: 11 cost time: 3.6512911319732666
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 5.073 Vali Acc: 0.245 Test Loss: 5.073 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.869340419769287
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.185 Vali Acc: 0.253 Test Loss: 5.185 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8828017711639404
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 5.313 Vali Acc: 0.251 Test Loss: 5.313 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.883850574493408
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.353 Vali Acc: 0.256 Test Loss: 5.353 Test Acc: 0.256
Validation loss decreased (-0.254069 --> -0.256417).  Saving model ...
Epoch: 15 cost time: 3.9681153297424316
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.440 Vali Acc: 0.258 Test Loss: 5.440 Test Acc: 0.258
Validation loss decreased (-0.256417 --> -0.257593).  Saving model ...
Epoch: 16 cost time: 3.8224668502807617
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.435 Vali Acc: 0.258 Test Loss: 5.435 Test Acc: 0.258
Validation loss decreased (-0.257593 --> -0.257593).  Saving model ...
Epoch: 17 cost time: 3.7269511222839355
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.402 Vali Acc: 0.262 Test Loss: 5.402 Test Acc: 0.262
Validation loss decreased (-0.257593 --> -0.262299).  Saving model ...
Epoch: 18 cost time: 3.771183729171753
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.422 Vali Acc: 0.267 Test Loss: 5.422 Test Acc: 0.267
Validation loss decreased (-0.262299 --> -0.267005).  Saving model ...
Epoch: 19 cost time: 3.9025371074676514
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.444 Vali Acc: 0.266 Test Loss: 5.444 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.691260576248169
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.465 Vali Acc: 0.268 Test Loss: 5.465 Test Acc: 0.268
Validation loss decreased (-0.267005 --> -0.268181).  Saving model ...
Epoch: 21 cost time: 3.6617588996887207
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.481 Vali Acc: 0.271 Test Loss: 5.481 Test Acc: 0.271
Validation loss decreased (-0.268181 --> -0.270533).  Saving model ...
Epoch: 22 cost time: 3.342470407485962
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.497 Vali Acc: 0.269 Test Loss: 5.497 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.441969871520996
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.512 Vali Acc: 0.266 Test Loss: 5.512 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.603731393814087
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.538 Vali Acc: 0.266 Test Loss: 5.538 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.603187084197998
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.556 Vali Acc: 0.266 Test Loss: 5.556 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.002614498138428
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.573 Vali Acc: 0.266 Test Loss: 5.573 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.5335137844085693
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.587 Vali Acc: 0.265 Test Loss: 5.587 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.7326533794403076
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.599 Vali Acc: 0.267 Test Loss: 5.599 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.8993000984191895
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.617 Vali Acc: 0.267 Test Loss: 5.617 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.811687469482422
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.634 Vali Acc: 0.265 Test Loss: 5.634 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.875288963317871
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.644 Vali Acc: 0.266 Test Loss: 5.644 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 3844634
model size : 24.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.978841543197632
Epoch: 1, Steps: 10 | Train Loss: 3.432 Vali Loss: 3.333 Vali Acc: 0.047 Test Loss: 3.333 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 3.803682327270508
Epoch: 2, Steps: 10 | Train Loss: 2.836 Vali Loss: 3.547 Vali Acc: 0.080 Test Loss: 3.547 Test Acc: 0.080
Validation loss decreased (-0.047025 --> -0.079965).  Saving model ...
Epoch: 3 cost time: 3.5186665058135986
Epoch: 3, Steps: 10 | Train Loss: 2.028 Vali Loss: 3.441 Vali Acc: 0.096 Test Loss: 3.441 Test Acc: 0.096
Validation loss decreased (-0.079965 --> -0.096436).  Saving model ...
Epoch: 4 cost time: 3.7201895713806152
Epoch: 4, Steps: 10 | Train Loss: 1.232 Vali Loss: 3.593 Vali Acc: 0.115 Test Loss: 3.593 Test Acc: 0.115
Validation loss decreased (-0.096436 --> -0.115258).  Saving model ...
Epoch: 5 cost time: 3.5571610927581787
Epoch: 5, Steps: 10 | Train Loss: 0.649 Vali Loss: 3.906 Vali Acc: 0.134 Test Loss: 3.906 Test Acc: 0.134
Validation loss decreased (-0.115258 --> -0.134079).  Saving model ...
Epoch: 6 cost time: 3.996349573135376
Epoch: 6, Steps: 10 | Train Loss: 0.298 Vali Loss: 4.363 Vali Acc: 0.116 Test Loss: 4.363 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.018052577972412
Epoch: 7, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.624 Vali Acc: 0.139 Test Loss: 4.624 Test Acc: 0.139
Validation loss decreased (-0.134079 --> -0.138777).  Saving model ...
Epoch: 8 cost time: 3.719269275665283
Epoch: 8, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.872 Vali Acc: 0.135 Test Loss: 4.872 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4773600101470947
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 5.349 Vali Acc: 0.128 Test Loss: 5.349 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0970349311828613
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.329 Vali Acc: 0.144 Test Loss: 5.329 Test Acc: 0.144
Validation loss decreased (-0.138777 --> -0.143476).  Saving model ...
Epoch: 11 cost time: 3.7619729042053223
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.318 Vali Acc: 0.156 Test Loss: 5.318 Test Acc: 0.156
Validation loss decreased (-0.143476 --> -0.156417).  Saving model ...
Epoch: 12 cost time: 3.785933256149292
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.396 Vali Acc: 0.151 Test Loss: 5.396 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.664238452911377
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.471 Vali Acc: 0.158 Test Loss: 5.471 Test Acc: 0.158
Validation loss decreased (-0.156417 --> -0.157592).  Saving model ...
Epoch: 14 cost time: 3.5131804943084717
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.529 Vali Acc: 0.151 Test Loss: 5.529 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8304038047790527
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.571 Vali Acc: 0.149 Test Loss: 5.571 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.742600440979004
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.607 Vali Acc: 0.149 Test Loss: 5.607 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.989736318588257
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.626 Vali Acc: 0.152 Test Loss: 5.626 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.597449779510498
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.650 Vali Acc: 0.153 Test Loss: 5.650 Test Acc: 0.153
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.9915335178375244
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.684 Vali Acc: 0.152 Test Loss: 5.684 Test Acc: 0.152
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.362705230712891
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.716 Vali Acc: 0.156 Test Loss: 5.716 Test Acc: 0.156
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.7025887966156006
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.736 Vali Acc: 0.159 Test Loss: 5.736 Test Acc: 0.159
Validation loss decreased (-0.157592 --> -0.158766).  Saving model ...
Epoch: 22 cost time: 3.7780253887176514
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.767 Vali Acc: 0.159 Test Loss: 5.767 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.8728954792022705
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.802 Vali Acc: 0.160 Test Loss: 5.802 Test Acc: 0.160
Validation loss decreased (-0.158766 --> -0.159942).  Saving model ...
Epoch: 24 cost time: 4.094437122344971
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.834 Vali Acc: 0.158 Test Loss: 5.834 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.075401067733765
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.852 Vali Acc: 0.160 Test Loss: 5.852 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.9173407554626465
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.870 Vali Acc: 0.161 Test Loss: 5.870 Test Acc: 0.161
Validation loss decreased (-0.159942 --> -0.161118).  Saving model ...
Epoch: 27 cost time: 3.24267840385437
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.892 Vali Acc: 0.155 Test Loss: 5.892 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3911118507385254
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.915 Vali Acc: 0.155 Test Loss: 5.915 Test Acc: 0.155
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.8187875747680664
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.944 Vali Acc: 0.158 Test Loss: 5.944 Test Acc: 0.158
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.041512489318848
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.969 Vali Acc: 0.155 Test Loss: 5.969 Test Acc: 0.155
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.541011333465576
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.990 Vali Acc: 0.154 Test Loss: 5.990 Test Acc: 0.154
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.022530555725098
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.001 Vali Acc: 0.158 Test Loss: 6.001 Test Acc: 0.158
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.9856176376342773
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.019 Vali Acc: 0.159 Test Loss: 6.019 Test Acc: 0.159
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.645432949066162
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.045 Vali Acc: 0.158 Test Loss: 6.045 Test Acc: 0.158
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.7531578540802
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.068 Vali Acc: 0.159 Test Loss: 6.068 Test Acc: 0.159
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.2084128856658936
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.082 Vali Acc: 0.158 Test Loss: 6.082 Test Acc: 0.158
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16117647058823528
model parameter : 3844634
model size : 24.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.949657917022705
Epoch: 1, Steps: 10 | Train Loss: 3.411 Vali Loss: 3.346 Vali Acc: 0.041 Test Loss: 3.346 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 3.7419047355651855
Epoch: 2, Steps: 10 | Train Loss: 2.958 Vali Loss: 3.530 Vali Acc: 0.051 Test Loss: 3.530 Test Acc: 0.051
Validation loss decreased (-0.041143 --> -0.050553).  Saving model ...
Epoch: 3 cost time: 3.569672107696533
Epoch: 3, Steps: 10 | Train Loss: 2.330 Vali Loss: 3.427 Vali Acc: 0.060 Test Loss: 3.427 Test Acc: 0.060
Validation loss decreased (-0.050553 --> -0.059966).  Saving model ...
Epoch: 4 cost time: 3.5400187969207764
Epoch: 4, Steps: 10 | Train Loss: 1.618 Vali Loss: 3.483 Vali Acc: 0.067 Test Loss: 3.483 Test Acc: 0.067
Validation loss decreased (-0.059966 --> -0.067024).  Saving model ...
Epoch: 5 cost time: 3.903449535369873
Epoch: 5, Steps: 10 | Train Loss: 0.974 Vali Loss: 3.707 Vali Acc: 0.080 Test Loss: 3.707 Test Acc: 0.080
Validation loss decreased (-0.067024 --> -0.079963).  Saving model ...
Epoch: 6 cost time: 3.965939521789551
Epoch: 6, Steps: 10 | Train Loss: 0.532 Vali Loss: 4.016 Vali Acc: 0.086 Test Loss: 4.016 Test Acc: 0.086
Validation loss decreased (-0.079963 --> -0.085842).  Saving model ...
Epoch: 7 cost time: 3.651223659515381
Epoch: 7, Steps: 10 | Train Loss: 0.251 Vali Loss: 4.277 Vali Acc: 0.101 Test Loss: 4.277 Test Acc: 0.101
Validation loss decreased (-0.085842 --> -0.101134).  Saving model ...
Epoch: 8 cost time: 3.5925607681274414
Epoch: 8, Steps: 10 | Train Loss: 0.102 Vali Loss: 4.727 Vali Acc: 0.099 Test Loss: 4.727 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.438770055770874
Epoch: 9, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.999 Vali Acc: 0.113 Test Loss: 4.999 Test Acc: 0.113
Validation loss decreased (-0.101134 --> -0.112891).  Saving model ...
Epoch: 10 cost time: 3.8128602504730225
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.149 Vali Acc: 0.107 Test Loss: 5.149 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.622603178024292
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.266 Vali Acc: 0.106 Test Loss: 5.266 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2664883136749268
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.373 Vali Acc: 0.116 Test Loss: 5.373 Test Acc: 0.116
Validation loss decreased (-0.112891 --> -0.116417).  Saving model ...
Epoch: 13 cost time: 3.2546494007110596
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.446 Vali Acc: 0.120 Test Loss: 5.446 Test Acc: 0.120
Validation loss decreased (-0.116417 --> -0.119946).  Saving model ...
Epoch: 14 cost time: 3.1573007106781006
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.500 Vali Acc: 0.120 Test Loss: 5.500 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.55026912689209
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.525 Vali Acc: 0.121 Test Loss: 5.525 Test Acc: 0.121
Validation loss decreased (-0.119946 --> -0.121121).  Saving model ...
Epoch: 16 cost time: 3.8398420810699463
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.564 Vali Acc: 0.120 Test Loss: 5.564 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.167505979537964
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.598 Vali Acc: 0.116 Test Loss: 5.598 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8870038986206055
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.625 Vali Acc: 0.118 Test Loss: 5.625 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.3132524490356445
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.660 Vali Acc: 0.119 Test Loss: 5.660 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.5870742797851562
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.697 Vali Acc: 0.118 Test Loss: 5.697 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.9186525344848633
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.726 Vali Acc: 0.116 Test Loss: 5.726 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.6418259143829346
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.751 Vali Acc: 0.118 Test Loss: 5.751 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.4681897163391113
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.780 Vali Acc: 0.116 Test Loss: 5.780 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.446971893310547
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.809 Vali Acc: 0.119 Test Loss: 5.809 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.484255075454712
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.820 Vali Acc: 0.127 Test Loss: 5.820 Test Acc: 0.127
Validation loss decreased (-0.121121 --> -0.127001).  Saving model ...
Epoch: 26 cost time: 3.338028907775879
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.834 Vali Acc: 0.124 Test Loss: 5.834 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.687565803527832
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.849 Vali Acc: 0.127 Test Loss: 5.849 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.602735757827759
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.866 Vali Acc: 0.127 Test Loss: 5.866 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.702548027038574
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.892 Vali Acc: 0.129 Test Loss: 5.892 Test Acc: 0.129
Validation loss decreased (-0.127001 --> -0.129353).  Saving model ...
Epoch: 30 cost time: 3.68072247505188
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.915 Vali Acc: 0.127 Test Loss: 5.915 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.5440428256988525
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.938 Vali Acc: 0.124 Test Loss: 5.938 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.6249382495880127
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.948 Vali Acc: 0.124 Test Loss: 5.948 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.7057862281799316
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.960 Vali Acc: 0.125 Test Loss: 5.960 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.6226871013641357
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.978 Vali Acc: 0.125 Test Loss: 5.978 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.4022974967956543
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.995 Vali Acc: 0.124 Test Loss: 5.995 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.7655954360961914
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.005 Vali Acc: 0.124 Test Loss: 6.005 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.6459550857543945
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.022 Vali Acc: 0.124 Test Loss: 6.022 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.7768571376800537
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.040 Vali Acc: 0.127 Test Loss: 6.040 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.8158111572265625
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.062 Vali Acc: 0.127 Test Loss: 6.062 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12941176470588237
model parameter : 3844634
model size : 24.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.728564500808716
Epoch: 1, Steps: 10 | Train Loss: 3.434 Vali Loss: 3.345 Vali Acc: 0.041 Test Loss: 3.345 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 3.5124075412750244
Epoch: 2, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.525 Vali Acc: 0.058 Test Loss: 3.525 Test Acc: 0.058
Validation loss decreased (-0.041143 --> -0.057612).  Saving model ...
Epoch: 3 cost time: 3.4077608585357666
Epoch: 3, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.441 Vali Acc: 0.067 Test Loss: 3.441 Test Acc: 0.067
Validation loss decreased (-0.057612 --> -0.067024).  Saving model ...
Epoch: 4 cost time: 4.064067125320435
Epoch: 4, Steps: 10 | Train Loss: 2.071 Vali Loss: 3.403 Vali Acc: 0.074 Test Loss: 3.403 Test Acc: 0.074
Validation loss decreased (-0.067024 --> -0.074084).  Saving model ...
Epoch: 5 cost time: 3.8049449920654297
Epoch: 5, Steps: 10 | Train Loss: 1.484 Vali Loss: 3.568 Vali Acc: 0.095 Test Loss: 3.568 Test Acc: 0.095
Validation loss decreased (-0.074084 --> -0.095258).  Saving model ...
Epoch: 6 cost time: 3.7278530597686768
Epoch: 6, Steps: 10 | Train Loss: 0.957 Vali Loss: 3.864 Vali Acc: 0.096 Test Loss: 3.864 Test Acc: 0.096
Validation loss decreased (-0.095258 --> -0.096432).  Saving model ...
Epoch: 7 cost time: 3.9237241744995117
Epoch: 7, Steps: 10 | Train Loss: 0.536 Vali Loss: 4.227 Vali Acc: 0.106 Test Loss: 4.227 Test Acc: 0.106
Validation loss decreased (-0.096432 --> -0.105840).  Saving model ...
Epoch: 8 cost time: 4.103765964508057
Epoch: 8, Steps: 10 | Train Loss: 0.266 Vali Loss: 4.666 Vali Acc: 0.098 Test Loss: 4.666 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5361220836639404
Epoch: 9, Steps: 10 | Train Loss: 0.134 Vali Loss: 5.027 Vali Acc: 0.108 Test Loss: 5.027 Test Acc: 0.108
Validation loss decreased (-0.105840 --> -0.108185).  Saving model ...
Epoch: 10 cost time: 3.4419455528259277
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 5.144 Vali Acc: 0.108 Test Loss: 5.144 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6183910369873047
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 5.443 Vali Acc: 0.129 Test Loss: 5.443 Test Acc: 0.129
Validation loss decreased (-0.108185 --> -0.129357).  Saving model ...
Epoch: 12 cost time: 3.870297908782959
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.574 Vali Acc: 0.134 Test Loss: 5.574 Test Acc: 0.134
Validation loss decreased (-0.129357 --> -0.134062).  Saving model ...
Epoch: 13 cost time: 4.065958023071289
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.731 Vali Acc: 0.132 Test Loss: 5.731 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.617957830429077
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.763 Vali Acc: 0.129 Test Loss: 5.763 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6111397743225098
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.822 Vali Acc: 0.134 Test Loss: 5.822 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.253347396850586
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.797 Vali Acc: 0.141 Test Loss: 5.797 Test Acc: 0.141
Validation loss decreased (-0.134062 --> -0.141118).  Saving model ...
Epoch: 17 cost time: 4.3714118003845215
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.859 Vali Acc: 0.135 Test Loss: 5.859 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.743204355239868
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.881 Vali Acc: 0.133 Test Loss: 5.881 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3456597328186035
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.890 Vali Acc: 0.135 Test Loss: 5.890 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.9328763484954834
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.924 Vali Acc: 0.139 Test Loss: 5.924 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.7796595096588135
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.938 Vali Acc: 0.136 Test Loss: 5.938 Test Acc: 0.136
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.036761999130249
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.959 Vali Acc: 0.136 Test Loss: 5.959 Test Acc: 0.136
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.683319568634033
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.001 Vali Acc: 0.141 Test Loss: 6.001 Test Acc: 0.141
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.5861427783966064
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.029 Vali Acc: 0.140 Test Loss: 6.029 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.673072576522827
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.049 Vali Acc: 0.136 Test Loss: 6.049 Test Acc: 0.136
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.082570552825928
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.063 Vali Acc: 0.141 Test Loss: 6.063 Test Acc: 0.141
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1411764705882353
model parameter : 3844634
model size : 24.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.0039026737213135
Epoch: 1, Steps: 10 | Train Loss: 3.431 Vali Loss: 3.335 Vali Acc: 0.040 Test Loss: 3.335 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.7762341499328613
Epoch: 2, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.535 Vali Acc: 0.061 Test Loss: 3.535 Test Acc: 0.061
Validation loss decreased (-0.039967 --> -0.061141).  Saving model ...
Epoch: 3 cost time: 3.8061680793762207
Epoch: 3, Steps: 10 | Train Loss: 2.798 Vali Loss: 3.453 Vali Acc: 0.075 Test Loss: 3.453 Test Acc: 0.075
Validation loss decreased (-0.061141 --> -0.075260).  Saving model ...
Epoch: 4 cost time: 3.6468939781188965
Epoch: 4, Steps: 10 | Train Loss: 2.327 Vali Loss: 3.373 Vali Acc: 0.080 Test Loss: 3.373 Test Acc: 0.080
Validation loss decreased (-0.075260 --> -0.079966).  Saving model ...
Epoch: 5 cost time: 3.707629919052124
Epoch: 5, Steps: 10 | Train Loss: 1.827 Vali Loss: 3.513 Vali Acc: 0.093 Test Loss: 3.513 Test Acc: 0.093
Validation loss decreased (-0.079966 --> -0.092906).  Saving model ...
Epoch: 6 cost time: 3.2887468338012695
Epoch: 6, Steps: 10 | Train Loss: 1.324 Vali Loss: 3.782 Vali Acc: 0.093 Test Loss: 3.782 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1284942626953125
Epoch: 7, Steps: 10 | Train Loss: 0.851 Vali Loss: 4.090 Vali Acc: 0.096 Test Loss: 4.090 Test Acc: 0.096
Validation loss decreased (-0.092906 --> -0.096430).  Saving model ...
Epoch: 8 cost time: 3.5805530548095703
Epoch: 8, Steps: 10 | Train Loss: 0.496 Vali Loss: 4.422 Vali Acc: 0.095 Test Loss: 4.422 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6420836448669434
Epoch: 9, Steps: 10 | Train Loss: 0.257 Vali Loss: 4.737 Vali Acc: 0.113 Test Loss: 4.737 Test Acc: 0.113
Validation loss decreased (-0.096430 --> -0.112894).  Saving model ...
Epoch: 10 cost time: 3.5100040435791016
Epoch: 10, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.904 Vali Acc: 0.121 Test Loss: 4.904 Test Acc: 0.121
Validation loss decreased (-0.112894 --> -0.121127).  Saving model ...
Epoch: 11 cost time: 3.3475122451782227
Epoch: 11, Steps: 10 | Train Loss: 0.056 Vali Loss: 5.230 Vali Acc: 0.124 Test Loss: 5.230 Test Acc: 0.124
Validation loss decreased (-0.121127 --> -0.123477).  Saving model ...
Epoch: 12 cost time: 3.7831156253814697
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 5.445 Vali Acc: 0.126 Test Loss: 5.445 Test Acc: 0.126
Validation loss decreased (-0.123477 --> -0.125828).  Saving model ...
Epoch: 13 cost time: 3.7587170600891113
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.572 Vali Acc: 0.132 Test Loss: 5.572 Test Acc: 0.132
Validation loss decreased (-0.125828 --> -0.131709).  Saving model ...
Epoch: 14 cost time: 3.93339467048645
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.593 Vali Acc: 0.134 Test Loss: 5.593 Test Acc: 0.134
Validation loss decreased (-0.131709 --> -0.134062).  Saving model ...
Epoch: 15 cost time: 3.5221445560455322
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.612 Vali Acc: 0.135 Test Loss: 5.612 Test Acc: 0.135
Validation loss decreased (-0.134062 --> -0.135238).  Saving model ...
Epoch: 16 cost time: 3.9699227809906006
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.656 Vali Acc: 0.127 Test Loss: 5.656 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7258388996124268
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.659 Vali Acc: 0.128 Test Loss: 5.659 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.709026336669922
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.749 Vali Acc: 0.135 Test Loss: 5.749 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.707606315612793
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.715 Vali Acc: 0.135 Test Loss: 5.715 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.6464695930480957
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.820 Vali Acc: 0.132 Test Loss: 5.820 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.480515480041504
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.826 Vali Acc: 0.133 Test Loss: 5.826 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.070692777633667
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.821 Vali Acc: 0.134 Test Loss: 5.821 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.894993782043457
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.846 Vali Acc: 0.131 Test Loss: 5.846 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.034032106399536
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.880 Vali Acc: 0.138 Test Loss: 5.880 Test Acc: 0.138
Validation loss decreased (-0.135238 --> -0.137588).  Saving model ...
Epoch: 25 cost time: 4.09993052482605
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.917 Vali Acc: 0.136 Test Loss: 5.917 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.9425079822540283
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.927 Vali Acc: 0.136 Test Loss: 5.927 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.026087999343872
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.936 Vali Acc: 0.135 Test Loss: 5.936 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.687894105911255
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.955 Vali Acc: 0.135 Test Loss: 5.955 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.6228699684143066
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.972 Vali Acc: 0.135 Test Loss: 5.972 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.3724093437194824
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.983 Vali Acc: 0.139 Test Loss: 5.983 Test Acc: 0.139
Validation loss decreased (-0.137588 --> -0.138764).  Saving model ...
Epoch: 31 cost time: 3.5544912815093994
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.996 Vali Acc: 0.140 Test Loss: 5.996 Test Acc: 0.140
Validation loss decreased (-0.138764 --> -0.139940).  Saving model ...
Epoch: 32 cost time: 4.059463262557983
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.009 Vali Acc: 0.138 Test Loss: 6.009 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.8602170944213867
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.030 Vali Acc: 0.139 Test Loss: 6.030 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.747605085372925
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.054 Vali Acc: 0.136 Test Loss: 6.054 Test Acc: 0.136
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.626452922821045
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.063 Vali Acc: 0.139 Test Loss: 6.063 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 4.133131980895996
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.061 Vali Acc: 0.140 Test Loss: 6.061 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.892184257507324
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.076 Vali Acc: 0.140 Test Loss: 6.076 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.729339122772217
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.090 Vali Acc: 0.142 Test Loss: 6.090 Test Acc: 0.142
Validation loss decreased (-0.139940 --> -0.142292).  Saving model ...
Epoch: 39 cost time: 4.050684452056885
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.113 Vali Acc: 0.144 Test Loss: 6.113 Test Acc: 0.144
Validation loss decreased (-0.142292 --> -0.143468).  Saving model ...
Epoch: 40 cost time: 3.9640698432922363
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.127 Vali Acc: 0.142 Test Loss: 6.127 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.186435222625732
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.132 Vali Acc: 0.144 Test Loss: 6.132 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.716254472732544
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.140 Vali Acc: 0.145 Test Loss: 6.140 Test Acc: 0.145
Validation loss decreased (-0.143468 --> -0.144644).  Saving model ...
Epoch: 43 cost time: 5.212467670440674
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.147 Vali Acc: 0.144 Test Loss: 6.147 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 5.050044775009155
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.165 Vali Acc: 0.140 Test Loss: 6.165 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 5.268922567367554
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.182 Vali Acc: 0.141 Test Loss: 6.182 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 5.39799690246582
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.201 Vali Acc: 0.142 Test Loss: 6.201 Test Acc: 0.142
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 4.932375192642212
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.216 Vali Acc: 0.142 Test Loss: 6.216 Test Acc: 0.142
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 4.687402963638306
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.221 Vali Acc: 0.140 Test Loss: 6.221 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 4.931534290313721
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.233 Vali Acc: 0.139 Test Loss: 6.233 Test Acc: 0.139
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 5.236391067504883
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.246 Vali Acc: 0.140 Test Loss: 6.246 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 5.68376612663269
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.260 Vali Acc: 0.140 Test Loss: 6.260 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 6.333250999450684
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.273 Vali Acc: 0.142 Test Loss: 6.273 Test Acc: 0.142
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14470588235294118
model parameter : 3844634
model size : 24.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.648689270019531
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.325 Vali Acc: 0.044 Test Loss: 3.325 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 5.7647504806518555
Epoch: 2, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.551 Vali Acc: 0.052 Test Loss: 3.551 Test Acc: 0.052
Validation loss decreased (-0.043496 --> -0.051729).  Saving model ...
Epoch: 3 cost time: 4.7938244342803955
Epoch: 3, Steps: 10 | Train Loss: 2.916 Vali Loss: 3.457 Vali Acc: 0.075 Test Loss: 3.457 Test Acc: 0.075
Validation loss decreased (-0.051729 --> -0.075260).  Saving model ...
Epoch: 4 cost time: 4.8039116859436035
Epoch: 4, Steps: 10 | Train Loss: 2.530 Vali Loss: 3.383 Vali Acc: 0.069 Test Loss: 3.383 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.36001992225647
Epoch: 5, Steps: 10 | Train Loss: 2.056 Vali Loss: 3.468 Vali Acc: 0.087 Test Loss: 3.468 Test Acc: 0.087
Validation loss decreased (-0.075260 --> -0.087024).  Saving model ...
Epoch: 6 cost time: 5.505608558654785
Epoch: 6, Steps: 10 | Train Loss: 1.577 Vali Loss: 3.727 Vali Acc: 0.098 Test Loss: 3.727 Test Acc: 0.098
Validation loss decreased (-0.087024 --> -0.097610).  Saving model ...
Epoch: 7 cost time: 5.4867844581604
Epoch: 7, Steps: 10 | Train Loss: 1.093 Vali Loss: 4.016 Vali Acc: 0.108 Test Loss: 4.016 Test Acc: 0.108
Validation loss decreased (-0.097610 --> -0.108195).  Saving model ...
Epoch: 8 cost time: 5.911791563034058
Epoch: 8, Steps: 10 | Train Loss: 0.659 Vali Loss: 4.456 Vali Acc: 0.107 Test Loss: 4.456 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.502655029296875
Epoch: 9, Steps: 10 | Train Loss: 0.376 Vali Loss: 4.635 Vali Acc: 0.140 Test Loss: 4.635 Test Acc: 0.140
Validation loss decreased (-0.108195 --> -0.139954).  Saving model ...
Epoch: 10 cost time: 5.347625255584717
Epoch: 10, Steps: 10 | Train Loss: 0.190 Vali Loss: 4.960 Vali Acc: 0.135 Test Loss: 4.960 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.440924882888794
Epoch: 11, Steps: 10 | Train Loss: 0.086 Vali Loss: 5.263 Vali Acc: 0.153 Test Loss: 5.263 Test Acc: 0.153
Validation loss decreased (-0.139954 --> -0.152889).  Saving model ...
Epoch: 12 cost time: 5.2573254108428955
Epoch: 12, Steps: 10 | Train Loss: 0.038 Vali Loss: 5.493 Vali Acc: 0.151 Test Loss: 5.493 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.870622634887695
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 5.666 Vali Acc: 0.140 Test Loss: 5.666 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.941129922866821
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.600 Vali Acc: 0.154 Test Loss: 5.600 Test Acc: 0.154
Validation loss decreased (-0.152889 --> -0.154062).  Saving model ...
Epoch: 15 cost time: 6.0257627964019775
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.695 Vali Acc: 0.160 Test Loss: 5.695 Test Acc: 0.160
Validation loss decreased (-0.154062 --> -0.159943).  Saving model ...
Epoch: 16 cost time: 6.2863335609436035
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.727 Vali Acc: 0.165 Test Loss: 5.727 Test Acc: 0.165
Validation loss decreased (-0.159943 --> -0.164649).  Saving model ...
Epoch: 17 cost time: 6.252809286117554
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.722 Vali Acc: 0.154 Test Loss: 5.722 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.94484281539917
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.726 Vali Acc: 0.160 Test Loss: 5.726 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.037775039672852
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.753 Vali Acc: 0.162 Test Loss: 5.753 Test Acc: 0.162
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.992848634719849
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.840 Vali Acc: 0.159 Test Loss: 5.840 Test Acc: 0.159
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.128139019012451
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.867 Vali Acc: 0.161 Test Loss: 5.867 Test Acc: 0.161
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.300388813018799
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.869 Vali Acc: 0.164 Test Loss: 5.869 Test Acc: 0.164
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.743837118148804
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.885 Vali Acc: 0.166 Test Loss: 5.885 Test Acc: 0.166
Validation loss decreased (-0.164649 --> -0.165824).  Saving model ...
Epoch: 24 cost time: 6.280936241149902
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.901 Vali Acc: 0.166 Test Loss: 5.901 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.297655344009399
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.916 Vali Acc: 0.166 Test Loss: 5.916 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.213017225265503
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.933 Vali Acc: 0.171 Test Loss: 5.933 Test Acc: 0.171
Validation loss decreased (-0.165824 --> -0.170529).  Saving model ...
Epoch: 27 cost time: 6.292501926422119
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.948 Vali Acc: 0.173 Test Loss: 5.948 Test Acc: 0.173
Validation loss decreased (-0.170529 --> -0.172882).  Saving model ...
Epoch: 28 cost time: 5.603872537612915
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.959 Vali Acc: 0.172 Test Loss: 5.959 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.5672643184661865
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.975 Vali Acc: 0.174 Test Loss: 5.975 Test Acc: 0.174
Validation loss decreased (-0.172882 --> -0.174058).  Saving model ...
Epoch: 30 cost time: 6.346725225448608
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.991 Vali Acc: 0.173 Test Loss: 5.991 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 7.125959157943726
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.003 Vali Acc: 0.172 Test Loss: 6.003 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.491342306137085
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.023 Vali Acc: 0.173 Test Loss: 6.023 Test Acc: 0.173
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.27929425239563
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.035 Vali Acc: 0.172 Test Loss: 6.035 Test Acc: 0.172
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.8996076583862305
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.048 Vali Acc: 0.172 Test Loss: 6.048 Test Acc: 0.172
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 7.552649974822998
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.073 Vali Acc: 0.173 Test Loss: 6.073 Test Acc: 0.173
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 6.08426308631897
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.083 Vali Acc: 0.173 Test Loss: 6.083 Test Acc: 0.173
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 6.366212606430054
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.085 Vali Acc: 0.172 Test Loss: 6.085 Test Acc: 0.172
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 6.466126203536987
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.096 Vali Acc: 0.173 Test Loss: 6.096 Test Acc: 0.173
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 7.568425178527832
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.115 Vali Acc: 0.173 Test Loss: 6.115 Test Acc: 0.173
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17411764705882352
model parameter : 3844634
model size : 24.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.467494487762451
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.039 Test Loss: 3.258 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 5.19948148727417
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.164326190948486
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.326150178909302
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.442878007888794
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.123719930648804
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.932113409042358
Epoch: 7, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.971341133117676
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.897255182266235
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.498492002487183
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.176407337188721
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.03882352941176471
model parameter : 3844634
model size : 24.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.048618078231812
Epoch: 1, Steps: 10 | Train Loss: 3.330 Vali Loss: 3.278 Vali Acc: 0.053 Test Loss: 3.278 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 5.657733201980591
Epoch: 2, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.309 Vali Acc: 0.116 Test Loss: 3.309 Test Acc: 0.116
Validation loss decreased (-0.052908 --> -0.116437).  Saving model ...
Epoch: 3 cost time: 5.620330095291138
Epoch: 3, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.168 Vali Acc: 0.179 Test Loss: 3.168 Test Acc: 0.179
Validation loss decreased (-0.116437 --> -0.178792).  Saving model ...
Epoch: 4 cost time: 6.184502363204956
Epoch: 4, Steps: 10 | Train Loss: 1.646 Vali Loss: 3.115 Vali Acc: 0.224 Test Loss: 3.115 Test Acc: 0.224
Validation loss decreased (-0.178792 --> -0.223498).  Saving model ...
Epoch: 5 cost time: 7.003053903579712
Epoch: 5, Steps: 10 | Train Loss: 1.106 Vali Loss: 3.163 Vali Acc: 0.239 Test Loss: 3.163 Test Acc: 0.239
Validation loss decreased (-0.223498 --> -0.238792).  Saving model ...
Epoch: 6 cost time: 6.75078821182251
Epoch: 6, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.265 Vali Acc: 0.274 Test Loss: 3.265 Test Acc: 0.274
Validation loss decreased (-0.238792 --> -0.274085).  Saving model ...
Epoch: 7 cost time: 6.917839288711548
Epoch: 7, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.461 Vali Acc: 0.288 Test Loss: 3.461 Test Acc: 0.288
Validation loss decreased (-0.274085 --> -0.288201).  Saving model ...
Epoch: 8 cost time: 6.580205202102661
Epoch: 8, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.578 Vali Acc: 0.302 Test Loss: 3.578 Test Acc: 0.302
Validation loss decreased (-0.288201 --> -0.302317).  Saving model ...
Epoch: 9 cost time: 7.431734561920166
Epoch: 9, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.741 Vali Acc: 0.302 Test Loss: 3.741 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.409322738647461
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.962 Vali Acc: 0.298 Test Loss: 3.962 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.75518274307251
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.005 Vali Acc: 0.301 Test Loss: 4.005 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.131695032119751
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.028 Vali Acc: 0.302 Test Loss: 4.028 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.01638650894165
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.043 Vali Acc: 0.308 Test Loss: 4.043 Test Acc: 0.308
Validation loss decreased (-0.302317 --> -0.308195).  Saving model ...
Epoch: 14 cost time: 7.209476947784424
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.059 Vali Acc: 0.311 Test Loss: 4.059 Test Acc: 0.311
Validation loss decreased (-0.308195 --> -0.310548).  Saving model ...
Epoch: 15 cost time: 7.237999200820923
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.098 Vali Acc: 0.311 Test Loss: 4.098 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.840769529342651
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.134 Vali Acc: 0.313 Test Loss: 4.134 Test Acc: 0.313
Validation loss decreased (-0.310548 --> -0.312900).  Saving model ...
Epoch: 17 cost time: 7.46860671043396
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.168 Vali Acc: 0.313 Test Loss: 4.168 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.5560455322265625
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.185 Vali Acc: 0.316 Test Loss: 4.185 Test Acc: 0.316
Validation loss decreased (-0.312900 --> -0.316429).  Saving model ...
Epoch: 19 cost time: 6.787335395812988
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.205 Vali Acc: 0.316 Test Loss: 4.205 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.788186073303223
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.226 Vali Acc: 0.314 Test Loss: 4.226 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.2928009033203125
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.251 Vali Acc: 0.313 Test Loss: 4.251 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.461284399032593
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.269 Vali Acc: 0.313 Test Loss: 4.269 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.560232877731323
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.286 Vali Acc: 0.315 Test Loss: 4.286 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.389277696609497
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.304 Vali Acc: 0.313 Test Loss: 4.304 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.734830141067505
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.324 Vali Acc: 0.314 Test Loss: 4.324 Test Acc: 0.314
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.841012954711914
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.332 Vali Acc: 0.314 Test Loss: 4.332 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.792478322982788
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.346 Vali Acc: 0.316 Test Loss: 4.346 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.330502271652222
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.358 Vali Acc: 0.316 Test Loss: 4.358 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 2741530
model size : 15.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 9.638326644897461
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.290 Vali Acc: 0.056 Test Loss: 3.290 Test Acc: 0.056
Validation loss decreased (inf --> -0.056438).  Saving model ...
Epoch: 2 cost time: 6.485685586929321
Epoch: 2, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.323 Vali Acc: 0.109 Test Loss: 3.323 Test Acc: 0.109
Validation loss decreased (-0.056438 --> -0.109379).  Saving model ...
Epoch: 3 cost time: 6.2328221797943115
Epoch: 3, Steps: 10 | Train Loss: 2.280 Vali Loss: 3.183 Vali Acc: 0.175 Test Loss: 3.183 Test Acc: 0.175
Validation loss decreased (-0.109379 --> -0.175262).  Saving model ...
Epoch: 4 cost time: 6.87069034576416
Epoch: 4, Steps: 10 | Train Loss: 1.674 Vali Loss: 3.124 Vali Acc: 0.228 Test Loss: 3.124 Test Acc: 0.228
Validation loss decreased (-0.175262 --> -0.228204).  Saving model ...
Epoch: 5 cost time: 6.554239988327026
Epoch: 5, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.165 Vali Acc: 0.244 Test Loss: 3.165 Test Acc: 0.244
Validation loss decreased (-0.228204 --> -0.243498).  Saving model ...
Epoch: 6 cost time: 6.027080535888672
Epoch: 6, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.242 Vali Acc: 0.280 Test Loss: 3.242 Test Acc: 0.280
Validation loss decreased (-0.243498 --> -0.279968).  Saving model ...
Epoch: 7 cost time: 5.884603023529053
Epoch: 7, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.468 Vali Acc: 0.294 Test Loss: 3.468 Test Acc: 0.294
Validation loss decreased (-0.279968 --> -0.294083).  Saving model ...
Epoch: 8 cost time: 8.007739067077637
Epoch: 8, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.608 Vali Acc: 0.308 Test Loss: 3.608 Test Acc: 0.308
Validation loss decreased (-0.294083 --> -0.308199).  Saving model ...
Epoch: 9 cost time: 7.88163161277771
Epoch: 9, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.766 Vali Acc: 0.320 Test Loss: 3.766 Test Acc: 0.320
Validation loss decreased (-0.308199 --> -0.319962).  Saving model ...
Epoch: 10 cost time: 6.034274339675903
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.999 Vali Acc: 0.312 Test Loss: 3.999 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.77680778503418
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.036 Vali Acc: 0.328 Test Loss: 4.036 Test Acc: 0.328
Validation loss decreased (-0.319962 --> -0.328195).  Saving model ...
Epoch: 12 cost time: 5.983382701873779
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.037 Vali Acc: 0.322 Test Loss: 4.037 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.422152996063232
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.074 Vali Acc: 0.321 Test Loss: 4.074 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.516253709793091
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.120 Vali Acc: 0.316 Test Loss: 4.120 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.198855400085449
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.156 Vali Acc: 0.320 Test Loss: 4.156 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.128955841064453
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.179 Vali Acc: 0.327 Test Loss: 4.179 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.967252969741821
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.213 Vali Acc: 0.325 Test Loss: 4.213 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.605708837509155
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.228 Vali Acc: 0.324 Test Loss: 4.228 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.484860181808472
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.247 Vali Acc: 0.321 Test Loss: 4.247 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.023393154144287
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.263 Vali Acc: 0.324 Test Loss: 4.263 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.19415283203125
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.284 Vali Acc: 0.324 Test Loss: 4.284 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32823529411764707
model parameter : 2741530
model size : 15.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.35420298576355
Epoch: 1, Steps: 10 | Train Loss: 3.330 Vali Loss: 3.265 Vali Acc: 0.065 Test Loss: 3.265 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 6.302943229675293
Epoch: 2, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.311 Vali Acc: 0.112 Test Loss: 3.311 Test Acc: 0.112
Validation loss decreased (-0.064673 --> -0.111732).  Saving model ...
Epoch: 3 cost time: 7.491125583648682
Epoch: 3, Steps: 10 | Train Loss: 2.257 Vali Loss: 3.204 Vali Acc: 0.184 Test Loss: 3.204 Test Acc: 0.184
Validation loss decreased (-0.111732 --> -0.183497).  Saving model ...
Epoch: 4 cost time: 6.696326732635498
Epoch: 4, Steps: 10 | Train Loss: 1.685 Vali Loss: 3.182 Vali Acc: 0.242 Test Loss: 3.182 Test Acc: 0.242
Validation loss decreased (-0.183497 --> -0.242321).  Saving model ...
Epoch: 5 cost time: 7.439057111740112
Epoch: 5, Steps: 10 | Train Loss: 1.240 Vali Loss: 3.246 Vali Acc: 0.253 Test Loss: 3.246 Test Acc: 0.253
Validation loss decreased (-0.242321 --> -0.252909).  Saving model ...
Epoch: 6 cost time: 6.537139892578125
Epoch: 6, Steps: 10 | Train Loss: 0.798 Vali Loss: 3.309 Vali Acc: 0.271 Test Loss: 3.309 Test Acc: 0.271
Validation loss decreased (-0.252909 --> -0.270555).  Saving model ...
Epoch: 7 cost time: 5.399996042251587
Epoch: 7, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.480 Vali Acc: 0.289 Test Loss: 3.480 Test Acc: 0.289
Validation loss decreased (-0.270555 --> -0.289377).  Saving model ...
Epoch: 8 cost time: 6.582172632217407
Epoch: 8, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.625 Vali Acc: 0.298 Test Loss: 3.625 Test Acc: 0.298
Validation loss decreased (-0.289377 --> -0.297611).  Saving model ...
Epoch: 9 cost time: 7.113017559051514
Epoch: 9, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.728 Vali Acc: 0.305 Test Loss: 3.728 Test Acc: 0.305
Validation loss decreased (-0.297611 --> -0.304669).  Saving model ...
Epoch: 10 cost time: 6.49055552482605
Epoch: 10, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.883 Vali Acc: 0.308 Test Loss: 3.883 Test Acc: 0.308
Validation loss decreased (-0.304669 --> -0.308196).  Saving model ...
Epoch: 11 cost time: 6.47020959854126
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.994 Vali Acc: 0.307 Test Loss: 3.994 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.029033899307251
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.049 Vali Acc: 0.316 Test Loss: 4.049 Test Acc: 0.316
Validation loss decreased (-0.308196 --> -0.316430).  Saving model ...
Epoch: 13 cost time: 7.794720649719238
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.122 Vali Acc: 0.316 Test Loss: 4.122 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.042311429977417
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.143 Vali Acc: 0.309 Test Loss: 4.143 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.047955513000488
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.186 Vali Acc: 0.326 Test Loss: 4.186 Test Acc: 0.326
Validation loss decreased (-0.316430 --> -0.325840).  Saving model ...
Epoch: 16 cost time: 7.663971424102783
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.219 Vali Acc: 0.324 Test Loss: 4.219 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.582208871841431
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.231 Vali Acc: 0.325 Test Loss: 4.231 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.117632865905762
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.237 Vali Acc: 0.326 Test Loss: 4.237 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.435415267944336
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.254 Vali Acc: 0.329 Test Loss: 4.254 Test Acc: 0.329
Validation loss decreased (-0.325840 --> -0.329369).  Saving model ...
Epoch: 20 cost time: 6.662142515182495
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.278 Vali Acc: 0.329 Test Loss: 4.278 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.899010181427002
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.304 Vali Acc: 0.320 Test Loss: 4.304 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.181915044784546
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.327 Vali Acc: 0.319 Test Loss: 4.327 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.757409572601318
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.345 Vali Acc: 0.320 Test Loss: 4.345 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.7873125076293945
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.363 Vali Acc: 0.321 Test Loss: 4.363 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.625996828079224
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.380 Vali Acc: 0.324 Test Loss: 4.380 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.517910718917847
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.391 Vali Acc: 0.325 Test Loss: 4.391 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.593237400054932
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.406 Vali Acc: 0.326 Test Loss: 4.406 Test Acc: 0.326
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.873243570327759
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.428 Vali Acc: 0.322 Test Loss: 4.428 Test Acc: 0.322
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.608924388885498
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.444 Vali Acc: 0.326 Test Loss: 4.444 Test Acc: 0.326
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 2741530
model size : 15.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.914443731307983
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.289 Vali Acc: 0.062 Test Loss: 3.289 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 7.415639162063599
Epoch: 2, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.355 Vali Acc: 0.104 Test Loss: 3.355 Test Acc: 0.104
Validation loss decreased (-0.062320 --> -0.103496).  Saving model ...
Epoch: 3 cost time: 7.827727794647217
Epoch: 3, Steps: 10 | Train Loss: 2.358 Vali Loss: 3.292 Vali Acc: 0.154 Test Loss: 3.292 Test Acc: 0.154
Validation loss decreased (-0.103496 --> -0.154085).  Saving model ...
Epoch: 4 cost time: 7.004537582397461
Epoch: 4, Steps: 10 | Train Loss: 1.818 Vali Loss: 3.323 Vali Acc: 0.172 Test Loss: 3.323 Test Acc: 0.172
Validation loss decreased (-0.154085 --> -0.171731).  Saving model ...
Epoch: 5 cost time: 6.585522174835205
Epoch: 5, Steps: 10 | Train Loss: 1.327 Vali Loss: 3.425 Vali Acc: 0.196 Test Loss: 3.425 Test Acc: 0.196
Validation loss decreased (-0.171731 --> -0.196436).  Saving model ...
Epoch: 6 cost time: 6.864923000335693
Epoch: 6, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.539 Vali Acc: 0.204 Test Loss: 3.539 Test Acc: 0.204
Validation loss decreased (-0.196436 --> -0.203494).  Saving model ...
Epoch: 7 cost time: 6.325775146484375
Epoch: 7, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.757 Vali Acc: 0.214 Test Loss: 3.757 Test Acc: 0.214
Validation loss decreased (-0.203494 --> -0.214080).  Saving model ...
Epoch: 8 cost time: 6.839667320251465
Epoch: 8, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.863 Vali Acc: 0.242 Test Loss: 3.863 Test Acc: 0.242
Validation loss decreased (-0.214080 --> -0.242314).  Saving model ...
Epoch: 9 cost time: 7.922496557235718
Epoch: 9, Steps: 10 | Train Loss: 0.200 Vali Loss: 4.058 Vali Acc: 0.242 Test Loss: 4.058 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.514918088912964
Epoch: 10, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.220 Vali Acc: 0.261 Test Loss: 4.220 Test Acc: 0.261
Validation loss decreased (-0.242314 --> -0.261134).  Saving model ...
Epoch: 11 cost time: 8.065324306488037
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.391 Vali Acc: 0.239 Test Loss: 4.391 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.258058786392212
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.398 Vali Acc: 0.258 Test Loss: 4.398 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.325856685638428
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.536 Vali Acc: 0.254 Test Loss: 4.536 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.1021568775177
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.628 Vali Acc: 0.261 Test Loss: 4.628 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.1269731521606445
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.728 Vali Acc: 0.256 Test Loss: 4.728 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.623610973358154
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.761 Vali Acc: 0.262 Test Loss: 4.761 Test Acc: 0.262
Validation loss decreased (-0.261134 --> -0.262305).  Saving model ...
Epoch: 17 cost time: 7.198802709579468
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.760 Vali Acc: 0.267 Test Loss: 4.760 Test Acc: 0.267
Validation loss decreased (-0.262305 --> -0.267011).  Saving model ...
Epoch: 18 cost time: 7.101804971694946
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.773 Vali Acc: 0.262 Test Loss: 4.773 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.539820671081543
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.804 Vali Acc: 0.260 Test Loss: 4.804 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.066999197006226
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.837 Vali Acc: 0.259 Test Loss: 4.837 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.976346015930176
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.871 Vali Acc: 0.258 Test Loss: 4.871 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.41097617149353
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.900 Vali Acc: 0.259 Test Loss: 4.900 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.643529653549194
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.922 Vali Acc: 0.262 Test Loss: 4.922 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.341933727264404
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.945 Vali Acc: 0.266 Test Loss: 4.945 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.751948356628418
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.968 Vali Acc: 0.264 Test Loss: 4.968 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.2787392139434814
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.974 Vali Acc: 0.267 Test Loss: 4.974 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 7.197475910186768
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.994 Vali Acc: 0.266 Test Loss: 4.994 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 2741530
model size : 15.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 9.856122493743896
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.326 Vali Acc: 0.047 Test Loss: 3.326 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 5.701765775680542
Epoch: 2, Steps: 10 | Train Loss: 3.044 Vali Loss: 3.425 Vali Acc: 0.065 Test Loss: 3.425 Test Acc: 0.065
Validation loss decreased (-0.047026 --> -0.064672).  Saving model ...
Epoch: 3 cost time: 6.039382696151733
Epoch: 3, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.394 Vali Acc: 0.087 Test Loss: 3.394 Test Acc: 0.087
Validation loss decreased (-0.064672 --> -0.087025).  Saving model ...
Epoch: 4 cost time: 6.836447238922119
Epoch: 4, Steps: 10 | Train Loss: 1.944 Vali Loss: 3.397 Vali Acc: 0.109 Test Loss: 3.397 Test Acc: 0.109
Validation loss decreased (-0.087025 --> -0.109378).  Saving model ...
Epoch: 5 cost time: 6.877481937408447
Epoch: 5, Steps: 10 | Train Loss: 1.396 Vali Loss: 3.502 Vali Acc: 0.116 Test Loss: 3.502 Test Acc: 0.116
Validation loss decreased (-0.109378 --> -0.116436).  Saving model ...
Epoch: 6 cost time: 5.9664788246154785
Epoch: 6, Steps: 10 | Train Loss: 0.908 Vali Loss: 3.676 Vali Acc: 0.116 Test Loss: 3.676 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.986637830734253
Epoch: 7, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.933 Vali Acc: 0.118 Test Loss: 3.933 Test Acc: 0.118
Validation loss decreased (-0.116436 --> -0.117608).  Saving model ...
Epoch: 8 cost time: 5.5072126388549805
Epoch: 8, Steps: 10 | Train Loss: 0.272 Vali Loss: 4.171 Vali Acc: 0.134 Test Loss: 4.171 Test Acc: 0.134
Validation loss decreased (-0.117608 --> -0.134076).  Saving model ...
Epoch: 9 cost time: 5.255064249038696
Epoch: 9, Steps: 10 | Train Loss: 0.131 Vali Loss: 4.482 Vali Acc: 0.126 Test Loss: 4.482 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.339229345321655
Epoch: 10, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.727 Vali Acc: 0.138 Test Loss: 4.727 Test Acc: 0.138
Validation loss decreased (-0.134076 --> -0.137600).  Saving model ...
Epoch: 11 cost time: 5.862800359725952
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.811 Vali Acc: 0.140 Test Loss: 4.811 Test Acc: 0.140
Validation loss decreased (-0.137600 --> -0.139952).  Saving model ...
Epoch: 12 cost time: 6.566828489303589
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.859 Vali Acc: 0.146 Test Loss: 4.859 Test Acc: 0.146
Validation loss decreased (-0.139952 --> -0.145834).  Saving model ...
Epoch: 13 cost time: 6.637258529663086
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.933 Vali Acc: 0.148 Test Loss: 4.933 Test Acc: 0.148
Validation loss decreased (-0.145834 --> -0.148186).  Saving model ...
Epoch: 14 cost time: 6.1632232666015625
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.014 Vali Acc: 0.151 Test Loss: 5.014 Test Acc: 0.151
Validation loss decreased (-0.148186 --> -0.150538).  Saving model ...
Epoch: 15 cost time: 7.405768394470215
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.057 Vali Acc: 0.148 Test Loss: 5.057 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.730163812637329
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.092 Vali Acc: 0.154 Test Loss: 5.092 Test Acc: 0.154
Validation loss decreased (-0.150538 --> -0.154067).  Saving model ...
Epoch: 17 cost time: 7.351951360702515
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.125 Vali Acc: 0.153 Test Loss: 5.125 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.173362731933594
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.149 Vali Acc: 0.156 Test Loss: 5.149 Test Acc: 0.156
Validation loss decreased (-0.154067 --> -0.156419).  Saving model ...
Epoch: 19 cost time: 7.060835599899292
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.167 Vali Acc: 0.158 Test Loss: 5.167 Test Acc: 0.158
Validation loss decreased (-0.156419 --> -0.157595).  Saving model ...
Epoch: 20 cost time: 6.963857412338257
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.183 Vali Acc: 0.158 Test Loss: 5.183 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.670921087265015
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.211 Vali Acc: 0.156 Test Loss: 5.211 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.679085731506348
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.252 Vali Acc: 0.156 Test Loss: 5.252 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.2184717655181885
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.273 Vali Acc: 0.158 Test Loss: 5.273 Test Acc: 0.158
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.198700666427612
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.295 Vali Acc: 0.159 Test Loss: 5.295 Test Acc: 0.159
Validation loss decreased (-0.157595 --> -0.158771).  Saving model ...
Epoch: 25 cost time: 6.392560005187988
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.315 Vali Acc: 0.158 Test Loss: 5.315 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.023974657058716
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.327 Vali Acc: 0.158 Test Loss: 5.327 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.379456281661987
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.347 Vali Acc: 0.160 Test Loss: 5.347 Test Acc: 0.160
Validation loss decreased (-0.158771 --> -0.159947).  Saving model ...
Epoch: 28 cost time: 7.145626544952393
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.370 Vali Acc: 0.162 Test Loss: 5.370 Test Acc: 0.162
Validation loss decreased (-0.159947 --> -0.162299).  Saving model ...
Epoch: 29 cost time: 6.472512722015381
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.388 Vali Acc: 0.161 Test Loss: 5.388 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 7.212611198425293
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.404 Vali Acc: 0.161 Test Loss: 5.404 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 7.390152931213379
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.419 Vali Acc: 0.162 Test Loss: 5.419 Test Acc: 0.162
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 6.230136871337891
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.443 Vali Acc: 0.161 Test Loss: 5.443 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 7.475750207901001
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.472 Vali Acc: 0.166 Test Loss: 5.472 Test Acc: 0.166
Validation loss decreased (-0.162299 --> -0.165828).  Saving model ...
Epoch: 34 cost time: 6.213879823684692
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.505 Vali Acc: 0.165 Test Loss: 5.505 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.407275438308716
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.518 Vali Acc: 0.165 Test Loss: 5.518 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 7.288140296936035
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.535 Vali Acc: 0.168 Test Loss: 5.535 Test Acc: 0.168
Validation loss decreased (-0.165828 --> -0.168180).  Saving model ...
Epoch: 37 cost time: 6.321709871292114
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.550 Vali Acc: 0.169 Test Loss: 5.550 Test Acc: 0.169
Validation loss decreased (-0.168180 --> -0.169356).  Saving model ...
Epoch: 38 cost time: 6.049596309661865
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.558 Vali Acc: 0.165 Test Loss: 5.558 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.851840496063232
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.579 Vali Acc: 0.167 Test Loss: 5.579 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.670926094055176
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.601 Vali Acc: 0.169 Test Loss: 5.601 Test Acc: 0.169
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 5.541414499282837
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.614 Vali Acc: 0.168 Test Loss: 5.614 Test Acc: 0.168
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 6.019857883453369
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.621 Vali Acc: 0.168 Test Loss: 5.621 Test Acc: 0.168
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 6.572377681732178
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.639 Vali Acc: 0.169 Test Loss: 5.639 Test Acc: 0.169
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 6.696195602416992
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.652 Vali Acc: 0.173 Test Loss: 5.652 Test Acc: 0.173
Validation loss decreased (-0.169356 --> -0.172885).  Saving model ...
Epoch: 45 cost time: 5.651915788650513
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.663 Vali Acc: 0.172 Test Loss: 5.663 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.271624803543091
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.672 Vali Acc: 0.173 Test Loss: 5.672 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 6.55562686920166
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.689 Vali Acc: 0.172 Test Loss: 5.689 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 6.158522367477417
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.699 Vali Acc: 0.172 Test Loss: 5.699 Test Acc: 0.172
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 5.644606113433838
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.712 Vali Acc: 0.171 Test Loss: 5.712 Test Acc: 0.171
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 6.092737913131714
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.729 Vali Acc: 0.169 Test Loss: 5.729 Test Acc: 0.169
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 7.489508628845215
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.747 Vali Acc: 0.171 Test Loss: 5.747 Test Acc: 0.171
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 7.551136016845703
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.756 Vali Acc: 0.172 Test Loss: 5.756 Test Acc: 0.172
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 6.571574926376343
Epoch: 53, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.762 Vali Acc: 0.173 Test Loss: 5.762 Test Acc: 0.173
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 6.209556818008423
Epoch: 54, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.770 Vali Acc: 0.172 Test Loss: 5.770 Test Acc: 0.172
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17294117647058824
model parameter : 2741530
model size : 15.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 7.593445301055908
Epoch: 1, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.325 Vali Acc: 0.044 Test Loss: 3.325 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 5.073806524276733
Epoch: 2, Steps: 10 | Train Loss: 3.136 Vali Loss: 3.411 Vali Acc: 0.056 Test Loss: 3.411 Test Acc: 0.056
Validation loss decreased (-0.043496 --> -0.056436).  Saving model ...
Epoch: 3 cost time: 5.755003929138184
Epoch: 3, Steps: 10 | Train Loss: 2.757 Vali Loss: 3.406 Vali Acc: 0.066 Test Loss: 3.406 Test Acc: 0.066
Validation loss decreased (-0.056436 --> -0.065848).  Saving model ...
Epoch: 4 cost time: 7.049948692321777
Epoch: 4, Steps: 10 | Train Loss: 2.285 Vali Loss: 3.396 Vali Acc: 0.061 Test Loss: 3.396 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.172788381576538
Epoch: 5, Steps: 10 | Train Loss: 1.835 Vali Loss: 3.411 Vali Acc: 0.093 Test Loss: 3.411 Test Acc: 0.093
Validation loss decreased (-0.065848 --> -0.092907).  Saving model ...
Epoch: 6 cost time: 5.410413980484009
Epoch: 6, Steps: 10 | Train Loss: 1.324 Vali Loss: 3.504 Vali Acc: 0.075 Test Loss: 3.504 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.139801740646362
Epoch: 7, Steps: 10 | Train Loss: 0.849 Vali Loss: 3.684 Vali Acc: 0.091 Test Loss: 3.684 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.413733959197998
Epoch: 8, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.882 Vali Acc: 0.095 Test Loss: 3.882 Test Acc: 0.095
Validation loss decreased (-0.092907 --> -0.095255).  Saving model ...
Epoch: 9 cost time: 5.5140604972839355
Epoch: 9, Steps: 10 | Train Loss: 0.275 Vali Loss: 4.086 Vali Acc: 0.101 Test Loss: 4.086 Test Acc: 0.101
Validation loss decreased (-0.095255 --> -0.101136).  Saving model ...
Epoch: 10 cost time: 6.656348705291748
Epoch: 10, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.323 Vali Acc: 0.098 Test Loss: 4.323 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.476867437362671
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.553 Vali Acc: 0.108 Test Loss: 4.553 Test Acc: 0.108
Validation loss decreased (-0.101136 --> -0.108190).  Saving model ...
Epoch: 12 cost time: 6.046548843383789
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.647 Vali Acc: 0.111 Test Loss: 4.647 Test Acc: 0.111
Validation loss decreased (-0.108190 --> -0.110542).  Saving model ...
Epoch: 13 cost time: 6.29269814491272
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.725 Vali Acc: 0.119 Test Loss: 4.725 Test Acc: 0.119
Validation loss decreased (-0.110542 --> -0.118776).  Saving model ...
Epoch: 14 cost time: 7.04380464553833
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.806 Vali Acc: 0.111 Test Loss: 4.806 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.249587297439575
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.836 Vali Acc: 0.105 Test Loss: 4.836 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.858512878417969
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.863 Vali Acc: 0.111 Test Loss: 4.863 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.014027118682861
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.909 Vali Acc: 0.115 Test Loss: 4.909 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.050781488418579
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.939 Vali Acc: 0.114 Test Loss: 4.939 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.711440801620483
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.974 Vali Acc: 0.115 Test Loss: 4.974 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.460395336151123
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.990 Vali Acc: 0.113 Test Loss: 4.990 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.687049150466919
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.017 Vali Acc: 0.114 Test Loss: 5.017 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.541492938995361
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.049 Vali Acc: 0.118 Test Loss: 5.049 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.03514552116394
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.074 Vali Acc: 0.119 Test Loss: 5.074 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1188235294117647
model parameter : 2741530
model size : 15.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.36215853691101
Epoch: 1, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.316 Vali Acc: 0.056 Test Loss: 3.316 Test Acc: 0.056
Validation loss decreased (inf --> -0.056437).  Saving model ...
Epoch: 2 cost time: 7.104963064193726
Epoch: 2, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.396 Vali Acc: 0.061 Test Loss: 3.396 Test Acc: 0.061
Validation loss decreased (-0.056437 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 7.757444381713867
Epoch: 3, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.419 Vali Acc: 0.067 Test Loss: 3.419 Test Acc: 0.067
Validation loss decreased (-0.061143 --> -0.067025).  Saving model ...
Epoch: 4 cost time: 7.455962657928467
Epoch: 4, Steps: 10 | Train Loss: 2.544 Vali Loss: 3.396 Vali Acc: 0.071 Test Loss: 3.396 Test Acc: 0.071
Validation loss decreased (-0.067025 --> -0.070554).  Saving model ...
Epoch: 5 cost time: 7.193372011184692
Epoch: 5, Steps: 10 | Train Loss: 2.268 Vali Loss: 3.374 Vali Acc: 0.081 Test Loss: 3.374 Test Acc: 0.081
Validation loss decreased (-0.070554 --> -0.081143).  Saving model ...
Epoch: 6 cost time: 6.699251413345337
Epoch: 6, Steps: 10 | Train Loss: 1.773 Vali Loss: 3.408 Vali Acc: 0.082 Test Loss: 3.408 Test Acc: 0.082
Validation loss decreased (-0.081143 --> -0.082319).  Saving model ...
Epoch: 7 cost time: 6.497689247131348
Epoch: 7, Steps: 10 | Train Loss: 1.317 Vali Loss: 3.538 Vali Acc: 0.078 Test Loss: 3.538 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.639453411102295
Epoch: 8, Steps: 10 | Train Loss: 0.917 Vali Loss: 3.691 Vali Acc: 0.084 Test Loss: 3.691 Test Acc: 0.084
Validation loss decreased (-0.082319 --> -0.083493).  Saving model ...
Epoch: 9 cost time: 6.56958532333374
Epoch: 9, Steps: 10 | Train Loss: 0.559 Vali Loss: 3.868 Vali Acc: 0.096 Test Loss: 3.868 Test Acc: 0.096
Validation loss decreased (-0.083493 --> -0.096432).  Saving model ...
Epoch: 10 cost time: 5.689854383468628
Epoch: 10, Steps: 10 | Train Loss: 0.279 Vali Loss: 4.215 Vali Acc: 0.093 Test Loss: 4.215 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.131741046905518
Epoch: 11, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.428 Vali Acc: 0.102 Test Loss: 4.428 Test Acc: 0.102
Validation loss decreased (-0.096432 --> -0.102309).  Saving model ...
Epoch: 12 cost time: 6.789773225784302
Epoch: 12, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.619 Vali Acc: 0.096 Test Loss: 4.619 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.6604509353637695
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.692 Vali Acc: 0.098 Test Loss: 4.692 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.776403903961182
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.782 Vali Acc: 0.109 Test Loss: 4.782 Test Acc: 0.109
Validation loss decreased (-0.102309 --> -0.109364).  Saving model ...
Epoch: 15 cost time: 6.039351463317871
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.871 Vali Acc: 0.111 Test Loss: 4.871 Test Acc: 0.111
Validation loss decreased (-0.109364 --> -0.110540).  Saving model ...
Epoch: 16 cost time: 6.385261535644531
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.914 Vali Acc: 0.106 Test Loss: 4.914 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.184083938598633
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.960 Vali Acc: 0.109 Test Loss: 4.960 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.244562387466431
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.975 Vali Acc: 0.113 Test Loss: 4.975 Test Acc: 0.113
Validation loss decreased (-0.110540 --> -0.112891).  Saving model ...
Epoch: 19 cost time: 7.028860569000244
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.003 Vali Acc: 0.119 Test Loss: 5.003 Test Acc: 0.119
Validation loss decreased (-0.112891 --> -0.118773).  Saving model ...
Epoch: 20 cost time: 6.846906423568726
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.017 Vali Acc: 0.121 Test Loss: 5.017 Test Acc: 0.121
Validation loss decreased (-0.118773 --> -0.121126).  Saving model ...
Epoch: 21 cost time: 6.383824110031128
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.046 Vali Acc: 0.119 Test Loss: 5.046 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.974287033081055
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.085 Vali Acc: 0.118 Test Loss: 5.085 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.2321953773498535
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.113 Vali Acc: 0.118 Test Loss: 5.113 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.294225692749023
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.136 Vali Acc: 0.118 Test Loss: 5.136 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.626332521438599
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.155 Vali Acc: 0.116 Test Loss: 5.155 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.315309524536133
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.146 Vali Acc: 0.121 Test Loss: 5.146 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.669500112533569
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.145 Vali Acc: 0.124 Test Loss: 5.145 Test Acc: 0.124
Validation loss decreased (-0.121126 --> -0.123478).  Saving model ...
Epoch: 28 cost time: 6.247874736785889
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.165 Vali Acc: 0.124 Test Loss: 5.165 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.618524074554443
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.185 Vali Acc: 0.124 Test Loss: 5.185 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.31803035736084
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.209 Vali Acc: 0.121 Test Loss: 5.209 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.127581357955933
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.228 Vali Acc: 0.119 Test Loss: 5.228 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.7603232860565186
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.251 Vali Acc: 0.119 Test Loss: 5.251 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 6.073193311691284
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.272 Vali Acc: 0.122 Test Loss: 5.272 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 6.938106536865234
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.304 Vali Acc: 0.121 Test Loss: 5.304 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 7.2383458614349365
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.317 Vali Acc: 0.122 Test Loss: 5.317 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 6.5059874057769775
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.330 Vali Acc: 0.121 Test Loss: 5.330 Test Acc: 0.121
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 6.063197612762451
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.339 Vali Acc: 0.124 Test Loss: 5.339 Test Acc: 0.124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12352941176470589
model parameter : 2741530
model size : 15.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.414959192276001
Epoch: 1, Steps: 10 | Train Loss: 3.349 Vali Loss: 3.345 Vali Acc: 0.040 Test Loss: 3.345 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 6.108944892883301
Epoch: 2, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.447 Vali Acc: 0.054 Test Loss: 3.447 Test Acc: 0.054
Validation loss decreased (-0.039967 --> -0.054083).  Saving model ...
Epoch: 3 cost time: 6.5335047245025635
Epoch: 3, Steps: 10 | Train Loss: 2.948 Vali Loss: 3.484 Vali Acc: 0.058 Test Loss: 3.484 Test Acc: 0.058
Validation loss decreased (-0.054083 --> -0.057612).  Saving model ...
Epoch: 4 cost time: 5.84364914894104
Epoch: 4, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.455 Vali Acc: 0.062 Test Loss: 3.455 Test Acc: 0.062
Validation loss decreased (-0.057612 --> -0.062318).  Saving model ...
Epoch: 5 cost time: 6.297281265258789
Epoch: 5, Steps: 10 | Train Loss: 2.503 Vali Loss: 3.412 Vali Acc: 0.071 Test Loss: 3.412 Test Acc: 0.071
Validation loss decreased (-0.062318 --> -0.070554).  Saving model ...
Epoch: 6 cost time: 5.843231201171875
Epoch: 6, Steps: 10 | Train Loss: 2.080 Vali Loss: 3.416 Vali Acc: 0.082 Test Loss: 3.416 Test Acc: 0.082
Validation loss decreased (-0.070554 --> -0.082319).  Saving model ...
Epoch: 7 cost time: 5.7669994831085205
Epoch: 7, Steps: 10 | Train Loss: 1.725 Vali Loss: 3.508 Vali Acc: 0.076 Test Loss: 3.508 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.180993556976318
Epoch: 8, Steps: 10 | Train Loss: 1.283 Vali Loss: 3.590 Vali Acc: 0.082 Test Loss: 3.590 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.2781453132629395
Epoch: 9, Steps: 10 | Train Loss: 0.906 Vali Loss: 3.697 Vali Acc: 0.086 Test Loss: 3.697 Test Acc: 0.086
Validation loss decreased (-0.082319 --> -0.085845).  Saving model ...
Epoch: 10 cost time: 5.127862215042114
Epoch: 10, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.974 Vali Acc: 0.089 Test Loss: 3.974 Test Acc: 0.089
Validation loss decreased (-0.085845 --> -0.089372).  Saving model ...
Epoch: 11 cost time: 5.564383268356323
Epoch: 11, Steps: 10 | Train Loss: 0.289 Vali Loss: 4.117 Vali Acc: 0.099 Test Loss: 4.117 Test Acc: 0.099
Validation loss decreased (-0.089372 --> -0.098782).  Saving model ...
Epoch: 12 cost time: 5.128111362457275
Epoch: 12, Steps: 10 | Train Loss: 0.127 Vali Loss: 4.328 Vali Acc: 0.101 Test Loss: 4.328 Test Acc: 0.101
Validation loss decreased (-0.098782 --> -0.101133).  Saving model ...
Epoch: 13 cost time: 5.04401969909668
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.484 Vali Acc: 0.101 Test Loss: 4.484 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.636269569396973
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.605 Vali Acc: 0.101 Test Loss: 4.605 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.1606926918029785
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.713 Vali Acc: 0.099 Test Loss: 4.713 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.223437070846558
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.789 Vali Acc: 0.108 Test Loss: 4.789 Test Acc: 0.108
Validation loss decreased (-0.101133 --> -0.108187).  Saving model ...
Epoch: 17 cost time: 6.401888132095337
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.893 Vali Acc: 0.102 Test Loss: 4.893 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.281076192855835
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.866 Vali Acc: 0.105 Test Loss: 4.866 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.94649600982666
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.850 Vali Acc: 0.113 Test Loss: 4.850 Test Acc: 0.113
Validation loss decreased (-0.108187 --> -0.112893).  Saving model ...
Epoch: 20 cost time: 6.541273593902588
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.853 Vali Acc: 0.118 Test Loss: 4.853 Test Acc: 0.118
Validation loss decreased (-0.112893 --> -0.117599).  Saving model ...
Epoch: 21 cost time: 4.948582410812378
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.863 Vali Acc: 0.116 Test Loss: 4.863 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.25547194480896
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.900 Vali Acc: 0.114 Test Loss: 4.900 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.380267143249512
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.925 Vali Acc: 0.120 Test Loss: 4.925 Test Acc: 0.120
Validation loss decreased (-0.117599 --> -0.119951).  Saving model ...
Epoch: 24 cost time: 6.113694429397583
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.937 Vali Acc: 0.118 Test Loss: 4.937 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.385613203048706
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.943 Vali Acc: 0.118 Test Loss: 4.943 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.450735092163086
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.943 Vali Acc: 0.120 Test Loss: 4.943 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.034342050552368
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.962 Vali Acc: 0.118 Test Loss: 4.962 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.730693817138672
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.992 Vali Acc: 0.118 Test Loss: 4.992 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.392461538314819
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.010 Vali Acc: 0.115 Test Loss: 5.010 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.170944929122925
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.020 Vali Acc: 0.114 Test Loss: 5.020 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.401217460632324
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.034 Vali Acc: 0.115 Test Loss: 5.034 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 6.0440075397491455
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.051 Vali Acc: 0.119 Test Loss: 5.051 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 6.055147647857666
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.074 Vali Acc: 0.118 Test Loss: 5.074 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12
model parameter : 2741530
model size : 15.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.736800670623779
Epoch: 1, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.306 Vali Acc: 0.039 Test Loss: 3.306 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 5.797247886657715
Epoch: 2, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.380 Vali Acc: 0.051 Test Loss: 3.380 Test Acc: 0.051
Validation loss decreased (-0.038790 --> -0.050554).  Saving model ...
Epoch: 3 cost time: 6.315518140792847
Epoch: 3, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.430 Vali Acc: 0.059 Test Loss: 3.430 Test Acc: 0.059
Validation loss decreased (-0.050554 --> -0.058789).  Saving model ...
Epoch: 4 cost time: 6.063462018966675
Epoch: 4, Steps: 10 | Train Loss: 2.830 Vali Loss: 3.404 Vali Acc: 0.072 Test Loss: 3.404 Test Acc: 0.072
Validation loss decreased (-0.058789 --> -0.071731).  Saving model ...
Epoch: 5 cost time: 5.704020738601685
Epoch: 5, Steps: 10 | Train Loss: 2.635 Vali Loss: 3.352 Vali Acc: 0.080 Test Loss: 3.352 Test Acc: 0.080
Validation loss decreased (-0.071731 --> -0.079966).  Saving model ...
Epoch: 6 cost time: 5.749608755111694
Epoch: 6, Steps: 10 | Train Loss: 2.359 Vali Loss: 3.340 Vali Acc: 0.088 Test Loss: 3.340 Test Acc: 0.088
Validation loss decreased (-0.079966 --> -0.088202).  Saving model ...
Epoch: 7 cost time: 5.308948993682861
Epoch: 7, Steps: 10 | Train Loss: 1.925 Vali Loss: 3.422 Vali Acc: 0.091 Test Loss: 3.422 Test Acc: 0.091
Validation loss decreased (-0.088202 --> -0.090554).  Saving model ...
Epoch: 8 cost time: 5.340949773788452
Epoch: 8, Steps: 10 | Train Loss: 1.573 Vali Loss: 3.497 Vali Acc: 0.091 Test Loss: 3.497 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.337683200836182
Epoch: 9, Steps: 10 | Train Loss: 1.155 Vali Loss: 3.622 Vali Acc: 0.100 Test Loss: 3.622 Test Acc: 0.100
Validation loss decreased (-0.090554 --> -0.099964).  Saving model ...
Epoch: 10 cost time: 5.633537292480469
Epoch: 10, Steps: 10 | Train Loss: 0.711 Vali Loss: 3.888 Vali Acc: 0.101 Test Loss: 3.888 Test Acc: 0.101
Validation loss decreased (-0.099964 --> -0.101138).  Saving model ...
Epoch: 11 cost time: 5.179255485534668
Epoch: 11, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.998 Vali Acc: 0.113 Test Loss: 3.998 Test Acc: 0.113
Validation loss decreased (-0.101138 --> -0.112901).  Saving model ...
Epoch: 12 cost time: 5.133497714996338
Epoch: 12, Steps: 10 | Train Loss: 0.231 Vali Loss: 4.219 Vali Acc: 0.120 Test Loss: 4.219 Test Acc: 0.120
Validation loss decreased (-0.112901 --> -0.119958).  Saving model ...
Epoch: 13 cost time: 5.25505256652832
Epoch: 13, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.305 Vali Acc: 0.125 Test Loss: 4.305 Test Acc: 0.125
Validation loss decreased (-0.119958 --> -0.124663).  Saving model ...
Epoch: 14 cost time: 5.431097745895386
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.600 Vali Acc: 0.126 Test Loss: 4.600 Test Acc: 0.126
Validation loss decreased (-0.124663 --> -0.125836).  Saving model ...
Epoch: 15 cost time: 5.848634958267212
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.655 Vali Acc: 0.134 Test Loss: 4.655 Test Acc: 0.134
Validation loss decreased (-0.125836 --> -0.134071).  Saving model ...
Epoch: 16 cost time: 5.197270154953003
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.726 Vali Acc: 0.132 Test Loss: 4.726 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.444890975952148
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.848 Vali Acc: 0.133 Test Loss: 4.848 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.954992055892944
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.792 Vali Acc: 0.142 Test Loss: 4.792 Test Acc: 0.142
Validation loss decreased (-0.134071 --> -0.142305).  Saving model ...
Epoch: 19 cost time: 5.242759704589844
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.805 Vali Acc: 0.148 Test Loss: 4.805 Test Acc: 0.148
Validation loss decreased (-0.142305 --> -0.148187).  Saving model ...
Epoch: 20 cost time: 5.131733417510986
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.816 Vali Acc: 0.146 Test Loss: 4.816 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.892469644546509
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.828 Vali Acc: 0.147 Test Loss: 4.828 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.00434136390686
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.863 Vali Acc: 0.145 Test Loss: 4.863 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.2208476066589355
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.891 Vali Acc: 0.141 Test Loss: 4.891 Test Acc: 0.141
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.490528106689453
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.911 Vali Acc: 0.144 Test Loss: 4.911 Test Acc: 0.144
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.3721489906311035
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.920 Vali Acc: 0.147 Test Loss: 4.920 Test Acc: 0.147
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.750902414321899
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.922 Vali Acc: 0.138 Test Loss: 4.922 Test Acc: 0.138
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.147287130355835
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.942 Vali Acc: 0.142 Test Loss: 4.942 Test Acc: 0.142
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.475274085998535
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.978 Vali Acc: 0.139 Test Loss: 4.978 Test Acc: 0.139
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.775198459625244
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.986 Vali Acc: 0.140 Test Loss: 4.986 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14823529411764705
model parameter : 2741530
model size : 15.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 7.46099066734314
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.029 Test Loss: 3.258 Test Acc: 0.029
Validation loss decreased (inf --> -0.029379).  Saving model ...
Epoch: 2 cost time: 5.158991098403931
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.029 Test Loss: 3.258 Test Acc: 0.029
Validation loss decreased (-0.029379 --> -0.029379).  Saving model ...
Epoch: 3 cost time: 4.920506238937378
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
Validation loss decreased (-0.029379 --> -0.030556).  Saving model ...
Epoch: 4 cost time: 5.263989448547363
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
Validation loss decreased (-0.030556 --> -0.030556).  Saving model ...
Epoch: 5 cost time: 5.610415935516357
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
Validation loss decreased (-0.030556 --> -0.030556).  Saving model ...
Epoch: 6 cost time: 4.8429789543151855
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
Validation loss decreased (-0.030556 --> -0.030556).  Saving model ...
Epoch: 7 cost time: 5.646790981292725
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.030556 --> -0.050556).  Saving model ...
Epoch: 8 cost time: 6.32778000831604
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 9 cost time: 6.408212661743164
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 10 cost time: 5.637070655822754
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 11 cost time: 7.030576944351196
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 12 cost time: 5.746694326400757
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 13 cost time: 5.188653945922852
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 14 cost time: 4.935210704803467
Epoch: 14, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 15 cost time: 5.898111820220947
Epoch: 15, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 16 cost time: 5.2024126052856445
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 17 cost time: 5.531829595565796
Epoch: 17, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 18 cost time: 4.948399782180786
Epoch: 18, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 19 cost time: 4.672790765762329
Epoch: 19, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 20 cost time: 5.793258190155029
Epoch: 20, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 21 cost time: 5.7788777351379395
Epoch: 21, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 22 cost time: 6.208583116531372
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 23 cost time: 5.835312366485596
Epoch: 23, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.48856520652771
Epoch: 24, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.93220853805542
Epoch: 25, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.279954195022583
Epoch: 26, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.044492721557617
Epoch: 27, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.551262140274048
Epoch: 28, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.520068407058716
Epoch: 29, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.182715177536011
Epoch: 30, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.261902093887329
Epoch: 31, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.925885915756226
Epoch: 32, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.05058823529411765
model parameter : 2741530
model size : 15.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.654167413711548
Epoch: 1, Steps: 10 | Train Loss: 3.268 Vali Loss: 3.313 Vali Acc: 0.059 Test Loss: 3.313 Test Acc: 0.059
Validation loss decreased (inf --> -0.058790).  Saving model ...
Epoch: 2 cost time: 6.511319398880005
Epoch: 2, Steps: 10 | Train Loss: 2.911 Vali Loss: 3.303 Vali Acc: 0.122 Test Loss: 3.303 Test Acc: 0.122
Validation loss decreased (-0.058790 --> -0.122320).  Saving model ...
Epoch: 3 cost time: 5.307277202606201
Epoch: 3, Steps: 10 | Train Loss: 2.356 Vali Loss: 3.225 Vali Acc: 0.159 Test Loss: 3.225 Test Acc: 0.159
Validation loss decreased (-0.122320 --> -0.158791).  Saving model ...
Epoch: 4 cost time: 7.065830230712891
Epoch: 4, Steps: 10 | Train Loss: 1.653 Vali Loss: 3.145 Vali Acc: 0.192 Test Loss: 3.145 Test Acc: 0.192
Validation loss decreased (-0.158791 --> -0.191733).  Saving model ...
Epoch: 5 cost time: 7.595383167266846
Epoch: 5, Steps: 10 | Train Loss: 1.114 Vali Loss: 3.223 Vali Acc: 0.224 Test Loss: 3.223 Test Acc: 0.224
Validation loss decreased (-0.191733 --> -0.223497).  Saving model ...
Epoch: 6 cost time: 7.001012325286865
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.270 Vali Acc: 0.245 Test Loss: 3.270 Test Acc: 0.245
Validation loss decreased (-0.223497 --> -0.244673).  Saving model ...
Epoch: 7 cost time: 5.917719602584839
Epoch: 7, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.418 Vali Acc: 0.271 Test Loss: 3.418 Test Acc: 0.271
Validation loss decreased (-0.244673 --> -0.270554).  Saving model ...
Epoch: 8 cost time: 5.7230939865112305
Epoch: 8, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.550 Vali Acc: 0.285 Test Loss: 3.550 Test Acc: 0.285
Validation loss decreased (-0.270554 --> -0.284670).  Saving model ...
Epoch: 9 cost time: 7.0564045906066895
Epoch: 9, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.740 Vali Acc: 0.280 Test Loss: 3.740 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.238719701766968
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.941 Vali Acc: 0.280 Test Loss: 3.941 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.446727752685547
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.975 Vali Acc: 0.295 Test Loss: 3.975 Test Acc: 0.295
Validation loss decreased (-0.284670 --> -0.295254).  Saving model ...
Epoch: 12 cost time: 6.429908752441406
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.001 Vali Acc: 0.293 Test Loss: 4.001 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.578922748565674
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.048 Vali Acc: 0.300 Test Loss: 4.048 Test Acc: 0.300
Validation loss decreased (-0.295254 --> -0.299960).  Saving model ...
Epoch: 14 cost time: 5.594102382659912
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.082 Vali Acc: 0.305 Test Loss: 4.082 Test Acc: 0.305
Validation loss decreased (-0.299960 --> -0.304665).  Saving model ...
Epoch: 15 cost time: 5.050960540771484
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.098 Vali Acc: 0.311 Test Loss: 4.098 Test Acc: 0.311
Validation loss decreased (-0.304665 --> -0.310547).  Saving model ...
Epoch: 16 cost time: 6.394282817840576
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.123 Vali Acc: 0.306 Test Loss: 4.123 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.448891878128052
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.147 Vali Acc: 0.308 Test Loss: 4.147 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.944112539291382
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.174 Vali Acc: 0.313 Test Loss: 4.174 Test Acc: 0.313
Validation loss decreased (-0.310547 --> -0.312899).  Saving model ...
Epoch: 19 cost time: 6.381077766418457
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.192 Vali Acc: 0.313 Test Loss: 4.192 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.04999303817749
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.207 Vali Acc: 0.316 Test Loss: 4.207 Test Acc: 0.316
Validation loss decreased (-0.312899 --> -0.316429).  Saving model ...
Epoch: 21 cost time: 6.349694728851318
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.229 Vali Acc: 0.313 Test Loss: 4.229 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.632970094680786
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.252 Vali Acc: 0.313 Test Loss: 4.252 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.5200934410095215
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.276 Vali Acc: 0.315 Test Loss: 4.276 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.725962162017822
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.301 Vali Acc: 0.318 Test Loss: 4.301 Test Acc: 0.318
Validation loss decreased (-0.316429 --> -0.317604).  Saving model ...
Epoch: 25 cost time: 6.178921699523926
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.322 Vali Acc: 0.316 Test Loss: 4.322 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.094857931137085
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.341 Vali Acc: 0.315 Test Loss: 4.341 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.280174732208252
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.358 Vali Acc: 0.312 Test Loss: 4.358 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.050194263458252
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.372 Vali Acc: 0.314 Test Loss: 4.372 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.735136270523071
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.391 Vali Acc: 0.314 Test Loss: 4.391 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.218317031860352
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.413 Vali Acc: 0.320 Test Loss: 4.413 Test Acc: 0.320
Validation loss decreased (-0.317604 --> -0.319956).  Saving model ...
Epoch: 31 cost time: 6.525057792663574
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.432 Vali Acc: 0.320 Test Loss: 4.432 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.813306093215942
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.446 Vali Acc: 0.319 Test Loss: 4.446 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.199918985366821
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.466 Vali Acc: 0.319 Test Loss: 4.466 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.9330360889434814
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.484 Vali Acc: 0.318 Test Loss: 4.484 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 5.972927570343018
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.494 Vali Acc: 0.318 Test Loss: 4.494 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 5.612385034561157
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.508 Vali Acc: 0.319 Test Loss: 4.508 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 5.85651969909668
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.517 Vali Acc: 0.319 Test Loss: 4.517 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 6.453000783920288
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.527 Vali Acc: 0.318 Test Loss: 4.527 Test Acc: 0.318
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 6.365989923477173
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.541 Vali Acc: 0.316 Test Loss: 4.541 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 6.157180547714233
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.552 Vali Acc: 0.319 Test Loss: 4.552 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32
model parameter : 1955098
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 7.636772394180298
Epoch: 1, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.297 Vali Acc: 0.075 Test Loss: 3.297 Test Acc: 0.075
Validation loss decreased (inf --> -0.075261).  Saving model ...
Epoch: 2 cost time: 4.962889671325684
Epoch: 2, Steps: 10 | Train Loss: 2.895 Vali Loss: 3.286 Vali Acc: 0.120 Test Loss: 3.286 Test Acc: 0.120
Validation loss decreased (-0.075261 --> -0.119967).  Saving model ...
Epoch: 3 cost time: 5.427127361297607
Epoch: 3, Steps: 10 | Train Loss: 2.350 Vali Loss: 3.212 Vali Acc: 0.173 Test Loss: 3.212 Test Acc: 0.173
Validation loss decreased (-0.119967 --> -0.172909).  Saving model ...
Epoch: 4 cost time: 4.9837305545806885
Epoch: 4, Steps: 10 | Train Loss: 1.646 Vali Loss: 3.135 Vali Acc: 0.213 Test Loss: 3.135 Test Acc: 0.213
Validation loss decreased (-0.172909 --> -0.212910).  Saving model ...
Epoch: 5 cost time: 5.247491359710693
Epoch: 5, Steps: 10 | Train Loss: 1.124 Vali Loss: 3.211 Vali Acc: 0.234 Test Loss: 3.211 Test Acc: 0.234
Validation loss decreased (-0.212910 --> -0.234086).  Saving model ...
Epoch: 6 cost time: 5.503161191940308
Epoch: 6, Steps: 10 | Train Loss: 0.713 Vali Loss: 3.271 Vali Acc: 0.260 Test Loss: 3.271 Test Acc: 0.260
Validation loss decreased (-0.234086 --> -0.259967).  Saving model ...
Epoch: 7 cost time: 5.247518301010132
Epoch: 7, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.418 Vali Acc: 0.284 Test Loss: 3.418 Test Acc: 0.284
Validation loss decreased (-0.259967 --> -0.283495).  Saving model ...
Epoch: 8 cost time: 5.341374635696411
Epoch: 8, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.589 Vali Acc: 0.305 Test Loss: 3.589 Test Acc: 0.305
Validation loss decreased (-0.283495 --> -0.304670).  Saving model ...
Epoch: 9 cost time: 5.45637059211731
Epoch: 9, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.782 Vali Acc: 0.301 Test Loss: 3.782 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.621315956115723
Epoch: 10, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.935 Vali Acc: 0.315 Test Loss: 3.935 Test Acc: 0.315
Validation loss decreased (-0.304670 --> -0.315255).  Saving model ...
Epoch: 11 cost time: 4.917735576629639
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.039 Vali Acc: 0.322 Test Loss: 4.039 Test Acc: 0.322
Validation loss decreased (-0.315255 --> -0.322313).  Saving model ...
Epoch: 12 cost time: 5.3495612144470215
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.153 Vali Acc: 0.306 Test Loss: 4.153 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.44165301322937
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.228 Vali Acc: 0.306 Test Loss: 4.228 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.666987657546997
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.181 Vali Acc: 0.324 Test Loss: 4.181 Test Acc: 0.324
Validation loss decreased (-0.322313 --> -0.323488).  Saving model ...
Epoch: 15 cost time: 5.124690294265747
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.188 Vali Acc: 0.324 Test Loss: 4.188 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.045139312744141
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.204 Vali Acc: 0.324 Test Loss: 4.204 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.138715982437134
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.236 Vali Acc: 0.325 Test Loss: 4.236 Test Acc: 0.325
Validation loss decreased (-0.323488 --> -0.324664).  Saving model ...
Epoch: 18 cost time: 5.812721490859985
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.263 Vali Acc: 0.321 Test Loss: 4.263 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.208600282669067
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.280 Vali Acc: 0.324 Test Loss: 4.280 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.9648354053497314
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.296 Vali Acc: 0.322 Test Loss: 4.296 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.693837404251099
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.318 Vali Acc: 0.321 Test Loss: 4.318 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.226746320724487
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.336 Vali Acc: 0.324 Test Loss: 4.336 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.5196874141693115
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.355 Vali Acc: 0.325 Test Loss: 4.355 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.344621419906616
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.379 Vali Acc: 0.325 Test Loss: 4.379 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.065728187561035
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.407 Vali Acc: 0.325 Test Loss: 4.407 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.6688454151153564
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.427 Vali Acc: 0.325 Test Loss: 4.427 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.908194303512573
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.443 Vali Acc: 0.326 Test Loss: 4.443 Test Acc: 0.326
Validation loss decreased (-0.324664 --> -0.325838).  Saving model ...
Epoch: 28 cost time: 5.943251132965088
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.453 Vali Acc: 0.326 Test Loss: 4.453 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.537302017211914
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.474 Vali Acc: 0.326 Test Loss: 4.474 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.5297229290008545
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.492 Vali Acc: 0.325 Test Loss: 4.492 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.932599782943726
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.512 Vali Acc: 0.325 Test Loss: 4.512 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.586725473403931
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.529 Vali Acc: 0.325 Test Loss: 4.529 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.64320969581604
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.552 Vali Acc: 0.326 Test Loss: 4.552 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 6.162755489349365
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.574 Vali Acc: 0.322 Test Loss: 4.574 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 6.399831771850586
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.586 Vali Acc: 0.324 Test Loss: 4.586 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 6.619855642318726
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.600 Vali Acc: 0.324 Test Loss: 4.600 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 5.286182165145874
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.609 Vali Acc: 0.324 Test Loss: 4.609 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 1955098
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.129732131958008
Epoch: 1, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.292 Vali Acc: 0.067 Test Loss: 3.292 Test Acc: 0.067
Validation loss decreased (inf --> -0.067026).  Saving model ...
Epoch: 2 cost time: 5.630737543106079
Epoch: 2, Steps: 10 | Train Loss: 2.855 Vali Loss: 3.273 Vali Acc: 0.133 Test Loss: 3.273 Test Acc: 0.133
Validation loss decreased (-0.067026 --> -0.132908).  Saving model ...
Epoch: 3 cost time: 6.563661336898804
Epoch: 3, Steps: 10 | Train Loss: 2.351 Vali Loss: 3.233 Vali Acc: 0.168 Test Loss: 3.233 Test Acc: 0.168
Validation loss decreased (-0.132908 --> -0.168203).  Saving model ...
Epoch: 4 cost time: 5.982898712158203
Epoch: 4, Steps: 10 | Train Loss: 1.683 Vali Loss: 3.202 Vali Acc: 0.201 Test Loss: 3.202 Test Acc: 0.201
Validation loss decreased (-0.168203 --> -0.201144).  Saving model ...
Epoch: 5 cost time: 5.860604524612427
Epoch: 5, Steps: 10 | Train Loss: 1.202 Vali Loss: 3.267 Vali Acc: 0.238 Test Loss: 3.267 Test Acc: 0.238
Validation loss decreased (-0.201144 --> -0.237614).  Saving model ...
Epoch: 6 cost time: 5.753077030181885
Epoch: 6, Steps: 10 | Train Loss: 0.824 Vali Loss: 3.322 Vali Acc: 0.269 Test Loss: 3.322 Test Acc: 0.269
Validation loss decreased (-0.237614 --> -0.269379).  Saving model ...
Epoch: 7 cost time: 5.517569541931152
Epoch: 7, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.474 Vali Acc: 0.273 Test Loss: 3.474 Test Acc: 0.273
Validation loss decreased (-0.269379 --> -0.272906).  Saving model ...
Epoch: 8 cost time: 5.511984348297119
Epoch: 8, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.606 Vali Acc: 0.286 Test Loss: 3.606 Test Acc: 0.286
Validation loss decreased (-0.272906 --> -0.285846).  Saving model ...
Epoch: 9 cost time: 5.9025678634643555
Epoch: 9, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.727 Vali Acc: 0.299 Test Loss: 3.727 Test Acc: 0.299
Validation loss decreased (-0.285846 --> -0.298786).  Saving model ...
Epoch: 10 cost time: 7.241438150405884
Epoch: 10, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.034 Vali Acc: 0.282 Test Loss: 4.034 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.651159286499023
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.988 Vali Acc: 0.308 Test Loss: 3.988 Test Acc: 0.308
Validation loss decreased (-0.298786 --> -0.308195).  Saving model ...
Epoch: 12 cost time: 6.0549914836883545
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.104 Vali Acc: 0.304 Test Loss: 4.104 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.031801700592041
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.186 Vali Acc: 0.294 Test Loss: 4.186 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.832176446914673
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.227 Vali Acc: 0.300 Test Loss: 4.227 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.06399941444397
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.241 Vali Acc: 0.301 Test Loss: 4.241 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.8172447681427
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.273 Vali Acc: 0.302 Test Loss: 4.273 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.379220247268677
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.298 Vali Acc: 0.301 Test Loss: 4.298 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.81478214263916
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.334 Vali Acc: 0.304 Test Loss: 4.334 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.7438623905181885
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.349 Vali Acc: 0.306 Test Loss: 4.349 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.81445837020874
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.359 Vali Acc: 0.304 Test Loss: 4.359 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.797951936721802
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.381 Vali Acc: 0.305 Test Loss: 4.381 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30823529411764705
model parameter : 1955098
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 9.03187870979309
Epoch: 1, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.315 Vali Acc: 0.052 Test Loss: 3.315 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 4.82326865196228
Epoch: 2, Steps: 10 | Train Loss: 2.931 Vali Loss: 3.339 Vali Acc: 0.102 Test Loss: 3.339 Test Acc: 0.102
Validation loss decreased (-0.051732 --> -0.102320).  Saving model ...
Epoch: 3 cost time: 6.232998371124268
Epoch: 3, Steps: 10 | Train Loss: 2.405 Vali Loss: 3.342 Vali Acc: 0.135 Test Loss: 3.342 Test Acc: 0.135
Validation loss decreased (-0.102320 --> -0.135261).  Saving model ...
Epoch: 4 cost time: 5.308483123779297
Epoch: 4, Steps: 10 | Train Loss: 1.795 Vali Loss: 3.352 Vali Acc: 0.154 Test Loss: 3.352 Test Acc: 0.154
Validation loss decreased (-0.135261 --> -0.154084).  Saving model ...
Epoch: 5 cost time: 6.284583568572998
Epoch: 5, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.448 Vali Acc: 0.173 Test Loss: 3.448 Test Acc: 0.173
Validation loss decreased (-0.154084 --> -0.172907).  Saving model ...
Epoch: 6 cost time: 6.44830584526062
Epoch: 6, Steps: 10 | Train Loss: 0.945 Vali Loss: 3.540 Vali Acc: 0.185 Test Loss: 3.540 Test Acc: 0.185
Validation loss decreased (-0.172907 --> -0.184670).  Saving model ...
Epoch: 7 cost time: 6.384671449661255
Epoch: 7, Steps: 10 | Train Loss: 0.611 Vali Loss: 3.709 Vali Acc: 0.220 Test Loss: 3.709 Test Acc: 0.220
Validation loss decreased (-0.184670 --> -0.219963).  Saving model ...
Epoch: 8 cost time: 6.136855125427246
Epoch: 8, Steps: 10 | Train Loss: 0.372 Vali Loss: 3.845 Vali Acc: 0.224 Test Loss: 3.845 Test Acc: 0.224
Validation loss decreased (-0.219963 --> -0.223491).  Saving model ...
Epoch: 9 cost time: 5.888157606124878
Epoch: 9, Steps: 10 | Train Loss: 0.208 Vali Loss: 4.005 Vali Acc: 0.241 Test Loss: 4.005 Test Acc: 0.241
Validation loss decreased (-0.223491 --> -0.241136).  Saving model ...
Epoch: 10 cost time: 5.858007192611694
Epoch: 10, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.297 Vali Acc: 0.232 Test Loss: 4.297 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.739769458770752
Epoch: 11, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.342 Vali Acc: 0.251 Test Loss: 4.342 Test Acc: 0.251
Validation loss decreased (-0.241136 --> -0.250545).  Saving model ...
Epoch: 12 cost time: 6.241809129714966
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.544 Vali Acc: 0.240 Test Loss: 4.544 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.417508363723755
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.603 Vali Acc: 0.256 Test Loss: 4.603 Test Acc: 0.256
Validation loss decreased (-0.250545 --> -0.256425).  Saving model ...
Epoch: 14 cost time: 6.231795310974121
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.662 Vali Acc: 0.253 Test Loss: 4.662 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.923094749450684
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.695 Vali Acc: 0.255 Test Loss: 4.695 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.457616806030273
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.743 Vali Acc: 0.256 Test Loss: 4.743 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.887945652008057
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.752 Vali Acc: 0.258 Test Loss: 4.752 Test Acc: 0.258
Validation loss decreased (-0.256425 --> -0.257600).  Saving model ...
Epoch: 18 cost time: 6.898723363876343
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.769 Vali Acc: 0.256 Test Loss: 4.769 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.168016672134399
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.797 Vali Acc: 0.255 Test Loss: 4.797 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.3892974853515625
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.833 Vali Acc: 0.252 Test Loss: 4.833 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.323383808135986
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.855 Vali Acc: 0.252 Test Loss: 4.855 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.119223356246948
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.871 Vali Acc: 0.255 Test Loss: 4.871 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.512418031692505
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.895 Vali Acc: 0.258 Test Loss: 4.895 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.580230236053467
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.923 Vali Acc: 0.260 Test Loss: 4.923 Test Acc: 0.260
Validation loss decreased (-0.257600 --> -0.259951).  Saving model ...
Epoch: 25 cost time: 6.276078462600708
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.954 Vali Acc: 0.259 Test Loss: 4.954 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.355673789978027
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.978 Vali Acc: 0.255 Test Loss: 4.978 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.3533313274383545
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.000 Vali Acc: 0.258 Test Loss: 5.000 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.072771787643433
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.017 Vali Acc: 0.259 Test Loss: 5.017 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 7.086986780166626
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.040 Vali Acc: 0.259 Test Loss: 5.040 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.989099979400635
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.061 Vali Acc: 0.256 Test Loss: 5.061 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.97170090675354
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.079 Vali Acc: 0.260 Test Loss: 5.079 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 7.100574493408203
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.090 Vali Acc: 0.261 Test Loss: 5.090 Test Acc: 0.261
Validation loss decreased (-0.259951 --> -0.261126).  Saving model ...
Epoch: 33 cost time: 5.395089626312256
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.112 Vali Acc: 0.258 Test Loss: 5.112 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.023709058761597
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.135 Vali Acc: 0.259 Test Loss: 5.135 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.4065022468566895
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.153 Vali Acc: 0.260 Test Loss: 5.153 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.621867656707764
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.175 Vali Acc: 0.258 Test Loss: 5.175 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.113553524017334
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.187 Vali Acc: 0.256 Test Loss: 5.187 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 5.702444314956665
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.195 Vali Acc: 0.260 Test Loss: 5.195 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 6.190187692642212
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.212 Vali Acc: 0.258 Test Loss: 5.212 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 6.841548681259155
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.222 Vali Acc: 0.258 Test Loss: 5.222 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 6.029501438140869
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.235 Vali Acc: 0.258 Test Loss: 5.235 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 7.630121231079102
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.253 Vali Acc: 0.258 Test Loss: 5.253 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 1955098
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 9.175196170806885
Epoch: 1, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.329 Vali Acc: 0.046 Test Loss: 3.329 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 5.533331871032715
Epoch: 2, Steps: 10 | Train Loss: 2.989 Vali Loss: 3.390 Vali Acc: 0.066 Test Loss: 3.390 Test Acc: 0.066
Validation loss decreased (-0.045849 --> -0.065848).  Saving model ...
Epoch: 3 cost time: 5.568523645401001
Epoch: 3, Steps: 10 | Train Loss: 2.539 Vali Loss: 3.410 Vali Acc: 0.075 Test Loss: 3.410 Test Acc: 0.075
Validation loss decreased (-0.065848 --> -0.075260).  Saving model ...
Epoch: 4 cost time: 6.8681252002716064
Epoch: 4, Steps: 10 | Train Loss: 1.951 Vali Loss: 3.400 Vali Acc: 0.089 Test Loss: 3.400 Test Acc: 0.089
Validation loss decreased (-0.075260 --> -0.089378).  Saving model ...
Epoch: 5 cost time: 6.455413103103638
Epoch: 5, Steps: 10 | Train Loss: 1.409 Vali Loss: 3.499 Vali Acc: 0.100 Test Loss: 3.499 Test Acc: 0.100
Validation loss decreased (-0.089378 --> -0.099965).  Saving model ...
Epoch: 6 cost time: 6.238558292388916
Epoch: 6, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.635 Vali Acc: 0.114 Test Loss: 3.635 Test Acc: 0.114
Validation loss decreased (-0.099965 --> -0.114081).  Saving model ...
Epoch: 7 cost time: 6.016540765762329
Epoch: 7, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.872 Vali Acc: 0.122 Test Loss: 3.872 Test Acc: 0.122
Validation loss decreased (-0.114081 --> -0.122314).  Saving model ...
Epoch: 8 cost time: 5.491716146469116
Epoch: 8, Steps: 10 | Train Loss: 0.305 Vali Loss: 4.102 Vali Acc: 0.131 Test Loss: 4.102 Test Acc: 0.131
Validation loss decreased (-0.122314 --> -0.130547).  Saving model ...
Epoch: 9 cost time: 5.921802043914795
Epoch: 9, Steps: 10 | Train Loss: 0.150 Vali Loss: 4.421 Vali Acc: 0.126 Test Loss: 4.421 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.832192659378052
Epoch: 10, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.602 Vali Acc: 0.131 Test Loss: 4.602 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.101522207260132
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.774 Vali Acc: 0.141 Test Loss: 4.774 Test Acc: 0.141
Validation loss decreased (-0.130547 --> -0.141129).  Saving model ...
Epoch: 12 cost time: 5.848694562911987
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.908 Vali Acc: 0.136 Test Loss: 4.908 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.616235733032227
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.949 Vali Acc: 0.145 Test Loss: 4.949 Test Acc: 0.145
Validation loss decreased (-0.141129 --> -0.144656).  Saving model ...
Epoch: 14 cost time: 5.825568437576294
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.002 Vali Acc: 0.147 Test Loss: 5.002 Test Acc: 0.147
Validation loss decreased (-0.144656 --> -0.147009).  Saving model ...
Epoch: 15 cost time: 6.023254632949829
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.020 Vali Acc: 0.151 Test Loss: 5.020 Test Acc: 0.151
Validation loss decreased (-0.147009 --> -0.150538).  Saving model ...
Epoch: 16 cost time: 5.776004076004028
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.051 Vali Acc: 0.152 Test Loss: 5.051 Test Acc: 0.152
Validation loss decreased (-0.150538 --> -0.151714).  Saving model ...
Epoch: 17 cost time: 7.126972198486328
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.085 Vali Acc: 0.151 Test Loss: 5.085 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.22920823097229
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.130 Vali Acc: 0.152 Test Loss: 5.130 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.258608341217041
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.168 Vali Acc: 0.151 Test Loss: 5.168 Test Acc: 0.151
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.2894721031188965
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.200 Vali Acc: 0.149 Test Loss: 5.200 Test Acc: 0.149
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.5383617877960205
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.231 Vali Acc: 0.155 Test Loss: 5.231 Test Acc: 0.155
Validation loss decreased (-0.151714 --> -0.155242).  Saving model ...
Epoch: 22 cost time: 6.3346168994903564
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.241 Vali Acc: 0.153 Test Loss: 5.241 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.66256856918335
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.263 Vali Acc: 0.149 Test Loss: 5.263 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.050896644592285
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.293 Vali Acc: 0.151 Test Loss: 5.293 Test Acc: 0.151
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.258780002593994
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.336 Vali Acc: 0.154 Test Loss: 5.336 Test Acc: 0.154
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.937442779541016
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.359 Vali Acc: 0.155 Test Loss: 5.359 Test Acc: 0.155
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.9479005336761475
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.376 Vali Acc: 0.156 Test Loss: 5.376 Test Acc: 0.156
Validation loss decreased (-0.155242 --> -0.156417).  Saving model ...
Epoch: 28 cost time: 7.606760025024414
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.392 Vali Acc: 0.155 Test Loss: 5.392 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.870966196060181
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.420 Vali Acc: 0.159 Test Loss: 5.420 Test Acc: 0.159
Validation loss decreased (-0.156417 --> -0.158769).  Saving model ...
Epoch: 30 cost time: 6.426535129547119
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.439 Vali Acc: 0.155 Test Loss: 5.439 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.385168075561523
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.452 Vali Acc: 0.156 Test Loss: 5.452 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.6384501457214355
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.466 Vali Acc: 0.156 Test Loss: 5.466 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.427074670791626
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.493 Vali Acc: 0.158 Test Loss: 5.493 Test Acc: 0.158
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.482537269592285
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.525 Vali Acc: 0.159 Test Loss: 5.525 Test Acc: 0.159
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.913697242736816
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.546 Vali Acc: 0.158 Test Loss: 5.546 Test Acc: 0.158
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 7.54197883605957
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.564 Vali Acc: 0.155 Test Loss: 5.564 Test Acc: 0.155
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.885448217391968
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.574 Vali Acc: 0.154 Test Loss: 5.574 Test Acc: 0.154
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 6.644703388214111
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.588 Vali Acc: 0.155 Test Loss: 5.588 Test Acc: 0.155
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 5.790457248687744
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.601 Vali Acc: 0.161 Test Loss: 5.601 Test Acc: 0.161
Validation loss decreased (-0.158769 --> -0.161120).  Saving model ...
Epoch: 40 cost time: 6.238697528839111
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.614 Vali Acc: 0.160 Test Loss: 5.614 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.6758973598480225
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.624 Vali Acc: 0.161 Test Loss: 5.624 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.287516832351685
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.642 Vali Acc: 0.159 Test Loss: 5.642 Test Acc: 0.159
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.395337343215942
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.659 Vali Acc: 0.160 Test Loss: 5.659 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.080556392669678
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.673 Vali Acc: 0.159 Test Loss: 5.673 Test Acc: 0.159
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 5.408064365386963
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.690 Vali Acc: 0.160 Test Loss: 5.690 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 5.861786127090454
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.701 Vali Acc: 0.162 Test Loss: 5.701 Test Acc: 0.162
Validation loss decreased (-0.161120 --> -0.162296).  Saving model ...
Epoch: 47 cost time: 6.810981035232544
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.730 Vali Acc: 0.162 Test Loss: 5.730 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 6.468880891799927
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.747 Vali Acc: 0.161 Test Loss: 5.747 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 6.086339950561523
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.760 Vali Acc: 0.159 Test Loss: 5.760 Test Acc: 0.159
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 7.163176536560059
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.768 Vali Acc: 0.159 Test Loss: 5.768 Test Acc: 0.159
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 6.889267206192017
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.783 Vali Acc: 0.161 Test Loss: 5.783 Test Acc: 0.161
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 7.131629228591919
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.799 Vali Acc: 0.161 Test Loss: 5.799 Test Acc: 0.161
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 5.4900126457214355
Epoch: 53, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.812 Vali Acc: 0.160 Test Loss: 5.812 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 6.294875860214233
Epoch: 54, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.819 Vali Acc: 0.161 Test Loss: 5.819 Test Acc: 0.161
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 6.383242845535278
Epoch: 55, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.827 Vali Acc: 0.161 Test Loss: 5.827 Test Acc: 0.161
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 6.615128517150879
Epoch: 56, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.835 Vali Acc: 0.161 Test Loss: 5.835 Test Acc: 0.161
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1623529411764706
model parameter : 1955098
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 7.3349831104278564
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.308 Vali Acc: 0.042 Test Loss: 3.308 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 6.638501405715942
Epoch: 2, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.385 Vali Acc: 0.055 Test Loss: 3.385 Test Acc: 0.055
Validation loss decreased (-0.042320 --> -0.055260).  Saving model ...
Epoch: 3 cost time: 5.807289361953735
Epoch: 3, Steps: 10 | Train Loss: 2.737 Vali Loss: 3.413 Vali Acc: 0.067 Test Loss: 3.413 Test Acc: 0.067
Validation loss decreased (-0.055260 --> -0.067025).  Saving model ...
Epoch: 4 cost time: 5.4404966831207275
Epoch: 4, Steps: 10 | Train Loss: 2.337 Vali Loss: 3.376 Vali Acc: 0.074 Test Loss: 3.376 Test Acc: 0.074
Validation loss decreased (-0.067025 --> -0.074084).  Saving model ...
Epoch: 5 cost time: 6.139486312866211
Epoch: 5, Steps: 10 | Train Loss: 1.863 Vali Loss: 3.405 Vali Acc: 0.089 Test Loss: 3.405 Test Acc: 0.089
Validation loss decreased (-0.074084 --> -0.089378).  Saving model ...
Epoch: 6 cost time: 5.316484212875366
Epoch: 6, Steps: 10 | Train Loss: 1.402 Vali Loss: 3.482 Vali Acc: 0.085 Test Loss: 3.482 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.510018587112427
Epoch: 7, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.632 Vali Acc: 0.098 Test Loss: 3.632 Test Acc: 0.098
Validation loss decreased (-0.089378 --> -0.097611).  Saving model ...
Epoch: 8 cost time: 5.63680362701416
Epoch: 8, Steps: 10 | Train Loss: 0.592 Vali Loss: 3.805 Vali Acc: 0.102 Test Loss: 3.805 Test Acc: 0.102
Validation loss decreased (-0.097611 --> -0.102315).  Saving model ...
Epoch: 9 cost time: 6.1248884201049805
Epoch: 9, Steps: 10 | Train Loss: 0.309 Vali Loss: 4.047 Vali Acc: 0.106 Test Loss: 4.047 Test Acc: 0.106
Validation loss decreased (-0.102315 --> -0.105842).  Saving model ...
Epoch: 10 cost time: 6.129626989364624
Epoch: 10, Steps: 10 | Train Loss: 0.138 Vali Loss: 4.309 Vali Acc: 0.111 Test Loss: 4.309 Test Acc: 0.111
Validation loss decreased (-0.105842 --> -0.110545).  Saving model ...
Epoch: 11 cost time: 6.803947687149048
Epoch: 11, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.501 Vali Acc: 0.121 Test Loss: 4.501 Test Acc: 0.121
Validation loss decreased (-0.110545 --> -0.121131).  Saving model ...
Epoch: 12 cost time: 7.414007663726807
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.666 Vali Acc: 0.120 Test Loss: 4.666 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.159282922744751
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.870 Vali Acc: 0.112 Test Loss: 4.870 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.433166265487671
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.862 Vali Acc: 0.114 Test Loss: 4.862 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.827043533325195
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.895 Vali Acc: 0.119 Test Loss: 4.895 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.9789206981658936
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.934 Vali Acc: 0.115 Test Loss: 4.934 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.5328333377838135
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.951 Vali Acc: 0.124 Test Loss: 4.951 Test Acc: 0.124
Validation loss decreased (-0.121131 --> -0.123480).  Saving model ...
Epoch: 18 cost time: 6.2767252922058105
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.004 Vali Acc: 0.120 Test Loss: 5.004 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.849505662918091
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.039 Vali Acc: 0.121 Test Loss: 5.039 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.723718881607056
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.052 Vali Acc: 0.118 Test Loss: 5.052 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.384493827819824
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.070 Vali Acc: 0.116 Test Loss: 5.070 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.1826348304748535
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.076 Vali Acc: 0.118 Test Loss: 5.076 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.626188516616821
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.100 Vali Acc: 0.122 Test Loss: 5.100 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.498795986175537
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.145 Vali Acc: 0.121 Test Loss: 5.145 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.897859334945679
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.183 Vali Acc: 0.124 Test Loss: 5.183 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.549361705780029
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.195 Vali Acc: 0.127 Test Loss: 5.195 Test Acc: 0.127
Validation loss decreased (-0.123480 --> -0.127007).  Saving model ...
Epoch: 27 cost time: 5.838022232055664
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.218 Vali Acc: 0.128 Test Loss: 5.218 Test Acc: 0.128
Validation loss decreased (-0.127007 --> -0.128183).  Saving model ...
Epoch: 28 cost time: 6.606492519378662
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.242 Vali Acc: 0.125 Test Loss: 5.242 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.476860761642456
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.261 Vali Acc: 0.126 Test Loss: 5.261 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.4696033000946045
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.270 Vali Acc: 0.125 Test Loss: 5.270 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.955889463424683
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.281 Vali Acc: 0.126 Test Loss: 5.281 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.937654972076416
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.299 Vali Acc: 0.126 Test Loss: 5.299 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.830393314361572
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.322 Vali Acc: 0.126 Test Loss: 5.322 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 6.555685043334961
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.347 Vali Acc: 0.129 Test Loss: 5.347 Test Acc: 0.129
Validation loss decreased (-0.128183 --> -0.129358).  Saving model ...
Epoch: 35 cost time: 5.17499303817749
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.363 Vali Acc: 0.131 Test Loss: 5.363 Test Acc: 0.131
Validation loss decreased (-0.129358 --> -0.130535).  Saving model ...
Epoch: 36 cost time: 5.248554468154907
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.377 Vali Acc: 0.131 Test Loss: 5.377 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.93739128112793
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.381 Vali Acc: 0.131 Test Loss: 5.381 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.8359503746032715
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.392 Vali Acc: 0.132 Test Loss: 5.392 Test Acc: 0.132
Validation loss decreased (-0.130535 --> -0.131711).  Saving model ...
Epoch: 39 cost time: 5.952880859375
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.405 Vali Acc: 0.131 Test Loss: 5.405 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.440083026885986
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.421 Vali Acc: 0.131 Test Loss: 5.421 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.17864727973938
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.432 Vali Acc: 0.131 Test Loss: 5.432 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 5.849987030029297
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.451 Vali Acc: 0.131 Test Loss: 5.451 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 6.188497543334961
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.468 Vali Acc: 0.131 Test Loss: 5.468 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 6.419245719909668
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.483 Vali Acc: 0.131 Test Loss: 5.483 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 7.017212867736816
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.494 Vali Acc: 0.131 Test Loss: 5.494 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 6.400075912475586
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.503 Vali Acc: 0.129 Test Loss: 5.503 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 6.746506452560425
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.524 Vali Acc: 0.128 Test Loss: 5.524 Test Acc: 0.128
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 5.839679479598999
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.536 Vali Acc: 0.127 Test Loss: 5.536 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13176470588235295
model parameter : 1955098
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.737967491149902
Epoch: 1, Steps: 10 | Train Loss: 3.303 Vali Loss: 3.334 Vali Acc: 0.034 Test Loss: 3.334 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 5.943127155303955
Epoch: 2, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.400 Vali Acc: 0.045 Test Loss: 3.400 Test Acc: 0.045
Validation loss decreased (-0.034084 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 5.573763608932495
Epoch: 3, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.450 Vali Acc: 0.059 Test Loss: 3.450 Test Acc: 0.059
Validation loss decreased (-0.044672 --> -0.058789).  Saving model ...
Epoch: 4 cost time: 5.341614484786987
Epoch: 4, Steps: 10 | Train Loss: 2.604 Vali Loss: 3.396 Vali Acc: 0.058 Test Loss: 3.396 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.1866888999938965
Epoch: 5, Steps: 10 | Train Loss: 2.275 Vali Loss: 3.397 Vali Acc: 0.073 Test Loss: 3.397 Test Acc: 0.073
Validation loss decreased (-0.058789 --> -0.072907).  Saving model ...
Epoch: 6 cost time: 4.947969198226929
Epoch: 6, Steps: 10 | Train Loss: 1.868 Vali Loss: 3.418 Vali Acc: 0.074 Test Loss: 3.418 Test Acc: 0.074
Validation loss decreased (-0.072907 --> -0.074083).  Saving model ...
Epoch: 7 cost time: 5.849823951721191
Epoch: 7, Steps: 10 | Train Loss: 1.438 Vali Loss: 3.514 Vali Acc: 0.076 Test Loss: 3.514 Test Acc: 0.076
Validation loss decreased (-0.074083 --> -0.076435).  Saving model ...
Epoch: 8 cost time: 5.570517539978027
Epoch: 8, Steps: 10 | Train Loss: 1.068 Vali Loss: 3.661 Vali Acc: 0.087 Test Loss: 3.661 Test Acc: 0.087
Validation loss decreased (-0.076435 --> -0.087022).  Saving model ...
Epoch: 9 cost time: 5.2144739627838135
Epoch: 9, Steps: 10 | Train Loss: 0.650 Vali Loss: 3.908 Vali Acc: 0.098 Test Loss: 3.908 Test Acc: 0.098
Validation loss decreased (-0.087022 --> -0.097608).  Saving model ...
Epoch: 10 cost time: 5.9378135204315186
Epoch: 10, Steps: 10 | Train Loss: 0.364 Vali Loss: 4.197 Vali Acc: 0.101 Test Loss: 4.197 Test Acc: 0.101
Validation loss decreased (-0.097608 --> -0.101134).  Saving model ...
Epoch: 11 cost time: 6.524883031845093
Epoch: 11, Steps: 10 | Train Loss: 0.193 Vali Loss: 4.392 Vali Acc: 0.105 Test Loss: 4.392 Test Acc: 0.105
Validation loss decreased (-0.101134 --> -0.104662).  Saving model ...
Epoch: 12 cost time: 6.396275758743286
Epoch: 12, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.648 Vali Acc: 0.114 Test Loss: 4.648 Test Acc: 0.114
Validation loss decreased (-0.104662 --> -0.114071).  Saving model ...
Epoch: 13 cost time: 6.674803972244263
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.855 Vali Acc: 0.116 Test Loss: 4.855 Test Acc: 0.116
Validation loss decreased (-0.114071 --> -0.116422).  Saving model ...
Epoch: 14 cost time: 7.066624879837036
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.822 Vali Acc: 0.124 Test Loss: 4.822 Test Acc: 0.124
Validation loss decreased (-0.116422 --> -0.123481).  Saving model ...
Epoch: 15 cost time: 6.874471664428711
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.855 Vali Acc: 0.116 Test Loss: 4.855 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.972301483154297
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.938 Vali Acc: 0.122 Test Loss: 4.938 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.7715744972229
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.032 Vali Acc: 0.126 Test Loss: 5.032 Test Acc: 0.126
Validation loss decreased (-0.123481 --> -0.125832).  Saving model ...
Epoch: 18 cost time: 6.249661684036255
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.102 Vali Acc: 0.128 Test Loss: 5.102 Test Acc: 0.128
Validation loss decreased (-0.125832 --> -0.128184).  Saving model ...
Epoch: 19 cost time: 6.173652172088623
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.129 Vali Acc: 0.125 Test Loss: 5.129 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.127657413482666
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.131 Vali Acc: 0.121 Test Loss: 5.131 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.739858150482178
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.134 Vali Acc: 0.120 Test Loss: 5.134 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.244914770126343
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.145 Vali Acc: 0.125 Test Loss: 5.145 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.96773886680603
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.160 Vali Acc: 0.126 Test Loss: 5.160 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.893131494522095
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.182 Vali Acc: 0.122 Test Loss: 5.182 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.375037431716919
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.212 Vali Acc: 0.124 Test Loss: 5.212 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.427176475524902
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.234 Vali Acc: 0.124 Test Loss: 5.234 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.1315624713897705
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.265 Vali Acc: 0.127 Test Loss: 5.265 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.149364948272705
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.284 Vali Acc: 0.127 Test Loss: 5.284 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12823529411764706
model parameter : 1955098
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 7.847792148590088
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.322 Vali Acc: 0.036 Test Loss: 3.322 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 5.23120379447937
Epoch: 2, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.383 Vali Acc: 0.052 Test Loss: 3.383 Test Acc: 0.052
Validation loss decreased (-0.036437 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 5.039278268814087
Epoch: 3, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.452 Vali Acc: 0.064 Test Loss: 3.452 Test Acc: 0.064
Validation loss decreased (-0.051731 --> -0.063495).  Saving model ...
Epoch: 4 cost time: 5.161008358001709
Epoch: 4, Steps: 10 | Train Loss: 2.727 Vali Loss: 3.401 Vali Acc: 0.059 Test Loss: 3.401 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.856127023696899
Epoch: 5, Steps: 10 | Train Loss: 2.535 Vali Loss: 3.356 Vali Acc: 0.080 Test Loss: 3.356 Test Acc: 0.080
Validation loss decreased (-0.063495 --> -0.079966).  Saving model ...
Epoch: 6 cost time: 5.071510076522827
Epoch: 6, Steps: 10 | Train Loss: 2.154 Vali Loss: 3.371 Vali Acc: 0.086 Test Loss: 3.371 Test Acc: 0.086
Validation loss decreased (-0.079966 --> -0.085849).  Saving model ...
Epoch: 7 cost time: 5.5639426708221436
Epoch: 7, Steps: 10 | Train Loss: 1.831 Vali Loss: 3.441 Vali Acc: 0.086 Test Loss: 3.441 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.506349802017212
Epoch: 8, Steps: 10 | Train Loss: 1.473 Vali Loss: 3.514 Vali Acc: 0.093 Test Loss: 3.514 Test Acc: 0.093
Validation loss decreased (-0.085849 --> -0.092906).  Saving model ...
Epoch: 9 cost time: 5.914501190185547
Epoch: 9, Steps: 10 | Train Loss: 0.995 Vali Loss: 3.638 Vali Acc: 0.094 Test Loss: 3.638 Test Acc: 0.094
Validation loss decreased (-0.092906 --> -0.094081).  Saving model ...
Epoch: 10 cost time: 6.226047515869141
Epoch: 10, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.896 Vali Acc: 0.105 Test Loss: 3.896 Test Acc: 0.105
Validation loss decreased (-0.094081 --> -0.104667).  Saving model ...
Epoch: 11 cost time: 4.796627759933472
Epoch: 11, Steps: 10 | Train Loss: 0.389 Vali Loss: 4.029 Vali Acc: 0.112 Test Loss: 4.029 Test Acc: 0.112
Validation loss decreased (-0.104667 --> -0.111724).  Saving model ...
Epoch: 12 cost time: 4.731836795806885
Epoch: 12, Steps: 10 | Train Loss: 0.188 Vali Loss: 4.293 Vali Acc: 0.120 Test Loss: 4.293 Test Acc: 0.120
Validation loss decreased (-0.111724 --> -0.119957).  Saving model ...
Epoch: 13 cost time: 5.4800028800964355
Epoch: 13, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.444 Vali Acc: 0.116 Test Loss: 4.444 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.167184352874756
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.541 Vali Acc: 0.128 Test Loss: 4.541 Test Acc: 0.128
Validation loss decreased (-0.119957 --> -0.128190).  Saving model ...
Epoch: 15 cost time: 5.481631278991699
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.633 Vali Acc: 0.118 Test Loss: 4.633 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.121776103973389
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.727 Vali Acc: 0.122 Test Loss: 4.727 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.592211008071899
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.839 Vali Acc: 0.112 Test Loss: 4.839 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.902862787246704
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.888 Vali Acc: 0.119 Test Loss: 4.888 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.35954737663269
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.906 Vali Acc: 0.119 Test Loss: 4.906 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.103277921676636
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.902 Vali Acc: 0.121 Test Loss: 4.902 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.819546699523926
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.912 Vali Acc: 0.127 Test Loss: 4.912 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.657304048538208
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.921 Vali Acc: 0.131 Test Loss: 4.921 Test Acc: 0.131
Validation loss decreased (-0.128190 --> -0.130539).  Saving model ...
Epoch: 23 cost time: 6.264554738998413
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.926 Vali Acc: 0.134 Test Loss: 4.926 Test Acc: 0.134
Validation loss decreased (-0.130539 --> -0.134068).  Saving model ...
Epoch: 24 cost time: 6.869844198226929
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.942 Vali Acc: 0.128 Test Loss: 4.942 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.571444511413574
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.992 Vali Acc: 0.126 Test Loss: 4.992 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.7415502071380615
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.024 Vali Acc: 0.127 Test Loss: 5.024 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.56075119972229
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.055 Vali Acc: 0.131 Test Loss: 5.055 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.767220497131348
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.062 Vali Acc: 0.131 Test Loss: 5.062 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.031938314437866
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.085 Vali Acc: 0.135 Test Loss: 5.085 Test Acc: 0.135
Validation loss decreased (-0.134068 --> -0.135243).  Saving model ...
Epoch: 30 cost time: 6.219536304473877
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.096 Vali Acc: 0.136 Test Loss: 5.096 Test Acc: 0.136
Validation loss decreased (-0.135243 --> -0.136420).  Saving model ...
Epoch: 31 cost time: 6.958932399749756
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.100 Vali Acc: 0.135 Test Loss: 5.100 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.984934568405151
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.097 Vali Acc: 0.133 Test Loss: 5.097 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.940929651260376
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.104 Vali Acc: 0.132 Test Loss: 5.104 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.686358451843262
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.129 Vali Acc: 0.133 Test Loss: 5.129 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 5.986420154571533
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.152 Vali Acc: 0.133 Test Loss: 5.152 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 7.37197208404541
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.178 Vali Acc: 0.134 Test Loss: 5.178 Test Acc: 0.134
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 6.424066066741943
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.185 Vali Acc: 0.136 Test Loss: 5.185 Test Acc: 0.136
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 6.862393140792847
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.199 Vali Acc: 0.136 Test Loss: 5.199 Test Acc: 0.136
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 7.080604076385498
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.213 Vali Acc: 0.139 Test Loss: 5.213 Test Acc: 0.139
Validation loss decreased (-0.136420 --> -0.138771).  Saving model ...
Epoch: 40 cost time: 6.116801738739014
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.232 Vali Acc: 0.136 Test Loss: 5.232 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.366699695587158
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.235 Vali Acc: 0.138 Test Loss: 5.235 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.646793603897095
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.240 Vali Acc: 0.138 Test Loss: 5.240 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 7.150029182434082
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.248 Vali Acc: 0.131 Test Loss: 5.248 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.5790934562683105
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.260 Vali Acc: 0.129 Test Loss: 5.260 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 6.218702793121338
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.270 Vali Acc: 0.132 Test Loss: 5.270 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 6.743391275405884
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.275 Vali Acc: 0.129 Test Loss: 5.275 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 7.0953497886657715
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.308 Vali Acc: 0.129 Test Loss: 5.308 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 6.954158306121826
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.325 Vali Acc: 0.132 Test Loss: 5.325 Test Acc: 0.132
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 7.127071857452393
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.338 Vali Acc: 0.132 Test Loss: 5.338 Test Acc: 0.132
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1388235294117647
model parameter : 1955098
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.160372495651245
Epoch: 1, Steps: 10 | Train Loss: 3.260 Vali Loss: 3.321 Vali Acc: 0.036 Test Loss: 3.321 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 6.500691890716553
Epoch: 2, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.381 Vali Acc: 0.052 Test Loss: 3.381 Test Acc: 0.052
Validation loss decreased (-0.036437 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 6.445097208023071
Epoch: 3, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.444 Vali Acc: 0.053 Test Loss: 3.444 Test Acc: 0.053
Validation loss decreased (-0.051731 --> -0.052907).  Saving model ...
Epoch: 4 cost time: 6.477236986160278
Epoch: 4, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.389 Vali Acc: 0.060 Test Loss: 3.389 Test Acc: 0.060
Validation loss decreased (-0.052907 --> -0.059966).  Saving model ...
Epoch: 5 cost time: 6.5762128829956055
Epoch: 5, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.367 Vali Acc: 0.072 Test Loss: 3.367 Test Acc: 0.072
Validation loss decreased (-0.059966 --> -0.071731).  Saving model ...
Epoch: 6 cost time: 6.1159186363220215
Epoch: 6, Steps: 10 | Train Loss: 2.363 Vali Loss: 3.355 Vali Acc: 0.081 Test Loss: 3.355 Test Acc: 0.081
Validation loss decreased (-0.071731 --> -0.081143).  Saving model ...
Epoch: 7 cost time: 5.475809812545776
Epoch: 7, Steps: 10 | Train Loss: 2.097 Vali Loss: 3.396 Vali Acc: 0.080 Test Loss: 3.396 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.373346328735352
Epoch: 8, Steps: 10 | Train Loss: 1.750 Vali Loss: 3.466 Vali Acc: 0.088 Test Loss: 3.466 Test Acc: 0.088
Validation loss decreased (-0.081143 --> -0.088201).  Saving model ...
Epoch: 9 cost time: 5.895399570465088
Epoch: 9, Steps: 10 | Train Loss: 1.291 Vali Loss: 3.608 Vali Acc: 0.098 Test Loss: 3.608 Test Acc: 0.098
Validation loss decreased (-0.088201 --> -0.097611).  Saving model ...
Epoch: 10 cost time: 5.949559926986694
Epoch: 10, Steps: 10 | Train Loss: 0.923 Vali Loss: 3.853 Vali Acc: 0.107 Test Loss: 3.853 Test Acc: 0.107
Validation loss decreased (-0.097611 --> -0.107020).  Saving model ...
Epoch: 11 cost time: 5.622409343719482
Epoch: 11, Steps: 10 | Train Loss: 0.593 Vali Loss: 3.990 Vali Acc: 0.118 Test Loss: 3.990 Test Acc: 0.118
Validation loss decreased (-0.107020 --> -0.117607).  Saving model ...
Epoch: 12 cost time: 5.522061109542847
Epoch: 12, Steps: 10 | Train Loss: 0.336 Vali Loss: 4.219 Vali Acc: 0.115 Test Loss: 4.219 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.046512126922607
Epoch: 13, Steps: 10 | Train Loss: 0.181 Vali Loss: 4.294 Vali Acc: 0.136 Test Loss: 4.294 Test Acc: 0.136
Validation loss decreased (-0.117607 --> -0.136428).  Saving model ...
Epoch: 14 cost time: 5.275937080383301
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.481 Vali Acc: 0.142 Test Loss: 4.481 Test Acc: 0.142
Validation loss decreased (-0.136428 --> -0.142308).  Saving model ...
Epoch: 15 cost time: 4.608942270278931
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.498 Vali Acc: 0.138 Test Loss: 4.498 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.080158948898315
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.678 Vali Acc: 0.141 Test Loss: 4.678 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.183037757873535
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.774 Vali Acc: 0.145 Test Loss: 4.774 Test Acc: 0.145
Validation loss decreased (-0.142308 --> -0.144658).  Saving model ...
Epoch: 18 cost time: 4.872992753982544
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.776 Vali Acc: 0.145 Test Loss: 4.776 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.2754199504852295
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.768 Vali Acc: 0.145 Test Loss: 4.768 Test Acc: 0.145
Validation loss decreased (-0.144658 --> -0.144658).  Saving model ...
Epoch: 20 cost time: 4.625425338745117
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.800 Vali Acc: 0.145 Test Loss: 4.800 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.1965203285217285
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.810 Vali Acc: 0.147 Test Loss: 4.810 Test Acc: 0.147
Validation loss decreased (-0.144658 --> -0.147011).  Saving model ...
Epoch: 22 cost time: 5.540219306945801
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.818 Vali Acc: 0.147 Test Loss: 4.818 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.595704555511475
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.843 Vali Acc: 0.155 Test Loss: 4.843 Test Acc: 0.155
Validation loss decreased (-0.147011 --> -0.155246).  Saving model ...
Epoch: 24 cost time: 5.46704363822937
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.888 Vali Acc: 0.153 Test Loss: 4.888 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.883466005325317
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.936 Vali Acc: 0.152 Test Loss: 4.936 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.077970743179321
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.976 Vali Acc: 0.149 Test Loss: 4.976 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.431469917297363
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.006 Vali Acc: 0.152 Test Loss: 5.006 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.447803258895874
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.025 Vali Acc: 0.155 Test Loss: 5.025 Test Acc: 0.155
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.10695219039917
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.069 Vali Acc: 0.151 Test Loss: 5.069 Test Acc: 0.151
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.310889005661011
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.089 Vali Acc: 0.149 Test Loss: 5.089 Test Acc: 0.149
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.426774501800537
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.100 Vali Acc: 0.153 Test Loss: 5.100 Test Acc: 0.153
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.632850646972656
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.077 Vali Acc: 0.155 Test Loss: 5.077 Test Acc: 0.155
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.68651819229126
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.085 Vali Acc: 0.154 Test Loss: 5.085 Test Acc: 0.154
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15529411764705883
model parameter : 1955098
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.70251989364624
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.039 Test Loss: 3.258 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 4.9456329345703125
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.2348432540893555
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.670748472213745
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.022462606430054
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.316192626953125
Epoch: 6, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.461951494216919
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.7374587059021
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.949940919876099
Epoch: 9, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.418250322341919
Epoch: 10, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.683041095733643
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.03882352941176471
model parameter : 1955098
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.050752878189087
Epoch: 1, Steps: 10 | Train Loss: 3.360 Vali Loss: 3.296 Vali Acc: 0.047 Test Loss: 3.296 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 4.6841630935668945
Epoch: 2, Steps: 10 | Train Loss: 2.957 Vali Loss: 3.316 Vali Acc: 0.098 Test Loss: 3.316 Test Acc: 0.098
Validation loss decreased (-0.047026 --> -0.097614).  Saving model ...
Epoch: 3 cost time: 4.048906326293945
Epoch: 3, Steps: 10 | Train Loss: 2.337 Vali Loss: 3.182 Vali Acc: 0.148 Test Loss: 3.182 Test Acc: 0.148
Validation loss decreased (-0.097614 --> -0.148203).  Saving model ...
Epoch: 4 cost time: 4.725379467010498
Epoch: 4, Steps: 10 | Train Loss: 1.711 Vali Loss: 3.162 Vali Acc: 0.204 Test Loss: 3.162 Test Acc: 0.204
Validation loss decreased (-0.148203 --> -0.203498).  Saving model ...
Epoch: 5 cost time: 4.095907926559448
Epoch: 5, Steps: 10 | Train Loss: 1.150 Vali Loss: 3.181 Vali Acc: 0.209 Test Loss: 3.181 Test Acc: 0.209
Validation loss decreased (-0.203498 --> -0.209380).  Saving model ...
Epoch: 6 cost time: 4.523189306259155
Epoch: 6, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.257 Vali Acc: 0.248 Test Loss: 3.257 Test Acc: 0.248
Validation loss decreased (-0.209380 --> -0.248203).  Saving model ...
Epoch: 7 cost time: 4.42290997505188
Epoch: 7, Steps: 10 | Train Loss: 0.447 Vali Loss: 3.438 Vali Acc: 0.258 Test Loss: 3.438 Test Acc: 0.258
Validation loss decreased (-0.248203 --> -0.257613).  Saving model ...
Epoch: 8 cost time: 4.515915870666504
Epoch: 8, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.568 Vali Acc: 0.268 Test Loss: 3.568 Test Acc: 0.268
Validation loss decreased (-0.257613 --> -0.268200).  Saving model ...
Epoch: 9 cost time: 4.1474244594573975
Epoch: 9, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.708 Vali Acc: 0.274 Test Loss: 3.708 Test Acc: 0.274
Validation loss decreased (-0.268200 --> -0.274081).  Saving model ...
Epoch: 10 cost time: 4.115471601486206
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.791 Vali Acc: 0.298 Test Loss: 3.791 Test Acc: 0.298
Validation loss decreased (-0.274081 --> -0.297609).  Saving model ...
Epoch: 11 cost time: 4.50071382522583
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.893 Vali Acc: 0.289 Test Loss: 3.893 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.731266260147095
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.028 Vali Acc: 0.293 Test Loss: 4.028 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.811896085739136
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.039 Vali Acc: 0.300 Test Loss: 4.039 Test Acc: 0.300
Validation loss decreased (-0.297609 --> -0.299960).  Saving model ...
Epoch: 14 cost time: 4.901746511459351
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.067 Vali Acc: 0.295 Test Loss: 4.067 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.5841662883758545
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.109 Vali Acc: 0.298 Test Loss: 4.109 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.356180906295776
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.136 Vali Acc: 0.300 Test Loss: 4.136 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.470655202865601
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.148 Vali Acc: 0.301 Test Loss: 4.148 Test Acc: 0.301
Validation loss decreased (-0.299960 --> -0.301135).  Saving model ...
Epoch: 18 cost time: 4.201070308685303
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.185 Vali Acc: 0.302 Test Loss: 4.185 Test Acc: 0.302
Validation loss decreased (-0.301135 --> -0.302311).  Saving model ...
Epoch: 19 cost time: 4.680348873138428
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.202 Vali Acc: 0.299 Test Loss: 4.202 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.375549793243408
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.236 Vali Acc: 0.302 Test Loss: 4.236 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.317793369293213
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.265 Vali Acc: 0.301 Test Loss: 4.265 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.160165071487427
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.291 Vali Acc: 0.306 Test Loss: 4.291 Test Acc: 0.306
Validation loss decreased (-0.302311 --> -0.305839).  Saving model ...
Epoch: 23 cost time: 4.588992595672607
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.306 Vali Acc: 0.307 Test Loss: 4.306 Test Acc: 0.307
Validation loss decreased (-0.305839 --> -0.307016).  Saving model ...
Epoch: 24 cost time: 4.7352564334869385
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.324 Vali Acc: 0.307 Test Loss: 4.324 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.145009994506836
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.341 Vali Acc: 0.306 Test Loss: 4.341 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.500438213348389
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.358 Vali Acc: 0.307 Test Loss: 4.358 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.510135889053345
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.377 Vali Acc: 0.308 Test Loss: 4.377 Test Acc: 0.308
Validation loss decreased (-0.307016 --> -0.308192).  Saving model ...
Epoch: 28 cost time: 4.637625217437744
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.396 Vali Acc: 0.311 Test Loss: 4.396 Test Acc: 0.311
Validation loss decreased (-0.308192 --> -0.310544).  Saving model ...
Epoch: 29 cost time: 4.75381064414978
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.418 Vali Acc: 0.311 Test Loss: 4.418 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.324702739715576
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.438 Vali Acc: 0.311 Test Loss: 4.438 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.034637689590454
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.453 Vali Acc: 0.309 Test Loss: 4.453 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.443525075912476
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.466 Vali Acc: 0.312 Test Loss: 4.466 Test Acc: 0.312
Validation loss decreased (-0.310544 --> -0.311720).  Saving model ...
Epoch: 33 cost time: 4.825213670730591
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.479 Vali Acc: 0.309 Test Loss: 4.479 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.721088647842407
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.491 Vali Acc: 0.309 Test Loss: 4.491 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.470640182495117
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.512 Vali Acc: 0.308 Test Loss: 4.512 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.546538352966309
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.529 Vali Acc: 0.305 Test Loss: 4.529 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.749121904373169
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.540 Vali Acc: 0.302 Test Loss: 4.540 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 5.330543279647827
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.554 Vali Acc: 0.306 Test Loss: 4.554 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 5.75637412071228
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.565 Vali Acc: 0.308 Test Loss: 4.565 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.762904167175293
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.583 Vali Acc: 0.311 Test Loss: 4.583 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.679606914520264
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.598 Vali Acc: 0.309 Test Loss: 4.598 Test Acc: 0.309
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 4.599886655807495
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.610 Vali Acc: 0.312 Test Loss: 4.610 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 1561882
model size : 10.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.776942253112793
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.294 Vali Acc: 0.052 Test Loss: 3.294 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 4.754939317703247
Epoch: 2, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.325 Vali Acc: 0.100 Test Loss: 3.325 Test Acc: 0.100
Validation loss decreased (-0.051732 --> -0.099967).  Saving model ...
Epoch: 3 cost time: 4.51461935043335
Epoch: 3, Steps: 10 | Train Loss: 2.315 Vali Loss: 3.190 Vali Acc: 0.149 Test Loss: 3.190 Test Acc: 0.149
Validation loss decreased (-0.099967 --> -0.149380).  Saving model ...
Epoch: 4 cost time: 5.538259744644165
Epoch: 4, Steps: 10 | Train Loss: 1.721 Vali Loss: 3.157 Vali Acc: 0.207 Test Loss: 3.157 Test Acc: 0.207
Validation loss decreased (-0.149380 --> -0.207027).  Saving model ...
Epoch: 5 cost time: 5.211767196655273
Epoch: 5, Steps: 10 | Train Loss: 1.177 Vali Loss: 3.176 Vali Acc: 0.222 Test Loss: 3.176 Test Acc: 0.222
Validation loss decreased (-0.207027 --> -0.222321).  Saving model ...
Epoch: 6 cost time: 5.5945751667022705
Epoch: 6, Steps: 10 | Train Loss: 0.766 Vali Loss: 3.252 Vali Acc: 0.259 Test Loss: 3.252 Test Acc: 0.259
Validation loss decreased (-0.222321 --> -0.258791).  Saving model ...
Epoch: 7 cost time: 5.1427648067474365
Epoch: 7, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.442 Vali Acc: 0.265 Test Loss: 3.442 Test Acc: 0.265
Validation loss decreased (-0.258791 --> -0.264671).  Saving model ...
Epoch: 8 cost time: 4.742264747619629
Epoch: 8, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.576 Vali Acc: 0.288 Test Loss: 3.576 Test Acc: 0.288
Validation loss decreased (-0.264671 --> -0.288200).  Saving model ...
Epoch: 9 cost time: 4.880099296569824
Epoch: 9, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.753 Vali Acc: 0.299 Test Loss: 3.753 Test Acc: 0.299
Validation loss decreased (-0.288200 --> -0.298786).  Saving model ...
Epoch: 10 cost time: 4.984652757644653
Epoch: 10, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.829 Vali Acc: 0.308 Test Loss: 3.829 Test Acc: 0.308
Validation loss decreased (-0.298786 --> -0.308197).  Saving model ...
Epoch: 11 cost time: 5.542097806930542
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.965 Vali Acc: 0.304 Test Loss: 3.965 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.886205196380615
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.088 Vali Acc: 0.299 Test Loss: 4.088 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.6916351318359375
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.102 Vali Acc: 0.312 Test Loss: 4.102 Test Acc: 0.312
Validation loss decreased (-0.308197 --> -0.311724).  Saving model ...
Epoch: 14 cost time: 4.856258153915405
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.128 Vali Acc: 0.320 Test Loss: 4.128 Test Acc: 0.320
Validation loss decreased (-0.311724 --> -0.319959).  Saving model ...
Epoch: 15 cost time: 5.138633966445923
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.169 Vali Acc: 0.324 Test Loss: 4.169 Test Acc: 0.324
Validation loss decreased (-0.319959 --> -0.323488).  Saving model ...
Epoch: 16 cost time: 5.378671646118164
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.195 Vali Acc: 0.318 Test Loss: 4.195 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.551733732223511
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.222 Vali Acc: 0.313 Test Loss: 4.222 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.546367883682251
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.256 Vali Acc: 0.318 Test Loss: 4.256 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.034217834472656
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.271 Vali Acc: 0.319 Test Loss: 4.271 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.647773027420044
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.300 Vali Acc: 0.319 Test Loss: 4.300 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.004541635513306
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.330 Vali Acc: 0.321 Test Loss: 4.330 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.092921018600464
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.352 Vali Acc: 0.321 Test Loss: 4.352 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.568658351898193
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.361 Vali Acc: 0.320 Test Loss: 4.361 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.511096715927124
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.378 Vali Acc: 0.321 Test Loss: 4.378 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.765200614929199
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.403 Vali Acc: 0.322 Test Loss: 4.403 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 1561882
model size : 10.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 7.242496967315674
Epoch: 1, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.289 Vali Acc: 0.055 Test Loss: 3.289 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 4.925500154495239
Epoch: 2, Steps: 10 | Train Loss: 2.946 Vali Loss: 3.330 Vali Acc: 0.098 Test Loss: 3.330 Test Acc: 0.098
Validation loss decreased (-0.055261 --> -0.097614).  Saving model ...
Epoch: 3 cost time: 5.1074512004852295
Epoch: 3, Steps: 10 | Train Loss: 2.317 Vali Loss: 3.228 Vali Acc: 0.171 Test Loss: 3.228 Test Acc: 0.171
Validation loss decreased (-0.097614 --> -0.170556).  Saving model ...
Epoch: 4 cost time: 5.0692291259765625
Epoch: 4, Steps: 10 | Train Loss: 1.765 Vali Loss: 3.232 Vali Acc: 0.207 Test Loss: 3.232 Test Acc: 0.207
Validation loss decreased (-0.170556 --> -0.207027).  Saving model ...
Epoch: 5 cost time: 4.772327423095703
Epoch: 5, Steps: 10 | Train Loss: 1.250 Vali Loss: 3.273 Vali Acc: 0.235 Test Loss: 3.273 Test Acc: 0.235
Validation loss decreased (-0.207027 --> -0.235261).  Saving model ...
Epoch: 6 cost time: 4.992938280105591
Epoch: 6, Steps: 10 | Train Loss: 0.852 Vali Loss: 3.322 Vali Acc: 0.261 Test Loss: 3.322 Test Acc: 0.261
Validation loss decreased (-0.235261 --> -0.261143).  Saving model ...
Epoch: 7 cost time: 4.786517143249512
Epoch: 7, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.442 Vali Acc: 0.266 Test Loss: 3.442 Test Acc: 0.266
Validation loss decreased (-0.261143 --> -0.265848).  Saving model ...
Epoch: 8 cost time: 5.33495306968689
Epoch: 8, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.590 Vali Acc: 0.302 Test Loss: 3.590 Test Acc: 0.302
Validation loss decreased (-0.265848 --> -0.302317).  Saving model ...
Epoch: 9 cost time: 5.036240816116333
Epoch: 9, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.753 Vali Acc: 0.279 Test Loss: 3.753 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.899576902389526
Epoch: 10, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.798 Vali Acc: 0.312 Test Loss: 3.798 Test Acc: 0.312
Validation loss decreased (-0.302317 --> -0.311727).  Saving model ...
Epoch: 11 cost time: 4.031496047973633
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.910 Vali Acc: 0.306 Test Loss: 3.910 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.0460522174835205
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.021 Vali Acc: 0.306 Test Loss: 4.021 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.1160900592803955
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.088 Vali Acc: 0.318 Test Loss: 4.088 Test Acc: 0.318
Validation loss decreased (-0.311727 --> -0.317606).  Saving model ...
Epoch: 14 cost time: 4.693951368331909
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.150 Vali Acc: 0.319 Test Loss: 4.150 Test Acc: 0.319
Validation loss decreased (-0.317606 --> -0.318782).  Saving model ...
Epoch: 15 cost time: 4.750591516494751
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.195 Vali Acc: 0.313 Test Loss: 4.195 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.338473081588745
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.225 Vali Acc: 0.313 Test Loss: 4.225 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.309353351593018
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.251 Vali Acc: 0.309 Test Loss: 4.251 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.55830717086792
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.289 Vali Acc: 0.311 Test Loss: 4.289 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.00965142250061
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.303 Vali Acc: 0.307 Test Loss: 4.303 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.286428213119507
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.334 Vali Acc: 0.309 Test Loss: 4.334 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.813072919845581
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.368 Vali Acc: 0.313 Test Loss: 4.368 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.521348714828491
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.391 Vali Acc: 0.314 Test Loss: 4.391 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.932537078857422
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.404 Vali Acc: 0.316 Test Loss: 4.404 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.946826934814453
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.421 Vali Acc: 0.315 Test Loss: 4.421 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31882352941176473
model parameter : 1561882
model size : 10.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.309504747390747
Epoch: 1, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.282 Vali Acc: 0.054 Test Loss: 3.282 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 4.017081022262573
Epoch: 2, Steps: 10 | Train Loss: 2.975 Vali Loss: 3.349 Vali Acc: 0.101 Test Loss: 3.349 Test Acc: 0.101
Validation loss decreased (-0.054085 --> -0.101143).  Saving model ...
Epoch: 3 cost time: 4.164225339889526
Epoch: 3, Steps: 10 | Train Loss: 2.400 Vali Loss: 3.298 Vali Acc: 0.142 Test Loss: 3.298 Test Acc: 0.142
Validation loss decreased (-0.101143 --> -0.142320).  Saving model ...
Epoch: 4 cost time: 3.964526653289795
Epoch: 4, Steps: 10 | Train Loss: 1.857 Vali Loss: 3.342 Vali Acc: 0.153 Test Loss: 3.342 Test Acc: 0.153
Validation loss decreased (-0.142320 --> -0.152908).  Saving model ...
Epoch: 5 cost time: 4.432084560394287
Epoch: 5, Steps: 10 | Train Loss: 1.344 Vali Loss: 3.426 Vali Acc: 0.172 Test Loss: 3.426 Test Acc: 0.172
Validation loss decreased (-0.152908 --> -0.171730).  Saving model ...
Epoch: 6 cost time: 4.260842323303223
Epoch: 6, Steps: 10 | Train Loss: 0.925 Vali Loss: 3.525 Vali Acc: 0.192 Test Loss: 3.525 Test Acc: 0.192
Validation loss decreased (-0.171730 --> -0.191729).  Saving model ...
Epoch: 7 cost time: 4.137384414672852
Epoch: 7, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.718 Vali Acc: 0.194 Test Loss: 3.718 Test Acc: 0.194
Validation loss decreased (-0.191729 --> -0.194080).  Saving model ...
Epoch: 8 cost time: 4.109489679336548
Epoch: 8, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.882 Vali Acc: 0.216 Test Loss: 3.882 Test Acc: 0.216
Validation loss decreased (-0.194080 --> -0.216432).  Saving model ...
Epoch: 9 cost time: 4.54344630241394
Epoch: 9, Steps: 10 | Train Loss: 0.266 Vali Loss: 4.006 Vali Acc: 0.233 Test Loss: 4.006 Test Acc: 0.233
Validation loss decreased (-0.216432 --> -0.232901).  Saving model ...
Epoch: 10 cost time: 3.870187759399414
Epoch: 10, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.123 Vali Acc: 0.233 Test Loss: 4.123 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.045096397399902
Epoch: 11, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.290 Vali Acc: 0.240 Test Loss: 4.290 Test Acc: 0.240
Validation loss decreased (-0.232901 --> -0.239957).  Saving model ...
Epoch: 12 cost time: 3.9456892013549805
Epoch: 12, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.438 Vali Acc: 0.248 Test Loss: 4.438 Test Acc: 0.248
Validation loss decreased (-0.239957 --> -0.248191).  Saving model ...
Epoch: 13 cost time: 4.01545524597168
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.556 Vali Acc: 0.254 Test Loss: 4.556 Test Acc: 0.254
Validation loss decreased (-0.248191 --> -0.254072).  Saving model ...
Epoch: 14 cost time: 3.8132920265197754
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.602 Vali Acc: 0.253 Test Loss: 4.602 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.81510591506958
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.625 Vali Acc: 0.248 Test Loss: 4.625 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.352569818496704
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.653 Vali Acc: 0.248 Test Loss: 4.653 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.229358911514282
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.690 Vali Acc: 0.253 Test Loss: 4.690 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.364407062530518
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.752 Vali Acc: 0.254 Test Loss: 4.752 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.039443254470825
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.772 Vali Acc: 0.254 Test Loss: 4.772 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.0576465129852295
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.821 Vali Acc: 0.251 Test Loss: 4.821 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.820908546447754
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.855 Vali Acc: 0.254 Test Loss: 4.855 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.193240642547607
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.883 Vali Acc: 0.253 Test Loss: 4.883 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.089398384094238
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.905 Vali Acc: 0.253 Test Loss: 4.905 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 1561882
model size : 10.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.424546957015991
Epoch: 1, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.306 Vali Acc: 0.042 Test Loss: 3.306 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 4.081187963485718
Epoch: 2, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.413 Vali Acc: 0.066 Test Loss: 3.413 Test Acc: 0.066
Validation loss decreased (-0.042320 --> -0.065848).  Saving model ...
Epoch: 3 cost time: 4.3284852504730225
Epoch: 3, Steps: 10 | Train Loss: 2.528 Vali Loss: 3.387 Vali Acc: 0.101 Test Loss: 3.387 Test Acc: 0.101
Validation loss decreased (-0.065848 --> -0.101143).  Saving model ...
Epoch: 4 cost time: 3.878716230392456
Epoch: 4, Steps: 10 | Train Loss: 1.973 Vali Loss: 3.406 Vali Acc: 0.089 Test Loss: 3.406 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.545915126800537
Epoch: 5, Steps: 10 | Train Loss: 1.429 Vali Loss: 3.485 Vali Acc: 0.107 Test Loss: 3.485 Test Acc: 0.107
Validation loss decreased (-0.101143 --> -0.107024).  Saving model ...
Epoch: 6 cost time: 3.665614366531372
Epoch: 6, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.625 Vali Acc: 0.122 Test Loss: 3.625 Test Acc: 0.122
Validation loss decreased (-0.107024 --> -0.122317).  Saving model ...
Epoch: 7 cost time: 3.9435741901397705
Epoch: 7, Steps: 10 | Train Loss: 0.658 Vali Loss: 3.869 Vali Acc: 0.118 Test Loss: 3.869 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.900477647781372
Epoch: 8, Steps: 10 | Train Loss: 0.375 Vali Loss: 4.056 Vali Acc: 0.124 Test Loss: 4.056 Test Acc: 0.124
Validation loss decreased (-0.122317 --> -0.123489).  Saving model ...
Epoch: 9 cost time: 3.9708855152130127
Epoch: 9, Steps: 10 | Train Loss: 0.188 Vali Loss: 4.305 Vali Acc: 0.129 Test Loss: 4.305 Test Acc: 0.129
Validation loss decreased (-0.123489 --> -0.129369).  Saving model ...
Epoch: 10 cost time: 3.8016786575317383
Epoch: 10, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.485 Vali Acc: 0.132 Test Loss: 4.485 Test Acc: 0.132
Validation loss decreased (-0.129369 --> -0.131720).  Saving model ...
Epoch: 11 cost time: 3.7448761463165283
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.698 Vali Acc: 0.136 Test Loss: 4.698 Test Acc: 0.136
Validation loss decreased (-0.131720 --> -0.136424).  Saving model ...
Epoch: 12 cost time: 4.360856056213379
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.812 Vali Acc: 0.141 Test Loss: 4.812 Test Acc: 0.141
Validation loss decreased (-0.136424 --> -0.141128).  Saving model ...
Epoch: 13 cost time: 4.230858087539673
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.830 Vali Acc: 0.149 Test Loss: 4.830 Test Acc: 0.149
Validation loss decreased (-0.141128 --> -0.149363).  Saving model ...
Epoch: 14 cost time: 4.033970832824707
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.893 Vali Acc: 0.148 Test Loss: 4.893 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9315366744995117
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.995 Vali Acc: 0.153 Test Loss: 4.995 Test Acc: 0.153
Validation loss decreased (-0.149363 --> -0.152891).  Saving model ...
Epoch: 16 cost time: 3.79706072807312
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.027 Vali Acc: 0.152 Test Loss: 5.027 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.8134877681732178
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.044 Vali Acc: 0.152 Test Loss: 5.044 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.714158773422241
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.077 Vali Acc: 0.149 Test Loss: 5.077 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.935328722000122
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.098 Vali Acc: 0.153 Test Loss: 5.098 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.173574447631836
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.140 Vali Acc: 0.152 Test Loss: 5.140 Test Acc: 0.152
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.195701360702515
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.189 Vali Acc: 0.156 Test Loss: 5.189 Test Acc: 0.156
Validation loss decreased (-0.152891 --> -0.156419).  Saving model ...
Epoch: 22 cost time: 4.32042932510376
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.215 Vali Acc: 0.155 Test Loss: 5.215 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.170083999633789
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.228 Vali Acc: 0.154 Test Loss: 5.228 Test Acc: 0.154
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.191140174865723
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.251 Vali Acc: 0.154 Test Loss: 5.251 Test Acc: 0.154
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.0577356815338135
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.282 Vali Acc: 0.156 Test Loss: 5.282 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.422638177871704
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.307 Vali Acc: 0.158 Test Loss: 5.307 Test Acc: 0.158
Validation loss decreased (-0.156419 --> -0.157594).  Saving model ...
Epoch: 27 cost time: 4.179838180541992
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.333 Vali Acc: 0.156 Test Loss: 5.333 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.274555444717407
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.362 Vali Acc: 0.158 Test Loss: 5.362 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.7710955142974854
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.392 Vali Acc: 0.156 Test Loss: 5.392 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.072800159454346
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.408 Vali Acc: 0.158 Test Loss: 5.408 Test Acc: 0.158
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.0569908618927
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.422 Vali Acc: 0.155 Test Loss: 5.422 Test Acc: 0.155
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.309347629547119
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.431 Vali Acc: 0.155 Test Loss: 5.431 Test Acc: 0.155
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.151230573654175
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.450 Vali Acc: 0.155 Test Loss: 5.450 Test Acc: 0.155
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.844104290008545
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.474 Vali Acc: 0.156 Test Loss: 5.474 Test Acc: 0.156
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.218584060668945
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.501 Vali Acc: 0.154 Test Loss: 5.501 Test Acc: 0.154
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.55119514465332
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.517 Vali Acc: 0.154 Test Loss: 5.517 Test Acc: 0.154
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15764705882352942
model parameter : 1561882
model size : 10.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.282588243484497
Epoch: 1, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.324 Vali Acc: 0.039 Test Loss: 3.324 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 3.7404444217681885
Epoch: 2, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.410 Vali Acc: 0.052 Test Loss: 3.410 Test Acc: 0.052
Validation loss decreased (-0.038790 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 3.5728394985198975
Epoch: 3, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.422 Vali Acc: 0.064 Test Loss: 3.422 Test Acc: 0.064
Validation loss decreased (-0.051731 --> -0.063495).  Saving model ...
Epoch: 4 cost time: 3.8731181621551514
Epoch: 4, Steps: 10 | Train Loss: 2.316 Vali Loss: 3.413 Vali Acc: 0.059 Test Loss: 3.413 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9248108863830566
Epoch: 5, Steps: 10 | Train Loss: 1.830 Vali Loss: 3.423 Vali Acc: 0.085 Test Loss: 3.423 Test Acc: 0.085
Validation loss decreased (-0.063495 --> -0.084672).  Saving model ...
Epoch: 6 cost time: 3.955286741256714
Epoch: 6, Steps: 10 | Train Loss: 1.415 Vali Loss: 3.495 Vali Acc: 0.085 Test Loss: 3.495 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6982197761535645
Epoch: 7, Steps: 10 | Train Loss: 1.016 Vali Loss: 3.657 Vali Acc: 0.088 Test Loss: 3.657 Test Acc: 0.088
Validation loss decreased (-0.084672 --> -0.088199).  Saving model ...
Epoch: 8 cost time: 3.6392204761505127
Epoch: 8, Steps: 10 | Train Loss: 0.643 Vali Loss: 3.818 Vali Acc: 0.099 Test Loss: 3.818 Test Acc: 0.099
Validation loss decreased (-0.088199 --> -0.098785).  Saving model ...
Epoch: 9 cost time: 3.9695208072662354
Epoch: 9, Steps: 10 | Train Loss: 0.402 Vali Loss: 4.002 Vali Acc: 0.104 Test Loss: 4.002 Test Acc: 0.104
Validation loss decreased (-0.098785 --> -0.103489).  Saving model ...
Epoch: 10 cost time: 3.757327079772949
Epoch: 10, Steps: 10 | Train Loss: 0.193 Vali Loss: 4.270 Vali Acc: 0.108 Test Loss: 4.270 Test Acc: 0.108
Validation loss decreased (-0.103489 --> -0.108193).  Saving model ...
Epoch: 11 cost time: 4.085597991943359
Epoch: 11, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.476 Vali Acc: 0.109 Test Loss: 4.476 Test Acc: 0.109
Validation loss decreased (-0.108193 --> -0.109367).  Saving model ...
Epoch: 12 cost time: 3.4170477390289307
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.569 Vali Acc: 0.116 Test Loss: 4.569 Test Acc: 0.116
Validation loss decreased (-0.109367 --> -0.116425).  Saving model ...
Epoch: 13 cost time: 3.417372703552246
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.694 Vali Acc: 0.114 Test Loss: 4.694 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3845534324645996
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.826 Vali Acc: 0.109 Test Loss: 4.826 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.049661159515381
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.926 Vali Acc: 0.113 Test Loss: 4.926 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.246318817138672
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.942 Vali Acc: 0.111 Test Loss: 4.942 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.9471817016601562
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.965 Vali Acc: 0.113 Test Loss: 4.965 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.999002456665039
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.011 Vali Acc: 0.108 Test Loss: 5.011 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.068511247634888
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.024 Vali Acc: 0.114 Test Loss: 5.024 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.381785154342651
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.052 Vali Acc: 0.118 Test Loss: 5.052 Test Acc: 0.118
Validation loss decreased (-0.116425 --> -0.117597).  Saving model ...
Epoch: 21 cost time: 4.3300487995147705
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.086 Vali Acc: 0.121 Test Loss: 5.086 Test Acc: 0.121
Validation loss decreased (-0.117597 --> -0.121126).  Saving model ...
Epoch: 22 cost time: 4.156916618347168
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.117 Vali Acc: 0.120 Test Loss: 5.117 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.224329710006714
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.130 Vali Acc: 0.118 Test Loss: 5.130 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.155626058578491
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.139 Vali Acc: 0.113 Test Loss: 5.139 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.167670965194702
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.156 Vali Acc: 0.114 Test Loss: 5.156 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.681098222732544
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.177 Vali Acc: 0.116 Test Loss: 5.177 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.933570623397827
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.201 Vali Acc: 0.120 Test Loss: 5.201 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.2769246101379395
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.222 Vali Acc: 0.120 Test Loss: 5.222 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.588409662246704
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.240 Vali Acc: 0.119 Test Loss: 5.240 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.579007863998413
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.251 Vali Acc: 0.119 Test Loss: 5.251 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.457266807556152
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.270 Vali Acc: 0.121 Test Loss: 5.270 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12117647058823529
model parameter : 1561882
model size : 10.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.201648950576782
Epoch: 1, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.321 Vali Acc: 0.042 Test Loss: 3.321 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 4.277184247970581
Epoch: 2, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.404 Vali Acc: 0.042 Test Loss: 3.404 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.369299650192261
Epoch: 3, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.435 Vali Acc: 0.054 Test Loss: 3.435 Test Acc: 0.054
Validation loss decreased (-0.042320 --> -0.054083).  Saving model ...
Epoch: 4 cost time: 4.2592692375183105
Epoch: 4, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.412 Vali Acc: 0.062 Test Loss: 3.412 Test Acc: 0.062
Validation loss decreased (-0.054083 --> -0.062319).  Saving model ...
Epoch: 5 cost time: 4.224869728088379
Epoch: 5, Steps: 10 | Train Loss: 2.252 Vali Loss: 3.376 Vali Acc: 0.073 Test Loss: 3.376 Test Acc: 0.073
Validation loss decreased (-0.062319 --> -0.072907).  Saving model ...
Epoch: 6 cost time: 4.054260969161987
Epoch: 6, Steps: 10 | Train Loss: 1.887 Vali Loss: 3.394 Vali Acc: 0.086 Test Loss: 3.394 Test Acc: 0.086
Validation loss decreased (-0.072907 --> -0.085848).  Saving model ...
Epoch: 7 cost time: 4.666025876998901
Epoch: 7, Steps: 10 | Train Loss: 1.520 Vali Loss: 3.481 Vali Acc: 0.087 Test Loss: 3.481 Test Acc: 0.087
Validation loss decreased (-0.085848 --> -0.087024).  Saving model ...
Epoch: 8 cost time: 4.32861065864563
Epoch: 8, Steps: 10 | Train Loss: 1.119 Vali Loss: 3.662 Vali Acc: 0.089 Test Loss: 3.662 Test Acc: 0.089
Validation loss decreased (-0.087024 --> -0.089375).  Saving model ...
Epoch: 9 cost time: 4.365389585494995
Epoch: 9, Steps: 10 | Train Loss: 0.720 Vali Loss: 3.806 Vali Acc: 0.092 Test Loss: 3.806 Test Acc: 0.092
Validation loss decreased (-0.089375 --> -0.091727).  Saving model ...
Epoch: 10 cost time: 4.370650768280029
Epoch: 10, Steps: 10 | Train Loss: 0.453 Vali Loss: 4.105 Vali Acc: 0.095 Test Loss: 4.105 Test Acc: 0.095
Validation loss decreased (-0.091727 --> -0.095253).  Saving model ...
Epoch: 11 cost time: 4.453356981277466
Epoch: 11, Steps: 10 | Train Loss: 0.233 Vali Loss: 4.358 Vali Acc: 0.102 Test Loss: 4.358 Test Acc: 0.102
Validation loss decreased (-0.095253 --> -0.102309).  Saving model ...
Epoch: 12 cost time: 4.482683420181274
Epoch: 12, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.596 Vali Acc: 0.105 Test Loss: 4.596 Test Acc: 0.105
Validation loss decreased (-0.102309 --> -0.104660).  Saving model ...
Epoch: 13 cost time: 4.89312481880188
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.772 Vali Acc: 0.111 Test Loss: 4.772 Test Acc: 0.111
Validation loss decreased (-0.104660 --> -0.110541).  Saving model ...
Epoch: 14 cost time: 4.853791952133179
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.901 Vali Acc: 0.107 Test Loss: 4.901 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8253753185272217
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.030 Vali Acc: 0.105 Test Loss: 5.030 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.244410753250122
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.056 Vali Acc: 0.109 Test Loss: 5.056 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.431922912597656
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.077 Vali Acc: 0.112 Test Loss: 5.077 Test Acc: 0.112
Validation loss decreased (-0.110541 --> -0.111714).  Saving model ...
Epoch: 18 cost time: 4.513988018035889
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.115 Vali Acc: 0.109 Test Loss: 5.115 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.966536283493042
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.133 Vali Acc: 0.116 Test Loss: 5.133 Test Acc: 0.116
Validation loss decreased (-0.111714 --> -0.116419).  Saving model ...
Epoch: 20 cost time: 4.610755205154419
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.195 Vali Acc: 0.118 Test Loss: 5.195 Test Acc: 0.118
Validation loss decreased (-0.116419 --> -0.117595).  Saving model ...
Epoch: 21 cost time: 4.461615324020386
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.225 Vali Acc: 0.118 Test Loss: 5.225 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.361531019210815
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.246 Vali Acc: 0.119 Test Loss: 5.246 Test Acc: 0.119
Validation loss decreased (-0.117595 --> -0.118771).  Saving model ...
Epoch: 23 cost time: 4.504615068435669
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.256 Vali Acc: 0.118 Test Loss: 5.256 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.529128551483154
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.273 Vali Acc: 0.121 Test Loss: 5.273 Test Acc: 0.121
Validation loss decreased (-0.118771 --> -0.121124).  Saving model ...
Epoch: 25 cost time: 4.325336933135986
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.288 Vali Acc: 0.122 Test Loss: 5.288 Test Acc: 0.122
Validation loss decreased (-0.121124 --> -0.122300).  Saving model ...
Epoch: 26 cost time: 3.650054454803467
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.300 Vali Acc: 0.124 Test Loss: 5.300 Test Acc: 0.124
Validation loss decreased (-0.122300 --> -0.123476).  Saving model ...
Epoch: 27 cost time: 4.35731053352356
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.338 Vali Acc: 0.124 Test Loss: 5.338 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.821773052215576
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.362 Vali Acc: 0.124 Test Loss: 5.362 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.087262392044067
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.357 Vali Acc: 0.119 Test Loss: 5.357 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.014763355255127
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.370 Vali Acc: 0.120 Test Loss: 5.370 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.479665040969849
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.391 Vali Acc: 0.119 Test Loss: 5.391 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.137239456176758
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.411 Vali Acc: 0.120 Test Loss: 5.411 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.333972215652466
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.428 Vali Acc: 0.124 Test Loss: 5.428 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.114757537841797
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.450 Vali Acc: 0.126 Test Loss: 5.450 Test Acc: 0.126
Validation loss decreased (-0.123476 --> -0.125828).  Saving model ...
Epoch: 35 cost time: 3.921597957611084
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.472 Vali Acc: 0.124 Test Loss: 5.472 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.2805867195129395
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.487 Vali Acc: 0.122 Test Loss: 5.487 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.049581527709961
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.510 Vali Acc: 0.121 Test Loss: 5.510 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.70644736289978
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.529 Vali Acc: 0.120 Test Loss: 5.529 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.146265983581543
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.538 Vali Acc: 0.122 Test Loss: 5.538 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.6290364265441895
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.548 Vali Acc: 0.121 Test Loss: 5.548 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.561048746109009
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.553 Vali Acc: 0.121 Test Loss: 5.553 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.388555526733398
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.563 Vali Acc: 0.121 Test Loss: 5.563 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.4567794799804688
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.584 Vali Acc: 0.125 Test Loss: 5.584 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.088202953338623
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.600 Vali Acc: 0.124 Test Loss: 5.600 Test Acc: 0.124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12588235294117647
model parameter : 1561882
model size : 10.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.309894800186157
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.310 Vali Acc: 0.056 Test Loss: 3.310 Test Acc: 0.056
Validation loss decreased (inf --> -0.056437).  Saving model ...
Epoch: 2 cost time: 4.109379053115845
Epoch: 2, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.381 Vali Acc: 0.052 Test Loss: 3.381 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8641247749328613
Epoch: 3, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.411 Vali Acc: 0.062 Test Loss: 3.411 Test Acc: 0.062
Validation loss decreased (-0.056437 --> -0.062319).  Saving model ...
Epoch: 4 cost time: 3.94358491897583
Epoch: 4, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.404 Vali Acc: 0.060 Test Loss: 3.404 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.3072099685668945
Epoch: 5, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.340 Vali Acc: 0.072 Test Loss: 3.340 Test Acc: 0.072
Validation loss decreased (-0.062319 --> -0.071731).  Saving model ...
Epoch: 6 cost time: 4.079148530960083
Epoch: 6, Steps: 10 | Train Loss: 2.162 Vali Loss: 3.333 Vali Acc: 0.082 Test Loss: 3.333 Test Acc: 0.082
Validation loss decreased (-0.071731 --> -0.082320).  Saving model ...
Epoch: 7 cost time: 3.831543207168579
Epoch: 7, Steps: 10 | Train Loss: 1.909 Vali Loss: 3.402 Vali Acc: 0.091 Test Loss: 3.402 Test Acc: 0.091
Validation loss decreased (-0.082320 --> -0.090554).  Saving model ...
Epoch: 8 cost time: 3.566296339035034
Epoch: 8, Steps: 10 | Train Loss: 1.504 Vali Loss: 3.530 Vali Acc: 0.091 Test Loss: 3.530 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7017316818237305
Epoch: 9, Steps: 10 | Train Loss: 1.113 Vali Loss: 3.619 Vali Acc: 0.102 Test Loss: 3.619 Test Acc: 0.102
Validation loss decreased (-0.090554 --> -0.102317).  Saving model ...
Epoch: 10 cost time: 3.8450207710266113
Epoch: 10, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.843 Vali Acc: 0.098 Test Loss: 3.843 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.454535484313965
Epoch: 11, Steps: 10 | Train Loss: 0.459 Vali Loss: 4.041 Vali Acc: 0.104 Test Loss: 4.041 Test Acc: 0.104
Validation loss decreased (-0.102317 --> -0.103489).  Saving model ...
Epoch: 12 cost time: 3.8364856243133545
Epoch: 12, Steps: 10 | Train Loss: 0.277 Vali Loss: 4.302 Vali Acc: 0.105 Test Loss: 4.302 Test Acc: 0.105
Validation loss decreased (-0.103489 --> -0.104663).  Saving model ...
Epoch: 13 cost time: 3.9697186946868896
Epoch: 13, Steps: 10 | Train Loss: 0.137 Vali Loss: 4.480 Vali Acc: 0.106 Test Loss: 4.480 Test Acc: 0.106
Validation loss decreased (-0.104663 --> -0.105838).  Saving model ...
Epoch: 14 cost time: 4.192372798919678
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.644 Vali Acc: 0.109 Test Loss: 4.644 Test Acc: 0.109
Validation loss decreased (-0.105838 --> -0.109365).  Saving model ...
Epoch: 15 cost time: 4.472642660140991
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.746 Vali Acc: 0.114 Test Loss: 4.746 Test Acc: 0.114
Validation loss decreased (-0.109365 --> -0.114070).  Saving model ...
Epoch: 16 cost time: 3.847344398498535
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.754 Vali Acc: 0.111 Test Loss: 4.754 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.02547812461853
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.803 Vali Acc: 0.116 Test Loss: 4.803 Test Acc: 0.116
Validation loss decreased (-0.114070 --> -0.116423).  Saving model ...
Epoch: 18 cost time: 3.801081895828247
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.862 Vali Acc: 0.124 Test Loss: 4.862 Test Acc: 0.124
Validation loss decreased (-0.116423 --> -0.123481).  Saving model ...
Epoch: 19 cost time: 3.9923391342163086
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.879 Vali Acc: 0.127 Test Loss: 4.879 Test Acc: 0.127
Validation loss decreased (-0.123481 --> -0.127010).  Saving model ...
Epoch: 20 cost time: 4.23542594909668
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.961 Vali Acc: 0.124 Test Loss: 4.961 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6748247146606445
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.998 Vali Acc: 0.122 Test Loss: 4.998 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.8741719722747803
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.008 Vali Acc: 0.129 Test Loss: 5.008 Test Acc: 0.129
Validation loss decreased (-0.127010 --> -0.129362).  Saving model ...
Epoch: 23 cost time: 4.2976531982421875
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.024 Vali Acc: 0.131 Test Loss: 5.024 Test Acc: 0.131
Validation loss decreased (-0.129362 --> -0.130538).  Saving model ...
Epoch: 24 cost time: 4.346116542816162
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.039 Vali Acc: 0.126 Test Loss: 5.039 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.163896799087524
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.059 Vali Acc: 0.125 Test Loss: 5.059 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.7233128547668457
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.061 Vali Acc: 0.129 Test Loss: 5.061 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.844406843185425
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.064 Vali Acc: 0.132 Test Loss: 5.064 Test Acc: 0.132
Validation loss decreased (-0.130538 --> -0.131714).  Saving model ...
Epoch: 28 cost time: 4.261561393737793
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.075 Vali Acc: 0.128 Test Loss: 5.075 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.910419464111328
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.091 Vali Acc: 0.126 Test Loss: 5.091 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.8409998416900635
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.112 Vali Acc: 0.127 Test Loss: 5.112 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.136586904525757
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.132 Vali Acc: 0.129 Test Loss: 5.132 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.879638910293579
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.145 Vali Acc: 0.129 Test Loss: 5.145 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.9663960933685303
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.164 Vali Acc: 0.129 Test Loss: 5.164 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.081456184387207
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.185 Vali Acc: 0.134 Test Loss: 5.185 Test Acc: 0.134
Validation loss decreased (-0.131714 --> -0.134066).  Saving model ...
Epoch: 35 cost time: 4.096986532211304
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.215 Vali Acc: 0.134 Test Loss: 5.215 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.957202911376953
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.236 Vali Acc: 0.135 Test Loss: 5.236 Test Acc: 0.135
Validation loss decreased (-0.134066 --> -0.135242).  Saving model ...
Epoch: 37 cost time: 4.047104597091675
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.247 Vali Acc: 0.135 Test Loss: 5.247 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.29085898399353
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.255 Vali Acc: 0.135 Test Loss: 5.255 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 4.34538459777832
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.260 Vali Acc: 0.140 Test Loss: 5.260 Test Acc: 0.140
Validation loss decreased (-0.135242 --> -0.139947).  Saving model ...
Epoch: 40 cost time: 4.951306581497192
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.270 Vali Acc: 0.138 Test Loss: 5.270 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.538822412490845
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.281 Vali Acc: 0.136 Test Loss: 5.281 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.010071754455566
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.293 Vali Acc: 0.135 Test Loss: 5.293 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.689043283462524
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.314 Vali Acc: 0.139 Test Loss: 5.314 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 4.0698840618133545
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.330 Vali Acc: 0.138 Test Loss: 5.330 Test Acc: 0.138
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 4.149402856826782
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.342 Vali Acc: 0.136 Test Loss: 5.342 Test Acc: 0.136
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 4.074891805648804
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.349 Vali Acc: 0.134 Test Loss: 5.349 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.815613031387329
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.370 Vali Acc: 0.135 Test Loss: 5.370 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 4.130197286605835
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.389 Vali Acc: 0.133 Test Loss: 5.389 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.8919484615325928
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.393 Vali Acc: 0.134 Test Loss: 5.393 Test Acc: 0.134
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14
model parameter : 1561882
model size : 10.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.013524770736694
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.326 Vali Acc: 0.034 Test Loss: 3.326 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 3.3807179927825928
Epoch: 2, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.406 Vali Acc: 0.042 Test Loss: 3.406 Test Acc: 0.042
Validation loss decreased (-0.034084 --> -0.042319).  Saving model ...
Epoch: 3 cost time: 4.020065069198608
Epoch: 3, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.446 Vali Acc: 0.049 Test Loss: 3.446 Test Acc: 0.049
Validation loss decreased (-0.042319 --> -0.049377).  Saving model ...
Epoch: 4 cost time: 3.8962268829345703
Epoch: 4, Steps: 10 | Train Loss: 2.866 Vali Loss: 3.444 Vali Acc: 0.055 Test Loss: 3.444 Test Acc: 0.055
Validation loss decreased (-0.049377 --> -0.055260).  Saving model ...
Epoch: 5 cost time: 3.4699103832244873
Epoch: 5, Steps: 10 | Train Loss: 2.619 Vali Loss: 3.373 Vali Acc: 0.067 Test Loss: 3.373 Test Acc: 0.067
Validation loss decreased (-0.055260 --> -0.067025).  Saving model ...
Epoch: 6 cost time: 3.4963254928588867
Epoch: 6, Steps: 10 | Train Loss: 2.363 Vali Loss: 3.352 Vali Acc: 0.086 Test Loss: 3.352 Test Acc: 0.086
Validation loss decreased (-0.067025 --> -0.085849).  Saving model ...
Epoch: 7 cost time: 3.38016676902771
Epoch: 7, Steps: 10 | Train Loss: 2.145 Vali Loss: 3.390 Vali Acc: 0.092 Test Loss: 3.390 Test Acc: 0.092
Validation loss decreased (-0.085849 --> -0.091731).  Saving model ...
Epoch: 8 cost time: 3.6750431060791016
Epoch: 8, Steps: 10 | Train Loss: 1.795 Vali Loss: 3.515 Vali Acc: 0.101 Test Loss: 3.515 Test Acc: 0.101
Validation loss decreased (-0.091731 --> -0.101141).  Saving model ...
Epoch: 9 cost time: 4.3223371505737305
Epoch: 9, Steps: 10 | Train Loss: 1.362 Vali Loss: 3.629 Vali Acc: 0.113 Test Loss: 3.629 Test Acc: 0.113
Validation loss decreased (-0.101141 --> -0.112905).  Saving model ...
Epoch: 10 cost time: 3.5998222827911377
Epoch: 10, Steps: 10 | Train Loss: 1.010 Vali Loss: 3.847 Vali Acc: 0.108 Test Loss: 3.847 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.973773956298828
Epoch: 11, Steps: 10 | Train Loss: 0.650 Vali Loss: 3.937 Vali Acc: 0.121 Test Loss: 3.937 Test Acc: 0.121
Validation loss decreased (-0.112905 --> -0.121137).  Saving model ...
Epoch: 12 cost time: 3.9179999828338623
Epoch: 12, Steps: 10 | Train Loss: 0.415 Vali Loss: 4.137 Vali Acc: 0.139 Test Loss: 4.137 Test Acc: 0.139
Validation loss decreased (-0.121137 --> -0.138782).  Saving model ...
Epoch: 13 cost time: 4.318381309509277
Epoch: 13, Steps: 10 | Train Loss: 0.223 Vali Loss: 4.341 Vali Acc: 0.133 Test Loss: 4.341 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.249275207519531
Epoch: 14, Steps: 10 | Train Loss: 0.120 Vali Loss: 4.564 Vali Acc: 0.131 Test Loss: 4.564 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6239523887634277
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.673 Vali Acc: 0.129 Test Loss: 4.673 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6303274631500244
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.751 Vali Acc: 0.140 Test Loss: 4.751 Test Acc: 0.140
Validation loss decreased (-0.138782 --> -0.139952).  Saving model ...
Epoch: 17 cost time: 3.7219138145446777
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.831 Vali Acc: 0.149 Test Loss: 4.831 Test Acc: 0.149
Validation loss decreased (-0.139952 --> -0.149363).  Saving model ...
Epoch: 18 cost time: 3.6184961795806885
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.876 Vali Acc: 0.147 Test Loss: 4.876 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.826859951019287
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.918 Vali Acc: 0.146 Test Loss: 4.918 Test Acc: 0.146
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.443521499633789
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.991 Vali Acc: 0.147 Test Loss: 4.991 Test Acc: 0.147
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.455754280090332
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.002 Vali Acc: 0.144 Test Loss: 5.002 Test Acc: 0.144
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.6376402378082275
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.025 Vali Acc: 0.144 Test Loss: 5.025 Test Acc: 0.144
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.826152324676514
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.052 Vali Acc: 0.141 Test Loss: 5.052 Test Acc: 0.141
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.5824925899505615
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.053 Vali Acc: 0.142 Test Loss: 5.053 Test Acc: 0.142
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.0032734870910645
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.086 Vali Acc: 0.148 Test Loss: 5.086 Test Acc: 0.148
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.807551383972168
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.096 Vali Acc: 0.148 Test Loss: 5.096 Test Acc: 0.148
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.1672043800354
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.107 Vali Acc: 0.148 Test Loss: 5.107 Test Acc: 0.148
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14941176470588236
model parameter : 1561882
model size : 10.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.093418836593628
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 4.059699296951294
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 3.662146806716919
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 3.9585535526275635
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 5 cost time: 3.938041925430298
Epoch: 5, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 6 cost time: 3.792004346847534
Epoch: 6, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 7 cost time: 3.5949790477752686
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 8 cost time: 3.6998727321624756
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 9 cost time: 4.348321437835693
Epoch: 9, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 10 cost time: 4.481432676315308
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 11 cost time: 4.281422138214111
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 12 cost time: 4.017297983169556
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 13 cost time: 4.1496193408966064
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 14 cost time: 4.088339805603027
Epoch: 14, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 15 cost time: 4.061078310012817
Epoch: 15, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 16 cost time: 3.673919439315796
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 17 cost time: 3.860081672668457
Epoch: 17, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 18 cost time: 4.228166580200195
Epoch: 18, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 19 cost time: 4.278028249740601
Epoch: 19, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 20 cost time: 3.977358341217041
Epoch: 20, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 21 cost time: 3.9474174976348877
Epoch: 21, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 22 cost time: 3.90499210357666
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 23 cost time: 4.317519664764404
Epoch: 23, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 24 cost time: 4.127720832824707
Epoch: 24, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 25 cost time: 4.154188394546509
Epoch: 25, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 26 cost time: 4.031976222991943
Epoch: 26, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 27 cost time: 4.0596325397491455
Epoch: 27, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 28 cost time: 4.308243751525879
Epoch: 28, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 29 cost time: 4.307879686355591
Epoch: 29, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.9774816036224365
Epoch: 30, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 31 cost time: 3.4597787857055664
Epoch: 31, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 32 cost time: 4.154467344284058
Epoch: 32, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 33 cost time: 4.251977443695068
Epoch: 33, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 34 cost time: 4.024993181228638
Epoch: 34, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 35 cost time: 3.6235339641571045
Epoch: 35, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 36 cost time: 3.8192086219787598
Epoch: 36, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.053545236587524
Epoch: 37, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.047929763793945
Epoch: 38, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 39 cost time: 4.304523944854736
Epoch: 39, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 40 cost time: 4.102849245071411
Epoch: 40, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.022269248962402
Epoch: 41, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.076746940612793
Epoch: 42, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.9244656562805176
Epoch: 43, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.9154624938964844
Epoch: 44, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.9237263202667236
Epoch: 45, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 4.064447402954102
Epoch: 46, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 4.480653762817383
Epoch: 47, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 4.854114532470703
Epoch: 48, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 4.080111026763916
Epoch: 49, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.03764705882352941
model parameter : 1561882
model size : 10.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.553304195404053
Epoch: 1, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.298 Vali Acc: 0.051 Test Loss: 3.298 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 3.6720454692840576
Epoch: 2, Steps: 10 | Train Loss: 2.900 Vali Loss: 3.330 Vali Acc: 0.100 Test Loss: 3.330 Test Acc: 0.100
Validation loss decreased (-0.050555 --> -0.099967).  Saving model ...
Epoch: 3 cost time: 3.795254707336426
Epoch: 3, Steps: 10 | Train Loss: 2.350 Vali Loss: 3.199 Vali Acc: 0.168 Test Loss: 3.199 Test Acc: 0.168
Validation loss decreased (-0.099967 --> -0.168203).  Saving model ...
Epoch: 4 cost time: 3.470694065093994
Epoch: 4, Steps: 10 | Train Loss: 1.733 Vali Loss: 3.144 Vali Acc: 0.214 Test Loss: 3.144 Test Acc: 0.214
Validation loss decreased (-0.168203 --> -0.214086).  Saving model ...
Epoch: 5 cost time: 3.4899489879608154
Epoch: 5, Steps: 10 | Train Loss: 1.231 Vali Loss: 3.182 Vali Acc: 0.227 Test Loss: 3.182 Test Acc: 0.227
Validation loss decreased (-0.214086 --> -0.227027).  Saving model ...
Epoch: 6 cost time: 3.887047529220581
Epoch: 6, Steps: 10 | Train Loss: 0.751 Vali Loss: 3.320 Vali Acc: 0.241 Test Loss: 3.320 Test Acc: 0.241
Validation loss decreased (-0.227027 --> -0.241143).  Saving model ...
Epoch: 7 cost time: 3.8797476291656494
Epoch: 7, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.373 Vali Acc: 0.278 Test Loss: 3.373 Test Acc: 0.278
Validation loss decreased (-0.241143 --> -0.277613).  Saving model ...
Epoch: 8 cost time: 4.403646469116211
Epoch: 8, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.566 Vali Acc: 0.281 Test Loss: 3.566 Test Acc: 0.281
Validation loss decreased (-0.277613 --> -0.281141).  Saving model ...
Epoch: 9 cost time: 4.034183740615845
Epoch: 9, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.690 Vali Acc: 0.274 Test Loss: 3.690 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9498322010040283
Epoch: 10, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.796 Vali Acc: 0.286 Test Loss: 3.796 Test Acc: 0.286
Validation loss decreased (-0.281141 --> -0.285844).  Saving model ...
Epoch: 11 cost time: 3.9438374042510986
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.971 Vali Acc: 0.300 Test Loss: 3.971 Test Acc: 0.300
Validation loss decreased (-0.285844 --> -0.299960).  Saving model ...
Epoch: 12 cost time: 3.696281909942627
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.985 Vali Acc: 0.302 Test Loss: 3.985 Test Acc: 0.302
Validation loss decreased (-0.299960 --> -0.302313).  Saving model ...
Epoch: 13 cost time: 3.8053290843963623
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.008 Vali Acc: 0.299 Test Loss: 4.008 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.19515585899353
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.078 Vali Acc: 0.301 Test Loss: 4.078 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.014990568161011
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.107 Vali Acc: 0.302 Test Loss: 4.107 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.28070068359375
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.144 Vali Acc: 0.307 Test Loss: 4.144 Test Acc: 0.307
Validation loss decreased (-0.302313 --> -0.307017).  Saving model ...
Epoch: 17 cost time: 4.418879985809326
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.157 Vali Acc: 0.299 Test Loss: 4.157 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.626622438430786
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.196 Vali Acc: 0.302 Test Loss: 4.196 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.127471208572388
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.220 Vali Acc: 0.306 Test Loss: 4.220 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.7516348361968994
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.241 Vali Acc: 0.306 Test Loss: 4.241 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.343623399734497
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.261 Vali Acc: 0.304 Test Loss: 4.261 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.73612380027771
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.276 Vali Acc: 0.312 Test Loss: 4.276 Test Acc: 0.312
Validation loss decreased (-0.307017 --> -0.311722).  Saving model ...
Epoch: 23 cost time: 3.612177610397339
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.293 Vali Acc: 0.307 Test Loss: 4.293 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.533820390701294
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.316 Vali Acc: 0.311 Test Loss: 4.316 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.4532573223114014
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.344 Vali Acc: 0.311 Test Loss: 4.344 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.6197993755340576
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.365 Vali Acc: 0.312 Test Loss: 4.365 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.7690093517303467
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.383 Vali Acc: 0.312 Test Loss: 4.383 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.956488847732544
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.407 Vali Acc: 0.309 Test Loss: 4.407 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.899897575378418
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.429 Vali Acc: 0.309 Test Loss: 4.429 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.7189109325408936
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.449 Vali Acc: 0.312 Test Loss: 4.449 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.808032274246216
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.463 Vali Acc: 0.312 Test Loss: 4.463 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.0750017166137695
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.477 Vali Acc: 0.313 Test Loss: 4.477 Test Acc: 0.313
Validation loss decreased (-0.311722 --> -0.312896).  Saving model ...
Epoch: 33 cost time: 4.11043643951416
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.492 Vali Acc: 0.313 Test Loss: 4.492 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.9210145473480225
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.513 Vali Acc: 0.314 Test Loss: 4.513 Test Acc: 0.314
Validation loss decreased (-0.312896 --> -0.314073).  Saving model ...
Epoch: 35 cost time: 3.707115888595581
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.530 Vali Acc: 0.318 Test Loss: 4.530 Test Acc: 0.318
Validation loss decreased (-0.314073 --> -0.317602).  Saving model ...
Epoch: 36 cost time: 3.7209606170654297
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.546 Vali Acc: 0.315 Test Loss: 4.546 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.749199628829956
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.561 Vali Acc: 0.316 Test Loss: 4.561 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.412658214569092
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.575 Vali Acc: 0.315 Test Loss: 4.575 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.004607915878296
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.595 Vali Acc: 0.315 Test Loss: 4.595 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.058819770812988
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.607 Vali Acc: 0.313 Test Loss: 4.607 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.9327778816223145
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.625 Vali Acc: 0.315 Test Loss: 4.625 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.379943132400513
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.636 Vali Acc: 0.313 Test Loss: 4.636 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.9810376167297363
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.647 Vali Acc: 0.313 Test Loss: 4.647 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.93558931350708
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.660 Vali Acc: 0.313 Test Loss: 4.660 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.7229087352752686
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.675 Vali Acc: 0.314 Test Loss: 4.675 Test Acc: 0.314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 1365274
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.760171175003052
Epoch: 1, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.297 Vali Acc: 0.049 Test Loss: 3.297 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 4.023457050323486
Epoch: 2, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.318 Vali Acc: 0.104 Test Loss: 3.318 Test Acc: 0.104
Validation loss decreased (-0.049379 --> -0.103496).  Saving model ...
Epoch: 3 cost time: 3.727252721786499
Epoch: 3, Steps: 10 | Train Loss: 2.359 Vali Loss: 3.195 Vali Acc: 0.166 Test Loss: 3.195 Test Acc: 0.166
Validation loss decreased (-0.103496 --> -0.165850).  Saving model ...
Epoch: 4 cost time: 3.675412893295288
Epoch: 4, Steps: 10 | Train Loss: 1.745 Vali Loss: 3.133 Vali Acc: 0.231 Test Loss: 3.133 Test Acc: 0.231
Validation loss decreased (-0.165850 --> -0.230557).  Saving model ...
Epoch: 5 cost time: 3.6536481380462646
Epoch: 5, Steps: 10 | Train Loss: 1.275 Vali Loss: 3.158 Vali Acc: 0.239 Test Loss: 3.158 Test Acc: 0.239
Validation loss decreased (-0.230557 --> -0.238792).  Saving model ...
Epoch: 6 cost time: 3.8930351734161377
Epoch: 6, Steps: 10 | Train Loss: 0.787 Vali Loss: 3.283 Vali Acc: 0.255 Test Loss: 3.283 Test Acc: 0.255
Validation loss decreased (-0.238792 --> -0.255261).  Saving model ...
Epoch: 7 cost time: 4.7553956508636475
Epoch: 7, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.349 Vali Acc: 0.286 Test Loss: 3.349 Test Acc: 0.286
Validation loss decreased (-0.255261 --> -0.285849).  Saving model ...
Epoch: 8 cost time: 4.660053253173828
Epoch: 8, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.543 Vali Acc: 0.288 Test Loss: 3.543 Test Acc: 0.288
Validation loss decreased (-0.285849 --> -0.288200).  Saving model ...
Epoch: 9 cost time: 3.9981038570404053
Epoch: 9, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.665 Vali Acc: 0.299 Test Loss: 3.665 Test Acc: 0.299
Validation loss decreased (-0.288200 --> -0.298787).  Saving model ...
Epoch: 10 cost time: 4.085164546966553
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.847 Vali Acc: 0.304 Test Loss: 3.847 Test Acc: 0.304
Validation loss decreased (-0.298787 --> -0.303491).  Saving model ...
Epoch: 11 cost time: 4.322403192520142
Epoch: 11, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.968 Vali Acc: 0.313 Test Loss: 3.968 Test Acc: 0.313
Validation loss decreased (-0.303491 --> -0.312901).  Saving model ...
Epoch: 12 cost time: 4.394244194030762
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.023 Vali Acc: 0.316 Test Loss: 4.023 Test Acc: 0.316
Validation loss decreased (-0.312901 --> -0.316430).  Saving model ...
Epoch: 13 cost time: 4.134796380996704
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.094 Vali Acc: 0.314 Test Loss: 4.094 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.9131414890289307
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.154 Vali Acc: 0.314 Test Loss: 4.154 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.072121858596802
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.166 Vali Acc: 0.315 Test Loss: 4.166 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.614222526550293
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.200 Vali Acc: 0.315 Test Loss: 4.200 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.478456497192383
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.209 Vali Acc: 0.318 Test Loss: 4.209 Test Acc: 0.318
Validation loss decreased (-0.316430 --> -0.317605).  Saving model ...
Epoch: 18 cost time: 4.266345739364624
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.231 Vali Acc: 0.319 Test Loss: 4.231 Test Acc: 0.319
Validation loss decreased (-0.317605 --> -0.318781).  Saving model ...
Epoch: 19 cost time: 3.6288578510284424
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.264 Vali Acc: 0.315 Test Loss: 4.264 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.545513391494751
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.292 Vali Acc: 0.320 Test Loss: 4.292 Test Acc: 0.320
Validation loss decreased (-0.318781 --> -0.319957).  Saving model ...
Epoch: 21 cost time: 3.618403911590576
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.318 Vali Acc: 0.321 Test Loss: 4.318 Test Acc: 0.321
Validation loss decreased (-0.319957 --> -0.321133).  Saving model ...
Epoch: 22 cost time: 4.188581466674805
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.334 Vali Acc: 0.320 Test Loss: 4.334 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.106873512268066
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.356 Vali Acc: 0.315 Test Loss: 4.356 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.9345929622650146
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.376 Vali Acc: 0.321 Test Loss: 4.376 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.5356945991516113
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.407 Vali Acc: 0.322 Test Loss: 4.407 Test Acc: 0.322
Validation loss decreased (-0.321133 --> -0.322309).  Saving model ...
Epoch: 26 cost time: 3.9084949493408203
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.428 Vali Acc: 0.325 Test Loss: 4.428 Test Acc: 0.325
Validation loss decreased (-0.322309 --> -0.324662).  Saving model ...
Epoch: 27 cost time: 3.92962646484375
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.455 Vali Acc: 0.324 Test Loss: 4.455 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.5527002811431885
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.480 Vali Acc: 0.322 Test Loss: 4.480 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.810518741607666
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.499 Vali Acc: 0.320 Test Loss: 4.499 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.8594553470611572
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.515 Vali Acc: 0.325 Test Loss: 4.515 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.8717522621154785
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.530 Vali Acc: 0.324 Test Loss: 4.530 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.9487154483795166
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.546 Vali Acc: 0.322 Test Loss: 4.546 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.412647247314453
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.566 Vali Acc: 0.324 Test Loss: 4.566 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.051462173461914
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.590 Vali Acc: 0.321 Test Loss: 4.590 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.8340861797332764
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.605 Vali Acc: 0.325 Test Loss: 4.605 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.080063819885254
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.619 Vali Acc: 0.326 Test Loss: 4.619 Test Acc: 0.326
Validation loss decreased (-0.324662 --> -0.325836).  Saving model ...
Epoch: 37 cost time: 4.470909833908081
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.636 Vali Acc: 0.326 Test Loss: 4.636 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.7660109996795654
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.649 Vali Acc: 0.324 Test Loss: 4.649 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.544278621673584
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.669 Vali Acc: 0.321 Test Loss: 4.669 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.6745402812957764
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.683 Vali Acc: 0.322 Test Loss: 4.683 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.6468071937561035
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.705 Vali Acc: 0.324 Test Loss: 4.705 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.6950669288635254
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.722 Vali Acc: 0.321 Test Loss: 4.722 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.5937511920928955
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.735 Vali Acc: 0.322 Test Loss: 4.735 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.901806354522705
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.748 Vali Acc: 0.324 Test Loss: 4.748 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.589693546295166
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.759 Vali Acc: 0.324 Test Loss: 4.759 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.511164665222168
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.765 Vali Acc: 0.326 Test Loss: 4.765 Test Acc: 0.326
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 1365274
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.519239187240601
Epoch: 1, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.287 Vali Acc: 0.053 Test Loss: 3.287 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 3.626344680786133
Epoch: 2, Steps: 10 | Train Loss: 2.886 Vali Loss: 3.303 Vali Acc: 0.102 Test Loss: 3.303 Test Acc: 0.102
Validation loss decreased (-0.052908 --> -0.102320).  Saving model ...
Epoch: 3 cost time: 3.9948956966400146
Epoch: 3, Steps: 10 | Train Loss: 2.342 Vali Loss: 3.212 Vali Acc: 0.172 Test Loss: 3.212 Test Acc: 0.172
Validation loss decreased (-0.102320 --> -0.171733).  Saving model ...
Epoch: 4 cost time: 3.7884068489074707
Epoch: 4, Steps: 10 | Train Loss: 1.788 Vali Loss: 3.165 Vali Acc: 0.229 Test Loss: 3.165 Test Acc: 0.229
Validation loss decreased (-0.171733 --> -0.229380).  Saving model ...
Epoch: 5 cost time: 3.573122262954712
Epoch: 5, Steps: 10 | Train Loss: 1.344 Vali Loss: 3.204 Vali Acc: 0.269 Test Loss: 3.204 Test Acc: 0.269
Validation loss decreased (-0.229380 --> -0.269380).  Saving model ...
Epoch: 6 cost time: 3.770880937576294
Epoch: 6, Steps: 10 | Train Loss: 0.915 Vali Loss: 3.334 Vali Acc: 0.268 Test Loss: 3.334 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5563857555389404
Epoch: 7, Steps: 10 | Train Loss: 0.549 Vali Loss: 3.370 Vali Acc: 0.289 Test Loss: 3.370 Test Acc: 0.289
Validation loss decreased (-0.269380 --> -0.289378).  Saving model ...
Epoch: 8 cost time: 3.6640422344207764
Epoch: 8, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.553 Vali Acc: 0.289 Test Loss: 3.553 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.737201452255249
Epoch: 9, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.654 Vali Acc: 0.292 Test Loss: 3.654 Test Acc: 0.292
Validation loss decreased (-0.289378 --> -0.291728).  Saving model ...
Epoch: 10 cost time: 3.766166925430298
Epoch: 10, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.790 Vali Acc: 0.309 Test Loss: 3.790 Test Acc: 0.309
Validation loss decreased (-0.291728 --> -0.309374).  Saving model ...
Epoch: 11 cost time: 3.9661965370178223
Epoch: 11, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.918 Vali Acc: 0.309 Test Loss: 3.918 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.497007131576538
Epoch: 12, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.967 Vali Acc: 0.304 Test Loss: 3.967 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.538918972015381
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.056 Vali Acc: 0.302 Test Loss: 4.056 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1154909133911133
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.087 Vali Acc: 0.314 Test Loss: 4.087 Test Acc: 0.314
Validation loss decreased (-0.309374 --> -0.314077).  Saving model ...
Epoch: 15 cost time: 3.79571270942688
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.109 Vali Acc: 0.325 Test Loss: 4.109 Test Acc: 0.325
Validation loss decreased (-0.314077 --> -0.324665).  Saving model ...
Epoch: 16 cost time: 4.00187873840332
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.174 Vali Acc: 0.318 Test Loss: 4.174 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9238038063049316
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.210 Vali Acc: 0.321 Test Loss: 4.210 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.106788396835327
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.246 Vali Acc: 0.314 Test Loss: 4.246 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.5390379428863525
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.278 Vali Acc: 0.320 Test Loss: 4.278 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.713510274887085
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.304 Vali Acc: 0.318 Test Loss: 4.304 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.6986565589904785
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.327 Vali Acc: 0.318 Test Loss: 4.327 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.7237582206726074
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.345 Vali Acc: 0.318 Test Loss: 4.345 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.8953471183776855
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.373 Vali Acc: 0.319 Test Loss: 4.373 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.028701543807983
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.396 Vali Acc: 0.325 Test Loss: 4.396 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.74015212059021
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.424 Vali Acc: 0.321 Test Loss: 4.424 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 1365274
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.002965927124023
Epoch: 1, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.301 Vali Acc: 0.049 Test Loss: 3.301 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 3.9829814434051514
Epoch: 2, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.377 Vali Acc: 0.089 Test Loss: 3.377 Test Acc: 0.089
Validation loss decreased (-0.049379 --> -0.089378).  Saving model ...
Epoch: 3 cost time: 3.9622647762298584
Epoch: 3, Steps: 10 | Train Loss: 2.415 Vali Loss: 3.320 Vali Acc: 0.131 Test Loss: 3.320 Test Acc: 0.131
Validation loss decreased (-0.089378 --> -0.130555).  Saving model ...
Epoch: 4 cost time: 4.16470742225647
Epoch: 4, Steps: 10 | Train Loss: 1.874 Vali Loss: 3.326 Vali Acc: 0.156 Test Loss: 3.326 Test Acc: 0.156
Validation loss decreased (-0.130555 --> -0.156437).  Saving model ...
Epoch: 5 cost time: 3.7290916442871094
Epoch: 5, Steps: 10 | Train Loss: 1.424 Vali Loss: 3.416 Vali Acc: 0.179 Test Loss: 3.416 Test Acc: 0.179
Validation loss decreased (-0.156437 --> -0.178789).  Saving model ...
Epoch: 6 cost time: 4.006193399429321
Epoch: 6, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.596 Vali Acc: 0.180 Test Loss: 3.596 Test Acc: 0.180
Validation loss decreased (-0.178789 --> -0.179964).  Saving model ...
Epoch: 7 cost time: 3.962397813796997
Epoch: 7, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.641 Vali Acc: 0.202 Test Loss: 3.641 Test Acc: 0.202
Validation loss decreased (-0.179964 --> -0.202317).  Saving model ...
Epoch: 8 cost time: 3.960597515106201
Epoch: 8, Steps: 10 | Train Loss: 0.422 Vali Loss: 3.838 Vali Acc: 0.222 Test Loss: 3.838 Test Acc: 0.222
Validation loss decreased (-0.202317 --> -0.222315).  Saving model ...
Epoch: 9 cost time: 4.099997282028198
Epoch: 9, Steps: 10 | Train Loss: 0.256 Vali Loss: 4.002 Vali Acc: 0.224 Test Loss: 4.002 Test Acc: 0.224
Validation loss decreased (-0.222315 --> -0.223489).  Saving model ...
Epoch: 10 cost time: 3.8187801837921143
Epoch: 10, Steps: 10 | Train Loss: 0.149 Vali Loss: 4.122 Vali Acc: 0.236 Test Loss: 4.122 Test Acc: 0.236
Validation loss decreased (-0.223489 --> -0.236429).  Saving model ...
Epoch: 11 cost time: 3.8604531288146973
Epoch: 11, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.323 Vali Acc: 0.227 Test Loss: 4.323 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5505247116088867
Epoch: 12, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.390 Vali Acc: 0.239 Test Loss: 4.390 Test Acc: 0.239
Validation loss decreased (-0.236429 --> -0.238780).  Saving model ...
Epoch: 13 cost time: 3.5932130813598633
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.536 Vali Acc: 0.246 Test Loss: 4.536 Test Acc: 0.246
Validation loss decreased (-0.238780 --> -0.245837).  Saving model ...
Epoch: 14 cost time: 4.233987331390381
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.525 Vali Acc: 0.261 Test Loss: 4.525 Test Acc: 0.261
Validation loss decreased (-0.245837 --> -0.261131).  Saving model ...
Epoch: 15 cost time: 3.820237398147583
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.562 Vali Acc: 0.254 Test Loss: 4.562 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6420702934265137
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.656 Vali Acc: 0.252 Test Loss: 4.656 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.618381977081299
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.690 Vali Acc: 0.247 Test Loss: 4.690 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.5559842586517334
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.732 Vali Acc: 0.247 Test Loss: 4.732 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.428161382675171
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.768 Vali Acc: 0.256 Test Loss: 4.768 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5060338973999023
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.796 Vali Acc: 0.255 Test Loss: 4.796 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.8930234909057617
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.830 Vali Acc: 0.258 Test Loss: 4.830 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.7177748680114746
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.846 Vali Acc: 0.254 Test Loss: 4.846 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.6856393814086914
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.868 Vali Acc: 0.255 Test Loss: 4.868 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.292253732681274
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.888 Vali Acc: 0.255 Test Loss: 4.888 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 1365274
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.183873891830444
Epoch: 1, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.308 Vali Acc: 0.042 Test Loss: 3.308 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 3.9584128856658936
Epoch: 2, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.417 Vali Acc: 0.058 Test Loss: 3.417 Test Acc: 0.058
Validation loss decreased (-0.042320 --> -0.057613).  Saving model ...
Epoch: 3 cost time: 3.5578904151916504
Epoch: 3, Steps: 10 | Train Loss: 2.547 Vali Loss: 3.385 Vali Acc: 0.085 Test Loss: 3.385 Test Acc: 0.085
Validation loss decreased (-0.057613 --> -0.084672).  Saving model ...
Epoch: 4 cost time: 3.7975478172302246
Epoch: 4, Steps: 10 | Train Loss: 1.979 Vali Loss: 3.376 Vali Acc: 0.095 Test Loss: 3.376 Test Acc: 0.095
Validation loss decreased (-0.084672 --> -0.095260).  Saving model ...
Epoch: 5 cost time: 3.8433940410614014
Epoch: 5, Steps: 10 | Train Loss: 1.554 Vali Loss: 3.436 Vali Acc: 0.112 Test Loss: 3.436 Test Acc: 0.112
Validation loss decreased (-0.095260 --> -0.111730).  Saving model ...
Epoch: 6 cost time: 3.9501330852508545
Epoch: 6, Steps: 10 | Train Loss: 0.993 Vali Loss: 3.662 Vali Acc: 0.108 Test Loss: 3.662 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.557990550994873
Epoch: 7, Steps: 10 | Train Loss: 0.620 Vali Loss: 3.774 Vali Acc: 0.126 Test Loss: 3.774 Test Acc: 0.126
Validation loss decreased (-0.111730 --> -0.125845).  Saving model ...
Epoch: 8 cost time: 3.3829212188720703
Epoch: 8, Steps: 10 | Train Loss: 0.363 Vali Loss: 4.051 Vali Acc: 0.120 Test Loss: 4.051 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.398914337158203
Epoch: 9, Steps: 10 | Train Loss: 0.200 Vali Loss: 4.254 Vali Acc: 0.136 Test Loss: 4.254 Test Acc: 0.136
Validation loss decreased (-0.125845 --> -0.136428).  Saving model ...
Epoch: 10 cost time: 3.492546319961548
Epoch: 10, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.513 Vali Acc: 0.140 Test Loss: 4.513 Test Acc: 0.140
Validation loss decreased (-0.136428 --> -0.139955).  Saving model ...
Epoch: 11 cost time: 3.605353832244873
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.708 Vali Acc: 0.145 Test Loss: 4.708 Test Acc: 0.145
Validation loss decreased (-0.139955 --> -0.144659).  Saving model ...
Epoch: 12 cost time: 3.4274158477783203
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.733 Vali Acc: 0.145 Test Loss: 4.733 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4405152797698975
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.842 Vali Acc: 0.151 Test Loss: 4.842 Test Acc: 0.151
Validation loss decreased (-0.144659 --> -0.150540).  Saving model ...
Epoch: 14 cost time: 3.3942105770111084
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.943 Vali Acc: 0.155 Test Loss: 4.943 Test Acc: 0.155
Validation loss decreased (-0.150540 --> -0.155245).  Saving model ...
Epoch: 15 cost time: 3.2456905841827393
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.961 Vali Acc: 0.152 Test Loss: 4.961 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.824270248413086
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.010 Vali Acc: 0.155 Test Loss: 5.010 Test Acc: 0.155
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5128252506256104
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.037 Vali Acc: 0.153 Test Loss: 5.037 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.420836925506592
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.064 Vali Acc: 0.152 Test Loss: 5.064 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.820298194885254
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.094 Vali Acc: 0.155 Test Loss: 5.094 Test Acc: 0.155
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5613856315612793
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.136 Vali Acc: 0.158 Test Loss: 5.136 Test Acc: 0.158
Validation loss decreased (-0.155245 --> -0.157596).  Saving model ...
Epoch: 21 cost time: 3.6281890869140625
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.165 Vali Acc: 0.156 Test Loss: 5.165 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6506447792053223
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.195 Vali Acc: 0.164 Test Loss: 5.195 Test Acc: 0.164
Validation loss decreased (-0.157596 --> -0.163477).  Saving model ...
Epoch: 23 cost time: 3.2939083576202393
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.222 Vali Acc: 0.161 Test Loss: 5.222 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.5412185192108154
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.242 Vali Acc: 0.161 Test Loss: 5.242 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.247483968734741
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.264 Vali Acc: 0.165 Test Loss: 5.264 Test Acc: 0.165
Validation loss decreased (-0.163477 --> -0.164653).  Saving model ...
Epoch: 26 cost time: 3.7508606910705566
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.288 Vali Acc: 0.168 Test Loss: 5.288 Test Acc: 0.168
Validation loss decreased (-0.164653 --> -0.168182).  Saving model ...
Epoch: 27 cost time: 3.822669744491577
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.308 Vali Acc: 0.167 Test Loss: 5.308 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.049940824508667
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.333 Vali Acc: 0.169 Test Loss: 5.333 Test Acc: 0.169
Validation loss decreased (-0.168182 --> -0.169358).  Saving model ...
Epoch: 29 cost time: 3.641634225845337
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.366 Vali Acc: 0.169 Test Loss: 5.366 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.6226611137390137
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.390 Vali Acc: 0.171 Test Loss: 5.390 Test Acc: 0.171
Validation loss decreased (-0.169358 --> -0.170534).  Saving model ...
Epoch: 31 cost time: 3.480842113494873
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.411 Vali Acc: 0.167 Test Loss: 5.411 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.2953836917877197
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.420 Vali Acc: 0.173 Test Loss: 5.420 Test Acc: 0.173
Validation loss decreased (-0.170534 --> -0.172887).  Saving model ...
Epoch: 33 cost time: 4.00894832611084
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.434 Vali Acc: 0.173 Test Loss: 5.434 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.7800955772399902
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.457 Vali Acc: 0.175 Test Loss: 5.457 Test Acc: 0.175
Validation loss decreased (-0.172887 --> -0.175240).  Saving model ...
Epoch: 35 cost time: 4.281959056854248
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.475 Vali Acc: 0.175 Test Loss: 5.475 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.8007419109344482
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.494 Vali Acc: 0.173 Test Loss: 5.494 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.9565412998199463
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.514 Vali Acc: 0.173 Test Loss: 5.514 Test Acc: 0.173
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.285521984100342
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.532 Vali Acc: 0.173 Test Loss: 5.532 Test Acc: 0.173
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.864445686340332
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.555 Vali Acc: 0.171 Test Loss: 5.555 Test Acc: 0.171
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.76139235496521
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.573 Vali Acc: 0.173 Test Loss: 5.573 Test Acc: 0.173
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.6832950115203857
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.591 Vali Acc: 0.174 Test Loss: 5.591 Test Acc: 0.174
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.530052423477173
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.603 Vali Acc: 0.174 Test Loss: 5.603 Test Acc: 0.174
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.9838054180145264
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.615 Vali Acc: 0.175 Test Loss: 5.615 Test Acc: 0.175
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.8595130443573
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.624 Vali Acc: 0.174 Test Loss: 5.624 Test Acc: 0.174
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17529411764705882
model parameter : 1365274
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.478095769882202
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.330 Vali Acc: 0.034 Test Loss: 3.330 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 3.381469964981079
Epoch: 2, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.416 Vali Acc: 0.046 Test Loss: 3.416 Test Acc: 0.046
Validation loss decreased (-0.034084 --> -0.045848).  Saving model ...
Epoch: 3 cost time: 3.546541690826416
Epoch: 3, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.413 Vali Acc: 0.058 Test Loss: 3.413 Test Acc: 0.058
Validation loss decreased (-0.045848 --> -0.057613).  Saving model ...
Epoch: 4 cost time: 3.7422125339508057
Epoch: 4, Steps: 10 | Train Loss: 2.306 Vali Loss: 3.385 Vali Acc: 0.073 Test Loss: 3.385 Test Acc: 0.073
Validation loss decreased (-0.057613 --> -0.072907).  Saving model ...
Epoch: 5 cost time: 4.069733381271362
Epoch: 5, Steps: 10 | Train Loss: 1.957 Vali Loss: 3.389 Vali Acc: 0.078 Test Loss: 3.389 Test Acc: 0.078
Validation loss decreased (-0.072907 --> -0.077613).  Saving model ...
Epoch: 6 cost time: 3.8807098865509033
Epoch: 6, Steps: 10 | Train Loss: 1.433 Vali Loss: 3.518 Vali Acc: 0.089 Test Loss: 3.518 Test Acc: 0.089
Validation loss decreased (-0.077613 --> -0.089377).  Saving model ...
Epoch: 7 cost time: 4.009721994400024
Epoch: 7, Steps: 10 | Train Loss: 1.017 Vali Loss: 3.603 Vali Acc: 0.092 Test Loss: 3.603 Test Acc: 0.092
Validation loss decreased (-0.089377 --> -0.091729).  Saving model ...
Epoch: 8 cost time: 3.6447157859802246
Epoch: 8, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.742 Vali Acc: 0.106 Test Loss: 3.742 Test Acc: 0.106
Validation loss decreased (-0.091729 --> -0.105845).  Saving model ...
Epoch: 9 cost time: 3.558906316757202
Epoch: 9, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.930 Vali Acc: 0.111 Test Loss: 3.930 Test Acc: 0.111
Validation loss decreased (-0.105845 --> -0.110549).  Saving model ...
Epoch: 10 cost time: 3.6347944736480713
Epoch: 10, Steps: 10 | Train Loss: 0.214 Vali Loss: 4.187 Vali Acc: 0.107 Test Loss: 4.187 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.205995559692383
Epoch: 11, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.369 Vali Acc: 0.112 Test Loss: 4.369 Test Acc: 0.112
Validation loss decreased (-0.110549 --> -0.111721).  Saving model ...
Epoch: 12 cost time: 3.841135263442993
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.597 Vali Acc: 0.116 Test Loss: 4.597 Test Acc: 0.116
Validation loss decreased (-0.111721 --> -0.116425).  Saving model ...
Epoch: 13 cost time: 3.7264814376831055
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.772 Vali Acc: 0.120 Test Loss: 4.772 Test Acc: 0.120
Validation loss decreased (-0.116425 --> -0.119952).  Saving model ...
Epoch: 14 cost time: 3.7946410179138184
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.778 Vali Acc: 0.115 Test Loss: 4.778 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.228509187698364
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.816 Vali Acc: 0.116 Test Loss: 4.816 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.326498746871948
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.932 Vali Acc: 0.116 Test Loss: 4.932 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.775127410888672
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.970 Vali Acc: 0.121 Test Loss: 4.970 Test Acc: 0.121
Validation loss decreased (-0.119952 --> -0.121127).  Saving model ...
Epoch: 18 cost time: 3.7233598232269287
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.975 Vali Acc: 0.121 Test Loss: 4.975 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.491589307785034
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.011 Vali Acc: 0.122 Test Loss: 5.011 Test Acc: 0.122
Validation loss decreased (-0.121127 --> -0.122303).  Saving model ...
Epoch: 20 cost time: 4.008527040481567
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.058 Vali Acc: 0.118 Test Loss: 5.058 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.146489381790161
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.086 Vali Acc: 0.122 Test Loss: 5.086 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.271076679229736
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.107 Vali Acc: 0.121 Test Loss: 5.107 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.275222539901733
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.130 Vali Acc: 0.125 Test Loss: 5.130 Test Acc: 0.125
Validation loss decreased (-0.122303 --> -0.124655).  Saving model ...
Epoch: 24 cost time: 4.2000508308410645
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.143 Vali Acc: 0.125 Test Loss: 5.143 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.1207051277160645
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.178 Vali Acc: 0.126 Test Loss: 5.178 Test Acc: 0.126
Validation loss decreased (-0.124655 --> -0.125831).  Saving model ...
Epoch: 26 cost time: 3.4947733879089355
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.206 Vali Acc: 0.129 Test Loss: 5.206 Test Acc: 0.129
Validation loss decreased (-0.125831 --> -0.129360).  Saving model ...
Epoch: 27 cost time: 4.160414695739746
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.229 Vali Acc: 0.128 Test Loss: 5.229 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.8561084270477295
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.256 Vali Acc: 0.126 Test Loss: 5.256 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.912415027618408
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.284 Vali Acc: 0.125 Test Loss: 5.284 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.5702197551727295
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.306 Vali Acc: 0.126 Test Loss: 5.306 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.889843702316284
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.323 Vali Acc: 0.126 Test Loss: 5.323 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.008004188537598
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.342 Vali Acc: 0.128 Test Loss: 5.342 Test Acc: 0.128
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.6615567207336426
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.365 Vali Acc: 0.126 Test Loss: 5.365 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.753263473510742
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.382 Vali Acc: 0.129 Test Loss: 5.382 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.071741580963135
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.392 Vali Acc: 0.129 Test Loss: 5.392 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.735905170440674
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.413 Vali Acc: 0.129 Test Loss: 5.413 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12941176470588237
model parameter : 1365274
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.758939981460571
Epoch: 1, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.322 Vali Acc: 0.041 Test Loss: 3.322 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 3.819082736968994
Epoch: 2, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.396 Vali Acc: 0.055 Test Loss: 3.396 Test Acc: 0.055
Validation loss decreased (-0.041143 --> -0.055260).  Saving model ...
Epoch: 3 cost time: 3.5333616733551025
Epoch: 3, Steps: 10 | Train Loss: 2.915 Vali Loss: 3.412 Vali Acc: 0.061 Test Loss: 3.412 Test Acc: 0.061
Validation loss decreased (-0.055260 --> -0.061142).  Saving model ...
Epoch: 4 cost time: 3.498413562774658
Epoch: 4, Steps: 10 | Train Loss: 2.639 Vali Loss: 3.376 Vali Acc: 0.081 Test Loss: 3.376 Test Acc: 0.081
Validation loss decreased (-0.061142 --> -0.081143).  Saving model ...
Epoch: 5 cost time: 3.497528553009033
Epoch: 5, Steps: 10 | Train Loss: 2.368 Vali Loss: 3.354 Vali Acc: 0.084 Test Loss: 3.354 Test Acc: 0.084
Validation loss decreased (-0.081143 --> -0.083496).  Saving model ...
Epoch: 6 cost time: 3.842731237411499
Epoch: 6, Steps: 10 | Train Loss: 1.962 Vali Loss: 3.420 Vali Acc: 0.094 Test Loss: 3.420 Test Acc: 0.094
Validation loss decreased (-0.083496 --> -0.094083).  Saving model ...
Epoch: 7 cost time: 3.491384983062744
Epoch: 7, Steps: 10 | Train Loss: 1.586 Vali Loss: 3.476 Vali Acc: 0.093 Test Loss: 3.476 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.806398868560791
Epoch: 8, Steps: 10 | Train Loss: 1.160 Vali Loss: 3.626 Vali Acc: 0.089 Test Loss: 3.626 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.675705909729004
Epoch: 9, Steps: 10 | Train Loss: 0.817 Vali Loss: 3.782 Vali Acc: 0.093 Test Loss: 3.782 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.026502847671509
Epoch: 10, Steps: 10 | Train Loss: 0.519 Vali Loss: 4.072 Vali Acc: 0.099 Test Loss: 4.072 Test Acc: 0.099
Validation loss decreased (-0.094083 --> -0.098783).  Saving model ...
Epoch: 11 cost time: 3.8909404277801514
Epoch: 11, Steps: 10 | Train Loss: 0.312 Vali Loss: 4.289 Vali Acc: 0.092 Test Loss: 4.289 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9526846408843994
Epoch: 12, Steps: 10 | Train Loss: 0.170 Vali Loss: 4.537 Vali Acc: 0.101 Test Loss: 4.537 Test Acc: 0.101
Validation loss decreased (-0.098783 --> -0.101131).  Saving model ...
Epoch: 13 cost time: 3.523367166519165
Epoch: 13, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.770 Vali Acc: 0.118 Test Loss: 4.770 Test Acc: 0.118
Validation loss decreased (-0.101131 --> -0.117599).  Saving model ...
Epoch: 14 cost time: 3.4259257316589355
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.842 Vali Acc: 0.122 Test Loss: 4.842 Test Acc: 0.122
Validation loss decreased (-0.117599 --> -0.122305).  Saving model ...
Epoch: 15 cost time: 3.5806331634521484
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.954 Vali Acc: 0.118 Test Loss: 4.954 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4768171310424805
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.079 Vali Acc: 0.119 Test Loss: 5.079 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.715491533279419
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.097 Vali Acc: 0.124 Test Loss: 5.097 Test Acc: 0.124
Validation loss decreased (-0.122305 --> -0.123478).  Saving model ...
Epoch: 18 cost time: 3.779700517654419
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.133 Vali Acc: 0.127 Test Loss: 5.133 Test Acc: 0.127
Validation loss decreased (-0.123478 --> -0.127007).  Saving model ...
Epoch: 19 cost time: 3.938429594039917
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.190 Vali Acc: 0.132 Test Loss: 5.190 Test Acc: 0.132
Validation loss decreased (-0.127007 --> -0.131713).  Saving model ...
Epoch: 20 cost time: 3.831027030944824
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.227 Vali Acc: 0.131 Test Loss: 5.227 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7683725357055664
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.259 Vali Acc: 0.128 Test Loss: 5.259 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.416593074798584
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.272 Vali Acc: 0.128 Test Loss: 5.272 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.7582287788391113
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.293 Vali Acc: 0.127 Test Loss: 5.293 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.561669111251831
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.311 Vali Acc: 0.127 Test Loss: 5.311 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.95052433013916
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.358 Vali Acc: 0.127 Test Loss: 5.358 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.6124796867370605
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.394 Vali Acc: 0.129 Test Loss: 5.394 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.878910779953003
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.407 Vali Acc: 0.128 Test Loss: 5.407 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.262378692626953
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.428 Vali Acc: 0.128 Test Loss: 5.428 Test Acc: 0.128
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.8696279525756836
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.450 Vali Acc: 0.127 Test Loss: 5.450 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13176470588235295
model parameter : 1365274
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.363652467727661
Epoch: 1, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.329 Vali Acc: 0.042 Test Loss: 3.329 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 3.665614128112793
Epoch: 2, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.407 Vali Acc: 0.040 Test Loss: 3.407 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.883174419403076
Epoch: 3, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.437 Vali Acc: 0.056 Test Loss: 3.437 Test Acc: 0.056
Validation loss decreased (-0.042320 --> -0.056436).  Saving model ...
Epoch: 4 cost time: 4.157417297363281
Epoch: 4, Steps: 10 | Train Loss: 2.818 Vali Loss: 3.406 Vali Acc: 0.075 Test Loss: 3.406 Test Acc: 0.075
Validation loss decreased (-0.056436 --> -0.075260).  Saving model ...
Epoch: 5 cost time: 3.765566825866699
Epoch: 5, Steps: 10 | Train Loss: 2.606 Vali Loss: 3.366 Vali Acc: 0.079 Test Loss: 3.366 Test Acc: 0.079
Validation loss decreased (-0.075260 --> -0.078790).  Saving model ...
Epoch: 6 cost time: 3.9170894622802734
Epoch: 6, Steps: 10 | Train Loss: 2.244 Vali Loss: 3.383 Vali Acc: 0.092 Test Loss: 3.383 Test Acc: 0.092
Validation loss decreased (-0.078790 --> -0.091731).  Saving model ...
Epoch: 7 cost time: 3.425103187561035
Epoch: 7, Steps: 10 | Train Loss: 1.924 Vali Loss: 3.425 Vali Acc: 0.095 Test Loss: 3.425 Test Acc: 0.095
Validation loss decreased (-0.091731 --> -0.095260).  Saving model ...
Epoch: 8 cost time: 3.712223529815674
Epoch: 8, Steps: 10 | Train Loss: 1.532 Vali Loss: 3.515 Vali Acc: 0.092 Test Loss: 3.515 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6758644580841064
Epoch: 9, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.589 Vali Acc: 0.108 Test Loss: 3.589 Test Acc: 0.108
Validation loss decreased (-0.095260 --> -0.108199).  Saving model ...
Epoch: 10 cost time: 3.8767762184143066
Epoch: 10, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.778 Vali Acc: 0.105 Test Loss: 3.778 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.958390474319458
Epoch: 11, Steps: 10 | Train Loss: 0.573 Vali Loss: 3.996 Vali Acc: 0.098 Test Loss: 3.996 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9675028324127197
Epoch: 12, Steps: 10 | Train Loss: 0.366 Vali Loss: 4.219 Vali Acc: 0.109 Test Loss: 4.219 Test Acc: 0.109
Validation loss decreased (-0.108199 --> -0.109370).  Saving model ...
Epoch: 13 cost time: 3.502216100692749
Epoch: 13, Steps: 10 | Train Loss: 0.196 Vali Loss: 4.443 Vali Acc: 0.120 Test Loss: 4.443 Test Acc: 0.120
Validation loss decreased (-0.109370 --> -0.119956).  Saving model ...
Epoch: 14 cost time: 3.4368538856506348
Epoch: 14, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.575 Vali Acc: 0.140 Test Loss: 4.575 Test Acc: 0.140
Validation loss decreased (-0.119956 --> -0.139954).  Saving model ...
Epoch: 15 cost time: 3.702599048614502
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.664 Vali Acc: 0.128 Test Loss: 4.664 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7675349712371826
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.791 Vali Acc: 0.129 Test Loss: 4.791 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.849785327911377
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.845 Vali Acc: 0.133 Test Loss: 4.845 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.244365692138672
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.914 Vali Acc: 0.129 Test Loss: 4.914 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.477699041366577
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.980 Vali Acc: 0.121 Test Loss: 4.980 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.676415205001831
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.000 Vali Acc: 0.131 Test Loss: 5.000 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.8451156616210938
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.020 Vali Acc: 0.129 Test Loss: 5.020 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.576152801513672
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.029 Vali Acc: 0.132 Test Loss: 5.029 Test Acc: 0.132
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.8020401000976562
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.050 Vali Acc: 0.133 Test Loss: 5.050 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.3681156635284424
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.068 Vali Acc: 0.131 Test Loss: 5.068 Test Acc: 0.131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14
model parameter : 1365274
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.290477275848389
Epoch: 1, Steps: 10 | Train Loss: 3.334 Vali Loss: 3.326 Vali Acc: 0.040 Test Loss: 3.326 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.9858624935150146
Epoch: 2, Steps: 10 | Train Loss: 3.205 Vali Loss: 3.397 Vali Acc: 0.045 Test Loss: 3.397 Test Acc: 0.045
Validation loss decreased (-0.039967 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 3.614044189453125
Epoch: 3, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.435 Vali Acc: 0.038 Test Loss: 3.435 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5302987098693848
Epoch: 4, Steps: 10 | Train Loss: 2.869 Vali Loss: 3.399 Vali Acc: 0.064 Test Loss: 3.399 Test Acc: 0.064
Validation loss decreased (-0.044672 --> -0.063495).  Saving model ...
Epoch: 5 cost time: 3.80027437210083
Epoch: 5, Steps: 10 | Train Loss: 2.671 Vali Loss: 3.345 Vali Acc: 0.073 Test Loss: 3.345 Test Acc: 0.073
Validation loss decreased (-0.063495 --> -0.072908).  Saving model ...
Epoch: 6 cost time: 4.04851508140564
Epoch: 6, Steps: 10 | Train Loss: 2.394 Vali Loss: 3.365 Vali Acc: 0.084 Test Loss: 3.365 Test Acc: 0.084
Validation loss decreased (-0.072908 --> -0.083496).  Saving model ...
Epoch: 7 cost time: 3.797614574432373
Epoch: 7, Steps: 10 | Train Loss: 2.078 Vali Loss: 3.400 Vali Acc: 0.085 Test Loss: 3.400 Test Acc: 0.085
Validation loss decreased (-0.083496 --> -0.084672).  Saving model ...
Epoch: 8 cost time: 3.617723226547241
Epoch: 8, Steps: 10 | Train Loss: 1.833 Vali Loss: 3.479 Vali Acc: 0.084 Test Loss: 3.479 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.352071523666382
Epoch: 9, Steps: 10 | Train Loss: 1.399 Vali Loss: 3.560 Vali Acc: 0.100 Test Loss: 3.560 Test Acc: 0.100
Validation loss decreased (-0.084672 --> -0.099964).  Saving model ...
Epoch: 10 cost time: 3.488211154937744
Epoch: 10, Steps: 10 | Train Loss: 0.983 Vali Loss: 3.751 Vali Acc: 0.112 Test Loss: 3.751 Test Acc: 0.112
Validation loss decreased (-0.099964 --> -0.111727).  Saving model ...
Epoch: 11 cost time: 3.6823151111602783
Epoch: 11, Steps: 10 | Train Loss: 0.721 Vali Loss: 3.973 Vali Acc: 0.128 Test Loss: 3.973 Test Acc: 0.128
Validation loss decreased (-0.111727 --> -0.128196).  Saving model ...
Epoch: 12 cost time: 3.314924716949463
Epoch: 12, Steps: 10 | Train Loss: 0.476 Vali Loss: 4.139 Vali Acc: 0.129 Test Loss: 4.139 Test Acc: 0.129
Validation loss decreased (-0.128196 --> -0.129370).  Saving model ...
Epoch: 13 cost time: 3.4785192012786865
Epoch: 13, Steps: 10 | Train Loss: 0.271 Vali Loss: 4.406 Vali Acc: 0.133 Test Loss: 4.406 Test Acc: 0.133
Validation loss decreased (-0.129370 --> -0.132897).  Saving model ...
Epoch: 14 cost time: 3.836696147918701
Epoch: 14, Steps: 10 | Train Loss: 0.163 Vali Loss: 4.497 Vali Acc: 0.149 Test Loss: 4.497 Test Acc: 0.149
Validation loss decreased (-0.132897 --> -0.149367).  Saving model ...
Epoch: 15 cost time: 3.5603861808776855
Epoch: 15, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.542 Vali Acc: 0.151 Test Loss: 4.542 Test Acc: 0.151
Validation loss decreased (-0.149367 --> -0.150543).  Saving model ...
Epoch: 16 cost time: 3.5359370708465576
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.837 Vali Acc: 0.144 Test Loss: 4.837 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.002206802368164
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.892 Vali Acc: 0.153 Test Loss: 4.892 Test Acc: 0.153
Validation loss decreased (-0.150543 --> -0.152892).  Saving model ...
Epoch: 18 cost time: 3.7358744144439697
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.972 Vali Acc: 0.159 Test Loss: 4.972 Test Acc: 0.159
Validation loss decreased (-0.152892 --> -0.158774).  Saving model ...
Epoch: 19 cost time: 3.859963893890381
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.044 Vali Acc: 0.146 Test Loss: 5.044 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6363961696624756
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.090 Vali Acc: 0.144 Test Loss: 5.090 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.4678711891174316
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.087 Vali Acc: 0.146 Test Loss: 5.087 Test Acc: 0.146
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.7840640544891357
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.079 Vali Acc: 0.155 Test Loss: 5.079 Test Acc: 0.155
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.5237648487091064
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.084 Vali Acc: 0.160 Test Loss: 5.084 Test Acc: 0.160
Validation loss decreased (-0.158774 --> -0.159949).  Saving model ...
Epoch: 24 cost time: 3.7688210010528564
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.111 Vali Acc: 0.161 Test Loss: 5.111 Test Acc: 0.161
Validation loss decreased (-0.159949 --> -0.161125).  Saving model ...
Epoch: 25 cost time: 3.41758394241333
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.151 Vali Acc: 0.158 Test Loss: 5.151 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.608448028564453
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.186 Vali Acc: 0.160 Test Loss: 5.186 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.6184945106506348
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.214 Vali Acc: 0.159 Test Loss: 5.214 Test Acc: 0.159
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.892758369445801
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.233 Vali Acc: 0.160 Test Loss: 5.233 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.5453426837921143
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.256 Vali Acc: 0.156 Test Loss: 5.256 Test Acc: 0.156
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.691845417022705
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.271 Vali Acc: 0.155 Test Loss: 5.271 Test Acc: 0.155
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.302295207977295
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.282 Vali Acc: 0.161 Test Loss: 5.282 Test Acc: 0.161
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.508807420730591
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.296 Vali Acc: 0.161 Test Loss: 5.296 Test Acc: 0.161
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.169432878494263
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.316 Vali Acc: 0.161 Test Loss: 5.316 Test Acc: 0.161
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.7825915813446045
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.327 Vali Acc: 0.162 Test Loss: 5.327 Test Acc: 0.162
Validation loss decreased (-0.161125 --> -0.162300).  Saving model ...
Epoch: 35 cost time: 3.9361016750335693
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.333 Vali Acc: 0.164 Test Loss: 5.333 Test Acc: 0.164
Validation loss decreased (-0.162300 --> -0.163476).  Saving model ...
Epoch: 36 cost time: 3.411219358444214
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.349 Vali Acc: 0.160 Test Loss: 5.349 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.1625540256500244
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.375 Vali Acc: 0.164 Test Loss: 5.375 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.7773385047912598
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.403 Vali Acc: 0.161 Test Loss: 5.403 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.7456724643707275
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.424 Vali Acc: 0.164 Test Loss: 5.424 Test Acc: 0.164
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.836271047592163
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.432 Vali Acc: 0.164 Test Loss: 5.432 Test Acc: 0.164
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.033721208572388
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.435 Vali Acc: 0.162 Test Loss: 5.435 Test Acc: 0.162
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.9145166873931885
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.441 Vali Acc: 0.165 Test Loss: 5.441 Test Acc: 0.165
Validation loss decreased (-0.163476 --> -0.164651).  Saving model ...
Epoch: 43 cost time: 4.079784870147705
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.451 Vali Acc: 0.161 Test Loss: 5.451 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.9699745178222656
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.457 Vali Acc: 0.162 Test Loss: 5.457 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.9334418773651123
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.480 Vali Acc: 0.162 Test Loss: 5.480 Test Acc: 0.162
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.562378406524658
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.487 Vali Acc: 0.162 Test Loss: 5.487 Test Acc: 0.162
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.2748677730560303
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.490 Vali Acc: 0.161 Test Loss: 5.490 Test Acc: 0.161
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.578202247619629
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.505 Vali Acc: 0.159 Test Loss: 5.505 Test Acc: 0.159
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 4.133820533752441
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.519 Vali Acc: 0.162 Test Loss: 5.519 Test Acc: 0.162
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.793224811553955
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.533 Vali Acc: 0.164 Test Loss: 5.533 Test Acc: 0.164
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.6539056301116943
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.545 Vali Acc: 0.164 Test Loss: 5.545 Test Acc: 0.164
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.523458480834961
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.564 Vali Acc: 0.165 Test Loss: 5.564 Test Acc: 0.165
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16470588235294117
model parameter : 1365274
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.851315259933472
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.039 Test Loss: 3.258 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 3.727339029312134
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.036 Test Loss: 3.258 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4910805225372314
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.036 Test Loss: 3.258 Test Acc: 0.036
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4353489875793457
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.038791 --> -0.042320).  Saving model ...
Epoch: 5 cost time: 3.686923027038574
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 6 cost time: 3.2941644191741943
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 7 cost time: 3.953883171081543
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 8 cost time: 3.954824447631836
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 9 cost time: 3.8871066570281982
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 10 cost time: 3.8741109371185303
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 11 cost time: 3.3352720737457275
Epoch: 11, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 12 cost time: 3.862696647644043
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 13 cost time: 3.813765048980713
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.042 Test Loss: 3.258 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 14 cost time: 3.689253807067871
Epoch: 14, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.00339150428772
Epoch: 15, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.674952983856201
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.9504103660583496
Epoch: 17, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.357239246368408
Epoch: 18, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.852470874786377
Epoch: 19, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.8036725521087646
Epoch: 20, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.6881070137023926
Epoch: 21, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.760802745819092
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.611953020095825
Epoch: 23, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.042352941176470586
model parameter : 1365274
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.108267784118652
Epoch: 1, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.287 Vali Acc: 0.039 Test Loss: 3.287 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 3.663285255432129
Epoch: 2, Steps: 10 | Train Loss: 2.931 Vali Loss: 3.327 Vali Acc: 0.107 Test Loss: 3.327 Test Acc: 0.107
Validation loss decreased (-0.038791 --> -0.107026).  Saving model ...
Epoch: 3 cost time: 4.306254863739014
Epoch: 3, Steps: 10 | Train Loss: 2.301 Vali Loss: 3.161 Vali Acc: 0.158 Test Loss: 3.161 Test Acc: 0.158
Validation loss decreased (-0.107026 --> -0.157615).  Saving model ...
Epoch: 4 cost time: 3.85302734375
Epoch: 4, Steps: 10 | Train Loss: 1.684 Vali Loss: 3.110 Vali Acc: 0.196 Test Loss: 3.110 Test Acc: 0.196
Validation loss decreased (-0.157615 --> -0.196439).  Saving model ...
Epoch: 5 cost time: 3.964289903640747
Epoch: 5, Steps: 10 | Train Loss: 1.171 Vali Loss: 3.152 Vali Acc: 0.236 Test Loss: 3.152 Test Acc: 0.236
Validation loss decreased (-0.196439 --> -0.236439).  Saving model ...
Epoch: 6 cost time: 3.866375207901001
Epoch: 6, Steps: 10 | Train Loss: 0.751 Vali Loss: 3.301 Vali Acc: 0.233 Test Loss: 3.301 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.530085325241089
Epoch: 7, Steps: 10 | Train Loss: 0.469 Vali Loss: 3.417 Vali Acc: 0.256 Test Loss: 3.417 Test Acc: 0.256
Validation loss decreased (-0.236439 --> -0.256436).  Saving model ...
Epoch: 8 cost time: 4.141513347625732
Epoch: 8, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.444 Vali Acc: 0.266 Test Loss: 3.444 Test Acc: 0.266
Validation loss decreased (-0.256436 --> -0.265848).  Saving model ...
Epoch: 9 cost time: 3.7347490787506104
Epoch: 9, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.669 Vali Acc: 0.265 Test Loss: 3.669 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.014263391494751
Epoch: 10, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.753 Vali Acc: 0.276 Test Loss: 3.753 Test Acc: 0.276
Validation loss decreased (-0.265848 --> -0.276433).  Saving model ...
Epoch: 11 cost time: 3.547683000564575
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.903 Vali Acc: 0.298 Test Loss: 3.903 Test Acc: 0.298
Validation loss decreased (-0.276433 --> -0.297608).  Saving model ...
Epoch: 12 cost time: 3.723362445831299
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.946 Vali Acc: 0.284 Test Loss: 3.946 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.07866096496582
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.010 Vali Acc: 0.289 Test Loss: 4.010 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.862412452697754
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.080 Vali Acc: 0.289 Test Loss: 4.080 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.6923654079437256
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.108 Vali Acc: 0.293 Test Loss: 4.108 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.403768539428711
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.113 Vali Acc: 0.292 Test Loss: 4.113 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.921424627304077
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.140 Vali Acc: 0.298 Test Loss: 4.140 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.612128257751465
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.178 Vali Acc: 0.299 Test Loss: 4.178 Test Acc: 0.299
Validation loss decreased (-0.297608 --> -0.298782).  Saving model ...
Epoch: 19 cost time: 4.176506280899048
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.212 Vali Acc: 0.300 Test Loss: 4.212 Test Acc: 0.300
Validation loss decreased (-0.298782 --> -0.299958).  Saving model ...
Epoch: 20 cost time: 4.024929761886597
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.233 Vali Acc: 0.301 Test Loss: 4.233 Test Acc: 0.301
Validation loss decreased (-0.299958 --> -0.301134).  Saving model ...
Epoch: 21 cost time: 3.829195737838745
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.249 Vali Acc: 0.300 Test Loss: 4.249 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7827279567718506
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.269 Vali Acc: 0.304 Test Loss: 4.269 Test Acc: 0.304
Validation loss decreased (-0.301134 --> -0.303487).  Saving model ...
Epoch: 23 cost time: 3.947970151901245
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.293 Vali Acc: 0.295 Test Loss: 4.293 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.0692219734191895
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.316 Vali Acc: 0.296 Test Loss: 4.316 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.6386027336120605
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.343 Vali Acc: 0.299 Test Loss: 4.343 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.6050078868865967
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.364 Vali Acc: 0.300 Test Loss: 4.364 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.653043270111084
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.382 Vali Acc: 0.298 Test Loss: 4.382 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.7976839542388916
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.401 Vali Acc: 0.304 Test Loss: 4.401 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.150554895401001
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.424 Vali Acc: 0.305 Test Loss: 4.424 Test Acc: 0.305
Validation loss decreased (-0.303487 --> -0.304662).  Saving model ...
Epoch: 30 cost time: 4.010079383850098
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.448 Vali Acc: 0.304 Test Loss: 4.448 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.8941752910614014
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.476 Vali Acc: 0.300 Test Loss: 4.476 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.6522765159606934
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.491 Vali Acc: 0.300 Test Loss: 4.491 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.341315507888794
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.501 Vali Acc: 0.305 Test Loss: 4.501 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.497520446777344
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.510 Vali Acc: 0.304 Test Loss: 4.510 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.031588077545166
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.529 Vali Acc: 0.306 Test Loss: 4.529 Test Acc: 0.306
Validation loss decreased (-0.304662 --> -0.305837).  Saving model ...
Epoch: 36 cost time: 3.720163106918335
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.545 Vali Acc: 0.306 Test Loss: 4.545 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.6885623931884766
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.555 Vali Acc: 0.304 Test Loss: 4.555 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.4054038524627686
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.575 Vali Acc: 0.304 Test Loss: 4.575 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.367363929748535
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.588 Vali Acc: 0.304 Test Loss: 4.588 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.415952682495117
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.605 Vali Acc: 0.306 Test Loss: 4.605 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.077020883560181
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.616 Vali Acc: 0.305 Test Loss: 4.616 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.158886194229126
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.629 Vali Acc: 0.306 Test Loss: 4.629 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.8222196102142334
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.632 Vali Acc: 0.306 Test Loss: 4.632 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.098482608795166
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.648 Vali Acc: 0.306 Test Loss: 4.648 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 4.121016263961792
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.661 Vali Acc: 0.306 Test Loss: 4.661 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3058823529411765
model parameter : 1266970
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.2508440017700195
Epoch: 1, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.305 Vali Acc: 0.051 Test Loss: 3.305 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 4.008625745773315
Epoch: 2, Steps: 10 | Train Loss: 2.954 Vali Loss: 3.340 Vali Acc: 0.100 Test Loss: 3.340 Test Acc: 0.100
Validation loss decreased (-0.050555 --> -0.099967).  Saving model ...
Epoch: 3 cost time: 4.186513423919678
Epoch: 3, Steps: 10 | Train Loss: 2.321 Vali Loss: 3.175 Vali Acc: 0.164 Test Loss: 3.175 Test Acc: 0.164
Validation loss decreased (-0.099967 --> -0.163498).  Saving model ...
Epoch: 4 cost time: 3.9462573528289795
Epoch: 4, Steps: 10 | Train Loss: 1.715 Vali Loss: 3.116 Vali Acc: 0.205 Test Loss: 3.116 Test Acc: 0.205
Validation loss decreased (-0.163498 --> -0.204675).  Saving model ...
Epoch: 5 cost time: 4.492163419723511
Epoch: 5, Steps: 10 | Train Loss: 1.203 Vali Loss: 3.156 Vali Acc: 0.233 Test Loss: 3.156 Test Acc: 0.233
Validation loss decreased (-0.204675 --> -0.232910).  Saving model ...
Epoch: 6 cost time: 3.583538055419922
Epoch: 6, Steps: 10 | Train Loss: 0.759 Vali Loss: 3.286 Vali Acc: 0.247 Test Loss: 3.286 Test Acc: 0.247
Validation loss decreased (-0.232910 --> -0.247026).  Saving model ...
Epoch: 7 cost time: 3.570344924926758
Epoch: 7, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.400 Vali Acc: 0.268 Test Loss: 3.400 Test Acc: 0.268
Validation loss decreased (-0.247026 --> -0.268201).  Saving model ...
Epoch: 8 cost time: 3.9799280166625977
Epoch: 8, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.454 Vali Acc: 0.288 Test Loss: 3.454 Test Acc: 0.288
Validation loss decreased (-0.268201 --> -0.288201).  Saving model ...
Epoch: 9 cost time: 3.6120688915252686
Epoch: 9, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.744 Vali Acc: 0.276 Test Loss: 3.744 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.109792709350586
Epoch: 10, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.788 Vali Acc: 0.308 Test Loss: 3.788 Test Acc: 0.308
Validation loss decreased (-0.288201 --> -0.308197).  Saving model ...
Epoch: 11 cost time: 4.170744180679321
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.915 Vali Acc: 0.306 Test Loss: 3.915 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.0641844272613525
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.029 Vali Acc: 0.294 Test Loss: 4.029 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.4526941776275635
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.079 Vali Acc: 0.307 Test Loss: 4.079 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.224583864212036
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.144 Vali Acc: 0.304 Test Loss: 4.144 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.1146323680877686
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.155 Vali Acc: 0.307 Test Loss: 4.155 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.9681408405303955
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.179 Vali Acc: 0.312 Test Loss: 4.179 Test Acc: 0.312
Validation loss decreased (-0.308197 --> -0.311723).  Saving model ...
Epoch: 17 cost time: 4.018660545349121
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.199 Vali Acc: 0.316 Test Loss: 4.199 Test Acc: 0.316
Validation loss decreased (-0.311723 --> -0.316429).  Saving model ...
Epoch: 18 cost time: 3.6472039222717285
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.232 Vali Acc: 0.319 Test Loss: 4.232 Test Acc: 0.319
Validation loss decreased (-0.316429 --> -0.318781).  Saving model ...
Epoch: 19 cost time: 4.037560224533081
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.260 Vali Acc: 0.318 Test Loss: 4.260 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.964235782623291
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.281 Vali Acc: 0.314 Test Loss: 4.281 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.019723415374756
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.296 Vali Acc: 0.313 Test Loss: 4.296 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.8403756618499756
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.314 Vali Acc: 0.315 Test Loss: 4.314 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.066797733306885
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.342 Vali Acc: 0.316 Test Loss: 4.342 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.226303577423096
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.367 Vali Acc: 0.316 Test Loss: 4.367 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.9851250648498535
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.392 Vali Acc: 0.316 Test Loss: 4.392 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.8838393688201904
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.412 Vali Acc: 0.311 Test Loss: 4.412 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.6701550483703613
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.428 Vali Acc: 0.314 Test Loss: 4.428 Test Acc: 0.314
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.944459915161133
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.445 Vali Acc: 0.313 Test Loss: 4.445 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31882352941176473
model parameter : 1266970
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.641177177429199
Epoch: 1, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.295 Vali Acc: 0.060 Test Loss: 3.295 Test Acc: 0.060
Validation loss decreased (inf --> -0.059967).  Saving model ...
Epoch: 2 cost time: 4.179885387420654
Epoch: 2, Steps: 10 | Train Loss: 2.940 Vali Loss: 3.328 Vali Acc: 0.119 Test Loss: 3.328 Test Acc: 0.119
Validation loss decreased (-0.059967 --> -0.118790).  Saving model ...
Epoch: 3 cost time: 4.451739072799683
Epoch: 3, Steps: 10 | Train Loss: 2.317 Vali Loss: 3.190 Vali Acc: 0.164 Test Loss: 3.190 Test Acc: 0.164
Validation loss decreased (-0.118790 --> -0.163498).  Saving model ...
Epoch: 4 cost time: 3.843776226043701
Epoch: 4, Steps: 10 | Train Loss: 1.756 Vali Loss: 3.161 Vali Acc: 0.221 Test Loss: 3.161 Test Acc: 0.221
Validation loss decreased (-0.163498 --> -0.221145).  Saving model ...
Epoch: 5 cost time: 3.999103546142578
Epoch: 5, Steps: 10 | Train Loss: 1.306 Vali Loss: 3.210 Vali Acc: 0.244 Test Loss: 3.210 Test Acc: 0.244
Validation loss decreased (-0.221145 --> -0.243497).  Saving model ...
Epoch: 6 cost time: 4.204567909240723
Epoch: 6, Steps: 10 | Train Loss: 0.873 Vali Loss: 3.328 Vali Acc: 0.264 Test Loss: 3.328 Test Acc: 0.264
Validation loss decreased (-0.243497 --> -0.263496).  Saving model ...
Epoch: 7 cost time: 4.2585508823394775
Epoch: 7, Steps: 10 | Train Loss: 0.582 Vali Loss: 3.445 Vali Acc: 0.275 Test Loss: 3.445 Test Acc: 0.275
Validation loss decreased (-0.263496 --> -0.275260).  Saving model ...
Epoch: 8 cost time: 4.345452308654785
Epoch: 8, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.448 Vali Acc: 0.291 Test Loss: 3.448 Test Acc: 0.291
Validation loss decreased (-0.275260 --> -0.290554).  Saving model ...
Epoch: 9 cost time: 3.829399585723877
Epoch: 9, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.645 Vali Acc: 0.261 Test Loss: 3.645 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.331887722015381
Epoch: 10, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.745 Vali Acc: 0.294 Test Loss: 3.745 Test Acc: 0.294
Validation loss decreased (-0.290554 --> -0.294080).  Saving model ...
Epoch: 11 cost time: 3.8957467079162598
Epoch: 11, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.914 Vali Acc: 0.306 Test Loss: 3.914 Test Acc: 0.306
Validation loss decreased (-0.294080 --> -0.305843).  Saving model ...
Epoch: 12 cost time: 3.9568638801574707
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.991 Vali Acc: 0.289 Test Loss: 3.991 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9074885845184326
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.041 Vali Acc: 0.298 Test Loss: 4.041 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7409825325012207
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.129 Vali Acc: 0.300 Test Loss: 4.129 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.204113960266113
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.132 Vali Acc: 0.308 Test Loss: 4.132 Test Acc: 0.308
Validation loss decreased (-0.305843 --> -0.308194).  Saving model ...
Epoch: 16 cost time: 4.0170745849609375
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.178 Vali Acc: 0.308 Test Loss: 4.178 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.207402229309082
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.195 Vali Acc: 0.318 Test Loss: 4.195 Test Acc: 0.318
Validation loss decreased (-0.308194 --> -0.317605).  Saving model ...
Epoch: 18 cost time: 4.236614465713501
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.230 Vali Acc: 0.320 Test Loss: 4.230 Test Acc: 0.320
Validation loss decreased (-0.317605 --> -0.319958).  Saving model ...
Epoch: 19 cost time: 3.8906891345977783
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.275 Vali Acc: 0.316 Test Loss: 4.275 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.781039237976074
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.304 Vali Acc: 0.314 Test Loss: 4.304 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.004507303237915
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.326 Vali Acc: 0.314 Test Loss: 4.326 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.151575326919556
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.340 Vali Acc: 0.319 Test Loss: 4.340 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.045905351638794
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.364 Vali Acc: 0.314 Test Loss: 4.364 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.001309633255005
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.389 Vali Acc: 0.313 Test Loss: 4.389 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.35071063041687
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.420 Vali Acc: 0.318 Test Loss: 4.420 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.852393388748169
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.449 Vali Acc: 0.318 Test Loss: 4.449 Test Acc: 0.318
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.8106017112731934
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.466 Vali Acc: 0.322 Test Loss: 4.466 Test Acc: 0.322
Validation loss decreased (-0.319958 --> -0.322308).  Saving model ...
Epoch: 28 cost time: 4.260302782058716
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.478 Vali Acc: 0.322 Test Loss: 4.478 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.8326656818389893
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.503 Vali Acc: 0.322 Test Loss: 4.503 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.589543342590332
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.527 Vali Acc: 0.326 Test Loss: 4.527 Test Acc: 0.326
Validation loss decreased (-0.322308 --> -0.325837).  Saving model ...
Epoch: 31 cost time: 4.372090101242065
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.548 Vali Acc: 0.324 Test Loss: 4.548 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.5114822387695312
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.566 Vali Acc: 0.321 Test Loss: 4.566 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.8062756061553955
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.586 Vali Acc: 0.320 Test Loss: 4.586 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.905841588973999
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.601 Vali Acc: 0.319 Test Loss: 4.601 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.8203821182250977
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.617 Vali Acc: 0.319 Test Loss: 4.617 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.723360300064087
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.628 Vali Acc: 0.320 Test Loss: 4.628 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.765943765640259
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.640 Vali Acc: 0.321 Test Loss: 4.640 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 4.030322313308716
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.662 Vali Acc: 0.319 Test Loss: 4.662 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.6763668060302734
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.677 Vali Acc: 0.320 Test Loss: 4.677 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 4.010812282562256
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.696 Vali Acc: 0.320 Test Loss: 4.696 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 1266970
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.38340425491333
Epoch: 1, Steps: 10 | Train Loss: 3.262 Vali Loss: 3.297 Vali Acc: 0.040 Test Loss: 3.297 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.8681681156158447
Epoch: 2, Steps: 10 | Train Loss: 2.926 Vali Loss: 3.360 Vali Acc: 0.107 Test Loss: 3.360 Test Acc: 0.107
Validation loss decreased (-0.039967 --> -0.107025).  Saving model ...
Epoch: 3 cost time: 4.455743312835693
Epoch: 3, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.274 Vali Acc: 0.133 Test Loss: 3.274 Test Acc: 0.133
Validation loss decreased (-0.107025 --> -0.132908).  Saving model ...
Epoch: 4 cost time: 3.7393605709075928
Epoch: 4, Steps: 10 | Train Loss: 1.821 Vali Loss: 3.300 Vali Acc: 0.156 Test Loss: 3.300 Test Acc: 0.156
Validation loss decreased (-0.132908 --> -0.156438).  Saving model ...
Epoch: 5 cost time: 3.9584028720855713
Epoch: 5, Steps: 10 | Train Loss: 1.359 Vali Loss: 3.405 Vali Acc: 0.179 Test Loss: 3.405 Test Acc: 0.179
Validation loss decreased (-0.156438 --> -0.178789).  Saving model ...
Epoch: 6 cost time: 4.229881525039673
Epoch: 6, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.564 Vali Acc: 0.186 Test Loss: 3.564 Test Acc: 0.186
Validation loss decreased (-0.178789 --> -0.185847).  Saving model ...
Epoch: 7 cost time: 4.372925519943237
Epoch: 7, Steps: 10 | Train Loss: 0.662 Vali Loss: 3.700 Vali Acc: 0.212 Test Loss: 3.700 Test Acc: 0.212
Validation loss decreased (-0.185847 --> -0.211728).  Saving model ...
Epoch: 8 cost time: 4.352010488510132
Epoch: 8, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.741 Vali Acc: 0.236 Test Loss: 3.741 Test Acc: 0.236
Validation loss decreased (-0.211728 --> -0.236433).  Saving model ...
Epoch: 9 cost time: 4.290791749954224
Epoch: 9, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.954 Vali Acc: 0.225 Test Loss: 3.954 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.998957872390747
Epoch: 10, Steps: 10 | Train Loss: 0.154 Vali Loss: 4.130 Vali Acc: 0.236 Test Loss: 4.130 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.642940282821655
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.292 Vali Acc: 0.249 Test Loss: 4.292 Test Acc: 0.249
Validation loss decreased (-0.236433 --> -0.249369).  Saving model ...
Epoch: 12 cost time: 4.6298792362213135
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.360 Vali Acc: 0.245 Test Loss: 4.360 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.306622743606567
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.510 Vali Acc: 0.236 Test Loss: 4.510 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.159299373626709
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.577 Vali Acc: 0.249 Test Loss: 4.577 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.8236443996429443
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.588 Vali Acc: 0.259 Test Loss: 4.588 Test Acc: 0.259
Validation loss decreased (-0.249369 --> -0.258778).  Saving model ...
Epoch: 16 cost time: 4.212385177612305
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.635 Vali Acc: 0.251 Test Loss: 4.635 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.026756763458252
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.673 Vali Acc: 0.262 Test Loss: 4.673 Test Acc: 0.262
Validation loss decreased (-0.258778 --> -0.262306).  Saving model ...
Epoch: 18 cost time: 3.9879088401794434
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.731 Vali Acc: 0.262 Test Loss: 4.731 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9993293285369873
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.785 Vali Acc: 0.258 Test Loss: 4.785 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.888306140899658
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.796 Vali Acc: 0.259 Test Loss: 4.796 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.22824239730835
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.805 Vali Acc: 0.258 Test Loss: 4.805 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.213251352310181
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.830 Vali Acc: 0.261 Test Loss: 4.830 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.4999847412109375
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.865 Vali Acc: 0.262 Test Loss: 4.865 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.8390743732452393
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.898 Vali Acc: 0.264 Test Loss: 4.898 Test Acc: 0.264
Validation loss decreased (-0.262306 --> -0.263480).  Saving model ...
Epoch: 25 cost time: 3.911696195602417
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.925 Vali Acc: 0.264 Test Loss: 4.925 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.315988302230835
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.943 Vali Acc: 0.268 Test Loss: 4.943 Test Acc: 0.268
Validation loss decreased (-0.263480 --> -0.268186).  Saving model ...
Epoch: 27 cost time: 4.572534084320068
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.968 Vali Acc: 0.268 Test Loss: 4.968 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.867199182510376
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.990 Vali Acc: 0.267 Test Loss: 4.990 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.999342679977417
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.018 Vali Acc: 0.265 Test Loss: 5.018 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.286128997802734
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.046 Vali Acc: 0.265 Test Loss: 5.046 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.492703437805176
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.069 Vali Acc: 0.266 Test Loss: 5.069 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.0838844776153564
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.087 Vali Acc: 0.268 Test Loss: 5.087 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.7390387058258057
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.103 Vali Acc: 0.268 Test Loss: 5.103 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.7751686573028564
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.118 Vali Acc: 0.268 Test Loss: 5.118 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.105147123336792
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.138 Vali Acc: 0.266 Test Loss: 5.138 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.164478302001953
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.149 Vali Acc: 0.269 Test Loss: 5.149 Test Acc: 0.269
Validation loss decreased (-0.268186 --> -0.269360).  Saving model ...
Epoch: 37 cost time: 4.071054697036743
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.160 Vali Acc: 0.271 Test Loss: 5.160 Test Acc: 0.271
Validation loss decreased (-0.269360 --> -0.270537).  Saving model ...
Epoch: 38 cost time: 4.027724981307983
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.180 Vali Acc: 0.269 Test Loss: 5.180 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.090710639953613
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.194 Vali Acc: 0.272 Test Loss: 5.194 Test Acc: 0.272
Validation loss decreased (-0.270537 --> -0.271713).  Saving model ...
Epoch: 40 cost time: 4.692662239074707
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.212 Vali Acc: 0.272 Test Loss: 5.212 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.382553577423096
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.225 Vali Acc: 0.268 Test Loss: 5.225 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.4632275104522705
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.241 Vali Acc: 0.268 Test Loss: 5.241 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.83663010597229
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.248 Vali Acc: 0.272 Test Loss: 5.248 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.849173069000244
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.263 Vali Acc: 0.272 Test Loss: 5.263 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 4.347146034240723
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.275 Vali Acc: 0.273 Test Loss: 5.275 Test Acc: 0.273
Validation loss decreased (-0.271713 --> -0.272888).  Saving model ...
Epoch: 46 cost time: 3.9532647132873535
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.288 Vali Acc: 0.274 Test Loss: 5.288 Test Acc: 0.274
Validation loss decreased (-0.272888 --> -0.274065).  Saving model ...
Epoch: 47 cost time: 3.888463020324707
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.305 Vali Acc: 0.275 Test Loss: 5.305 Test Acc: 0.275
Validation loss decreased (-0.274065 --> -0.275241).  Saving model ...
Epoch: 48 cost time: 4.131476402282715
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.329 Vali Acc: 0.275 Test Loss: 5.329 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 4.087927579879761
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.347 Vali Acc: 0.274 Test Loss: 5.347 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.811373233795166
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.358 Vali Acc: 0.274 Test Loss: 5.358 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 4.15971827507019
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.372 Vali Acc: 0.273 Test Loss: 5.372 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.6896159648895264
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.384 Vali Acc: 0.272 Test Loss: 5.384 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 4.010405778884888
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.393 Vali Acc: 0.272 Test Loss: 5.393 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.8624942302703857
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.410 Vali Acc: 0.272 Test Loss: 5.410 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 4.272669076919556
Epoch: 55, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.423 Vali Acc: 0.272 Test Loss: 5.423 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.9597716331481934
Epoch: 56, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.438 Vali Acc: 0.271 Test Loss: 5.438 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.7724878787994385
Epoch: 57, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.449 Vali Acc: 0.273 Test Loss: 5.449 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 1266970
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.489518404006958
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.349 Vali Acc: 0.047 Test Loss: 3.349 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 4.0595622062683105
Epoch: 2, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.433 Vali Acc: 0.064 Test Loss: 3.433 Test Acc: 0.064
Validation loss decreased (-0.047025 --> -0.063495).  Saving model ...
Epoch: 3 cost time: 4.066580533981323
Epoch: 3, Steps: 10 | Train Loss: 2.554 Vali Loss: 3.366 Vali Acc: 0.071 Test Loss: 3.366 Test Acc: 0.071
Validation loss decreased (-0.063495 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 4.409747838973999
Epoch: 4, Steps: 10 | Train Loss: 2.002 Vali Loss: 3.382 Vali Acc: 0.094 Test Loss: 3.382 Test Acc: 0.094
Validation loss decreased (-0.070555 --> -0.094084).  Saving model ...
Epoch: 5 cost time: 3.870514154434204
Epoch: 5, Steps: 10 | Train Loss: 1.456 Vali Loss: 3.454 Vali Acc: 0.105 Test Loss: 3.454 Test Acc: 0.105
Validation loss decreased (-0.094084 --> -0.104671).  Saving model ...
Epoch: 6 cost time: 3.898308515548706
Epoch: 6, Steps: 10 | Train Loss: 1.009 Vali Loss: 3.657 Vali Acc: 0.112 Test Loss: 3.657 Test Acc: 0.112
Validation loss decreased (-0.104671 --> -0.111728).  Saving model ...
Epoch: 7 cost time: 4.4299821853637695
Epoch: 7, Steps: 10 | Train Loss: 0.651 Vali Loss: 3.831 Vali Acc: 0.119 Test Loss: 3.831 Test Acc: 0.119
Validation loss decreased (-0.111728 --> -0.118785).  Saving model ...
Epoch: 8 cost time: 4.366406202316284
Epoch: 8, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.981 Vali Acc: 0.122 Test Loss: 3.981 Test Acc: 0.122
Validation loss decreased (-0.118785 --> -0.122313).  Saving model ...
Epoch: 9 cost time: 4.1427693367004395
Epoch: 9, Steps: 10 | Train Loss: 0.216 Vali Loss: 4.251 Vali Acc: 0.135 Test Loss: 4.251 Test Acc: 0.135
Validation loss decreased (-0.122313 --> -0.135252).  Saving model ...
Epoch: 10 cost time: 3.8938138484954834
Epoch: 10, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.456 Vali Acc: 0.139 Test Loss: 4.456 Test Acc: 0.139
Validation loss decreased (-0.135252 --> -0.138779).  Saving model ...
Epoch: 11 cost time: 4.240291595458984
Epoch: 11, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.661 Vali Acc: 0.139 Test Loss: 4.661 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.248281955718994
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.717 Vali Acc: 0.140 Test Loss: 4.717 Test Acc: 0.140
Validation loss decreased (-0.138779 --> -0.139953).  Saving model ...
Epoch: 13 cost time: 3.934108018875122
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.850 Vali Acc: 0.149 Test Loss: 4.850 Test Acc: 0.149
Validation loss decreased (-0.139953 --> -0.149363).  Saving model ...
Epoch: 14 cost time: 4.123271703720093
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.954 Vali Acc: 0.140 Test Loss: 4.954 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.331111431121826
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.994 Vali Acc: 0.138 Test Loss: 4.994 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.2383599281311035
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.026 Vali Acc: 0.141 Test Loss: 5.026 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8532791137695312
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.048 Vali Acc: 0.142 Test Loss: 5.048 Test Acc: 0.142
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.893505096435547
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.100 Vali Acc: 0.142 Test Loss: 5.100 Test Acc: 0.142
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.100201606750488
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.145 Vali Acc: 0.144 Test Loss: 5.145 Test Acc: 0.144
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.156233072280884
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.184 Vali Acc: 0.148 Test Loss: 5.184 Test Acc: 0.148
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.154416561126709
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.221 Vali Acc: 0.146 Test Loss: 5.221 Test Acc: 0.146
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.3702497482299805
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.244 Vali Acc: 0.145 Test Loss: 5.244 Test Acc: 0.145
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.029505014419556
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.280 Vali Acc: 0.148 Test Loss: 5.280 Test Acc: 0.148
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14941176470588236
model parameter : 1266970
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.700342893600464
Epoch: 1, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.323 Vali Acc: 0.042 Test Loss: 3.323 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 3.8580856323242188
Epoch: 2, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.428 Vali Acc: 0.048 Test Loss: 3.428 Test Acc: 0.048
Validation loss decreased (-0.042320 --> -0.048201).  Saving model ...
Epoch: 3 cost time: 3.539048671722412
Epoch: 3, Steps: 10 | Train Loss: 2.754 Vali Loss: 3.390 Vali Acc: 0.059 Test Loss: 3.390 Test Acc: 0.059
Validation loss decreased (-0.048201 --> -0.058790).  Saving model ...
Epoch: 4 cost time: 3.6974658966064453
Epoch: 4, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.366 Vali Acc: 0.079 Test Loss: 3.366 Test Acc: 0.079
Validation loss decreased (-0.058790 --> -0.078790).  Saving model ...
Epoch: 5 cost time: 3.745492458343506
Epoch: 5, Steps: 10 | Train Loss: 1.856 Vali Loss: 3.375 Vali Acc: 0.091 Test Loss: 3.375 Test Acc: 0.091
Validation loss decreased (-0.078790 --> -0.090554).  Saving model ...
Epoch: 6 cost time: 3.7875735759735107
Epoch: 6, Steps: 10 | Train Loss: 1.451 Vali Loss: 3.504 Vali Acc: 0.087 Test Loss: 3.504 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.741283416748047
Epoch: 7, Steps: 10 | Train Loss: 1.054 Vali Loss: 3.610 Vali Acc: 0.094 Test Loss: 3.610 Test Acc: 0.094
Validation loss decreased (-0.090554 --> -0.094082).  Saving model ...
Epoch: 8 cost time: 4.227865695953369
Epoch: 8, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.716 Vali Acc: 0.102 Test Loss: 3.716 Test Acc: 0.102
Validation loss decreased (-0.094082 --> -0.102316).  Saving model ...
Epoch: 9 cost time: 4.113202333450317
Epoch: 9, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.915 Vali Acc: 0.104 Test Loss: 3.915 Test Acc: 0.104
Validation loss decreased (-0.102316 --> -0.103490).  Saving model ...
Epoch: 10 cost time: 4.054894924163818
Epoch: 10, Steps: 10 | Train Loss: 0.267 Vali Loss: 4.131 Vali Acc: 0.112 Test Loss: 4.131 Test Acc: 0.112
Validation loss decreased (-0.103490 --> -0.111723).  Saving model ...
Epoch: 11 cost time: 4.1975417137146
Epoch: 11, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.330 Vali Acc: 0.118 Test Loss: 4.330 Test Acc: 0.118
Validation loss decreased (-0.111723 --> -0.117604).  Saving model ...
Epoch: 12 cost time: 4.335275411605835
Epoch: 12, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.526 Vali Acc: 0.119 Test Loss: 4.526 Test Acc: 0.119
Validation loss decreased (-0.117604 --> -0.118778).  Saving model ...
Epoch: 13 cost time: 4.132860422134399
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.730 Vali Acc: 0.118 Test Loss: 4.730 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8842122554779053
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.778 Vali Acc: 0.126 Test Loss: 4.778 Test Acc: 0.126
Validation loss decreased (-0.118778 --> -0.125835).  Saving model ...
Epoch: 15 cost time: 3.808488368988037
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.841 Vali Acc: 0.120 Test Loss: 4.841 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.718341827392578
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.905 Vali Acc: 0.120 Test Loss: 4.905 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.658934593200684
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.965 Vali Acc: 0.118 Test Loss: 4.965 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.561378717422485
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.014 Vali Acc: 0.121 Test Loss: 5.014 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.376589298248291
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.069 Vali Acc: 0.122 Test Loss: 5.069 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.378798007965088
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.114 Vali Acc: 0.126 Test Loss: 5.114 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.10376763343811
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.147 Vali Acc: 0.126 Test Loss: 5.147 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.102298021316528
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.163 Vali Acc: 0.122 Test Loss: 5.163 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.259294748306274
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.190 Vali Acc: 0.121 Test Loss: 5.190 Test Acc: 0.121
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.081113338470459
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.217 Vali Acc: 0.122 Test Loss: 5.217 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12588235294117647
model parameter : 1266970
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.259004592895508
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.337 Vali Acc: 0.026 Test Loss: 3.337 Test Acc: 0.026
Validation loss decreased (inf --> -0.025849).  Saving model ...
Epoch: 2 cost time: 3.9474692344665527
Epoch: 2, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.441 Vali Acc: 0.035 Test Loss: 3.441 Test Acc: 0.035
Validation loss decreased (-0.025849 --> -0.035260).  Saving model ...
Epoch: 3 cost time: 4.430538654327393
Epoch: 3, Steps: 10 | Train Loss: 2.924 Vali Loss: 3.432 Vali Acc: 0.046 Test Loss: 3.432 Test Acc: 0.046
Validation loss decreased (-0.035260 --> -0.045848).  Saving model ...
Epoch: 4 cost time: 3.977651834487915
Epoch: 4, Steps: 10 | Train Loss: 2.599 Vali Loss: 3.391 Vali Acc: 0.067 Test Loss: 3.391 Test Acc: 0.067
Validation loss decreased (-0.045848 --> -0.067025).  Saving model ...
Epoch: 5 cost time: 4.119124174118042
Epoch: 5, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.351 Vali Acc: 0.072 Test Loss: 3.351 Test Acc: 0.072
Validation loss decreased (-0.067025 --> -0.071731).  Saving model ...
Epoch: 6 cost time: 4.094007253646851
Epoch: 6, Steps: 10 | Train Loss: 1.927 Vali Loss: 3.430 Vali Acc: 0.078 Test Loss: 3.430 Test Acc: 0.078
Validation loss decreased (-0.071731 --> -0.077613).  Saving model ...
Epoch: 7 cost time: 3.8836350440979004
Epoch: 7, Steps: 10 | Train Loss: 1.564 Vali Loss: 3.554 Vali Acc: 0.081 Test Loss: 3.554 Test Acc: 0.081
Validation loss decreased (-0.077613 --> -0.081141).  Saving model ...
Epoch: 8 cost time: 3.7987375259399414
Epoch: 8, Steps: 10 | Train Loss: 1.178 Vali Loss: 3.631 Vali Acc: 0.098 Test Loss: 3.631 Test Acc: 0.098
Validation loss decreased (-0.081141 --> -0.097611).  Saving model ...
Epoch: 9 cost time: 3.6924617290496826
Epoch: 9, Steps: 10 | Train Loss: 0.881 Vali Loss: 3.868 Vali Acc: 0.086 Test Loss: 3.868 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7163891792297363
Epoch: 10, Steps: 10 | Train Loss: 0.575 Vali Loss: 4.061 Vali Acc: 0.102 Test Loss: 4.061 Test Acc: 0.102
Validation loss decreased (-0.097611 --> -0.102312).  Saving model ...
Epoch: 11 cost time: 3.30649471282959
Epoch: 11, Steps: 10 | Train Loss: 0.345 Vali Loss: 4.382 Vali Acc: 0.102 Test Loss: 4.382 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.780789375305176
Epoch: 12, Steps: 10 | Train Loss: 0.194 Vali Loss: 4.486 Vali Acc: 0.114 Test Loss: 4.486 Test Acc: 0.114
Validation loss decreased (-0.102312 --> -0.114073).  Saving model ...
Epoch: 13 cost time: 3.4941370487213135
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.834 Vali Acc: 0.125 Test Loss: 4.834 Test Acc: 0.125
Validation loss decreased (-0.114073 --> -0.124658).  Saving model ...
Epoch: 14 cost time: 3.773374080657959
Epoch: 14, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.955 Vali Acc: 0.121 Test Loss: 4.955 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4190545082092285
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.105 Vali Acc: 0.113 Test Loss: 5.105 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.4617531299591064
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 5.165 Vali Acc: 0.126 Test Loss: 5.165 Test Acc: 0.126
Validation loss decreased (-0.124658 --> -0.125831).  Saving model ...
Epoch: 17 cost time: 3.895787477493286
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.169 Vali Acc: 0.126 Test Loss: 5.169 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.13297438621521
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.237 Vali Acc: 0.126 Test Loss: 5.237 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.407921552658081
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.297 Vali Acc: 0.124 Test Loss: 5.297 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.8600685596466064
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.340 Vali Acc: 0.122 Test Loss: 5.340 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.9999732971191406
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.359 Vali Acc: 0.126 Test Loss: 5.359 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.6792919635772705
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.362 Vali Acc: 0.131 Test Loss: 5.362 Test Acc: 0.131
Validation loss decreased (-0.125831 --> -0.130535).  Saving model ...
Epoch: 23 cost time: 3.9994070529937744
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.396 Vali Acc: 0.134 Test Loss: 5.396 Test Acc: 0.134
Validation loss decreased (-0.130535 --> -0.134064).  Saving model ...
Epoch: 24 cost time: 4.349985122680664
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.425 Vali Acc: 0.131 Test Loss: 5.425 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.239034175872803
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.441 Vali Acc: 0.131 Test Loss: 5.441 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.86405348777771
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.464 Vali Acc: 0.129 Test Loss: 5.464 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.061089277267456
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.489 Vali Acc: 0.127 Test Loss: 5.489 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.149315118789673
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.522 Vali Acc: 0.127 Test Loss: 5.522 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.213485479354858
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.556 Vali Acc: 0.127 Test Loss: 5.556 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.263343811035156
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.594 Vali Acc: 0.131 Test Loss: 5.594 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.027872085571289
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.613 Vali Acc: 0.136 Test Loss: 5.613 Test Acc: 0.136
Validation loss decreased (-0.134064 --> -0.136414).  Saving model ...
Epoch: 32 cost time: 4.031286954879761
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.607 Vali Acc: 0.135 Test Loss: 5.607 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.447210311889648
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.606 Vali Acc: 0.135 Test Loss: 5.606 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.247243165969849
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.618 Vali Acc: 0.135 Test Loss: 5.618 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.237347602844238
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.637 Vali Acc: 0.133 Test Loss: 5.637 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 4.353668451309204
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.655 Vali Acc: 0.131 Test Loss: 5.655 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 4.173154592514038
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.678 Vali Acc: 0.129 Test Loss: 5.678 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.9431376457214355
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.691 Vali Acc: 0.131 Test Loss: 5.691 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.974233865737915
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.700 Vali Acc: 0.132 Test Loss: 5.700 Test Acc: 0.132
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 4.614148139953613
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.719 Vali Acc: 0.132 Test Loss: 5.719 Test Acc: 0.132
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 4.0747597217559814
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.728 Vali Acc: 0.134 Test Loss: 5.728 Test Acc: 0.134
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13647058823529412
model parameter : 1266970
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.487579584121704
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.337 Vali Acc: 0.027 Test Loss: 3.337 Test Acc: 0.027
Validation loss decreased (inf --> -0.027025).  Saving model ...
Epoch: 2 cost time: 4.584041118621826
Epoch: 2, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.434 Vali Acc: 0.039 Test Loss: 3.434 Test Acc: 0.039
Validation loss decreased (-0.027025 --> -0.038789).  Saving model ...
Epoch: 3 cost time: 4.210755109786987
Epoch: 3, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.440 Vali Acc: 0.041 Test Loss: 3.440 Test Acc: 0.041
Validation loss decreased (-0.038789 --> -0.041142).  Saving model ...
Epoch: 4 cost time: 3.8631348609924316
Epoch: 4, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.400 Vali Acc: 0.068 Test Loss: 3.400 Test Acc: 0.068
Validation loss decreased (-0.041142 --> -0.068201).  Saving model ...
Epoch: 5 cost time: 4.199533224105835
Epoch: 5, Steps: 10 | Train Loss: 2.502 Vali Loss: 3.345 Vali Acc: 0.066 Test Loss: 3.345 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9429688453674316
Epoch: 6, Steps: 10 | Train Loss: 2.237 Vali Loss: 3.401 Vali Acc: 0.073 Test Loss: 3.401 Test Acc: 0.073
Validation loss decreased (-0.068201 --> -0.072907).  Saving model ...
Epoch: 7 cost time: 4.076318025588989
Epoch: 7, Steps: 10 | Train Loss: 1.912 Vali Loss: 3.490 Vali Acc: 0.075 Test Loss: 3.490 Test Acc: 0.075
Validation loss decreased (-0.072907 --> -0.075259).  Saving model ...
Epoch: 8 cost time: 3.894340991973877
Epoch: 8, Steps: 10 | Train Loss: 1.555 Vali Loss: 3.522 Vali Acc: 0.080 Test Loss: 3.522 Test Acc: 0.080
Validation loss decreased (-0.075259 --> -0.079965).  Saving model ...
Epoch: 9 cost time: 3.9070186614990234
Epoch: 9, Steps: 10 | Train Loss: 1.230 Vali Loss: 3.717 Vali Acc: 0.094 Test Loss: 3.717 Test Acc: 0.094
Validation loss decreased (-0.079965 --> -0.094080).  Saving model ...
Epoch: 10 cost time: 4.1196911334991455
Epoch: 10, Steps: 10 | Train Loss: 0.879 Vali Loss: 3.839 Vali Acc: 0.098 Test Loss: 3.839 Test Acc: 0.098
Validation loss decreased (-0.094080 --> -0.097609).  Saving model ...
Epoch: 11 cost time: 3.902663469314575
Epoch: 11, Steps: 10 | Train Loss: 0.601 Vali Loss: 4.133 Vali Acc: 0.101 Test Loss: 4.133 Test Acc: 0.101
Validation loss decreased (-0.097609 --> -0.101135).  Saving model ...
Epoch: 12 cost time: 4.078891754150391
Epoch: 12, Steps: 10 | Train Loss: 0.369 Vali Loss: 4.248 Vali Acc: 0.116 Test Loss: 4.248 Test Acc: 0.116
Validation loss decreased (-0.101135 --> -0.116428).  Saving model ...
Epoch: 13 cost time: 4.05169415473938
Epoch: 13, Steps: 10 | Train Loss: 0.232 Vali Loss: 4.577 Vali Acc: 0.113 Test Loss: 4.577 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6482863426208496
Epoch: 14, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.619 Vali Acc: 0.122 Test Loss: 4.619 Test Acc: 0.122
Validation loss decreased (-0.116428 --> -0.122307).  Saving model ...
Epoch: 15 cost time: 4.114794969558716
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.723 Vali Acc: 0.124 Test Loss: 4.723 Test Acc: 0.124
Validation loss decreased (-0.122307 --> -0.123482).  Saving model ...
Epoch: 16 cost time: 3.883814811706543
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.843 Vali Acc: 0.128 Test Loss: 4.843 Test Acc: 0.128
Validation loss decreased (-0.123482 --> -0.128187).  Saving model ...
Epoch: 17 cost time: 3.401902437210083
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.967 Vali Acc: 0.133 Test Loss: 4.967 Test Acc: 0.133
Validation loss decreased (-0.128187 --> -0.132892).  Saving model ...
Epoch: 18 cost time: 4.0124146938323975
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.072 Vali Acc: 0.129 Test Loss: 5.072 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.685325860977173
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.134 Vali Acc: 0.129 Test Loss: 5.134 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.7550888061523438
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.168 Vali Acc: 0.128 Test Loss: 5.168 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.711805820465088
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.171 Vali Acc: 0.125 Test Loss: 5.171 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.275137186050415
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.191 Vali Acc: 0.125 Test Loss: 5.191 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.937962293624878
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.227 Vali Acc: 0.129 Test Loss: 5.227 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.338997840881348
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.242 Vali Acc: 0.133 Test Loss: 5.242 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.13491153717041
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.245 Vali Acc: 0.132 Test Loss: 5.245 Test Acc: 0.132
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.778308153152466
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.267 Vali Acc: 0.133 Test Loss: 5.267 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.388306379318237
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.311 Vali Acc: 0.134 Test Loss: 5.311 Test Acc: 0.134
Validation loss decreased (-0.132892 --> -0.134065).  Saving model ...
Epoch: 28 cost time: 3.9703385829925537
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.355 Vali Acc: 0.135 Test Loss: 5.355 Test Acc: 0.135
Validation loss decreased (-0.134065 --> -0.135241).  Saving model ...
Epoch: 29 cost time: 4.1048054695129395
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.395 Vali Acc: 0.131 Test Loss: 5.395 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.101222991943359
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.433 Vali Acc: 0.133 Test Loss: 5.433 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.055211305618286
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.449 Vali Acc: 0.131 Test Loss: 5.449 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.4645535945892334
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.447 Vali Acc: 0.135 Test Loss: 5.447 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.108720779418945
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.449 Vali Acc: 0.135 Test Loss: 5.449 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.7324976921081543
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.473 Vali Acc: 0.135 Test Loss: 5.473 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.9049630165100098
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.486 Vali Acc: 0.138 Test Loss: 5.486 Test Acc: 0.138
Validation loss decreased (-0.135241 --> -0.137592).  Saving model ...
Epoch: 36 cost time: 4.47643518447876
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.504 Vali Acc: 0.138 Test Loss: 5.504 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.991636276245117
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.520 Vali Acc: 0.138 Test Loss: 5.520 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.8423116207122803
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.533 Vali Acc: 0.135 Test Loss: 5.533 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.5942463874816895
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.542 Vali Acc: 0.136 Test Loss: 5.542 Test Acc: 0.136
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.9400711059570312
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.555 Vali Acc: 0.136 Test Loss: 5.555 Test Acc: 0.136
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.8565587997436523
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.569 Vali Acc: 0.136 Test Loss: 5.569 Test Acc: 0.136
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.6245462894439697
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.591 Vali Acc: 0.138 Test Loss: 5.591 Test Acc: 0.138
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 4.178824424743652
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.592 Vali Acc: 0.140 Test Loss: 5.592 Test Acc: 0.140
Validation loss decreased (-0.137592 --> -0.139944).  Saving model ...
Epoch: 44 cost time: 4.096594572067261
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.597 Vali Acc: 0.141 Test Loss: 5.597 Test Acc: 0.141
Validation loss decreased (-0.139944 --> -0.141121).  Saving model ...
Epoch: 45 cost time: 3.80338454246521
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.598 Vali Acc: 0.139 Test Loss: 5.598 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.7457962036132812
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.604 Vali Acc: 0.139 Test Loss: 5.604 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.8563027381896973
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.626 Vali Acc: 0.140 Test Loss: 5.626 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.985440969467163
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.660 Vali Acc: 0.141 Test Loss: 5.660 Test Acc: 0.141
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.800234317779541
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.681 Vali Acc: 0.141 Test Loss: 5.681 Test Acc: 0.141
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.691554069519043
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.692 Vali Acc: 0.141 Test Loss: 5.692 Test Acc: 0.141
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.815199851989746
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.701 Vali Acc: 0.141 Test Loss: 5.701 Test Acc: 0.141
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.8708693981170654
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.703 Vali Acc: 0.141 Test Loss: 5.703 Test Acc: 0.141
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.888275623321533
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.710 Vali Acc: 0.140 Test Loss: 5.710 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 4.039978742599487
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.725 Vali Acc: 0.140 Test Loss: 5.725 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1411764705882353
model parameter : 1266970
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.671194076538086
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.333 Vali Acc: 0.036 Test Loss: 3.333 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 4.024415731430054
Epoch: 2, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.414 Vali Acc: 0.047 Test Loss: 3.414 Test Acc: 0.047
Validation loss decreased (-0.036437 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 4.056707382202148
Epoch: 3, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.442 Vali Acc: 0.059 Test Loss: 3.442 Test Acc: 0.059
Validation loss decreased (-0.047025 --> -0.058789).  Saving model ...
Epoch: 4 cost time: 3.865731954574585
Epoch: 4, Steps: 10 | Train Loss: 2.922 Vali Loss: 3.424 Vali Acc: 0.066 Test Loss: 3.424 Test Acc: 0.066
Validation loss decreased (-0.058789 --> -0.065848).  Saving model ...
Epoch: 5 cost time: 3.9274039268493652
Epoch: 5, Steps: 10 | Train Loss: 2.647 Vali Loss: 3.346 Vali Acc: 0.078 Test Loss: 3.346 Test Acc: 0.078
Validation loss decreased (-0.065848 --> -0.077614).  Saving model ...
Epoch: 6 cost time: 3.871859312057495
Epoch: 6, Steps: 10 | Train Loss: 2.433 Vali Loss: 3.390 Vali Acc: 0.080 Test Loss: 3.390 Test Acc: 0.080
Validation loss decreased (-0.077614 --> -0.079966).  Saving model ...
Epoch: 7 cost time: 3.8009843826293945
Epoch: 7, Steps: 10 | Train Loss: 2.122 Vali Loss: 3.477 Vali Acc: 0.087 Test Loss: 3.477 Test Acc: 0.087
Validation loss decreased (-0.079966 --> -0.087024).  Saving model ...
Epoch: 8 cost time: 3.8663904666900635
Epoch: 8, Steps: 10 | Train Loss: 1.812 Vali Loss: 3.515 Vali Acc: 0.084 Test Loss: 3.515 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.756850242614746
Epoch: 9, Steps: 10 | Train Loss: 1.434 Vali Loss: 3.658 Vali Acc: 0.092 Test Loss: 3.658 Test Acc: 0.092
Validation loss decreased (-0.087024 --> -0.091728).  Saving model ...
Epoch: 10 cost time: 3.930528163909912
Epoch: 10, Steps: 10 | Train Loss: 1.124 Vali Loss: 3.783 Vali Acc: 0.109 Test Loss: 3.783 Test Acc: 0.109
Validation loss decreased (-0.091728 --> -0.109374).  Saving model ...
Epoch: 11 cost time: 4.1134185791015625
Epoch: 11, Steps: 10 | Train Loss: 0.757 Vali Loss: 4.057 Vali Acc: 0.118 Test Loss: 4.057 Test Acc: 0.118
Validation loss decreased (-0.109374 --> -0.117606).  Saving model ...
Epoch: 12 cost time: 4.1801605224609375
Epoch: 12, Steps: 10 | Train Loss: 0.511 Vali Loss: 4.134 Vali Acc: 0.132 Test Loss: 4.134 Test Acc: 0.132
Validation loss decreased (-0.117606 --> -0.131723).  Saving model ...
Epoch: 13 cost time: 3.8741614818573
Epoch: 13, Steps: 10 | Train Loss: 0.353 Vali Loss: 4.386 Vali Acc: 0.138 Test Loss: 4.386 Test Acc: 0.138
Validation loss decreased (-0.131723 --> -0.137603).  Saving model ...
Epoch: 14 cost time: 4.112079858779907
Epoch: 14, Steps: 10 | Train Loss: 0.233 Vali Loss: 4.550 Vali Acc: 0.131 Test Loss: 4.550 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.902392864227295
Epoch: 15, Steps: 10 | Train Loss: 0.116 Vali Loss: 4.648 Vali Acc: 0.135 Test Loss: 4.648 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.278418302536011
Epoch: 16, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.698 Vali Acc: 0.147 Test Loss: 4.698 Test Acc: 0.147
Validation loss decreased (-0.137603 --> -0.147012).  Saving model ...
Epoch: 17 cost time: 4.430089235305786
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.846 Vali Acc: 0.151 Test Loss: 4.846 Test Acc: 0.151
Validation loss decreased (-0.147012 --> -0.150540).  Saving model ...
Epoch: 18 cost time: 4.223196744918823
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.983 Vali Acc: 0.155 Test Loss: 4.983 Test Acc: 0.155
Validation loss decreased (-0.150540 --> -0.155244).  Saving model ...
Epoch: 19 cost time: 4.393645524978638
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.023 Vali Acc: 0.164 Test Loss: 5.023 Test Acc: 0.164
Validation loss decreased (-0.155244 --> -0.163479).  Saving model ...
Epoch: 20 cost time: 3.832160472869873
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.057 Vali Acc: 0.158 Test Loss: 5.057 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7697649002075195
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.077 Vali Acc: 0.159 Test Loss: 5.077 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.8353559970855713
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.115 Vali Acc: 0.160 Test Loss: 5.115 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.243596076965332
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.146 Vali Acc: 0.161 Test Loss: 5.146 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.300621271133423
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.145 Vali Acc: 0.164 Test Loss: 5.145 Test Acc: 0.164
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.7241692543029785
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.175 Vali Acc: 0.166 Test Loss: 5.175 Test Acc: 0.166
Validation loss decreased (-0.163479 --> -0.165831).  Saving model ...
Epoch: 26 cost time: 3.946645498275757
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.204 Vali Acc: 0.164 Test Loss: 5.204 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.0854432582855225
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.226 Vali Acc: 0.164 Test Loss: 5.226 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.203575611114502
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.269 Vali Acc: 0.168 Test Loss: 5.269 Test Acc: 0.168
Validation loss decreased (-0.165831 --> -0.168183).  Saving model ...
Epoch: 29 cost time: 4.407948970794678
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.290 Vali Acc: 0.169 Test Loss: 5.290 Test Acc: 0.169
Validation loss decreased (-0.168183 --> -0.169359).  Saving model ...
Epoch: 30 cost time: 4.189576864242554
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.311 Vali Acc: 0.164 Test Loss: 5.311 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.1908204555511475
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.341 Vali Acc: 0.166 Test Loss: 5.341 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.5053935050964355
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.360 Vali Acc: 0.164 Test Loss: 5.360 Test Acc: 0.164
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.094768524169922
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.376 Vali Acc: 0.164 Test Loss: 5.376 Test Acc: 0.164
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.642286539077759
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.388 Vali Acc: 0.161 Test Loss: 5.388 Test Acc: 0.161
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.088743448257446
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.399 Vali Acc: 0.160 Test Loss: 5.399 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.7577831745147705
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.417 Vali Acc: 0.164 Test Loss: 5.417 Test Acc: 0.164
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.7512478828430176
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.443 Vali Acc: 0.165 Test Loss: 5.443 Test Acc: 0.165
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.227963209152222
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.462 Vali Acc: 0.160 Test Loss: 5.462 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.290909290313721
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.460 Vali Acc: 0.164 Test Loss: 5.460 Test Acc: 0.164
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16941176470588235
model parameter : 1266970
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.447937250137329
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 3.8529117107391357
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 3 cost time: 4.682202577590942
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 4 cost time: 4.725433349609375
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 5 cost time: 4.207129240036011
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 6 cost time: 4.322556972503662
Epoch: 6, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 7 cost time: 3.881063222885132
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 8 cost time: 4.109049320220947
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 9 cost time: 4.057781457901001
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.034085 --> -0.037614).  Saving model ...
Epoch: 10 cost time: 4.087102651596069
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 11 cost time: 4.061110734939575
Epoch: 11, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 12 cost time: 4.356812953948975
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 13 cost time: 3.9309842586517334
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 14 cost time: 3.972179412841797
Epoch: 14, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 15 cost time: 4.100977420806885
Epoch: 15, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 16 cost time: 3.636164903640747
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 17 cost time: 3.7498788833618164
Epoch: 17, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 18 cost time: 3.7720558643341064
Epoch: 18, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 19 cost time: 3.7792649269104004
Epoch: 19, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 20 cost time: 4.245914936065674
Epoch: 20, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 21 cost time: 4.213125705718994
Epoch: 21, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 22 cost time: 3.9553463459014893
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 23 cost time: 4.064618349075317
Epoch: 23, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 24 cost time: 4.0947418212890625
Epoch: 24, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 25 cost time: 4.379985809326172
Epoch: 25, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 26 cost time: 3.773770809173584
Epoch: 26, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 27 cost time: 4.220762252807617
Epoch: 27, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 28 cost time: 3.6756772994995117
Epoch: 28, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 29 cost time: 4.1765007972717285
Epoch: 29, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 30 cost time: 3.961266040802002
Epoch: 30, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 31 cost time: 4.224938631057739
Epoch: 31, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 32 cost time: 3.981586217880249
Epoch: 32, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 33 cost time: 4.036938905715942
Epoch: 33, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.160778045654297
Epoch: 34, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 35 cost time: 3.9691731929779053
Epoch: 35, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 36 cost time: 3.6002895832061768
Epoch: 36, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 37 cost time: 4.272348165512085
Epoch: 37, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 38 cost time: 3.8746256828308105
Epoch: 38, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.69956111907959
Epoch: 39, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 40 cost time: 3.7042057514190674
Epoch: 40, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 41 cost time: 3.646934747695923
Epoch: 41, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.9983925819396973
Epoch: 42, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 43 cost time: 3.861147403717041
Epoch: 43, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 44 cost time: 4.028262615203857
Epoch: 44, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 45 cost time: 3.8296399116516113
Epoch: 45, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 4.086654424667358
Epoch: 46, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.8314878940582275
Epoch: 47, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.97908878326416
Epoch: 48, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.767453908920288
Epoch: 49, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 50 cost time: 3.40208101272583
Epoch: 50, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.452906608581543
Epoch: 51, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 52 cost time: 3.739759683609009
Epoch: 52, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.7283639907836914
Epoch: 53, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.5888259410858154
Epoch: 54, Steps: 10 | Train Loss: 3.239 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.663090944290161
Epoch: 55, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.5786304473876953
Epoch: 56, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 4.029876708984375
Epoch: 57, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.9211692810058594
Epoch: 58, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.867396116256714
Epoch: 59, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 3.800786256790161
Epoch: 60, Steps: 10 | Train Loss: 3.236 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.9289698600769043
Epoch: 61, Steps: 10 | Train Loss: 3.236 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.03764705882352941
model parameter : 1266970
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.231889486312866
Epoch: 1, Steps: 10 | Train Loss: 3.358 Vali Loss: 3.294 Vali Acc: 0.055 Test Loss: 3.294 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 3.670635461807251
Epoch: 2, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.270 Vali Acc: 0.088 Test Loss: 3.270 Test Acc: 0.088
Validation loss decreased (-0.055261 --> -0.088203).  Saving model ...
Epoch: 3 cost time: 3.886782646179199
Epoch: 3, Steps: 10 | Train Loss: 2.722 Vali Loss: 3.233 Vali Acc: 0.132 Test Loss: 3.233 Test Acc: 0.132
Validation loss decreased (-0.088203 --> -0.131732).  Saving model ...
Epoch: 4 cost time: 4.042567014694214
Epoch: 4, Steps: 10 | Train Loss: 2.293 Vali Loss: 3.150 Vali Acc: 0.173 Test Loss: 3.150 Test Acc: 0.173
Validation loss decreased (-0.131732 --> -0.172910).  Saving model ...
Epoch: 5 cost time: 4.014479637145996
Epoch: 5, Steps: 10 | Train Loss: 1.881 Vali Loss: 3.075 Vali Acc: 0.208 Test Loss: 3.075 Test Acc: 0.208
Validation loss decreased (-0.172910 --> -0.208205).  Saving model ...
Epoch: 6 cost time: 3.9147274494171143
Epoch: 6, Steps: 10 | Train Loss: 1.420 Vali Loss: 3.113 Vali Acc: 0.234 Test Loss: 3.113 Test Acc: 0.234
Validation loss decreased (-0.208205 --> -0.234087).  Saving model ...
Epoch: 7 cost time: 3.6213736534118652
Epoch: 7, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.169 Vali Acc: 0.245 Test Loss: 3.169 Test Acc: 0.245
Validation loss decreased (-0.234087 --> -0.244674).  Saving model ...
Epoch: 8 cost time: 4.141792058944702
Epoch: 8, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.202 Vali Acc: 0.259 Test Loss: 3.202 Test Acc: 0.259
Validation loss decreased (-0.244674 --> -0.258792).  Saving model ...
Epoch: 9 cost time: 3.990330696105957
Epoch: 9, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.314 Vali Acc: 0.267 Test Loss: 3.314 Test Acc: 0.267
Validation loss decreased (-0.258792 --> -0.267026).  Saving model ...
Epoch: 10 cost time: 3.7437381744384766
Epoch: 10, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.437 Vali Acc: 0.275 Test Loss: 3.437 Test Acc: 0.275
Validation loss decreased (-0.267026 --> -0.275260).  Saving model ...
Epoch: 11 cost time: 3.876296043395996
Epoch: 11, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.520 Vali Acc: 0.276 Test Loss: 3.520 Test Acc: 0.276
Validation loss decreased (-0.275260 --> -0.276435).  Saving model ...
Epoch: 12 cost time: 4.168705701828003
Epoch: 12, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.609 Vali Acc: 0.278 Test Loss: 3.609 Test Acc: 0.278
Validation loss decreased (-0.276435 --> -0.277611).  Saving model ...
Epoch: 13 cost time: 3.971285343170166
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.660 Vali Acc: 0.299 Test Loss: 3.660 Test Acc: 0.299
Validation loss decreased (-0.277611 --> -0.298787).  Saving model ...
Epoch: 14 cost time: 3.871025800704956
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.761 Vali Acc: 0.293 Test Loss: 3.761 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7739925384521484
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.833 Vali Acc: 0.280 Test Loss: 3.833 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.236560344696045
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.833 Vali Acc: 0.288 Test Loss: 3.833 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8468234539031982
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.856 Vali Acc: 0.295 Test Loss: 3.856 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8972859382629395
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.884 Vali Acc: 0.293 Test Loss: 3.884 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6802239418029785
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.906 Vali Acc: 0.294 Test Loss: 3.906 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.8750884532928467
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.934 Vali Acc: 0.299 Test Loss: 3.934 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.6626269817352295
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.961 Vali Acc: 0.302 Test Loss: 3.961 Test Acc: 0.302
Validation loss decreased (-0.298787 --> -0.302313).  Saving model ...
Epoch: 22 cost time: 3.4436612129211426
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.986 Vali Acc: 0.300 Test Loss: 3.986 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.692669153213501
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.007 Vali Acc: 0.300 Test Loss: 4.007 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.6524646282196045
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.035 Vali Acc: 0.301 Test Loss: 4.035 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.963855028152466
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.039 Vali Acc: 0.300 Test Loss: 4.039 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.8409199714660645
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.061 Vali Acc: 0.306 Test Loss: 4.061 Test Acc: 0.306
Validation loss decreased (-0.302313 --> -0.305842).  Saving model ...
Epoch: 27 cost time: 3.94883394241333
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.079 Vali Acc: 0.301 Test Loss: 4.079 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.375495910644531
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.094 Vali Acc: 0.304 Test Loss: 4.094 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.9581403732299805
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.111 Vali Acc: 0.304 Test Loss: 4.111 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.8217215538024902
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.124 Vali Acc: 0.304 Test Loss: 4.124 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.6753990650177
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.138 Vali Acc: 0.304 Test Loss: 4.138 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.467571973800659
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.156 Vali Acc: 0.307 Test Loss: 4.156 Test Acc: 0.307
Validation loss decreased (-0.305842 --> -0.307017).  Saving model ...
Epoch: 33 cost time: 3.888612985610962
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.172 Vali Acc: 0.307 Test Loss: 4.172 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.8957746028900146
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.202 Vali Acc: 0.306 Test Loss: 4.202 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.146820545196533
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.212 Vali Acc: 0.306 Test Loss: 4.212 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.903402090072632
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.228 Vali Acc: 0.307 Test Loss: 4.228 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.004347324371338
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.242 Vali Acc: 0.308 Test Loss: 4.242 Test Acc: 0.308
Validation loss decreased (-0.307017 --> -0.308193).  Saving model ...
Epoch: 38 cost time: 3.741006374359131
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.253 Vali Acc: 0.309 Test Loss: 4.253 Test Acc: 0.309
Validation loss decreased (-0.308193 --> -0.309369).  Saving model ...
Epoch: 39 cost time: 4.07002329826355
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.263 Vali Acc: 0.309 Test Loss: 4.263 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.6432907581329346
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.274 Vali Acc: 0.309 Test Loss: 4.274 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 4.197512149810791
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.289 Vali Acc: 0.309 Test Loss: 4.289 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.6650335788726807
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.294 Vali Acc: 0.308 Test Loss: 4.294 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.9178197383880615
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.301 Vali Acc: 0.309 Test Loss: 4.301 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.7784500122070312
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.310 Vali Acc: 0.312 Test Loss: 4.310 Test Acc: 0.312
Validation loss decreased (-0.309369 --> -0.311722).  Saving model ...
Epoch: 45 cost time: 4.344746828079224
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.321 Vali Acc: 0.312 Test Loss: 4.321 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 4.205976963043213
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.331 Vali Acc: 0.313 Test Loss: 4.331 Test Acc: 0.313
Validation loss decreased (-0.311722 --> -0.312898).  Saving model ...
Epoch: 47 cost time: 4.039264917373657
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.342 Vali Acc: 0.313 Test Loss: 4.342 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.671456813812256
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.353 Vali Acc: 0.314 Test Loss: 4.353 Test Acc: 0.314
Validation loss decreased (-0.312898 --> -0.314074).  Saving model ...
Epoch: 49 cost time: 3.60101318359375
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.367 Vali Acc: 0.316 Test Loss: 4.367 Test Acc: 0.316
Validation loss decreased (-0.314074 --> -0.316427).  Saving model ...
Epoch: 50 cost time: 3.952054500579834
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.379 Vali Acc: 0.315 Test Loss: 4.379 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.8840293884277344
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.391 Vali Acc: 0.313 Test Loss: 4.391 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 4.0918967723846436
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.397 Vali Acc: 0.311 Test Loss: 4.397 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.7042293548583984
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.405 Vali Acc: 0.313 Test Loss: 4.405 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.793745756149292
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.414 Vali Acc: 0.313 Test Loss: 4.414 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.810183525085449
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.427 Vali Acc: 0.313 Test Loss: 4.427 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.5158255100250244
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.435 Vali Acc: 0.314 Test Loss: 4.435 Test Acc: 0.314
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 4.110450744628906
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.443 Vali Acc: 0.313 Test Loss: 4.443 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.816063642501831
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.449 Vali Acc: 0.313 Test Loss: 4.449 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.710073232650757
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.459 Vali Acc: 0.313 Test Loss: 4.459 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 1206938
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.2256011962890625
Epoch: 1, Steps: 10 | Train Loss: 3.337 Vali Loss: 3.284 Vali Acc: 0.064 Test Loss: 3.284 Test Acc: 0.064
Validation loss decreased (inf --> -0.063497).  Saving model ...
Epoch: 2 cost time: 4.037771940231323
Epoch: 2, Steps: 10 | Train Loss: 3.110 Vali Loss: 3.268 Vali Acc: 0.081 Test Loss: 3.268 Test Acc: 0.081
Validation loss decreased (-0.063497 --> -0.081144).  Saving model ...
Epoch: 3 cost time: 3.8895821571350098
Epoch: 3, Steps: 10 | Train Loss: 2.709 Vali Loss: 3.233 Vali Acc: 0.129 Test Loss: 3.233 Test Acc: 0.129
Validation loss decreased (-0.081144 --> -0.129379).  Saving model ...
Epoch: 4 cost time: 3.693303346633911
Epoch: 4, Steps: 10 | Train Loss: 2.280 Vali Loss: 3.149 Vali Acc: 0.178 Test Loss: 3.149 Test Acc: 0.178
Validation loss decreased (-0.129379 --> -0.177616).  Saving model ...
Epoch: 5 cost time: 4.213934421539307
Epoch: 5, Steps: 10 | Train Loss: 1.872 Vali Loss: 3.076 Vali Acc: 0.206 Test Loss: 3.076 Test Acc: 0.206
Validation loss decreased (-0.177616 --> -0.205852).  Saving model ...
Epoch: 6 cost time: 3.7683145999908447
Epoch: 6, Steps: 10 | Train Loss: 1.438 Vali Loss: 3.116 Vali Acc: 0.234 Test Loss: 3.116 Test Acc: 0.234
Validation loss decreased (-0.205852 --> -0.234086).  Saving model ...
Epoch: 7 cost time: 3.6789751052856445
Epoch: 7, Steps: 10 | Train Loss: 1.042 Vali Loss: 3.168 Vali Acc: 0.246 Test Loss: 3.168 Test Acc: 0.246
Validation loss decreased (-0.234086 --> -0.245851).  Saving model ...
Epoch: 8 cost time: 3.8934810161590576
Epoch: 8, Steps: 10 | Train Loss: 0.742 Vali Loss: 3.210 Vali Acc: 0.255 Test Loss: 3.210 Test Acc: 0.255
Validation loss decreased (-0.245851 --> -0.255262).  Saving model ...
Epoch: 9 cost time: 4.423861026763916
Epoch: 9, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.306 Vali Acc: 0.287 Test Loss: 3.306 Test Acc: 0.287
Validation loss decreased (-0.255262 --> -0.287026).  Saving model ...
Epoch: 10 cost time: 4.049382209777832
Epoch: 10, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.420 Vali Acc: 0.296 Test Loss: 3.420 Test Acc: 0.296
Validation loss decreased (-0.287026 --> -0.296436).  Saving model ...
Epoch: 11 cost time: 3.9657604694366455
Epoch: 11, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.558 Vali Acc: 0.299 Test Loss: 3.558 Test Acc: 0.299
Validation loss decreased (-0.296436 --> -0.298788).  Saving model ...
Epoch: 12 cost time: 4.494724988937378
Epoch: 12, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.631 Vali Acc: 0.315 Test Loss: 3.631 Test Acc: 0.315
Validation loss decreased (-0.298788 --> -0.315258).  Saving model ...
Epoch: 13 cost time: 4.10622501373291
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.691 Vali Acc: 0.321 Test Loss: 3.691 Test Acc: 0.321
Validation loss decreased (-0.315258 --> -0.321140).  Saving model ...
Epoch: 14 cost time: 4.179264307022095
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.814 Vali Acc: 0.315 Test Loss: 3.814 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.775171995162964
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.858 Vali Acc: 0.320 Test Loss: 3.858 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.696345090866089
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.870 Vali Acc: 0.319 Test Loss: 3.870 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5833640098571777
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.890 Vali Acc: 0.333 Test Loss: 3.890 Test Acc: 0.333
Validation loss decreased (-0.321140 --> -0.332902).  Saving model ...
Epoch: 18 cost time: 3.893486738204956
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.919 Vali Acc: 0.333 Test Loss: 3.919 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.646941661834717
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.944 Vali Acc: 0.327 Test Loss: 3.944 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.232524633407593
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.980 Vali Acc: 0.324 Test Loss: 3.980 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.9143548011779785
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.017 Vali Acc: 0.326 Test Loss: 4.017 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4658172130584717
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.043 Vali Acc: 0.328 Test Loss: 4.043 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.088605165481567
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.065 Vali Acc: 0.333 Test Loss: 4.065 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.799895763397217
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.092 Vali Acc: 0.327 Test Loss: 4.092 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.9003806114196777
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.092 Vali Acc: 0.332 Test Loss: 4.092 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.8983397483825684
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.106 Vali Acc: 0.333 Test Loss: 4.106 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.903892755508423
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.128 Vali Acc: 0.329 Test Loss: 4.128 Test Acc: 0.329
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33294117647058824
model parameter : 1206938
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.618895769119263
Epoch: 1, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.294 Vali Acc: 0.061 Test Loss: 3.294 Test Acc: 0.061
Validation loss decreased (inf --> -0.061144).  Saving model ...
Epoch: 2 cost time: 3.761359214782715
Epoch: 2, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.276 Vali Acc: 0.067 Test Loss: 3.276 Test Acc: 0.067
Validation loss decreased (-0.061144 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 3.8082830905914307
Epoch: 3, Steps: 10 | Train Loss: 2.708 Vali Loss: 3.254 Vali Acc: 0.115 Test Loss: 3.254 Test Acc: 0.115
Validation loss decreased (-0.067026 --> -0.115262).  Saving model ...
Epoch: 4 cost time: 3.8142433166503906
Epoch: 4, Steps: 10 | Train Loss: 2.297 Vali Loss: 3.184 Vali Acc: 0.153 Test Loss: 3.184 Test Acc: 0.153
Validation loss decreased (-0.115262 --> -0.152909).  Saving model ...
Epoch: 5 cost time: 3.802666425704956
Epoch: 5, Steps: 10 | Train Loss: 1.937 Vali Loss: 3.124 Vali Acc: 0.198 Test Loss: 3.124 Test Acc: 0.198
Validation loss decreased (-0.152909 --> -0.197616).  Saving model ...
Epoch: 6 cost time: 3.831021785736084
Epoch: 6, Steps: 10 | Train Loss: 1.516 Vali Loss: 3.175 Vali Acc: 0.226 Test Loss: 3.175 Test Acc: 0.226
Validation loss decreased (-0.197616 --> -0.225851).  Saving model ...
Epoch: 7 cost time: 3.569139003753662
Epoch: 7, Steps: 10 | Train Loss: 1.176 Vali Loss: 3.216 Vali Acc: 0.248 Test Loss: 3.216 Test Acc: 0.248
Validation loss decreased (-0.225851 --> -0.248203).  Saving model ...
Epoch: 8 cost time: 3.625922679901123
Epoch: 8, Steps: 10 | Train Loss: 0.893 Vali Loss: 3.262 Vali Acc: 0.249 Test Loss: 3.262 Test Acc: 0.249
Validation loss decreased (-0.248203 --> -0.249379).  Saving model ...
Epoch: 9 cost time: 3.977614402770996
Epoch: 9, Steps: 10 | Train Loss: 0.566 Vali Loss: 3.342 Vali Acc: 0.265 Test Loss: 3.342 Test Acc: 0.265
Validation loss decreased (-0.249379 --> -0.264672).  Saving model ...
Epoch: 10 cost time: 4.186342716217041
Epoch: 10, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.443 Vali Acc: 0.272 Test Loss: 3.443 Test Acc: 0.272
Validation loss decreased (-0.264672 --> -0.271730).  Saving model ...
Epoch: 11 cost time: 3.8285140991210938
Epoch: 11, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.529 Vali Acc: 0.264 Test Loss: 3.529 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.559814214706421
Epoch: 12, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.619 Vali Acc: 0.298 Test Loss: 3.619 Test Acc: 0.298
Validation loss decreased (-0.271730 --> -0.297611).  Saving model ...
Epoch: 13 cost time: 4.174637317657471
Epoch: 13, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.690 Vali Acc: 0.292 Test Loss: 3.690 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8638386726379395
Epoch: 14, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.845 Vali Acc: 0.288 Test Loss: 3.845 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8783137798309326
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.850 Vali Acc: 0.305 Test Loss: 3.850 Test Acc: 0.305
Validation loss decreased (-0.297611 --> -0.304667).  Saving model ...
Epoch: 16 cost time: 3.7591075897216797
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.928 Vali Acc: 0.304 Test Loss: 3.928 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7833058834075928
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.971 Vali Acc: 0.301 Test Loss: 3.971 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.639892578125
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.967 Vali Acc: 0.309 Test Loss: 3.967 Test Acc: 0.309
Validation loss decreased (-0.304667 --> -0.309372).  Saving model ...
Epoch: 19 cost time: 4.1621692180633545
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.993 Vali Acc: 0.312 Test Loss: 3.993 Test Acc: 0.312
Validation loss decreased (-0.309372 --> -0.311725).  Saving model ...
Epoch: 20 cost time: 3.8622727394104004
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.034 Vali Acc: 0.311 Test Loss: 4.034 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4125185012817383
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.075 Vali Acc: 0.309 Test Loss: 4.075 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.504298448562622
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.105 Vali Acc: 0.314 Test Loss: 4.105 Test Acc: 0.314
Validation loss decreased (-0.311725 --> -0.314077).  Saving model ...
Epoch: 23 cost time: 3.949842691421509
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.133 Vali Acc: 0.309 Test Loss: 4.133 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.8511786460876465
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.176 Vali Acc: 0.311 Test Loss: 4.176 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.8886165618896484
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.190 Vali Acc: 0.314 Test Loss: 4.190 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.6740639209747314
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.202 Vali Acc: 0.316 Test Loss: 4.202 Test Acc: 0.316
Validation loss decreased (-0.314077 --> -0.316429).  Saving model ...
Epoch: 27 cost time: 3.873695135116577
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.207 Vali Acc: 0.314 Test Loss: 4.207 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.8733198642730713
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.230 Vali Acc: 0.312 Test Loss: 4.230 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.8759353160858154
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.260 Vali Acc: 0.311 Test Loss: 4.260 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.5930771827697754
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.279 Vali Acc: 0.312 Test Loss: 4.279 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.558340549468994
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.293 Vali Acc: 0.312 Test Loss: 4.293 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.4217207431793213
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.318 Vali Acc: 0.312 Test Loss: 4.318 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.2882778644561768
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.334 Vali Acc: 0.315 Test Loss: 4.334 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.888684034347534
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.365 Vali Acc: 0.314 Test Loss: 4.365 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.182432413101196
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.377 Vali Acc: 0.316 Test Loss: 4.377 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.104299783706665
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.396 Vali Acc: 0.315 Test Loss: 4.396 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 1206938
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.121504545211792
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.307 Vali Acc: 0.054 Test Loss: 3.307 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 3.5664916038513184
Epoch: 2, Steps: 10 | Train Loss: 3.121 Vali Loss: 3.297 Vali Acc: 0.066 Test Loss: 3.297 Test Acc: 0.066
Validation loss decreased (-0.054085 --> -0.065849).  Saving model ...
Epoch: 3 cost time: 3.665074110031128
Epoch: 3, Steps: 10 | Train Loss: 2.732 Vali Loss: 3.294 Vali Acc: 0.104 Test Loss: 3.294 Test Acc: 0.104
Validation loss decreased (-0.065849 --> -0.103496).  Saving model ...
Epoch: 4 cost time: 3.458935260772705
Epoch: 4, Steps: 10 | Train Loss: 2.350 Vali Loss: 3.258 Vali Acc: 0.129 Test Loss: 3.258 Test Acc: 0.129
Validation loss decreased (-0.103496 --> -0.129379).  Saving model ...
Epoch: 5 cost time: 3.7962019443511963
Epoch: 5, Steps: 10 | Train Loss: 2.001 Vali Loss: 3.236 Vali Acc: 0.144 Test Loss: 3.236 Test Acc: 0.144
Validation loss decreased (-0.129379 --> -0.143497).  Saving model ...
Epoch: 6 cost time: 3.6505753993988037
Epoch: 6, Steps: 10 | Train Loss: 1.609 Vali Loss: 3.308 Vali Acc: 0.164 Test Loss: 3.308 Test Acc: 0.164
Validation loss decreased (-0.143497 --> -0.163496).  Saving model ...
Epoch: 7 cost time: 3.7306618690490723
Epoch: 7, Steps: 10 | Train Loss: 1.276 Vali Loss: 3.387 Vali Acc: 0.178 Test Loss: 3.387 Test Acc: 0.178
Validation loss decreased (-0.163496 --> -0.177613).  Saving model ...
Epoch: 8 cost time: 3.921983003616333
Epoch: 8, Steps: 10 | Train Loss: 0.993 Vali Loss: 3.458 Vali Acc: 0.182 Test Loss: 3.458 Test Acc: 0.182
Validation loss decreased (-0.177613 --> -0.182318).  Saving model ...
Epoch: 9 cost time: 4.102893829345703
Epoch: 9, Steps: 10 | Train Loss: 0.692 Vali Loss: 3.536 Vali Acc: 0.211 Test Loss: 3.536 Test Acc: 0.211
Validation loss decreased (-0.182318 --> -0.210553).  Saving model ...
Epoch: 10 cost time: 3.6190295219421387
Epoch: 10, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.651 Vali Acc: 0.213 Test Loss: 3.651 Test Acc: 0.213
Validation loss decreased (-0.210553 --> -0.212905).  Saving model ...
Epoch: 11 cost time: 4.305344581604004
Epoch: 11, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.764 Vali Acc: 0.227 Test Loss: 3.764 Test Acc: 0.227
Validation loss decreased (-0.212905 --> -0.227021).  Saving model ...
Epoch: 12 cost time: 3.9776132106781006
Epoch: 12, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.919 Vali Acc: 0.234 Test Loss: 3.919 Test Acc: 0.234
Validation loss decreased (-0.227021 --> -0.234078).  Saving model ...
Epoch: 13 cost time: 3.6553966999053955
Epoch: 13, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.972 Vali Acc: 0.241 Test Loss: 3.972 Test Acc: 0.241
Validation loss decreased (-0.234078 --> -0.241137).  Saving model ...
Epoch: 14 cost time: 3.984375
Epoch: 14, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.163 Vali Acc: 0.238 Test Loss: 4.163 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.981353521347046
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.243 Vali Acc: 0.244 Test Loss: 4.243 Test Acc: 0.244
Validation loss decreased (-0.241137 --> -0.243487).  Saving model ...
Epoch: 16 cost time: 3.860535144805908
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.235 Vali Acc: 0.251 Test Loss: 4.235 Test Acc: 0.251
Validation loss decreased (-0.243487 --> -0.250546).  Saving model ...
Epoch: 17 cost time: 3.597731113433838
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.325 Vali Acc: 0.246 Test Loss: 4.325 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8885791301727295
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.410 Vali Acc: 0.246 Test Loss: 4.410 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6046369075775146
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.444 Vali Acc: 0.248 Test Loss: 4.444 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.140146017074585
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.466 Vali Acc: 0.247 Test Loss: 4.466 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6088526248931885
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.492 Vali Acc: 0.249 Test Loss: 4.492 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.8883347511291504
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.544 Vali Acc: 0.249 Test Loss: 4.544 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.250189304351807
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.595 Vali Acc: 0.252 Test Loss: 4.595 Test Acc: 0.252
Validation loss decreased (-0.250546 --> -0.251719).  Saving model ...
Epoch: 24 cost time: 3.697028160095215
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.626 Vali Acc: 0.252 Test Loss: 4.626 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.086734771728516
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.629 Vali Acc: 0.255 Test Loss: 4.629 Test Acc: 0.255
Validation loss decreased (-0.251719 --> -0.255248).  Saving model ...
Epoch: 26 cost time: 3.7664952278137207
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.665 Vali Acc: 0.253 Test Loss: 4.665 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.8489677906036377
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.687 Vali Acc: 0.248 Test Loss: 4.687 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.6071665287017822
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.707 Vali Acc: 0.251 Test Loss: 4.707 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.413658857345581
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.749 Vali Acc: 0.252 Test Loss: 4.749 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.063286304473877
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.772 Vali Acc: 0.252 Test Loss: 4.772 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.7094295024871826
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.794 Vali Acc: 0.254 Test Loss: 4.794 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.2419092655181885
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.815 Vali Acc: 0.252 Test Loss: 4.815 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.357689619064331
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.835 Vali Acc: 0.253 Test Loss: 4.835 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.117267847061157
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.876 Vali Acc: 0.255 Test Loss: 4.876 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.069278001785278
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.882 Vali Acc: 0.255 Test Loss: 4.882 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 1206938
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.452183485031128
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.284 Vali Acc: 0.056 Test Loss: 3.284 Test Acc: 0.056
Validation loss decreased (inf --> -0.056438).  Saving model ...
Epoch: 2 cost time: 3.359156608581543
Epoch: 2, Steps: 10 | Train Loss: 3.192 Vali Loss: 3.310 Vali Acc: 0.052 Test Loss: 3.310 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4066171646118164
Epoch: 3, Steps: 10 | Train Loss: 2.868 Vali Loss: 3.341 Vali Acc: 0.060 Test Loss: 3.341 Test Acc: 0.060
Validation loss decreased (-0.056438 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 3.5182301998138428
Epoch: 4, Steps: 10 | Train Loss: 2.525 Vali Loss: 3.320 Vali Acc: 0.084 Test Loss: 3.320 Test Acc: 0.084
Validation loss decreased (-0.059967 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 3.480794906616211
Epoch: 5, Steps: 10 | Train Loss: 2.183 Vali Loss: 3.294 Vali Acc: 0.094 Test Loss: 3.294 Test Acc: 0.094
Validation loss decreased (-0.083496 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 3.7298190593719482
Epoch: 6, Steps: 10 | Train Loss: 1.787 Vali Loss: 3.356 Vali Acc: 0.109 Test Loss: 3.356 Test Acc: 0.109
Validation loss decreased (-0.094085 --> -0.109378).  Saving model ...
Epoch: 7 cost time: 3.2452046871185303
Epoch: 7, Steps: 10 | Train Loss: 1.388 Vali Loss: 3.450 Vali Acc: 0.108 Test Loss: 3.450 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9114186763763428
Epoch: 8, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.552 Vali Acc: 0.119 Test Loss: 3.552 Test Acc: 0.119
Validation loss decreased (-0.109378 --> -0.118788).  Saving model ...
Epoch: 9 cost time: 3.568615436553955
Epoch: 9, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.691 Vali Acc: 0.125 Test Loss: 3.691 Test Acc: 0.125
Validation loss decreased (-0.118788 --> -0.124669).  Saving model ...
Epoch: 10 cost time: 3.142214775085449
Epoch: 10, Steps: 10 | Train Loss: 0.471 Vali Loss: 3.844 Vali Acc: 0.120 Test Loss: 3.844 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3793718814849854
Epoch: 11, Steps: 10 | Train Loss: 0.301 Vali Loss: 4.035 Vali Acc: 0.132 Test Loss: 4.035 Test Acc: 0.132
Validation loss decreased (-0.124669 --> -0.131724).  Saving model ...
Epoch: 12 cost time: 3.7783520221710205
Epoch: 12, Steps: 10 | Train Loss: 0.185 Vali Loss: 4.246 Vali Acc: 0.126 Test Loss: 4.246 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7543280124664307
Epoch: 13, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.269 Vali Acc: 0.140 Test Loss: 4.269 Test Acc: 0.140
Validation loss decreased (-0.131724 --> -0.139957).  Saving model ...
Epoch: 14 cost time: 3.846076250076294
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.489 Vali Acc: 0.136 Test Loss: 4.489 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9582931995391846
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.586 Vali Acc: 0.144 Test Loss: 4.586 Test Acc: 0.144
Validation loss decreased (-0.139957 --> -0.143484).  Saving model ...
Epoch: 16 cost time: 4.216371774673462
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.630 Vali Acc: 0.144 Test Loss: 4.630 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7826080322265625
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.674 Vali Acc: 0.149 Test Loss: 4.674 Test Acc: 0.149
Validation loss decreased (-0.143484 --> -0.149365).  Saving model ...
Epoch: 18 cost time: 4.358145713806152
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.716 Vali Acc: 0.146 Test Loss: 4.716 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9237136840820312
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.743 Vali Acc: 0.149 Test Loss: 4.743 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.465664863586426
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.779 Vali Acc: 0.148 Test Loss: 4.779 Test Acc: 0.148
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.8410098552703857
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.820 Vali Acc: 0.152 Test Loss: 4.820 Test Acc: 0.152
Validation loss decreased (-0.149365 --> -0.151717).  Saving model ...
Epoch: 22 cost time: 3.632085084915161
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.855 Vali Acc: 0.155 Test Loss: 4.855 Test Acc: 0.155
Validation loss decreased (-0.151717 --> -0.155246).  Saving model ...
Epoch: 23 cost time: 4.108239412307739
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.890 Vali Acc: 0.154 Test Loss: 4.890 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.8973984718322754
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.931 Vali Acc: 0.156 Test Loss: 4.931 Test Acc: 0.156
Validation loss decreased (-0.155246 --> -0.156421).  Saving model ...
Epoch: 25 cost time: 3.6349165439605713
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.943 Vali Acc: 0.155 Test Loss: 4.943 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.234384298324585
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.958 Vali Acc: 0.160 Test Loss: 4.958 Test Acc: 0.160
Validation loss decreased (-0.156421 --> -0.159950).  Saving model ...
Epoch: 27 cost time: 3.2003538608551025
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.970 Vali Acc: 0.159 Test Loss: 4.970 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.6296117305755615
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.983 Vali Acc: 0.161 Test Loss: 4.983 Test Acc: 0.161
Validation loss decreased (-0.159950 --> -0.161127).  Saving model ...
Epoch: 29 cost time: 3.974261522293091
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.017 Vali Acc: 0.158 Test Loss: 5.017 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.047945261001587
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.041 Vali Acc: 0.159 Test Loss: 5.041 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.9874064922332764
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.065 Vali Acc: 0.160 Test Loss: 5.065 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.9805450439453125
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.084 Vali Acc: 0.160 Test Loss: 5.084 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.8649213314056396
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.099 Vali Acc: 0.161 Test Loss: 5.099 Test Acc: 0.161
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.274993181228638
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.139 Vali Acc: 0.160 Test Loss: 5.139 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.008001089096069
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.166 Vali Acc: 0.164 Test Loss: 5.166 Test Acc: 0.164
Validation loss decreased (-0.161127 --> -0.163478).  Saving model ...
Epoch: 36 cost time: 3.6566061973571777
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.188 Vali Acc: 0.166 Test Loss: 5.188 Test Acc: 0.166
Validation loss decreased (-0.163478 --> -0.165830).  Saving model ...
Epoch: 37 cost time: 3.6691040992736816
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.191 Vali Acc: 0.169 Test Loss: 5.191 Test Acc: 0.169
Validation loss decreased (-0.165830 --> -0.169360).  Saving model ...
Epoch: 38 cost time: 3.5971145629882812
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.193 Vali Acc: 0.166 Test Loss: 5.193 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.307644367218018
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.209 Vali Acc: 0.165 Test Loss: 5.209 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.9109718799591064
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.219 Vali Acc: 0.166 Test Loss: 5.219 Test Acc: 0.166
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 4.007526159286499
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.237 Vali Acc: 0.167 Test Loss: 5.237 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.990731954574585
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.249 Vali Acc: 0.165 Test Loss: 5.249 Test Acc: 0.165
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 4.208166122436523
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.260 Vali Acc: 0.162 Test Loss: 5.260 Test Acc: 0.162
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 4.3699562549591064
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.271 Vali Acc: 0.161 Test Loss: 5.271 Test Acc: 0.161
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.627017021179199
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.286 Vali Acc: 0.164 Test Loss: 5.286 Test Acc: 0.164
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.746289014816284
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.310 Vali Acc: 0.165 Test Loss: 5.310 Test Acc: 0.165
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.658843994140625
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.326 Vali Acc: 0.169 Test Loss: 5.326 Test Acc: 0.169
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16941176470588235
model parameter : 1206938
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.012197256088257
Epoch: 1, Steps: 10 | Train Loss: 3.332 Vali Loss: 3.312 Vali Acc: 0.041 Test Loss: 3.312 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 3.5248918533325195
Epoch: 2, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.316 Vali Acc: 0.044 Test Loss: 3.316 Test Acc: 0.044
Validation loss decreased (-0.041143 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 3.7904775142669678
Epoch: 3, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.355 Vali Acc: 0.055 Test Loss: 3.355 Test Acc: 0.055
Validation loss decreased (-0.043496 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 4.182496786117554
Epoch: 4, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.346 Vali Acc: 0.065 Test Loss: 3.346 Test Acc: 0.065
Validation loss decreased (-0.055261 --> -0.064672).  Saving model ...
Epoch: 5 cost time: 3.39451265335083
Epoch: 5, Steps: 10 | Train Loss: 2.466 Vali Loss: 3.311 Vali Acc: 0.072 Test Loss: 3.311 Test Acc: 0.072
Validation loss decreased (-0.064672 --> -0.071732).  Saving model ...
Epoch: 6 cost time: 3.3613948822021484
Epoch: 6, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.339 Vali Acc: 0.060 Test Loss: 3.339 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6696972846984863
Epoch: 7, Steps: 10 | Train Loss: 1.808 Vali Loss: 3.397 Vali Acc: 0.072 Test Loss: 3.397 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5978541374206543
Epoch: 8, Steps: 10 | Train Loss: 1.480 Vali Loss: 3.452 Vali Acc: 0.072 Test Loss: 3.452 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.864999771118164
Epoch: 9, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.537 Vali Acc: 0.084 Test Loss: 3.537 Test Acc: 0.084
Validation loss decreased (-0.071732 --> -0.083494).  Saving model ...
Epoch: 10 cost time: 3.855090379714966
Epoch: 10, Steps: 10 | Train Loss: 0.799 Vali Loss: 3.629 Vali Acc: 0.087 Test Loss: 3.629 Test Acc: 0.087
Validation loss decreased (-0.083494 --> -0.087023).  Saving model ...
Epoch: 11 cost time: 3.9032511711120605
Epoch: 11, Steps: 10 | Train Loss: 0.592 Vali Loss: 3.769 Vali Acc: 0.086 Test Loss: 3.769 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5638883113861084
Epoch: 12, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.937 Vali Acc: 0.094 Test Loss: 3.937 Test Acc: 0.094
Validation loss decreased (-0.087023 --> -0.094078).  Saving model ...
Epoch: 13 cost time: 3.8623666763305664
Epoch: 13, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.974 Vali Acc: 0.100 Test Loss: 3.974 Test Acc: 0.100
Validation loss decreased (-0.094078 --> -0.099960).  Saving model ...
Epoch: 14 cost time: 3.838620185852051
Epoch: 14, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.240 Vali Acc: 0.093 Test Loss: 4.240 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.843653678894043
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.335 Vali Acc: 0.100 Test Loss: 4.335 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.454143762588501
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.358 Vali Acc: 0.108 Test Loss: 4.358 Test Acc: 0.108
Validation loss decreased (-0.099960 --> -0.108192).  Saving model ...
Epoch: 17 cost time: 3.503565549850464
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.480 Vali Acc: 0.107 Test Loss: 4.480 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8744077682495117
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.542 Vali Acc: 0.099 Test Loss: 4.542 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3959767818450928
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.590 Vali Acc: 0.099 Test Loss: 4.590 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.776569128036499
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.615 Vali Acc: 0.100 Test Loss: 4.615 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.066700220108032
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.632 Vali Acc: 0.107 Test Loss: 4.632 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.144163131713867
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.657 Vali Acc: 0.113 Test Loss: 4.657 Test Acc: 0.113
Validation loss decreased (-0.108192 --> -0.112895).  Saving model ...
Epoch: 23 cost time: 3.6230108737945557
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.692 Vali Acc: 0.111 Test Loss: 4.692 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.6986923217773438
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.738 Vali Acc: 0.111 Test Loss: 4.738 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.7044858932495117
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.757 Vali Acc: 0.112 Test Loss: 4.757 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.5597877502441406
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.753 Vali Acc: 0.113 Test Loss: 4.753 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.717752695083618
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.753 Vali Acc: 0.114 Test Loss: 4.753 Test Acc: 0.114
Validation loss decreased (-0.112895 --> -0.114070).  Saving model ...
Epoch: 28 cost time: 3.8622939586639404
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.778 Vali Acc: 0.114 Test Loss: 4.778 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.938793897628784
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.813 Vali Acc: 0.113 Test Loss: 4.813 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.6116738319396973
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.848 Vali Acc: 0.118 Test Loss: 4.848 Test Acc: 0.118
Validation loss decreased (-0.114070 --> -0.117599).  Saving model ...
Epoch: 31 cost time: 3.753095865249634
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.870 Vali Acc: 0.114 Test Loss: 4.870 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.5726568698883057
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.884 Vali Acc: 0.116 Test Loss: 4.884 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.727623462677002
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.896 Vali Acc: 0.118 Test Loss: 4.896 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.620192050933838
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.931 Vali Acc: 0.115 Test Loss: 4.931 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.7610867023468018
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.941 Vali Acc: 0.116 Test Loss: 4.941 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 4.002195596694946
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.956 Vali Acc: 0.114 Test Loss: 4.956 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 4.23773980140686
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.966 Vali Acc: 0.114 Test Loss: 4.966 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.8562183380126953
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.978 Vali Acc: 0.114 Test Loss: 4.978 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.8414855003356934
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.998 Vali Acc: 0.118 Test Loss: 4.998 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.8652162551879883
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.011 Vali Acc: 0.120 Test Loss: 5.011 Test Acc: 0.120
Validation loss decreased (-0.117599 --> -0.119950).  Saving model ...
Epoch: 41 cost time: 4.3849804401397705
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.027 Vali Acc: 0.119 Test Loss: 5.027 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 4.189871788024902
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.036 Vali Acc: 0.121 Test Loss: 5.036 Test Acc: 0.121
Validation loss decreased (-0.119950 --> -0.121126).  Saving model ...
Epoch: 43 cost time: 4.47124171257019
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.049 Vali Acc: 0.120 Test Loss: 5.049 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.309453725814819
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.064 Vali Acc: 0.121 Test Loss: 5.064 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 4.0409181118011475
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.077 Vali Acc: 0.124 Test Loss: 5.077 Test Acc: 0.124
Validation loss decreased (-0.121126 --> -0.123479).  Saving model ...
Epoch: 46 cost time: 4.0281054973602295
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.091 Vali Acc: 0.125 Test Loss: 5.091 Test Acc: 0.125
Validation loss decreased (-0.123479 --> -0.124655).  Saving model ...
Epoch: 47 cost time: 3.8402099609375
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.099 Vali Acc: 0.120 Test Loss: 5.099 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.7532222270965576
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.109 Vali Acc: 0.118 Test Loss: 5.109 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.671755313873291
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.125 Vali Acc: 0.121 Test Loss: 5.125 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.8218579292297363
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.138 Vali Acc: 0.125 Test Loss: 5.138 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 4.289526462554932
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.150 Vali Acc: 0.121 Test Loss: 5.150 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 4.2414045333862305
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.157 Vali Acc: 0.120 Test Loss: 5.157 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.9951674938201904
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.159 Vali Acc: 0.122 Test Loss: 5.159 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 3.860102653503418
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.167 Vali Acc: 0.122 Test Loss: 5.167 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 3.8975210189819336
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.173 Vali Acc: 0.124 Test Loss: 5.173 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 3.673123359680176
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.177 Vali Acc: 0.124 Test Loss: 5.177 Test Acc: 0.124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12470588235294118
model parameter : 1206938
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.181922912597656
Epoch: 1, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.352 Vali Acc: 0.039 Test Loss: 3.352 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 3.6557633876800537
Epoch: 2, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.358 Vali Acc: 0.032 Test Loss: 3.358 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.294872999191284
Epoch: 3, Steps: 10 | Train Loss: 3.096 Vali Loss: 3.391 Vali Acc: 0.032 Test Loss: 3.391 Test Acc: 0.032
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.805706262588501
Epoch: 4, Steps: 10 | Train Loss: 2.908 Vali Loss: 3.398 Vali Acc: 0.038 Test Loss: 3.398 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.944976329803467
Epoch: 5, Steps: 10 | Train Loss: 2.690 Vali Loss: 3.364 Vali Acc: 0.059 Test Loss: 3.364 Test Acc: 0.059
Validation loss decreased (-0.038790 --> -0.058790).  Saving model ...
Epoch: 6 cost time: 3.8282806873321533
Epoch: 6, Steps: 10 | Train Loss: 2.473 Vali Loss: 3.366 Vali Acc: 0.060 Test Loss: 3.366 Test Acc: 0.060
Validation loss decreased (-0.058790 --> -0.059966).  Saving model ...
Epoch: 7 cost time: 3.80352783203125
Epoch: 7, Steps: 10 | Train Loss: 2.240 Vali Loss: 3.390 Vali Acc: 0.065 Test Loss: 3.390 Test Acc: 0.065
Validation loss decreased (-0.059966 --> -0.064672).  Saving model ...
Epoch: 8 cost time: 3.635850667953491
Epoch: 8, Steps: 10 | Train Loss: 1.959 Vali Loss: 3.405 Vali Acc: 0.074 Test Loss: 3.405 Test Acc: 0.074
Validation loss decreased (-0.064672 --> -0.074084).  Saving model ...
Epoch: 9 cost time: 3.714012622833252
Epoch: 9, Steps: 10 | Train Loss: 1.600 Vali Loss: 3.440 Vali Acc: 0.078 Test Loss: 3.440 Test Acc: 0.078
Validation loss decreased (-0.074084 --> -0.077613).  Saving model ...
Epoch: 10 cost time: 3.6328916549682617
Epoch: 10, Steps: 10 | Train Loss: 1.314 Vali Loss: 3.485 Vali Acc: 0.081 Test Loss: 3.485 Test Acc: 0.081
Validation loss decreased (-0.077613 --> -0.081142).  Saving model ...
Epoch: 11 cost time: 3.756920099258423
Epoch: 11, Steps: 10 | Train Loss: 1.036 Vali Loss: 3.561 Vali Acc: 0.086 Test Loss: 3.561 Test Acc: 0.086
Validation loss decreased (-0.081142 --> -0.085847).  Saving model ...
Epoch: 12 cost time: 3.838411808013916
Epoch: 12, Steps: 10 | Train Loss: 0.718 Vali Loss: 3.740 Vali Acc: 0.085 Test Loss: 3.740 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7754623889923096
Epoch: 13, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.780 Vali Acc: 0.098 Test Loss: 3.780 Test Acc: 0.098
Validation loss decreased (-0.085847 --> -0.097609).  Saving model ...
Epoch: 14 cost time: 3.401682138442993
Epoch: 14, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.997 Vali Acc: 0.099 Test Loss: 3.997 Test Acc: 0.099
Validation loss decreased (-0.097609 --> -0.098784).  Saving model ...
Epoch: 15 cost time: 3.6772708892822266
Epoch: 15, Steps: 10 | Train Loss: 0.185 Vali Loss: 4.168 Vali Acc: 0.096 Test Loss: 4.168 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4473910331726074
Epoch: 16, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.221 Vali Acc: 0.107 Test Loss: 4.221 Test Acc: 0.107
Validation loss decreased (-0.098784 --> -0.107017).  Saving model ...
Epoch: 17 cost time: 3.305717706680298
Epoch: 17, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.404 Vali Acc: 0.109 Test Loss: 4.404 Test Acc: 0.109
Validation loss decreased (-0.107017 --> -0.109368).  Saving model ...
Epoch: 18 cost time: 3.661036729812622
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.517 Vali Acc: 0.102 Test Loss: 4.517 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.155469179153442
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.547 Vali Acc: 0.112 Test Loss: 4.547 Test Acc: 0.112
Validation loss decreased (-0.109368 --> -0.111719).  Saving model ...
Epoch: 20 cost time: 4.1916823387146
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.564 Vali Acc: 0.108 Test Loss: 4.564 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8042287826538086
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.618 Vali Acc: 0.113 Test Loss: 4.618 Test Acc: 0.113
Validation loss decreased (-0.111719 --> -0.112895).  Saving model ...
Epoch: 22 cost time: 3.6270217895507812
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.677 Vali Acc: 0.109 Test Loss: 4.677 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9115560054779053
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.733 Vali Acc: 0.108 Test Loss: 4.733 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5172531604766846
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.784 Vali Acc: 0.118 Test Loss: 4.784 Test Acc: 0.118
Validation loss decreased (-0.112895 --> -0.117599).  Saving model ...
Epoch: 25 cost time: 3.683598041534424
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.776 Vali Acc: 0.118 Test Loss: 4.776 Test Acc: 0.118
Validation loss decreased (-0.117599 --> -0.117599).  Saving model ...
Epoch: 26 cost time: 3.8987505435943604
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.770 Vali Acc: 0.118 Test Loss: 4.770 Test Acc: 0.118
Validation loss decreased (-0.117599 --> -0.117599).  Saving model ...
Epoch: 27 cost time: 3.8133533000946045
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.769 Vali Acc: 0.118 Test Loss: 4.769 Test Acc: 0.118
Validation loss decreased (-0.117599 --> -0.117599).  Saving model ...
Epoch: 28 cost time: 3.6138315200805664
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.805 Vali Acc: 0.119 Test Loss: 4.805 Test Acc: 0.119
Validation loss decreased (-0.117599 --> -0.118775).  Saving model ...
Epoch: 29 cost time: 3.834005117416382
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.848 Vali Acc: 0.114 Test Loss: 4.848 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.022942304611206
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.872 Vali Acc: 0.113 Test Loss: 4.872 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.8301608562469482
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.892 Vali Acc: 0.114 Test Loss: 4.892 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.079608917236328
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.919 Vali Acc: 0.116 Test Loss: 4.919 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.017693996429443
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.934 Vali Acc: 0.114 Test Loss: 4.934 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.839827537536621
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.968 Vali Acc: 0.115 Test Loss: 4.968 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.1841249465942383
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.985 Vali Acc: 0.113 Test Loss: 4.985 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.9111649990081787
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.006 Vali Acc: 0.112 Test Loss: 5.006 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.06989312171936
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.004 Vali Acc: 0.112 Test Loss: 5.004 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.9443039894104004
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.998 Vali Acc: 0.113 Test Loss: 4.998 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1188235294117647
model parameter : 1206938
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.279972314834595
Epoch: 1, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.329 Vali Acc: 0.042 Test Loss: 3.329 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 3.6345224380493164
Epoch: 2, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.349 Vali Acc: 0.032 Test Loss: 3.349 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.58276629447937
Epoch: 3, Steps: 10 | Train Loss: 3.156 Vali Loss: 3.390 Vali Acc: 0.036 Test Loss: 3.390 Test Acc: 0.036
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4957313537597656
Epoch: 4, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.401 Vali Acc: 0.051 Test Loss: 3.401 Test Acc: 0.051
Validation loss decreased (-0.042320 --> -0.050554).  Saving model ...
Epoch: 5 cost time: 3.3805346488952637
Epoch: 5, Steps: 10 | Train Loss: 2.804 Vali Loss: 3.366 Vali Acc: 0.059 Test Loss: 3.366 Test Acc: 0.059
Validation loss decreased (-0.050554 --> -0.058790).  Saving model ...
Epoch: 6 cost time: 3.7057998180389404
Epoch: 6, Steps: 10 | Train Loss: 2.655 Vali Loss: 3.360 Vali Acc: 0.061 Test Loss: 3.360 Test Acc: 0.061
Validation loss decreased (-0.058790 --> -0.061143).  Saving model ...
Epoch: 7 cost time: 3.7100090980529785
Epoch: 7, Steps: 10 | Train Loss: 2.438 Vali Loss: 3.369 Vali Acc: 0.067 Test Loss: 3.369 Test Acc: 0.067
Validation loss decreased (-0.061143 --> -0.067025).  Saving model ...
Epoch: 8 cost time: 3.6178433895111084
Epoch: 8, Steps: 10 | Train Loss: 2.236 Vali Loss: 3.376 Vali Acc: 0.068 Test Loss: 3.376 Test Acc: 0.068
Validation loss decreased (-0.067025 --> -0.068202).  Saving model ...
Epoch: 9 cost time: 3.6618432998657227
Epoch: 9, Steps: 10 | Train Loss: 1.950 Vali Loss: 3.395 Vali Acc: 0.072 Test Loss: 3.395 Test Acc: 0.072
Validation loss decreased (-0.068202 --> -0.071731).  Saving model ...
Epoch: 10 cost time: 3.7092366218566895
Epoch: 10, Steps: 10 | Train Loss: 1.700 Vali Loss: 3.420 Vali Acc: 0.081 Test Loss: 3.420 Test Acc: 0.081
Validation loss decreased (-0.071731 --> -0.081142).  Saving model ...
Epoch: 11 cost time: 3.6213417053222656
Epoch: 11, Steps: 10 | Train Loss: 1.388 Vali Loss: 3.450 Vali Acc: 0.075 Test Loss: 3.450 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.651249647140503
Epoch: 12, Steps: 10 | Train Loss: 1.045 Vali Loss: 3.588 Vali Acc: 0.073 Test Loss: 3.588 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.626734972000122
Epoch: 13, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.622 Vali Acc: 0.084 Test Loss: 3.622 Test Acc: 0.084
Validation loss decreased (-0.081142 --> -0.083493).  Saving model ...
Epoch: 14 cost time: 3.5135462284088135
Epoch: 14, Steps: 10 | Train Loss: 0.532 Vali Loss: 3.812 Vali Acc: 0.091 Test Loss: 3.812 Test Acc: 0.091
Validation loss decreased (-0.083493 --> -0.090550).  Saving model ...
Epoch: 15 cost time: 3.9429399967193604
Epoch: 15, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.976 Vali Acc: 0.086 Test Loss: 3.976 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8565568923950195
Epoch: 16, Steps: 10 | Train Loss: 0.218 Vali Loss: 4.031 Vali Acc: 0.098 Test Loss: 4.031 Test Acc: 0.098
Validation loss decreased (-0.090550 --> -0.097607).  Saving model ...
Epoch: 17 cost time: 4.4019763469696045
Epoch: 17, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.196 Vali Acc: 0.098 Test Loss: 4.196 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.246519088745117
Epoch: 18, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.265 Vali Acc: 0.100 Test Loss: 4.265 Test Acc: 0.100
Validation loss decreased (-0.097607 --> -0.099957).  Saving model ...
Epoch: 19 cost time: 4.053568363189697
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.314 Vali Acc: 0.100 Test Loss: 4.314 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.327728271484375
Epoch: 20, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.391 Vali Acc: 0.102 Test Loss: 4.391 Test Acc: 0.102
Validation loss decreased (-0.099957 --> -0.102309).  Saving model ...
Epoch: 21 cost time: 3.831446647644043
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.459 Vali Acc: 0.111 Test Loss: 4.459 Test Acc: 0.111
Validation loss decreased (-0.102309 --> -0.110544).  Saving model ...
Epoch: 22 cost time: 3.917128324508667
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.509 Vali Acc: 0.116 Test Loss: 4.509 Test Acc: 0.116
Validation loss decreased (-0.110544 --> -0.116425).  Saving model ...
Epoch: 23 cost time: 3.9586217403411865
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.562 Vali Acc: 0.113 Test Loss: 4.562 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.32035231590271
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.599 Vali Acc: 0.112 Test Loss: 4.599 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.9898548126220703
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.575 Vali Acc: 0.107 Test Loss: 4.575 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.5466880798339844
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.592 Vali Acc: 0.114 Test Loss: 4.592 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.6704916954040527
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.595 Vali Acc: 0.112 Test Loss: 4.595 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.6741247177124023
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.635 Vali Acc: 0.104 Test Loss: 4.635 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.462404727935791
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.669 Vali Acc: 0.106 Test Loss: 4.669 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.7648119926452637
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.690 Vali Acc: 0.111 Test Loss: 4.690 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.6354851722717285
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.707 Vali Acc: 0.115 Test Loss: 4.707 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.7146291732788086
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.737 Vali Acc: 0.113 Test Loss: 4.737 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.11647058823529412
model parameter : 1206938
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.284708499908447
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.328 Vali Acc: 0.042 Test Loss: 3.328 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 4.0657219886779785
Epoch: 2, Steps: 10 | Train Loss: 3.277 Vali Loss: 3.332 Vali Acc: 0.039 Test Loss: 3.332 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.777902364730835
Epoch: 3, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.363 Vali Acc: 0.044 Test Loss: 3.363 Test Acc: 0.044
Validation loss decreased (-0.042320 --> -0.043496).  Saving model ...
Epoch: 4 cost time: 3.8265373706817627
Epoch: 4, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.377 Vali Acc: 0.047 Test Loss: 3.377 Test Acc: 0.047
Validation loss decreased (-0.043496 --> -0.047025).  Saving model ...
Epoch: 5 cost time: 3.92460036277771
Epoch: 5, Steps: 10 | Train Loss: 2.959 Vali Loss: 3.350 Vali Acc: 0.058 Test Loss: 3.350 Test Acc: 0.058
Validation loss decreased (-0.047025 --> -0.057614).  Saving model ...
Epoch: 6 cost time: 3.292043685913086
Epoch: 6, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.336 Vali Acc: 0.059 Test Loss: 3.336 Test Acc: 0.059
Validation loss decreased (-0.057614 --> -0.058790).  Saving model ...
Epoch: 7 cost time: 3.5290744304656982
Epoch: 7, Steps: 10 | Train Loss: 2.700 Vali Loss: 3.329 Vali Acc: 0.058 Test Loss: 3.329 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7052297592163086
Epoch: 8, Steps: 10 | Train Loss: 2.413 Vali Loss: 3.333 Vali Acc: 0.066 Test Loss: 3.333 Test Acc: 0.066
Validation loss decreased (-0.058790 --> -0.065849).  Saving model ...
Epoch: 9 cost time: 4.0685999393463135
Epoch: 9, Steps: 10 | Train Loss: 2.203 Vali Loss: 3.334 Vali Acc: 0.079 Test Loss: 3.334 Test Acc: 0.079
Validation loss decreased (-0.065849 --> -0.078790).  Saving model ...
Epoch: 10 cost time: 3.67557430267334
Epoch: 10, Steps: 10 | Train Loss: 1.991 Vali Loss: 3.342 Vali Acc: 0.095 Test Loss: 3.342 Test Acc: 0.095
Validation loss decreased (-0.078790 --> -0.095261).  Saving model ...
Epoch: 11 cost time: 3.918337345123291
Epoch: 11, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.357 Vali Acc: 0.093 Test Loss: 3.357 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8323540687561035
Epoch: 12, Steps: 10 | Train Loss: 1.457 Vali Loss: 3.474 Vali Acc: 0.082 Test Loss: 3.474 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.247355937957764
Epoch: 13, Steps: 10 | Train Loss: 1.111 Vali Loss: 3.484 Vali Acc: 0.094 Test Loss: 3.484 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.8405652046203613
Epoch: 14, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.616 Vali Acc: 0.098 Test Loss: 3.616 Test Acc: 0.098
Validation loss decreased (-0.095261 --> -0.097611).  Saving model ...
Epoch: 15 cost time: 4.017974376678467
Epoch: 15, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.744 Vali Acc: 0.098 Test Loss: 3.744 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4502005577087402
Epoch: 16, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.825 Vali Acc: 0.115 Test Loss: 3.825 Test Acc: 0.115
Validation loss decreased (-0.097611 --> -0.115256).  Saving model ...
Epoch: 17 cost time: 4.202775239944458
Epoch: 17, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.987 Vali Acc: 0.108 Test Loss: 3.987 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7569010257720947
Epoch: 18, Steps: 10 | Train Loss: 0.183 Vali Loss: 4.057 Vali Acc: 0.127 Test Loss: 4.057 Test Acc: 0.127
Validation loss decreased (-0.115256 --> -0.127018).  Saving model ...
Epoch: 19 cost time: 4.016308546066284
Epoch: 19, Steps: 10 | Train Loss: 0.114 Vali Loss: 4.155 Vali Acc: 0.132 Test Loss: 4.155 Test Acc: 0.132
Validation loss decreased (-0.127018 --> -0.131723).  Saving model ...
Epoch: 20 cost time: 3.955239772796631
Epoch: 20, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.281 Vali Acc: 0.125 Test Loss: 4.281 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.707609176635742
Epoch: 21, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.302 Vali Acc: 0.138 Test Loss: 4.302 Test Acc: 0.138
Validation loss decreased (-0.131723 --> -0.137604).  Saving model ...
Epoch: 22 cost time: 3.4825713634490967
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.360 Vali Acc: 0.144 Test Loss: 4.360 Test Acc: 0.144
Validation loss decreased (-0.137604 --> -0.143486).  Saving model ...
Epoch: 23 cost time: 3.7846593856811523
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.429 Vali Acc: 0.145 Test Loss: 4.429 Test Acc: 0.145
Validation loss decreased (-0.143486 --> -0.144662).  Saving model ...
Epoch: 24 cost time: 4.173893928527832
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.533 Vali Acc: 0.128 Test Loss: 4.533 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.204889297485352
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.529 Vali Acc: 0.128 Test Loss: 4.529 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.256798982620239
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.522 Vali Acc: 0.136 Test Loss: 4.522 Test Acc: 0.136
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.5042989253997803
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.536 Vali Acc: 0.138 Test Loss: 4.536 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.9165256023406982
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.607 Vali Acc: 0.134 Test Loss: 4.607 Test Acc: 0.134
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.26443076133728
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.651 Vali Acc: 0.145 Test Loss: 4.651 Test Acc: 0.145
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.3636016845703125
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.649 Vali Acc: 0.140 Test Loss: 4.649 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.9619617462158203
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.668 Vali Acc: 0.141 Test Loss: 4.668 Test Acc: 0.141
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.7075297832489014
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.677 Vali Acc: 0.140 Test Loss: 4.677 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.8358407020568848
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.698 Vali Acc: 0.142 Test Loss: 4.698 Test Acc: 0.142
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14470588235294118
model parameter : 1206938
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.519213676452637
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (inf --> -0.050556).  Saving model ...
Epoch: 2 cost time: 4.443111896514893
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8305323123931885
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.230022668838501
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.5265371799468994
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.534884214401245
Epoch: 6, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.758178949356079
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.080537557601929
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.9357194900512695
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.3552324771881104
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.8400967121124268
Epoch: 11, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.05058823529411765
model parameter : 1206938
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.361751079559326
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.286 Vali Acc: 0.052 Test Loss: 3.286 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 3.7972121238708496
Epoch: 2, Steps: 10 | Train Loss: 3.074 Vali Loss: 3.255 Vali Acc: 0.092 Test Loss: 3.255 Test Acc: 0.092
Validation loss decreased (-0.051732 --> -0.091732).  Saving model ...
Epoch: 3 cost time: 3.6731669902801514
Epoch: 3, Steps: 10 | Train Loss: 2.739 Vali Loss: 3.253 Vali Acc: 0.114 Test Loss: 3.253 Test Acc: 0.114
Validation loss decreased (-0.091732 --> -0.114085).  Saving model ...
Epoch: 4 cost time: 3.814404010772705
Epoch: 4, Steps: 10 | Train Loss: 2.336 Vali Loss: 3.180 Vali Acc: 0.159 Test Loss: 3.180 Test Acc: 0.159
Validation loss decreased (-0.114085 --> -0.158792).  Saving model ...
Epoch: 5 cost time: 3.5935440063476562
Epoch: 5, Steps: 10 | Train Loss: 1.907 Vali Loss: 3.115 Vali Acc: 0.196 Test Loss: 3.115 Test Acc: 0.196
Validation loss decreased (-0.158792 --> -0.196439).  Saving model ...
Epoch: 6 cost time: 3.61661958694458
Epoch: 6, Steps: 10 | Train Loss: 1.522 Vali Loss: 3.095 Vali Acc: 0.226 Test Loss: 3.095 Test Acc: 0.226
Validation loss decreased (-0.196439 --> -0.225851).  Saving model ...
Epoch: 7 cost time: 3.6344664096832275
Epoch: 7, Steps: 10 | Train Loss: 1.099 Vali Loss: 3.135 Vali Acc: 0.239 Test Loss: 3.135 Test Acc: 0.239
Validation loss decreased (-0.225851 --> -0.238792).  Saving model ...
Epoch: 8 cost time: 3.4327290058135986
Epoch: 8, Steps: 10 | Train Loss: 0.799 Vali Loss: 3.188 Vali Acc: 0.252 Test Loss: 3.188 Test Acc: 0.252
Validation loss decreased (-0.238792 --> -0.251733).  Saving model ...
Epoch: 9 cost time: 3.8315374851226807
Epoch: 9, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.287 Vali Acc: 0.254 Test Loss: 3.287 Test Acc: 0.254
Validation loss decreased (-0.251733 --> -0.254085).  Saving model ...
Epoch: 10 cost time: 4.001622200012207
Epoch: 10, Steps: 10 | Train Loss: 0.356 Vali Loss: 3.345 Vali Acc: 0.268 Test Loss: 3.345 Test Acc: 0.268
Validation loss decreased (-0.254085 --> -0.268202).  Saving model ...
Epoch: 11 cost time: 3.3680405616760254
Epoch: 11, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.465 Vali Acc: 0.280 Test Loss: 3.465 Test Acc: 0.280
Validation loss decreased (-0.268202 --> -0.279965).  Saving model ...
Epoch: 12 cost time: 3.2452194690704346
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.537 Vali Acc: 0.294 Test Loss: 3.537 Test Acc: 0.294
Validation loss decreased (-0.279965 --> -0.294082).  Saving model ...
Epoch: 13 cost time: 3.610703706741333
Epoch: 13, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.599 Vali Acc: 0.296 Test Loss: 3.599 Test Acc: 0.296
Validation loss decreased (-0.294082 --> -0.296435).  Saving model ...
Epoch: 14 cost time: 3.7954204082489014
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.679 Vali Acc: 0.299 Test Loss: 3.679 Test Acc: 0.299
Validation loss decreased (-0.296435 --> -0.298787).  Saving model ...
Epoch: 15 cost time: 3.695138454437256
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.735 Vali Acc: 0.305 Test Loss: 3.735 Test Acc: 0.305
Validation loss decreased (-0.298787 --> -0.304669).  Saving model ...
Epoch: 16 cost time: 4.357409715652466
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.775 Vali Acc: 0.309 Test Loss: 3.775 Test Acc: 0.309
Validation loss decreased (-0.304669 --> -0.309374).  Saving model ...
Epoch: 17 cost time: 3.906362295150757
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.818 Vali Acc: 0.311 Test Loss: 3.818 Test Acc: 0.311
Validation loss decreased (-0.309374 --> -0.310550).  Saving model ...
Epoch: 18 cost time: 3.823826313018799
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.857 Vali Acc: 0.305 Test Loss: 3.857 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7188782691955566
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.885 Vali Acc: 0.302 Test Loss: 3.885 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.7862515449523926
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.914 Vali Acc: 0.306 Test Loss: 3.914 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.058067560195923
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.936 Vali Acc: 0.308 Test Loss: 3.936 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.638392686843872
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.958 Vali Acc: 0.308 Test Loss: 3.958 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.7581307888031006
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.977 Vali Acc: 0.306 Test Loss: 3.977 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.33488655090332
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.004 Vali Acc: 0.305 Test Loss: 4.004 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.273933410644531
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.033 Vali Acc: 0.302 Test Loss: 4.033 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.7959892749786377
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.055 Vali Acc: 0.309 Test Loss: 4.055 Test Acc: 0.309
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.525355577468872
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.072 Vali Acc: 0.308 Test Loss: 4.072 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31058823529411766
model parameter : 813722
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.221824407577515
Epoch: 1, Steps: 10 | Train Loss: 3.411 Vali Loss: 3.296 Vali Acc: 0.053 Test Loss: 3.296 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 4.023620843887329
Epoch: 2, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.262 Vali Acc: 0.098 Test Loss: 3.262 Test Acc: 0.098
Validation loss decreased (-0.052908 --> -0.097614).  Saving model ...
Epoch: 3 cost time: 3.7823679447174072
Epoch: 3, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.265 Vali Acc: 0.111 Test Loss: 3.265 Test Acc: 0.111
Validation loss decreased (-0.097614 --> -0.110556).  Saving model ...
Epoch: 4 cost time: 3.6593892574310303
Epoch: 4, Steps: 10 | Train Loss: 2.365 Vali Loss: 3.193 Vali Acc: 0.167 Test Loss: 3.193 Test Acc: 0.167
Validation loss decreased (-0.110556 --> -0.167027).  Saving model ...
Epoch: 5 cost time: 3.9884207248687744
Epoch: 5, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.119 Vali Acc: 0.195 Test Loss: 3.119 Test Acc: 0.195
Validation loss decreased (-0.167027 --> -0.195263).  Saving model ...
Epoch: 6 cost time: 3.906183958053589
Epoch: 6, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.103 Vali Acc: 0.228 Test Loss: 3.103 Test Acc: 0.228
Validation loss decreased (-0.195263 --> -0.228204).  Saving model ...
Epoch: 7 cost time: 4.104719161987305
Epoch: 7, Steps: 10 | Train Loss: 1.126 Vali Loss: 3.145 Vali Acc: 0.236 Test Loss: 3.145 Test Acc: 0.236
Validation loss decreased (-0.228204 --> -0.236439).  Saving model ...
Epoch: 8 cost time: 3.877128839492798
Epoch: 8, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.172 Vali Acc: 0.266 Test Loss: 3.172 Test Acc: 0.266
Validation loss decreased (-0.236439 --> -0.265851).  Saving model ...
Epoch: 9 cost time: 3.5814456939697266
Epoch: 9, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.293 Vali Acc: 0.269 Test Loss: 3.293 Test Acc: 0.269
Validation loss decreased (-0.265851 --> -0.269379).  Saving model ...
Epoch: 10 cost time: 3.7958593368530273
Epoch: 10, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.367 Vali Acc: 0.289 Test Loss: 3.367 Test Acc: 0.289
Validation loss decreased (-0.269379 --> -0.289378).  Saving model ...
Epoch: 11 cost time: 3.9548144340515137
Epoch: 11, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.484 Vali Acc: 0.299 Test Loss: 3.484 Test Acc: 0.299
Validation loss decreased (-0.289378 --> -0.298789).  Saving model ...
Epoch: 12 cost time: 3.7655346393585205
Epoch: 12, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.591 Vali Acc: 0.309 Test Loss: 3.591 Test Acc: 0.309
Validation loss decreased (-0.298789 --> -0.309376).  Saving model ...
Epoch: 13 cost time: 3.970963478088379
Epoch: 13, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.649 Vali Acc: 0.315 Test Loss: 3.649 Test Acc: 0.315
Validation loss decreased (-0.309376 --> -0.315258).  Saving model ...
Epoch: 14 cost time: 4.235644817352295
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.713 Vali Acc: 0.320 Test Loss: 3.713 Test Acc: 0.320
Validation loss decreased (-0.315258 --> -0.319963).  Saving model ...
Epoch: 15 cost time: 3.6714179515838623
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.802 Vali Acc: 0.322 Test Loss: 3.802 Test Acc: 0.322
Validation loss decreased (-0.319963 --> -0.322315).  Saving model ...
Epoch: 16 cost time: 4.236898422241211
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.854 Vali Acc: 0.322 Test Loss: 3.854 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.2856738567352295
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.880 Vali Acc: 0.324 Test Loss: 3.880 Test Acc: 0.324
Validation loss decreased (-0.322315 --> -0.323491).  Saving model ...
Epoch: 18 cost time: 4.394516944885254
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.922 Vali Acc: 0.331 Test Loss: 3.922 Test Acc: 0.331
Validation loss decreased (-0.323491 --> -0.330549).  Saving model ...
Epoch: 19 cost time: 3.950099468231201
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.954 Vali Acc: 0.326 Test Loss: 3.954 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4710922241210938
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.987 Vali Acc: 0.326 Test Loss: 3.987 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.7051753997802734
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.008 Vali Acc: 0.326 Test Loss: 4.008 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.9150969982147217
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.034 Vali Acc: 0.326 Test Loss: 4.034 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.03650689125061
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.060 Vali Acc: 0.325 Test Loss: 4.060 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.499422788619995
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.085 Vali Acc: 0.326 Test Loss: 4.085 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.6485660076141357
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.105 Vali Acc: 0.328 Test Loss: 4.105 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.861942768096924
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.126 Vali Acc: 0.325 Test Loss: 4.126 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.7788753509521484
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.143 Vali Acc: 0.327 Test Loss: 4.143 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.780745029449463
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.168 Vali Acc: 0.321 Test Loss: 4.168 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3305882352941176
model parameter : 813722
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.838982343673706
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.283 Vali Acc: 0.055 Test Loss: 3.283 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 4.129469156265259
Epoch: 2, Steps: 10 | Train Loss: 3.077 Vali Loss: 3.241 Vali Acc: 0.104 Test Loss: 3.241 Test Acc: 0.104
Validation loss decreased (-0.055261 --> -0.103497).  Saving model ...
Epoch: 3 cost time: 3.980855703353882
Epoch: 3, Steps: 10 | Train Loss: 2.735 Vali Loss: 3.252 Vali Acc: 0.121 Test Loss: 3.252 Test Acc: 0.121
Validation loss decreased (-0.103497 --> -0.121144).  Saving model ...
Epoch: 4 cost time: 3.9528985023498535
Epoch: 4, Steps: 10 | Train Loss: 2.347 Vali Loss: 3.195 Vali Acc: 0.142 Test Loss: 3.195 Test Acc: 0.142
Validation loss decreased (-0.121144 --> -0.142321).  Saving model ...
Epoch: 5 cost time: 3.9321441650390625
Epoch: 5, Steps: 10 | Train Loss: 1.927 Vali Loss: 3.145 Vali Acc: 0.199 Test Loss: 3.145 Test Acc: 0.199
Validation loss decreased (-0.142321 --> -0.198792).  Saving model ...
Epoch: 6 cost time: 3.574284791946411
Epoch: 6, Steps: 10 | Train Loss: 1.622 Vali Loss: 3.139 Vali Acc: 0.236 Test Loss: 3.139 Test Acc: 0.236
Validation loss decreased (-0.198792 --> -0.236439).  Saving model ...
Epoch: 7 cost time: 3.7167301177978516
Epoch: 7, Steps: 10 | Train Loss: 1.215 Vali Loss: 3.192 Vali Acc: 0.231 Test Loss: 3.192 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.112633228302002
Epoch: 8, Steps: 10 | Train Loss: 0.942 Vali Loss: 3.213 Vali Acc: 0.272 Test Loss: 3.213 Test Acc: 0.272
Validation loss decreased (-0.236439 --> -0.271733).  Saving model ...
Epoch: 9 cost time: 3.6672143936157227
Epoch: 9, Steps: 10 | Train Loss: 0.697 Vali Loss: 3.312 Vali Acc: 0.274 Test Loss: 3.312 Test Acc: 0.274
Validation loss decreased (-0.271733 --> -0.274085).  Saving model ...
Epoch: 10 cost time: 3.7797367572784424
Epoch: 10, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.356 Vali Acc: 0.287 Test Loss: 3.356 Test Acc: 0.287
Validation loss decreased (-0.274085 --> -0.287025).  Saving model ...
Epoch: 11 cost time: 3.63344669342041
Epoch: 11, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.450 Vali Acc: 0.289 Test Loss: 3.450 Test Acc: 0.289
Validation loss decreased (-0.287025 --> -0.289377).  Saving model ...
Epoch: 12 cost time: 3.7503280639648438
Epoch: 12, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.568 Vali Acc: 0.299 Test Loss: 3.568 Test Acc: 0.299
Validation loss decreased (-0.289377 --> -0.298788).  Saving model ...
Epoch: 13 cost time: 4.253155469894409
Epoch: 13, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.631 Vali Acc: 0.321 Test Loss: 3.631 Test Acc: 0.321
Validation loss decreased (-0.298788 --> -0.321140).  Saving model ...
Epoch: 14 cost time: 4.4822282791137695
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.732 Vali Acc: 0.315 Test Loss: 3.732 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.152771472930908
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.786 Vali Acc: 0.309 Test Loss: 3.786 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.001352548599243
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.841 Vali Acc: 0.311 Test Loss: 3.841 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.625291585922241
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.897 Vali Acc: 0.308 Test Loss: 3.897 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.718853712081909
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.914 Vali Acc: 0.306 Test Loss: 3.914 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.9035837650299072
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.946 Vali Acc: 0.313 Test Loss: 3.946 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.036857604980469
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.994 Vali Acc: 0.315 Test Loss: 3.994 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.286913156509399
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.019 Vali Acc: 0.309 Test Loss: 4.019 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.258514881134033
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.051 Vali Acc: 0.318 Test Loss: 4.051 Test Acc: 0.318
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.348177909851074
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.075 Vali Acc: 0.319 Test Loss: 4.075 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 813722
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.043176174163818
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.282 Vali Acc: 0.054 Test Loss: 3.282 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 3.854625701904297
Epoch: 2, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.264 Vali Acc: 0.099 Test Loss: 3.264 Test Acc: 0.099
Validation loss decreased (-0.054085 --> -0.098791).  Saving model ...
Epoch: 3 cost time: 4.005753993988037
Epoch: 3, Steps: 10 | Train Loss: 2.743 Vali Loss: 3.293 Vali Acc: 0.121 Test Loss: 3.293 Test Acc: 0.121
Validation loss decreased (-0.098791 --> -0.121144).  Saving model ...
Epoch: 4 cost time: 3.716493606567383
Epoch: 4, Steps: 10 | Train Loss: 2.366 Vali Loss: 3.273 Vali Acc: 0.146 Test Loss: 3.273 Test Acc: 0.146
Validation loss decreased (-0.121144 --> -0.145850).  Saving model ...
Epoch: 5 cost time: 3.818389892578125
Epoch: 5, Steps: 10 | Train Loss: 1.986 Vali Loss: 3.265 Vali Acc: 0.156 Test Loss: 3.265 Test Acc: 0.156
Validation loss decreased (-0.145850 --> -0.156438).  Saving model ...
Epoch: 6 cost time: 4.061005592346191
Epoch: 6, Steps: 10 | Train Loss: 1.659 Vali Loss: 3.291 Vali Acc: 0.175 Test Loss: 3.291 Test Acc: 0.175
Validation loss decreased (-0.156438 --> -0.175261).  Saving model ...
Epoch: 7 cost time: 3.9184587001800537
Epoch: 7, Steps: 10 | Train Loss: 1.302 Vali Loss: 3.357 Vali Acc: 0.186 Test Loss: 3.357 Test Acc: 0.186
Validation loss decreased (-0.175261 --> -0.185849).  Saving model ...
Epoch: 8 cost time: 4.303414821624756
Epoch: 8, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.432 Vali Acc: 0.189 Test Loss: 3.432 Test Acc: 0.189
Validation loss decreased (-0.185849 --> -0.189377).  Saving model ...
Epoch: 9 cost time: 3.901064395904541
Epoch: 9, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.564 Vali Acc: 0.202 Test Loss: 3.564 Test Acc: 0.202
Validation loss decreased (-0.189377 --> -0.202317).  Saving model ...
Epoch: 10 cost time: 3.9930098056793213
Epoch: 10, Steps: 10 | Train Loss: 0.573 Vali Loss: 3.617 Vali Acc: 0.234 Test Loss: 3.617 Test Acc: 0.234
Validation loss decreased (-0.202317 --> -0.234081).  Saving model ...
Epoch: 11 cost time: 4.090773344039917
Epoch: 11, Steps: 10 | Train Loss: 0.402 Vali Loss: 3.742 Vali Acc: 0.208 Test Loss: 3.742 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.19501256942749
Epoch: 12, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.844 Vali Acc: 0.238 Test Loss: 3.844 Test Acc: 0.238
Validation loss decreased (-0.234081 --> -0.237609).  Saving model ...
Epoch: 13 cost time: 4.110229969024658
Epoch: 13, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.969 Vali Acc: 0.240 Test Loss: 3.969 Test Acc: 0.240
Validation loss decreased (-0.237609 --> -0.239960).  Saving model ...
Epoch: 14 cost time: 3.760275363922119
Epoch: 14, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.096 Vali Acc: 0.251 Test Loss: 4.096 Test Acc: 0.251
Validation loss decreased (-0.239960 --> -0.250547).  Saving model ...
Epoch: 15 cost time: 3.5151312351226807
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.176 Vali Acc: 0.246 Test Loss: 4.176 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8900227546691895
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.231 Vali Acc: 0.242 Test Loss: 4.231 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.720245361328125
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.334 Vali Acc: 0.244 Test Loss: 4.334 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.75612735748291
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.387 Vali Acc: 0.259 Test Loss: 4.387 Test Acc: 0.259
Validation loss decreased (-0.250547 --> -0.258780).  Saving model ...
Epoch: 19 cost time: 3.519500970840454
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.436 Vali Acc: 0.255 Test Loss: 4.436 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8295371532440186
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.484 Vali Acc: 0.255 Test Loss: 4.484 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.8283915519714355
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.508 Vali Acc: 0.255 Test Loss: 4.508 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.893566846847534
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.526 Vali Acc: 0.258 Test Loss: 4.526 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.254998683929443
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.546 Vali Acc: 0.261 Test Loss: 4.546 Test Acc: 0.261
Validation loss decreased (-0.258780 --> -0.261131).  Saving model ...
Epoch: 24 cost time: 3.631077289581299
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.589 Vali Acc: 0.258 Test Loss: 4.589 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.7829556465148926
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.639 Vali Acc: 0.264 Test Loss: 4.639 Test Acc: 0.264
Validation loss decreased (-0.261131 --> -0.263483).  Saving model ...
Epoch: 26 cost time: 4.05975866317749
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.675 Vali Acc: 0.258 Test Loss: 4.675 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.923327922821045
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.693 Vali Acc: 0.255 Test Loss: 4.693 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.3848485946655273
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.703 Vali Acc: 0.256 Test Loss: 4.703 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.938028335571289
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.720 Vali Acc: 0.259 Test Loss: 4.720 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.0674378871917725
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.739 Vali Acc: 0.261 Test Loss: 4.739 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.072766065597534
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.759 Vali Acc: 0.264 Test Loss: 4.759 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.087096929550171
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.779 Vali Acc: 0.262 Test Loss: 4.779 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.7177863121032715
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.791 Vali Acc: 0.261 Test Loss: 4.791 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.8621723651885986
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.819 Vali Acc: 0.264 Test Loss: 4.819 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.232862710952759
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.844 Vali Acc: 0.260 Test Loss: 4.844 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 813722
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.379843711853027
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.282 Vali Acc: 0.047 Test Loss: 3.282 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 3.499223470687866
Epoch: 2, Steps: 10 | Train Loss: 3.130 Vali Loss: 3.304 Vali Acc: 0.069 Test Loss: 3.304 Test Acc: 0.069
Validation loss decreased (-0.047026 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 3.857983112335205
Epoch: 3, Steps: 10 | Train Loss: 2.853 Vali Loss: 3.360 Vali Acc: 0.074 Test Loss: 3.360 Test Acc: 0.074
Validation loss decreased (-0.069379 --> -0.074084).  Saving model ...
Epoch: 4 cost time: 3.933539867401123
Epoch: 4, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.355 Vali Acc: 0.089 Test Loss: 3.355 Test Acc: 0.089
Validation loss decreased (-0.074084 --> -0.089378).  Saving model ...
Epoch: 5 cost time: 3.9581949710845947
Epoch: 5, Steps: 10 | Train Loss: 2.168 Vali Loss: 3.338 Vali Acc: 0.101 Test Loss: 3.338 Test Acc: 0.101
Validation loss decreased (-0.089378 --> -0.101143).  Saving model ...
Epoch: 6 cost time: 3.4437761306762695
Epoch: 6, Steps: 10 | Train Loss: 1.815 Vali Loss: 3.353 Vali Acc: 0.105 Test Loss: 3.353 Test Acc: 0.105
Validation loss decreased (-0.101143 --> -0.104672).  Saving model ...
Epoch: 7 cost time: 3.0949645042419434
Epoch: 7, Steps: 10 | Train Loss: 1.411 Vali Loss: 3.423 Vali Acc: 0.111 Test Loss: 3.423 Test Acc: 0.111
Validation loss decreased (-0.104672 --> -0.110554).  Saving model ...
Epoch: 8 cost time: 3.8078343868255615
Epoch: 8, Steps: 10 | Train Loss: 1.121 Vali Loss: 3.495 Vali Acc: 0.111 Test Loss: 3.495 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5936672687530518
Epoch: 9, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.674 Vali Acc: 0.119 Test Loss: 3.674 Test Acc: 0.119
Validation loss decreased (-0.110554 --> -0.118787).  Saving model ...
Epoch: 10 cost time: 3.5487008094787598
Epoch: 10, Steps: 10 | Train Loss: 0.568 Vali Loss: 3.803 Vali Acc: 0.115 Test Loss: 3.803 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4901788234710693
Epoch: 11, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.934 Vali Acc: 0.124 Test Loss: 3.934 Test Acc: 0.124
Validation loss decreased (-0.118787 --> -0.123490).  Saving model ...
Epoch: 12 cost time: 3.7295401096343994
Epoch: 12, Steps: 10 | Train Loss: 0.217 Vali Loss: 4.154 Vali Acc: 0.131 Test Loss: 4.154 Test Acc: 0.131
Validation loss decreased (-0.123490 --> -0.130547).  Saving model ...
Epoch: 13 cost time: 3.6001219749450684
Epoch: 13, Steps: 10 | Train Loss: 0.139 Vali Loss: 4.265 Vali Acc: 0.136 Test Loss: 4.265 Test Acc: 0.136
Validation loss decreased (-0.130547 --> -0.136428).  Saving model ...
Epoch: 14 cost time: 4.008415222167969
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.372 Vali Acc: 0.141 Test Loss: 4.372 Test Acc: 0.141
Validation loss decreased (-0.136428 --> -0.141133).  Saving model ...
Epoch: 15 cost time: 3.5475072860717773
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.506 Vali Acc: 0.145 Test Loss: 4.506 Test Acc: 0.145
Validation loss decreased (-0.141133 --> -0.144661).  Saving model ...
Epoch: 16 cost time: 3.488185167312622
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.586 Vali Acc: 0.151 Test Loss: 4.586 Test Acc: 0.151
Validation loss decreased (-0.144661 --> -0.150542).  Saving model ...
Epoch: 17 cost time: 3.617807626724243
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.629 Vali Acc: 0.148 Test Loss: 4.629 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.788726329803467
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.677 Vali Acc: 0.149 Test Loss: 4.677 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.742368221282959
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.722 Vali Acc: 0.154 Test Loss: 4.722 Test Acc: 0.154
Validation loss decreased (-0.150542 --> -0.154070).  Saving model ...
Epoch: 20 cost time: 3.9018943309783936
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.767 Vali Acc: 0.154 Test Loss: 4.767 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6433143615722656
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.786 Vali Acc: 0.155 Test Loss: 4.786 Test Acc: 0.155
Validation loss decreased (-0.154070 --> -0.155246).  Saving model ...
Epoch: 22 cost time: 3.834721565246582
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.817 Vali Acc: 0.158 Test Loss: 4.817 Test Acc: 0.158
Validation loss decreased (-0.155246 --> -0.157599).  Saving model ...
Epoch: 23 cost time: 4.425039052963257
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.853 Vali Acc: 0.161 Test Loss: 4.853 Test Acc: 0.161
Validation loss decreased (-0.157599 --> -0.161128).  Saving model ...
Epoch: 24 cost time: 3.882680892944336
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.881 Vali Acc: 0.161 Test Loss: 4.881 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.626011610031128
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.913 Vali Acc: 0.161 Test Loss: 4.913 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.6303515434265137
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.939 Vali Acc: 0.160 Test Loss: 4.939 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.0612194538116455
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.966 Vali Acc: 0.165 Test Loss: 4.966 Test Acc: 0.165
Validation loss decreased (-0.161128 --> -0.164656).  Saving model ...
Epoch: 28 cost time: 4.096693277359009
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.006 Vali Acc: 0.166 Test Loss: 5.006 Test Acc: 0.166
Validation loss decreased (-0.164656 --> -0.165832).  Saving model ...
Epoch: 29 cost time: 3.2145066261291504
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.024 Vali Acc: 0.160 Test Loss: 5.024 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.750903367996216
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.037 Vali Acc: 0.164 Test Loss: 5.037 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.8899147510528564
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.056 Vali Acc: 0.167 Test Loss: 5.056 Test Acc: 0.167
Validation loss decreased (-0.165832 --> -0.167008).  Saving model ...
Epoch: 32 cost time: 3.9189062118530273
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.077 Vali Acc: 0.166 Test Loss: 5.077 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.6253654956817627
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.091 Vali Acc: 0.165 Test Loss: 5.091 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.207073926925659
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.115 Vali Acc: 0.167 Test Loss: 5.115 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.976186990737915
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.139 Vali Acc: 0.171 Test Loss: 5.139 Test Acc: 0.171
Validation loss decreased (-0.167008 --> -0.170537).  Saving model ...
Epoch: 36 cost time: 3.65974760055542
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.156 Vali Acc: 0.169 Test Loss: 5.156 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.7378995418548584
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.175 Vali Acc: 0.167 Test Loss: 5.175 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.524707555770874
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.187 Vali Acc: 0.169 Test Loss: 5.187 Test Acc: 0.169
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.343914270401001
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.204 Vali Acc: 0.171 Test Loss: 5.204 Test Acc: 0.171
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.4014406204223633
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.220 Vali Acc: 0.171 Test Loss: 5.220 Test Acc: 0.171
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.1205146312713623
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.229 Vali Acc: 0.172 Test Loss: 5.229 Test Acc: 0.172
Validation loss decreased (-0.170537 --> -0.171712).  Saving model ...
Epoch: 42 cost time: 3.589271306991577
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.249 Vali Acc: 0.173 Test Loss: 5.249 Test Acc: 0.173
Validation loss decreased (-0.171712 --> -0.172889).  Saving model ...
Epoch: 43 cost time: 3.775543212890625
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.261 Vali Acc: 0.174 Test Loss: 5.261 Test Acc: 0.174
Validation loss decreased (-0.172889 --> -0.174065).  Saving model ...
Epoch: 44 cost time: 3.356588125228882
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.291 Vali Acc: 0.172 Test Loss: 5.291 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.3144278526306152
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.301 Vali Acc: 0.173 Test Loss: 5.301 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.9307596683502197
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.309 Vali Acc: 0.171 Test Loss: 5.309 Test Acc: 0.171
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.572068452835083
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.323 Vali Acc: 0.173 Test Loss: 5.323 Test Acc: 0.173
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.976933240890503
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.337 Vali Acc: 0.174 Test Loss: 5.337 Test Acc: 0.174
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.084589719772339
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.346 Vali Acc: 0.173 Test Loss: 5.346 Test Acc: 0.173
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 4.280940055847168
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.359 Vali Acc: 0.174 Test Loss: 5.359 Test Acc: 0.174
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 4.179816722869873
Epoch: 51, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.372 Vali Acc: 0.173 Test Loss: 5.372 Test Acc: 0.173
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.9276180267333984
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.389 Vali Acc: 0.171 Test Loss: 5.389 Test Acc: 0.171
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 4.280965089797974
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.399 Vali Acc: 0.172 Test Loss: 5.399 Test Acc: 0.172
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17411764705882352
model parameter : 813722
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.078964471817017
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.303 Vali Acc: 0.044 Test Loss: 3.303 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 3.5617282390594482
Epoch: 2, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.315 Vali Acc: 0.062 Test Loss: 3.315 Test Acc: 0.062
Validation loss decreased (-0.043496 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 3.755729913711548
Epoch: 3, Steps: 10 | Train Loss: 2.975 Vali Loss: 3.368 Vali Acc: 0.066 Test Loss: 3.368 Test Acc: 0.066
Validation loss decreased (-0.062320 --> -0.065849).  Saving model ...
Epoch: 4 cost time: 4.142333507537842
Epoch: 4, Steps: 10 | Train Loss: 2.778 Vali Loss: 3.376 Vali Acc: 0.068 Test Loss: 3.376 Test Acc: 0.068
Validation loss decreased (-0.065849 --> -0.068202).  Saving model ...
Epoch: 5 cost time: 3.4861295223236084
Epoch: 5, Steps: 10 | Train Loss: 2.443 Vali Loss: 3.364 Vali Acc: 0.068 Test Loss: 3.364 Test Acc: 0.068
Validation loss decreased (-0.068202 --> -0.068202).  Saving model ...
Epoch: 6 cost time: 4.143287420272827
Epoch: 6, Steps: 10 | Train Loss: 2.179 Vali Loss: 3.348 Vali Acc: 0.079 Test Loss: 3.348 Test Acc: 0.079
Validation loss decreased (-0.068202 --> -0.078790).  Saving model ...
Epoch: 7 cost time: 3.8851935863494873
Epoch: 7, Steps: 10 | Train Loss: 1.833 Vali Loss: 3.375 Vali Acc: 0.079 Test Loss: 3.375 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.869164228439331
Epoch: 8, Steps: 10 | Train Loss: 1.554 Vali Loss: 3.414 Vali Acc: 0.087 Test Loss: 3.414 Test Acc: 0.087
Validation loss decreased (-0.078790 --> -0.087025).  Saving model ...
Epoch: 9 cost time: 4.022983551025391
Epoch: 9, Steps: 10 | Train Loss: 1.212 Vali Loss: 3.519 Vali Acc: 0.086 Test Loss: 3.519 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9389264583587646
Epoch: 10, Steps: 10 | Train Loss: 0.937 Vali Loss: 3.600 Vali Acc: 0.087 Test Loss: 3.600 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8992128372192383
Epoch: 11, Steps: 10 | Train Loss: 0.660 Vali Loss: 3.710 Vali Acc: 0.092 Test Loss: 3.710 Test Acc: 0.092
Validation loss decreased (-0.087025 --> -0.091728).  Saving model ...
Epoch: 12 cost time: 3.502423048019409
Epoch: 12, Steps: 10 | Train Loss: 0.447 Vali Loss: 3.844 Vali Acc: 0.095 Test Loss: 3.844 Test Acc: 0.095
Validation loss decreased (-0.091728 --> -0.095256).  Saving model ...
Epoch: 13 cost time: 3.4765169620513916
Epoch: 13, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.979 Vali Acc: 0.101 Test Loss: 3.979 Test Acc: 0.101
Validation loss decreased (-0.095256 --> -0.101137).  Saving model ...
Epoch: 14 cost time: 4.225337743759155
Epoch: 14, Steps: 10 | Train Loss: 0.159 Vali Loss: 4.160 Vali Acc: 0.107 Test Loss: 4.160 Test Acc: 0.107
Validation loss decreased (-0.101137 --> -0.107017).  Saving model ...
Epoch: 15 cost time: 3.8642590045928955
Epoch: 15, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.297 Vali Acc: 0.107 Test Loss: 4.297 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7599990367889404
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.366 Vali Acc: 0.105 Test Loss: 4.366 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.661412239074707
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.471 Vali Acc: 0.109 Test Loss: 4.471 Test Acc: 0.109
Validation loss decreased (-0.107017 --> -0.109367).  Saving model ...
Epoch: 18 cost time: 3.4931693077087402
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.543 Vali Acc: 0.106 Test Loss: 4.543 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.301111936569214
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.574 Vali Acc: 0.106 Test Loss: 4.574 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.943753242492676
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.586 Vali Acc: 0.122 Test Loss: 4.586 Test Acc: 0.122
Validation loss decreased (-0.109367 --> -0.122307).  Saving model ...
Epoch: 21 cost time: 3.5550873279571533
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.599 Vali Acc: 0.116 Test Loss: 4.599 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.1503801345825195
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.624 Vali Acc: 0.115 Test Loss: 4.624 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.6896493434906006
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.647 Vali Acc: 0.114 Test Loss: 4.647 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.7362892627716064
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.677 Vali Acc: 0.120 Test Loss: 4.677 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.815258264541626
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.721 Vali Acc: 0.118 Test Loss: 4.721 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.814737319946289
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.744 Vali Acc: 0.120 Test Loss: 4.744 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.108458042144775
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.761 Vali Acc: 0.122 Test Loss: 4.761 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.137380599975586
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.795 Vali Acc: 0.126 Test Loss: 4.795 Test Acc: 0.126
Validation loss decreased (-0.122307 --> -0.125834).  Saving model ...
Epoch: 29 cost time: 3.399399995803833
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.804 Vali Acc: 0.127 Test Loss: 4.804 Test Acc: 0.127
Validation loss decreased (-0.125834 --> -0.127011).  Saving model ...
Epoch: 30 cost time: 3.1607022285461426
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.816 Vali Acc: 0.127 Test Loss: 4.816 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.792201042175293
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.836 Vali Acc: 0.128 Test Loss: 4.836 Test Acc: 0.128
Validation loss decreased (-0.127011 --> -0.128187).  Saving model ...
Epoch: 32 cost time: 4.209481477737427
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.853 Vali Acc: 0.128 Test Loss: 4.853 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.1234130859375
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.862 Vali Acc: 0.126 Test Loss: 4.862 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.6422741413116455
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.877 Vali Acc: 0.124 Test Loss: 4.877 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.084283113479614
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.902 Vali Acc: 0.129 Test Loss: 4.902 Test Acc: 0.129
Validation loss decreased (-0.128187 --> -0.129363).  Saving model ...
Epoch: 36 cost time: 3.772333860397339
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.918 Vali Acc: 0.129 Test Loss: 4.918 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.7641162872314453
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.937 Vali Acc: 0.131 Test Loss: 4.937 Test Acc: 0.131
Validation loss decreased (-0.129363 --> -0.130539).  Saving model ...
Epoch: 38 cost time: 3.443152904510498
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.948 Vali Acc: 0.129 Test Loss: 4.948 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.9545719623565674
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.962 Vali Acc: 0.132 Test Loss: 4.962 Test Acc: 0.132
Validation loss decreased (-0.130539 --> -0.131715).  Saving model ...
Epoch: 40 cost time: 4.126493692398071
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.985 Vali Acc: 0.134 Test Loss: 4.985 Test Acc: 0.134
Validation loss decreased (-0.131715 --> -0.134068).  Saving model ...
Epoch: 41 cost time: 3.746485710144043
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.999 Vali Acc: 0.132 Test Loss: 4.999 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 4.274769306182861
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.009 Vali Acc: 0.131 Test Loss: 5.009 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 4.106992244720459
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.012 Vali Acc: 0.132 Test Loss: 5.012 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 4.270671844482422
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.024 Vali Acc: 0.129 Test Loss: 5.024 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.506707191467285
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.032 Vali Acc: 0.129 Test Loss: 5.032 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 4.182824611663818
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.052 Vali Acc: 0.128 Test Loss: 5.052 Test Acc: 0.128
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 4.158926248550415
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.067 Vali Acc: 0.129 Test Loss: 5.067 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.51230788230896
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.083 Vali Acc: 0.129 Test Loss: 5.083 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.8685569763183594
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.096 Vali Acc: 0.131 Test Loss: 5.096 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.926398992538452
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.102 Vali Acc: 0.129 Test Loss: 5.102 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13411764705882354
model parameter : 813722
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.33079719543457
Epoch: 1, Steps: 10 | Train Loss: 3.390 Vali Loss: 3.317 Vali Acc: 0.036 Test Loss: 3.317 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 4.2259321212768555
Epoch: 2, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.329 Vali Acc: 0.059 Test Loss: 3.329 Test Acc: 0.059
Validation loss decreased (-0.036437 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 3.8241422176361084
Epoch: 3, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.377 Vali Acc: 0.054 Test Loss: 3.377 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8343734741210938
Epoch: 4, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.404 Vali Acc: 0.068 Test Loss: 3.404 Test Acc: 0.068
Validation loss decreased (-0.058790 --> -0.068201).  Saving model ...
Epoch: 5 cost time: 4.042986154556274
Epoch: 5, Steps: 10 | Train Loss: 2.722 Vali Loss: 3.396 Vali Acc: 0.069 Test Loss: 3.396 Test Acc: 0.069
Validation loss decreased (-0.068201 --> -0.069378).  Saving model ...
Epoch: 6 cost time: 4.126997470855713
Epoch: 6, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.365 Vali Acc: 0.081 Test Loss: 3.365 Test Acc: 0.081
Validation loss decreased (-0.069378 --> -0.081143).  Saving model ...
Epoch: 7 cost time: 3.7178499698638916
Epoch: 7, Steps: 10 | Train Loss: 2.225 Vali Loss: 3.364 Vali Acc: 0.081 Test Loss: 3.364 Test Acc: 0.081
Validation loss decreased (-0.081143 --> -0.081143).  Saving model ...
Epoch: 8 cost time: 3.602583885192871
Epoch: 8, Steps: 10 | Train Loss: 2.006 Vali Loss: 3.372 Vali Acc: 0.085 Test Loss: 3.372 Test Acc: 0.085
Validation loss decreased (-0.081143 --> -0.084672).  Saving model ...
Epoch: 9 cost time: 4.380011558532715
Epoch: 9, Steps: 10 | Train Loss: 1.763 Vali Loss: 3.434 Vali Acc: 0.089 Test Loss: 3.434 Test Acc: 0.089
Validation loss decreased (-0.084672 --> -0.089377).  Saving model ...
Epoch: 10 cost time: 4.251332998275757
Epoch: 10, Steps: 10 | Train Loss: 1.453 Vali Loss: 3.477 Vali Acc: 0.091 Test Loss: 3.477 Test Acc: 0.091
Validation loss decreased (-0.089377 --> -0.090553).  Saving model ...
Epoch: 11 cost time: 3.901848793029785
Epoch: 11, Steps: 10 | Train Loss: 1.101 Vali Loss: 3.536 Vali Acc: 0.088 Test Loss: 3.536 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9965410232543945
Epoch: 12, Steps: 10 | Train Loss: 0.831 Vali Loss: 3.633 Vali Acc: 0.087 Test Loss: 3.633 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.090714693069458
Epoch: 13, Steps: 10 | Train Loss: 0.635 Vali Loss: 3.731 Vali Acc: 0.093 Test Loss: 3.731 Test Acc: 0.093
Validation loss decreased (-0.090553 --> -0.092904).  Saving model ...
Epoch: 14 cost time: 3.8576624393463135
Epoch: 14, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.868 Vali Acc: 0.095 Test Loss: 3.868 Test Acc: 0.095
Validation loss decreased (-0.092904 --> -0.095255).  Saving model ...
Epoch: 15 cost time: 4.101484775543213
Epoch: 15, Steps: 10 | Train Loss: 0.256 Vali Loss: 4.108 Vali Acc: 0.099 Test Loss: 4.108 Test Acc: 0.099
Validation loss decreased (-0.095255 --> -0.098782).  Saving model ...
Epoch: 16 cost time: 3.717590093612671
Epoch: 16, Steps: 10 | Train Loss: 0.151 Vali Loss: 4.224 Vali Acc: 0.102 Test Loss: 4.224 Test Acc: 0.102
Validation loss decreased (-0.098782 --> -0.102311).  Saving model ...
Epoch: 17 cost time: 3.5371928215026855
Epoch: 17, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.325 Vali Acc: 0.096 Test Loss: 4.325 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.738741159439087
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.474 Vali Acc: 0.107 Test Loss: 4.474 Test Acc: 0.107
Validation loss decreased (-0.102311 --> -0.107014).  Saving model ...
Epoch: 19 cost time: 4.002093553543091
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.515 Vali Acc: 0.099 Test Loss: 4.515 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5714035034179688
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.526 Vali Acc: 0.107 Test Loss: 4.526 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.7106871604919434
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.552 Vali Acc: 0.106 Test Loss: 4.552 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.74308705329895
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.589 Vali Acc: 0.108 Test Loss: 4.589 Test Acc: 0.108
Validation loss decreased (-0.107014 --> -0.108189).  Saving model ...
Epoch: 23 cost time: 3.7611465454101562
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.630 Vali Acc: 0.111 Test Loss: 4.630 Test Acc: 0.111
Validation loss decreased (-0.108189 --> -0.110542).  Saving model ...
Epoch: 24 cost time: 4.310050964355469
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.680 Vali Acc: 0.106 Test Loss: 4.680 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.986879348754883
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.750 Vali Acc: 0.106 Test Loss: 4.750 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.960770606994629
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.763 Vali Acc: 0.101 Test Loss: 4.763 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.2410054206848145
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.762 Vali Acc: 0.104 Test Loss: 4.762 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.705683469772339
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.792 Vali Acc: 0.105 Test Loss: 4.792 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.8693552017211914
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.795 Vali Acc: 0.104 Test Loss: 4.795 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.4255669116973877
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.816 Vali Acc: 0.106 Test Loss: 4.816 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.770831346511841
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.838 Vali Acc: 0.106 Test Loss: 4.838 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.15902042388916
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.871 Vali Acc: 0.111 Test Loss: 4.871 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.165127754211426
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.885 Vali Acc: 0.111 Test Loss: 4.885 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.11058823529411765
model parameter : 813722
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.185159683227539
Epoch: 1, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.300 Vali Acc: 0.051 Test Loss: 3.300 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 3.70524001121521
Epoch: 2, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.317 Vali Acc: 0.053 Test Loss: 3.317 Test Acc: 0.053
Validation loss decreased (-0.050555 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 3.91048002243042
Epoch: 3, Steps: 10 | Train Loss: 3.118 Vali Loss: 3.372 Vali Acc: 0.053 Test Loss: 3.372 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.558061361312866
Epoch: 4, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.399 Vali Acc: 0.064 Test Loss: 3.399 Test Acc: 0.064
Validation loss decreased (-0.052908 --> -0.063495).  Saving model ...
Epoch: 5 cost time: 3.694316864013672
Epoch: 5, Steps: 10 | Train Loss: 2.835 Vali Loss: 3.390 Vali Acc: 0.059 Test Loss: 3.390 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6760072708129883
Epoch: 6, Steps: 10 | Train Loss: 2.670 Vali Loss: 3.356 Vali Acc: 0.069 Test Loss: 3.356 Test Acc: 0.069
Validation loss decreased (-0.063495 --> -0.069378).  Saving model ...
Epoch: 7 cost time: 3.7229442596435547
Epoch: 7, Steps: 10 | Train Loss: 2.438 Vali Loss: 3.329 Vali Acc: 0.076 Test Loss: 3.329 Test Acc: 0.076
Validation loss decreased (-0.069378 --> -0.076437).  Saving model ...
Epoch: 8 cost time: 3.6156609058380127
Epoch: 8, Steps: 10 | Train Loss: 2.265 Vali Loss: 3.323 Vali Acc: 0.092 Test Loss: 3.323 Test Acc: 0.092
Validation loss decreased (-0.076437 --> -0.091731).  Saving model ...
Epoch: 9 cost time: 3.8101868629455566
Epoch: 9, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.357 Vali Acc: 0.095 Test Loss: 3.357 Test Acc: 0.095
Validation loss decreased (-0.091731 --> -0.095261).  Saving model ...
Epoch: 10 cost time: 3.9880073070526123
Epoch: 10, Steps: 10 | Train Loss: 1.819 Vali Loss: 3.385 Vali Acc: 0.088 Test Loss: 3.385 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.858271598815918
Epoch: 11, Steps: 10 | Train Loss: 1.479 Vali Loss: 3.419 Vali Acc: 0.092 Test Loss: 3.419 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.858367681503296
Epoch: 12, Steps: 10 | Train Loss: 1.164 Vali Loss: 3.476 Vali Acc: 0.087 Test Loss: 3.476 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.061195135116577
Epoch: 13, Steps: 10 | Train Loss: 0.937 Vali Loss: 3.574 Vali Acc: 0.093 Test Loss: 3.574 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.162883281707764
Epoch: 14, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.679 Vali Acc: 0.091 Test Loss: 3.679 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.192174911499023
Epoch: 15, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.851 Vali Acc: 0.088 Test Loss: 3.851 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.9399707317352295
Epoch: 16, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.959 Vali Acc: 0.098 Test Loss: 3.959 Test Acc: 0.098
Validation loss decreased (-0.095261 --> -0.097607).  Saving model ...
Epoch: 17 cost time: 3.7156004905700684
Epoch: 17, Steps: 10 | Train Loss: 0.181 Vali Loss: 4.143 Vali Acc: 0.093 Test Loss: 4.143 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.827239513397217
Epoch: 18, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.264 Vali Acc: 0.093 Test Loss: 4.264 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.182840347290039
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.242 Vali Acc: 0.105 Test Loss: 4.242 Test Acc: 0.105
Validation loss decreased (-0.097607 --> -0.104663).  Saving model ...
Epoch: 20 cost time: 3.8127479553222656
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.329 Vali Acc: 0.100 Test Loss: 4.329 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.909196615219116
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.399 Vali Acc: 0.106 Test Loss: 4.399 Test Acc: 0.106
Validation loss decreased (-0.104663 --> -0.105838).  Saving model ...
Epoch: 22 cost time: 4.161500453948975
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.443 Vali Acc: 0.107 Test Loss: 4.443 Test Acc: 0.107
Validation loss decreased (-0.105838 --> -0.107014).  Saving model ...
Epoch: 23 cost time: 3.8494317531585693
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.454 Vali Acc: 0.112 Test Loss: 4.454 Test Acc: 0.112
Validation loss decreased (-0.107014 --> -0.111720).  Saving model ...
Epoch: 24 cost time: 4.106795072555542
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.493 Vali Acc: 0.116 Test Loss: 4.493 Test Acc: 0.116
Validation loss decreased (-0.111720 --> -0.116426).  Saving model ...
Epoch: 25 cost time: 3.964664936065674
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.539 Vali Acc: 0.111 Test Loss: 4.539 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.958705186843872
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.562 Vali Acc: 0.111 Test Loss: 4.562 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.0076584815979
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.574 Vali Acc: 0.112 Test Loss: 4.574 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.5931503772735596
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.619 Vali Acc: 0.111 Test Loss: 4.619 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.770350217819214
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.633 Vali Acc: 0.109 Test Loss: 4.633 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.824512481689453
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.649 Vali Acc: 0.111 Test Loss: 4.649 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.833749294281006
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.670 Vali Acc: 0.114 Test Loss: 4.670 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.519082546234131
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.677 Vali Acc: 0.115 Test Loss: 4.677 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.7811646461486816
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.660 Vali Acc: 0.116 Test Loss: 4.660 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.842158317565918
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.667 Vali Acc: 0.118 Test Loss: 4.667 Test Acc: 0.118
Validation loss decreased (-0.116426 --> -0.117600).  Saving model ...
Epoch: 35 cost time: 3.8484013080596924
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.691 Vali Acc: 0.116 Test Loss: 4.691 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.0250818729400635
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.721 Vali Acc: 0.119 Test Loss: 4.721 Test Acc: 0.119
Validation loss decreased (-0.117600 --> -0.118776).  Saving model ...
Epoch: 37 cost time: 3.6145288944244385
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.739 Vali Acc: 0.116 Test Loss: 4.739 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.605529308319092
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.752 Vali Acc: 0.119 Test Loss: 4.752 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.68514084815979
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.778 Vali Acc: 0.121 Test Loss: 4.778 Test Acc: 0.121
Validation loss decreased (-0.118776 --> -0.121129).  Saving model ...
Epoch: 40 cost time: 3.5510597229003906
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.813 Vali Acc: 0.119 Test Loss: 4.813 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.849423885345459
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.820 Vali Acc: 0.119 Test Loss: 4.820 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.427795171737671
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.831 Vali Acc: 0.122 Test Loss: 4.831 Test Acc: 0.122
Validation loss decreased (-0.121129 --> -0.122305).  Saving model ...
Epoch: 43 cost time: 4.186538457870483
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.832 Vali Acc: 0.121 Test Loss: 4.832 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.971388339996338
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.847 Vali Acc: 0.119 Test Loss: 4.847 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 4.133581638336182
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.854 Vali Acc: 0.121 Test Loss: 4.854 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 4.411349058151245
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.865 Vali Acc: 0.121 Test Loss: 4.865 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.7580454349517822
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.891 Vali Acc: 0.119 Test Loss: 4.891 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.5302913188934326
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.915 Vali Acc: 0.122 Test Loss: 4.915 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.593705415725708
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.911 Vali Acc: 0.126 Test Loss: 4.911 Test Acc: 0.126
Validation loss decreased (-0.122305 --> -0.125833).  Saving model ...
Epoch: 50 cost time: 3.5847835540771484
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.914 Vali Acc: 0.119 Test Loss: 4.914 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.4182960987091064
Epoch: 51, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.917 Vali Acc: 0.124 Test Loss: 4.917 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.8373231887817383
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.931 Vali Acc: 0.124 Test Loss: 4.931 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.9501233100891113
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.942 Vali Acc: 0.122 Test Loss: 4.942 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.638401746749878
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.950 Vali Acc: 0.126 Test Loss: 4.950 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.6023149490356445
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.956 Vali Acc: 0.127 Test Loss: 4.956 Test Acc: 0.127
Validation loss decreased (-0.125833 --> -0.127009).  Saving model ...
Epoch: 56 cost time: 3.5011632442474365
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.963 Vali Acc: 0.128 Test Loss: 4.963 Test Acc: 0.128
Validation loss decreased (-0.127009 --> -0.128186).  Saving model ...
Epoch: 57 cost time: 3.579634428024292
Epoch: 57, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.971 Vali Acc: 0.125 Test Loss: 4.971 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.673781394958496
Epoch: 58, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.982 Vali Acc: 0.125 Test Loss: 4.982 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.7623448371887207
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.994 Vali Acc: 0.124 Test Loss: 4.994 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.5776307582855225
Epoch: 60, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.001 Vali Acc: 0.124 Test Loss: 5.001 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.7662899494171143
Epoch: 61, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.014 Vali Acc: 0.120 Test Loss: 5.014 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 3.599680185317993
Epoch: 62, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.020 Vali Acc: 0.121 Test Loss: 5.020 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 3.726825475692749
Epoch: 63, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.029 Vali Acc: 0.122 Test Loss: 5.029 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 3.733961343765259
Epoch: 64, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.039 Vali Acc: 0.122 Test Loss: 5.039 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 3.667963981628418
Epoch: 65, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.048 Vali Acc: 0.124 Test Loss: 5.048 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 3.394261598587036
Epoch: 66, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.058 Vali Acc: 0.125 Test Loss: 5.058 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12823529411764706
model parameter : 813722
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.218187570571899
Epoch: 1, Steps: 10 | Train Loss: 3.366 Vali Loss: 3.340 Vali Acc: 0.033 Test Loss: 3.340 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 3.6976208686828613
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.357 Vali Acc: 0.038 Test Loss: 3.357 Test Acc: 0.038
Validation loss decreased (-0.032908 --> -0.037613).  Saving model ...
Epoch: 3 cost time: 3.7448911666870117
Epoch: 3, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.395 Vali Acc: 0.044 Test Loss: 3.395 Test Acc: 0.044
Validation loss decreased (-0.037613 --> -0.043495).  Saving model ...
Epoch: 4 cost time: 3.8176205158233643
Epoch: 4, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.433 Vali Acc: 0.046 Test Loss: 3.433 Test Acc: 0.046
Validation loss decreased (-0.043495 --> -0.045848).  Saving model ...
Epoch: 5 cost time: 3.180474042892456
Epoch: 5, Steps: 10 | Train Loss: 2.946 Vali Loss: 3.436 Vali Acc: 0.054 Test Loss: 3.436 Test Acc: 0.054
Validation loss decreased (-0.045848 --> -0.054083).  Saving model ...
Epoch: 6 cost time: 3.3986728191375732
Epoch: 6, Steps: 10 | Train Loss: 2.824 Vali Loss: 3.393 Vali Acc: 0.049 Test Loss: 3.393 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.475231170654297
Epoch: 7, Steps: 10 | Train Loss: 2.656 Vali Loss: 3.372 Vali Acc: 0.061 Test Loss: 3.372 Test Acc: 0.061
Validation loss decreased (-0.054083 --> -0.061143).  Saving model ...
Epoch: 8 cost time: 3.2539429664611816
Epoch: 8, Steps: 10 | Train Loss: 2.524 Vali Loss: 3.358 Vali Acc: 0.061 Test Loss: 3.358 Test Acc: 0.061
Validation loss decreased (-0.061143 --> -0.061143).  Saving model ...
Epoch: 9 cost time: 3.154970407485962
Epoch: 9, Steps: 10 | Train Loss: 2.291 Vali Loss: 3.367 Vali Acc: 0.074 Test Loss: 3.367 Test Acc: 0.074
Validation loss decreased (-0.061143 --> -0.074084).  Saving model ...
Epoch: 10 cost time: 3.277988910675049
Epoch: 10, Steps: 10 | Train Loss: 2.104 Vali Loss: 3.381 Vali Acc: 0.073 Test Loss: 3.381 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7490975856781006
Epoch: 11, Steps: 10 | Train Loss: 1.875 Vali Loss: 3.406 Vali Acc: 0.081 Test Loss: 3.406 Test Acc: 0.081
Validation loss decreased (-0.074084 --> -0.081142).  Saving model ...
Epoch: 12 cost time: 3.7365641593933105
Epoch: 12, Steps: 10 | Train Loss: 1.574 Vali Loss: 3.443 Vali Acc: 0.089 Test Loss: 3.443 Test Acc: 0.089
Validation loss decreased (-0.081142 --> -0.089377).  Saving model ...
Epoch: 13 cost time: 3.9798262119293213
Epoch: 13, Steps: 10 | Train Loss: 1.251 Vali Loss: 3.504 Vali Acc: 0.102 Test Loss: 3.504 Test Acc: 0.102
Validation loss decreased (-0.089377 --> -0.102318).  Saving model ...
Epoch: 14 cost time: 3.7439334392547607
Epoch: 14, Steps: 10 | Train Loss: 0.922 Vali Loss: 3.626 Vali Acc: 0.106 Test Loss: 3.626 Test Acc: 0.106
Validation loss decreased (-0.102318 --> -0.105846).  Saving model ...
Epoch: 15 cost time: 3.655797243118286
Epoch: 15, Steps: 10 | Train Loss: 0.742 Vali Loss: 3.730 Vali Acc: 0.111 Test Loss: 3.730 Test Acc: 0.111
Validation loss decreased (-0.105846 --> -0.110551).  Saving model ...
Epoch: 16 cost time: 3.93015456199646
Epoch: 16, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.871 Vali Acc: 0.099 Test Loss: 3.871 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9151511192321777
Epoch: 17, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.988 Vali Acc: 0.109 Test Loss: 3.988 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.0570762157440186
Epoch: 18, Steps: 10 | Train Loss: 0.229 Vali Loss: 4.112 Vali Acc: 0.101 Test Loss: 4.112 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9875121116638184
Epoch: 19, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.161 Vali Acc: 0.114 Test Loss: 4.161 Test Acc: 0.114
Validation loss decreased (-0.110551 --> -0.114076).  Saving model ...
Epoch: 20 cost time: 3.912715196609497
Epoch: 20, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.290 Vali Acc: 0.120 Test Loss: 4.290 Test Acc: 0.120
Validation loss decreased (-0.114076 --> -0.119957).  Saving model ...
Epoch: 21 cost time: 3.8372671604156494
Epoch: 21, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.332 Vali Acc: 0.118 Test Loss: 4.332 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8646225929260254
Epoch: 22, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.399 Vali Acc: 0.124 Test Loss: 4.399 Test Acc: 0.124
Validation loss decreased (-0.119957 --> -0.123485).  Saving model ...
Epoch: 23 cost time: 3.8190484046936035
Epoch: 23, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.387 Vali Acc: 0.128 Test Loss: 4.387 Test Acc: 0.128
Validation loss decreased (-0.123485 --> -0.128191).  Saving model ...
Epoch: 24 cost time: 3.488264799118042
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.421 Vali Acc: 0.131 Test Loss: 4.421 Test Acc: 0.131
Validation loss decreased (-0.128191 --> -0.130544).  Saving model ...
Epoch: 25 cost time: 3.8396034240722656
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.489 Vali Acc: 0.127 Test Loss: 4.489 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.5096559524536133
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.557 Vali Acc: 0.131 Test Loss: 4.557 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.663975954055786
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.553 Vali Acc: 0.135 Test Loss: 4.553 Test Acc: 0.135
Validation loss decreased (-0.130544 --> -0.135249).  Saving model ...
Epoch: 28 cost time: 3.1930456161499023
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.596 Vali Acc: 0.133 Test Loss: 4.596 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.556889295578003
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.614 Vali Acc: 0.142 Test Loss: 4.614 Test Acc: 0.142
Validation loss decreased (-0.135249 --> -0.142307).  Saving model ...
Epoch: 30 cost time: 3.664642572402954
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.626 Vali Acc: 0.138 Test Loss: 4.626 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.2474076747894287
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.638 Vali Acc: 0.136 Test Loss: 4.638 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.4877548217773438
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.651 Vali Acc: 0.141 Test Loss: 4.651 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.5232608318328857
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.647 Vali Acc: 0.145 Test Loss: 4.647 Test Acc: 0.145
Validation loss decreased (-0.142307 --> -0.144659).  Saving model ...
Epoch: 34 cost time: 3.8896591663360596
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.673 Vali Acc: 0.147 Test Loss: 4.673 Test Acc: 0.147
Validation loss decreased (-0.144659 --> -0.147012).  Saving model ...
Epoch: 35 cost time: 4.117272138595581
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.706 Vali Acc: 0.140 Test Loss: 4.706 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.7198987007141113
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.743 Vali Acc: 0.145 Test Loss: 4.743 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.703735589981079
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.763 Vali Acc: 0.144 Test Loss: 4.763 Test Acc: 0.144
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.700131416320801
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.771 Vali Acc: 0.145 Test Loss: 4.771 Test Acc: 0.145
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.7836499214172363
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.791 Vali Acc: 0.151 Test Loss: 4.791 Test Acc: 0.151
Validation loss decreased (-0.147012 --> -0.150540).  Saving model ...
Epoch: 40 cost time: 3.532405138015747
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.820 Vali Acc: 0.148 Test Loss: 4.820 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.8447012901306152
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.832 Vali Acc: 0.147 Test Loss: 4.832 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.626349925994873
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.845 Vali Acc: 0.149 Test Loss: 4.845 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.055554628372192
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.845 Vali Acc: 0.148 Test Loss: 4.845 Test Acc: 0.148
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 4.046509265899658
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.873 Vali Acc: 0.149 Test Loss: 4.873 Test Acc: 0.149
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 4.1583027839660645
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.886 Vali Acc: 0.146 Test Loss: 4.886 Test Acc: 0.146
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 4.650401592254639
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.903 Vali Acc: 0.148 Test Loss: 4.903 Test Acc: 0.148
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 4.146320343017578
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.920 Vali Acc: 0.146 Test Loss: 4.920 Test Acc: 0.146
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.9608078002929688
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.929 Vali Acc: 0.147 Test Loss: 4.929 Test Acc: 0.147
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.9320037364959717
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.919 Vali Acc: 0.148 Test Loss: 4.919 Test Acc: 0.148
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15058823529411763
model parameter : 813722
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.01651406288147
Epoch: 1, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.040 Test Loss: 3.258 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 4.057426691055298
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.040 Test Loss: 3.258 Test Acc: 0.040
Validation loss decreased (-0.039967 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 3.8388378620147705
Epoch: 3, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.039967 --> -0.050556).  Saving model ...
Epoch: 4 cost time: 3.596790075302124
Epoch: 4, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 5 cost time: 3.7165262699127197
Epoch: 5, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 6 cost time: 3.569483995437622
Epoch: 6, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 7 cost time: 3.7379679679870605
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 8 cost time: 4.133413076400757
Epoch: 8, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 9 cost time: 3.4676051139831543
Epoch: 9, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 10 cost time: 3.606602907180786
Epoch: 10, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 11 cost time: 3.2891807556152344
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 12 cost time: 3.551898717880249
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 13 cost time: 3.8734071254730225
Epoch: 13, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 14 cost time: 3.462388038635254
Epoch: 14, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 15 cost time: 3.7336387634277344
Epoch: 15, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 16 cost time: 3.838785171508789
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 17 cost time: 3.5594186782836914
Epoch: 17, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 18 cost time: 4.012680530548096
Epoch: 18, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 19 cost time: 3.975071430206299
Epoch: 19, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 20 cost time: 3.6735479831695557
Epoch: 20, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 21 cost time: 3.8079984188079834
Epoch: 21, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 22 cost time: 3.2469429969787598
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 23 cost time: 3.4013826847076416
Epoch: 23, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.257 Vali Acc: 0.051 Test Loss: 3.257 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 24 cost time: 3.3881866931915283
Epoch: 24, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.257 Vali Acc: 0.051 Test Loss: 3.257 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 25 cost time: 3.821500778198242
Epoch: 25, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.036189079284668
Epoch: 26, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.160553216934204
Epoch: 27, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.50547194480896
Epoch: 28, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.3172049522399902
Epoch: 29, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.9173648357391357
Epoch: 30, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.5812923908233643
Epoch: 31, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.482501983642578
Epoch: 32, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.6887431144714355
Epoch: 33, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.635531425476074
Epoch: 34, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.05058823529411765
model parameter : 813722
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.8159825801849365
Epoch: 1, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.263 Vali Acc: 0.069 Test Loss: 3.263 Test Acc: 0.069
Validation loss decreased (inf --> -0.069379).  Saving model ...
Epoch: 2 cost time: 3.40297532081604
Epoch: 2, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.249 Vali Acc: 0.102 Test Loss: 3.249 Test Acc: 0.102
Validation loss decreased (-0.069379 --> -0.102320).  Saving model ...
Epoch: 3 cost time: 3.6092584133148193
Epoch: 3, Steps: 10 | Train Loss: 2.740 Vali Loss: 3.242 Vali Acc: 0.125 Test Loss: 3.242 Test Acc: 0.125
Validation loss decreased (-0.102320 --> -0.124673).  Saving model ...
Epoch: 4 cost time: 3.4198055267333984
Epoch: 4, Steps: 10 | Train Loss: 2.319 Vali Loss: 3.171 Vali Acc: 0.166 Test Loss: 3.171 Test Acc: 0.166
Validation loss decreased (-0.124673 --> -0.165851).  Saving model ...
Epoch: 5 cost time: 3.4361488819122314
Epoch: 5, Steps: 10 | Train Loss: 1.901 Vali Loss: 3.105 Vali Acc: 0.196 Test Loss: 3.105 Test Acc: 0.196
Validation loss decreased (-0.165851 --> -0.196440).  Saving model ...
Epoch: 6 cost time: 3.8136191368103027
Epoch: 6, Steps: 10 | Train Loss: 1.533 Vali Loss: 3.104 Vali Acc: 0.211 Test Loss: 3.104 Test Acc: 0.211
Validation loss decreased (-0.196440 --> -0.210557).  Saving model ...
Epoch: 7 cost time: 3.9198050498962402
Epoch: 7, Steps: 10 | Train Loss: 1.193 Vali Loss: 3.186 Vali Acc: 0.224 Test Loss: 3.186 Test Acc: 0.224
Validation loss decreased (-0.210557 --> -0.223498).  Saving model ...
Epoch: 8 cost time: 3.8601763248443604
Epoch: 8, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.168 Vali Acc: 0.253 Test Loss: 3.168 Test Acc: 0.253
Validation loss decreased (-0.223498 --> -0.252909).  Saving model ...
Epoch: 9 cost time: 3.7678232192993164
Epoch: 9, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.229 Vali Acc: 0.276 Test Loss: 3.229 Test Acc: 0.276
Validation loss decreased (-0.252909 --> -0.276438).  Saving model ...
Epoch: 10 cost time: 3.3630449771881104
Epoch: 10, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.328 Vali Acc: 0.284 Test Loss: 3.328 Test Acc: 0.284
Validation loss decreased (-0.276438 --> -0.283496).  Saving model ...
Epoch: 11 cost time: 3.609907627105713
Epoch: 11, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.473 Vali Acc: 0.268 Test Loss: 3.473 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1241037845611572
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.537 Vali Acc: 0.289 Test Loss: 3.537 Test Acc: 0.289
Validation loss decreased (-0.283496 --> -0.289376).  Saving model ...
Epoch: 13 cost time: 3.57427716255188
Epoch: 13, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.566 Vali Acc: 0.304 Test Loss: 3.566 Test Acc: 0.304
Validation loss decreased (-0.289376 --> -0.303494).  Saving model ...
Epoch: 14 cost time: 2.9882044792175293
Epoch: 14, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.648 Vali Acc: 0.301 Test Loss: 3.648 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2215735912323
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.704 Vali Acc: 0.298 Test Loss: 3.704 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.556259870529175
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.760 Vali Acc: 0.301 Test Loss: 3.760 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.406276226043701
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.806 Vali Acc: 0.315 Test Loss: 3.806 Test Acc: 0.315
Validation loss decreased (-0.303494 --> -0.315256).  Saving model ...
Epoch: 18 cost time: 3.5607786178588867
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.859 Vali Acc: 0.318 Test Loss: 3.859 Test Acc: 0.318
Validation loss decreased (-0.315256 --> -0.317608).  Saving model ...
Epoch: 19 cost time: 3.2742443084716797
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.857 Vali Acc: 0.314 Test Loss: 3.857 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3855741024017334
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.888 Vali Acc: 0.319 Test Loss: 3.888 Test Acc: 0.319
Validation loss decreased (-0.317608 --> -0.318785).  Saving model ...
Epoch: 21 cost time: 3.5424411296844482
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.920 Vali Acc: 0.319 Test Loss: 3.920 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.310987949371338
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.943 Vali Acc: 0.319 Test Loss: 3.943 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.514472484588623
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.962 Vali Acc: 0.314 Test Loss: 3.962 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.196101665496826
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.989 Vali Acc: 0.319 Test Loss: 3.989 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.074710845947266
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.013 Vali Acc: 0.316 Test Loss: 4.013 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.8553318977355957
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.044 Vali Acc: 0.318 Test Loss: 4.044 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.283110857009888
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.062 Vali Acc: 0.314 Test Loss: 4.062 Test Acc: 0.314
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5154175758361816
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.080 Vali Acc: 0.320 Test Loss: 4.080 Test Acc: 0.320
Validation loss decreased (-0.318785 --> -0.319959).  Saving model ...
Epoch: 29 cost time: 3.520453929901123
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.092 Vali Acc: 0.319 Test Loss: 4.092 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.816133975982666
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.112 Vali Acc: 0.321 Test Loss: 4.112 Test Acc: 0.321
Validation loss decreased (-0.319959 --> -0.321135).  Saving model ...
Epoch: 31 cost time: 3.706749439239502
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.137 Vali Acc: 0.325 Test Loss: 4.137 Test Acc: 0.325
Validation loss decreased (-0.321135 --> -0.324665).  Saving model ...
Epoch: 32 cost time: 3.425274610519409
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.157 Vali Acc: 0.322 Test Loss: 4.157 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.9355297088623047
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.169 Vali Acc: 0.322 Test Loss: 4.169 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.932853937149048
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.182 Vali Acc: 0.322 Test Loss: 4.182 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.5573177337646484
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.202 Vali Acc: 0.321 Test Loss: 4.202 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.5678181648254395
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.218 Vali Acc: 0.320 Test Loss: 4.218 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.584056854248047
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.239 Vali Acc: 0.318 Test Loss: 4.239 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.9609973430633545
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.255 Vali Acc: 0.320 Test Loss: 4.255 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.3835058212280273
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.267 Vali Acc: 0.324 Test Loss: 4.267 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.4161376953125
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.280 Vali Acc: 0.326 Test Loss: 4.280 Test Acc: 0.326
Validation loss decreased (-0.324665 --> -0.325840).  Saving model ...
Epoch: 41 cost time: 3.9310719966888428
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.302 Vali Acc: 0.324 Test Loss: 4.302 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 4.103222370147705
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.317 Vali Acc: 0.320 Test Loss: 4.317 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.9757111072540283
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.328 Vali Acc: 0.319 Test Loss: 4.328 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.5193774700164795
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.334 Vali Acc: 0.325 Test Loss: 4.334 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.511176109313965
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.350 Vali Acc: 0.327 Test Loss: 4.350 Test Acc: 0.327
Validation loss decreased (-0.325840 --> -0.327015).  Saving model ...
Epoch: 46 cost time: 3.2813398838043213
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.360 Vali Acc: 0.328 Test Loss: 4.360 Test Acc: 0.328
Validation loss decreased (-0.327015 --> -0.328192).  Saving model ...
Epoch: 47 cost time: 3.814399242401123
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.370 Vali Acc: 0.328 Test Loss: 4.370 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.920450448989868
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.378 Vali Acc: 0.332 Test Loss: 4.378 Test Acc: 0.332
Validation loss decreased (-0.328192 --> -0.331721).  Saving model ...
Epoch: 49 cost time: 3.8173983097076416
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.389 Vali Acc: 0.327 Test Loss: 4.389 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.9496190547943115
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.400 Vali Acc: 0.326 Test Loss: 4.400 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 4.215195894241333
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.413 Vali Acc: 0.325 Test Loss: 4.413 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.958125352859497
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.421 Vali Acc: 0.331 Test Loss: 4.421 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 4.005700588226318
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.434 Vali Acc: 0.328 Test Loss: 4.434 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.9267618656158447
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.449 Vali Acc: 0.328 Test Loss: 4.449 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.6067605018615723
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.460 Vali Acc: 0.328 Test Loss: 4.460 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.7728004455566406
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.472 Vali Acc: 0.331 Test Loss: 4.472 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 3.931055784225464
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.487 Vali Acc: 0.331 Test Loss: 4.487 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 3.902536153793335
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.500 Vali Acc: 0.332 Test Loss: 4.500 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33176470588235296
model parameter : 617114
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.0913779735565186
Epoch: 1, Steps: 10 | Train Loss: 3.306 Vali Loss: 3.268 Vali Acc: 0.064 Test Loss: 3.268 Test Acc: 0.064
Validation loss decreased (inf --> -0.063497).  Saving model ...
Epoch: 2 cost time: 3.37807559967041
Epoch: 2, Steps: 10 | Train Loss: 3.053 Vali Loss: 3.259 Vali Acc: 0.086 Test Loss: 3.259 Test Acc: 0.086
Validation loss decreased (-0.063497 --> -0.085850).  Saving model ...
Epoch: 3 cost time: 3.4347641468048096
Epoch: 3, Steps: 10 | Train Loss: 2.727 Vali Loss: 3.254 Vali Acc: 0.124 Test Loss: 3.254 Test Acc: 0.124
Validation loss decreased (-0.085850 --> -0.123497).  Saving model ...
Epoch: 4 cost time: 3.62333345413208
Epoch: 4, Steps: 10 | Train Loss: 2.300 Vali Loss: 3.182 Vali Acc: 0.160 Test Loss: 3.182 Test Acc: 0.160
Validation loss decreased (-0.123497 --> -0.159968).  Saving model ...
Epoch: 5 cost time: 3.527111291885376
Epoch: 5, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.118 Vali Acc: 0.186 Test Loss: 3.118 Test Acc: 0.186
Validation loss decreased (-0.159968 --> -0.185851).  Saving model ...
Epoch: 6 cost time: 3.817432165145874
Epoch: 6, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.113 Vali Acc: 0.226 Test Loss: 3.113 Test Acc: 0.226
Validation loss decreased (-0.185851 --> -0.225851).  Saving model ...
Epoch: 7 cost time: 3.5788543224334717
Epoch: 7, Steps: 10 | Train Loss: 1.199 Vali Loss: 3.198 Vali Acc: 0.228 Test Loss: 3.198 Test Acc: 0.228
Validation loss decreased (-0.225851 --> -0.228203).  Saving model ...
Epoch: 8 cost time: 3.5067474842071533
Epoch: 8, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.179 Vali Acc: 0.259 Test Loss: 3.179 Test Acc: 0.259
Validation loss decreased (-0.228203 --> -0.258792).  Saving model ...
Epoch: 9 cost time: 3.240194797515869
Epoch: 9, Steps: 10 | Train Loss: 0.606 Vali Loss: 3.242 Vali Acc: 0.271 Test Loss: 3.242 Test Acc: 0.271
Validation loss decreased (-0.258792 --> -0.270556).  Saving model ...
Epoch: 10 cost time: 3.9440557956695557
Epoch: 10, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.355 Vali Acc: 0.285 Test Loss: 3.355 Test Acc: 0.285
Validation loss decreased (-0.270556 --> -0.284672).  Saving model ...
Epoch: 11 cost time: 3.6609203815460205
Epoch: 11, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.505 Vali Acc: 0.287 Test Loss: 3.505 Test Acc: 0.287
Validation loss decreased (-0.284672 --> -0.287024).  Saving model ...
Epoch: 12 cost time: 3.674654960632324
Epoch: 12, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.566 Vali Acc: 0.309 Test Loss: 3.566 Test Acc: 0.309
Validation loss decreased (-0.287024 --> -0.309376).  Saving model ...
Epoch: 13 cost time: 3.4603192806243896
Epoch: 13, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.631 Vali Acc: 0.318 Test Loss: 3.631 Test Acc: 0.318
Validation loss decreased (-0.309376 --> -0.317611).  Saving model ...
Epoch: 14 cost time: 3.7920284271240234
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.740 Vali Acc: 0.299 Test Loss: 3.740 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7688183784484863
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.810 Vali Acc: 0.302 Test Loss: 3.810 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.389874219894409
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.868 Vali Acc: 0.308 Test Loss: 3.868 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.744676113128662
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.903 Vali Acc: 0.309 Test Loss: 3.903 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3401966094970703
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.936 Vali Acc: 0.309 Test Loss: 3.936 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.8355157375335693
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.951 Vali Acc: 0.314 Test Loss: 3.951 Test Acc: 0.314
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.937739133834839
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.996 Vali Acc: 0.314 Test Loss: 3.996 Test Acc: 0.314
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.889101982116699
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.035 Vali Acc: 0.315 Test Loss: 4.035 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.5494391918182373
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.053 Vali Acc: 0.315 Test Loss: 4.053 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.6891112327575684
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.071 Vali Acc: 0.313 Test Loss: 4.071 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 617114
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.575073480606079
Epoch: 1, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.266 Vali Acc: 0.048 Test Loss: 3.266 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 3.4430148601531982
Epoch: 2, Steps: 10 | Train Loss: 3.109 Vali Loss: 3.248 Vali Acc: 0.089 Test Loss: 3.248 Test Acc: 0.089
Validation loss decreased (-0.048203 --> -0.089379).  Saving model ...
Epoch: 3 cost time: 3.845151901245117
Epoch: 3, Steps: 10 | Train Loss: 2.782 Vali Loss: 3.246 Vali Acc: 0.109 Test Loss: 3.246 Test Acc: 0.109
Validation loss decreased (-0.089379 --> -0.109379).  Saving model ...
Epoch: 4 cost time: 3.8284919261932373
Epoch: 4, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.191 Vali Acc: 0.161 Test Loss: 3.191 Test Acc: 0.161
Validation loss decreased (-0.109379 --> -0.161145).  Saving model ...
Epoch: 5 cost time: 3.6233911514282227
Epoch: 5, Steps: 10 | Train Loss: 1.965 Vali Loss: 3.147 Vali Acc: 0.180 Test Loss: 3.147 Test Acc: 0.180
Validation loss decreased (-0.161145 --> -0.179969).  Saving model ...
Epoch: 6 cost time: 3.372758388519287
Epoch: 6, Steps: 10 | Train Loss: 1.663 Vali Loss: 3.154 Vali Acc: 0.207 Test Loss: 3.154 Test Acc: 0.207
Validation loss decreased (-0.179969 --> -0.207027).  Saving model ...
Epoch: 7 cost time: 3.4773473739624023
Epoch: 7, Steps: 10 | Train Loss: 1.332 Vali Loss: 3.247 Vali Acc: 0.241 Test Loss: 3.247 Test Acc: 0.241
Validation loss decreased (-0.207027 --> -0.241144).  Saving model ...
Epoch: 8 cost time: 3.5373826026916504
Epoch: 8, Steps: 10 | Train Loss: 0.995 Vali Loss: 3.218 Vali Acc: 0.258 Test Loss: 3.218 Test Acc: 0.258
Validation loss decreased (-0.241144 --> -0.257615).  Saving model ...
Epoch: 9 cost time: 3.429903745651245
Epoch: 9, Steps: 10 | Train Loss: 0.766 Vali Loss: 3.272 Vali Acc: 0.260 Test Loss: 3.272 Test Acc: 0.260
Validation loss decreased (-0.257615 --> -0.259967).  Saving model ...
Epoch: 10 cost time: 3.717592239379883
Epoch: 10, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.381 Vali Acc: 0.284 Test Loss: 3.381 Test Acc: 0.284
Validation loss decreased (-0.259967 --> -0.283496).  Saving model ...
Epoch: 11 cost time: 3.555907726287842
Epoch: 11, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.501 Vali Acc: 0.285 Test Loss: 3.501 Test Acc: 0.285
Validation loss decreased (-0.283496 --> -0.284671).  Saving model ...
Epoch: 12 cost time: 3.807999610900879
Epoch: 12, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.530 Vali Acc: 0.292 Test Loss: 3.530 Test Acc: 0.292
Validation loss decreased (-0.284671 --> -0.291729).  Saving model ...
Epoch: 13 cost time: 3.6388936042785645
Epoch: 13, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.606 Vali Acc: 0.305 Test Loss: 3.606 Test Acc: 0.305
Validation loss decreased (-0.291729 --> -0.304670).  Saving model ...
Epoch: 14 cost time: 3.8270342350006104
Epoch: 14, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.744 Vali Acc: 0.301 Test Loss: 3.744 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.611907958984375
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.785 Vali Acc: 0.318 Test Loss: 3.785 Test Acc: 0.318
Validation loss decreased (-0.304670 --> -0.317609).  Saving model ...
Epoch: 16 cost time: 3.4381346702575684
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.846 Vali Acc: 0.314 Test Loss: 3.846 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3415825366973877
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.910 Vali Acc: 0.311 Test Loss: 3.910 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.123986005783081
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.976 Vali Acc: 0.313 Test Loss: 3.976 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.5287163257598877
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.968 Vali Acc: 0.324 Test Loss: 3.968 Test Acc: 0.324
Validation loss decreased (-0.317609 --> -0.323490).  Saving model ...
Epoch: 20 cost time: 3.6462290287017822
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.016 Vali Acc: 0.313 Test Loss: 4.016 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.675467014312744
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.063 Vali Acc: 0.318 Test Loss: 4.063 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.7519445419311523
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.080 Vali Acc: 0.322 Test Loss: 4.080 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.561161994934082
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.106 Vali Acc: 0.325 Test Loss: 4.106 Test Acc: 0.325
Validation loss decreased (-0.323490 --> -0.324665).  Saving model ...
Epoch: 24 cost time: 3.25673246383667
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.139 Vali Acc: 0.322 Test Loss: 4.139 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.243122100830078
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.175 Vali Acc: 0.316 Test Loss: 4.175 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.417099714279175
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.202 Vali Acc: 0.320 Test Loss: 4.202 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.4027109146118164
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.219 Vali Acc: 0.319 Test Loss: 4.219 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.7736005783081055
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.233 Vali Acc: 0.320 Test Loss: 4.233 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.084885358810425
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.249 Vali Acc: 0.318 Test Loss: 4.249 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.8306968212127686
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.274 Vali Acc: 0.316 Test Loss: 4.274 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.049497127532959
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.299 Vali Acc: 0.320 Test Loss: 4.299 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.6400129795074463
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.314 Vali Acc: 0.319 Test Loss: 4.314 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.4871294498443604
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.325 Vali Acc: 0.322 Test Loss: 4.325 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 617114
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.553407907485962
Epoch: 1, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.272 Vali Acc: 0.059 Test Loss: 3.272 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 3.2453112602233887
Epoch: 2, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.269 Vali Acc: 0.084 Test Loss: 3.269 Test Acc: 0.084
Validation loss decreased (-0.058791 --> -0.083497).  Saving model ...
Epoch: 3 cost time: 3.493544578552246
Epoch: 3, Steps: 10 | Train Loss: 2.793 Vali Loss: 3.288 Vali Acc: 0.108 Test Loss: 3.288 Test Acc: 0.108
Validation loss decreased (-0.083497 --> -0.108202).  Saving model ...
Epoch: 4 cost time: 3.678067207336426
Epoch: 4, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.264 Vali Acc: 0.136 Test Loss: 3.264 Test Acc: 0.136
Validation loss decreased (-0.108202 --> -0.136438).  Saving model ...
Epoch: 5 cost time: 3.7090651988983154
Epoch: 5, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.247 Vali Acc: 0.153 Test Loss: 3.247 Test Acc: 0.153
Validation loss decreased (-0.136438 --> -0.152909).  Saving model ...
Epoch: 6 cost time: 3.189734697341919
Epoch: 6, Steps: 10 | Train Loss: 1.703 Vali Loss: 3.289 Vali Acc: 0.165 Test Loss: 3.289 Test Acc: 0.165
Validation loss decreased (-0.152909 --> -0.164673).  Saving model ...
Epoch: 7 cost time: 3.602412223815918
Epoch: 7, Steps: 10 | Train Loss: 1.397 Vali Loss: 3.405 Vali Acc: 0.172 Test Loss: 3.405 Test Acc: 0.172
Validation loss decreased (-0.164673 --> -0.171731).  Saving model ...
Epoch: 8 cost time: 3.4693779945373535
Epoch: 8, Steps: 10 | Train Loss: 1.095 Vali Loss: 3.406 Vali Acc: 0.200 Test Loss: 3.406 Test Acc: 0.200
Validation loss decreased (-0.171731 --> -0.199966).  Saving model ...
Epoch: 9 cost time: 3.497124195098877
Epoch: 9, Steps: 10 | Train Loss: 0.860 Vali Loss: 3.489 Vali Acc: 0.196 Test Loss: 3.489 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.427889347076416
Epoch: 10, Steps: 10 | Train Loss: 0.606 Vali Loss: 3.606 Vali Acc: 0.214 Test Loss: 3.606 Test Acc: 0.214
Validation loss decreased (-0.199966 --> -0.214082).  Saving model ...
Epoch: 11 cost time: 3.0556793212890625
Epoch: 11, Steps: 10 | Train Loss: 0.457 Vali Loss: 3.749 Vali Acc: 0.224 Test Loss: 3.749 Test Acc: 0.224
Validation loss decreased (-0.214082 --> -0.223492).  Saving model ...
Epoch: 12 cost time: 3.7216765880584717
Epoch: 12, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.790 Vali Acc: 0.233 Test Loss: 3.790 Test Acc: 0.233
Validation loss decreased (-0.223492 --> -0.232903).  Saving model ...
Epoch: 13 cost time: 3.469651699066162
Epoch: 13, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.865 Vali Acc: 0.240 Test Loss: 3.865 Test Acc: 0.240
Validation loss decreased (-0.232903 --> -0.239961).  Saving model ...
Epoch: 14 cost time: 3.625091075897217
Epoch: 14, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.047 Vali Acc: 0.247 Test Loss: 4.047 Test Acc: 0.247
Validation loss decreased (-0.239961 --> -0.247018).  Saving model ...
Epoch: 15 cost time: 3.274472951889038
Epoch: 15, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.150 Vali Acc: 0.240 Test Loss: 4.150 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4739389419555664
Epoch: 16, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.234 Vali Acc: 0.240 Test Loss: 4.234 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.290189743041992
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.305 Vali Acc: 0.253 Test Loss: 4.305 Test Acc: 0.253
Validation loss decreased (-0.247018 --> -0.252898).  Saving model ...
Epoch: 18 cost time: 2.846064805984497
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.370 Vali Acc: 0.253 Test Loss: 4.370 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1267800331115723
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.364 Vali Acc: 0.253 Test Loss: 4.364 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.845525026321411
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.423 Vali Acc: 0.252 Test Loss: 4.423 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.5043833255767822
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.462 Vali Acc: 0.258 Test Loss: 4.462 Test Acc: 0.258
Validation loss decreased (-0.252898 --> -0.257602).  Saving model ...
Epoch: 22 cost time: 3.698103189468384
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.501 Vali Acc: 0.265 Test Loss: 4.501 Test Acc: 0.265
Validation loss decreased (-0.257602 --> -0.264661).  Saving model ...
Epoch: 23 cost time: 3.234758138656616
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.542 Vali Acc: 0.259 Test Loss: 4.542 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.290435314178467
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.586 Vali Acc: 0.258 Test Loss: 4.586 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.4523723125457764
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.612 Vali Acc: 0.260 Test Loss: 4.612 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.143681049346924
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.641 Vali Acc: 0.259 Test Loss: 4.641 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.749513626098633
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.653 Vali Acc: 0.262 Test Loss: 4.653 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.274759292602539
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.670 Vali Acc: 0.267 Test Loss: 4.670 Test Acc: 0.267
Validation loss decreased (-0.264661 --> -0.267012).  Saving model ...
Epoch: 29 cost time: 3.544935464859009
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.684 Vali Acc: 0.266 Test Loss: 4.684 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.634847402572632
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.714 Vali Acc: 0.262 Test Loss: 4.714 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.991438388824463
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.751 Vali Acc: 0.265 Test Loss: 4.751 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.3554635047912598
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.779 Vali Acc: 0.264 Test Loss: 4.779 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.2339422702789307
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.793 Vali Acc: 0.266 Test Loss: 4.793 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.4726078510284424
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.814 Vali Acc: 0.267 Test Loss: 4.814 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.865828037261963
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.837 Vali Acc: 0.266 Test Loss: 4.837 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.382908821105957
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.857 Vali Acc: 0.268 Test Loss: 4.857 Test Acc: 0.268
Validation loss decreased (-0.267012 --> -0.268187).  Saving model ...
Epoch: 37 cost time: 3.333773136138916
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.875 Vali Acc: 0.267 Test Loss: 4.875 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.5405590534210205
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.888 Vali Acc: 0.269 Test Loss: 4.888 Test Acc: 0.269
Validation loss decreased (-0.268187 --> -0.269363).  Saving model ...
Epoch: 39 cost time: 2.9560751914978027
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.899 Vali Acc: 0.269 Test Loss: 4.899 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.3899848461151123
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.917 Vali Acc: 0.269 Test Loss: 4.917 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.6757078170776367
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.942 Vali Acc: 0.269 Test Loss: 4.942 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.5218939781188965
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.962 Vali Acc: 0.272 Test Loss: 4.962 Test Acc: 0.272
Validation loss decreased (-0.269363 --> -0.271715).  Saving model ...
Epoch: 43 cost time: 3.3958425521850586
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.975 Vali Acc: 0.272 Test Loss: 4.975 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.5986368656158447
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.985 Vali Acc: 0.269 Test Loss: 4.985 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.777198553085327
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.006 Vali Acc: 0.272 Test Loss: 5.006 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.595881223678589
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.015 Vali Acc: 0.272 Test Loss: 5.015 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.6544394493103027
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.028 Vali Acc: 0.268 Test Loss: 5.028 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.9429471492767334
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.040 Vali Acc: 0.268 Test Loss: 5.040 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.7536752223968506
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.057 Vali Acc: 0.269 Test Loss: 5.057 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.787696123123169
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.071 Vali Acc: 0.272 Test Loss: 5.071 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.6680283546447754
Epoch: 51, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.086 Vali Acc: 0.271 Test Loss: 5.086 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.466135263442993
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.094 Vali Acc: 0.271 Test Loss: 5.094 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 617114
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.9319117069244385
Epoch: 1, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.291 Vali Acc: 0.051 Test Loss: 3.291 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 3.6665797233581543
Epoch: 2, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.325 Vali Acc: 0.061 Test Loss: 3.325 Test Acc: 0.061
Validation loss decreased (-0.050555 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 3.533090353012085
Epoch: 3, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.372 Vali Acc: 0.064 Test Loss: 3.372 Test Acc: 0.064
Validation loss decreased (-0.061143 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 3.4183833599090576
Epoch: 4, Steps: 10 | Train Loss: 2.550 Vali Loss: 3.359 Vali Acc: 0.088 Test Loss: 3.359 Test Acc: 0.088
Validation loss decreased (-0.063496 --> -0.088202).  Saving model ...
Epoch: 5 cost time: 3.34405517578125
Epoch: 5, Steps: 10 | Train Loss: 2.163 Vali Loss: 3.341 Vali Acc: 0.099 Test Loss: 3.341 Test Acc: 0.099
Validation loss decreased (-0.088202 --> -0.098790).  Saving model ...
Epoch: 6 cost time: 2.9884257316589355
Epoch: 6, Steps: 10 | Train Loss: 1.845 Vali Loss: 3.360 Vali Acc: 0.105 Test Loss: 3.360 Test Acc: 0.105
Validation loss decreased (-0.098790 --> -0.104672).  Saving model ...
Epoch: 7 cost time: 3.6149661540985107
Epoch: 7, Steps: 10 | Train Loss: 1.460 Vali Loss: 3.473 Vali Acc: 0.099 Test Loss: 3.473 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.280608892440796
Epoch: 8, Steps: 10 | Train Loss: 1.120 Vali Loss: 3.509 Vali Acc: 0.121 Test Loss: 3.509 Test Acc: 0.121
Validation loss decreased (-0.104672 --> -0.121141).  Saving model ...
Epoch: 9 cost time: 3.8411171436309814
Epoch: 9, Steps: 10 | Train Loss: 0.880 Vali Loss: 3.628 Vali Acc: 0.114 Test Loss: 3.628 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8782949447631836
Epoch: 10, Steps: 10 | Train Loss: 0.611 Vali Loss: 3.749 Vali Acc: 0.131 Test Loss: 3.749 Test Acc: 0.131
Validation loss decreased (-0.121141 --> -0.130551).  Saving model ...
Epoch: 11 cost time: 3.998420238494873
Epoch: 11, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.939 Vali Acc: 0.124 Test Loss: 3.939 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.770073890686035
Epoch: 12, Steps: 10 | Train Loss: 0.255 Vali Loss: 4.052 Vali Acc: 0.138 Test Loss: 4.052 Test Acc: 0.138
Validation loss decreased (-0.130551 --> -0.137607).  Saving model ...
Epoch: 13 cost time: 3.2568199634552
Epoch: 13, Steps: 10 | Train Loss: 0.161 Vali Loss: 4.226 Vali Acc: 0.145 Test Loss: 4.226 Test Acc: 0.145
Validation loss decreased (-0.137607 --> -0.144664).  Saving model ...
Epoch: 14 cost time: 3.9362668991088867
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.392 Vali Acc: 0.146 Test Loss: 4.392 Test Acc: 0.146
Validation loss decreased (-0.144664 --> -0.145838).  Saving model ...
Epoch: 15 cost time: 3.7072854042053223
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.483 Vali Acc: 0.147 Test Loss: 4.483 Test Acc: 0.147
Validation loss decreased (-0.145838 --> -0.147014).  Saving model ...
Epoch: 16 cost time: 4.01757025718689
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.585 Vali Acc: 0.147 Test Loss: 4.585 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.3871495723724365
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.632 Vali Acc: 0.147 Test Loss: 4.632 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.6019160747528076
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.676 Vali Acc: 0.149 Test Loss: 4.676 Test Acc: 0.149
Validation loss decreased (-0.147014 --> -0.149365).  Saving model ...
Epoch: 19 cost time: 3.7521069049835205
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.699 Vali Acc: 0.154 Test Loss: 4.699 Test Acc: 0.154
Validation loss decreased (-0.149365 --> -0.154071).  Saving model ...
Epoch: 20 cost time: 3.6405742168426514
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.756 Vali Acc: 0.154 Test Loss: 4.756 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9387407302856445
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.792 Vali Acc: 0.154 Test Loss: 4.792 Test Acc: 0.154
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.768937349319458
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.819 Vali Acc: 0.162 Test Loss: 4.819 Test Acc: 0.162
Validation loss decreased (-0.154071 --> -0.162305).  Saving model ...
Epoch: 23 cost time: 3.478921413421631
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.832 Vali Acc: 0.164 Test Loss: 4.832 Test Acc: 0.164
Validation loss decreased (-0.162305 --> -0.163481).  Saving model ...
Epoch: 24 cost time: 3.9814469814300537
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.862 Vali Acc: 0.167 Test Loss: 4.862 Test Acc: 0.167
Validation loss decreased (-0.163481 --> -0.167010).  Saving model ...
Epoch: 25 cost time: 3.646561861038208
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.901 Vali Acc: 0.164 Test Loss: 4.901 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4375758171081543
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.933 Vali Acc: 0.158 Test Loss: 4.933 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.792471408843994
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.953 Vali Acc: 0.161 Test Loss: 4.953 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.075475692749023
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.977 Vali Acc: 0.161 Test Loss: 4.977 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.679532051086426
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.995 Vali Acc: 0.160 Test Loss: 4.995 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.695558547973633
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.023 Vali Acc: 0.159 Test Loss: 5.023 Test Acc: 0.159
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.483443260192871
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.057 Vali Acc: 0.159 Test Loss: 5.057 Test Acc: 0.159
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.532989978790283
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.078 Vali Acc: 0.159 Test Loss: 5.078 Test Acc: 0.159
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.7431089878082275
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.098 Vali Acc: 0.158 Test Loss: 5.098 Test Acc: 0.158
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.175537586212158
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.117 Vali Acc: 0.161 Test Loss: 5.117 Test Acc: 0.161
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16705882352941176
model parameter : 617114
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.02498722076416
Epoch: 1, Steps: 10 | Train Loss: 3.337 Vali Loss: 3.308 Vali Acc: 0.046 Test Loss: 3.308 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 3.6695289611816406
Epoch: 2, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.335 Vali Acc: 0.058 Test Loss: 3.335 Test Acc: 0.058
Validation loss decreased (-0.045849 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 3.6303892135620117
Epoch: 3, Steps: 10 | Train Loss: 3.006 Vali Loss: 3.387 Vali Acc: 0.046 Test Loss: 3.387 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5954604148864746
Epoch: 4, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.388 Vali Acc: 0.067 Test Loss: 3.388 Test Acc: 0.067
Validation loss decreased (-0.057614 --> -0.067025).  Saving model ...
Epoch: 5 cost time: 3.7557849884033203
Epoch: 5, Steps: 10 | Train Loss: 2.501 Vali Loss: 3.369 Vali Acc: 0.075 Test Loss: 3.369 Test Acc: 0.075
Validation loss decreased (-0.067025 --> -0.075260).  Saving model ...
Epoch: 6 cost time: 3.880279541015625
Epoch: 6, Steps: 10 | Train Loss: 2.230 Vali Loss: 3.367 Vali Acc: 0.076 Test Loss: 3.367 Test Acc: 0.076
Validation loss decreased (-0.075260 --> -0.076437).  Saving model ...
Epoch: 7 cost time: 4.091737508773804
Epoch: 7, Steps: 10 | Train Loss: 1.943 Vali Loss: 3.424 Vali Acc: 0.078 Test Loss: 3.424 Test Acc: 0.078
Validation loss decreased (-0.076437 --> -0.077613).  Saving model ...
Epoch: 8 cost time: 4.1154375076293945
Epoch: 8, Steps: 10 | Train Loss: 1.590 Vali Loss: 3.437 Vali Acc: 0.076 Test Loss: 3.437 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.903327226638794
Epoch: 9, Steps: 10 | Train Loss: 1.293 Vali Loss: 3.488 Vali Acc: 0.089 Test Loss: 3.488 Test Acc: 0.089
Validation loss decreased (-0.077613 --> -0.089377).  Saving model ...
Epoch: 10 cost time: 3.7258143424987793
Epoch: 10, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.567 Vali Acc: 0.086 Test Loss: 3.567 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4398887157440186
Epoch: 11, Steps: 10 | Train Loss: 0.762 Vali Loss: 3.719 Vali Acc: 0.084 Test Loss: 3.719 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.014538764953613
Epoch: 12, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.776 Vali Acc: 0.094 Test Loss: 3.776 Test Acc: 0.094
Validation loss decreased (-0.089377 --> -0.094080).  Saving model ...
Epoch: 13 cost time: 4.00283145904541
Epoch: 13, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.939 Vali Acc: 0.092 Test Loss: 3.939 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.837682008743286
Epoch: 14, Steps: 10 | Train Loss: 0.193 Vali Loss: 4.142 Vali Acc: 0.094 Test Loss: 4.142 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.842073440551758
Epoch: 15, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.288 Vali Acc: 0.096 Test Loss: 4.288 Test Acc: 0.096
Validation loss decreased (-0.094080 --> -0.096428).  Saving model ...
Epoch: 16 cost time: 3.6499085426330566
Epoch: 16, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.399 Vali Acc: 0.102 Test Loss: 4.399 Test Acc: 0.102
Validation loss decreased (-0.096428 --> -0.102309).  Saving model ...
Epoch: 17 cost time: 4.095207452774048
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.491 Vali Acc: 0.106 Test Loss: 4.491 Test Acc: 0.106
Validation loss decreased (-0.102309 --> -0.105837).  Saving model ...
Epoch: 18 cost time: 3.9759297370910645
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.555 Vali Acc: 0.102 Test Loss: 4.555 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7217934131622314
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.600 Vali Acc: 0.104 Test Loss: 4.600 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.9092931747436523
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.651 Vali Acc: 0.112 Test Loss: 4.651 Test Acc: 0.112
Validation loss decreased (-0.105837 --> -0.111718).  Saving model ...
Epoch: 21 cost time: 3.7944858074188232
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.680 Vali Acc: 0.109 Test Loss: 4.680 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8386142253875732
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.693 Vali Acc: 0.112 Test Loss: 4.693 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.8359739780426025
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.703 Vali Acc: 0.115 Test Loss: 4.703 Test Acc: 0.115
Validation loss decreased (-0.111718 --> -0.115247).  Saving model ...
Epoch: 24 cost time: 3.773921251296997
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.733 Vali Acc: 0.120 Test Loss: 4.733 Test Acc: 0.120
Validation loss decreased (-0.115247 --> -0.119953).  Saving model ...
Epoch: 25 cost time: 4.047430753707886
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.781 Vali Acc: 0.115 Test Loss: 4.781 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.199682235717773
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.831 Vali Acc: 0.113 Test Loss: 4.831 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.326235294342041
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.858 Vali Acc: 0.111 Test Loss: 4.858 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.3373959064483643
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.869 Vali Acc: 0.114 Test Loss: 4.869 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.3326075077056885
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.888 Vali Acc: 0.118 Test Loss: 4.888 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.7808640003204346
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.914 Vali Acc: 0.119 Test Loss: 4.914 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.854120969772339
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.936 Vali Acc: 0.120 Test Loss: 4.936 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.0156660079956055
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.951 Vali Acc: 0.120 Test Loss: 4.951 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.826143741607666
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.969 Vali Acc: 0.119 Test Loss: 4.969 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.018362045288086
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.983 Vali Acc: 0.120 Test Loss: 4.983 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12
model parameter : 617114
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.849636793136597
Epoch: 1, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.316 Vali Acc: 0.044 Test Loss: 3.316 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 3.2943131923675537
Epoch: 2, Steps: 10 | Train Loss: 3.277 Vali Loss: 3.338 Vali Acc: 0.044 Test Loss: 3.338 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5784993171691895
Epoch: 3, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.373 Vali Acc: 0.048 Test Loss: 3.373 Test Acc: 0.048
Validation loss decreased (-0.043496 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 3.5591752529144287
Epoch: 4, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.392 Vali Acc: 0.060 Test Loss: 3.392 Test Acc: 0.060
Validation loss decreased (-0.048202 --> -0.059966).  Saving model ...
Epoch: 5 cost time: 4.045051097869873
Epoch: 5, Steps: 10 | Train Loss: 2.743 Vali Loss: 3.375 Vali Acc: 0.064 Test Loss: 3.375 Test Acc: 0.064
Validation loss decreased (-0.059966 --> -0.063496).  Saving model ...
Epoch: 6 cost time: 3.721203565597534
Epoch: 6, Steps: 10 | Train Loss: 2.586 Vali Loss: 3.351 Vali Acc: 0.064 Test Loss: 3.351 Test Acc: 0.064
Validation loss decreased (-0.063496 --> -0.063496).  Saving model ...
Epoch: 7 cost time: 3.3830504417419434
Epoch: 7, Steps: 10 | Train Loss: 2.361 Vali Loss: 3.365 Vali Acc: 0.071 Test Loss: 3.365 Test Acc: 0.071
Validation loss decreased (-0.063496 --> -0.070555).  Saving model ...
Epoch: 8 cost time: 4.150859594345093
Epoch: 8, Steps: 10 | Train Loss: 2.082 Vali Loss: 3.363 Vali Acc: 0.084 Test Loss: 3.363 Test Acc: 0.084
Validation loss decreased (-0.070555 --> -0.083496).  Saving model ...
Epoch: 9 cost time: 3.5717856884002686
Epoch: 9, Steps: 10 | Train Loss: 1.800 Vali Loss: 3.395 Vali Acc: 0.082 Test Loss: 3.395 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2091259956359863
Epoch: 10, Steps: 10 | Train Loss: 1.546 Vali Loss: 3.438 Vali Acc: 0.087 Test Loss: 3.438 Test Acc: 0.087
Validation loss decreased (-0.083496 --> -0.087024).  Saving model ...
Epoch: 11 cost time: 3.8833839893341064
Epoch: 11, Steps: 10 | Train Loss: 1.243 Vali Loss: 3.548 Vali Acc: 0.086 Test Loss: 3.548 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8306753635406494
Epoch: 12, Steps: 10 | Train Loss: 0.998 Vali Loss: 3.624 Vali Acc: 0.095 Test Loss: 3.624 Test Acc: 0.095
Validation loss decreased (-0.087024 --> -0.095258).  Saving model ...
Epoch: 13 cost time: 3.8060197830200195
Epoch: 13, Steps: 10 | Train Loss: 0.689 Vali Loss: 3.711 Vali Acc: 0.098 Test Loss: 3.711 Test Acc: 0.098
Validation loss decreased (-0.095258 --> -0.097610).  Saving model ...
Epoch: 14 cost time: 3.6906588077545166
Epoch: 14, Steps: 10 | Train Loss: 0.480 Vali Loss: 3.879 Vali Acc: 0.104 Test Loss: 3.879 Test Acc: 0.104
Validation loss decreased (-0.097610 --> -0.103491).  Saving model ...
Epoch: 15 cost time: 3.6817870140075684
Epoch: 15, Steps: 10 | Train Loss: 0.329 Vali Loss: 4.065 Vali Acc: 0.100 Test Loss: 4.065 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8096718788146973
Epoch: 16, Steps: 10 | Train Loss: 0.191 Vali Loss: 4.236 Vali Acc: 0.100 Test Loss: 4.236 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.148815870285034
Epoch: 17, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.391 Vali Acc: 0.105 Test Loss: 4.391 Test Acc: 0.105
Validation loss decreased (-0.103491 --> -0.104662).  Saving model ...
Epoch: 18 cost time: 3.7787420749664307
Epoch: 18, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.483 Vali Acc: 0.094 Test Loss: 4.483 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6349618434906006
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.545 Vali Acc: 0.106 Test Loss: 4.545 Test Acc: 0.106
Validation loss decreased (-0.104662 --> -0.105837).  Saving model ...
Epoch: 20 cost time: 3.3874425888061523
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.615 Vali Acc: 0.116 Test Loss: 4.615 Test Acc: 0.116
Validation loss decreased (-0.105837 --> -0.116424).  Saving model ...
Epoch: 21 cost time: 3.4070916175842285
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.649 Vali Acc: 0.121 Test Loss: 4.649 Test Acc: 0.121
Validation loss decreased (-0.116424 --> -0.121130).  Saving model ...
Epoch: 22 cost time: 3.849857807159424
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.659 Vali Acc: 0.118 Test Loss: 4.659 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4954938888549805
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.702 Vali Acc: 0.119 Test Loss: 4.702 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.7147326469421387
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.737 Vali Acc: 0.124 Test Loss: 4.737 Test Acc: 0.124
Validation loss decreased (-0.121130 --> -0.123482).  Saving model ...
Epoch: 25 cost time: 3.617478370666504
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.763 Vali Acc: 0.124 Test Loss: 4.763 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.5501608848571777
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.817 Vali Acc: 0.119 Test Loss: 4.817 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.488743782043457
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.846 Vali Acc: 0.121 Test Loss: 4.846 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.66898775100708
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.866 Vali Acc: 0.120 Test Loss: 4.866 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.5513908863067627
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.875 Vali Acc: 0.121 Test Loss: 4.875 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.363081693649292
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.892 Vali Acc: 0.121 Test Loss: 4.892 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.9683594703674316
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.922 Vali Acc: 0.118 Test Loss: 4.922 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.754025936126709
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.942 Vali Acc: 0.125 Test Loss: 4.942 Test Acc: 0.125
Validation loss decreased (-0.123482 --> -0.124656).  Saving model ...
Epoch: 33 cost time: 3.766058921813965
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.959 Vali Acc: 0.121 Test Loss: 4.959 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.2850723266601562
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.964 Vali Acc: 0.124 Test Loss: 4.964 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.6831915378570557
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.988 Vali Acc: 0.122 Test Loss: 4.988 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.2886784076690674
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.000 Vali Acc: 0.124 Test Loss: 5.000 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.520747184753418
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.026 Vali Acc: 0.122 Test Loss: 5.026 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.5470798015594482
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.051 Vali Acc: 0.120 Test Loss: 5.051 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.597302198410034
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.068 Vali Acc: 0.121 Test Loss: 5.068 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.4620814323425293
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.076 Vali Acc: 0.122 Test Loss: 5.076 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.399155855178833
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.089 Vali Acc: 0.120 Test Loss: 5.089 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.578864812850952
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.103 Vali Acc: 0.125 Test Loss: 5.103 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12470588235294118
model parameter : 617114
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.074494361877441
Epoch: 1, Steps: 10 | Train Loss: 3.439 Vali Loss: 3.328 Vali Acc: 0.034 Test Loss: 3.328 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 3.6132314205169678
Epoch: 2, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.350 Vali Acc: 0.038 Test Loss: 3.350 Test Acc: 0.038
Validation loss decreased (-0.034084 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 3.3716652393341064
Epoch: 3, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.392 Vali Acc: 0.041 Test Loss: 3.392 Test Acc: 0.041
Validation loss decreased (-0.037614 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 3.3739066123962402
Epoch: 4, Steps: 10 | Train Loss: 3.031 Vali Loss: 3.412 Vali Acc: 0.053 Test Loss: 3.412 Test Acc: 0.053
Validation loss decreased (-0.041143 --> -0.052907).  Saving model ...
Epoch: 5 cost time: 3.670276641845703
Epoch: 5, Steps: 10 | Train Loss: 2.853 Vali Loss: 3.397 Vali Acc: 0.051 Test Loss: 3.397 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.662283182144165
Epoch: 6, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.374 Vali Acc: 0.066 Test Loss: 3.374 Test Acc: 0.066
Validation loss decreased (-0.052907 --> -0.065849).  Saving model ...
Epoch: 7 cost time: 3.893453598022461
Epoch: 7, Steps: 10 | Train Loss: 2.571 Vali Loss: 3.370 Vali Acc: 0.072 Test Loss: 3.370 Test Acc: 0.072
Validation loss decreased (-0.065849 --> -0.071731).  Saving model ...
Epoch: 8 cost time: 3.2049028873443604
Epoch: 8, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.355 Vali Acc: 0.079 Test Loss: 3.355 Test Acc: 0.079
Validation loss decreased (-0.071731 --> -0.078790).  Saving model ...
Epoch: 9 cost time: 4.2012481689453125
Epoch: 9, Steps: 10 | Train Loss: 2.126 Vali Loss: 3.369 Vali Acc: 0.081 Test Loss: 3.369 Test Acc: 0.081
Validation loss decreased (-0.078790 --> -0.081143).  Saving model ...
Epoch: 10 cost time: 3.6356706619262695
Epoch: 10, Steps: 10 | Train Loss: 1.947 Vali Loss: 3.381 Vali Acc: 0.089 Test Loss: 3.381 Test Acc: 0.089
Validation loss decreased (-0.081143 --> -0.089378).  Saving model ...
Epoch: 11 cost time: 3.551558256149292
Epoch: 11, Steps: 10 | Train Loss: 1.651 Vali Loss: 3.440 Vali Acc: 0.093 Test Loss: 3.440 Test Acc: 0.093
Validation loss decreased (-0.089378 --> -0.092907).  Saving model ...
Epoch: 12 cost time: 3.6937413215637207
Epoch: 12, Steps: 10 | Train Loss: 1.405 Vali Loss: 3.465 Vali Acc: 0.095 Test Loss: 3.465 Test Acc: 0.095
Validation loss decreased (-0.092907 --> -0.095259).  Saving model ...
Epoch: 13 cost time: 3.6045682430267334
Epoch: 13, Steps: 10 | Train Loss: 1.093 Vali Loss: 3.507 Vali Acc: 0.099 Test Loss: 3.507 Test Acc: 0.099
Validation loss decreased (-0.095259 --> -0.098788).  Saving model ...
Epoch: 14 cost time: 4.065773010253906
Epoch: 14, Steps: 10 | Train Loss: 0.826 Vali Loss: 3.642 Vali Acc: 0.092 Test Loss: 3.642 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9983160495758057
Epoch: 15, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.766 Vali Acc: 0.100 Test Loss: 3.766 Test Acc: 0.100
Validation loss decreased (-0.098788 --> -0.099962).  Saving model ...
Epoch: 16 cost time: 3.5885121822357178
Epoch: 16, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.885 Vali Acc: 0.102 Test Loss: 3.885 Test Acc: 0.102
Validation loss decreased (-0.099962 --> -0.102314).  Saving model ...
Epoch: 17 cost time: 3.643183469772339
Epoch: 17, Steps: 10 | Train Loss: 0.268 Vali Loss: 4.037 Vali Acc: 0.106 Test Loss: 4.037 Test Acc: 0.106
Validation loss decreased (-0.102314 --> -0.105842).  Saving model ...
Epoch: 18 cost time: 3.4191575050354004
Epoch: 18, Steps: 10 | Train Loss: 0.175 Vali Loss: 4.172 Vali Acc: 0.105 Test Loss: 4.172 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8064677715301514
Epoch: 19, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.273 Vali Acc: 0.102 Test Loss: 4.273 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.591512680053711
Epoch: 20, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.337 Vali Acc: 0.113 Test Loss: 4.337 Test Acc: 0.113
Validation loss decreased (-0.105842 --> -0.112898).  Saving model ...
Epoch: 21 cost time: 3.513364553451538
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.358 Vali Acc: 0.115 Test Loss: 4.358 Test Acc: 0.115
Validation loss decreased (-0.112898 --> -0.115251).  Saving model ...
Epoch: 22 cost time: 3.191248655319214
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.390 Vali Acc: 0.114 Test Loss: 4.390 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.7168688774108887
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.458 Vali Acc: 0.115 Test Loss: 4.458 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.6889915466308594
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.497 Vali Acc: 0.119 Test Loss: 4.497 Test Acc: 0.119
Validation loss decreased (-0.115251 --> -0.118779).  Saving model ...
Epoch: 25 cost time: 3.7840065956115723
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.519 Vali Acc: 0.121 Test Loss: 4.519 Test Acc: 0.121
Validation loss decreased (-0.118779 --> -0.121131).  Saving model ...
Epoch: 26 cost time: 3.8408381938934326
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.566 Vali Acc: 0.124 Test Loss: 4.566 Test Acc: 0.124
Validation loss decreased (-0.121131 --> -0.123484).  Saving model ...
Epoch: 27 cost time: 3.476212739944458
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.595 Vali Acc: 0.121 Test Loss: 4.595 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.247163772583008
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.597 Vali Acc: 0.125 Test Loss: 4.597 Test Acc: 0.125
Validation loss decreased (-0.123484 --> -0.124660).  Saving model ...
Epoch: 29 cost time: 3.4482553005218506
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.609 Vali Acc: 0.124 Test Loss: 4.609 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.8398361206054688
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.635 Vali Acc: 0.129 Test Loss: 4.635 Test Acc: 0.129
Validation loss decreased (-0.124660 --> -0.129365).  Saving model ...
Epoch: 31 cost time: 3.6905934810638428
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.673 Vali Acc: 0.128 Test Loss: 4.673 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.495617628097534
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.689 Vali Acc: 0.126 Test Loss: 4.689 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.6504673957824707
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.712 Vali Acc: 0.122 Test Loss: 4.712 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.6422038078308105
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.718 Vali Acc: 0.126 Test Loss: 4.718 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 4.016859531402588
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.721 Vali Acc: 0.127 Test Loss: 4.721 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.888695001602173
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.728 Vali Acc: 0.131 Test Loss: 4.728 Test Acc: 0.131
Validation loss decreased (-0.129365 --> -0.130541).  Saving model ...
Epoch: 37 cost time: 3.945662260055542
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.761 Vali Acc: 0.132 Test Loss: 4.761 Test Acc: 0.132
Validation loss decreased (-0.130541 --> -0.131717).  Saving model ...
Epoch: 38 cost time: 3.8945398330688477
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.794 Vali Acc: 0.129 Test Loss: 4.794 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.785313606262207
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.798 Vali Acc: 0.131 Test Loss: 4.798 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.561311960220337
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.803 Vali Acc: 0.128 Test Loss: 4.803 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.9533233642578125
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.822 Vali Acc: 0.127 Test Loss: 4.822 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.990307092666626
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.836 Vali Acc: 0.128 Test Loss: 4.836 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.3463261127471924
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.859 Vali Acc: 0.125 Test Loss: 4.859 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.4672863483428955
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.868 Vali Acc: 0.128 Test Loss: 4.868 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.674196720123291
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.890 Vali Acc: 0.129 Test Loss: 4.890 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.4997265338897705
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.894 Vali Acc: 0.126 Test Loss: 4.894 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.6516125202178955
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.894 Vali Acc: 0.125 Test Loss: 4.894 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13176470588235295
model parameter : 617114
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.175672292709351
Epoch: 1, Steps: 10 | Train Loss: 3.384 Vali Loss: 3.313 Vali Acc: 0.049 Test Loss: 3.313 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 3.474364757537842
Epoch: 2, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.336 Vali Acc: 0.038 Test Loss: 3.336 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6771833896636963
Epoch: 3, Steps: 10 | Train Loss: 3.215 Vali Loss: 3.391 Vali Acc: 0.042 Test Loss: 3.391 Test Acc: 0.042
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7030701637268066
Epoch: 4, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.418 Vali Acc: 0.051 Test Loss: 3.418 Test Acc: 0.051
Validation loss decreased (-0.049379 --> -0.050554).  Saving model ...
Epoch: 5 cost time: 3.2913978099823
Epoch: 5, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.415 Vali Acc: 0.053 Test Loss: 3.415 Test Acc: 0.053
Validation loss decreased (-0.050554 --> -0.052907).  Saving model ...
Epoch: 6 cost time: 3.5012030601501465
Epoch: 6, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.390 Vali Acc: 0.053 Test Loss: 3.390 Test Acc: 0.053
Validation loss decreased (-0.052907 --> -0.052907).  Saving model ...
Epoch: 7 cost time: 3.7054758071899414
Epoch: 7, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.399 Vali Acc: 0.065 Test Loss: 3.399 Test Acc: 0.065
Validation loss decreased (-0.052907 --> -0.064672).  Saving model ...
Epoch: 8 cost time: 3.8359298706054688
Epoch: 8, Steps: 10 | Train Loss: 2.553 Vali Loss: 3.369 Vali Acc: 0.066 Test Loss: 3.369 Test Acc: 0.066
Validation loss decreased (-0.064672 --> -0.065849).  Saving model ...
Epoch: 9 cost time: 3.8604700565338135
Epoch: 9, Steps: 10 | Train Loss: 2.326 Vali Loss: 3.372 Vali Acc: 0.073 Test Loss: 3.372 Test Acc: 0.073
Validation loss decreased (-0.065849 --> -0.072907).  Saving model ...
Epoch: 10 cost time: 4.016622066497803
Epoch: 10, Steps: 10 | Train Loss: 2.100 Vali Loss: 3.388 Vali Acc: 0.072 Test Loss: 3.388 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.582016944885254
Epoch: 11, Steps: 10 | Train Loss: 1.901 Vali Loss: 3.447 Vali Acc: 0.079 Test Loss: 3.447 Test Acc: 0.079
Validation loss decreased (-0.072907 --> -0.078789).  Saving model ...
Epoch: 12 cost time: 3.638040065765381
Epoch: 12, Steps: 10 | Train Loss: 1.716 Vali Loss: 3.466 Vali Acc: 0.091 Test Loss: 3.466 Test Acc: 0.091
Validation loss decreased (-0.078789 --> -0.090554).  Saving model ...
Epoch: 13 cost time: 4.0230629444122314
Epoch: 13, Steps: 10 | Train Loss: 1.376 Vali Loss: 3.511 Vali Acc: 0.100 Test Loss: 3.511 Test Acc: 0.100
Validation loss decreased (-0.090554 --> -0.099965).  Saving model ...
Epoch: 14 cost time: 3.50850772857666
Epoch: 14, Steps: 10 | Train Loss: 1.074 Vali Loss: 3.625 Vali Acc: 0.104 Test Loss: 3.625 Test Acc: 0.104
Validation loss decreased (-0.099965 --> -0.103493).  Saving model ...
Epoch: 15 cost time: 3.558269500732422
Epoch: 15, Steps: 10 | Train Loss: 0.834 Vali Loss: 3.763 Vali Acc: 0.102 Test Loss: 3.763 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3539254665374756
Epoch: 16, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.836 Vali Acc: 0.109 Test Loss: 3.836 Test Acc: 0.109
Validation loss decreased (-0.103493 --> -0.109373).  Saving model ...
Epoch: 17 cost time: 3.5974063873291016
Epoch: 17, Steps: 10 | Train Loss: 0.447 Vali Loss: 3.995 Vali Acc: 0.111 Test Loss: 3.995 Test Acc: 0.111
Validation loss decreased (-0.109373 --> -0.110548).  Saving model ...
Epoch: 18 cost time: 3.9131417274475098
Epoch: 18, Steps: 10 | Train Loss: 0.314 Vali Loss: 4.096 Vali Acc: 0.115 Test Loss: 4.096 Test Acc: 0.115
Validation loss decreased (-0.110548 --> -0.115253).  Saving model ...
Epoch: 19 cost time: 3.621647596359253
Epoch: 19, Steps: 10 | Train Loss: 0.231 Vali Loss: 4.199 Vali Acc: 0.116 Test Loss: 4.199 Test Acc: 0.116
Validation loss decreased (-0.115253 --> -0.116429).  Saving model ...
Epoch: 20 cost time: 3.387744903564453
Epoch: 20, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.322 Vali Acc: 0.125 Test Loss: 4.322 Test Acc: 0.125
Validation loss decreased (-0.116429 --> -0.124663).  Saving model ...
Epoch: 21 cost time: 3.5492162704467773
Epoch: 21, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.422 Vali Acc: 0.127 Test Loss: 4.422 Test Acc: 0.127
Validation loss decreased (-0.124663 --> -0.127015).  Saving model ...
Epoch: 22 cost time: 3.4946744441986084
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.485 Vali Acc: 0.129 Test Loss: 4.485 Test Acc: 0.129
Validation loss decreased (-0.127015 --> -0.129367).  Saving model ...
Epoch: 23 cost time: 3.848658561706543
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.526 Vali Acc: 0.136 Test Loss: 4.526 Test Acc: 0.136
Validation loss decreased (-0.129367 --> -0.136425).  Saving model ...
Epoch: 24 cost time: 3.8418729305267334
Epoch: 24, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.556 Vali Acc: 0.141 Test Loss: 4.556 Test Acc: 0.141
Validation loss decreased (-0.136425 --> -0.141131).  Saving model ...
Epoch: 25 cost time: 3.2879886627197266
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.609 Vali Acc: 0.135 Test Loss: 4.609 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.183326959609985
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.677 Vali Acc: 0.140 Test Loss: 4.677 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8521270751953125
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.720 Vali Acc: 0.140 Test Loss: 4.720 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.274780511856079
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.741 Vali Acc: 0.146 Test Loss: 4.741 Test Acc: 0.146
Validation loss decreased (-0.141131 --> -0.145835).  Saving model ...
Epoch: 29 cost time: 3.531623125076294
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.770 Vali Acc: 0.149 Test Loss: 4.770 Test Acc: 0.149
Validation loss decreased (-0.145835 --> -0.149364).  Saving model ...
Epoch: 30 cost time: 3.9902069568634033
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.792 Vali Acc: 0.144 Test Loss: 4.792 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.7303354740142822
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.808 Vali Acc: 0.145 Test Loss: 4.808 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.8753559589385986
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.815 Vali Acc: 0.142 Test Loss: 4.815 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3820106983184814
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.814 Vali Acc: 0.148 Test Loss: 4.814 Test Acc: 0.148
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.3785510063171387
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.829 Vali Acc: 0.152 Test Loss: 4.829 Test Acc: 0.152
Validation loss decreased (-0.149364 --> -0.151716).  Saving model ...
Epoch: 35 cost time: 3.658083200454712
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.871 Vali Acc: 0.149 Test Loss: 4.871 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.5272228717803955
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.880 Vali Acc: 0.148 Test Loss: 4.880 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.4448533058166504
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.895 Vali Acc: 0.147 Test Loss: 4.895 Test Acc: 0.147
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.808429002761841
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.909 Vali Acc: 0.147 Test Loss: 4.909 Test Acc: 0.147
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.019263029098511
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.931 Vali Acc: 0.147 Test Loss: 4.931 Test Acc: 0.147
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.7067716121673584
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.940 Vali Acc: 0.149 Test Loss: 4.940 Test Acc: 0.149
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.989626407623291
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.965 Vali Acc: 0.152 Test Loss: 4.965 Test Acc: 0.152
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.8108572959899902
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.981 Vali Acc: 0.149 Test Loss: 4.981 Test Acc: 0.149
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.1334335803985596
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.985 Vali Acc: 0.148 Test Loss: 4.985 Test Acc: 0.148
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.6829497814178467
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.996 Vali Acc: 0.148 Test Loss: 4.996 Test Acc: 0.148
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15176470588235294
model parameter : 617114
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.653939723968506
Epoch: 1, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 3.392664909362793
Epoch: 2, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 3 cost time: 4.483378887176514
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 4 cost time: 4.027872323989868
Epoch: 4, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 5 cost time: 3.476353406906128
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 6 cost time: 3.697450876235962
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 7 cost time: 3.2950544357299805
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 8 cost time: 3.606671094894409
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 9 cost time: 3.598815441131592
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 10 cost time: 3.8931546211242676
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 11 cost time: 3.7220818996429443
Epoch: 11, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 12 cost time: 4.216918230056763
Epoch: 12, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 13 cost time: 3.940556764602661
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.034085 --> -0.035262).  Saving model ...
Epoch: 14 cost time: 3.9771440029144287
Epoch: 14, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 15 cost time: 3.5970029830932617
Epoch: 15, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 16 cost time: 3.5401437282562256
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 17 cost time: 3.4621737003326416
Epoch: 17, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 18 cost time: 3.790163040161133
Epoch: 18, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 19 cost time: 3.896437406539917
Epoch: 19, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 20 cost time: 3.880897283554077
Epoch: 20, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 21 cost time: 3.8226027488708496
Epoch: 21, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 22 cost time: 4.026437759399414
Epoch: 22, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 23 cost time: 3.541297674179077
Epoch: 23, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 24 cost time: 3.691995143890381
Epoch: 24, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 25 cost time: 3.5200109481811523
Epoch: 25, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 26 cost time: 3.4918057918548584
Epoch: 26, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 27 cost time: 3.640219211578369
Epoch: 27, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 28 cost time: 4.002733469009399
Epoch: 28, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 29 cost time: 3.6940577030181885
Epoch: 29, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.035262 --> -0.037614).  Saving model ...
Epoch: 30 cost time: 3.6450159549713135
Epoch: 30, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 31 cost time: 3.782973289489746
Epoch: 31, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.6714982986450195
Epoch: 32, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.6164751052856445
Epoch: 33, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 34 cost time: 4.0500102043151855
Epoch: 34, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 35 cost time: 3.406224489212036
Epoch: 35, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 36 cost time: 3.779132127761841
Epoch: 36, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.8634443283081055
Epoch: 37, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.6740894317626953
Epoch: 38, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 39 cost time: 3.2830183506011963
Epoch: 39, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.6542983055114746
Epoch: 40, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.879225969314575
Epoch: 41, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 42 cost time: 3.5865256786346436
Epoch: 42, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 43 cost time: 3.4604809284210205
Epoch: 43, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 44 cost time: 3.6339075565338135
Epoch: 44, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.8344802856445312
Epoch: 45, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.6527371406555176
Epoch: 46, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.872286796569824
Epoch: 47, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.6880128383636475
Epoch: 48, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.6570372581481934
Epoch: 49, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.950155258178711
Epoch: 50, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.3344759941101074
Epoch: 51, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.438652753829956
Epoch: 52, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.9363765716552734
Epoch: 53, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.03764705882352941
model parameter : 617114
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.512851715087891
Epoch: 1, Steps: 10 | Train Loss: 3.357 Vali Loss: 3.275 Vali Acc: 0.047 Test Loss: 3.275 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 3.6744275093078613
Epoch: 2, Steps: 10 | Train Loss: 3.107 Vali Loss: 3.257 Vali Acc: 0.076 Test Loss: 3.257 Test Acc: 0.076
Validation loss decreased (-0.047026 --> -0.076438).  Saving model ...
Epoch: 3 cost time: 3.981259822845459
Epoch: 3, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.260 Vali Acc: 0.109 Test Loss: 3.260 Test Acc: 0.109
Validation loss decreased (-0.076438 --> -0.109379).  Saving model ...
Epoch: 4 cost time: 3.4494705200195312
Epoch: 4, Steps: 10 | Train Loss: 2.416 Vali Loss: 3.202 Vali Acc: 0.145 Test Loss: 3.202 Test Acc: 0.145
Validation loss decreased (-0.109379 --> -0.144674).  Saving model ...
Epoch: 5 cost time: 3.411271333694458
Epoch: 5, Steps: 10 | Train Loss: 1.966 Vali Loss: 3.102 Vali Acc: 0.188 Test Loss: 3.102 Test Acc: 0.188
Validation loss decreased (-0.144674 --> -0.188204).  Saving model ...
Epoch: 6 cost time: 3.550762414932251
Epoch: 6, Steps: 10 | Train Loss: 1.584 Vali Loss: 3.076 Vali Acc: 0.209 Test Loss: 3.076 Test Acc: 0.209
Validation loss decreased (-0.188204 --> -0.209381).  Saving model ...
Epoch: 7 cost time: 3.8860418796539307
Epoch: 7, Steps: 10 | Train Loss: 1.238 Vali Loss: 3.147 Vali Acc: 0.220 Test Loss: 3.147 Test Acc: 0.220
Validation loss decreased (-0.209381 --> -0.219969).  Saving model ...
Epoch: 8 cost time: 3.878450632095337
Epoch: 8, Steps: 10 | Train Loss: 0.942 Vali Loss: 3.160 Vali Acc: 0.252 Test Loss: 3.160 Test Acc: 0.252
Validation loss decreased (-0.219969 --> -0.251733).  Saving model ...
Epoch: 9 cost time: 4.025185585021973
Epoch: 9, Steps: 10 | Train Loss: 0.660 Vali Loss: 3.200 Vali Acc: 0.260 Test Loss: 3.200 Test Acc: 0.260
Validation loss decreased (-0.251733 --> -0.259968).  Saving model ...
Epoch: 10 cost time: 4.223909616470337
Epoch: 10, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.264 Vali Acc: 0.274 Test Loss: 3.264 Test Acc: 0.274
Validation loss decreased (-0.259968 --> -0.274085).  Saving model ...
Epoch: 11 cost time: 4.33191180229187
Epoch: 11, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.385 Vali Acc: 0.276 Test Loss: 3.385 Test Acc: 0.276
Validation loss decreased (-0.274085 --> -0.276437).  Saving model ...
Epoch: 12 cost time: 3.629373073577881
Epoch: 12, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.466 Vali Acc: 0.288 Test Loss: 3.466 Test Acc: 0.288
Validation loss decreased (-0.276437 --> -0.288201).  Saving model ...
Epoch: 13 cost time: 4.126879453659058
Epoch: 13, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.493 Vali Acc: 0.292 Test Loss: 3.493 Test Acc: 0.292
Validation loss decreased (-0.288201 --> -0.291730).  Saving model ...
Epoch: 14 cost time: 4.213636875152588
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.632 Vali Acc: 0.292 Test Loss: 3.632 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9171059131622314
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.661 Vali Acc: 0.298 Test Loss: 3.661 Test Acc: 0.298
Validation loss decreased (-0.291730 --> -0.297610).  Saving model ...
Epoch: 16 cost time: 3.725684642791748
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.708 Vali Acc: 0.305 Test Loss: 3.708 Test Acc: 0.305
Validation loss decreased (-0.297610 --> -0.304669).  Saving model ...
Epoch: 17 cost time: 3.501056671142578
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.742 Vali Acc: 0.306 Test Loss: 3.742 Test Acc: 0.306
Validation loss decreased (-0.304669 --> -0.305845).  Saving model ...
Epoch: 18 cost time: 4.005887746810913
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.799 Vali Acc: 0.302 Test Loss: 3.799 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7827982902526855
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.846 Vali Acc: 0.302 Test Loss: 3.846 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.926330327987671
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.871 Vali Acc: 0.315 Test Loss: 3.871 Test Acc: 0.315
Validation loss decreased (-0.305845 --> -0.315255).  Saving model ...
Epoch: 21 cost time: 3.450697183609009
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.878 Vali Acc: 0.318 Test Loss: 3.878 Test Acc: 0.318
Validation loss decreased (-0.315255 --> -0.317608).  Saving model ...
Epoch: 22 cost time: 3.602670907974243
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.898 Vali Acc: 0.312 Test Loss: 3.898 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5636167526245117
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.938 Vali Acc: 0.314 Test Loss: 3.938 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5345611572265625
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.946 Vali Acc: 0.314 Test Loss: 3.946 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.697340250015259
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.974 Vali Acc: 0.311 Test Loss: 3.974 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.545499324798584
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.002 Vali Acc: 0.311 Test Loss: 4.002 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.8253326416015625
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.025 Vali Acc: 0.313 Test Loss: 4.025 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.767658233642578
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.042 Vali Acc: 0.316 Test Loss: 4.042 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.626343011856079
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.058 Vali Acc: 0.321 Test Loss: 4.058 Test Acc: 0.321
Validation loss decreased (-0.317608 --> -0.321136).  Saving model ...
Epoch: 30 cost time: 3.452665090560913
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.078 Vali Acc: 0.325 Test Loss: 4.078 Test Acc: 0.325
Validation loss decreased (-0.321136 --> -0.324665).  Saving model ...
Epoch: 31 cost time: 3.8276994228363037
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.094 Vali Acc: 0.326 Test Loss: 4.094 Test Acc: 0.326
Validation loss decreased (-0.324665 --> -0.325841).  Saving model ...
Epoch: 32 cost time: 3.7901251316070557
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.108 Vali Acc: 0.325 Test Loss: 4.108 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.4039418697357178
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.124 Vali Acc: 0.325 Test Loss: 4.124 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.867514133453369
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.139 Vali Acc: 0.324 Test Loss: 4.139 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.7815675735473633
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.152 Vali Acc: 0.324 Test Loss: 4.152 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 4.091220378875732
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.168 Vali Acc: 0.322 Test Loss: 4.168 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.767202138900757
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.187 Vali Acc: 0.322 Test Loss: 4.187 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.135319948196411
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.204 Vali Acc: 0.322 Test Loss: 4.204 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.8893446922302246
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.218 Vali Acc: 0.322 Test Loss: 4.218 Test Acc: 0.322
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.897963523864746
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.236 Vali Acc: 0.321 Test Loss: 4.236 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.7869935035705566
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.253 Vali Acc: 0.324 Test Loss: 4.253 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 518810
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.924798965454102
Epoch: 1, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.292 Vali Acc: 0.042 Test Loss: 3.292 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 3.1688072681427
Epoch: 2, Steps: 10 | Train Loss: 3.086 Vali Loss: 3.279 Vali Acc: 0.072 Test Loss: 3.279 Test Acc: 0.072
Validation loss decreased (-0.042320 --> -0.071732).  Saving model ...
Epoch: 3 cost time: 3.716020345687866
Epoch: 3, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.282 Vali Acc: 0.118 Test Loss: 3.282 Test Acc: 0.118
Validation loss decreased (-0.071732 --> -0.117614).  Saving model ...
Epoch: 4 cost time: 3.8036341667175293
Epoch: 4, Steps: 10 | Train Loss: 2.435 Vali Loss: 3.221 Vali Acc: 0.166 Test Loss: 3.221 Test Acc: 0.166
Validation loss decreased (-0.117614 --> -0.165850).  Saving model ...
Epoch: 5 cost time: 3.358734369277954
Epoch: 5, Steps: 10 | Train Loss: 1.989 Vali Loss: 3.121 Vali Acc: 0.205 Test Loss: 3.121 Test Acc: 0.205
Validation loss decreased (-0.165850 --> -0.204675).  Saving model ...
Epoch: 6 cost time: 3.3495702743530273
Epoch: 6, Steps: 10 | Train Loss: 1.597 Vali Loss: 3.096 Vali Acc: 0.220 Test Loss: 3.096 Test Acc: 0.220
Validation loss decreased (-0.204675 --> -0.219969).  Saving model ...
Epoch: 7 cost time: 3.7990167140960693
Epoch: 7, Steps: 10 | Train Loss: 1.254 Vali Loss: 3.161 Vali Acc: 0.232 Test Loss: 3.161 Test Acc: 0.232
Validation loss decreased (-0.219969 --> -0.231733).  Saving model ...
Epoch: 8 cost time: 3.641575813293457
Epoch: 8, Steps: 10 | Train Loss: 0.959 Vali Loss: 3.183 Vali Acc: 0.247 Test Loss: 3.183 Test Acc: 0.247
Validation loss decreased (-0.231733 --> -0.247027).  Saving model ...
Epoch: 9 cost time: 3.9886889457702637
Epoch: 9, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.223 Vali Acc: 0.269 Test Loss: 3.223 Test Acc: 0.269
Validation loss decreased (-0.247027 --> -0.269380).  Saving model ...
Epoch: 10 cost time: 3.896761894226074
Epoch: 10, Steps: 10 | Train Loss: 0.459 Vali Loss: 3.285 Vali Acc: 0.285 Test Loss: 3.285 Test Acc: 0.285
Validation loss decreased (-0.269380 --> -0.284673).  Saving model ...
Epoch: 11 cost time: 3.748911142349243
Epoch: 11, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.425 Vali Acc: 0.273 Test Loss: 3.425 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5666701793670654
Epoch: 12, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.500 Vali Acc: 0.302 Test Loss: 3.500 Test Acc: 0.302
Validation loss decreased (-0.284673 --> -0.302318).  Saving model ...
Epoch: 13 cost time: 4.207744836807251
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.538 Vali Acc: 0.309 Test Loss: 3.538 Test Acc: 0.309
Validation loss decreased (-0.302318 --> -0.309376).  Saving model ...
Epoch: 14 cost time: 4.042910814285278
Epoch: 14, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.684 Vali Acc: 0.304 Test Loss: 3.684 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3712685108184814
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.736 Vali Acc: 0.301 Test Loss: 3.736 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5764150619506836
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.804 Vali Acc: 0.304 Test Loss: 3.804 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.968125343322754
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.828 Vali Acc: 0.309 Test Loss: 3.828 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8940484523773193
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.883 Vali Acc: 0.312 Test Loss: 3.883 Test Acc: 0.312
Validation loss decreased (-0.309376 --> -0.311726).  Saving model ...
Epoch: 19 cost time: 3.871843099594116
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.935 Vali Acc: 0.312 Test Loss: 3.935 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9153096675872803
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.963 Vali Acc: 0.314 Test Loss: 3.963 Test Acc: 0.314
Validation loss decreased (-0.311726 --> -0.314078).  Saving model ...
Epoch: 21 cost time: 3.961574077606201
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.980 Vali Acc: 0.312 Test Loss: 3.980 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8216679096221924
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.014 Vali Acc: 0.316 Test Loss: 4.014 Test Acc: 0.316
Validation loss decreased (-0.314078 --> -0.316430).  Saving model ...
Epoch: 23 cost time: 3.784707546234131
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.047 Vali Acc: 0.311 Test Loss: 4.047 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.104122877120972
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.058 Vali Acc: 0.311 Test Loss: 4.058 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.4634528160095215
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.080 Vali Acc: 0.313 Test Loss: 4.080 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.049898862838745
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.105 Vali Acc: 0.315 Test Loss: 4.105 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.104517698287964
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.124 Vali Acc: 0.314 Test Loss: 4.124 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.8204474449157715
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.143 Vali Acc: 0.315 Test Loss: 4.143 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.9654524326324463
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.157 Vali Acc: 0.318 Test Loss: 4.157 Test Acc: 0.318
Validation loss decreased (-0.316430 --> -0.317605).  Saving model ...
Epoch: 30 cost time: 3.6410117149353027
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.179 Vali Acc: 0.316 Test Loss: 4.179 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.820558786392212
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.193 Vali Acc: 0.319 Test Loss: 4.193 Test Acc: 0.319
Validation loss decreased (-0.317605 --> -0.318782).  Saving model ...
Epoch: 32 cost time: 3.889984607696533
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.212 Vali Acc: 0.316 Test Loss: 4.212 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.9385621547698975
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.233 Vali Acc: 0.316 Test Loss: 4.233 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.46811580657959
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.251 Vali Acc: 0.320 Test Loss: 4.251 Test Acc: 0.320
Validation loss decreased (-0.318782 --> -0.319957).  Saving model ...
Epoch: 35 cost time: 3.9182794094085693
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.265 Vali Acc: 0.321 Test Loss: 4.265 Test Acc: 0.321
Validation loss decreased (-0.319957 --> -0.321134).  Saving model ...
Epoch: 36 cost time: 3.9518074989318848
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.285 Vali Acc: 0.324 Test Loss: 4.285 Test Acc: 0.324
Validation loss decreased (-0.321134 --> -0.323487).  Saving model ...
Epoch: 37 cost time: 3.8190903663635254
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.307 Vali Acc: 0.322 Test Loss: 4.307 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.7940492630004883
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.321 Vali Acc: 0.322 Test Loss: 4.321 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 4.317325115203857
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.337 Vali Acc: 0.325 Test Loss: 4.337 Test Acc: 0.325
Validation loss decreased (-0.323487 --> -0.324663).  Saving model ...
Epoch: 40 cost time: 4.21212911605835
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.357 Vali Acc: 0.322 Test Loss: 4.357 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.579005718231201
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.375 Vali Acc: 0.320 Test Loss: 4.375 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.8464698791503906
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.396 Vali Acc: 0.324 Test Loss: 4.396 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.167219638824463
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.413 Vali Acc: 0.322 Test Loss: 4.413 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 4.001845598220825
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.425 Vali Acc: 0.326 Test Loss: 4.425 Test Acc: 0.326
Validation loss decreased (-0.324663 --> -0.325838).  Saving model ...
Epoch: 45 cost time: 4.149209022521973
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.439 Vali Acc: 0.322 Test Loss: 4.439 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.541969060897827
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.445 Vali Acc: 0.321 Test Loss: 4.445 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.7693967819213867
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.455 Vali Acc: 0.321 Test Loss: 4.455 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.6031296253204346
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.468 Vali Acc: 0.320 Test Loss: 4.468 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.5455498695373535
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.482 Vali Acc: 0.322 Test Loss: 4.482 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.7376646995544434
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.490 Vali Acc: 0.327 Test Loss: 4.490 Test Acc: 0.327
Validation loss decreased (-0.325838 --> -0.327014).  Saving model ...
Epoch: 51 cost time: 4.073877573013306
Epoch: 51, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.503 Vali Acc: 0.328 Test Loss: 4.503 Test Acc: 0.328
Validation loss decreased (-0.327014 --> -0.328190).  Saving model ...
Epoch: 52 cost time: 4.525099277496338
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.516 Vali Acc: 0.327 Test Loss: 4.516 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 4.095411777496338
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.524 Vali Acc: 0.325 Test Loss: 4.524 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.680473566055298
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.530 Vali Acc: 0.329 Test Loss: 4.530 Test Acc: 0.329
Validation loss decreased (-0.328190 --> -0.329366).  Saving model ...
Epoch: 55 cost time: 3.812523126602173
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.543 Vali Acc: 0.328 Test Loss: 4.543 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 4.094836711883545
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.557 Vali Acc: 0.328 Test Loss: 4.557 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.9377665519714355
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.572 Vali Acc: 0.325 Test Loss: 4.572 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.621260404586792
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.584 Vali Acc: 0.322 Test Loss: 4.584 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 4.137362241744995
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.594 Vali Acc: 0.324 Test Loss: 4.594 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 4.4030442237854
Epoch: 60, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.606 Vali Acc: 0.322 Test Loss: 4.606 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.907414674758911
Epoch: 61, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.616 Vali Acc: 0.327 Test Loss: 4.616 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.9800219535827637
Epoch: 62, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.628 Vali Acc: 0.325 Test Loss: 4.628 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.8892123699188232
Epoch: 63, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.640 Vali Acc: 0.322 Test Loss: 4.640 Test Acc: 0.322
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.907196283340454
Epoch: 64, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.655 Vali Acc: 0.321 Test Loss: 4.655 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 518810
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.260545492172241
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.278 Vali Acc: 0.046 Test Loss: 3.278 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 3.2085955142974854
Epoch: 2, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.255 Vali Acc: 0.092 Test Loss: 3.255 Test Acc: 0.092
Validation loss decreased (-0.045850 --> -0.091732).  Saving model ...
Epoch: 3 cost time: 3.4745068550109863
Epoch: 3, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.265 Vali Acc: 0.116 Test Loss: 3.265 Test Acc: 0.116
Validation loss decreased (-0.091732 --> -0.116438).  Saving model ...
Epoch: 4 cost time: 3.2547519207000732
Epoch: 4, Steps: 10 | Train Loss: 2.439 Vali Loss: 3.226 Vali Acc: 0.152 Test Loss: 3.226 Test Acc: 0.152
Validation loss decreased (-0.116438 --> -0.151732).  Saving model ...
Epoch: 5 cost time: 3.575291633605957
Epoch: 5, Steps: 10 | Train Loss: 2.013 Vali Loss: 3.139 Vali Acc: 0.205 Test Loss: 3.139 Test Acc: 0.205
Validation loss decreased (-0.151732 --> -0.204674).  Saving model ...
Epoch: 6 cost time: 3.7759883403778076
Epoch: 6, Steps: 10 | Train Loss: 1.648 Vali Loss: 3.127 Vali Acc: 0.229 Test Loss: 3.127 Test Acc: 0.229
Validation loss decreased (-0.204674 --> -0.229380).  Saving model ...
Epoch: 7 cost time: 3.9536545276641846
Epoch: 7, Steps: 10 | Train Loss: 1.345 Vali Loss: 3.202 Vali Acc: 0.232 Test Loss: 3.202 Test Acc: 0.232
Validation loss decreased (-0.229380 --> -0.231733).  Saving model ...
Epoch: 8 cost time: 4.059423923492432
Epoch: 8, Steps: 10 | Train Loss: 1.064 Vali Loss: 3.211 Vali Acc: 0.259 Test Loss: 3.211 Test Acc: 0.259
Validation loss decreased (-0.231733 --> -0.258791).  Saving model ...
Epoch: 9 cost time: 4.282873630523682
Epoch: 9, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.247 Vali Acc: 0.273 Test Loss: 3.247 Test Acc: 0.273
Validation loss decreased (-0.258791 --> -0.272909).  Saving model ...
Epoch: 10 cost time: 3.881427049636841
Epoch: 10, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.320 Vali Acc: 0.280 Test Loss: 3.320 Test Acc: 0.280
Validation loss decreased (-0.272909 --> -0.279967).  Saving model ...
Epoch: 11 cost time: 3.859769344329834
Epoch: 11, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.419 Vali Acc: 0.286 Test Loss: 3.419 Test Acc: 0.286
Validation loss decreased (-0.279967 --> -0.285848).  Saving model ...
Epoch: 12 cost time: 3.9645557403564453
Epoch: 12, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.470 Vali Acc: 0.298 Test Loss: 3.470 Test Acc: 0.298
Validation loss decreased (-0.285848 --> -0.297612).  Saving model ...
Epoch: 13 cost time: 3.9127190113067627
Epoch: 13, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.524 Vali Acc: 0.314 Test Loss: 3.524 Test Acc: 0.314
Validation loss decreased (-0.297612 --> -0.314082).  Saving model ...
Epoch: 14 cost time: 3.985715627670288
Epoch: 14, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.689 Vali Acc: 0.308 Test Loss: 3.689 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.029711723327637
Epoch: 15, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.722 Vali Acc: 0.306 Test Loss: 3.722 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.08656644821167
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.808 Vali Acc: 0.304 Test Loss: 3.808 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8788859844207764
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.805 Vali Acc: 0.325 Test Loss: 3.805 Test Acc: 0.325
Validation loss decreased (-0.314082 --> -0.324668).  Saving model ...
Epoch: 18 cost time: 3.9968457221984863
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.894 Vali Acc: 0.327 Test Loss: 3.894 Test Acc: 0.327
Validation loss decreased (-0.324668 --> -0.327020).  Saving model ...
Epoch: 19 cost time: 3.4904611110687256
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.979 Vali Acc: 0.314 Test Loss: 3.979 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.70609974861145
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.989 Vali Acc: 0.314 Test Loss: 3.989 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.122589111328125
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.998 Vali Acc: 0.316 Test Loss: 3.998 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.691488027572632
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.040 Vali Acc: 0.319 Test Loss: 4.040 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.6266791820526123
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.081 Vali Acc: 0.318 Test Loss: 4.081 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.761240005493164
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.092 Vali Acc: 0.321 Test Loss: 4.092 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.150569677352905
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.120 Vali Acc: 0.321 Test Loss: 4.120 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.4961328506469727
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.152 Vali Acc: 0.319 Test Loss: 4.152 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.5932464599609375
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.168 Vali Acc: 0.324 Test Loss: 4.168 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.8055293560028076
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.189 Vali Acc: 0.324 Test Loss: 4.189 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3270588235294118
model parameter : 518810
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.310845613479614
Epoch: 1, Steps: 10 | Train Loss: 3.385 Vali Loss: 3.289 Vali Acc: 0.040 Test Loss: 3.289 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.9116382598876953
Epoch: 2, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.279 Vali Acc: 0.062 Test Loss: 3.279 Test Acc: 0.062
Validation loss decreased (-0.039967 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 4.0556700229644775
Epoch: 3, Steps: 10 | Train Loss: 2.803 Vali Loss: 3.308 Vali Acc: 0.100 Test Loss: 3.308 Test Acc: 0.100
Validation loss decreased (-0.062320 --> -0.099967).  Saving model ...
Epoch: 4 cost time: 4.111927509307861
Epoch: 4, Steps: 10 | Train Loss: 2.471 Vali Loss: 3.297 Vali Acc: 0.132 Test Loss: 3.297 Test Acc: 0.132
Validation loss decreased (-0.099967 --> -0.131732).  Saving model ...
Epoch: 5 cost time: 4.047807216644287
Epoch: 5, Steps: 10 | Train Loss: 2.084 Vali Loss: 3.245 Vali Acc: 0.152 Test Loss: 3.245 Test Acc: 0.152
Validation loss decreased (-0.131732 --> -0.151732).  Saving model ...
Epoch: 6 cost time: 3.4453225135803223
Epoch: 6, Steps: 10 | Train Loss: 1.730 Vali Loss: 3.255 Vali Acc: 0.175 Test Loss: 3.255 Test Acc: 0.175
Validation loss decreased (-0.151732 --> -0.175262).  Saving model ...
Epoch: 7 cost time: 3.7014660835266113
Epoch: 7, Steps: 10 | Train Loss: 1.430 Vali Loss: 3.370 Vali Acc: 0.171 Test Loss: 3.370 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5783486366271973
Epoch: 8, Steps: 10 | Train Loss: 1.171 Vali Loss: 3.425 Vali Acc: 0.184 Test Loss: 3.425 Test Acc: 0.184
Validation loss decreased (-0.175262 --> -0.183495).  Saving model ...
Epoch: 9 cost time: 3.7791292667388916
Epoch: 9, Steps: 10 | Train Loss: 0.896 Vali Loss: 3.469 Vali Acc: 0.201 Test Loss: 3.469 Test Acc: 0.201
Validation loss decreased (-0.183495 --> -0.201142).  Saving model ...
Epoch: 10 cost time: 4.0359039306640625
Epoch: 10, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.540 Vali Acc: 0.221 Test Loss: 3.540 Test Acc: 0.221
Validation loss decreased (-0.201142 --> -0.221141).  Saving model ...
Epoch: 11 cost time: 4.045982360839844
Epoch: 11, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.686 Vali Acc: 0.211 Test Loss: 3.686 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.016657114028931
Epoch: 12, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.754 Vali Acc: 0.245 Test Loss: 3.754 Test Acc: 0.245
Validation loss decreased (-0.221141 --> -0.244668).  Saving model ...
Epoch: 13 cost time: 3.7150726318359375
Epoch: 13, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.804 Vali Acc: 0.240 Test Loss: 3.804 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4809505939483643
Epoch: 14, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.990 Vali Acc: 0.242 Test Loss: 3.990 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.832810878753662
Epoch: 15, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.026 Vali Acc: 0.251 Test Loss: 4.026 Test Acc: 0.251
Validation loss decreased (-0.244668 --> -0.250548).  Saving model ...
Epoch: 16 cost time: 3.4129929542541504
Epoch: 16, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.152 Vali Acc: 0.241 Test Loss: 4.152 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.567197799682617
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.202 Vali Acc: 0.253 Test Loss: 4.202 Test Acc: 0.253
Validation loss decreased (-0.250548 --> -0.252899).  Saving model ...
Epoch: 18 cost time: 3.6211349964141846
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.300 Vali Acc: 0.260 Test Loss: 4.300 Test Acc: 0.260
Validation loss decreased (-0.252899 --> -0.259957).  Saving model ...
Epoch: 19 cost time: 3.8556861877441406
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.366 Vali Acc: 0.261 Test Loss: 4.366 Test Acc: 0.261
Validation loss decreased (-0.259957 --> -0.261133).  Saving model ...
Epoch: 20 cost time: 3.6898674964904785
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.370 Vali Acc: 0.262 Test Loss: 4.370 Test Acc: 0.262
Validation loss decreased (-0.261133 --> -0.262309).  Saving model ...
Epoch: 21 cost time: 4.0608086585998535
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.386 Vali Acc: 0.264 Test Loss: 4.386 Test Acc: 0.264
Validation loss decreased (-0.262309 --> -0.263486).  Saving model ...
Epoch: 22 cost time: 3.6203274726867676
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.426 Vali Acc: 0.262 Test Loss: 4.426 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.7708683013916016
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.484 Vali Acc: 0.265 Test Loss: 4.484 Test Acc: 0.265
Validation loss decreased (-0.263486 --> -0.264661).  Saving model ...
Epoch: 24 cost time: 3.621875524520874
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.494 Vali Acc: 0.267 Test Loss: 4.494 Test Acc: 0.267
Validation loss decreased (-0.264661 --> -0.267014).  Saving model ...
Epoch: 25 cost time: 3.516172170639038
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.526 Vali Acc: 0.267 Test Loss: 4.526 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.456242561340332
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.556 Vali Acc: 0.261 Test Loss: 4.556 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.7295284271240234
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.573 Vali Acc: 0.262 Test Loss: 4.573 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.77419114112854
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.594 Vali Acc: 0.267 Test Loss: 4.594 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.5720062255859375
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.623 Vali Acc: 0.267 Test Loss: 4.623 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.8011443614959717
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.649 Vali Acc: 0.269 Test Loss: 4.649 Test Acc: 0.269
Validation loss decreased (-0.267014 --> -0.269365).  Saving model ...
Epoch: 31 cost time: 3.9207329750061035
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.671 Vali Acc: 0.268 Test Loss: 4.671 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.00459098815918
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.689 Vali Acc: 0.266 Test Loss: 4.689 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.4990174770355225
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.707 Vali Acc: 0.267 Test Loss: 4.707 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.439906120300293
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.731 Vali Acc: 0.268 Test Loss: 4.731 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.917515277862549
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.746 Vali Acc: 0.267 Test Loss: 4.746 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.6661527156829834
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.766 Vali Acc: 0.271 Test Loss: 4.766 Test Acc: 0.271
Validation loss decreased (-0.269365 --> -0.270541).  Saving model ...
Epoch: 37 cost time: 3.9656262397766113
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.793 Vali Acc: 0.269 Test Loss: 4.793 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.0933754444122314
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.809 Vali Acc: 0.273 Test Loss: 4.809 Test Acc: 0.273
Validation loss decreased (-0.270541 --> -0.272893).  Saving model ...
Epoch: 39 cost time: 3.688804864883423
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.832 Vali Acc: 0.273 Test Loss: 4.832 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.6846232414245605
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.853 Vali Acc: 0.272 Test Loss: 4.853 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.5021321773529053
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.868 Vali Acc: 0.271 Test Loss: 4.868 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.587209463119507
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.886 Vali Acc: 0.271 Test Loss: 4.886 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.645540952682495
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.899 Vali Acc: 0.273 Test Loss: 4.899 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.8278086185455322
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.916 Vali Acc: 0.274 Test Loss: 4.916 Test Acc: 0.274
Validation loss decreased (-0.272893 --> -0.274068).  Saving model ...
Epoch: 45 cost time: 3.5467417240142822
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.933 Vali Acc: 0.274 Test Loss: 4.933 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 4.231009483337402
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.937 Vali Acc: 0.274 Test Loss: 4.937 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.689922571182251
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.950 Vali Acc: 0.276 Test Loss: 4.950 Test Acc: 0.276
Validation loss decreased (-0.274068 --> -0.276421).  Saving model ...
Epoch: 48 cost time: 3.784111499786377
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.967 Vali Acc: 0.278 Test Loss: 4.967 Test Acc: 0.278
Validation loss decreased (-0.276421 --> -0.277597).  Saving model ...
Epoch: 49 cost time: 3.9028241634368896
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.987 Vali Acc: 0.275 Test Loss: 4.987 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.826796770095825
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.992 Vali Acc: 0.275 Test Loss: 4.992 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.4157886505126953
Epoch: 51, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.006 Vali Acc: 0.275 Test Loss: 5.006 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.6836187839508057
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.027 Vali Acc: 0.275 Test Loss: 5.027 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.6088380813598633
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.043 Vali Acc: 0.274 Test Loss: 5.043 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.6249561309814453
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.054 Vali Acc: 0.274 Test Loss: 5.054 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.728092908859253
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.067 Vali Acc: 0.274 Test Loss: 5.067 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.7573294639587402
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.080 Vali Acc: 0.275 Test Loss: 5.080 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 3.5360727310180664
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.096 Vali Acc: 0.274 Test Loss: 5.096 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 3.9351885318756104
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.111 Vali Acc: 0.275 Test Loss: 5.111 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 518810
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.260474920272827
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.296 Vali Acc: 0.052 Test Loss: 3.296 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 3.0008504390716553
Epoch: 2, Steps: 10 | Train Loss: 3.110 Vali Loss: 3.316 Vali Acc: 0.049 Test Loss: 3.316 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.211595058441162
Epoch: 3, Steps: 10 | Train Loss: 2.811 Vali Loss: 3.377 Vali Acc: 0.069 Test Loss: 3.377 Test Acc: 0.069
Validation loss decreased (-0.051732 --> -0.069378).  Saving model ...
Epoch: 4 cost time: 3.405935287475586
Epoch: 4, Steps: 10 | Train Loss: 2.563 Vali Loss: 3.387 Vali Acc: 0.073 Test Loss: 3.387 Test Acc: 0.073
Validation loss decreased (-0.069378 --> -0.072907).  Saving model ...
Epoch: 5 cost time: 3.4314229488372803
Epoch: 5, Steps: 10 | Train Loss: 2.188 Vali Loss: 3.343 Vali Acc: 0.093 Test Loss: 3.343 Test Acc: 0.093
Validation loss decreased (-0.072907 --> -0.092908).  Saving model ...
Epoch: 6 cost time: 3.546799898147583
Epoch: 6, Steps: 10 | Train Loss: 1.818 Vali Loss: 3.345 Vali Acc: 0.101 Test Loss: 3.345 Test Acc: 0.101
Validation loss decreased (-0.092908 --> -0.101143).  Saving model ...
Epoch: 7 cost time: 3.3979902267456055
Epoch: 7, Steps: 10 | Train Loss: 1.544 Vali Loss: 3.451 Vali Acc: 0.109 Test Loss: 3.451 Test Acc: 0.109
Validation loss decreased (-0.101143 --> -0.109377).  Saving model ...
Epoch: 8 cost time: 3.230217218399048
Epoch: 8, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.500 Vali Acc: 0.115 Test Loss: 3.500 Test Acc: 0.115
Validation loss decreased (-0.109377 --> -0.115259).  Saving model ...
Epoch: 9 cost time: 3.1950526237487793
Epoch: 9, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.598 Vali Acc: 0.114 Test Loss: 3.598 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.212798595428467
Epoch: 10, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.696 Vali Acc: 0.118 Test Loss: 3.696 Test Acc: 0.118
Validation loss decreased (-0.115259 --> -0.117610).  Saving model ...
Epoch: 11 cost time: 3.159390449523926
Epoch: 11, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.878 Vali Acc: 0.121 Test Loss: 3.878 Test Acc: 0.121
Validation loss decreased (-0.117610 --> -0.121138).  Saving model ...
Epoch: 12 cost time: 3.14450740814209
Epoch: 12, Steps: 10 | Train Loss: 0.322 Vali Loss: 4.037 Vali Acc: 0.131 Test Loss: 4.037 Test Acc: 0.131
Validation loss decreased (-0.121138 --> -0.130548).  Saving model ...
Epoch: 13 cost time: 3.373263359069824
Epoch: 13, Steps: 10 | Train Loss: 0.195 Vali Loss: 4.095 Vali Acc: 0.126 Test Loss: 4.095 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3928909301757812
Epoch: 14, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.311 Vali Acc: 0.129 Test Loss: 4.311 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8088204860687256
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.429 Vali Acc: 0.147 Test Loss: 4.429 Test Acc: 0.147
Validation loss decreased (-0.130548 --> -0.147015).  Saving model ...
Epoch: 16 cost time: 3.1771583557128906
Epoch: 16, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.546 Vali Acc: 0.136 Test Loss: 4.546 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2431163787841797
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.572 Vali Acc: 0.145 Test Loss: 4.572 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3953588008880615
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.612 Vali Acc: 0.146 Test Loss: 4.612 Test Acc: 0.146
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.28332781791687
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.667 Vali Acc: 0.148 Test Loss: 4.667 Test Acc: 0.148
Validation loss decreased (-0.147015 --> -0.148189).  Saving model ...
Epoch: 20 cost time: 3.1568989753723145
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.735 Vali Acc: 0.152 Test Loss: 4.735 Test Acc: 0.152
Validation loss decreased (-0.148189 --> -0.151717).  Saving model ...
Epoch: 21 cost time: 3.494140863418579
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.773 Vali Acc: 0.151 Test Loss: 4.773 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.294166088104248
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.808 Vali Acc: 0.153 Test Loss: 4.808 Test Acc: 0.153
Validation loss decreased (-0.151717 --> -0.152893).  Saving model ...
Epoch: 23 cost time: 3.2165675163269043
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.848 Vali Acc: 0.154 Test Loss: 4.848 Test Acc: 0.154
Validation loss decreased (-0.152893 --> -0.154069).  Saving model ...
Epoch: 24 cost time: 3.609752893447876
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.862 Vali Acc: 0.156 Test Loss: 4.862 Test Acc: 0.156
Validation loss decreased (-0.154069 --> -0.156422).  Saving model ...
Epoch: 25 cost time: 3.548417806625366
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.900 Vali Acc: 0.158 Test Loss: 4.900 Test Acc: 0.158
Validation loss decreased (-0.156422 --> -0.157598).  Saving model ...
Epoch: 26 cost time: 3.342337131500244
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.931 Vali Acc: 0.156 Test Loss: 4.931 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2001020908355713
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.955 Vali Acc: 0.158 Test Loss: 4.955 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.5623557567596436
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.985 Vali Acc: 0.159 Test Loss: 4.985 Test Acc: 0.159
Validation loss decreased (-0.157598 --> -0.158774).  Saving model ...
Epoch: 29 cost time: 3.3838412761688232
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.012 Vali Acc: 0.160 Test Loss: 5.012 Test Acc: 0.160
Validation loss decreased (-0.158774 --> -0.159950).  Saving model ...
Epoch: 30 cost time: 3.53313946723938
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.036 Vali Acc: 0.161 Test Loss: 5.036 Test Acc: 0.161
Validation loss decreased (-0.159950 --> -0.161126).  Saving model ...
Epoch: 31 cost time: 3.282336473464966
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.064 Vali Acc: 0.165 Test Loss: 5.064 Test Acc: 0.165
Validation loss decreased (-0.161126 --> -0.164655).  Saving model ...
Epoch: 32 cost time: 3.378587245941162
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.087 Vali Acc: 0.166 Test Loss: 5.087 Test Acc: 0.166
Validation loss decreased (-0.164655 --> -0.165831).  Saving model ...
Epoch: 33 cost time: 3.8571112155914307
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.105 Vali Acc: 0.167 Test Loss: 5.105 Test Acc: 0.167
Validation loss decreased (-0.165831 --> -0.167008).  Saving model ...
Epoch: 34 cost time: 3.6357004642486572
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.120 Vali Acc: 0.162 Test Loss: 5.120 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.272163152694702
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.136 Vali Acc: 0.162 Test Loss: 5.136 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.170031785964966
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.149 Vali Acc: 0.161 Test Loss: 5.149 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.2301928997039795
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.168 Vali Acc: 0.162 Test Loss: 5.168 Test Acc: 0.162
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.254368305206299
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.185 Vali Acc: 0.162 Test Loss: 5.185 Test Acc: 0.162
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.1009488105773926
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.208 Vali Acc: 0.165 Test Loss: 5.208 Test Acc: 0.165
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.092432737350464
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.236 Vali Acc: 0.164 Test Loss: 5.236 Test Acc: 0.164
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.4328083992004395
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.260 Vali Acc: 0.164 Test Loss: 5.260 Test Acc: 0.164
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.5624170303344727
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.278 Vali Acc: 0.166 Test Loss: 5.278 Test Acc: 0.166
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.4759626388549805
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.290 Vali Acc: 0.164 Test Loss: 5.290 Test Acc: 0.164
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16705882352941176
model parameter : 518810
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.61678147315979
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.305 Vali Acc: 0.041 Test Loss: 3.305 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 3.6420202255249023
Epoch: 2, Steps: 10 | Train Loss: 3.180 Vali Loss: 3.317 Vali Acc: 0.056 Test Loss: 3.317 Test Acc: 0.056
Validation loss decreased (-0.041143 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 3.159278154373169
Epoch: 3, Steps: 10 | Train Loss: 2.958 Vali Loss: 3.377 Vali Acc: 0.059 Test Loss: 3.377 Test Acc: 0.059
Validation loss decreased (-0.056437 --> -0.058790).  Saving model ...
Epoch: 4 cost time: 3.4528040885925293
Epoch: 4, Steps: 10 | Train Loss: 2.803 Vali Loss: 3.398 Vali Acc: 0.061 Test Loss: 3.398 Test Acc: 0.061
Validation loss decreased (-0.058790 --> -0.061142).  Saving model ...
Epoch: 5 cost time: 3.8062055110931396
Epoch: 5, Steps: 10 | Train Loss: 2.538 Vali Loss: 3.361 Vali Acc: 0.061 Test Loss: 3.361 Test Acc: 0.061
Validation loss decreased (-0.061142 --> -0.061143).  Saving model ...
Epoch: 6 cost time: 3.6941425800323486
Epoch: 6, Steps: 10 | Train Loss: 2.244 Vali Loss: 3.343 Vali Acc: 0.076 Test Loss: 3.343 Test Acc: 0.076
Validation loss decreased (-0.061143 --> -0.076437).  Saving model ...
Epoch: 7 cost time: 3.7833333015441895
Epoch: 7, Steps: 10 | Train Loss: 1.965 Vali Loss: 3.405 Vali Acc: 0.087 Test Loss: 3.405 Test Acc: 0.087
Validation loss decreased (-0.076437 --> -0.087025).  Saving model ...
Epoch: 8 cost time: 4.0095436573028564
Epoch: 8, Steps: 10 | Train Loss: 1.682 Vali Loss: 3.427 Vali Acc: 0.084 Test Loss: 3.427 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7203025817871094
Epoch: 9, Steps: 10 | Train Loss: 1.351 Vali Loss: 3.482 Vali Acc: 0.085 Test Loss: 3.482 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.574826955795288
Epoch: 10, Steps: 10 | Train Loss: 1.103 Vali Loss: 3.546 Vali Acc: 0.088 Test Loss: 3.546 Test Acc: 0.088
Validation loss decreased (-0.087025 --> -0.088200).  Saving model ...
Epoch: 11 cost time: 3.3040688037872314
Epoch: 11, Steps: 10 | Train Loss: 0.853 Vali Loss: 3.665 Vali Acc: 0.091 Test Loss: 3.665 Test Acc: 0.091
Validation loss decreased (-0.088200 --> -0.090552).  Saving model ...
Epoch: 12 cost time: 3.2781314849853516
Epoch: 12, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.763 Vali Acc: 0.092 Test Loss: 3.763 Test Acc: 0.092
Validation loss decreased (-0.090552 --> -0.091727).  Saving model ...
Epoch: 13 cost time: 3.3892452716827393
Epoch: 13, Steps: 10 | Train Loss: 0.441 Vali Loss: 3.836 Vali Acc: 0.095 Test Loss: 3.836 Test Acc: 0.095
Validation loss decreased (-0.091727 --> -0.095256).  Saving model ...
Epoch: 14 cost time: 3.3708419799804688
Epoch: 14, Steps: 10 | Train Loss: 0.266 Vali Loss: 4.070 Vali Acc: 0.094 Test Loss: 4.070 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1957550048828125
Epoch: 15, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.174 Vali Acc: 0.106 Test Loss: 4.174 Test Acc: 0.106
Validation loss decreased (-0.095256 --> -0.105841).  Saving model ...
Epoch: 16 cost time: 3.4888408184051514
Epoch: 16, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.400 Vali Acc: 0.102 Test Loss: 4.400 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5057177543640137
Epoch: 17, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.450 Vali Acc: 0.102 Test Loss: 4.450 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3768789768218994
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.505 Vali Acc: 0.113 Test Loss: 4.505 Test Acc: 0.113
Validation loss decreased (-0.105841 --> -0.112896).  Saving model ...
Epoch: 19 cost time: 3.8113865852355957
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.611 Vali Acc: 0.115 Test Loss: 4.611 Test Acc: 0.115
Validation loss decreased (-0.112896 --> -0.115248).  Saving model ...
Epoch: 20 cost time: 3.198748826980591
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.652 Vali Acc: 0.119 Test Loss: 4.652 Test Acc: 0.119
Validation loss decreased (-0.115248 --> -0.118777).  Saving model ...
Epoch: 21 cost time: 2.890045404434204
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.677 Vali Acc: 0.114 Test Loss: 4.677 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6931989192962646
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.695 Vali Acc: 0.118 Test Loss: 4.695 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.508286714553833
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.725 Vali Acc: 0.125 Test Loss: 4.725 Test Acc: 0.125
Validation loss decreased (-0.118777 --> -0.124659).  Saving model ...
Epoch: 24 cost time: 3.785207986831665
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.760 Vali Acc: 0.131 Test Loss: 4.760 Test Acc: 0.131
Validation loss decreased (-0.124659 --> -0.130541).  Saving model ...
Epoch: 25 cost time: 3.670006036758423
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.799 Vali Acc: 0.125 Test Loss: 4.799 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.833495616912842
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.832 Vali Acc: 0.126 Test Loss: 4.832 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.483372688293457
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.857 Vali Acc: 0.122 Test Loss: 4.857 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.328084945678711
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.869 Vali Acc: 0.125 Test Loss: 4.869 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.731799840927124
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.894 Vali Acc: 0.125 Test Loss: 4.894 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.23405122756958
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.918 Vali Acc: 0.127 Test Loss: 4.918 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.5631418228149414
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.938 Vali Acc: 0.127 Test Loss: 4.938 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.497509002685547
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.954 Vali Acc: 0.128 Test Loss: 4.954 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.7529969215393066
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.968 Vali Acc: 0.127 Test Loss: 4.968 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.816451072692871
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.983 Vali Acc: 0.126 Test Loss: 4.983 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13058823529411764
model parameter : 518810
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.551436185836792
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.331 Vali Acc: 0.049 Test Loss: 3.331 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 3.44793438911438
Epoch: 2, Steps: 10 | Train Loss: 3.189 Vali Loss: 3.332 Vali Acc: 0.051 Test Loss: 3.332 Test Acc: 0.051
Validation loss decreased (-0.049378 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 3.5906455516815186
Epoch: 3, Steps: 10 | Train Loss: 3.031 Vali Loss: 3.383 Vali Acc: 0.060 Test Loss: 3.383 Test Acc: 0.060
Validation loss decreased (-0.050555 --> -0.059966).  Saving model ...
Epoch: 4 cost time: 3.2488627433776855
Epoch: 4, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.417 Vali Acc: 0.065 Test Loss: 3.417 Test Acc: 0.065
Validation loss decreased (-0.059966 --> -0.064672).  Saving model ...
Epoch: 5 cost time: 3.2891921997070312
Epoch: 5, Steps: 10 | Train Loss: 2.744 Vali Loss: 3.384 Vali Acc: 0.072 Test Loss: 3.384 Test Acc: 0.072
Validation loss decreased (-0.064672 --> -0.071731).  Saving model ...
Epoch: 6 cost time: 3.3232474327087402
Epoch: 6, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.357 Vali Acc: 0.073 Test Loss: 3.357 Test Acc: 0.073
Validation loss decreased (-0.071731 --> -0.072908).  Saving model ...
Epoch: 7 cost time: 3.6255462169647217
Epoch: 7, Steps: 10 | Train Loss: 2.377 Vali Loss: 3.375 Vali Acc: 0.079 Test Loss: 3.375 Test Acc: 0.079
Validation loss decreased (-0.072908 --> -0.078790).  Saving model ...
Epoch: 8 cost time: 3.2873685359954834
Epoch: 8, Steps: 10 | Train Loss: 2.109 Vali Loss: 3.374 Vali Acc: 0.093 Test Loss: 3.374 Test Acc: 0.093
Validation loss decreased (-0.078790 --> -0.092907).  Saving model ...
Epoch: 9 cost time: 3.327934980392456
Epoch: 9, Steps: 10 | Train Loss: 1.855 Vali Loss: 3.409 Vali Acc: 0.087 Test Loss: 3.409 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0588669776916504
Epoch: 10, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.426 Vali Acc: 0.086 Test Loss: 3.426 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.41556715965271
Epoch: 11, Steps: 10 | Train Loss: 1.377 Vali Loss: 3.485 Vali Acc: 0.098 Test Loss: 3.485 Test Acc: 0.098
Validation loss decreased (-0.092907 --> -0.097612).  Saving model ...
Epoch: 12 cost time: 3.381617784500122
Epoch: 12, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.556 Vali Acc: 0.104 Test Loss: 3.556 Test Acc: 0.104
Validation loss decreased (-0.097612 --> -0.103494).  Saving model ...
Epoch: 13 cost time: 3.3836543560028076
Epoch: 13, Steps: 10 | Train Loss: 0.814 Vali Loss: 3.628 Vali Acc: 0.101 Test Loss: 3.628 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.529365301132202
Epoch: 14, Steps: 10 | Train Loss: 0.585 Vali Loss: 3.781 Vali Acc: 0.108 Test Loss: 3.781 Test Acc: 0.108
Validation loss decreased (-0.103494 --> -0.108197).  Saving model ...
Epoch: 15 cost time: 3.510611057281494
Epoch: 15, Steps: 10 | Train Loss: 0.399 Vali Loss: 3.934 Vali Acc: 0.104 Test Loss: 3.934 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.561453342437744
Epoch: 16, Steps: 10 | Train Loss: 0.268 Vali Loss: 4.084 Vali Acc: 0.107 Test Loss: 4.084 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1621034145355225
Epoch: 17, Steps: 10 | Train Loss: 0.178 Vali Loss: 4.246 Vali Acc: 0.105 Test Loss: 4.246 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.176589250564575
Epoch: 18, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.405 Vali Acc: 0.106 Test Loss: 4.405 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.4700706005096436
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.473 Vali Acc: 0.118 Test Loss: 4.473 Test Acc: 0.118
Validation loss decreased (-0.108197 --> -0.117602).  Saving model ...
Epoch: 20 cost time: 3.0127344131469727
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.480 Vali Acc: 0.115 Test Loss: 4.480 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1444694995880127
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.545 Vali Acc: 0.119 Test Loss: 4.545 Test Acc: 0.119
Validation loss decreased (-0.117602 --> -0.118778).  Saving model ...
Epoch: 22 cost time: 3.5863497257232666
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.619 Vali Acc: 0.119 Test Loss: 4.619 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.823052167892456
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.667 Vali Acc: 0.115 Test Loss: 4.667 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.461452007293701
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.693 Vali Acc: 0.119 Test Loss: 4.693 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.7550323009490967
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.724 Vali Acc: 0.119 Test Loss: 4.724 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.3789401054382324
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.784 Vali Acc: 0.120 Test Loss: 4.784 Test Acc: 0.120
Validation loss decreased (-0.118778 --> -0.119952).  Saving model ...
Epoch: 27 cost time: 3.3349342346191406
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.814 Vali Acc: 0.122 Test Loss: 4.814 Test Acc: 0.122
Validation loss decreased (-0.119952 --> -0.122305).  Saving model ...
Epoch: 28 cost time: 3.301068067550659
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.839 Vali Acc: 0.118 Test Loss: 4.839 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.261176109313965
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.855 Vali Acc: 0.119 Test Loss: 4.855 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.5752875804901123
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.856 Vali Acc: 0.121 Test Loss: 4.856 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.660367012023926
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.858 Vali Acc: 0.122 Test Loss: 4.858 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.7248072624206543
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.867 Vali Acc: 0.127 Test Loss: 4.867 Test Acc: 0.127
Validation loss decreased (-0.122305 --> -0.127010).  Saving model ...
Epoch: 33 cost time: 3.440458297729492
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.883 Vali Acc: 0.127 Test Loss: 4.883 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.463343620300293
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.914 Vali Acc: 0.126 Test Loss: 4.914 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.435788154602051
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.948 Vali Acc: 0.125 Test Loss: 4.948 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.7586710453033447
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.967 Vali Acc: 0.120 Test Loss: 4.967 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.7411131858825684
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.990 Vali Acc: 0.121 Test Loss: 4.990 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.616253137588501
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.003 Vali Acc: 0.124 Test Loss: 5.003 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.5432028770446777
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.024 Vali Acc: 0.121 Test Loss: 5.024 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.819793701171875
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.051 Vali Acc: 0.121 Test Loss: 5.051 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.3849565982818604
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.080 Vali Acc: 0.124 Test Loss: 5.080 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.010204315185547
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.085 Vali Acc: 0.122 Test Loss: 5.085 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12705882352941175
model parameter : 518810
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.665623188018799
Epoch: 1, Steps: 10 | Train Loss: 3.402 Vali Loss: 3.338 Vali Acc: 0.044 Test Loss: 3.338 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 3.533950090408325
Epoch: 2, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.365 Vali Acc: 0.034 Test Loss: 3.365 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5426926612854004
Epoch: 3, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.432 Vali Acc: 0.038 Test Loss: 3.432 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7412331104278564
Epoch: 4, Steps: 10 | Train Loss: 3.060 Vali Loss: 3.472 Vali Acc: 0.039 Test Loss: 3.472 Test Acc: 0.039
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.543318033218384
Epoch: 5, Steps: 10 | Train Loss: 2.859 Vali Loss: 3.445 Vali Acc: 0.044 Test Loss: 3.445 Test Acc: 0.044
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.5630507469177246
Epoch: 6, Steps: 10 | Train Loss: 2.717 Vali Loss: 3.404 Vali Acc: 0.058 Test Loss: 3.404 Test Acc: 0.058
Validation loss decreased (-0.043496 --> -0.057613).  Saving model ...
Epoch: 7 cost time: 3.3643815517425537
Epoch: 7, Steps: 10 | Train Loss: 2.609 Vali Loss: 3.406 Vali Acc: 0.066 Test Loss: 3.406 Test Acc: 0.066
Validation loss decreased (-0.057613 --> -0.065848).  Saving model ...
Epoch: 8 cost time: 3.208209991455078
Epoch: 8, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.400 Vali Acc: 0.071 Test Loss: 3.400 Test Acc: 0.071
Validation loss decreased (-0.065848 --> -0.070554).  Saving model ...
Epoch: 9 cost time: 3.0735859870910645
Epoch: 9, Steps: 10 | Train Loss: 2.158 Vali Loss: 3.428 Vali Acc: 0.080 Test Loss: 3.428 Test Acc: 0.080
Validation loss decreased (-0.070554 --> -0.079966).  Saving model ...
Epoch: 10 cost time: 3.398867130279541
Epoch: 10, Steps: 10 | Train Loss: 1.979 Vali Loss: 3.412 Vali Acc: 0.076 Test Loss: 3.412 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5219385623931885
Epoch: 11, Steps: 10 | Train Loss: 1.794 Vali Loss: 3.441 Vali Acc: 0.089 Test Loss: 3.441 Test Acc: 0.089
Validation loss decreased (-0.079966 --> -0.089377).  Saving model ...
Epoch: 12 cost time: 3.6705234050750732
Epoch: 12, Steps: 10 | Train Loss: 1.483 Vali Loss: 3.505 Vali Acc: 0.092 Test Loss: 3.505 Test Acc: 0.092
Validation loss decreased (-0.089377 --> -0.091730).  Saving model ...
Epoch: 13 cost time: 3.208688974380493
Epoch: 13, Steps: 10 | Train Loss: 1.191 Vali Loss: 3.540 Vali Acc: 0.084 Test Loss: 3.540 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.204094886779785
Epoch: 14, Steps: 10 | Train Loss: 0.916 Vali Loss: 3.657 Vali Acc: 0.098 Test Loss: 3.657 Test Acc: 0.098
Validation loss decreased (-0.091730 --> -0.097610).  Saving model ...
Epoch: 15 cost time: 3.4606738090515137
Epoch: 15, Steps: 10 | Train Loss: 0.707 Vali Loss: 3.756 Vali Acc: 0.100 Test Loss: 3.756 Test Acc: 0.100
Validation loss decreased (-0.097610 --> -0.099962).  Saving model ...
Epoch: 16 cost time: 3.2979042530059814
Epoch: 16, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.903 Vali Acc: 0.107 Test Loss: 3.903 Test Acc: 0.107
Validation loss decreased (-0.099962 --> -0.107020).  Saving model ...
Epoch: 17 cost time: 3.2203402519226074
Epoch: 17, Steps: 10 | Train Loss: 0.354 Vali Loss: 4.039 Vali Acc: 0.100 Test Loss: 4.039 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5507493019104004
Epoch: 18, Steps: 10 | Train Loss: 0.242 Vali Loss: 4.208 Vali Acc: 0.124 Test Loss: 4.208 Test Acc: 0.124
Validation loss decreased (-0.107020 --> -0.123487).  Saving model ...
Epoch: 19 cost time: 3.4223172664642334
Epoch: 19, Steps: 10 | Train Loss: 0.141 Vali Loss: 4.221 Vali Acc: 0.120 Test Loss: 4.221 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.700883388519287
Epoch: 20, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.325 Vali Acc: 0.122 Test Loss: 4.325 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.4078478813171387
Epoch: 21, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.428 Vali Acc: 0.122 Test Loss: 4.428 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.556154727935791
Epoch: 22, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.517 Vali Acc: 0.118 Test Loss: 4.517 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.759711980819702
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.571 Vali Acc: 0.120 Test Loss: 4.571 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.689345121383667
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.596 Vali Acc: 0.124 Test Loss: 4.596 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.604715585708618
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.627 Vali Acc: 0.128 Test Loss: 4.627 Test Acc: 0.128
Validation loss decreased (-0.123487 --> -0.128189).  Saving model ...
Epoch: 26 cost time: 3.5681424140930176
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.695 Vali Acc: 0.126 Test Loss: 4.695 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.034771203994751
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.723 Vali Acc: 0.125 Test Loss: 4.723 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.767935037612915
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.754 Vali Acc: 0.121 Test Loss: 4.754 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.820427417755127
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.774 Vali Acc: 0.119 Test Loss: 4.774 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.669222354888916
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.776 Vali Acc: 0.121 Test Loss: 4.776 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.384535312652588
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.777 Vali Acc: 0.126 Test Loss: 4.777 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.759694814682007
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.789 Vali Acc: 0.128 Test Loss: 4.789 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.4728095531463623
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.820 Vali Acc: 0.126 Test Loss: 4.820 Test Acc: 0.126
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.4243812561035156
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.852 Vali Acc: 0.125 Test Loss: 4.852 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.540012836456299
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.866 Vali Acc: 0.127 Test Loss: 4.866 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12823529411764706
model parameter : 518810
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.99844217300415
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.307 Vali Acc: 0.054 Test Loss: 3.307 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 3.608060359954834
Epoch: 2, Steps: 10 | Train Loss: 3.220 Vali Loss: 3.335 Vali Acc: 0.054 Test Loss: 3.335 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.860278367996216
Epoch: 3, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.398 Vali Acc: 0.049 Test Loss: 3.398 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.38832688331604
Epoch: 4, Steps: 10 | Train Loss: 3.068 Vali Loss: 3.443 Vali Acc: 0.052 Test Loss: 3.443 Test Acc: 0.052
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.306485414505005
Epoch: 5, Steps: 10 | Train Loss: 3.010 Vali Loss: 3.423 Vali Acc: 0.059 Test Loss: 3.423 Test Acc: 0.059
Validation loss decreased (-0.054085 --> -0.058789).  Saving model ...
Epoch: 6 cost time: 3.7054660320281982
Epoch: 6, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.392 Vali Acc: 0.062 Test Loss: 3.392 Test Acc: 0.062
Validation loss decreased (-0.058789 --> -0.062319).  Saving model ...
Epoch: 7 cost time: 3.3894569873809814
Epoch: 7, Steps: 10 | Train Loss: 2.680 Vali Loss: 3.391 Vali Acc: 0.068 Test Loss: 3.391 Test Acc: 0.068
Validation loss decreased (-0.062319 --> -0.068201).  Saving model ...
Epoch: 8 cost time: 3.9688403606414795
Epoch: 8, Steps: 10 | Train Loss: 2.522 Vali Loss: 3.370 Vali Acc: 0.069 Test Loss: 3.370 Test Acc: 0.069
Validation loss decreased (-0.068201 --> -0.069378).  Saving model ...
Epoch: 9 cost time: 3.628335952758789
Epoch: 9, Steps: 10 | Train Loss: 2.333 Vali Loss: 3.390 Vali Acc: 0.071 Test Loss: 3.390 Test Acc: 0.071
Validation loss decreased (-0.069378 --> -0.070554).  Saving model ...
Epoch: 10 cost time: 3.318387508392334
Epoch: 10, Steps: 10 | Train Loss: 2.234 Vali Loss: 3.390 Vali Acc: 0.080 Test Loss: 3.390 Test Acc: 0.080
Validation loss decreased (-0.070554 --> -0.079966).  Saving model ...
Epoch: 11 cost time: 3.762491464614868
Epoch: 11, Steps: 10 | Train Loss: 1.924 Vali Loss: 3.410 Vali Acc: 0.094 Test Loss: 3.410 Test Acc: 0.094
Validation loss decreased (-0.079966 --> -0.094084).  Saving model ...
Epoch: 12 cost time: 3.2458267211914062
Epoch: 12, Steps: 10 | Train Loss: 1.761 Vali Loss: 3.460 Vali Acc: 0.095 Test Loss: 3.460 Test Acc: 0.095
Validation loss decreased (-0.094084 --> -0.095260).  Saving model ...
Epoch: 13 cost time: 3.4802374839782715
Epoch: 13, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.510 Vali Acc: 0.095 Test Loss: 3.510 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4860010147094727
Epoch: 14, Steps: 10 | Train Loss: 1.213 Vali Loss: 3.634 Vali Acc: 0.102 Test Loss: 3.634 Test Acc: 0.102
Validation loss decreased (-0.095260 --> -0.102317).  Saving model ...
Epoch: 15 cost time: 3.301386594772339
Epoch: 15, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.770 Vali Acc: 0.101 Test Loss: 3.770 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.612048387527466
Epoch: 16, Steps: 10 | Train Loss: 0.712 Vali Loss: 3.913 Vali Acc: 0.116 Test Loss: 3.913 Test Acc: 0.116
Validation loss decreased (-0.102317 --> -0.116431).  Saving model ...
Epoch: 17 cost time: 3.535778522491455
Epoch: 17, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.994 Vali Acc: 0.119 Test Loss: 3.994 Test Acc: 0.119
Validation loss decreased (-0.116431 --> -0.118784).  Saving model ...
Epoch: 18 cost time: 3.863675594329834
Epoch: 18, Steps: 10 | Train Loss: 0.412 Vali Loss: 4.086 Vali Acc: 0.140 Test Loss: 4.086 Test Acc: 0.140
Validation loss decreased (-0.118784 --> -0.139959).  Saving model ...
Epoch: 19 cost time: 3.1447973251342773
Epoch: 19, Steps: 10 | Train Loss: 0.248 Vali Loss: 4.228 Vali Acc: 0.134 Test Loss: 4.228 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2335901260375977
Epoch: 20, Steps: 10 | Train Loss: 0.188 Vali Loss: 4.331 Vali Acc: 0.135 Test Loss: 4.331 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.496387004852295
Epoch: 21, Steps: 10 | Train Loss: 0.116 Vali Loss: 4.482 Vali Acc: 0.138 Test Loss: 4.482 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.473151922225952
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.565 Vali Acc: 0.144 Test Loss: 4.565 Test Acc: 0.144
Validation loss decreased (-0.139959 --> -0.143484).  Saving model ...
Epoch: 23 cost time: 3.735621213912964
Epoch: 23, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.573 Vali Acc: 0.140 Test Loss: 4.573 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.865844249725342
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.625 Vali Acc: 0.145 Test Loss: 4.625 Test Acc: 0.145
Validation loss decreased (-0.143484 --> -0.144660).  Saving model ...
Epoch: 25 cost time: 3.771796941757202
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.698 Vali Acc: 0.144 Test Loss: 4.698 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.64373779296875
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.779 Vali Acc: 0.153 Test Loss: 4.779 Test Acc: 0.153
Validation loss decreased (-0.144660 --> -0.152893).  Saving model ...
Epoch: 27 cost time: 3.414334535598755
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.788 Vali Acc: 0.148 Test Loss: 4.788 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3912227153778076
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.820 Vali Acc: 0.148 Test Loss: 4.820 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1053943634033203
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.844 Vali Acc: 0.151 Test Loss: 4.844 Test Acc: 0.151
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.2650225162506104
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.854 Vali Acc: 0.148 Test Loss: 4.854 Test Acc: 0.148
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.3194870948791504
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.867 Vali Acc: 0.147 Test Loss: 4.867 Test Acc: 0.147
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.4583497047424316
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.894 Vali Acc: 0.152 Test Loss: 4.894 Test Acc: 0.152
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.748225212097168
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.937 Vali Acc: 0.154 Test Loss: 4.937 Test Acc: 0.154
Validation loss decreased (-0.152893 --> -0.154068).  Saving model ...
Epoch: 34 cost time: 3.5367372035980225
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.965 Vali Acc: 0.151 Test Loss: 4.965 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.4071757793426514
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.971 Vali Acc: 0.151 Test Loss: 4.971 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.622798442840576
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.980 Vali Acc: 0.151 Test Loss: 4.980 Test Acc: 0.151
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.232308864593506
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.998 Vali Acc: 0.155 Test Loss: 4.998 Test Acc: 0.155
Validation loss decreased (-0.154068 --> -0.155244).  Saving model ...
Epoch: 38 cost time: 3.217533826828003
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.011 Vali Acc: 0.158 Test Loss: 5.011 Test Acc: 0.158
Validation loss decreased (-0.155244 --> -0.157597).  Saving model ...
Epoch: 39 cost time: 3.5651626586914062
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.025 Vali Acc: 0.155 Test Loss: 5.025 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.845288038253784
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.033 Vali Acc: 0.162 Test Loss: 5.033 Test Acc: 0.162
Validation loss decreased (-0.157597 --> -0.162303).  Saving model ...
Epoch: 41 cost time: 3.7631587982177734
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.045 Vali Acc: 0.160 Test Loss: 5.045 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.720355987548828
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.058 Vali Acc: 0.159 Test Loss: 5.058 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.202725648880005
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.080 Vali Acc: 0.153 Test Loss: 5.080 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.334040880203247
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.103 Vali Acc: 0.156 Test Loss: 5.103 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.7162437438964844
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.126 Vali Acc: 0.159 Test Loss: 5.126 Test Acc: 0.159
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.4513068199157715
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.144 Vali Acc: 0.158 Test Loss: 5.144 Test Acc: 0.158
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 4.206197738647461
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.157 Vali Acc: 0.155 Test Loss: 5.157 Test Acc: 0.155
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 4.043530464172363
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.166 Vali Acc: 0.159 Test Loss: 5.166 Test Acc: 0.159
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.867095470428467
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.184 Vali Acc: 0.159 Test Loss: 5.184 Test Acc: 0.159
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.579523801803589
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.204 Vali Acc: 0.159 Test Loss: 5.204 Test Acc: 0.159
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1623529411764706
model parameter : 518810
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.701605319976807
Epoch: 1, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.258 Vali Acc: 0.040 Test Loss: 3.258 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.1724181175231934
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.040 Test Loss: 3.258 Test Acc: 0.040
Validation loss decreased (-0.039967 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 3.4307992458343506
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.850139856338501
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.802295207977295
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.710233449935913
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.5686864852905273
Epoch: 7, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.691179037094116
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.0503017902374268
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.5099170207977295
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.3137130737304688
Epoch: 11, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.6488494873046875
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.04
model parameter : 518810
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.285286903381348
Epoch: 1, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.272 Vali Acc: 0.061 Test Loss: 3.272 Test Acc: 0.061
Validation loss decreased (inf --> -0.061144).  Saving model ...
Epoch: 2 cost time: 3.4627866744995117
Epoch: 2, Steps: 10 | Train Loss: 3.044 Vali Loss: 3.257 Vali Acc: 0.086 Test Loss: 3.257 Test Acc: 0.086
Validation loss decreased (-0.061144 --> -0.085850).  Saving model ...
Epoch: 3 cost time: 3.584749937057495
Epoch: 3, Steps: 10 | Train Loss: 2.701 Vali Loss: 3.243 Vali Acc: 0.113 Test Loss: 3.243 Test Acc: 0.113
Validation loss decreased (-0.085850 --> -0.112909).  Saving model ...
Epoch: 4 cost time: 4.174371242523193
Epoch: 4, Steps: 10 | Train Loss: 2.388 Vali Loss: 3.178 Vali Acc: 0.145 Test Loss: 3.178 Test Acc: 0.145
Validation loss decreased (-0.112909 --> -0.144674).  Saving model ...
Epoch: 5 cost time: 4.019229412078857
Epoch: 5, Steps: 10 | Train Loss: 1.991 Vali Loss: 3.130 Vali Acc: 0.188 Test Loss: 3.130 Test Acc: 0.188
Validation loss decreased (-0.144674 --> -0.188204).  Saving model ...
Epoch: 6 cost time: 3.8510375022888184
Epoch: 6, Steps: 10 | Train Loss: 1.596 Vali Loss: 3.106 Vali Acc: 0.191 Test Loss: 3.106 Test Acc: 0.191
Validation loss decreased (-0.188204 --> -0.190557).  Saving model ...
Epoch: 7 cost time: 3.783552408218384
Epoch: 7, Steps: 10 | Train Loss: 1.259 Vali Loss: 3.129 Vali Acc: 0.224 Test Loss: 3.129 Test Acc: 0.224
Validation loss decreased (-0.190557 --> -0.223498).  Saving model ...
Epoch: 8 cost time: 3.3784806728363037
Epoch: 8, Steps: 10 | Train Loss: 0.955 Vali Loss: 3.171 Vali Acc: 0.226 Test Loss: 3.171 Test Acc: 0.226
Validation loss decreased (-0.223498 --> -0.225851).  Saving model ...
Epoch: 9 cost time: 3.556600570678711
Epoch: 9, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.231 Vali Acc: 0.253 Test Loss: 3.231 Test Acc: 0.253
Validation loss decreased (-0.225851 --> -0.252909).  Saving model ...
Epoch: 10 cost time: 3.802692413330078
Epoch: 10, Steps: 10 | Train Loss: 0.488 Vali Loss: 3.265 Vali Acc: 0.267 Test Loss: 3.265 Test Acc: 0.267
Validation loss decreased (-0.252909 --> -0.267026).  Saving model ...
Epoch: 11 cost time: 4.090972661972046
Epoch: 11, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.355 Vali Acc: 0.274 Test Loss: 3.355 Test Acc: 0.274
Validation loss decreased (-0.267026 --> -0.274084).  Saving model ...
Epoch: 12 cost time: 3.892855644226074
Epoch: 12, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.476 Vali Acc: 0.282 Test Loss: 3.476 Test Acc: 0.282
Validation loss decreased (-0.274084 --> -0.282318).  Saving model ...
Epoch: 13 cost time: 3.830615282058716
Epoch: 13, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.486 Vali Acc: 0.285 Test Loss: 3.486 Test Acc: 0.285
Validation loss decreased (-0.282318 --> -0.284671).  Saving model ...
Epoch: 14 cost time: 3.6923398971557617
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.540 Vali Acc: 0.299 Test Loss: 3.540 Test Acc: 0.299
Validation loss decreased (-0.284671 --> -0.298788).  Saving model ...
Epoch: 15 cost time: 3.373683214187622
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.655 Vali Acc: 0.298 Test Loss: 3.655 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.443193197250366
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.679 Vali Acc: 0.293 Test Loss: 3.679 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.609217405319214
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.788 Vali Acc: 0.291 Test Loss: 3.788 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.7890655994415283
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.796 Vali Acc: 0.301 Test Loss: 3.796 Test Acc: 0.301
Validation loss decreased (-0.298788 --> -0.301139).  Saving model ...
Epoch: 19 cost time: 3.4373350143432617
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.813 Vali Acc: 0.306 Test Loss: 3.813 Test Acc: 0.306
Validation loss decreased (-0.301139 --> -0.305844).  Saving model ...
Epoch: 20 cost time: 3.9166109561920166
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.835 Vali Acc: 0.301 Test Loss: 3.835 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5013604164123535
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.872 Vali Acc: 0.304 Test Loss: 3.872 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.636201858520508
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.901 Vali Acc: 0.305 Test Loss: 3.901 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5668234825134277
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.923 Vali Acc: 0.301 Test Loss: 3.923 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.7960174083709717
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.941 Vali Acc: 0.301 Test Loss: 3.941 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.3847482204437256
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.969 Vali Acc: 0.306 Test Loss: 3.969 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.40272855758667
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.990 Vali Acc: 0.309 Test Loss: 3.990 Test Acc: 0.309
Validation loss decreased (-0.305844 --> -0.309372).  Saving model ...
Epoch: 27 cost time: 3.5072121620178223
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.018 Vali Acc: 0.307 Test Loss: 4.018 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.268739938735962
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.040 Vali Acc: 0.309 Test Loss: 4.040 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.8024861812591553
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.068 Vali Acc: 0.304 Test Loss: 4.068 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.5343644618988037
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.090 Vali Acc: 0.304 Test Loss: 4.090 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.4525816440582275
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.103 Vali Acc: 0.304 Test Loss: 4.103 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.018806219100952
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.123 Vali Acc: 0.307 Test Loss: 4.123 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.8095526695251465
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.134 Vali Acc: 0.309 Test Loss: 4.134 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.5260441303253174
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.148 Vali Acc: 0.307 Test Loss: 4.148 Test Acc: 0.307
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.073312282562256
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.168 Vali Acc: 0.309 Test Loss: 4.168 Test Acc: 0.309
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.193171262741089
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.187 Vali Acc: 0.307 Test Loss: 4.187 Test Acc: 0.307
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 469658
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.5842814445495605
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.269 Vali Acc: 0.055 Test Loss: 3.269 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 3.175354242324829
Epoch: 2, Steps: 10 | Train Loss: 3.042 Vali Loss: 3.259 Vali Acc: 0.080 Test Loss: 3.259 Test Acc: 0.080
Validation loss decreased (-0.055261 --> -0.079967).  Saving model ...
Epoch: 3 cost time: 3.507633924484253
Epoch: 3, Steps: 10 | Train Loss: 2.711 Vali Loss: 3.254 Vali Acc: 0.105 Test Loss: 3.254 Test Acc: 0.105
Validation loss decreased (-0.079967 --> -0.104673).  Saving model ...
Epoch: 4 cost time: 3.6070971488952637
Epoch: 4, Steps: 10 | Train Loss: 2.383 Vali Loss: 3.190 Vali Acc: 0.148 Test Loss: 3.190 Test Acc: 0.148
Validation loss decreased (-0.104673 --> -0.148203).  Saving model ...
Epoch: 5 cost time: 3.4049551486968994
Epoch: 5, Steps: 10 | Train Loss: 1.985 Vali Loss: 3.138 Vali Acc: 0.180 Test Loss: 3.138 Test Acc: 0.180
Validation loss decreased (-0.148203 --> -0.179969).  Saving model ...
Epoch: 6 cost time: 3.4389967918395996
Epoch: 6, Steps: 10 | Train Loss: 1.606 Vali Loss: 3.114 Vali Acc: 0.196 Test Loss: 3.114 Test Acc: 0.196
Validation loss decreased (-0.179969 --> -0.196439).  Saving model ...
Epoch: 7 cost time: 3.2835512161254883
Epoch: 7, Steps: 10 | Train Loss: 1.281 Vali Loss: 3.135 Vali Acc: 0.224 Test Loss: 3.135 Test Acc: 0.224
Validation loss decreased (-0.196439 --> -0.223498).  Saving model ...
Epoch: 8 cost time: 3.898223400115967
Epoch: 8, Steps: 10 | Train Loss: 0.976 Vali Loss: 3.177 Vali Acc: 0.234 Test Loss: 3.177 Test Acc: 0.234
Validation loss decreased (-0.223498 --> -0.234086).  Saving model ...
Epoch: 9 cost time: 4.007153272628784
Epoch: 9, Steps: 10 | Train Loss: 0.718 Vali Loss: 3.252 Vali Acc: 0.260 Test Loss: 3.252 Test Acc: 0.260
Validation loss decreased (-0.234086 --> -0.259967).  Saving model ...
Epoch: 10 cost time: 3.839268684387207
Epoch: 10, Steps: 10 | Train Loss: 0.497 Vali Loss: 3.280 Vali Acc: 0.271 Test Loss: 3.280 Test Acc: 0.271
Validation loss decreased (-0.259967 --> -0.270555).  Saving model ...
Epoch: 11 cost time: 3.724895477294922
Epoch: 11, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.363 Vali Acc: 0.291 Test Loss: 3.363 Test Acc: 0.291
Validation loss decreased (-0.270555 --> -0.290555).  Saving model ...
Epoch: 12 cost time: 3.7160792350769043
Epoch: 12, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.493 Vali Acc: 0.282 Test Loss: 3.493 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4887309074401855
Epoch: 13, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.552 Vali Acc: 0.294 Test Loss: 3.552 Test Acc: 0.294
Validation loss decreased (-0.290555 --> -0.294082).  Saving model ...
Epoch: 14 cost time: 3.3445496559143066
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.581 Vali Acc: 0.309 Test Loss: 3.581 Test Acc: 0.309
Validation loss decreased (-0.294082 --> -0.309376).  Saving model ...
Epoch: 15 cost time: 3.8278064727783203
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.701 Vali Acc: 0.302 Test Loss: 3.701 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.700575113296509
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.743 Vali Acc: 0.305 Test Loss: 3.743 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.762174367904663
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.823 Vali Acc: 0.301 Test Loss: 3.823 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6098875999450684
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.834 Vali Acc: 0.316 Test Loss: 3.834 Test Acc: 0.316
Validation loss decreased (-0.309376 --> -0.316432).  Saving model ...
Epoch: 19 cost time: 3.363328218460083
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.848 Vali Acc: 0.309 Test Loss: 3.848 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3162460327148438
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.878 Vali Acc: 0.311 Test Loss: 3.878 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6619179248809814
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.924 Vali Acc: 0.312 Test Loss: 3.924 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.064128875732422
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.953 Vali Acc: 0.319 Test Loss: 3.953 Test Acc: 0.319
Validation loss decreased (-0.316432 --> -0.318784).  Saving model ...
Epoch: 23 cost time: 3.814246654510498
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.977 Vali Acc: 0.315 Test Loss: 3.977 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.692413806915283
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.001 Vali Acc: 0.314 Test Loss: 4.001 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.523677349090576
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.044 Vali Acc: 0.315 Test Loss: 4.044 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.598287582397461
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.064 Vali Acc: 0.320 Test Loss: 4.064 Test Acc: 0.320
Validation loss decreased (-0.318784 --> -0.319959).  Saving model ...
Epoch: 27 cost time: 3.5352001190185547
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.095 Vali Acc: 0.321 Test Loss: 4.095 Test Acc: 0.321
Validation loss decreased (-0.319959 --> -0.321136).  Saving model ...
Epoch: 28 cost time: 3.7895090579986572
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.118 Vali Acc: 0.318 Test Loss: 4.118 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.5525078773498535
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.131 Vali Acc: 0.316 Test Loss: 4.131 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.67151141166687
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.145 Vali Acc: 0.315 Test Loss: 4.145 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.6733381748199463
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.162 Vali Acc: 0.319 Test Loss: 4.162 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.6682820320129395
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.186 Vali Acc: 0.319 Test Loss: 4.186 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.857332706451416
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.205 Vali Acc: 0.320 Test Loss: 4.205 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.706139087677002
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.219 Vali Acc: 0.321 Test Loss: 4.219 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.026830434799194
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.238 Vali Acc: 0.321 Test Loss: 4.238 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.345168352127075
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.252 Vali Acc: 0.324 Test Loss: 4.252 Test Acc: 0.324
Validation loss decreased (-0.321136 --> -0.323487).  Saving model ...
Epoch: 37 cost time: 3.3655436038970947
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.273 Vali Acc: 0.320 Test Loss: 4.273 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.6227219104766846
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.301 Vali Acc: 0.318 Test Loss: 4.301 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.786540985107422
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.321 Vali Acc: 0.318 Test Loss: 4.321 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 4.066582679748535
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.337 Vali Acc: 0.318 Test Loss: 4.337 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.698971748352051
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.347 Vali Acc: 0.318 Test Loss: 4.347 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.41389799118042
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.355 Vali Acc: 0.320 Test Loss: 4.355 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.2769734859466553
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.374 Vali Acc: 0.318 Test Loss: 4.374 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.262298107147217
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.390 Vali Acc: 0.316 Test Loss: 4.390 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.494485855102539
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.400 Vali Acc: 0.319 Test Loss: 4.400 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.8523294925689697
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.407 Vali Acc: 0.320 Test Loss: 4.407 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 469658
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.393908739089966
Epoch: 1, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.308 Vali Acc: 0.047 Test Loss: 3.308 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 3.6158270835876465
Epoch: 2, Steps: 10 | Train Loss: 3.054 Vali Loss: 3.280 Vali Acc: 0.072 Test Loss: 3.280 Test Acc: 0.072
Validation loss decreased (-0.047026 --> -0.071732).  Saving model ...
Epoch: 3 cost time: 3.224189043045044
Epoch: 3, Steps: 10 | Train Loss: 2.708 Vali Loss: 3.280 Vali Acc: 0.115 Test Loss: 3.280 Test Acc: 0.115
Validation loss decreased (-0.071732 --> -0.115261).  Saving model ...
Epoch: 4 cost time: 3.8314576148986816
Epoch: 4, Steps: 10 | Train Loss: 2.384 Vali Loss: 3.228 Vali Acc: 0.138 Test Loss: 3.228 Test Acc: 0.138
Validation loss decreased (-0.115261 --> -0.137615).  Saving model ...
Epoch: 5 cost time: 3.67331600189209
Epoch: 5, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.190 Vali Acc: 0.153 Test Loss: 3.190 Test Acc: 0.153
Validation loss decreased (-0.137615 --> -0.152909).  Saving model ...
Epoch: 6 cost time: 3.796708822250366
Epoch: 6, Steps: 10 | Train Loss: 1.678 Vali Loss: 3.174 Vali Acc: 0.188 Test Loss: 3.174 Test Acc: 0.188
Validation loss decreased (-0.152909 --> -0.188204).  Saving model ...
Epoch: 7 cost time: 3.6638975143432617
Epoch: 7, Steps: 10 | Train Loss: 1.367 Vali Loss: 3.212 Vali Acc: 0.245 Test Loss: 3.212 Test Acc: 0.245
Validation loss decreased (-0.188204 --> -0.244674).  Saving model ...
Epoch: 8 cost time: 3.4621360301971436
Epoch: 8, Steps: 10 | Train Loss: 1.085 Vali Loss: 3.247 Vali Acc: 0.261 Test Loss: 3.247 Test Acc: 0.261
Validation loss decreased (-0.244674 --> -0.261144).  Saving model ...
Epoch: 9 cost time: 3.4136312007904053
Epoch: 9, Steps: 10 | Train Loss: 0.845 Vali Loss: 3.316 Vali Acc: 0.259 Test Loss: 3.316 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8024215698242188
Epoch: 10, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.335 Vali Acc: 0.269 Test Loss: 3.335 Test Acc: 0.269
Validation loss decreased (-0.261144 --> -0.269378).  Saving model ...
Epoch: 11 cost time: 3.665947198867798
Epoch: 11, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.395 Vali Acc: 0.287 Test Loss: 3.395 Test Acc: 0.287
Validation loss decreased (-0.269378 --> -0.287025).  Saving model ...
Epoch: 12 cost time: 3.7242178916931152
Epoch: 12, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.507 Vali Acc: 0.288 Test Loss: 3.507 Test Acc: 0.288
Validation loss decreased (-0.287025 --> -0.288200).  Saving model ...
Epoch: 13 cost time: 3.959747076034546
Epoch: 13, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.565 Vali Acc: 0.300 Test Loss: 3.565 Test Acc: 0.300
Validation loss decreased (-0.288200 --> -0.299964).  Saving model ...
Epoch: 14 cost time: 3.1174678802490234
Epoch: 14, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.603 Vali Acc: 0.314 Test Loss: 3.603 Test Acc: 0.314
Validation loss decreased (-0.299964 --> -0.314082).  Saving model ...
Epoch: 15 cost time: 3.7281739711761475
Epoch: 15, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.743 Vali Acc: 0.301 Test Loss: 3.743 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8308358192443848
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.765 Vali Acc: 0.314 Test Loss: 3.765 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6193225383758545
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.877 Vali Acc: 0.313 Test Loss: 3.877 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.7801690101623535
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.889 Vali Acc: 0.313 Test Loss: 3.889 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.495651960372925
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.920 Vali Acc: 0.320 Test Loss: 3.920 Test Acc: 0.320
Validation loss decreased (-0.314082 --> -0.319961).  Saving model ...
Epoch: 20 cost time: 3.4110796451568604
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.965 Vali Acc: 0.321 Test Loss: 3.965 Test Acc: 0.321
Validation loss decreased (-0.319961 --> -0.321137).  Saving model ...
Epoch: 21 cost time: 3.2634024620056152
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.014 Vali Acc: 0.312 Test Loss: 4.014 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.298241376876831
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.042 Vali Acc: 0.319 Test Loss: 4.042 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.134714365005493
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.075 Vali Acc: 0.318 Test Loss: 4.075 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.61741304397583
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.103 Vali Acc: 0.320 Test Loss: 4.103 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.9364538192749023
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.148 Vali Acc: 0.313 Test Loss: 4.148 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.6715168952941895
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.173 Vali Acc: 0.319 Test Loss: 4.173 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.5146706104278564
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.211 Vali Acc: 0.318 Test Loss: 4.211 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.675901412963867
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.238 Vali Acc: 0.316 Test Loss: 4.238 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.7407915592193604
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.250 Vali Acc: 0.316 Test Loss: 4.250 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.574218988418579
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.266 Vali Acc: 0.324 Test Loss: 4.266 Test Acc: 0.324
Validation loss decreased (-0.321137 --> -0.323487).  Saving model ...
Epoch: 31 cost time: 3.431014060974121
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.282 Vali Acc: 0.325 Test Loss: 4.282 Test Acc: 0.325
Validation loss decreased (-0.323487 --> -0.324663).  Saving model ...
Epoch: 32 cost time: 3.7056291103363037
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.311 Vali Acc: 0.327 Test Loss: 4.311 Test Acc: 0.327
Validation loss decreased (-0.324663 --> -0.327016).  Saving model ...
Epoch: 33 cost time: 3.7287893295288086
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.334 Vali Acc: 0.322 Test Loss: 4.334 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.5863890647888184
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.352 Vali Acc: 0.326 Test Loss: 4.352 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.8320446014404297
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.375 Vali Acc: 0.328 Test Loss: 4.375 Test Acc: 0.328
Validation loss decreased (-0.327016 --> -0.328192).  Saving model ...
Epoch: 36 cost time: 3.675800085067749
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.393 Vali Acc: 0.332 Test Loss: 4.393 Test Acc: 0.332
Validation loss decreased (-0.328192 --> -0.331721).  Saving model ...
Epoch: 37 cost time: 3.2084836959838867
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.415 Vali Acc: 0.333 Test Loss: 4.415 Test Acc: 0.333
Validation loss decreased (-0.331721 --> -0.332897).  Saving model ...
Epoch: 38 cost time: 3.9147496223449707
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.450 Vali Acc: 0.328 Test Loss: 4.450 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.636523723602295
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.471 Vali Acc: 0.329 Test Loss: 4.471 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.320563793182373
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.484 Vali Acc: 0.329 Test Loss: 4.484 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.3995070457458496
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.492 Vali Acc: 0.329 Test Loss: 4.492 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.895378828048706
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.506 Vali Acc: 0.328 Test Loss: 4.506 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 4.434718370437622
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.526 Vali Acc: 0.332 Test Loss: 4.526 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.295581340789795
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.545 Vali Acc: 0.332 Test Loss: 4.545 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.499533176422119
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.558 Vali Acc: 0.333 Test Loss: 4.558 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.7951173782348633
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.564 Vali Acc: 0.334 Test Loss: 4.564 Test Acc: 0.334
Validation loss decreased (-0.332897 --> -0.334072).  Saving model ...
Epoch: 47 cost time: 3.705883502960205
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.573 Vali Acc: 0.332 Test Loss: 4.573 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 4.188795804977417
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.585 Vali Acc: 0.333 Test Loss: 4.585 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.759453058242798
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.601 Vali Acc: 0.332 Test Loss: 4.601 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.8798036575317383
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.614 Vali Acc: 0.332 Test Loss: 4.614 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.8919997215270996
Epoch: 51, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.630 Vali Acc: 0.331 Test Loss: 4.630 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.660184383392334
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.644 Vali Acc: 0.329 Test Loss: 4.644 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.1768593788146973
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.658 Vali Acc: 0.329 Test Loss: 4.658 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 3.0329031944274902
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.668 Vali Acc: 0.326 Test Loss: 4.668 Test Acc: 0.326
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 3.1954095363616943
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.682 Vali Acc: 0.328 Test Loss: 4.682 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 3.5346603393554688
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.691 Vali Acc: 0.331 Test Loss: 4.691 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 469658
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.772602081298828
Epoch: 1, Steps: 10 | Train Loss: 3.311 Vali Loss: 3.298 Vali Acc: 0.040 Test Loss: 3.298 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.0271658897399902
Epoch: 2, Steps: 10 | Train Loss: 3.068 Vali Loss: 3.281 Vali Acc: 0.086 Test Loss: 3.281 Test Acc: 0.086
Validation loss decreased (-0.039967 --> -0.085850).  Saving model ...
Epoch: 3 cost time: 3.664386034011841
Epoch: 3, Steps: 10 | Train Loss: 2.739 Vali Loss: 3.301 Vali Acc: 0.115 Test Loss: 3.301 Test Acc: 0.115
Validation loss decreased (-0.085850 --> -0.115261).  Saving model ...
Epoch: 4 cost time: 3.2591190338134766
Epoch: 4, Steps: 10 | Train Loss: 2.441 Vali Loss: 3.278 Vali Acc: 0.131 Test Loss: 3.278 Test Acc: 0.131
Validation loss decreased (-0.115261 --> -0.130555).  Saving model ...
Epoch: 5 cost time: 3.7505035400390625
Epoch: 5, Steps: 10 | Train Loss: 2.070 Vali Loss: 3.265 Vali Acc: 0.149 Test Loss: 3.265 Test Acc: 0.149
Validation loss decreased (-0.130555 --> -0.149379).  Saving model ...
Epoch: 6 cost time: 3.0307750701904297
Epoch: 6, Steps: 10 | Train Loss: 1.745 Vali Loss: 3.279 Vali Acc: 0.169 Test Loss: 3.279 Test Acc: 0.169
Validation loss decreased (-0.149379 --> -0.169379).  Saving model ...
Epoch: 7 cost time: 3.1382784843444824
Epoch: 7, Steps: 10 | Train Loss: 1.418 Vali Loss: 3.335 Vali Acc: 0.174 Test Loss: 3.335 Test Acc: 0.174
Validation loss decreased (-0.169379 --> -0.174084).  Saving model ...
Epoch: 8 cost time: 3.601876974105835
Epoch: 8, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.412 Vali Acc: 0.185 Test Loss: 3.412 Test Acc: 0.185
Validation loss decreased (-0.174084 --> -0.184672).  Saving model ...
Epoch: 9 cost time: 3.6525282859802246
Epoch: 9, Steps: 10 | Train Loss: 0.914 Vali Loss: 3.480 Vali Acc: 0.185 Test Loss: 3.480 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4991307258605957
Epoch: 10, Steps: 10 | Train Loss: 0.687 Vali Loss: 3.541 Vali Acc: 0.205 Test Loss: 3.541 Test Acc: 0.205
Validation loss decreased (-0.184672 --> -0.204670).  Saving model ...
Epoch: 11 cost time: 3.3124256134033203
Epoch: 11, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.632 Vali Acc: 0.220 Test Loss: 3.632 Test Acc: 0.220
Validation loss decreased (-0.204670 --> -0.219964).  Saving model ...
Epoch: 12 cost time: 3.7256569862365723
Epoch: 12, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.750 Vali Acc: 0.235 Test Loss: 3.750 Test Acc: 0.235
Validation loss decreased (-0.219964 --> -0.235257).  Saving model ...
Epoch: 13 cost time: 3.874455451965332
Epoch: 13, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.752 Vali Acc: 0.247 Test Loss: 3.752 Test Acc: 0.247
Validation loss decreased (-0.235257 --> -0.247021).  Saving model ...
Epoch: 14 cost time: 3.992445468902588
Epoch: 14, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.879 Vali Acc: 0.242 Test Loss: 3.879 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5606305599212646
Epoch: 15, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.033 Vali Acc: 0.254 Test Loss: 4.033 Test Acc: 0.254
Validation loss decreased (-0.247021 --> -0.254077).  Saving model ...
Epoch: 16 cost time: 3.9326279163360596
Epoch: 16, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.066 Vali Acc: 0.259 Test Loss: 4.066 Test Acc: 0.259
Validation loss decreased (-0.254077 --> -0.258783).  Saving model ...
Epoch: 17 cost time: 3.3965003490448
Epoch: 17, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.230 Vali Acc: 0.234 Test Loss: 4.230 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.742842197418213
Epoch: 18, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.222 Vali Acc: 0.258 Test Loss: 4.222 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.9109292030334473
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.243 Vali Acc: 0.259 Test Loss: 4.243 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5978899002075195
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.304 Vali Acc: 0.256 Test Loss: 4.304 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.464639663696289
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.377 Vali Acc: 0.253 Test Loss: 4.377 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.998154640197754
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.415 Vali Acc: 0.254 Test Loss: 4.415 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.7976224422454834
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.441 Vali Acc: 0.258 Test Loss: 4.441 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.3455255031585693
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.471 Vali Acc: 0.260 Test Loss: 4.471 Test Acc: 0.260
Validation loss decreased (-0.258783 --> -0.259955).  Saving model ...
Epoch: 25 cost time: 3.556016683578491
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.521 Vali Acc: 0.262 Test Loss: 4.521 Test Acc: 0.262
Validation loss decreased (-0.259955 --> -0.262308).  Saving model ...
Epoch: 26 cost time: 3.8164682388305664
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.552 Vali Acc: 0.265 Test Loss: 4.552 Test Acc: 0.265
Validation loss decreased (-0.262308 --> -0.264660).  Saving model ...
Epoch: 27 cost time: 3.833787441253662
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.586 Vali Acc: 0.261 Test Loss: 4.586 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.705620288848877
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.612 Vali Acc: 0.259 Test Loss: 4.612 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6231448650360107
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.638 Vali Acc: 0.262 Test Loss: 4.638 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.4700815677642822
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.664 Vali Acc: 0.261 Test Loss: 4.664 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.6286630630493164
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.689 Vali Acc: 0.265 Test Loss: 4.689 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.8601531982421875
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.724 Vali Acc: 0.267 Test Loss: 4.724 Test Acc: 0.267
Validation loss decreased (-0.264660 --> -0.267012).  Saving model ...
Epoch: 33 cost time: 3.7401506900787354
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.739 Vali Acc: 0.267 Test Loss: 4.739 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.054314136505127
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.762 Vali Acc: 0.264 Test Loss: 4.762 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.5425682067871094
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.784 Vali Acc: 0.264 Test Loss: 4.784 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.437536239624023
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.805 Vali Acc: 0.261 Test Loss: 4.805 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.885861873626709
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.830 Vali Acc: 0.265 Test Loss: 4.830 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.5016026496887207
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.863 Vali Acc: 0.265 Test Loss: 4.863 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.717663526535034
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.881 Vali Acc: 0.267 Test Loss: 4.881 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.439765691757202
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.892 Vali Acc: 0.268 Test Loss: 4.892 Test Acc: 0.268
Validation loss decreased (-0.267012 --> -0.268186).  Saving model ...
Epoch: 41 cost time: 3.3340415954589844
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.903 Vali Acc: 0.268 Test Loss: 4.903 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.4806103706359863
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.918 Vali Acc: 0.267 Test Loss: 4.918 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.8972175121307373
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.943 Vali Acc: 0.268 Test Loss: 4.943 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.741163730621338
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.965 Vali Acc: 0.267 Test Loss: 4.965 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.668958902359009
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.980 Vali Acc: 0.269 Test Loss: 4.980 Test Acc: 0.269
Validation loss decreased (-0.268186 --> -0.269362).  Saving model ...
Epoch: 46 cost time: 3.990201473236084
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.989 Vali Acc: 0.271 Test Loss: 4.989 Test Acc: 0.271
Validation loss decreased (-0.269362 --> -0.270538).  Saving model ...
Epoch: 47 cost time: 3.846153974533081
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.997 Vali Acc: 0.267 Test Loss: 4.997 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 4.015776634216309
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.009 Vali Acc: 0.267 Test Loss: 5.009 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.7525038719177246
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.027 Vali Acc: 0.266 Test Loss: 5.027 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.2590436935424805
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.047 Vali Acc: 0.266 Test Loss: 5.047 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.7566421031951904
Epoch: 51, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.064 Vali Acc: 0.267 Test Loss: 5.064 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.8144967555999756
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.075 Vali Acc: 0.271 Test Loss: 5.075 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.7839906215667725
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.086 Vali Acc: 0.269 Test Loss: 5.086 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 3.575427770614624
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.101 Vali Acc: 0.269 Test Loss: 5.101 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 4.069658994674683
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.124 Vali Acc: 0.269 Test Loss: 5.124 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 4.090799331665039
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.135 Vali Acc: 0.272 Test Loss: 5.135 Test Acc: 0.272
Validation loss decreased (-0.270538 --> -0.271713).  Saving model ...
Epoch: 57 cost time: 3.6600699424743652
Epoch: 57, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.142 Vali Acc: 0.269 Test Loss: 5.142 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.8142056465148926
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.149 Vali Acc: 0.268 Test Loss: 5.149 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.8187623023986816
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.160 Vali Acc: 0.267 Test Loss: 5.160 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.5221803188323975
Epoch: 60, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.171 Vali Acc: 0.271 Test Loss: 5.171 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.579111099243164
Epoch: 61, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.188 Vali Acc: 0.272 Test Loss: 5.188 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 4.017215728759766
Epoch: 62, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.206 Vali Acc: 0.269 Test Loss: 5.206 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 4.145859479904175
Epoch: 63, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.222 Vali Acc: 0.269 Test Loss: 5.222 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 3.702624797821045
Epoch: 64, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.236 Vali Acc: 0.271 Test Loss: 5.236 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 3.3009276390075684
Epoch: 65, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.251 Vali Acc: 0.273 Test Loss: 5.251 Test Acc: 0.273
Validation loss decreased (-0.271713 --> -0.272889).  Saving model ...
Epoch: 66 cost time: 3.5654680728912354
Epoch: 66, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.261 Vali Acc: 0.272 Test Loss: 5.261 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 3.5679240226745605
Epoch: 67, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.271 Vali Acc: 0.269 Test Loss: 5.271 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 3.762956142425537
Epoch: 68, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.283 Vali Acc: 0.269 Test Loss: 5.283 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 3.6025662422180176
Epoch: 69, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.293 Vali Acc: 0.269 Test Loss: 5.293 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 3.790245771408081
Epoch: 70, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.298 Vali Acc: 0.268 Test Loss: 5.298 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 3.9030561447143555
Epoch: 71, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.306 Vali Acc: 0.267 Test Loss: 5.306 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 3.4271445274353027
Epoch: 72, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.314 Vali Acc: 0.267 Test Loss: 5.314 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 3.539771556854248
Epoch: 73, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.327 Vali Acc: 0.268 Test Loss: 5.327 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 3.9008851051330566
Epoch: 74, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.339 Vali Acc: 0.271 Test Loss: 5.339 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 4.109052419662476
Epoch: 75, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.353 Vali Acc: 0.271 Test Loss: 5.353 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 469658
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.988229990005493
Epoch: 1, Steps: 10 | Train Loss: 3.347 Vali Loss: 3.302 Vali Acc: 0.048 Test Loss: 3.302 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 3.939887046813965
Epoch: 2, Steps: 10 | Train Loss: 3.136 Vali Loss: 3.325 Vali Acc: 0.055 Test Loss: 3.325 Test Acc: 0.055
Validation loss decreased (-0.048202 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 4.138435125350952
Epoch: 3, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.367 Vali Acc: 0.071 Test Loss: 3.367 Test Acc: 0.071
Validation loss decreased (-0.055261 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 3.6523540019989014
Epoch: 4, Steps: 10 | Train Loss: 2.630 Vali Loss: 3.362 Vali Acc: 0.084 Test Loss: 3.362 Test Acc: 0.084
Validation loss decreased (-0.070555 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 3.4934353828430176
Epoch: 5, Steps: 10 | Train Loss: 2.254 Vali Loss: 3.358 Vali Acc: 0.089 Test Loss: 3.358 Test Acc: 0.089
Validation loss decreased (-0.083496 --> -0.089378).  Saving model ...
Epoch: 6 cost time: 3.598400831222534
Epoch: 6, Steps: 10 | Train Loss: 1.939 Vali Loss: 3.364 Vali Acc: 0.093 Test Loss: 3.364 Test Acc: 0.093
Validation loss decreased (-0.089378 --> -0.092908).  Saving model ...
Epoch: 7 cost time: 3.7580389976501465
Epoch: 7, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.410 Vali Acc: 0.105 Test Loss: 3.410 Test Acc: 0.105
Validation loss decreased (-0.092908 --> -0.104672).  Saving model ...
Epoch: 8 cost time: 3.276017427444458
Epoch: 8, Steps: 10 | Train Loss: 1.292 Vali Loss: 3.490 Vali Acc: 0.111 Test Loss: 3.490 Test Acc: 0.111
Validation loss decreased (-0.104672 --> -0.110553).  Saving model ...
Epoch: 9 cost time: 3.0840935707092285
Epoch: 9, Steps: 10 | Train Loss: 0.996 Vali Loss: 3.603 Vali Acc: 0.116 Test Loss: 3.603 Test Acc: 0.116
Validation loss decreased (-0.110553 --> -0.116435).  Saving model ...
Epoch: 10 cost time: 3.92899489402771
Epoch: 10, Steps: 10 | Train Loss: 0.737 Vali Loss: 3.698 Vali Acc: 0.116 Test Loss: 3.698 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9473507404327393
Epoch: 11, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.801 Vali Acc: 0.128 Test Loss: 3.801 Test Acc: 0.128
Validation loss decreased (-0.116435 --> -0.128197).  Saving model ...
Epoch: 12 cost time: 3.683391571044922
Epoch: 12, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.997 Vali Acc: 0.134 Test Loss: 3.997 Test Acc: 0.134
Validation loss decreased (-0.128197 --> -0.134078).  Saving model ...
Epoch: 13 cost time: 3.445559024810791
Epoch: 13, Steps: 10 | Train Loss: 0.244 Vali Loss: 4.073 Vali Acc: 0.131 Test Loss: 4.073 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6288962364196777
Epoch: 14, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.232 Vali Acc: 0.136 Test Loss: 4.232 Test Acc: 0.136
Validation loss decreased (-0.134078 --> -0.136428).  Saving model ...
Epoch: 15 cost time: 3.3734312057495117
Epoch: 15, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.426 Vali Acc: 0.139 Test Loss: 4.426 Test Acc: 0.139
Validation loss decreased (-0.136428 --> -0.138779).  Saving model ...
Epoch: 16 cost time: 3.4188950061798096
Epoch: 16, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.479 Vali Acc: 0.142 Test Loss: 4.479 Test Acc: 0.142
Validation loss decreased (-0.138779 --> -0.142308).  Saving model ...
Epoch: 17 cost time: 3.237664222717285
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.607 Vali Acc: 0.142 Test Loss: 4.607 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8867573738098145
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.637 Vali Acc: 0.141 Test Loss: 4.637 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6059906482696533
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.659 Vali Acc: 0.149 Test Loss: 4.659 Test Acc: 0.149
Validation loss decreased (-0.142308 --> -0.149365).  Saving model ...
Epoch: 20 cost time: 3.45841646194458
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.707 Vali Acc: 0.149 Test Loss: 4.707 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7709550857543945
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.764 Vali Acc: 0.148 Test Loss: 4.764 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.539857864379883
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.815 Vali Acc: 0.151 Test Loss: 4.815 Test Acc: 0.151
Validation loss decreased (-0.149365 --> -0.150540).  Saving model ...
Epoch: 23 cost time: 3.3179805278778076
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.852 Vali Acc: 0.152 Test Loss: 4.852 Test Acc: 0.152
Validation loss decreased (-0.150540 --> -0.151716).  Saving model ...
Epoch: 24 cost time: 3.4391767978668213
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.874 Vali Acc: 0.154 Test Loss: 4.874 Test Acc: 0.154
Validation loss decreased (-0.151716 --> -0.154069).  Saving model ...
Epoch: 25 cost time: 3.6773297786712646
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.907 Vali Acc: 0.158 Test Loss: 4.907 Test Acc: 0.158
Validation loss decreased (-0.154069 --> -0.157598).  Saving model ...
Epoch: 26 cost time: 4.093125104904175
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.937 Vali Acc: 0.155 Test Loss: 4.937 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.8010056018829346
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.976 Vali Acc: 0.153 Test Loss: 4.976 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.397721290588379
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.012 Vali Acc: 0.155 Test Loss: 5.012 Test Acc: 0.155
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.4148616790771484
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.037 Vali Acc: 0.156 Test Loss: 5.037 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.52836012840271
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.062 Vali Acc: 0.154 Test Loss: 5.062 Test Acc: 0.154
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.827331066131592
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.077 Vali Acc: 0.154 Test Loss: 5.077 Test Acc: 0.154
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.542625665664673
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.102 Vali Acc: 0.154 Test Loss: 5.102 Test Acc: 0.154
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.0845015048980713
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.122 Vali Acc: 0.155 Test Loss: 5.122 Test Acc: 0.155
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.663856029510498
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.142 Vali Acc: 0.159 Test Loss: 5.142 Test Acc: 0.159
Validation loss decreased (-0.157598 --> -0.158772).  Saving model ...
Epoch: 35 cost time: 3.904799461364746
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.165 Vali Acc: 0.159 Test Loss: 5.165 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.887950897216797
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.186 Vali Acc: 0.160 Test Loss: 5.186 Test Acc: 0.160
Validation loss decreased (-0.158772 --> -0.159948).  Saving model ...
Epoch: 37 cost time: 3.902343988418579
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.221 Vali Acc: 0.161 Test Loss: 5.221 Test Acc: 0.161
Validation loss decreased (-0.159948 --> -0.161124).  Saving model ...
Epoch: 38 cost time: 3.6919846534729004
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.257 Vali Acc: 0.159 Test Loss: 5.257 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.2973248958587646
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.272 Vali Acc: 0.159 Test Loss: 5.272 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.619333267211914
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.282 Vali Acc: 0.160 Test Loss: 5.282 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.9320428371429443
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.296 Vali Acc: 0.158 Test Loss: 5.296 Test Acc: 0.158
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.4983880519866943
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.311 Vali Acc: 0.161 Test Loss: 5.311 Test Acc: 0.161
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.603313446044922
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.334 Vali Acc: 0.162 Test Loss: 5.334 Test Acc: 0.162
Validation loss decreased (-0.161124 --> -0.162300).  Saving model ...
Epoch: 44 cost time: 3.7459805011749268
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.351 Vali Acc: 0.162 Test Loss: 5.351 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.6702535152435303
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.362 Vali Acc: 0.161 Test Loss: 5.362 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.4768571853637695
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.371 Vali Acc: 0.166 Test Loss: 5.371 Test Acc: 0.166
Validation loss decreased (-0.162300 --> -0.165829).  Saving model ...
Epoch: 47 cost time: 3.9811043739318848
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.386 Vali Acc: 0.166 Test Loss: 5.386 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.7701125144958496
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.399 Vali Acc: 0.164 Test Loss: 5.399 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.32489275932312
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.413 Vali Acc: 0.167 Test Loss: 5.413 Test Acc: 0.167
Validation loss decreased (-0.165829 --> -0.167005).  Saving model ...
Epoch: 50 cost time: 3.378230571746826
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.426 Vali Acc: 0.166 Test Loss: 5.426 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.490387201309204
Epoch: 51, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.442 Vali Acc: 0.167 Test Loss: 5.442 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.652055025100708
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.451 Vali Acc: 0.165 Test Loss: 5.451 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.284524917602539
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.461 Vali Acc: 0.167 Test Loss: 5.461 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.9047529697418213
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.476 Vali Acc: 0.168 Test Loss: 5.476 Test Acc: 0.168
Validation loss decreased (-0.167005 --> -0.168181).  Saving model ...
Epoch: 55 cost time: 3.703559398651123
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.494 Vali Acc: 0.168 Test Loss: 5.494 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.349527359008789
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.508 Vali Acc: 0.168 Test Loss: 5.508 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.6128129959106445
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.523 Vali Acc: 0.169 Test Loss: 5.523 Test Acc: 0.169
Validation loss decreased (-0.168181 --> -0.169357).  Saving model ...
Epoch: 58 cost time: 3.9023101329803467
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.532 Vali Acc: 0.169 Test Loss: 5.532 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.27013897895813
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.542 Vali Acc: 0.169 Test Loss: 5.542 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 3.513841390609741
Epoch: 60, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.546 Vali Acc: 0.168 Test Loss: 5.546 Test Acc: 0.168
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 3.573539972305298
Epoch: 61, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.562 Vali Acc: 0.166 Test Loss: 5.562 Test Acc: 0.166
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 3.5224809646606445
Epoch: 62, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.583 Vali Acc: 0.169 Test Loss: 5.583 Test Acc: 0.169
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 3.4578723907470703
Epoch: 63, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.603 Vali Acc: 0.171 Test Loss: 5.603 Test Acc: 0.171
Validation loss decreased (-0.169357 --> -0.170532).  Saving model ...
Epoch: 64 cost time: 3.3570592403411865
Epoch: 64, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.618 Vali Acc: 0.172 Test Loss: 5.618 Test Acc: 0.172
Validation loss decreased (-0.170532 --> -0.171709).  Saving model ...
Epoch: 65 cost time: 3.501783609390259
Epoch: 65, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.631 Vali Acc: 0.171 Test Loss: 5.631 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.374521017074585
Epoch: 66, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.638 Vali Acc: 0.169 Test Loss: 5.638 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 3.1771769523620605
Epoch: 67, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.648 Vali Acc: 0.169 Test Loss: 5.648 Test Acc: 0.169
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 3.4969160556793213
Epoch: 68, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.659 Vali Acc: 0.171 Test Loss: 5.659 Test Acc: 0.171
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 3.7527499198913574
Epoch: 69, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.667 Vali Acc: 0.171 Test Loss: 5.667 Test Acc: 0.171
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 3.4779205322265625
Epoch: 70, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.678 Vali Acc: 0.167 Test Loss: 5.678 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 3.4626712799072266
Epoch: 71, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.685 Vali Acc: 0.169 Test Loss: 5.685 Test Acc: 0.169
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 3.804612874984741
Epoch: 72, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.693 Vali Acc: 0.169 Test Loss: 5.693 Test Acc: 0.169
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 3.3418545722961426
Epoch: 73, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.705 Vali Acc: 0.171 Test Loss: 5.705 Test Acc: 0.171
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 3.0253374576568604
Epoch: 74, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.719 Vali Acc: 0.169 Test Loss: 5.719 Test Acc: 0.169
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17176470588235293
model parameter : 469658
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.027745485305786
Epoch: 1, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.315 Vali Acc: 0.039 Test Loss: 3.315 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 3.491508960723877
Epoch: 2, Steps: 10 | Train Loss: 3.153 Vali Loss: 3.336 Vali Acc: 0.049 Test Loss: 3.336 Test Acc: 0.049
Validation loss decreased (-0.038790 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 3.395881175994873
Epoch: 3, Steps: 10 | Train Loss: 2.917 Vali Loss: 3.379 Vali Acc: 0.064 Test Loss: 3.379 Test Acc: 0.064
Validation loss decreased (-0.049378 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 3.7704970836639404
Epoch: 4, Steps: 10 | Train Loss: 2.786 Vali Loss: 3.382 Vali Acc: 0.065 Test Loss: 3.382 Test Acc: 0.065
Validation loss decreased (-0.063496 --> -0.064672).  Saving model ...
Epoch: 5 cost time: 3.5430357456207275
Epoch: 5, Steps: 10 | Train Loss: 2.565 Vali Loss: 3.376 Vali Acc: 0.066 Test Loss: 3.376 Test Acc: 0.066
Validation loss decreased (-0.064672 --> -0.065849).  Saving model ...
Epoch: 6 cost time: 3.246549606323242
Epoch: 6, Steps: 10 | Train Loss: 2.280 Vali Loss: 3.358 Vali Acc: 0.081 Test Loss: 3.358 Test Acc: 0.081
Validation loss decreased (-0.065849 --> -0.081143).  Saving model ...
Epoch: 7 cost time: 3.984219789505005
Epoch: 7, Steps: 10 | Train Loss: 2.033 Vali Loss: 3.372 Vali Acc: 0.084 Test Loss: 3.372 Test Acc: 0.084
Validation loss decreased (-0.081143 --> -0.083496).  Saving model ...
Epoch: 8 cost time: 3.8359062671661377
Epoch: 8, Steps: 10 | Train Loss: 1.702 Vali Loss: 3.416 Vali Acc: 0.086 Test Loss: 3.416 Test Acc: 0.086
Validation loss decreased (-0.083496 --> -0.085848).  Saving model ...
Epoch: 9 cost time: 3.3297817707061768
Epoch: 9, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.485 Vali Acc: 0.084 Test Loss: 3.485 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.503059148788452
Epoch: 10, Steps: 10 | Train Loss: 1.145 Vali Loss: 3.534 Vali Acc: 0.084 Test Loss: 3.534 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.686002492904663
Epoch: 11, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.598 Vali Acc: 0.093 Test Loss: 3.598 Test Acc: 0.093
Validation loss decreased (-0.085848 --> -0.092905).  Saving model ...
Epoch: 12 cost time: 3.5841336250305176
Epoch: 12, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.724 Vali Acc: 0.101 Test Loss: 3.724 Test Acc: 0.101
Validation loss decreased (-0.092905 --> -0.101139).  Saving model ...
Epoch: 13 cost time: 3.4403274059295654
Epoch: 13, Steps: 10 | Train Loss: 0.500 Vali Loss: 3.788 Vali Acc: 0.101 Test Loss: 3.788 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.362362861633301
Epoch: 14, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.937 Vali Acc: 0.101 Test Loss: 3.937 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4657554626464844
Epoch: 15, Steps: 10 | Train Loss: 0.210 Vali Loss: 4.148 Vali Acc: 0.094 Test Loss: 4.148 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.5693840980529785
Epoch: 16, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.245 Vali Acc: 0.109 Test Loss: 4.245 Test Acc: 0.109
Validation loss decreased (-0.101139 --> -0.109369).  Saving model ...
Epoch: 17 cost time: 3.271937131881714
Epoch: 17, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.449 Vali Acc: 0.102 Test Loss: 4.449 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.225259304046631
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.465 Vali Acc: 0.113 Test Loss: 4.465 Test Acc: 0.113
Validation loss decreased (-0.109369 --> -0.112897).  Saving model ...
Epoch: 19 cost time: 3.7788331508636475
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.516 Vali Acc: 0.113 Test Loss: 4.516 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8929286003112793
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.614 Vali Acc: 0.114 Test Loss: 4.614 Test Acc: 0.114
Validation loss decreased (-0.112897 --> -0.114072).  Saving model ...
Epoch: 21 cost time: 3.5238635540008545
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.655 Vali Acc: 0.115 Test Loss: 4.655 Test Acc: 0.115
Validation loss decreased (-0.114072 --> -0.115248).  Saving model ...
Epoch: 22 cost time: 3.6871018409729004
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.682 Vali Acc: 0.118 Test Loss: 4.682 Test Acc: 0.118
Validation loss decreased (-0.115248 --> -0.117600).  Saving model ...
Epoch: 23 cost time: 3.9551143646240234
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.716 Vali Acc: 0.120 Test Loss: 4.716 Test Acc: 0.120
Validation loss decreased (-0.117600 --> -0.119953).  Saving model ...
Epoch: 24 cost time: 3.372007131576538
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.753 Vali Acc: 0.124 Test Loss: 4.753 Test Acc: 0.124
Validation loss decreased (-0.119953 --> -0.123482).  Saving model ...
Epoch: 25 cost time: 3.748095750808716
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.797 Vali Acc: 0.119 Test Loss: 4.797 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.531583070755005
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.810 Vali Acc: 0.121 Test Loss: 4.810 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.193593740463257
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.847 Vali Acc: 0.122 Test Loss: 4.847 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.617047071456909
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.874 Vali Acc: 0.121 Test Loss: 4.874 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.7108397483825684
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.894 Vali Acc: 0.121 Test Loss: 4.894 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.338268280029297
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.921 Vali Acc: 0.122 Test Loss: 4.921 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.633234739303589
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.942 Vali Acc: 0.121 Test Loss: 4.942 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.737481117248535
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.975 Vali Acc: 0.122 Test Loss: 4.975 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.8336374759674072
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.999 Vali Acc: 0.127 Test Loss: 4.999 Test Acc: 0.127
Validation loss decreased (-0.123482 --> -0.127009).  Saving model ...
Epoch: 34 cost time: 3.9367942810058594
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.013 Vali Acc: 0.125 Test Loss: 5.013 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.093797445297241
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.027 Vali Acc: 0.122 Test Loss: 5.027 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.382852792739868
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.049 Vali Acc: 0.125 Test Loss: 5.049 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.019609689712524
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.074 Vali Acc: 0.124 Test Loss: 5.074 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.023892402648926
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.107 Vali Acc: 0.126 Test Loss: 5.107 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.4500718116760254
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.130 Vali Acc: 0.126 Test Loss: 5.130 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 4.225963592529297
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.147 Vali Acc: 0.127 Test Loss: 5.147 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.867095708847046
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.161 Vali Acc: 0.127 Test Loss: 5.161 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.3713808059692383
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.163 Vali Acc: 0.127 Test Loss: 5.163 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.430690288543701
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.173 Vali Acc: 0.127 Test Loss: 5.173 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12705882352941175
model parameter : 469658
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.73394513130188
Epoch: 1, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.323 Vali Acc: 0.039 Test Loss: 3.323 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 3.550145387649536
Epoch: 2, Steps: 10 | Train Loss: 3.203 Vali Loss: 3.345 Vali Acc: 0.048 Test Loss: 3.345 Test Acc: 0.048
Validation loss decreased (-0.038790 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 3.830368995666504
Epoch: 3, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.393 Vali Acc: 0.049 Test Loss: 3.393 Test Acc: 0.049
Validation loss decreased (-0.048202 --> -0.049378).  Saving model ...
Epoch: 4 cost time: 3.19061017036438
Epoch: 4, Steps: 10 | Train Loss: 2.960 Vali Loss: 3.402 Vali Acc: 0.058 Test Loss: 3.402 Test Acc: 0.058
Validation loss decreased (-0.049378 --> -0.057613).  Saving model ...
Epoch: 5 cost time: 2.9597089290618896
Epoch: 5, Steps: 10 | Train Loss: 2.785 Vali Loss: 3.401 Vali Acc: 0.067 Test Loss: 3.401 Test Acc: 0.067
Validation loss decreased (-0.057613 --> -0.067025).  Saving model ...
Epoch: 6 cost time: 3.1986470222473145
Epoch: 6, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.376 Vali Acc: 0.069 Test Loss: 3.376 Test Acc: 0.069
Validation loss decreased (-0.067025 --> -0.069378).  Saving model ...
Epoch: 7 cost time: 3.011690855026245
Epoch: 7, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.366 Vali Acc: 0.074 Test Loss: 3.366 Test Acc: 0.074
Validation loss decreased (-0.069378 --> -0.074084).  Saving model ...
Epoch: 8 cost time: 2.764585256576538
Epoch: 8, Steps: 10 | Train Loss: 2.110 Vali Loss: 3.380 Vali Acc: 0.079 Test Loss: 3.380 Test Acc: 0.079
Validation loss decreased (-0.074084 --> -0.078790).  Saving model ...
Epoch: 9 cost time: 3.265188217163086
Epoch: 9, Steps: 10 | Train Loss: 1.943 Vali Loss: 3.431 Vali Acc: 0.080 Test Loss: 3.431 Test Acc: 0.080
Validation loss decreased (-0.078790 --> -0.079966).  Saving model ...
Epoch: 10 cost time: 3.361724853515625
Epoch: 10, Steps: 10 | Train Loss: 1.673 Vali Loss: 3.443 Vali Acc: 0.084 Test Loss: 3.443 Test Acc: 0.084
Validation loss decreased (-0.079966 --> -0.083495).  Saving model ...
Epoch: 11 cost time: 3.063028573989868
Epoch: 11, Steps: 10 | Train Loss: 1.408 Vali Loss: 3.485 Vali Acc: 0.098 Test Loss: 3.485 Test Acc: 0.098
Validation loss decreased (-0.083495 --> -0.097612).  Saving model ...
Epoch: 12 cost time: 3.3333234786987305
Epoch: 12, Steps: 10 | Train Loss: 1.131 Vali Loss: 3.625 Vali Acc: 0.100 Test Loss: 3.625 Test Acc: 0.100
Validation loss decreased (-0.097612 --> -0.099964).  Saving model ...
Epoch: 13 cost time: 3.3730883598327637
Epoch: 13, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.694 Vali Acc: 0.094 Test Loss: 3.694 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3742222785949707
Epoch: 14, Steps: 10 | Train Loss: 0.655 Vali Loss: 3.846 Vali Acc: 0.099 Test Loss: 3.846 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2587175369262695
Epoch: 15, Steps: 10 | Train Loss: 0.523 Vali Loss: 4.041 Vali Acc: 0.093 Test Loss: 4.041 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.018557548522949
Epoch: 16, Steps: 10 | Train Loss: 0.344 Vali Loss: 4.173 Vali Acc: 0.104 Test Loss: 4.173 Test Acc: 0.104
Validation loss decreased (-0.099964 --> -0.103488).  Saving model ...
Epoch: 17 cost time: 3.4151885509490967
Epoch: 17, Steps: 10 | Train Loss: 0.200 Vali Loss: 4.407 Vali Acc: 0.100 Test Loss: 4.407 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4520812034606934
Epoch: 18, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.477 Vali Acc: 0.102 Test Loss: 4.477 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.2308731079101562
Epoch: 19, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.609 Vali Acc: 0.105 Test Loss: 4.609 Test Acc: 0.105
Validation loss decreased (-0.103488 --> -0.104660).  Saving model ...
Epoch: 20 cost time: 3.5438029766082764
Epoch: 20, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.700 Vali Acc: 0.116 Test Loss: 4.700 Test Acc: 0.116
Validation loss decreased (-0.104660 --> -0.116424).  Saving model ...
Epoch: 21 cost time: 3.8604044914245605
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.774 Vali Acc: 0.115 Test Loss: 4.774 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.648094654083252
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.791 Vali Acc: 0.118 Test Loss: 4.791 Test Acc: 0.118
Validation loss decreased (-0.116424 --> -0.117599).  Saving model ...
Epoch: 23 cost time: 3.622173309326172
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.852 Vali Acc: 0.122 Test Loss: 4.852 Test Acc: 0.122
Validation loss decreased (-0.117599 --> -0.122304).  Saving model ...
Epoch: 24 cost time: 3.6148695945739746
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.888 Vali Acc: 0.125 Test Loss: 4.888 Test Acc: 0.125
Validation loss decreased (-0.122304 --> -0.124657).  Saving model ...
Epoch: 25 cost time: 3.7420804500579834
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.923 Vali Acc: 0.119 Test Loss: 4.923 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.507802963256836
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.931 Vali Acc: 0.126 Test Loss: 4.931 Test Acc: 0.126
Validation loss decreased (-0.124657 --> -0.125833).  Saving model ...
Epoch: 27 cost time: 3.316701650619507
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.978 Vali Acc: 0.128 Test Loss: 4.978 Test Acc: 0.128
Validation loss decreased (-0.125833 --> -0.128186).  Saving model ...
Epoch: 28 cost time: 4.170358657836914
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.031 Vali Acc: 0.125 Test Loss: 5.031 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.402324914932251
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.051 Vali Acc: 0.127 Test Loss: 5.051 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.435537338256836
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.079 Vali Acc: 0.126 Test Loss: 5.079 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.569532632827759
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.080 Vali Acc: 0.129 Test Loss: 5.080 Test Acc: 0.129
Validation loss decreased (-0.128186 --> -0.129361).  Saving model ...
Epoch: 32 cost time: 3.5842809677124023
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.097 Vali Acc: 0.125 Test Loss: 5.097 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.898247480392456
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.115 Vali Acc: 0.125 Test Loss: 5.115 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.64721417427063
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.130 Vali Acc: 0.125 Test Loss: 5.130 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.0673341751098633
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.141 Vali Acc: 0.127 Test Loss: 5.141 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.807901382446289
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.161 Vali Acc: 0.129 Test Loss: 5.161 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.577775001525879
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.193 Vali Acc: 0.128 Test Loss: 5.193 Test Acc: 0.128
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.7560315132141113
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.229 Vali Acc: 0.129 Test Loss: 5.229 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 4.078651666641235
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.247 Vali Acc: 0.128 Test Loss: 5.247 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.4083261489868164
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.261 Vali Acc: 0.131 Test Loss: 5.261 Test Acc: 0.131
Validation loss decreased (-0.129361 --> -0.130536).  Saving model ...
Epoch: 41 cost time: 3.8599164485931396
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.270 Vali Acc: 0.128 Test Loss: 5.270 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.9979820251464844
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.283 Vali Acc: 0.128 Test Loss: 5.283 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.2365095615386963
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.304 Vali Acc: 0.131 Test Loss: 5.304 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.8637747764587402
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.323 Vali Acc: 0.131 Test Loss: 5.323 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.4099783897399902
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.334 Vali Acc: 0.132 Test Loss: 5.334 Test Acc: 0.132
Validation loss decreased (-0.130536 --> -0.131711).  Saving model ...
Epoch: 46 cost time: 3.3259968757629395
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.350 Vali Acc: 0.132 Test Loss: 5.350 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.866412401199341
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.363 Vali Acc: 0.133 Test Loss: 5.363 Test Acc: 0.133
Validation loss decreased (-0.131711 --> -0.132888).  Saving model ...
Epoch: 48 cost time: 3.826505422592163
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.375 Vali Acc: 0.136 Test Loss: 5.375 Test Acc: 0.136
Validation loss decreased (-0.132888 --> -0.136417).  Saving model ...
Epoch: 49 cost time: 4.209323406219482
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.375 Vali Acc: 0.136 Test Loss: 5.375 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.9250035285949707
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.382 Vali Acc: 0.134 Test Loss: 5.382 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.2508349418640137
Epoch: 51, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.392 Vali Acc: 0.133 Test Loss: 5.392 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.6742591857910156
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.408 Vali Acc: 0.134 Test Loss: 5.408 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.378232955932617
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.422 Vali Acc: 0.134 Test Loss: 5.422 Test Acc: 0.134
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.887298345565796
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.428 Vali Acc: 0.133 Test Loss: 5.428 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.878310441970825
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.443 Vali Acc: 0.134 Test Loss: 5.443 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.3080968856811523
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.457 Vali Acc: 0.133 Test Loss: 5.457 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 3.957441568374634
Epoch: 57, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.469 Vali Acc: 0.131 Test Loss: 5.469 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 3.7227771282196045
Epoch: 58, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.477 Vali Acc: 0.128 Test Loss: 5.477 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13647058823529412
model parameter : 469658
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.379406452178955
Epoch: 1, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.348 Vali Acc: 0.038 Test Loss: 3.348 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 3.2379586696624756
Epoch: 2, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.379 Vali Acc: 0.047 Test Loss: 3.379 Test Acc: 0.047
Validation loss decreased (-0.037614 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 3.047206401824951
Epoch: 3, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.433 Vali Acc: 0.045 Test Loss: 3.433 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0194239616394043
Epoch: 4, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.452 Vali Acc: 0.047 Test Loss: 3.452 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3338253498077393
Epoch: 5, Steps: 10 | Train Loss: 2.956 Vali Loss: 3.452 Vali Acc: 0.051 Test Loss: 3.452 Test Acc: 0.051
Validation loss decreased (-0.047025 --> -0.050554).  Saving model ...
Epoch: 6 cost time: 3.102586507797241
Epoch: 6, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.428 Vali Acc: 0.054 Test Loss: 3.428 Test Acc: 0.054
Validation loss decreased (-0.050554 --> -0.054083).  Saving model ...
Epoch: 7 cost time: 3.20235013961792
Epoch: 7, Steps: 10 | Train Loss: 2.648 Vali Loss: 3.397 Vali Acc: 0.059 Test Loss: 3.397 Test Acc: 0.059
Validation loss decreased (-0.054083 --> -0.058790).  Saving model ...
Epoch: 8 cost time: 3.2804529666900635
Epoch: 8, Steps: 10 | Train Loss: 2.369 Vali Loss: 3.380 Vali Acc: 0.088 Test Loss: 3.380 Test Acc: 0.088
Validation loss decreased (-0.058790 --> -0.088201).  Saving model ...
Epoch: 9 cost time: 3.064185380935669
Epoch: 9, Steps: 10 | Train Loss: 2.237 Vali Loss: 3.402 Vali Acc: 0.081 Test Loss: 3.402 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8964738845825195
Epoch: 10, Steps: 10 | Train Loss: 2.009 Vali Loss: 3.406 Vali Acc: 0.086 Test Loss: 3.406 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.890737295150757
Epoch: 11, Steps: 10 | Train Loss: 1.777 Vali Loss: 3.413 Vali Acc: 0.087 Test Loss: 3.413 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7765517234802246
Epoch: 12, Steps: 10 | Train Loss: 1.489 Vali Loss: 3.491 Vali Acc: 0.092 Test Loss: 3.491 Test Acc: 0.092
Validation loss decreased (-0.088201 --> -0.091730).  Saving model ...
Epoch: 13 cost time: 3.336637258529663
Epoch: 13, Steps: 10 | Train Loss: 1.321 Vali Loss: 3.535 Vali Acc: 0.093 Test Loss: 3.535 Test Acc: 0.093
Validation loss decreased (-0.091730 --> -0.092906).  Saving model ...
Epoch: 14 cost time: 3.011192560195923
Epoch: 14, Steps: 10 | Train Loss: 1.015 Vali Loss: 3.646 Vali Acc: 0.101 Test Loss: 3.646 Test Acc: 0.101
Validation loss decreased (-0.092906 --> -0.101140).  Saving model ...
Epoch: 15 cost time: 3.216585874557495
Epoch: 15, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.791 Vali Acc: 0.093 Test Loss: 3.791 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.500110149383545
Epoch: 16, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.896 Vali Acc: 0.104 Test Loss: 3.896 Test Acc: 0.104
Validation loss decreased (-0.101140 --> -0.103490).  Saving model ...
Epoch: 17 cost time: 3.6125245094299316
Epoch: 17, Steps: 10 | Train Loss: 0.404 Vali Loss: 4.146 Vali Acc: 0.096 Test Loss: 4.146 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3249480724334717
Epoch: 18, Steps: 10 | Train Loss: 0.323 Vali Loss: 4.211 Vali Acc: 0.106 Test Loss: 4.211 Test Acc: 0.106
Validation loss decreased (-0.103490 --> -0.105840).  Saving model ...
Epoch: 19 cost time: 3.1833863258361816
Epoch: 19, Steps: 10 | Train Loss: 0.203 Vali Loss: 4.350 Vali Acc: 0.109 Test Loss: 4.350 Test Acc: 0.109
Validation loss decreased (-0.105840 --> -0.109368).  Saving model ...
Epoch: 20 cost time: 3.4773566722869873
Epoch: 20, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.426 Vali Acc: 0.108 Test Loss: 4.426 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5954535007476807
Epoch: 21, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.582 Vali Acc: 0.112 Test Loss: 4.582 Test Acc: 0.112
Validation loss decreased (-0.109368 --> -0.111719).  Saving model ...
Epoch: 22 cost time: 3.5015323162078857
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.658 Vali Acc: 0.115 Test Loss: 4.658 Test Acc: 0.115
Validation loss decreased (-0.111719 --> -0.115248).  Saving model ...
Epoch: 23 cost time: 3.608680486679077
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.695 Vali Acc: 0.114 Test Loss: 4.695 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.572371006011963
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.760 Vali Acc: 0.119 Test Loss: 4.760 Test Acc: 0.119
Validation loss decreased (-0.115248 --> -0.118776).  Saving model ...
Epoch: 25 cost time: 3.6984901428222656
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.815 Vali Acc: 0.116 Test Loss: 4.815 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.6741459369659424
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.826 Vali Acc: 0.114 Test Loss: 4.826 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3139822483062744
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.860 Vali Acc: 0.125 Test Loss: 4.860 Test Acc: 0.125
Validation loss decreased (-0.118776 --> -0.124657).  Saving model ...
Epoch: 28 cost time: 3.590996265411377
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.896 Vali Acc: 0.121 Test Loss: 4.896 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.403613805770874
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.936 Vali Acc: 0.118 Test Loss: 4.936 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.5650835037231445
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.973 Vali Acc: 0.120 Test Loss: 4.973 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.362969160079956
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.994 Vali Acc: 0.122 Test Loss: 4.994 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.503350019454956
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.028 Vali Acc: 0.124 Test Loss: 5.028 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.47013521194458
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.038 Vali Acc: 0.126 Test Loss: 5.038 Test Acc: 0.126
Validation loss decreased (-0.124657 --> -0.125832).  Saving model ...
Epoch: 34 cost time: 3.7076127529144287
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.040 Vali Acc: 0.125 Test Loss: 5.040 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.3512396812438965
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.052 Vali Acc: 0.125 Test Loss: 5.052 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.3888604640960693
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.074 Vali Acc: 0.127 Test Loss: 5.074 Test Acc: 0.127
Validation loss decreased (-0.125832 --> -0.127008).  Saving model ...
Epoch: 37 cost time: 3.51924467086792
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.108 Vali Acc: 0.124 Test Loss: 5.108 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.5072498321533203
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.145 Vali Acc: 0.124 Test Loss: 5.145 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.6687183380126953
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.163 Vali Acc: 0.126 Test Loss: 5.163 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.984046459197998
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.181 Vali Acc: 0.128 Test Loss: 5.181 Test Acc: 0.128
Validation loss decreased (-0.127008 --> -0.128183).  Saving model ...
Epoch: 41 cost time: 3.5969200134277344
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.190 Vali Acc: 0.129 Test Loss: 5.190 Test Acc: 0.129
Validation loss decreased (-0.128183 --> -0.129360).  Saving model ...
Epoch: 42 cost time: 4.063730955123901
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.209 Vali Acc: 0.129 Test Loss: 5.209 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.619447708129883
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.236 Vali Acc: 0.129 Test Loss: 5.236 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.470818281173706
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.259 Vali Acc: 0.126 Test Loss: 5.259 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.3790719509124756
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.272 Vali Acc: 0.128 Test Loss: 5.272 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.995124340057373
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.286 Vali Acc: 0.126 Test Loss: 5.286 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.8452703952789307
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.299 Vali Acc: 0.128 Test Loss: 5.299 Test Acc: 0.128
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.696549654006958
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.302 Vali Acc: 0.131 Test Loss: 5.302 Test Acc: 0.131
Validation loss decreased (-0.129360 --> -0.130535).  Saving model ...
Epoch: 49 cost time: 4.0231568813323975
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.301 Vali Acc: 0.133 Test Loss: 5.301 Test Acc: 0.133
Validation loss decreased (-0.130535 --> -0.132888).  Saving model ...
Epoch: 50 cost time: 3.652320146560669
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.319 Vali Acc: 0.132 Test Loss: 5.319 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.487844705581665
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.330 Vali Acc: 0.131 Test Loss: 5.330 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.328765392303467
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.335 Vali Acc: 0.131 Test Loss: 5.335 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.227430820465088
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.343 Vali Acc: 0.128 Test Loss: 5.343 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.818855047225952
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.348 Vali Acc: 0.132 Test Loss: 5.348 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.2801930904388428
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.366 Vali Acc: 0.131 Test Loss: 5.366 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.4035797119140625
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.385 Vali Acc: 0.129 Test Loss: 5.385 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.456378698348999
Epoch: 57, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.401 Vali Acc: 0.131 Test Loss: 5.401 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.4739699363708496
Epoch: 58, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.413 Vali Acc: 0.129 Test Loss: 5.413 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.6581225395202637
Epoch: 59, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.418 Vali Acc: 0.129 Test Loss: 5.418 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.13294117647058823
model parameter : 469658
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.3713219165802
Epoch: 1, Steps: 10 | Train Loss: 3.364 Vali Loss: 3.320 Vali Acc: 0.035 Test Loss: 3.320 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 3.509500503540039
Epoch: 2, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.346 Vali Acc: 0.036 Test Loss: 3.346 Test Acc: 0.036
Validation loss decreased (-0.035261 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 3.39089298248291
Epoch: 3, Steps: 10 | Train Loss: 3.168 Vali Loss: 3.396 Vali Acc: 0.039 Test Loss: 3.396 Test Acc: 0.039
Validation loss decreased (-0.036437 --> -0.038790).  Saving model ...
Epoch: 4 cost time: 3.1114501953125
Epoch: 4, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.416 Vali Acc: 0.040 Test Loss: 3.416 Test Acc: 0.040
Validation loss decreased (-0.038790 --> -0.039966).  Saving model ...
Epoch: 5 cost time: 3.3950347900390625
Epoch: 5, Steps: 10 | Train Loss: 2.947 Vali Loss: 3.418 Vali Acc: 0.041 Test Loss: 3.418 Test Acc: 0.041
Validation loss decreased (-0.039966 --> -0.041142).  Saving model ...
Epoch: 6 cost time: 3.3217856884002686
Epoch: 6, Steps: 10 | Train Loss: 2.827 Vali Loss: 3.396 Vali Acc: 0.042 Test Loss: 3.396 Test Acc: 0.042
Validation loss decreased (-0.041142 --> -0.042319).  Saving model ...
Epoch: 7 cost time: 3.2981626987457275
Epoch: 7, Steps: 10 | Train Loss: 2.724 Vali Loss: 3.364 Vali Acc: 0.053 Test Loss: 3.364 Test Acc: 0.053
Validation loss decreased (-0.042319 --> -0.052908).  Saving model ...
Epoch: 8 cost time: 3.3799667358398438
Epoch: 8, Steps: 10 | Train Loss: 2.544 Vali Loss: 3.354 Vali Acc: 0.072 Test Loss: 3.354 Test Acc: 0.072
Validation loss decreased (-0.052908 --> -0.071731).  Saving model ...
Epoch: 9 cost time: 3.3242413997650146
Epoch: 9, Steps: 10 | Train Loss: 2.396 Vali Loss: 3.370 Vali Acc: 0.081 Test Loss: 3.370 Test Acc: 0.081
Validation loss decreased (-0.071731 --> -0.081143).  Saving model ...
Epoch: 10 cost time: 3.3962528705596924
Epoch: 10, Steps: 10 | Train Loss: 2.236 Vali Loss: 3.388 Vali Acc: 0.086 Test Loss: 3.388 Test Acc: 0.086
Validation loss decreased (-0.081143 --> -0.085848).  Saving model ...
Epoch: 11 cost time: 3.3684444427490234
Epoch: 11, Steps: 10 | Train Loss: 1.964 Vali Loss: 3.408 Vali Acc: 0.091 Test Loss: 3.408 Test Acc: 0.091
Validation loss decreased (-0.085848 --> -0.090554).  Saving model ...
Epoch: 12 cost time: 3.4107871055603027
Epoch: 12, Steps: 10 | Train Loss: 1.820 Vali Loss: 3.485 Vali Acc: 0.092 Test Loss: 3.485 Test Acc: 0.092
Validation loss decreased (-0.090554 --> -0.091730).  Saving model ...
Epoch: 13 cost time: 3.4287192821502686
Epoch: 13, Steps: 10 | Train Loss: 1.556 Vali Loss: 3.540 Vali Acc: 0.108 Test Loss: 3.540 Test Acc: 0.108
Validation loss decreased (-0.091730 --> -0.108200).  Saving model ...
Epoch: 14 cost time: 3.536391496658325
Epoch: 14, Steps: 10 | Train Loss: 1.338 Vali Loss: 3.646 Vali Acc: 0.099 Test Loss: 3.646 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3229715824127197
Epoch: 15, Steps: 10 | Train Loss: 1.064 Vali Loss: 3.758 Vali Acc: 0.098 Test Loss: 3.758 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6620609760284424
Epoch: 16, Steps: 10 | Train Loss: 0.844 Vali Loss: 3.883 Vali Acc: 0.109 Test Loss: 3.883 Test Acc: 0.109
Validation loss decreased (-0.108200 --> -0.109373).  Saving model ...
Epoch: 17 cost time: 3.472904920578003
Epoch: 17, Steps: 10 | Train Loss: 0.622 Vali Loss: 4.059 Vali Acc: 0.112 Test Loss: 4.059 Test Acc: 0.112
Validation loss decreased (-0.109373 --> -0.111724).  Saving model ...
Epoch: 18 cost time: 3.2906980514526367
Epoch: 18, Steps: 10 | Train Loss: 0.507 Vali Loss: 4.122 Vali Acc: 0.129 Test Loss: 4.122 Test Acc: 0.129
Validation loss decreased (-0.111724 --> -0.129371).  Saving model ...
Epoch: 19 cost time: 3.796377182006836
Epoch: 19, Steps: 10 | Train Loss: 0.351 Vali Loss: 4.282 Vali Acc: 0.127 Test Loss: 4.282 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.382066249847412
Epoch: 20, Steps: 10 | Train Loss: 0.230 Vali Loss: 4.372 Vali Acc: 0.139 Test Loss: 4.372 Test Acc: 0.139
Validation loss decreased (-0.129371 --> -0.138780).  Saving model ...
Epoch: 21 cost time: 3.3557140827178955
Epoch: 21, Steps: 10 | Train Loss: 0.163 Vali Loss: 4.491 Vali Acc: 0.133 Test Loss: 4.491 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3575809001922607
Epoch: 22, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.521 Vali Acc: 0.141 Test Loss: 4.521 Test Acc: 0.141
Validation loss decreased (-0.138780 --> -0.141131).  Saving model ...
Epoch: 23 cost time: 3.3907077312469482
Epoch: 23, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.612 Vali Acc: 0.144 Test Loss: 4.612 Test Acc: 0.144
Validation loss decreased (-0.141131 --> -0.143483).  Saving model ...
Epoch: 24 cost time: 3.2245359420776367
Epoch: 24, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.697 Vali Acc: 0.147 Test Loss: 4.697 Test Acc: 0.147
Validation loss decreased (-0.143483 --> -0.147012).  Saving model ...
Epoch: 25 cost time: 3.031906843185425
Epoch: 25, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.826 Vali Acc: 0.139 Test Loss: 4.826 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.344881296157837
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.800 Vali Acc: 0.142 Test Loss: 4.800 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.7598323822021484
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.816 Vali Acc: 0.154 Test Loss: 4.816 Test Acc: 0.154
Validation loss decreased (-0.147012 --> -0.154069).  Saving model ...
Epoch: 28 cost time: 3.110421895980835
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.902 Vali Acc: 0.155 Test Loss: 4.902 Test Acc: 0.155
Validation loss decreased (-0.154069 --> -0.155245).  Saving model ...
Epoch: 29 cost time: 3.2269043922424316
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.930 Vali Acc: 0.155 Test Loss: 4.930 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.196162700653076
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.954 Vali Acc: 0.151 Test Loss: 4.954 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.6388347148895264
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.965 Vali Acc: 0.152 Test Loss: 4.965 Test Acc: 0.152
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.188961982727051
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.983 Vali Acc: 0.153 Test Loss: 4.983 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.2015879154205322
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.991 Vali Acc: 0.155 Test Loss: 4.991 Test Acc: 0.155
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.4906442165374756
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.017 Vali Acc: 0.156 Test Loss: 5.017 Test Acc: 0.156
Validation loss decreased (-0.155245 --> -0.156420).  Saving model ...
Epoch: 35 cost time: 3.59128999710083
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.052 Vali Acc: 0.158 Test Loss: 5.052 Test Acc: 0.158
Validation loss decreased (-0.156420 --> -0.157597).  Saving model ...
Epoch: 36 cost time: 3.387824296951294
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.087 Vali Acc: 0.156 Test Loss: 5.087 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.6991002559661865
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.133 Vali Acc: 0.159 Test Loss: 5.133 Test Acc: 0.159
Validation loss decreased (-0.157597 --> -0.158772).  Saving model ...
Epoch: 38 cost time: 3.663008213043213
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.161 Vali Acc: 0.156 Test Loss: 5.161 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.456841468811035
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.155 Vali Acc: 0.158 Test Loss: 5.155 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.4286539554595947
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.166 Vali Acc: 0.160 Test Loss: 5.166 Test Acc: 0.160
Validation loss decreased (-0.158772 --> -0.159948).  Saving model ...
Epoch: 41 cost time: 3.456124782562256
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.188 Vali Acc: 0.160 Test Loss: 5.188 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.351443290710449
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.201 Vali Acc: 0.162 Test Loss: 5.201 Test Acc: 0.162
Validation loss decreased (-0.159948 --> -0.162301).  Saving model ...
Epoch: 43 cost time: 3.169800043106079
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.220 Vali Acc: 0.158 Test Loss: 5.220 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.120229959487915
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.238 Vali Acc: 0.156 Test Loss: 5.238 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.4213719367980957
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.256 Vali Acc: 0.158 Test Loss: 5.256 Test Acc: 0.158
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.4847822189331055
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.277 Vali Acc: 0.156 Test Loss: 5.277 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.037292242050171
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.290 Vali Acc: 0.160 Test Loss: 5.290 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.258002996444702
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.286 Vali Acc: 0.159 Test Loss: 5.286 Test Acc: 0.159
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.3116087913513184
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.288 Vali Acc: 0.161 Test Loss: 5.288 Test Acc: 0.161
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.521923780441284
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.305 Vali Acc: 0.160 Test Loss: 5.305 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.207845687866211
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.329 Vali Acc: 0.160 Test Loss: 5.329 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.135019063949585
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.353 Vali Acc: 0.158 Test Loss: 5.353 Test Acc: 0.158
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1623529411764706
model parameter : 469658
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.095331430435181
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 3.4136900901794434
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 3 cost time: 3.7403950691223145
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 4 cost time: 3.706700325012207
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 5 cost time: 3.1654958724975586
Epoch: 5, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 6 cost time: 3.622095823287964
Epoch: 6, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 7 cost time: 3.4307591915130615
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 8 cost time: 3.5123798847198486
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 9 cost time: 3.1550629138946533
Epoch: 9, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 10 cost time: 3.042172431945801
Epoch: 10, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 11 cost time: 3.3790347576141357
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 12 cost time: 3.289485454559326
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 13 cost time: 3.3856582641601562
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 14 cost time: 3.5306200981140137
Epoch: 14, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.034085 --> -0.037614).  Saving model ...
Epoch: 15 cost time: 3.351145029067993
Epoch: 15, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 16 cost time: 3.400897979736328
Epoch: 16, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 17 cost time: 3.364210367202759
Epoch: 17, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 18 cost time: 3.5083274841308594
Epoch: 18, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 19 cost time: 3.659257650375366
Epoch: 19, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 20 cost time: 3.33131742477417
Epoch: 20, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 21 cost time: 3.2730252742767334
Epoch: 21, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 22 cost time: 3.627981424331665
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 23 cost time: 3.619936943054199
Epoch: 23, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.037614 --> -0.050556).  Saving model ...
Epoch: 24 cost time: 3.520991325378418
Epoch: 24, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 25 cost time: 3.66652250289917
Epoch: 25, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2357189655303955
Epoch: 26, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.377248525619507
Epoch: 27, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.5313265323638916
Epoch: 28, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.5259952545166016
Epoch: 29, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.7159202098846436
Epoch: 30, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.7107510566711426
Epoch: 31, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.5708675384521484
Epoch: 32, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.8090221881866455
Epoch: 33, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.3936474323272705
Epoch: 34, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.05058823529411765
model parameter : 469658
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.711810827255249
Epoch: 1, Steps: 10 | Train Loss: 3.366 Vali Loss: 3.305 Vali Acc: 0.062 Test Loss: 3.305 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 3.595686435699463
Epoch: 2, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.259 Vali Acc: 0.066 Test Loss: 3.259 Test Acc: 0.066
Validation loss decreased (-0.062320 --> -0.065850).  Saving model ...
Epoch: 3 cost time: 3.605573892593384
Epoch: 3, Steps: 10 | Train Loss: 2.970 Vali Loss: 3.251 Vali Acc: 0.082 Test Loss: 3.251 Test Acc: 0.082
Validation loss decreased (-0.065850 --> -0.082320).  Saving model ...
Epoch: 4 cost time: 3.709555149078369
Epoch: 4, Steps: 10 | Train Loss: 2.676 Vali Loss: 3.232 Vali Acc: 0.096 Test Loss: 3.232 Test Acc: 0.096
Validation loss decreased (-0.082320 --> -0.096438).  Saving model ...
Epoch: 5 cost time: 3.2845067977905273
Epoch: 5, Steps: 10 | Train Loss: 2.427 Vali Loss: 3.167 Vali Acc: 0.140 Test Loss: 3.167 Test Acc: 0.140
Validation loss decreased (-0.096438 --> -0.139968).  Saving model ...
Epoch: 6 cost time: 3.402113914489746
Epoch: 6, Steps: 10 | Train Loss: 2.144 Vali Loss: 3.118 Vali Acc: 0.160 Test Loss: 3.118 Test Acc: 0.160
Validation loss decreased (-0.139968 --> -0.159969).  Saving model ...
Epoch: 7 cost time: 3.6527225971221924
Epoch: 7, Steps: 10 | Train Loss: 1.821 Vali Loss: 3.089 Vali Acc: 0.193 Test Loss: 3.089 Test Acc: 0.193
Validation loss decreased (-0.159969 --> -0.192910).  Saving model ...
Epoch: 8 cost time: 3.2684590816497803
Epoch: 8, Steps: 10 | Train Loss: 1.553 Vali Loss: 3.071 Vali Acc: 0.198 Test Loss: 3.071 Test Acc: 0.198
Validation loss decreased (-0.192910 --> -0.197616).  Saving model ...
Epoch: 9 cost time: 3.6231863498687744
Epoch: 9, Steps: 10 | Train Loss: 1.261 Vali Loss: 3.084 Vali Acc: 0.214 Test Loss: 3.084 Test Acc: 0.214
Validation loss decreased (-0.197616 --> -0.214087).  Saving model ...
Epoch: 10 cost time: 3.5659756660461426
Epoch: 10, Steps: 10 | Train Loss: 0.981 Vali Loss: 3.118 Vali Acc: 0.216 Test Loss: 3.118 Test Acc: 0.216
Validation loss decreased (-0.214087 --> -0.216439).  Saving model ...
Epoch: 11 cost time: 3.6851420402526855
Epoch: 11, Steps: 10 | Train Loss: 0.752 Vali Loss: 3.116 Vali Acc: 0.226 Test Loss: 3.116 Test Acc: 0.226
Validation loss decreased (-0.216439 --> -0.225851).  Saving model ...
Epoch: 12 cost time: 3.2408151626586914
Epoch: 12, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.167 Vali Acc: 0.246 Test Loss: 3.167 Test Acc: 0.246
Validation loss decreased (-0.225851 --> -0.245851).  Saving model ...
Epoch: 13 cost time: 3.3634800910949707
Epoch: 13, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.199 Vali Acc: 0.256 Test Loss: 3.199 Test Acc: 0.256
Validation loss decreased (-0.245851 --> -0.256439).  Saving model ...
Epoch: 14 cost time: 2.9643146991729736
Epoch: 14, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.287 Vali Acc: 0.258 Test Loss: 3.287 Test Acc: 0.258
Validation loss decreased (-0.256439 --> -0.257614).  Saving model ...
Epoch: 15 cost time: 3.6891226768493652
Epoch: 15, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.358 Vali Acc: 0.258 Test Loss: 3.358 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.742379665374756
Epoch: 16, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.377 Vali Acc: 0.264 Test Loss: 3.377 Test Acc: 0.264
Validation loss decreased (-0.257614 --> -0.263496).  Saving model ...
Epoch: 17 cost time: 3.763686418533325
Epoch: 17, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.433 Vali Acc: 0.273 Test Loss: 3.433 Test Acc: 0.273
Validation loss decreased (-0.263496 --> -0.272907).  Saving model ...
Epoch: 18 cost time: 3.693875789642334
Epoch: 18, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.467 Vali Acc: 0.274 Test Loss: 3.467 Test Acc: 0.274
Validation loss decreased (-0.272907 --> -0.274083).  Saving model ...
Epoch: 19 cost time: 3.91310977935791
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.510 Vali Acc: 0.266 Test Loss: 3.510 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.223618268966675
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.535 Vali Acc: 0.274 Test Loss: 3.535 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3877453804016113
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.558 Vali Acc: 0.276 Test Loss: 3.558 Test Acc: 0.276
Validation loss decreased (-0.274083 --> -0.276435).  Saving model ...
Epoch: 22 cost time: 3.567725658416748
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.582 Vali Acc: 0.280 Test Loss: 3.582 Test Acc: 0.280
Validation loss decreased (-0.276435 --> -0.279964).  Saving model ...
Epoch: 23 cost time: 3.421145439147949
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.611 Vali Acc: 0.276 Test Loss: 3.611 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.7940595149993896
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.616 Vali Acc: 0.286 Test Loss: 3.616 Test Acc: 0.286
Validation loss decreased (-0.279964 --> -0.285846).  Saving model ...
Epoch: 25 cost time: 3.5100488662719727
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.636 Vali Acc: 0.292 Test Loss: 3.636 Test Acc: 0.292
Validation loss decreased (-0.285846 --> -0.291728).  Saving model ...
Epoch: 26 cost time: 3.425163507461548
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.653 Vali Acc: 0.291 Test Loss: 3.653 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.636749505996704
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.680 Vali Acc: 0.285 Test Loss: 3.680 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2053380012512207
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.707 Vali Acc: 0.280 Test Loss: 3.707 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.33213472366333
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.698 Vali Acc: 0.289 Test Loss: 3.698 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.5741167068481445
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.693 Vali Acc: 0.300 Test Loss: 3.693 Test Acc: 0.300
Validation loss decreased (-0.291728 --> -0.299963).  Saving model ...
Epoch: 31 cost time: 3.6942126750946045
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.718 Vali Acc: 0.296 Test Loss: 3.718 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.5804028511047363
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.759 Vali Acc: 0.295 Test Loss: 3.759 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.494068145751953
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.788 Vali Acc: 0.293 Test Loss: 3.788 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.34767484664917
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.786 Vali Acc: 0.292 Test Loss: 3.786 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.2474238872528076
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.780 Vali Acc: 0.289 Test Loss: 3.780 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.075247049331665
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.791 Vali Acc: 0.295 Test Loss: 3.791 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.430400848388672
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.806 Vali Acc: 0.291 Test Loss: 3.806 Test Acc: 0.291
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.7361888885498047
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.835 Vali Acc: 0.291 Test Loss: 3.835 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.8703627586364746
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.847 Vali Acc: 0.292 Test Loss: 3.847 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.4330732822418213
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.853 Vali Acc: 0.293 Test Loss: 3.853 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3
model parameter : 562522
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.739475727081299
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.300 Vali Acc: 0.059 Test Loss: 3.300 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 3.820638418197632
Epoch: 2, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.265 Vali Acc: 0.062 Test Loss: 3.265 Test Acc: 0.062
Validation loss decreased (-0.058791 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 3.3795254230499268
Epoch: 3, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.265 Vali Acc: 0.081 Test Loss: 3.265 Test Acc: 0.081
Validation loss decreased (-0.062320 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 3.4811789989471436
Epoch: 4, Steps: 10 | Train Loss: 2.709 Vali Loss: 3.255 Vali Acc: 0.105 Test Loss: 3.255 Test Acc: 0.105
Validation loss decreased (-0.081144 --> -0.104673).  Saving model ...
Epoch: 5 cost time: 3.884706497192383
Epoch: 5, Steps: 10 | Train Loss: 2.461 Vali Loss: 3.194 Vali Acc: 0.144 Test Loss: 3.194 Test Acc: 0.144
Validation loss decreased (-0.104673 --> -0.143497).  Saving model ...
Epoch: 6 cost time: 3.406456470489502
Epoch: 6, Steps: 10 | Train Loss: 2.179 Vali Loss: 3.148 Vali Acc: 0.176 Test Loss: 3.148 Test Acc: 0.176
Validation loss decreased (-0.143497 --> -0.176439).  Saving model ...
Epoch: 7 cost time: 3.8420612812042236
Epoch: 7, Steps: 10 | Train Loss: 1.876 Vali Loss: 3.118 Vali Acc: 0.201 Test Loss: 3.118 Test Acc: 0.201
Validation loss decreased (-0.176439 --> -0.201145).  Saving model ...
Epoch: 8 cost time: 3.3592984676361084
Epoch: 8, Steps: 10 | Train Loss: 1.638 Vali Loss: 3.105 Vali Acc: 0.211 Test Loss: 3.105 Test Acc: 0.211
Validation loss decreased (-0.201145 --> -0.210557).  Saving model ...
Epoch: 9 cost time: 3.3984010219573975
Epoch: 9, Steps: 10 | Train Loss: 1.292 Vali Loss: 3.115 Vali Acc: 0.234 Test Loss: 3.115 Test Acc: 0.234
Validation loss decreased (-0.210557 --> -0.234086).  Saving model ...
Epoch: 10 cost time: 3.6342086791992188
Epoch: 10, Steps: 10 | Train Loss: 0.991 Vali Loss: 3.154 Vali Acc: 0.239 Test Loss: 3.154 Test Acc: 0.239
Validation loss decreased (-0.234086 --> -0.238792).  Saving model ...
Epoch: 11 cost time: 3.399562120437622
Epoch: 11, Steps: 10 | Train Loss: 0.779 Vali Loss: 3.151 Vali Acc: 0.249 Test Loss: 3.151 Test Acc: 0.249
Validation loss decreased (-0.238792 --> -0.249380).  Saving model ...
Epoch: 12 cost time: 3.320131301879883
Epoch: 12, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.226 Vali Acc: 0.264 Test Loss: 3.226 Test Acc: 0.264
Validation loss decreased (-0.249380 --> -0.263497).  Saving model ...
Epoch: 13 cost time: 3.417375326156616
Epoch: 13, Steps: 10 | Train Loss: 0.441 Vali Loss: 3.258 Vali Acc: 0.279 Test Loss: 3.258 Test Acc: 0.279
Validation loss decreased (-0.263497 --> -0.278791).  Saving model ...
Epoch: 14 cost time: 3.0770628452301025
Epoch: 14, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.328 Vali Acc: 0.289 Test Loss: 3.328 Test Acc: 0.289
Validation loss decreased (-0.278791 --> -0.289378).  Saving model ...
Epoch: 15 cost time: 3.4183783531188965
Epoch: 15, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.413 Vali Acc: 0.279 Test Loss: 3.413 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.66998291015625
Epoch: 16, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.462 Vali Acc: 0.284 Test Loss: 3.462 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.262788772583008
Epoch: 17, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.504 Vali Acc: 0.291 Test Loss: 3.504 Test Acc: 0.291
Validation loss decreased (-0.289378 --> -0.290553).  Saving model ...
Epoch: 18 cost time: 3.7449371814727783
Epoch: 18, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.532 Vali Acc: 0.287 Test Loss: 3.532 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.380969762802124
Epoch: 19, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.572 Vali Acc: 0.298 Test Loss: 3.572 Test Acc: 0.298
Validation loss decreased (-0.290553 --> -0.297611).  Saving model ...
Epoch: 20 cost time: 3.361752510070801
Epoch: 20, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.627 Vali Acc: 0.296 Test Loss: 3.627 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3411505222320557
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.666 Vali Acc: 0.298 Test Loss: 3.666 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.730543375015259
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.661 Vali Acc: 0.299 Test Loss: 3.661 Test Acc: 0.299
Validation loss decreased (-0.297611 --> -0.298787).  Saving model ...
Epoch: 23 cost time: 3.397017002105713
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.684 Vali Acc: 0.301 Test Loss: 3.684 Test Acc: 0.301
Validation loss decreased (-0.298787 --> -0.301140).  Saving model ...
Epoch: 24 cost time: 3.4553394317626953
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.705 Vali Acc: 0.300 Test Loss: 3.705 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.688047409057617
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.744 Vali Acc: 0.299 Test Loss: 3.744 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.639594554901123
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.768 Vali Acc: 0.301 Test Loss: 3.768 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.5895400047302246
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.792 Vali Acc: 0.300 Test Loss: 3.792 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.579238176345825
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.807 Vali Acc: 0.298 Test Loss: 3.807 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.141648769378662
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.803 Vali Acc: 0.299 Test Loss: 3.803 Test Acc: 0.299
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.0312771797180176
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.803 Vali Acc: 0.301 Test Loss: 3.803 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.249565839767456
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.841 Vali Acc: 0.301 Test Loss: 3.841 Test Acc: 0.301
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.506164789199829
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.877 Vali Acc: 0.300 Test Loss: 3.877 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.627974033355713
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.883 Vali Acc: 0.305 Test Loss: 3.883 Test Acc: 0.305
Validation loss decreased (-0.301140 --> -0.304667).  Saving model ...
Epoch: 34 cost time: 3.9320173263549805
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.884 Vali Acc: 0.299 Test Loss: 3.884 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.3991048336029053
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.890 Vali Acc: 0.300 Test Loss: 3.890 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.3674681186676025
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.915 Vali Acc: 0.298 Test Loss: 3.915 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.5156209468841553
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.930 Vali Acc: 0.299 Test Loss: 3.930 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.1413214206695557
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.946 Vali Acc: 0.304 Test Loss: 3.946 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.18503737449646
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.963 Vali Acc: 0.302 Test Loss: 3.963 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.7903029918670654
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.973 Vali Acc: 0.302 Test Loss: 3.973 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.356510877609253
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.979 Vali Acc: 0.305 Test Loss: 3.979 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.4695138931274414
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.990 Vali Acc: 0.306 Test Loss: 3.990 Test Acc: 0.306
Validation loss decreased (-0.304667 --> -0.305842).  Saving model ...
Epoch: 43 cost time: 3.4057631492614746
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.998 Vali Acc: 0.306 Test Loss: 3.998 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.383981466293335
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.017 Vali Acc: 0.304 Test Loss: 4.017 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.2220242023468018
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.036 Vali Acc: 0.302 Test Loss: 4.036 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.265538454055786
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.044 Vali Acc: 0.304 Test Loss: 4.044 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.640627861022949
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.050 Vali Acc: 0.306 Test Loss: 4.050 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.6202375888824463
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.075 Vali Acc: 0.304 Test Loss: 4.075 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.519679307937622
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.081 Vali Acc: 0.301 Test Loss: 4.081 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.4372453689575195
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.087 Vali Acc: 0.302 Test Loss: 4.087 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.4562532901763916
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.100 Vali Acc: 0.305 Test Loss: 4.100 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.717810869216919
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.110 Vali Acc: 0.304 Test Loss: 4.110 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3058823529411765
model parameter : 562522
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.163066387176514
Epoch: 1, Steps: 10 | Train Loss: 3.337 Vali Loss: 3.309 Vali Acc: 0.039 Test Loss: 3.309 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 3.416386842727661
Epoch: 2, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.268 Vali Acc: 0.065 Test Loss: 3.268 Test Acc: 0.065
Validation loss decreased (-0.038790 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 3.447150230407715
Epoch: 3, Steps: 10 | Train Loss: 2.953 Vali Loss: 3.258 Vali Acc: 0.086 Test Loss: 3.258 Test Acc: 0.086
Validation loss decreased (-0.064673 --> -0.085850).  Saving model ...
Epoch: 4 cost time: 3.36150860786438
Epoch: 4, Steps: 10 | Train Loss: 2.689 Vali Loss: 3.251 Vali Acc: 0.120 Test Loss: 3.251 Test Acc: 0.120
Validation loss decreased (-0.085850 --> -0.119967).  Saving model ...
Epoch: 5 cost time: 3.252079725265503
Epoch: 5, Steps: 10 | Train Loss: 2.439 Vali Loss: 3.199 Vali Acc: 0.146 Test Loss: 3.199 Test Acc: 0.146
Validation loss decreased (-0.119967 --> -0.145850).  Saving model ...
Epoch: 6 cost time: 3.3052101135253906
Epoch: 6, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.164 Vali Acc: 0.173 Test Loss: 3.164 Test Acc: 0.173
Validation loss decreased (-0.145850 --> -0.172910).  Saving model ...
Epoch: 7 cost time: 3.238326072692871
Epoch: 7, Steps: 10 | Train Loss: 1.910 Vali Loss: 3.141 Vali Acc: 0.201 Test Loss: 3.141 Test Acc: 0.201
Validation loss decreased (-0.172910 --> -0.201145).  Saving model ...
Epoch: 8 cost time: 3.0905203819274902
Epoch: 8, Steps: 10 | Train Loss: 1.667 Vali Loss: 3.138 Vali Acc: 0.216 Test Loss: 3.138 Test Acc: 0.216
Validation loss decreased (-0.201145 --> -0.216439).  Saving model ...
Epoch: 9 cost time: 3.332547187805176
Epoch: 9, Steps: 10 | Train Loss: 1.385 Vali Loss: 3.155 Vali Acc: 0.238 Test Loss: 3.155 Test Acc: 0.238
Validation loss decreased (-0.216439 --> -0.237616).  Saving model ...
Epoch: 10 cost time: 3.2672836780548096
Epoch: 10, Steps: 10 | Train Loss: 1.103 Vali Loss: 3.203 Vali Acc: 0.238 Test Loss: 3.203 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2717788219451904
Epoch: 11, Steps: 10 | Train Loss: 0.911 Vali Loss: 3.191 Vali Acc: 0.259 Test Loss: 3.191 Test Acc: 0.259
Validation loss decreased (-0.237616 --> -0.258792).  Saving model ...
Epoch: 12 cost time: 3.402484655380249
Epoch: 12, Steps: 10 | Train Loss: 0.713 Vali Loss: 3.265 Vali Acc: 0.255 Test Loss: 3.265 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.420539379119873
Epoch: 13, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.284 Vali Acc: 0.280 Test Loss: 3.284 Test Acc: 0.280
Validation loss decreased (-0.258792 --> -0.279967).  Saving model ...
Epoch: 14 cost time: 3.4050004482269287
Epoch: 14, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.365 Vali Acc: 0.280 Test Loss: 3.365 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8583672046661377
Epoch: 15, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.438 Vali Acc: 0.281 Test Loss: 3.438 Test Acc: 0.281
Validation loss decreased (-0.279967 --> -0.281142).  Saving model ...
Epoch: 16 cost time: 3.43113374710083
Epoch: 16, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.472 Vali Acc: 0.294 Test Loss: 3.472 Test Acc: 0.294
Validation loss decreased (-0.281142 --> -0.294083).  Saving model ...
Epoch: 17 cost time: 3.575376510620117
Epoch: 17, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.533 Vali Acc: 0.288 Test Loss: 3.533 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.28364634513855
Epoch: 18, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.587 Vali Acc: 0.280 Test Loss: 3.587 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.388927936553955
Epoch: 19, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.627 Vali Acc: 0.295 Test Loss: 3.627 Test Acc: 0.295
Validation loss decreased (-0.294083 --> -0.295258).  Saving model ...
Epoch: 20 cost time: 3.6623401641845703
Epoch: 20, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.670 Vali Acc: 0.293 Test Loss: 3.670 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.555863857269287
Epoch: 21, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.717 Vali Acc: 0.291 Test Loss: 3.717 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.506171941757202
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.732 Vali Acc: 0.301 Test Loss: 3.732 Test Acc: 0.301
Validation loss decreased (-0.295258 --> -0.301139).  Saving model ...
Epoch: 23 cost time: 3.3016531467437744
Epoch: 23, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.761 Vali Acc: 0.293 Test Loss: 3.761 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.4414222240448
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.780 Vali Acc: 0.296 Test Loss: 3.780 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.499796152114868
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.795 Vali Acc: 0.293 Test Loss: 3.795 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.7033069133758545
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.826 Vali Acc: 0.293 Test Loss: 3.826 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.3796932697296143
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.878 Vali Acc: 0.295 Test Loss: 3.878 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.2703676223754883
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.894 Vali Acc: 0.294 Test Loss: 3.894 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.950460195541382
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.854 Vali Acc: 0.301 Test Loss: 3.854 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.7837839126586914
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.871 Vali Acc: 0.304 Test Loss: 3.871 Test Acc: 0.304
Validation loss decreased (-0.301139 --> -0.303491).  Saving model ...
Epoch: 31 cost time: 3.068922519683838
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.922 Vali Acc: 0.304 Test Loss: 3.922 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.2147648334503174
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.957 Vali Acc: 0.301 Test Loss: 3.957 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.828925132751465
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.973 Vali Acc: 0.298 Test Loss: 3.973 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.817284345626831
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.975 Vali Acc: 0.302 Test Loss: 3.975 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.2685275077819824
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.972 Vali Acc: 0.299 Test Loss: 3.972 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.2137110233306885
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.994 Vali Acc: 0.302 Test Loss: 3.994 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.9816603660583496
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.013 Vali Acc: 0.302 Test Loss: 4.013 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.7518792152404785
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.039 Vali Acc: 0.305 Test Loss: 4.039 Test Acc: 0.305
Validation loss decreased (-0.303491 --> -0.304665).  Saving model ...
Epoch: 39 cost time: 3.8367369174957275
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.044 Vali Acc: 0.305 Test Loss: 4.044 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.2296907901763916
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.046 Vali Acc: 0.305 Test Loss: 4.046 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.467571973800659
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.067 Vali Acc: 0.300 Test Loss: 4.067 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.951326608657837
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.084 Vali Acc: 0.301 Test Loss: 4.084 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.036449670791626
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.090 Vali Acc: 0.301 Test Loss: 4.090 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.502701759338379
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.114 Vali Acc: 0.300 Test Loss: 4.114 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.8414595127105713
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.126 Vali Acc: 0.298 Test Loss: 4.126 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.3748180866241455
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.130 Vali Acc: 0.294 Test Loss: 4.130 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.0923776626586914
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.145 Vali Acc: 0.300 Test Loss: 4.145 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.2232329845428467
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.175 Vali Acc: 0.299 Test Loss: 4.175 Test Acc: 0.299
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30470588235294116
model parameter : 562522
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.521448850631714
Epoch: 1, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.333 Vali Acc: 0.039 Test Loss: 3.333 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 3.0799856185913086
Epoch: 2, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.302 Vali Acc: 0.055 Test Loss: 3.302 Test Acc: 0.055
Validation loss decreased (-0.038790 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 3.0790789127349854
Epoch: 3, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.309 Vali Acc: 0.072 Test Loss: 3.309 Test Acc: 0.072
Validation loss decreased (-0.055261 --> -0.071732).  Saving model ...
Epoch: 4 cost time: 3.607407808303833
Epoch: 4, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.318 Vali Acc: 0.084 Test Loss: 3.318 Test Acc: 0.084
Validation loss decreased (-0.071732 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 3.4359614849090576
Epoch: 5, Steps: 10 | Train Loss: 2.504 Vali Loss: 3.286 Vali Acc: 0.113 Test Loss: 3.286 Test Acc: 0.113
Validation loss decreased (-0.083496 --> -0.112908).  Saving model ...
Epoch: 6 cost time: 3.684856414794922
Epoch: 6, Steps: 10 | Train Loss: 2.252 Vali Loss: 3.265 Vali Acc: 0.124 Test Loss: 3.265 Test Acc: 0.124
Validation loss decreased (-0.112908 --> -0.123497).  Saving model ...
Epoch: 7 cost time: 3.3879549503326416
Epoch: 7, Steps: 10 | Train Loss: 1.987 Vali Loss: 3.263 Vali Acc: 0.142 Test Loss: 3.263 Test Acc: 0.142
Validation loss decreased (-0.123497 --> -0.142320).  Saving model ...
Epoch: 8 cost time: 3.284029245376587
Epoch: 8, Steps: 10 | Train Loss: 1.741 Vali Loss: 3.280 Vali Acc: 0.142 Test Loss: 3.280 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2131500244140625
Epoch: 9, Steps: 10 | Train Loss: 1.487 Vali Loss: 3.323 Vali Acc: 0.164 Test Loss: 3.323 Test Acc: 0.164
Validation loss decreased (-0.142320 --> -0.163496).  Saving model ...
Epoch: 10 cost time: 3.6633400917053223
Epoch: 10, Steps: 10 | Train Loss: 1.243 Vali Loss: 3.399 Vali Acc: 0.168 Test Loss: 3.399 Test Acc: 0.168
Validation loss decreased (-0.163496 --> -0.168201).  Saving model ...
Epoch: 11 cost time: 3.384949207305908
Epoch: 11, Steps: 10 | Train Loss: 1.008 Vali Loss: 3.404 Vali Acc: 0.184 Test Loss: 3.404 Test Acc: 0.184
Validation loss decreased (-0.168201 --> -0.183495).  Saving model ...
Epoch: 12 cost time: 3.6566684246063232
Epoch: 12, Steps: 10 | Train Loss: 0.826 Vali Loss: 3.500 Vali Acc: 0.175 Test Loss: 3.500 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1020007133483887
Epoch: 13, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.529 Vali Acc: 0.196 Test Loss: 3.529 Test Acc: 0.196
Validation loss decreased (-0.183495 --> -0.196435).  Saving model ...
Epoch: 14 cost time: 3.6122007369995117
Epoch: 14, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.620 Vali Acc: 0.211 Test Loss: 3.620 Test Acc: 0.211
Validation loss decreased (-0.196435 --> -0.210552).  Saving model ...
Epoch: 15 cost time: 3.2523515224456787
Epoch: 15, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.699 Vali Acc: 0.208 Test Loss: 3.699 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.297393321990967
Epoch: 16, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.759 Vali Acc: 0.214 Test Loss: 3.759 Test Acc: 0.214
Validation loss decreased (-0.210552 --> -0.214080).  Saving model ...
Epoch: 17 cost time: 3.726991891860962
Epoch: 17, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.864 Vali Acc: 0.215 Test Loss: 3.864 Test Acc: 0.215
Validation loss decreased (-0.214080 --> -0.215255).  Saving model ...
Epoch: 18 cost time: 3.4637503623962402
Epoch: 18, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.914 Vali Acc: 0.218 Test Loss: 3.914 Test Acc: 0.218
Validation loss decreased (-0.215255 --> -0.217608).  Saving model ...
Epoch: 19 cost time: 2.808863878250122
Epoch: 19, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.988 Vali Acc: 0.225 Test Loss: 3.988 Test Acc: 0.225
Validation loss decreased (-0.217608 --> -0.224666).  Saving model ...
Epoch: 20 cost time: 3.34855580329895
Epoch: 20, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.010 Vali Acc: 0.225 Test Loss: 4.010 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.308159112930298
Epoch: 21, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.096 Vali Acc: 0.231 Test Loss: 4.096 Test Acc: 0.231
Validation loss decreased (-0.224666 --> -0.230547).  Saving model ...
Epoch: 22 cost time: 3.617690086364746
Epoch: 22, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.153 Vali Acc: 0.229 Test Loss: 4.153 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3825747966766357
Epoch: 23, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.176 Vali Acc: 0.228 Test Loss: 4.176 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.233086347579956
Epoch: 24, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.171 Vali Acc: 0.234 Test Loss: 4.171 Test Acc: 0.234
Validation loss decreased (-0.230547 --> -0.234076).  Saving model ...
Epoch: 25 cost time: 3.1521453857421875
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.242 Vali Acc: 0.233 Test Loss: 4.242 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2508015632629395
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.284 Vali Acc: 0.242 Test Loss: 4.284 Test Acc: 0.242
Validation loss decreased (-0.234076 --> -0.242310).  Saving model ...
Epoch: 27 cost time: 2.837878704071045
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.328 Vali Acc: 0.238 Test Loss: 4.328 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.6105761528015137
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.336 Vali Acc: 0.232 Test Loss: 4.336 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.354879140853882
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.306 Vali Acc: 0.241 Test Loss: 4.306 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.2543158531188965
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.337 Vali Acc: 0.242 Test Loss: 4.337 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.3079612255096436
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.435 Vali Acc: 0.240 Test Loss: 4.435 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.4526333808898926
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.423 Vali Acc: 0.239 Test Loss: 4.423 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.1691746711730957
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.427 Vali Acc: 0.242 Test Loss: 4.427 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.3591134548187256
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.467 Vali Acc: 0.235 Test Loss: 4.467 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.460381031036377
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.460 Vali Acc: 0.242 Test Loss: 4.460 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.2478554248809814
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.463 Vali Acc: 0.244 Test Loss: 4.463 Test Acc: 0.244
Validation loss decreased (-0.242310 --> -0.243485).  Saving model ...
Epoch: 37 cost time: 3.194148540496826
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.485 Vali Acc: 0.241 Test Loss: 4.485 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.107664108276367
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.533 Vali Acc: 0.240 Test Loss: 4.533 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.1916871070861816
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.546 Vali Acc: 0.242 Test Loss: 4.546 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.898125410079956
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.550 Vali Acc: 0.244 Test Loss: 4.550 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.1712310314178467
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.556 Vali Acc: 0.248 Test Loss: 4.556 Test Acc: 0.248
Validation loss decreased (-0.243485 --> -0.248190).  Saving model ...
Epoch: 42 cost time: 3.441237449645996
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.573 Vali Acc: 0.241 Test Loss: 4.573 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.04799747467041
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.596 Vali Acc: 0.241 Test Loss: 4.596 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.4323418140411377
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.622 Vali Acc: 0.248 Test Loss: 4.622 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.4814817905426025
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.619 Vali Acc: 0.242 Test Loss: 4.619 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.455251932144165
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.627 Vali Acc: 0.245 Test Loss: 4.627 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.376499652862549
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.646 Vali Acc: 0.245 Test Loss: 4.646 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.2684133052825928
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.665 Vali Acc: 0.245 Test Loss: 4.665 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.3044145107269287
Epoch: 49, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.681 Vali Acc: 0.246 Test Loss: 4.681 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.196237087249756
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.697 Vali Acc: 0.251 Test Loss: 4.697 Test Acc: 0.251
Validation loss decreased (-0.248190 --> -0.250541).  Saving model ...
Epoch: 51 cost time: 3.164184093475342
Epoch: 51, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.705 Vali Acc: 0.251 Test Loss: 4.705 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.2254798412323
Epoch: 52, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.701 Vali Acc: 0.247 Test Loss: 4.701 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.5101139545440674
Epoch: 53, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.699 Vali Acc: 0.247 Test Loss: 4.699 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.4098563194274902
Epoch: 54, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.712 Vali Acc: 0.245 Test Loss: 4.712 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.6441657543182373
Epoch: 55, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.731 Vali Acc: 0.246 Test Loss: 4.731 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.4337573051452637
Epoch: 56, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.753 Vali Acc: 0.246 Test Loss: 4.753 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.2110378742218018
Epoch: 57, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.771 Vali Acc: 0.247 Test Loss: 4.771 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 3.3610565662384033
Epoch: 58, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.768 Vali Acc: 0.247 Test Loss: 4.768 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 3.352458953857422
Epoch: 59, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.770 Vali Acc: 0.253 Test Loss: 4.770 Test Acc: 0.253
Validation loss decreased (-0.250541 --> -0.252893).  Saving model ...
Epoch: 60 cost time: 3.1834583282470703
Epoch: 60, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.773 Vali Acc: 0.253 Test Loss: 4.773 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.0751423835754395
Epoch: 61, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.778 Vali Acc: 0.254 Test Loss: 4.778 Test Acc: 0.254
Validation loss decreased (-0.252893 --> -0.254070).  Saving model ...
Epoch: 62 cost time: 3.4183895587921143
Epoch: 62, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.781 Vali Acc: 0.255 Test Loss: 4.781 Test Acc: 0.255
Validation loss decreased (-0.254070 --> -0.255246).  Saving model ...
Epoch: 63 cost time: 3.416853666305542
Epoch: 63, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.793 Vali Acc: 0.255 Test Loss: 4.793 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.4097750186920166
Epoch: 64, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.815 Vali Acc: 0.252 Test Loss: 4.815 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 3.2748751640319824
Epoch: 65, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.833 Vali Acc: 0.252 Test Loss: 4.833 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 3.3482699394226074
Epoch: 66, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.849 Vali Acc: 0.252 Test Loss: 4.849 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 3.6576499938964844
Epoch: 67, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.868 Vali Acc: 0.252 Test Loss: 4.868 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 2.8374922275543213
Epoch: 68, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.867 Vali Acc: 0.253 Test Loss: 4.867 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 3.2063369750976562
Epoch: 69, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.868 Vali Acc: 0.249 Test Loss: 4.868 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 3.211639881134033
Epoch: 70, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.875 Vali Acc: 0.252 Test Loss: 4.875 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 3.630392074584961
Epoch: 71, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.884 Vali Acc: 0.252 Test Loss: 4.884 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 3.577749013900757
Epoch: 72, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.888 Vali Acc: 0.252 Test Loss: 4.888 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 562522
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.370898723602295
Epoch: 1, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.318 Vali Acc: 0.041 Test Loss: 3.318 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 3.2575035095214844
Epoch: 2, Steps: 10 | Train Loss: 3.265 Vali Loss: 3.310 Vali Acc: 0.052 Test Loss: 3.310 Test Acc: 0.052
Validation loss decreased (-0.041143 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 3.4978206157684326
Epoch: 3, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.332 Vali Acc: 0.048 Test Loss: 3.332 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3176839351654053
Epoch: 4, Steps: 10 | Train Loss: 2.836 Vali Loss: 3.360 Vali Acc: 0.062 Test Loss: 3.360 Test Acc: 0.062
Validation loss decreased (-0.051732 --> -0.062319).  Saving model ...
Epoch: 5 cost time: 3.0408785343170166
Epoch: 5, Steps: 10 | Train Loss: 2.650 Vali Loss: 3.347 Vali Acc: 0.072 Test Loss: 3.347 Test Acc: 0.072
Validation loss decreased (-0.062319 --> -0.071731).  Saving model ...
Epoch: 6 cost time: 3.406273603439331
Epoch: 6, Steps: 10 | Train Loss: 2.380 Vali Loss: 3.343 Vali Acc: 0.085 Test Loss: 3.343 Test Acc: 0.085
Validation loss decreased (-0.071731 --> -0.084672).  Saving model ...
Epoch: 7 cost time: 3.274754047393799
Epoch: 7, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.340 Vali Acc: 0.096 Test Loss: 3.340 Test Acc: 0.096
Validation loss decreased (-0.084672 --> -0.096437).  Saving model ...
Epoch: 8 cost time: 3.433473587036133
Epoch: 8, Steps: 10 | Train Loss: 1.898 Vali Loss: 3.353 Vali Acc: 0.094 Test Loss: 3.353 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9396915435791016
Epoch: 9, Steps: 10 | Train Loss: 1.611 Vali Loss: 3.393 Vali Acc: 0.105 Test Loss: 3.393 Test Acc: 0.105
Validation loss decreased (-0.096437 --> -0.104672).  Saving model ...
Epoch: 10 cost time: 2.9060282707214355
Epoch: 10, Steps: 10 | Train Loss: 1.337 Vali Loss: 3.469 Vali Acc: 0.099 Test Loss: 3.469 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2552502155303955
Epoch: 11, Steps: 10 | Train Loss: 1.132 Vali Loss: 3.479 Vali Acc: 0.113 Test Loss: 3.479 Test Acc: 0.113
Validation loss decreased (-0.104672 --> -0.112906).  Saving model ...
Epoch: 12 cost time: 3.1506001949310303
Epoch: 12, Steps: 10 | Train Loss: 0.931 Vali Loss: 3.569 Vali Acc: 0.106 Test Loss: 3.569 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.206528663635254
Epoch: 13, Steps: 10 | Train Loss: 0.726 Vali Loss: 3.662 Vali Acc: 0.107 Test Loss: 3.662 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1532046794891357
Epoch: 14, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.771 Vali Acc: 0.115 Test Loss: 3.771 Test Acc: 0.115
Validation loss decreased (-0.112906 --> -0.115256).  Saving model ...
Epoch: 15 cost time: 3.2611515522003174
Epoch: 15, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.888 Vali Acc: 0.112 Test Loss: 3.888 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0814855098724365
Epoch: 16, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.947 Vali Acc: 0.120 Test Loss: 3.947 Test Acc: 0.120
Validation loss decreased (-0.115256 --> -0.119961).  Saving model ...
Epoch: 17 cost time: 3.4224178791046143
Epoch: 17, Steps: 10 | Train Loss: 0.200 Vali Loss: 4.060 Vali Acc: 0.114 Test Loss: 4.060 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4787116050720215
Epoch: 18, Steps: 10 | Train Loss: 0.156 Vali Loss: 4.137 Vali Acc: 0.120 Test Loss: 4.137 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4785828590393066
Epoch: 19, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.244 Vali Acc: 0.118 Test Loss: 4.244 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.3950040340423584
Epoch: 20, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.233 Vali Acc: 0.122 Test Loss: 4.233 Test Acc: 0.122
Validation loss decreased (-0.119961 --> -0.122311).  Saving model ...
Epoch: 21 cost time: 3.794539213180542
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.322 Vali Acc: 0.122 Test Loss: 4.322 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6987290382385254
Epoch: 22, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.352 Vali Acc: 0.127 Test Loss: 4.352 Test Acc: 0.127
Validation loss decreased (-0.122311 --> -0.127015).  Saving model ...
Epoch: 23 cost time: 3.3979578018188477
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.398 Vali Acc: 0.126 Test Loss: 4.398 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.721674680709839
Epoch: 24, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.390 Vali Acc: 0.124 Test Loss: 4.390 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.624598264694214
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.412 Vali Acc: 0.132 Test Loss: 4.412 Test Acc: 0.132
Validation loss decreased (-0.127015 --> -0.131721).  Saving model ...
Epoch: 26 cost time: 3.3567302227020264
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.456 Vali Acc: 0.127 Test Loss: 4.456 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2428975105285645
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.511 Vali Acc: 0.129 Test Loss: 4.511 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.832235097885132
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.554 Vali Acc: 0.129 Test Loss: 4.554 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.234597682952881
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.568 Vali Acc: 0.131 Test Loss: 4.568 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.5297293663024902
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.565 Vali Acc: 0.127 Test Loss: 4.565 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.564629316329956
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.575 Vali Acc: 0.129 Test Loss: 4.575 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.558213949203491
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.615 Vali Acc: 0.133 Test Loss: 4.615 Test Acc: 0.133
Validation loss decreased (-0.131721 --> -0.132895).  Saving model ...
Epoch: 33 cost time: 3.2178726196289062
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.666 Vali Acc: 0.131 Test Loss: 4.666 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.2838082313537598
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.686 Vali Acc: 0.129 Test Loss: 4.686 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.3290789127349854
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.675 Vali Acc: 0.133 Test Loss: 4.675 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.8471641540527344
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.689 Vali Acc: 0.135 Test Loss: 4.689 Test Acc: 0.135
Validation loss decreased (-0.132895 --> -0.135247).  Saving model ...
Epoch: 37 cost time: 2.9282655715942383
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.688 Vali Acc: 0.140 Test Loss: 4.688 Test Acc: 0.140
Validation loss decreased (-0.135247 --> -0.139953).  Saving model ...
Epoch: 38 cost time: 3.6353759765625
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.706 Vali Acc: 0.138 Test Loss: 4.706 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.282869338989258
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.736 Vali Acc: 0.141 Test Loss: 4.736 Test Acc: 0.141
Validation loss decreased (-0.139953 --> -0.141129).  Saving model ...
Epoch: 40 cost time: 3.2979869842529297
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.765 Vali Acc: 0.140 Test Loss: 4.765 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.124134063720703
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.792 Vali Acc: 0.138 Test Loss: 4.792 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.700784683227539
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.810 Vali Acc: 0.140 Test Loss: 4.810 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.8347246646881104
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.806 Vali Acc: 0.141 Test Loss: 4.806 Test Acc: 0.141
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.808256149291992
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.829 Vali Acc: 0.140 Test Loss: 4.829 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.381263494491577
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.830 Vali Acc: 0.139 Test Loss: 4.830 Test Acc: 0.139
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.3374783992767334
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.833 Vali Acc: 0.141 Test Loss: 4.833 Test Acc: 0.141
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.5688536167144775
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.844 Vali Acc: 0.141 Test Loss: 4.844 Test Acc: 0.141
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.6688337326049805
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.864 Vali Acc: 0.140 Test Loss: 4.864 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.50852108001709
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.880 Vali Acc: 0.141 Test Loss: 4.880 Test Acc: 0.141
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1411764705882353
model parameter : 562522
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.692355155944824
Epoch: 1, Steps: 10 | Train Loss: 3.402 Vali Loss: 3.335 Vali Acc: 0.040 Test Loss: 3.335 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.318028688430786
Epoch: 2, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.314 Vali Acc: 0.053 Test Loss: 3.314 Test Acc: 0.053
Validation loss decreased (-0.039967 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 3.094637155532837
Epoch: 3, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.340 Vali Acc: 0.051 Test Loss: 3.340 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1641082763671875
Epoch: 4, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.377 Vali Acc: 0.049 Test Loss: 3.377 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.264514684677124
Epoch: 5, Steps: 10 | Train Loss: 2.782 Vali Loss: 3.367 Vali Acc: 0.061 Test Loss: 3.367 Test Acc: 0.061
Validation loss decreased (-0.052908 --> -0.061143).  Saving model ...
Epoch: 6 cost time: 2.966662645339966
Epoch: 6, Steps: 10 | Train Loss: 2.659 Vali Loss: 3.356 Vali Acc: 0.062 Test Loss: 3.356 Test Acc: 0.062
Validation loss decreased (-0.061143 --> -0.062319).  Saving model ...
Epoch: 7 cost time: 3.048352003097534
Epoch: 7, Steps: 10 | Train Loss: 2.492 Vali Loss: 3.353 Vali Acc: 0.072 Test Loss: 3.353 Test Acc: 0.072
Validation loss decreased (-0.062319 --> -0.071731).  Saving model ...
Epoch: 8 cost time: 3.3845670223236084
Epoch: 8, Steps: 10 | Train Loss: 2.222 Vali Loss: 3.356 Vali Acc: 0.074 Test Loss: 3.356 Test Acc: 0.074
Validation loss decreased (-0.071731 --> -0.074084).  Saving model ...
Epoch: 9 cost time: 2.7950680255889893
Epoch: 9, Steps: 10 | Train Loss: 1.992 Vali Loss: 3.388 Vali Acc: 0.082 Test Loss: 3.388 Test Acc: 0.082
Validation loss decreased (-0.074084 --> -0.082319).  Saving model ...
Epoch: 10 cost time: 3.148073196411133
Epoch: 10, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.437 Vali Acc: 0.074 Test Loss: 3.437 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6758921146392822
Epoch: 11, Steps: 10 | Train Loss: 1.510 Vali Loss: 3.443 Vali Acc: 0.085 Test Loss: 3.443 Test Acc: 0.085
Validation loss decreased (-0.082319 --> -0.084671).  Saving model ...
Epoch: 12 cost time: 3.1210432052612305
Epoch: 12, Steps: 10 | Train Loss: 1.312 Vali Loss: 3.501 Vali Acc: 0.089 Test Loss: 3.501 Test Acc: 0.089
Validation loss decreased (-0.084671 --> -0.089377).  Saving model ...
Epoch: 13 cost time: 3.112774133682251
Epoch: 13, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.571 Vali Acc: 0.086 Test Loss: 3.571 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7894318103790283
Epoch: 14, Steps: 10 | Train Loss: 0.883 Vali Loss: 3.621 Vali Acc: 0.095 Test Loss: 3.621 Test Acc: 0.095
Validation loss decreased (-0.089377 --> -0.095258).  Saving model ...
Epoch: 15 cost time: 3.266359806060791
Epoch: 15, Steps: 10 | Train Loss: 0.728 Vali Loss: 3.688 Vali Acc: 0.095 Test Loss: 3.688 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0751454830169678
Epoch: 16, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.759 Vali Acc: 0.098 Test Loss: 3.759 Test Acc: 0.098
Validation loss decreased (-0.095258 --> -0.097609).  Saving model ...
Epoch: 17 cost time: 3.2140660285949707
Epoch: 17, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.851 Vali Acc: 0.102 Test Loss: 3.851 Test Acc: 0.102
Validation loss decreased (-0.097609 --> -0.102314).  Saving model ...
Epoch: 18 cost time: 3.6508302688598633
Epoch: 18, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.920 Vali Acc: 0.099 Test Loss: 3.920 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7919132709503174
Epoch: 19, Steps: 10 | Train Loss: 0.199 Vali Loss: 4.038 Vali Acc: 0.107 Test Loss: 4.038 Test Acc: 0.107
Validation loss decreased (-0.102314 --> -0.107018).  Saving model ...
Epoch: 20 cost time: 3.3012943267822266
Epoch: 20, Steps: 10 | Train Loss: 0.147 Vali Loss: 4.081 Vali Acc: 0.112 Test Loss: 4.081 Test Acc: 0.112
Validation loss decreased (-0.107018 --> -0.111724).  Saving model ...
Epoch: 21 cost time: 3.0183873176574707
Epoch: 21, Steps: 10 | Train Loss: 0.116 Vali Loss: 4.193 Vali Acc: 0.106 Test Loss: 4.193 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.540013074874878
Epoch: 22, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.241 Vali Acc: 0.105 Test Loss: 4.241 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2625679969787598
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.246 Vali Acc: 0.113 Test Loss: 4.246 Test Acc: 0.113
Validation loss decreased (-0.111724 --> -0.112899).  Saving model ...
Epoch: 24 cost time: 3.3194010257720947
Epoch: 24, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.285 Vali Acc: 0.118 Test Loss: 4.285 Test Acc: 0.118
Validation loss decreased (-0.112899 --> -0.117604).  Saving model ...
Epoch: 25 cost time: 3.80395245552063
Epoch: 25, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.378 Vali Acc: 0.115 Test Loss: 4.378 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.27691650390625
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.423 Vali Acc: 0.115 Test Loss: 4.423 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.118941068649292
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.467 Vali Acc: 0.119 Test Loss: 4.467 Test Acc: 0.119
Validation loss decreased (-0.117604 --> -0.118779).  Saving model ...
Epoch: 28 cost time: 3.3026316165924072
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.469 Vali Acc: 0.118 Test Loss: 4.469 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.9757251739501953
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.467 Vali Acc: 0.120 Test Loss: 4.467 Test Acc: 0.120
Validation loss decreased (-0.118779 --> -0.119955).  Saving model ...
Epoch: 30 cost time: 2.905329942703247
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.486 Vali Acc: 0.115 Test Loss: 4.486 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.027456283569336
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.511 Vali Acc: 0.116 Test Loss: 4.511 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.561875820159912
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.544 Vali Acc: 0.116 Test Loss: 4.544 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.299011468887329
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.586 Vali Acc: 0.118 Test Loss: 4.586 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.0195629596710205
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.603 Vali Acc: 0.120 Test Loss: 4.603 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.224985122680664
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.608 Vali Acc: 0.121 Test Loss: 4.608 Test Acc: 0.121
Validation loss decreased (-0.119955 --> -0.121130).  Saving model ...
Epoch: 36 cost time: 3.3143534660339355
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.626 Vali Acc: 0.125 Test Loss: 4.626 Test Acc: 0.125
Validation loss decreased (-0.121130 --> -0.124660).  Saving model ...
Epoch: 37 cost time: 3.474658250808716
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.648 Vali Acc: 0.122 Test Loss: 4.648 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.0426037311553955
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.665 Vali Acc: 0.120 Test Loss: 4.665 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.574774980545044
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.679 Vali Acc: 0.120 Test Loss: 4.679 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.918651580810547
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.698 Vali Acc: 0.121 Test Loss: 4.698 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.2825469970703125
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.720 Vali Acc: 0.121 Test Loss: 4.720 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.6922879219055176
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.738 Vali Acc: 0.122 Test Loss: 4.738 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.165604591369629
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.754 Vali Acc: 0.128 Test Loss: 4.754 Test Acc: 0.128
Validation loss decreased (-0.124660 --> -0.128188).  Saving model ...
Epoch: 44 cost time: 3.3361194133758545
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.771 Vali Acc: 0.122 Test Loss: 4.771 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.828735113143921
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.775 Vali Acc: 0.121 Test Loss: 4.775 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.3903653621673584
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.774 Vali Acc: 0.120 Test Loss: 4.774 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.9686503410339355
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.788 Vali Acc: 0.122 Test Loss: 4.788 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.1697187423706055
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.815 Vali Acc: 0.124 Test Loss: 4.815 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.9673664569854736
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.824 Vali Acc: 0.126 Test Loss: 4.824 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.425046920776367
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.833 Vali Acc: 0.125 Test Loss: 4.833 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.542144775390625
Epoch: 51, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.845 Vali Acc: 0.125 Test Loss: 4.845 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.1123549938201904
Epoch: 52, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.853 Vali Acc: 0.126 Test Loss: 4.853 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.3145477771759033
Epoch: 53, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.866 Vali Acc: 0.125 Test Loss: 4.866 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.12823529411764706
model parameter : 562522
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.3527209758758545
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.331 Vali Acc: 0.041 Test Loss: 3.331 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 3.5147416591644287
Epoch: 2, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.320 Vali Acc: 0.038 Test Loss: 3.320 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4476747512817383
Epoch: 3, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.331 Vali Acc: 0.047 Test Loss: 3.331 Test Acc: 0.047
Validation loss decreased (-0.041143 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 3.368607521057129
Epoch: 4, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.358 Vali Acc: 0.056 Test Loss: 3.358 Test Acc: 0.056
Validation loss decreased (-0.047026 --> -0.056437).  Saving model ...
Epoch: 5 cost time: 3.6580469608306885
Epoch: 5, Steps: 10 | Train Loss: 2.923 Vali Loss: 3.363 Vali Acc: 0.056 Test Loss: 3.363 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4028072357177734
Epoch: 6, Steps: 10 | Train Loss: 2.811 Vali Loss: 3.362 Vali Acc: 0.054 Test Loss: 3.362 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5503201484680176
Epoch: 7, Steps: 10 | Train Loss: 2.708 Vali Loss: 3.354 Vali Acc: 0.052 Test Loss: 3.354 Test Acc: 0.052
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.3635342121124268
Epoch: 8, Steps: 10 | Train Loss: 2.482 Vali Loss: 3.347 Vali Acc: 0.062 Test Loss: 3.347 Test Acc: 0.062
Validation loss decreased (-0.056437 --> -0.062319).  Saving model ...
Epoch: 9 cost time: 3.037792921066284
Epoch: 9, Steps: 10 | Train Loss: 2.308 Vali Loss: 3.355 Vali Acc: 0.065 Test Loss: 3.355 Test Acc: 0.065
Validation loss decreased (-0.062319 --> -0.064672).  Saving model ...
Epoch: 10 cost time: 3.428462505340576
Epoch: 10, Steps: 10 | Train Loss: 2.151 Vali Loss: 3.376 Vali Acc: 0.064 Test Loss: 3.376 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6925950050354004
Epoch: 11, Steps: 10 | Train Loss: 1.965 Vali Loss: 3.371 Vali Acc: 0.072 Test Loss: 3.371 Test Acc: 0.072
Validation loss decreased (-0.064672 --> -0.071731).  Saving model ...
Epoch: 12 cost time: 3.3912298679351807
Epoch: 12, Steps: 10 | Train Loss: 1.776 Vali Loss: 3.388 Vali Acc: 0.076 Test Loss: 3.388 Test Acc: 0.076
Validation loss decreased (-0.071731 --> -0.076437).  Saving model ...
Epoch: 13 cost time: 3.512666702270508
Epoch: 13, Steps: 10 | Train Loss: 1.530 Vali Loss: 3.411 Vali Acc: 0.082 Test Loss: 3.411 Test Acc: 0.082
Validation loss decreased (-0.076437 --> -0.082319).  Saving model ...
Epoch: 14 cost time: 3.7275586128234863
Epoch: 14, Steps: 10 | Train Loss: 1.368 Vali Loss: 3.444 Vali Acc: 0.082 Test Loss: 3.444 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.368347406387329
Epoch: 15, Steps: 10 | Train Loss: 1.093 Vali Loss: 3.499 Vali Acc: 0.080 Test Loss: 3.499 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.964468240737915
Epoch: 16, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.540 Vali Acc: 0.086 Test Loss: 3.540 Test Acc: 0.086
Validation loss decreased (-0.082319 --> -0.085847).  Saving model ...
Epoch: 17 cost time: 3.5553982257843018
Epoch: 17, Steps: 10 | Train Loss: 0.776 Vali Loss: 3.620 Vali Acc: 0.079 Test Loss: 3.620 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.057927131652832
Epoch: 18, Steps: 10 | Train Loss: 0.555 Vali Loss: 3.698 Vali Acc: 0.088 Test Loss: 3.698 Test Acc: 0.088
Validation loss decreased (-0.085847 --> -0.088198).  Saving model ...
Epoch: 19 cost time: 2.9807498455047607
Epoch: 19, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.792 Vali Acc: 0.076 Test Loss: 3.792 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5298643112182617
Epoch: 20, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.829 Vali Acc: 0.081 Test Loss: 3.829 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5506808757781982
Epoch: 21, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.971 Vali Acc: 0.092 Test Loss: 3.971 Test Acc: 0.092
Validation loss decreased (-0.088198 --> -0.091725).  Saving model ...
Epoch: 22 cost time: 3.414374828338623
Epoch: 22, Steps: 10 | Train Loss: 0.235 Vali Loss: 4.042 Vali Acc: 0.086 Test Loss: 4.042 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.468146324157715
Epoch: 23, Steps: 10 | Train Loss: 0.177 Vali Loss: 4.115 Vali Acc: 0.102 Test Loss: 4.115 Test Acc: 0.102
Validation loss decreased (-0.091725 --> -0.102312).  Saving model ...
Epoch: 24 cost time: 3.1465580463409424
Epoch: 24, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.167 Vali Acc: 0.092 Test Loss: 4.167 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3298377990722656
Epoch: 25, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.283 Vali Acc: 0.100 Test Loss: 4.283 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3641819953918457
Epoch: 26, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.326 Vali Acc: 0.105 Test Loss: 4.326 Test Acc: 0.105
Validation loss decreased (-0.102312 --> -0.104663).  Saving model ...
Epoch: 27 cost time: 2.9262852668762207
Epoch: 27, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.352 Vali Acc: 0.104 Test Loss: 4.352 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3049497604370117
Epoch: 28, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.387 Vali Acc: 0.111 Test Loss: 4.387 Test Acc: 0.111
Validation loss decreased (-0.104663 --> -0.110544).  Saving model ...
Epoch: 29 cost time: 3.628690004348755
Epoch: 29, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.382 Vali Acc: 0.108 Test Loss: 4.382 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.281379222869873
Epoch: 30, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.397 Vali Acc: 0.102 Test Loss: 4.397 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.7190351486206055
Epoch: 31, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.423 Vali Acc: 0.104 Test Loss: 4.423 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.532998561859131
Epoch: 32, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.460 Vali Acc: 0.101 Test Loss: 4.460 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.4400460720062256
Epoch: 33, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.518 Vali Acc: 0.104 Test Loss: 4.518 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.9396157264709473
Epoch: 34, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.556 Vali Acc: 0.105 Test Loss: 4.556 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.5171573162078857
Epoch: 35, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.581 Vali Acc: 0.100 Test Loss: 4.581 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.400472402572632
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.597 Vali Acc: 0.102 Test Loss: 4.597 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.9460201263427734
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.629 Vali Acc: 0.102 Test Loss: 4.629 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.7349693775177
Epoch: 38, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.663 Vali Acc: 0.106 Test Loss: 4.663 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.11058823529411765
model parameter : 562522
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.760199546813965
Epoch: 1, Steps: 10 | Train Loss: 3.373 Vali Loss: 3.306 Vali Acc: 0.049 Test Loss: 3.306 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 3.1834778785705566
Epoch: 2, Steps: 10 | Train Loss: 3.301 Vali Loss: 3.310 Vali Acc: 0.052 Test Loss: 3.310 Test Acc: 0.052
Validation loss decreased (-0.049379 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 3.6741127967834473
Epoch: 3, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.330 Vali Acc: 0.058 Test Loss: 3.330 Test Acc: 0.058
Validation loss decreased (-0.051732 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 3.009225606918335
Epoch: 4, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.358 Vali Acc: 0.061 Test Loss: 3.358 Test Acc: 0.061
Validation loss decreased (-0.057614 --> -0.061143).  Saving model ...
Epoch: 5 cost time: 2.9532477855682373
Epoch: 5, Steps: 10 | Train Loss: 2.984 Vali Loss: 3.367 Vali Acc: 0.062 Test Loss: 3.367 Test Acc: 0.062
Validation loss decreased (-0.061143 --> -0.062319).  Saving model ...
Epoch: 6 cost time: 3.6861774921417236
Epoch: 6, Steps: 10 | Train Loss: 2.916 Vali Loss: 3.370 Vali Acc: 0.067 Test Loss: 3.370 Test Acc: 0.067
Validation loss decreased (-0.062319 --> -0.067025).  Saving model ...
Epoch: 7 cost time: 3.34926700592041
Epoch: 7, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.365 Vali Acc: 0.061 Test Loss: 3.365 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5971076488494873
Epoch: 8, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.358 Vali Acc: 0.061 Test Loss: 3.358 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0426483154296875
Epoch: 9, Steps: 10 | Train Loss: 2.475 Vali Loss: 3.352 Vali Acc: 0.062 Test Loss: 3.352 Test Acc: 0.062
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.447052240371704
Epoch: 10, Steps: 10 | Train Loss: 2.341 Vali Loss: 3.368 Vali Acc: 0.061 Test Loss: 3.368 Test Acc: 0.061
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.30413556098938
Epoch: 11, Steps: 10 | Train Loss: 2.210 Vali Loss: 3.364 Vali Acc: 0.069 Test Loss: 3.364 Test Acc: 0.069
Validation loss decreased (-0.067025 --> -0.069378).  Saving model ...
Epoch: 12 cost time: 2.97060489654541
Epoch: 12, Steps: 10 | Train Loss: 2.085 Vali Loss: 3.379 Vali Acc: 0.071 Test Loss: 3.379 Test Acc: 0.071
Validation loss decreased (-0.069378 --> -0.070554).  Saving model ...
Epoch: 13 cost time: 3.3096084594726562
Epoch: 13, Steps: 10 | Train Loss: 1.839 Vali Loss: 3.395 Vali Acc: 0.076 Test Loss: 3.395 Test Acc: 0.076
Validation loss decreased (-0.070554 --> -0.076437).  Saving model ...
Epoch: 14 cost time: 3.2568397521972656
Epoch: 14, Steps: 10 | Train Loss: 1.700 Vali Loss: 3.424 Vali Acc: 0.081 Test Loss: 3.424 Test Acc: 0.081
Validation loss decreased (-0.076437 --> -0.081142).  Saving model ...
Epoch: 15 cost time: 3.436927080154419
Epoch: 15, Steps: 10 | Train Loss: 1.449 Vali Loss: 3.457 Vali Acc: 0.085 Test Loss: 3.457 Test Acc: 0.085
Validation loss decreased (-0.081142 --> -0.084671).  Saving model ...
Epoch: 16 cost time: 3.3396551609039307
Epoch: 16, Steps: 10 | Train Loss: 1.233 Vali Loss: 3.465 Vali Acc: 0.085 Test Loss: 3.465 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.230532646179199
Epoch: 17, Steps: 10 | Train Loss: 1.119 Vali Loss: 3.528 Vali Acc: 0.078 Test Loss: 3.528 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.291814088821411
Epoch: 18, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.573 Vali Acc: 0.078 Test Loss: 3.573 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.102159023284912
Epoch: 19, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.638 Vali Acc: 0.084 Test Loss: 3.638 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7074694633483887
Epoch: 20, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.693 Vali Acc: 0.080 Test Loss: 3.693 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.06785249710083
Epoch: 21, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.843 Vali Acc: 0.094 Test Loss: 3.843 Test Acc: 0.094
Validation loss decreased (-0.084671 --> -0.094079).  Saving model ...
Epoch: 22 cost time: 3.5217514038085938
Epoch: 22, Steps: 10 | Train Loss: 0.383 Vali Loss: 3.891 Vali Acc: 0.088 Test Loss: 3.891 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.67897891998291
Epoch: 23, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.987 Vali Acc: 0.092 Test Loss: 3.987 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2989747524261475
Epoch: 24, Steps: 10 | Train Loss: 0.205 Vali Loss: 4.071 Vali Acc: 0.094 Test Loss: 4.071 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.409475803375244
Epoch: 25, Steps: 10 | Train Loss: 0.157 Vali Loss: 4.213 Vali Acc: 0.091 Test Loss: 4.213 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.819279432296753
Epoch: 26, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.249 Vali Acc: 0.091 Test Loss: 4.249 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.9508187770843506
Epoch: 27, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.307 Vali Acc: 0.094 Test Loss: 4.307 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.051464557647705
Epoch: 28, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.365 Vali Acc: 0.100 Test Loss: 4.365 Test Acc: 0.100
Validation loss decreased (-0.094079 --> -0.099956).  Saving model ...
Epoch: 29 cost time: 3.297422409057617
Epoch: 29, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.377 Vali Acc: 0.095 Test Loss: 4.377 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.8756611347198486
Epoch: 30, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.404 Vali Acc: 0.098 Test Loss: 4.404 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.710878372192383
Epoch: 31, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.453 Vali Acc: 0.091 Test Loss: 4.453 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.297081232070923
Epoch: 32, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.486 Vali Acc: 0.095 Test Loss: 4.486 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.6806788444519043
Epoch: 33, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.529 Vali Acc: 0.095 Test Loss: 4.529 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.3527767658233643
Epoch: 34, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.532 Vali Acc: 0.093 Test Loss: 4.532 Test Acc: 0.093
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.412719964981079
Epoch: 35, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.524 Vali Acc: 0.099 Test Loss: 4.524 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.989415168762207
Epoch: 36, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.533 Vali Acc: 0.102 Test Loss: 4.533 Test Acc: 0.102
Validation loss decreased (-0.099956 --> -0.102308).  Saving model ...
Epoch: 37 cost time: 3.818645715713501
Epoch: 37, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.585 Vali Acc: 0.093 Test Loss: 4.585 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.194983720779419
Epoch: 38, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.662 Vali Acc: 0.093 Test Loss: 4.662 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.5856540203094482
Epoch: 39, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.691 Vali Acc: 0.096 Test Loss: 4.691 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.173637628555298
Epoch: 40, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.693 Vali Acc: 0.105 Test Loss: 4.693 Test Acc: 0.105
Validation loss decreased (-0.102308 --> -0.104659).  Saving model ...
Epoch: 41 cost time: 3.3633108139038086
Epoch: 41, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.716 Vali Acc: 0.101 Test Loss: 4.716 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.5076215267181396
Epoch: 42, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.730 Vali Acc: 0.100 Test Loss: 4.730 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.2838454246520996
Epoch: 43, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.754 Vali Acc: 0.094 Test Loss: 4.754 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.448004961013794
Epoch: 44, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.781 Vali Acc: 0.093 Test Loss: 4.781 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.1304898262023926
Epoch: 45, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.788 Vali Acc: 0.095 Test Loss: 4.788 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.709371566772461
Epoch: 46, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.812 Vali Acc: 0.096 Test Loss: 4.812 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.277890920639038
Epoch: 47, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.841 Vali Acc: 0.098 Test Loss: 4.841 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.519521713256836
Epoch: 48, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.861 Vali Acc: 0.093 Test Loss: 4.861 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.242748737335205
Epoch: 49, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.865 Vali Acc: 0.095 Test Loss: 4.865 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.7181315422058105
Epoch: 50, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.870 Vali Acc: 0.095 Test Loss: 4.870 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.10470588235294118
model parameter : 562522
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.627564430236816
Epoch: 1, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.335 Vali Acc: 0.031 Test Loss: 3.335 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 2.8280885219573975
Epoch: 2, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.341 Vali Acc: 0.031 Test Loss: 3.341 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8621487617492676
Epoch: 3, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.365 Vali Acc: 0.041 Test Loss: 3.365 Test Acc: 0.041
Validation loss decreased (-0.030555 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 2.964621067047119
Epoch: 4, Steps: 10 | Train Loss: 3.101 Vali Loss: 3.401 Vali Acc: 0.041 Test Loss: 3.401 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.107006072998047
Epoch: 5, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.421 Vali Acc: 0.048 Test Loss: 3.421 Test Acc: 0.048
Validation loss decreased (-0.041143 --> -0.048201).  Saving model ...
Epoch: 6 cost time: 3.2480387687683105
Epoch: 6, Steps: 10 | Train Loss: 3.009 Vali Loss: 3.432 Vali Acc: 0.049 Test Loss: 3.432 Test Acc: 0.049
Validation loss decreased (-0.048201 --> -0.049377).  Saving model ...
Epoch: 7 cost time: 3.2898194789886475
Epoch: 7, Steps: 10 | Train Loss: 2.959 Vali Loss: 3.429 Vali Acc: 0.056 Test Loss: 3.429 Test Acc: 0.056
Validation loss decreased (-0.049377 --> -0.056436).  Saving model ...
Epoch: 8 cost time: 3.6215898990631104
Epoch: 8, Steps: 10 | Train Loss: 2.783 Vali Loss: 3.410 Vali Acc: 0.058 Test Loss: 3.410 Test Acc: 0.058
Validation loss decreased (-0.056436 --> -0.057613).  Saving model ...
Epoch: 9 cost time: 3.599315881729126
Epoch: 9, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.399 Vali Acc: 0.062 Test Loss: 3.399 Test Acc: 0.062
Validation loss decreased (-0.057613 --> -0.062319).  Saving model ...
Epoch: 10 cost time: 3.182612180709839
Epoch: 10, Steps: 10 | Train Loss: 2.596 Vali Loss: 3.406 Vali Acc: 0.071 Test Loss: 3.406 Test Acc: 0.071
Validation loss decreased (-0.062319 --> -0.070554).  Saving model ...
Epoch: 11 cost time: 3.1980886459350586
Epoch: 11, Steps: 10 | Train Loss: 2.416 Vali Loss: 3.398 Vali Acc: 0.075 Test Loss: 3.398 Test Acc: 0.075
Validation loss decreased (-0.070554 --> -0.075260).  Saving model ...
Epoch: 12 cost time: 3.215912342071533
Epoch: 12, Steps: 10 | Train Loss: 2.319 Vali Loss: 3.397 Vali Acc: 0.076 Test Loss: 3.397 Test Acc: 0.076
Validation loss decreased (-0.075260 --> -0.076437).  Saving model ...
Epoch: 13 cost time: 3.3177523612976074
Epoch: 13, Steps: 10 | Train Loss: 2.169 Vali Loss: 3.396 Vali Acc: 0.081 Test Loss: 3.396 Test Acc: 0.081
Validation loss decreased (-0.076437 --> -0.081143).  Saving model ...
Epoch: 14 cost time: 3.278628349304199
Epoch: 14, Steps: 10 | Train Loss: 2.027 Vali Loss: 3.409 Vali Acc: 0.075 Test Loss: 3.409 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4292683601379395
Epoch: 15, Steps: 10 | Train Loss: 1.830 Vali Loss: 3.442 Vali Acc: 0.074 Test Loss: 3.442 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.234405755996704
Epoch: 16, Steps: 10 | Train Loss: 1.667 Vali Loss: 3.470 Vali Acc: 0.078 Test Loss: 3.470 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.1628904342651367
Epoch: 17, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.540 Vali Acc: 0.076 Test Loss: 3.540 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.999821662902832
Epoch: 18, Steps: 10 | Train Loss: 1.263 Vali Loss: 3.595 Vali Acc: 0.065 Test Loss: 3.595 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2955613136291504
Epoch: 19, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.662 Vali Acc: 0.067 Test Loss: 3.662 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.1673617362976074
Epoch: 20, Steps: 10 | Train Loss: 0.909 Vali Loss: 3.701 Vali Acc: 0.075 Test Loss: 3.701 Test Acc: 0.075
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.281681776046753
Epoch: 21, Steps: 10 | Train Loss: 0.802 Vali Loss: 3.811 Vali Acc: 0.086 Test Loss: 3.811 Test Acc: 0.086
Validation loss decreased (-0.081143 --> -0.085844).  Saving model ...
Epoch: 22 cost time: 3.564356565475464
Epoch: 22, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.837 Vali Acc: 0.094 Test Loss: 3.837 Test Acc: 0.094
Validation loss decreased (-0.085844 --> -0.094079).  Saving model ...
Epoch: 23 cost time: 3.5450918674468994
Epoch: 23, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.930 Vali Acc: 0.087 Test Loss: 3.930 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.42179799079895
Epoch: 24, Steps: 10 | Train Loss: 0.467 Vali Loss: 4.024 Vali Acc: 0.087 Test Loss: 4.024 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.4471404552459717
Epoch: 25, Steps: 10 | Train Loss: 0.334 Vali Loss: 4.091 Vali Acc: 0.092 Test Loss: 4.091 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.2531790733337402
Epoch: 26, Steps: 10 | Train Loss: 0.285 Vali Loss: 4.161 Vali Acc: 0.099 Test Loss: 4.161 Test Acc: 0.099
Validation loss decreased (-0.094079 --> -0.098782).  Saving model ...
Epoch: 27 cost time: 3.249135971069336
Epoch: 27, Steps: 10 | Train Loss: 0.226 Vali Loss: 4.215 Vali Acc: 0.100 Test Loss: 4.215 Test Acc: 0.100
Validation loss decreased (-0.098782 --> -0.099958).  Saving model ...
Epoch: 28 cost time: 3.597316265106201
Epoch: 28, Steps: 10 | Train Loss: 0.178 Vali Loss: 4.314 Vali Acc: 0.102 Test Loss: 4.314 Test Acc: 0.102
Validation loss decreased (-0.099958 --> -0.102310).  Saving model ...
Epoch: 29 cost time: 3.472454309463501
Epoch: 29, Steps: 10 | Train Loss: 0.170 Vali Loss: 4.362 Vali Acc: 0.106 Test Loss: 4.362 Test Acc: 0.106
Validation loss decreased (-0.102310 --> -0.105839).  Saving model ...
Epoch: 30 cost time: 3.5875766277313232
Epoch: 30, Steps: 10 | Train Loss: 0.141 Vali Loss: 4.398 Vali Acc: 0.102 Test Loss: 4.398 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1854088306427
Epoch: 31, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.469 Vali Acc: 0.100 Test Loss: 4.469 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.0852394104003906
Epoch: 32, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.487 Vali Acc: 0.100 Test Loss: 4.487 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.4343090057373047
Epoch: 33, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.557 Vali Acc: 0.100 Test Loss: 4.557 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.3670616149902344
Epoch: 34, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.610 Vali Acc: 0.093 Test Loss: 4.610 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.622023105621338
Epoch: 35, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.637 Vali Acc: 0.099 Test Loss: 4.637 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.593308925628662
Epoch: 36, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.659 Vali Acc: 0.107 Test Loss: 4.659 Test Acc: 0.107
Validation loss decreased (-0.105839 --> -0.107012).  Saving model ...
Epoch: 37 cost time: 3.389133930206299
Epoch: 37, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.698 Vali Acc: 0.111 Test Loss: 4.698 Test Acc: 0.111
Validation loss decreased (-0.107012 --> -0.110541).  Saving model ...
Epoch: 38 cost time: 3.355196714401245
Epoch: 38, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.766 Vali Acc: 0.108 Test Loss: 4.766 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.2447283267974854
Epoch: 39, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.830 Vali Acc: 0.112 Test Loss: 4.830 Test Acc: 0.112
Validation loss decreased (-0.110541 --> -0.111716).  Saving model ...
Epoch: 40 cost time: 3.3353278636932373
Epoch: 40, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.790 Vali Acc: 0.115 Test Loss: 4.790 Test Acc: 0.115
Validation loss decreased (-0.111716 --> -0.115246).  Saving model ...
Epoch: 41 cost time: 3.0454134941101074
Epoch: 41, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.788 Vali Acc: 0.107 Test Loss: 4.788 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.4082655906677246
Epoch: 42, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.812 Vali Acc: 0.113 Test Loss: 4.812 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.580045700073242
Epoch: 43, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.842 Vali Acc: 0.115 Test Loss: 4.842 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.0772876739501953
Epoch: 44, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.864 Vali Acc: 0.115 Test Loss: 4.864 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.194519281387329
Epoch: 45, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.878 Vali Acc: 0.113 Test Loss: 4.878 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.077540397644043
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.891 Vali Acc: 0.113 Test Loss: 4.891 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.859238624572754
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.931 Vali Acc: 0.106 Test Loss: 4.931 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.129013776779175
Epoch: 48, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.992 Vali Acc: 0.107 Test Loss: 4.992 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.610464096069336
Epoch: 49, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.998 Vali Acc: 0.107 Test Loss: 4.998 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.6792054176330566
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.990 Vali Acc: 0.114 Test Loss: 4.990 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.11529411764705882
model parameter : 562522
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.078011751174927
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
Validation loss decreased (inf --> -0.030556).  Saving model ...
Epoch: 2 cost time: 3.033853054046631
Epoch: 2, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
Validation loss decreased (-0.030556 --> -0.030556).  Saving model ...
Epoch: 3 cost time: 2.849518060684204
Epoch: 3, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.030556 --> -0.035262).  Saving model ...
Epoch: 4 cost time: 3.2759745121002197
Epoch: 4, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 5 cost time: 3.0846781730651855
Epoch: 5, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 6 cost time: 3.4201624393463135
Epoch: 6, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 7 cost time: 3.366210699081421
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 8 cost time: 3.169170379638672
Epoch: 8, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 9 cost time: 3.25962495803833
Epoch: 9, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 10 cost time: 3.098165273666382
Epoch: 10, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 11 cost time: 3.0579209327697754
Epoch: 11, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 12 cost time: 3.0957493782043457
Epoch: 12, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 13 cost time: 3.687377691268921
Epoch: 13, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 14 cost time: 3.4827280044555664
Epoch: 14, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 15 cost time: 3.116379976272583
Epoch: 15, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 16 cost time: 2.9287123680114746
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 17 cost time: 3.330423593521118
Epoch: 17, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 18 cost time: 4.115908622741699
Epoch: 18, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 19 cost time: 3.5365633964538574
Epoch: 19, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 20 cost time: 3.3901238441467285
Epoch: 20, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 21 cost time: 3.098639965057373
Epoch: 21, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.035 Test Loss: 3.258 Test Acc: 0.035
Validation loss decreased (-0.035262 --> -0.035262).  Saving model ...
Epoch: 22 cost time: 2.9935598373413086
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.035262 --> -0.037614).  Saving model ...
Epoch: 23 cost time: 3.237600803375244
Epoch: 23, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 24 cost time: 3.45574951171875
Epoch: 24, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 25 cost time: 3.4308481216430664
Epoch: 25, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 26 cost time: 3.5268046855926514
Epoch: 26, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 27 cost time: 3.5015854835510254
Epoch: 27, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 28 cost time: 3.1521544456481934
Epoch: 28, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 29 cost time: 3.42038893699646
Epoch: 29, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 30 cost time: 2.9684360027313232
Epoch: 30, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 31 cost time: 2.989675283432007
Epoch: 31, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 32 cost time: 3.2015323638916016
Epoch: 32, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 33 cost time: 3.191084384918213
Epoch: 33, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 34 cost time: 3.6435043811798096
Epoch: 34, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 35 cost time: 3.2163772583007812
Epoch: 35, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 36 cost time: 2.8008551597595215
Epoch: 36, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 37 cost time: 2.664515733718872
Epoch: 37, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 38 cost time: 3.039224147796631
Epoch: 38, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 39 cost time: 3.205026149749756
Epoch: 39, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 40 cost time: 3.0968265533447266
Epoch: 40, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 41 cost time: 3.277433395385742
Epoch: 41, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 42 cost time: 3.3126015663146973
Epoch: 42, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.0958046913146973
Epoch: 43, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 44 cost time: 2.9062743186950684
Epoch: 44, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 45 cost time: 3.1748545169830322
Epoch: 45, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.2438411712646484
Epoch: 46, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.9146780967712402
Epoch: 47, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.9995126724243164
Epoch: 48, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.1135528087615967
Epoch: 49, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.173051118850708
Epoch: 50, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.6031479835510254
Epoch: 51, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.385972499847412
Epoch: 52, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.8654069900512695
Epoch: 53, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 3.1276888847351074
Epoch: 54, Steps: 10 | Train Loss: 3.239 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.03764705882352941
model parameter : 562522
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.0889623165130615
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.340 Vali Acc: 0.039 Test Loss: 3.340 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 3.3264760971069336
Epoch: 2, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.306 Vali Acc: 0.041 Test Loss: 3.306 Test Acc: 0.041
Validation loss decreased (-0.038790 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 3.4135282039642334
Epoch: 3, Steps: 10 | Train Loss: 2.974 Vali Loss: 3.290 Vali Acc: 0.066 Test Loss: 3.290 Test Acc: 0.066
Validation loss decreased (-0.041143 --> -0.065849).  Saving model ...
Epoch: 4 cost time: 3.3061368465423584
Epoch: 4, Steps: 10 | Train Loss: 2.712 Vali Loss: 3.264 Vali Acc: 0.086 Test Loss: 3.264 Test Acc: 0.086
Validation loss decreased (-0.065849 --> -0.085850).  Saving model ...
Epoch: 5 cost time: 3.3085103034973145
Epoch: 5, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.219 Vali Acc: 0.127 Test Loss: 3.219 Test Acc: 0.127
Validation loss decreased (-0.085850 --> -0.127027).  Saving model ...
Epoch: 6 cost time: 3.1297457218170166
Epoch: 6, Steps: 10 | Train Loss: 2.209 Vali Loss: 3.173 Vali Acc: 0.148 Test Loss: 3.173 Test Acc: 0.148
Validation loss decreased (-0.127027 --> -0.148204).  Saving model ...
Epoch: 7 cost time: 3.2580206394195557
Epoch: 7, Steps: 10 | Train Loss: 1.890 Vali Loss: 3.144 Vali Acc: 0.166 Test Loss: 3.144 Test Acc: 0.166
Validation loss decreased (-0.148204 --> -0.165851).  Saving model ...
Epoch: 8 cost time: 3.3083910942077637
Epoch: 8, Steps: 10 | Train Loss: 1.587 Vali Loss: 3.119 Vali Acc: 0.199 Test Loss: 3.119 Test Acc: 0.199
Validation loss decreased (-0.165851 --> -0.198792).  Saving model ...
Epoch: 9 cost time: 3.0607731342315674
Epoch: 9, Steps: 10 | Train Loss: 1.338 Vali Loss: 3.121 Vali Acc: 0.212 Test Loss: 3.121 Test Acc: 0.212
Validation loss decreased (-0.198792 --> -0.211733).  Saving model ...
Epoch: 10 cost time: 3.110685110092163
Epoch: 10, Steps: 10 | Train Loss: 1.067 Vali Loss: 3.132 Vali Acc: 0.220 Test Loss: 3.132 Test Acc: 0.220
Validation loss decreased (-0.211733 --> -0.219969).  Saving model ...
Epoch: 11 cost time: 3.2396080493927
Epoch: 11, Steps: 10 | Train Loss: 0.828 Vali Loss: 3.154 Vali Acc: 0.233 Test Loss: 3.154 Test Acc: 0.233
Validation loss decreased (-0.219969 --> -0.232910).  Saving model ...
Epoch: 12 cost time: 3.2573297023773193
Epoch: 12, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.194 Vali Acc: 0.245 Test Loss: 3.194 Test Acc: 0.245
Validation loss decreased (-0.232910 --> -0.244674).  Saving model ...
Epoch: 13 cost time: 3.594444513320923
Epoch: 13, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.223 Vali Acc: 0.254 Test Loss: 3.223 Test Acc: 0.254
Validation loss decreased (-0.244674 --> -0.254085).  Saving model ...
Epoch: 14 cost time: 3.435272216796875
Epoch: 14, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.307 Vali Acc: 0.258 Test Loss: 3.307 Test Acc: 0.258
Validation loss decreased (-0.254085 --> -0.257614).  Saving model ...
Epoch: 15 cost time: 3.2795119285583496
Epoch: 15, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.333 Vali Acc: 0.275 Test Loss: 3.333 Test Acc: 0.275
Validation loss decreased (-0.257614 --> -0.275261).  Saving model ...
Epoch: 16 cost time: 3.047027826309204
Epoch: 16, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.394 Vali Acc: 0.274 Test Loss: 3.394 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.856722116470337
Epoch: 17, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.427 Vali Acc: 0.282 Test Loss: 3.427 Test Acc: 0.282
Validation loss decreased (-0.275261 --> -0.282319).  Saving model ...
Epoch: 18 cost time: 3.243556022644043
Epoch: 18, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.489 Vali Acc: 0.280 Test Loss: 3.489 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7536654472351074
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.509 Vali Acc: 0.281 Test Loss: 3.509 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.5177884101867676
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.542 Vali Acc: 0.284 Test Loss: 3.542 Test Acc: 0.284
Validation loss decreased (-0.282319 --> -0.283494).  Saving model ...
Epoch: 21 cost time: 3.3611209392547607
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.582 Vali Acc: 0.285 Test Loss: 3.582 Test Acc: 0.285
Validation loss decreased (-0.283494 --> -0.284670).  Saving model ...
Epoch: 22 cost time: 3.3845200538635254
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.611 Vali Acc: 0.289 Test Loss: 3.611 Test Acc: 0.289
Validation loss decreased (-0.284670 --> -0.289376).  Saving model ...
Epoch: 23 cost time: 3.3571255207061768
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.627 Vali Acc: 0.289 Test Loss: 3.627 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.539706230163574
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.644 Vali Acc: 0.288 Test Loss: 3.644 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.4843997955322266
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.663 Vali Acc: 0.289 Test Loss: 3.663 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.070235013961792
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.698 Vali Acc: 0.296 Test Loss: 3.698 Test Acc: 0.296
Validation loss decreased (-0.289376 --> -0.296434).  Saving model ...
Epoch: 27 cost time: 2.9817075729370117
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.723 Vali Acc: 0.294 Test Loss: 3.723 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.1702308654785156
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.747 Vali Acc: 0.288 Test Loss: 3.747 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.054293632507324
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.752 Vali Acc: 0.298 Test Loss: 3.752 Test Acc: 0.298
Validation loss decreased (-0.296434 --> -0.297610).  Saving model ...
Epoch: 30 cost time: 3.6510586738586426
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.757 Vali Acc: 0.304 Test Loss: 3.757 Test Acc: 0.304
Validation loss decreased (-0.297610 --> -0.303492).  Saving model ...
Epoch: 31 cost time: 3.5162551403045654
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.776 Vali Acc: 0.299 Test Loss: 3.776 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3032686710357666
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.795 Vali Acc: 0.295 Test Loss: 3.795 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.97072696685791
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.797 Vali Acc: 0.300 Test Loss: 3.797 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.0555474758148193
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.814 Vali Acc: 0.299 Test Loss: 3.814 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.324248790740967
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.834 Vali Acc: 0.301 Test Loss: 3.834 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.4311866760253906
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.864 Vali Acc: 0.298 Test Loss: 3.864 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.5099592208862305
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.885 Vali Acc: 0.300 Test Loss: 3.885 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.273897171020508
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.903 Vali Acc: 0.298 Test Loss: 3.903 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.2759323120117188
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.908 Vali Acc: 0.300 Test Loss: 3.908 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.9873552322387695
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.913 Vali Acc: 0.301 Test Loss: 3.913 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 365914
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.73412013053894
Epoch: 1, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.343 Vali Acc: 0.033 Test Loss: 3.343 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 3.3939661979675293
Epoch: 2, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.312 Vali Acc: 0.047 Test Loss: 3.312 Test Acc: 0.047
Validation loss decreased (-0.032908 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 3.15753436088562
Epoch: 3, Steps: 10 | Train Loss: 2.963 Vali Loss: 3.300 Vali Acc: 0.075 Test Loss: 3.300 Test Acc: 0.075
Validation loss decreased (-0.047026 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 3.172321081161499
Epoch: 4, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.273 Vali Acc: 0.088 Test Loss: 3.273 Test Acc: 0.088
Validation loss decreased (-0.075261 --> -0.088203).  Saving model ...
Epoch: 5 cost time: 3.14540958404541
Epoch: 5, Steps: 10 | Train Loss: 2.484 Vali Loss: 3.227 Vali Acc: 0.118 Test Loss: 3.227 Test Acc: 0.118
Validation loss decreased (-0.088203 --> -0.117615).  Saving model ...
Epoch: 6 cost time: 3.671830892562866
Epoch: 6, Steps: 10 | Train Loss: 2.237 Vali Loss: 3.180 Vali Acc: 0.147 Test Loss: 3.180 Test Acc: 0.147
Validation loss decreased (-0.117615 --> -0.147027).  Saving model ...
Epoch: 7 cost time: 3.5664103031158447
Epoch: 7, Steps: 10 | Train Loss: 1.938 Vali Loss: 3.151 Vali Acc: 0.174 Test Loss: 3.151 Test Acc: 0.174
Validation loss decreased (-0.147027 --> -0.174086).  Saving model ...
Epoch: 8 cost time: 3.2060084342956543
Epoch: 8, Steps: 10 | Train Loss: 1.634 Vali Loss: 3.123 Vali Acc: 0.196 Test Loss: 3.123 Test Acc: 0.196
Validation loss decreased (-0.174086 --> -0.196439).  Saving model ...
Epoch: 9 cost time: 3.163447380065918
Epoch: 9, Steps: 10 | Train Loss: 1.391 Vali Loss: 3.120 Vali Acc: 0.219 Test Loss: 3.120 Test Acc: 0.219
Validation loss decreased (-0.196439 --> -0.218792).  Saving model ...
Epoch: 10 cost time: 3.1878373622894287
Epoch: 10, Steps: 10 | Train Loss: 1.130 Vali Loss: 3.133 Vali Acc: 0.228 Test Loss: 3.133 Test Acc: 0.228
Validation loss decreased (-0.218792 --> -0.228204).  Saving model ...
Epoch: 11 cost time: 2.84367299079895
Epoch: 11, Steps: 10 | Train Loss: 0.870 Vali Loss: 3.153 Vali Acc: 0.240 Test Loss: 3.153 Test Acc: 0.240
Validation loss decreased (-0.228204 --> -0.239968).  Saving model ...
Epoch: 12 cost time: 3.2650692462921143
Epoch: 12, Steps: 10 | Train Loss: 0.658 Vali Loss: 3.196 Vali Acc: 0.254 Test Loss: 3.196 Test Acc: 0.254
Validation loss decreased (-0.239968 --> -0.254086).  Saving model ...
Epoch: 13 cost time: 3.3952858448028564
Epoch: 13, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.240 Vali Acc: 0.266 Test Loss: 3.240 Test Acc: 0.266
Validation loss decreased (-0.254086 --> -0.265850).  Saving model ...
Epoch: 14 cost time: 3.7621569633483887
Epoch: 14, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.307 Vali Acc: 0.271 Test Loss: 3.307 Test Acc: 0.271
Validation loss decreased (-0.265850 --> -0.270555).  Saving model ...
Epoch: 15 cost time: 3.473613977432251
Epoch: 15, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.369 Vali Acc: 0.273 Test Loss: 3.369 Test Acc: 0.273
Validation loss decreased (-0.270555 --> -0.272907).  Saving model ...
Epoch: 16 cost time: 3.4471399784088135
Epoch: 16, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.445 Vali Acc: 0.280 Test Loss: 3.445 Test Acc: 0.280
Validation loss decreased (-0.272907 --> -0.279966).  Saving model ...
Epoch: 17 cost time: 3.210904359817505
Epoch: 17, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.459 Vali Acc: 0.286 Test Loss: 3.459 Test Acc: 0.286
Validation loss decreased (-0.279966 --> -0.285848).  Saving model ...
Epoch: 18 cost time: 3.3897478580474854
Epoch: 18, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.520 Vali Acc: 0.282 Test Loss: 3.520 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2913360595703125
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.567 Vali Acc: 0.293 Test Loss: 3.567 Test Acc: 0.293
Validation loss decreased (-0.285848 --> -0.292906).  Saving model ...
Epoch: 20 cost time: 3.24094295501709
Epoch: 20, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.605 Vali Acc: 0.291 Test Loss: 3.605 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4608049392700195
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.644 Vali Acc: 0.294 Test Loss: 3.644 Test Acc: 0.294
Validation loss decreased (-0.292906 --> -0.294081).  Saving model ...
Epoch: 22 cost time: 3.549771547317505
Epoch: 22, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.668 Vali Acc: 0.289 Test Loss: 3.668 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2069361209869385
Epoch: 23, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.688 Vali Acc: 0.292 Test Loss: 3.688 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.176612377166748
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.705 Vali Acc: 0.291 Test Loss: 3.705 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0300662517547607
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.727 Vali Acc: 0.292 Test Loss: 3.727 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.542123794555664
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.764 Vali Acc: 0.299 Test Loss: 3.764 Test Acc: 0.299
Validation loss decreased (-0.294081 --> -0.298786).  Saving model ...
Epoch: 27 cost time: 3.2443273067474365
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.786 Vali Acc: 0.293 Test Loss: 3.786 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0431785583496094
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.808 Vali Acc: 0.298 Test Loss: 3.808 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1101081371307373
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.819 Vali Acc: 0.304 Test Loss: 3.819 Test Acc: 0.304
Validation loss decreased (-0.298786 --> -0.303491).  Saving model ...
Epoch: 30 cost time: 3.0714797973632812
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.834 Vali Acc: 0.305 Test Loss: 3.834 Test Acc: 0.305
Validation loss decreased (-0.303491 --> -0.304668).  Saving model ...
Epoch: 31 cost time: 3.368197202682495
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.865 Vali Acc: 0.299 Test Loss: 3.865 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3535046577453613
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.892 Vali Acc: 0.296 Test Loss: 3.892 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.5388262271881104
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.892 Vali Acc: 0.306 Test Loss: 3.892 Test Acc: 0.306
Validation loss decreased (-0.304668 --> -0.305843).  Saving model ...
Epoch: 34 cost time: 2.8407235145568848
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.909 Vali Acc: 0.308 Test Loss: 3.909 Test Acc: 0.308
Validation loss decreased (-0.305843 --> -0.308196).  Saving model ...
Epoch: 35 cost time: 3.1676955223083496
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.934 Vali Acc: 0.300 Test Loss: 3.934 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.1477208137512207
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.976 Vali Acc: 0.300 Test Loss: 3.976 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.373297929763794
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.985 Vali Acc: 0.302 Test Loss: 3.985 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.2626006603240967
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.990 Vali Acc: 0.304 Test Loss: 3.990 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.0250535011291504
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.990 Vali Acc: 0.305 Test Loss: 3.990 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.8293912410736084
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.995 Vali Acc: 0.308 Test Loss: 3.995 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.8850855827331543
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.007 Vali Acc: 0.308 Test Loss: 4.007 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.9730782508850098
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.028 Vali Acc: 0.307 Test Loss: 4.028 Test Acc: 0.307
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.285209894180298
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.043 Vali Acc: 0.305 Test Loss: 4.043 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.3162803649902344
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.056 Vali Acc: 0.306 Test Loss: 4.056 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30823529411764705
model parameter : 365914
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.7862043380737305
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.327 Vali Acc: 0.036 Test Loss: 3.327 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 3.2252554893493652
Epoch: 2, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.292 Vali Acc: 0.066 Test Loss: 3.292 Test Acc: 0.066
Validation loss decreased (-0.036437 --> -0.065849).  Saving model ...
Epoch: 3 cost time: 3.404372215270996
Epoch: 3, Steps: 10 | Train Loss: 2.965 Vali Loss: 3.279 Vali Acc: 0.075 Test Loss: 3.279 Test Acc: 0.075
Validation loss decreased (-0.065849 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 3.516632080078125
Epoch: 4, Steps: 10 | Train Loss: 2.750 Vali Loss: 3.256 Vali Acc: 0.098 Test Loss: 3.256 Test Acc: 0.098
Validation loss decreased (-0.075261 --> -0.097614).  Saving model ...
Epoch: 5 cost time: 3.5312702655792236
Epoch: 5, Steps: 10 | Train Loss: 2.468 Vali Loss: 3.220 Vali Acc: 0.135 Test Loss: 3.220 Test Acc: 0.135
Validation loss decreased (-0.097614 --> -0.135262).  Saving model ...
Epoch: 6 cost time: 3.3322365283966064
Epoch: 6, Steps: 10 | Train Loss: 2.242 Vali Loss: 3.186 Vali Acc: 0.156 Test Loss: 3.186 Test Acc: 0.156
Validation loss decreased (-0.135262 --> -0.156439).  Saving model ...
Epoch: 7 cost time: 3.1119306087493896
Epoch: 7, Steps: 10 | Train Loss: 1.959 Vali Loss: 3.169 Vali Acc: 0.178 Test Loss: 3.169 Test Acc: 0.178
Validation loss decreased (-0.156439 --> -0.177615).  Saving model ...
Epoch: 8 cost time: 3.065048933029175
Epoch: 8, Steps: 10 | Train Loss: 1.687 Vali Loss: 3.148 Vali Acc: 0.195 Test Loss: 3.148 Test Acc: 0.195
Validation loss decreased (-0.177615 --> -0.195263).  Saving model ...
Epoch: 9 cost time: 3.1590898036956787
Epoch: 9, Steps: 10 | Train Loss: 1.441 Vali Loss: 3.160 Vali Acc: 0.206 Test Loss: 3.160 Test Acc: 0.206
Validation loss decreased (-0.195263 --> -0.205851).  Saving model ...
Epoch: 10 cost time: 3.4362950325012207
Epoch: 10, Steps: 10 | Train Loss: 1.188 Vali Loss: 3.186 Vali Acc: 0.220 Test Loss: 3.186 Test Acc: 0.220
Validation loss decreased (-0.205851 --> -0.219968).  Saving model ...
Epoch: 11 cost time: 3.422921657562256
Epoch: 11, Steps: 10 | Train Loss: 0.962 Vali Loss: 3.206 Vali Acc: 0.229 Test Loss: 3.206 Test Acc: 0.229
Validation loss decreased (-0.219968 --> -0.229380).  Saving model ...
Epoch: 12 cost time: 3.2693939208984375
Epoch: 12, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.248 Vali Acc: 0.251 Test Loss: 3.248 Test Acc: 0.251
Validation loss decreased (-0.229380 --> -0.250556).  Saving model ...
Epoch: 13 cost time: 3.2421023845672607
Epoch: 13, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.273 Vali Acc: 0.254 Test Loss: 3.273 Test Acc: 0.254
Validation loss decreased (-0.250556 --> -0.254085).  Saving model ...
Epoch: 14 cost time: 2.9940779209136963
Epoch: 14, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.348 Vali Acc: 0.267 Test Loss: 3.348 Test Acc: 0.267
Validation loss decreased (-0.254085 --> -0.267025).  Saving model ...
Epoch: 15 cost time: 3.5142757892608643
Epoch: 15, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.402 Vali Acc: 0.264 Test Loss: 3.402 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4797773361206055
Epoch: 16, Steps: 10 | Train Loss: 0.264 Vali Loss: 3.464 Vali Acc: 0.276 Test Loss: 3.464 Test Acc: 0.276
Validation loss decreased (-0.267025 --> -0.276436).  Saving model ...
Epoch: 17 cost time: 3.014652729034424
Epoch: 17, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.500 Vali Acc: 0.286 Test Loss: 3.500 Test Acc: 0.286
Validation loss decreased (-0.276436 --> -0.285847).  Saving model ...
Epoch: 18 cost time: 2.974187135696411
Epoch: 18, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.575 Vali Acc: 0.275 Test Loss: 3.575 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2443158626556396
Epoch: 19, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.617 Vali Acc: 0.284 Test Loss: 3.617 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.633953094482422
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.674 Vali Acc: 0.286 Test Loss: 3.674 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.5532236099243164
Epoch: 21, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.715 Vali Acc: 0.284 Test Loss: 3.715 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.2554502487182617
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.742 Vali Acc: 0.284 Test Loss: 3.742 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.933905601501465
Epoch: 23, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.770 Vali Acc: 0.285 Test Loss: 3.770 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.9797935485839844
Epoch: 24, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.796 Vali Acc: 0.288 Test Loss: 3.796 Test Acc: 0.288
Validation loss decreased (-0.285847 --> -0.288197).  Saving model ...
Epoch: 25 cost time: 3.5652003288269043
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.811 Vali Acc: 0.288 Test Loss: 3.811 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.460796356201172
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.835 Vali Acc: 0.289 Test Loss: 3.835 Test Acc: 0.289
Validation loss decreased (-0.288197 --> -0.289373).  Saving model ...
Epoch: 27 cost time: 3.235349416732788
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.861 Vali Acc: 0.294 Test Loss: 3.861 Test Acc: 0.294
Validation loss decreased (-0.289373 --> -0.294079).  Saving model ...
Epoch: 28 cost time: 2.94268798828125
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.899 Vali Acc: 0.294 Test Loss: 3.899 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1796302795410156
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.906 Vali Acc: 0.295 Test Loss: 3.906 Test Acc: 0.295
Validation loss decreased (-0.294079 --> -0.295255).  Saving model ...
Epoch: 30 cost time: 3.450810670852661
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.896 Vali Acc: 0.299 Test Loss: 3.896 Test Acc: 0.299
Validation loss decreased (-0.295255 --> -0.298785).  Saving model ...
Epoch: 31 cost time: 3.3890483379364014
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.929 Vali Acc: 0.291 Test Loss: 3.929 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.9774463176727295
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.964 Vali Acc: 0.289 Test Loss: 3.964 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.368911027908325
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.966 Vali Acc: 0.295 Test Loss: 3.966 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.3473362922668457
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.983 Vali Acc: 0.300 Test Loss: 3.983 Test Acc: 0.300
Validation loss decreased (-0.298785 --> -0.299960).  Saving model ...
Epoch: 35 cost time: 3.406740427017212
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.004 Vali Acc: 0.300 Test Loss: 4.004 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.6456754207611084
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.043 Vali Acc: 0.299 Test Loss: 4.043 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.648812770843506
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.053 Vali Acc: 0.300 Test Loss: 4.053 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.28568172454834
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.066 Vali Acc: 0.299 Test Loss: 4.066 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.8803658485412598
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.079 Vali Acc: 0.298 Test Loss: 4.079 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.357987880706787
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.097 Vali Acc: 0.298 Test Loss: 4.097 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.1325459480285645
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.103 Vali Acc: 0.301 Test Loss: 4.103 Test Acc: 0.301
Validation loss decreased (-0.299960 --> -0.301135).  Saving model ...
Epoch: 42 cost time: 3.300420045852661
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.114 Vali Acc: 0.304 Test Loss: 4.114 Test Acc: 0.304
Validation loss decreased (-0.301135 --> -0.303488).  Saving model ...
Epoch: 43 cost time: 3.239179849624634
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.127 Vali Acc: 0.301 Test Loss: 4.127 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.820361375808716
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.141 Vali Acc: 0.299 Test Loss: 4.141 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.3558971881866455
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.150 Vali Acc: 0.300 Test Loss: 4.150 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.7886886596679688
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.152 Vali Acc: 0.302 Test Loss: 4.152 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.250369071960449
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.162 Vali Acc: 0.304 Test Loss: 4.162 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.0942749977111816
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.179 Vali Acc: 0.301 Test Loss: 4.179 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.2294762134552
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.186 Vali Acc: 0.299 Test Loss: 4.186 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.2734014987945557
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.196 Vali Acc: 0.300 Test Loss: 4.196 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.09883713722229
Epoch: 51, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.209 Vali Acc: 0.299 Test Loss: 4.209 Test Acc: 0.299
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.0819408893585205
Epoch: 52, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.215 Vali Acc: 0.302 Test Loss: 4.215 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 365914
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.951211214065552
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.337 Vali Acc: 0.035 Test Loss: 3.337 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 3.294405460357666
Epoch: 2, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.313 Vali Acc: 0.053 Test Loss: 3.313 Test Acc: 0.053
Validation loss decreased (-0.035261 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 2.8571736812591553
Epoch: 3, Steps: 10 | Train Loss: 2.979 Vali Loss: 3.311 Vali Acc: 0.073 Test Loss: 3.311 Test Acc: 0.073
Validation loss decreased (-0.052908 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 2.9869673252105713
Epoch: 4, Steps: 10 | Train Loss: 2.737 Vali Loss: 3.302 Vali Acc: 0.089 Test Loss: 3.302 Test Acc: 0.089
Validation loss decreased (-0.072908 --> -0.089379).  Saving model ...
Epoch: 5 cost time: 3.0632152557373047
Epoch: 5, Steps: 10 | Train Loss: 2.510 Vali Loss: 3.285 Vali Acc: 0.118 Test Loss: 3.285 Test Acc: 0.118
Validation loss decreased (-0.089379 --> -0.117614).  Saving model ...
Epoch: 6 cost time: 2.875770092010498
Epoch: 6, Steps: 10 | Train Loss: 2.281 Vali Loss: 3.271 Vali Acc: 0.135 Test Loss: 3.271 Test Acc: 0.135
Validation loss decreased (-0.117614 --> -0.135261).  Saving model ...
Epoch: 7 cost time: 3.326747417449951
Epoch: 7, Steps: 10 | Train Loss: 2.022 Vali Loss: 3.272 Vali Acc: 0.133 Test Loss: 3.272 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0484964847564697
Epoch: 8, Steps: 10 | Train Loss: 1.756 Vali Loss: 3.279 Vali Acc: 0.152 Test Loss: 3.279 Test Acc: 0.152
Validation loss decreased (-0.135261 --> -0.151732).  Saving model ...
Epoch: 9 cost time: 3.308616876602173
Epoch: 9, Steps: 10 | Train Loss: 1.522 Vali Loss: 3.313 Vali Acc: 0.167 Test Loss: 3.313 Test Acc: 0.167
Validation loss decreased (-0.151732 --> -0.167026).  Saving model ...
Epoch: 10 cost time: 3.323873519897461
Epoch: 10, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.357 Vali Acc: 0.171 Test Loss: 3.357 Test Acc: 0.171
Validation loss decreased (-0.167026 --> -0.170555).  Saving model ...
Epoch: 11 cost time: 3.2180418968200684
Epoch: 11, Steps: 10 | Train Loss: 1.105 Vali Loss: 3.409 Vali Acc: 0.179 Test Loss: 3.409 Test Acc: 0.179
Validation loss decreased (-0.170555 --> -0.178789).  Saving model ...
Epoch: 12 cost time: 3.279451847076416
Epoch: 12, Steps: 10 | Train Loss: 0.881 Vali Loss: 3.462 Vali Acc: 0.179 Test Loss: 3.462 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.478358030319214
Epoch: 13, Steps: 10 | Train Loss: 0.746 Vali Loss: 3.499 Vali Acc: 0.202 Test Loss: 3.499 Test Acc: 0.202
Validation loss decreased (-0.178789 --> -0.202318).  Saving model ...
Epoch: 14 cost time: 3.471090316772461
Epoch: 14, Steps: 10 | Train Loss: 0.588 Vali Loss: 3.599 Vali Acc: 0.205 Test Loss: 3.599 Test Acc: 0.205
Validation loss decreased (-0.202318 --> -0.204670).  Saving model ...
Epoch: 15 cost time: 3.4108431339263916
Epoch: 15, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.647 Vali Acc: 0.207 Test Loss: 3.647 Test Acc: 0.207
Validation loss decreased (-0.204670 --> -0.207022).  Saving model ...
Epoch: 16 cost time: 3.0763790607452393
Epoch: 16, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.720 Vali Acc: 0.226 Test Loss: 3.720 Test Acc: 0.226
Validation loss decreased (-0.207022 --> -0.225845).  Saving model ...
Epoch: 17 cost time: 3.3321635723114014
Epoch: 17, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.785 Vali Acc: 0.231 Test Loss: 3.785 Test Acc: 0.231
Validation loss decreased (-0.225845 --> -0.230550).  Saving model ...
Epoch: 18 cost time: 3.5482451915740967
Epoch: 18, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.901 Vali Acc: 0.220 Test Loss: 3.901 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0491342544555664
Epoch: 19, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.926 Vali Acc: 0.235 Test Loss: 3.926 Test Acc: 0.235
Validation loss decreased (-0.230550 --> -0.235255).  Saving model ...
Epoch: 20 cost time: 3.6174404621124268
Epoch: 20, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.003 Vali Acc: 0.233 Test Loss: 4.003 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.448931932449341
Epoch: 21, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.083 Vali Acc: 0.232 Test Loss: 4.083 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.6070287227630615
Epoch: 22, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.085 Vali Acc: 0.241 Test Loss: 4.085 Test Acc: 0.241
Validation loss decreased (-0.235255 --> -0.241136).  Saving model ...
Epoch: 23 cost time: 2.86641788482666
Epoch: 23, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.152 Vali Acc: 0.229 Test Loss: 4.152 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.8730952739715576
Epoch: 24, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.194 Vali Acc: 0.235 Test Loss: 4.194 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.475206136703491
Epoch: 25, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.199 Vali Acc: 0.239 Test Loss: 4.199 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.9918553829193115
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.250 Vali Acc: 0.245 Test Loss: 4.250 Test Acc: 0.245
Validation loss decreased (-0.241136 --> -0.244663).  Saving model ...
Epoch: 27 cost time: 2.930255889892578
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.301 Vali Acc: 0.239 Test Loss: 4.301 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.413508176803589
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.313 Vali Acc: 0.248 Test Loss: 4.313 Test Acc: 0.248
Validation loss decreased (-0.244663 --> -0.248192).  Saving model ...
Epoch: 29 cost time: 3.720959424972534
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.307 Vali Acc: 0.246 Test Loss: 4.307 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.0171730518341064
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.335 Vali Acc: 0.252 Test Loss: 4.335 Test Acc: 0.252
Validation loss decreased (-0.248192 --> -0.251721).  Saving model ...
Epoch: 31 cost time: 3.3205137252807617
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.379 Vali Acc: 0.249 Test Loss: 4.379 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3868088722229004
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.403 Vali Acc: 0.245 Test Loss: 4.403 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.7057478427886963
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.377 Vali Acc: 0.248 Test Loss: 4.377 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.246581792831421
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.417 Vali Acc: 0.251 Test Loss: 4.417 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.1743361949920654
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.451 Vali Acc: 0.248 Test Loss: 4.451 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.64788818359375
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.487 Vali Acc: 0.246 Test Loss: 4.487 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.6847875118255615
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.496 Vali Acc: 0.251 Test Loss: 4.496 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.238912343978882
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.529 Vali Acc: 0.252 Test Loss: 4.529 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.3269312381744385
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.560 Vali Acc: 0.244 Test Loss: 4.560 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.5924346446990967
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.568 Vali Acc: 0.246 Test Loss: 4.568 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 365914
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.14506196975708
Epoch: 1, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.341 Vali Acc: 0.033 Test Loss: 3.341 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 3.126112937927246
Epoch: 2, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.337 Vali Acc: 0.036 Test Loss: 3.337 Test Acc: 0.036
Validation loss decreased (-0.032908 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 3.376986503601074
Epoch: 3, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.353 Vali Acc: 0.039 Test Loss: 3.353 Test Acc: 0.039
Validation loss decreased (-0.036437 --> -0.038790).  Saving model ...
Epoch: 4 cost time: 3.6518921852111816
Epoch: 4, Steps: 10 | Train Loss: 2.838 Vali Loss: 3.364 Vali Acc: 0.044 Test Loss: 3.364 Test Acc: 0.044
Validation loss decreased (-0.038790 --> -0.043496).  Saving model ...
Epoch: 5 cost time: 3.3108460903167725
Epoch: 5, Steps: 10 | Train Loss: 2.637 Vali Loss: 3.358 Vali Acc: 0.048 Test Loss: 3.358 Test Acc: 0.048
Validation loss decreased (-0.043496 --> -0.048202).  Saving model ...
Epoch: 6 cost time: 3.435135841369629
Epoch: 6, Steps: 10 | Train Loss: 2.434 Vali Loss: 3.352 Vali Acc: 0.066 Test Loss: 3.352 Test Acc: 0.066
Validation loss decreased (-0.048202 --> -0.065849).  Saving model ...
Epoch: 7 cost time: 3.608114719390869
Epoch: 7, Steps: 10 | Train Loss: 2.204 Vali Loss: 3.358 Vali Acc: 0.079 Test Loss: 3.358 Test Acc: 0.079
Validation loss decreased (-0.065849 --> -0.078790).  Saving model ...
Epoch: 8 cost time: 3.0874807834625244
Epoch: 8, Steps: 10 | Train Loss: 1.936 Vali Loss: 3.368 Vali Acc: 0.085 Test Loss: 3.368 Test Acc: 0.085
Validation loss decreased (-0.078790 --> -0.084672).  Saving model ...
Epoch: 9 cost time: 3.1591908931732178
Epoch: 9, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.389 Vali Acc: 0.094 Test Loss: 3.389 Test Acc: 0.094
Validation loss decreased (-0.084672 --> -0.094084).  Saving model ...
Epoch: 10 cost time: 3.8357155323028564
Epoch: 10, Steps: 10 | Train Loss: 1.471 Vali Loss: 3.433 Vali Acc: 0.091 Test Loss: 3.433 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4621129035949707
Epoch: 11, Steps: 10 | Train Loss: 1.194 Vali Loss: 3.496 Vali Acc: 0.095 Test Loss: 3.496 Test Acc: 0.095
Validation loss decreased (-0.094084 --> -0.095259).  Saving model ...
Epoch: 12 cost time: 3.0747711658477783
Epoch: 12, Steps: 10 | Train Loss: 0.936 Vali Loss: 3.586 Vali Acc: 0.114 Test Loss: 3.586 Test Acc: 0.114
Validation loss decreased (-0.095259 --> -0.114082).  Saving model ...
Epoch: 13 cost time: 3.296055316925049
Epoch: 13, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.651 Vali Acc: 0.111 Test Loss: 3.651 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8481569290161133
Epoch: 14, Steps: 10 | Train Loss: 0.549 Vali Loss: 3.738 Vali Acc: 0.118 Test Loss: 3.738 Test Acc: 0.118
Validation loss decreased (-0.114082 --> -0.117610).  Saving model ...
Epoch: 15 cost time: 3.8357272148132324
Epoch: 15, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.860 Vali Acc: 0.118 Test Loss: 3.860 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.568932294845581
Epoch: 16, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.936 Vali Acc: 0.122 Test Loss: 3.936 Test Acc: 0.122
Validation loss decreased (-0.117610 --> -0.122314).  Saving model ...
Epoch: 17 cost time: 3.1322622299194336
Epoch: 17, Steps: 10 | Train Loss: 0.236 Vali Loss: 4.028 Vali Acc: 0.124 Test Loss: 4.028 Test Acc: 0.124
Validation loss decreased (-0.122314 --> -0.123489).  Saving model ...
Epoch: 18 cost time: 3.462136745452881
Epoch: 18, Steps: 10 | Train Loss: 0.167 Vali Loss: 4.157 Vali Acc: 0.124 Test Loss: 4.157 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3033432960510254
Epoch: 19, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.206 Vali Acc: 0.131 Test Loss: 4.206 Test Acc: 0.131
Validation loss decreased (-0.123489 --> -0.130546).  Saving model ...
Epoch: 20 cost time: 3.3343098163604736
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.275 Vali Acc: 0.132 Test Loss: 4.275 Test Acc: 0.132
Validation loss decreased (-0.130546 --> -0.131722).  Saving model ...
Epoch: 21 cost time: 3.310919761657715
Epoch: 21, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.340 Vali Acc: 0.131 Test Loss: 4.340 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3662614822387695
Epoch: 22, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.346 Vali Acc: 0.134 Test Loss: 4.346 Test Acc: 0.134
Validation loss decreased (-0.131722 --> -0.134074).  Saving model ...
Epoch: 23 cost time: 3.036816120147705
Epoch: 23, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.356 Vali Acc: 0.141 Test Loss: 4.356 Test Acc: 0.141
Validation loss decreased (-0.134074 --> -0.141133).  Saving model ...
Epoch: 24 cost time: 3.247196912765503
Epoch: 24, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.406 Vali Acc: 0.140 Test Loss: 4.406 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.136186361312866
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.455 Vali Acc: 0.140 Test Loss: 4.455 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.0401694774627686
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.500 Vali Acc: 0.135 Test Loss: 4.500 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.6486599445343018
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.509 Vali Acc: 0.140 Test Loss: 4.509 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.1018223762512207
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.529 Vali Acc: 0.145 Test Loss: 4.529 Test Acc: 0.145
Validation loss decreased (-0.141133 --> -0.144661).  Saving model ...
Epoch: 29 cost time: 3.09248948097229
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.545 Vali Acc: 0.142 Test Loss: 4.545 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5128302574157715
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.578 Vali Acc: 0.145 Test Loss: 4.578 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.696136474609375
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.608 Vali Acc: 0.141 Test Loss: 4.608 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.122547149658203
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.627 Vali Acc: 0.146 Test Loss: 4.627 Test Acc: 0.146
Validation loss decreased (-0.144661 --> -0.145836).  Saving model ...
Epoch: 33 cost time: 2.913670778274536
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.635 Vali Acc: 0.144 Test Loss: 4.635 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.6323676109313965
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.665 Vali Acc: 0.144 Test Loss: 4.665 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.955932140350342
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.686 Vali Acc: 0.146 Test Loss: 4.686 Test Acc: 0.146
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.98555326461792
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.707 Vali Acc: 0.141 Test Loss: 4.707 Test Acc: 0.141
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.567321538925171
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.719 Vali Acc: 0.144 Test Loss: 4.719 Test Acc: 0.144
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.85624361038208
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.738 Vali Acc: 0.145 Test Loss: 4.738 Test Acc: 0.145
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.225215435028076
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.761 Vali Acc: 0.147 Test Loss: 4.761 Test Acc: 0.147
Validation loss decreased (-0.145836 --> -0.147011).  Saving model ...
Epoch: 40 cost time: 3.1055240631103516
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.778 Vali Acc: 0.149 Test Loss: 4.778 Test Acc: 0.149
Validation loss decreased (-0.147011 --> -0.149364).  Saving model ...
Epoch: 41 cost time: 3.5817389488220215
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.788 Vali Acc: 0.149 Test Loss: 4.788 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.16874098777771
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.804 Vali Acc: 0.148 Test Loss: 4.804 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.212099075317383
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.828 Vali Acc: 0.149 Test Loss: 4.828 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.4002676010131836
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.840 Vali Acc: 0.146 Test Loss: 4.840 Test Acc: 0.146
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.4983201026916504
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.849 Vali Acc: 0.154 Test Loss: 4.849 Test Acc: 0.154
Validation loss decreased (-0.149364 --> -0.154069).  Saving model ...
Epoch: 46 cost time: 3.3170688152313232
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.869 Vali Acc: 0.152 Test Loss: 4.869 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.301847457885742
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.883 Vali Acc: 0.153 Test Loss: 4.883 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.5447463989257812
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.897 Vali Acc: 0.152 Test Loss: 4.897 Test Acc: 0.152
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.759243965148926
Epoch: 49, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.906 Vali Acc: 0.153 Test Loss: 4.906 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.9408841133117676
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.915 Vali Acc: 0.156 Test Loss: 4.915 Test Acc: 0.156
Validation loss decreased (-0.154069 --> -0.156421).  Saving model ...
Epoch: 51 cost time: 3.6774630546569824
Epoch: 51, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.929 Vali Acc: 0.158 Test Loss: 4.929 Test Acc: 0.158
Validation loss decreased (-0.156421 --> -0.157598).  Saving model ...
Epoch: 52 cost time: 3.1547913551330566
Epoch: 52, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.937 Vali Acc: 0.154 Test Loss: 4.937 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.353732109069824
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.943 Vali Acc: 0.154 Test Loss: 4.943 Test Acc: 0.154
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.6343257427215576
Epoch: 54, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.949 Vali Acc: 0.158 Test Loss: 4.949 Test Acc: 0.158
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.555986166000366
Epoch: 55, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.964 Vali Acc: 0.158 Test Loss: 4.964 Test Acc: 0.158
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.1525347232818604
Epoch: 56, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.978 Vali Acc: 0.156 Test Loss: 4.978 Test Acc: 0.156
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.0733859539031982
Epoch: 57, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.991 Vali Acc: 0.155 Test Loss: 4.991 Test Acc: 0.155
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.563312292098999
Epoch: 58, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.006 Vali Acc: 0.156 Test Loss: 5.006 Test Acc: 0.156
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.226407289505005
Epoch: 59, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.025 Vali Acc: 0.158 Test Loss: 5.025 Test Acc: 0.158
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 3.3663034439086914
Epoch: 60, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.037 Vali Acc: 0.154 Test Loss: 5.037 Test Acc: 0.154
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.869558811187744
Epoch: 61, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.041 Vali Acc: 0.155 Test Loss: 5.041 Test Acc: 0.155
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15764705882352942
model parameter : 365914
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.2012269496917725
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.325 Vali Acc: 0.045 Test Loss: 3.325 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 3.3971385955810547
Epoch: 2, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.320 Vali Acc: 0.036 Test Loss: 3.320 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.278869867324829
Epoch: 3, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.343 Vali Acc: 0.044 Test Loss: 3.343 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2294881343841553
Epoch: 4, Steps: 10 | Train Loss: 2.975 Vali Loss: 3.365 Vali Acc: 0.053 Test Loss: 3.365 Test Acc: 0.053
Validation loss decreased (-0.044673 --> -0.052908).  Saving model ...
Epoch: 5 cost time: 2.847891330718994
Epoch: 5, Steps: 10 | Train Loss: 2.818 Vali Loss: 3.369 Vali Acc: 0.053 Test Loss: 3.369 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.999782085418701
Epoch: 6, Steps: 10 | Train Loss: 2.678 Vali Loss: 3.366 Vali Acc: 0.053 Test Loss: 3.366 Test Acc: 0.053
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0427496433258057
Epoch: 7, Steps: 10 | Train Loss: 2.456 Vali Loss: 3.371 Vali Acc: 0.053 Test Loss: 3.371 Test Acc: 0.053
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.040358543395996
Epoch: 8, Steps: 10 | Train Loss: 2.301 Vali Loss: 3.372 Vali Acc: 0.061 Test Loss: 3.372 Test Acc: 0.061
Validation loss decreased (-0.052908 --> -0.061143).  Saving model ...
Epoch: 9 cost time: 3.111788034439087
Epoch: 9, Steps: 10 | Train Loss: 2.051 Vali Loss: 3.382 Vali Acc: 0.072 Test Loss: 3.382 Test Acc: 0.072
Validation loss decreased (-0.061143 --> -0.071731).  Saving model ...
Epoch: 10 cost time: 2.89151930809021
Epoch: 10, Steps: 10 | Train Loss: 1.856 Vali Loss: 3.406 Vali Acc: 0.072 Test Loss: 3.406 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.150496244430542
Epoch: 11, Steps: 10 | Train Loss: 1.588 Vali Loss: 3.437 Vali Acc: 0.075 Test Loss: 3.437 Test Acc: 0.075
Validation loss decreased (-0.071731 --> -0.075260).  Saving model ...
Epoch: 12 cost time: 3.5875115394592285
Epoch: 12, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.504 Vali Acc: 0.073 Test Loss: 3.504 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0929229259490967
Epoch: 13, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.555 Vali Acc: 0.085 Test Loss: 3.555 Test Acc: 0.085
Validation loss decreased (-0.075260 --> -0.084670).  Saving model ...
Epoch: 14 cost time: 2.6966347694396973
Epoch: 14, Steps: 10 | Train Loss: 0.945 Vali Loss: 3.621 Vali Acc: 0.088 Test Loss: 3.621 Test Acc: 0.088
Validation loss decreased (-0.084670 --> -0.088199).  Saving model ...
Epoch: 15 cost time: 3.3152668476104736
Epoch: 15, Steps: 10 | Train Loss: 0.740 Vali Loss: 3.670 Vali Acc: 0.089 Test Loss: 3.670 Test Acc: 0.089
Validation loss decreased (-0.088199 --> -0.089375).  Saving model ...
Epoch: 16 cost time: 3.065114736557007
Epoch: 16, Steps: 10 | Train Loss: 0.567 Vali Loss: 3.763 Vali Acc: 0.093 Test Loss: 3.763 Test Acc: 0.093
Validation loss decreased (-0.089375 --> -0.092904).  Saving model ...
Epoch: 17 cost time: 3.1384904384613037
Epoch: 17, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.820 Vali Acc: 0.104 Test Loss: 3.820 Test Acc: 0.104
Validation loss decreased (-0.092904 --> -0.103491).  Saving model ...
Epoch: 18 cost time: 3.401761531829834
Epoch: 18, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.978 Vali Acc: 0.094 Test Loss: 3.978 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.145629644393921
Epoch: 19, Steps: 10 | Train Loss: 0.230 Vali Loss: 4.005 Vali Acc: 0.095 Test Loss: 4.005 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.093219518661499
Epoch: 20, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.088 Vali Acc: 0.093 Test Loss: 4.088 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.249720573425293
Epoch: 21, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.188 Vali Acc: 0.094 Test Loss: 4.188 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.167283296585083
Epoch: 22, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.220 Vali Acc: 0.095 Test Loss: 4.220 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.2136759757995605
Epoch: 23, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.277 Vali Acc: 0.096 Test Loss: 4.277 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.2864489555358887
Epoch: 24, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.328 Vali Acc: 0.098 Test Loss: 4.328 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.386612892150879
Epoch: 25, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.360 Vali Acc: 0.102 Test Loss: 4.360 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.125413179397583
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.390 Vali Acc: 0.096 Test Loss: 4.390 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.4524877071380615
Epoch: 27, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.426 Vali Acc: 0.098 Test Loss: 4.426 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.10352941176470588
model parameter : 365914
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.0715227127075195
Epoch: 1, Steps: 10 | Train Loss: 3.359 Vali Loss: 3.349 Vali Acc: 0.031 Test Loss: 3.349 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 3.2636072635650635
Epoch: 2, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.354 Vali Acc: 0.034 Test Loss: 3.354 Test Acc: 0.034
Validation loss decreased (-0.030555 --> -0.034084).  Saving model ...
Epoch: 3 cost time: 3.026766300201416
Epoch: 3, Steps: 10 | Train Loss: 3.172 Vali Loss: 3.377 Vali Acc: 0.038 Test Loss: 3.377 Test Acc: 0.038
Validation loss decreased (-0.034084 --> -0.037613).  Saving model ...
Epoch: 4 cost time: 3.1353533267974854
Epoch: 4, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.401 Vali Acc: 0.035 Test Loss: 3.401 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.286193609237671
Epoch: 5, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.415 Vali Acc: 0.038 Test Loss: 3.415 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.072371006011963
Epoch: 6, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.421 Vali Acc: 0.041 Test Loss: 3.421 Test Acc: 0.041
Validation loss decreased (-0.037613 --> -0.041142).  Saving model ...
Epoch: 7 cost time: 2.788909912109375
Epoch: 7, Steps: 10 | Train Loss: 2.691 Vali Loss: 3.420 Vali Acc: 0.039 Test Loss: 3.420 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.256561756134033
Epoch: 8, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.414 Vali Acc: 0.046 Test Loss: 3.414 Test Acc: 0.046
Validation loss decreased (-0.041142 --> -0.045848).  Saving model ...
Epoch: 9 cost time: 3.1440539360046387
Epoch: 9, Steps: 10 | Train Loss: 2.428 Vali Loss: 3.414 Vali Acc: 0.049 Test Loss: 3.414 Test Acc: 0.049
Validation loss decreased (-0.045848 --> -0.049378).  Saving model ...
Epoch: 10 cost time: 3.534111261367798
Epoch: 10, Steps: 10 | Train Loss: 2.272 Vali Loss: 3.414 Vali Acc: 0.054 Test Loss: 3.414 Test Acc: 0.054
Validation loss decreased (-0.049378 --> -0.054084).  Saving model ...
Epoch: 11 cost time: 3.266542911529541
Epoch: 11, Steps: 10 | Train Loss: 2.074 Vali Loss: 3.410 Vali Acc: 0.064 Test Loss: 3.410 Test Acc: 0.064
Validation loss decreased (-0.054084 --> -0.063495).  Saving model ...
Epoch: 12 cost time: 3.023860216140747
Epoch: 12, Steps: 10 | Train Loss: 1.881 Vali Loss: 3.447 Vali Acc: 0.059 Test Loss: 3.447 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.262228488922119
Epoch: 13, Steps: 10 | Train Loss: 1.704 Vali Loss: 3.464 Vali Acc: 0.067 Test Loss: 3.464 Test Acc: 0.067
Validation loss decreased (-0.063495 --> -0.067024).  Saving model ...
Epoch: 14 cost time: 3.5638480186462402
Epoch: 14, Steps: 10 | Train Loss: 1.462 Vali Loss: 3.489 Vali Acc: 0.071 Test Loss: 3.489 Test Acc: 0.071
Validation loss decreased (-0.067024 --> -0.070553).  Saving model ...
Epoch: 15 cost time: 3.1319580078125
Epoch: 15, Steps: 10 | Train Loss: 1.250 Vali Loss: 3.514 Vali Acc: 0.069 Test Loss: 3.514 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.26684308052063
Epoch: 16, Steps: 10 | Train Loss: 1.048 Vali Loss: 3.572 Vali Acc: 0.074 Test Loss: 3.572 Test Acc: 0.074
Validation loss decreased (-0.070553 --> -0.074082).  Saving model ...
Epoch: 17 cost time: 3.151151180267334
Epoch: 17, Steps: 10 | Train Loss: 0.892 Vali Loss: 3.617 Vali Acc: 0.081 Test Loss: 3.617 Test Acc: 0.081
Validation loss decreased (-0.074082 --> -0.081140).  Saving model ...
Epoch: 18 cost time: 3.369107246398926
Epoch: 18, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.690 Vali Acc: 0.085 Test Loss: 3.690 Test Acc: 0.085
Validation loss decreased (-0.081140 --> -0.084669).  Saving model ...
Epoch: 19 cost time: 3.0988967418670654
Epoch: 19, Steps: 10 | Train Loss: 0.584 Vali Loss: 3.762 Vali Acc: 0.087 Test Loss: 3.762 Test Acc: 0.087
Validation loss decreased (-0.084669 --> -0.087021).  Saving model ...
Epoch: 20 cost time: 3.3372907638549805
Epoch: 20, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.873 Vali Acc: 0.082 Test Loss: 3.873 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6447489261627197
Epoch: 21, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.975 Vali Acc: 0.085 Test Loss: 3.975 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3148624897003174
Epoch: 22, Steps: 10 | Train Loss: 0.255 Vali Loss: 4.046 Vali Acc: 0.085 Test Loss: 4.046 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.583263874053955
Epoch: 23, Steps: 10 | Train Loss: 0.190 Vali Loss: 4.128 Vali Acc: 0.086 Test Loss: 4.128 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.1435928344726562
Epoch: 24, Steps: 10 | Train Loss: 0.152 Vali Loss: 4.194 Vali Acc: 0.089 Test Loss: 4.194 Test Acc: 0.089
Validation loss decreased (-0.087021 --> -0.089370).  Saving model ...
Epoch: 25 cost time: 3.7387561798095703
Epoch: 25, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.266 Vali Acc: 0.092 Test Loss: 4.266 Test Acc: 0.092
Validation loss decreased (-0.089370 --> -0.091722).  Saving model ...
Epoch: 26 cost time: 3.4005496501922607
Epoch: 26, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.329 Vali Acc: 0.094 Test Loss: 4.329 Test Acc: 0.094
Validation loss decreased (-0.091722 --> -0.094074).  Saving model ...
Epoch: 27 cost time: 3.65443754196167
Epoch: 27, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.332 Vali Acc: 0.092 Test Loss: 4.332 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.544130563735962
Epoch: 28, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.371 Vali Acc: 0.099 Test Loss: 4.371 Test Acc: 0.099
Validation loss decreased (-0.094074 --> -0.098780).  Saving model ...
Epoch: 29 cost time: 3.244947671890259
Epoch: 29, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.398 Vali Acc: 0.099 Test Loss: 4.398 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.765050172805786
Epoch: 30, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.453 Vali Acc: 0.094 Test Loss: 4.453 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.0941572189331055
Epoch: 31, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.520 Vali Acc: 0.095 Test Loss: 4.520 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.5479836463928223
Epoch: 32, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.549 Vali Acc: 0.099 Test Loss: 4.549 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.5062193870544434
Epoch: 33, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.539 Vali Acc: 0.105 Test Loss: 4.539 Test Acc: 0.105
Validation loss decreased (-0.098780 --> -0.104660).  Saving model ...
Epoch: 34 cost time: 3.80199933052063
Epoch: 34, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.569 Vali Acc: 0.101 Test Loss: 4.569 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.5589027404785156
Epoch: 35, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.601 Vali Acc: 0.102 Test Loss: 4.601 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.319681406021118
Epoch: 36, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.653 Vali Acc: 0.098 Test Loss: 4.653 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.729783535003662
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.669 Vali Acc: 0.104 Test Loss: 4.669 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.391075372695923
Epoch: 38, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.672 Vali Acc: 0.104 Test Loss: 4.672 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.795212507247925
Epoch: 39, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.660 Vali Acc: 0.107 Test Loss: 4.660 Test Acc: 0.107
Validation loss decreased (-0.104660 --> -0.107012).  Saving model ...
Epoch: 40 cost time: 3.405419111251831
Epoch: 40, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.674 Vali Acc: 0.109 Test Loss: 4.674 Test Acc: 0.109
Validation loss decreased (-0.107012 --> -0.109365).  Saving model ...
Epoch: 41 cost time: 4.166579246520996
Epoch: 41, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.693 Vali Acc: 0.109 Test Loss: 4.693 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.373290538787842
Epoch: 42, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.715 Vali Acc: 0.109 Test Loss: 4.715 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.583111047744751
Epoch: 43, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.750 Vali Acc: 0.104 Test Loss: 4.750 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.892385959625244
Epoch: 44, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.778 Vali Acc: 0.104 Test Loss: 4.778 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.4742228984832764
Epoch: 45, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.793 Vali Acc: 0.105 Test Loss: 4.793 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.689249277114868
Epoch: 46, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.811 Vali Acc: 0.100 Test Loss: 4.811 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.383772134780884
Epoch: 47, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.829 Vali Acc: 0.106 Test Loss: 4.829 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.765349864959717
Epoch: 48, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.838 Vali Acc: 0.108 Test Loss: 4.838 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.0150816440582275
Epoch: 49, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.861 Vali Acc: 0.105 Test Loss: 4.861 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.458228826522827
Epoch: 50, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.875 Vali Acc: 0.104 Test Loss: 4.875 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.10941176470588235
model parameter : 365914
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.563299179077148
Epoch: 1, Steps: 10 | Train Loss: 3.358 Vali Loss: 3.337 Vali Acc: 0.035 Test Loss: 3.337 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 3.5148935317993164
Epoch: 2, Steps: 10 | Train Loss: 3.281 Vali Loss: 3.341 Vali Acc: 0.031 Test Loss: 3.341 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0643868446350098
Epoch: 3, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.361 Vali Acc: 0.029 Test Loss: 3.361 Test Acc: 0.029
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.901716709136963
Epoch: 4, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.386 Vali Acc: 0.028 Test Loss: 3.386 Test Acc: 0.028
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.847205638885498
Epoch: 5, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.402 Vali Acc: 0.033 Test Loss: 3.402 Test Acc: 0.033
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.481882095336914
Epoch: 6, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.407 Vali Acc: 0.031 Test Loss: 3.407 Test Acc: 0.031
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.0444276332855225
Epoch: 7, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.403 Vali Acc: 0.041 Test Loss: 3.403 Test Acc: 0.041
Validation loss decreased (-0.035261 --> -0.041142).  Saving model ...
Epoch: 8 cost time: 3.576765775680542
Epoch: 8, Steps: 10 | Train Loss: 2.752 Vali Loss: 3.396 Vali Acc: 0.040 Test Loss: 3.396 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.867769241333008
Epoch: 9, Steps: 10 | Train Loss: 2.609 Vali Loss: 3.393 Vali Acc: 0.048 Test Loss: 3.393 Test Acc: 0.048
Validation loss decreased (-0.041142 --> -0.048201).  Saving model ...
Epoch: 10 cost time: 3.499009370803833
Epoch: 10, Steps: 10 | Train Loss: 2.529 Vali Loss: 3.386 Vali Acc: 0.059 Test Loss: 3.386 Test Acc: 0.059
Validation loss decreased (-0.048201 --> -0.058790).  Saving model ...
Epoch: 11 cost time: 2.786022424697876
Epoch: 11, Steps: 10 | Train Loss: 2.299 Vali Loss: 3.378 Vali Acc: 0.068 Test Loss: 3.378 Test Acc: 0.068
Validation loss decreased (-0.058790 --> -0.068202).  Saving model ...
Epoch: 12 cost time: 3.5957517623901367
Epoch: 12, Steps: 10 | Train Loss: 2.195 Vali Loss: 3.395 Vali Acc: 0.067 Test Loss: 3.395 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2768239974975586
Epoch: 13, Steps: 10 | Train Loss: 2.030 Vali Loss: 3.402 Vali Acc: 0.066 Test Loss: 3.402 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0860376358032227
Epoch: 14, Steps: 10 | Train Loss: 1.793 Vali Loss: 3.427 Vali Acc: 0.076 Test Loss: 3.427 Test Acc: 0.076
Validation loss decreased (-0.068202 --> -0.076436).  Saving model ...
Epoch: 15 cost time: 3.827770709991455
Epoch: 15, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.442 Vali Acc: 0.074 Test Loss: 3.442 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.572822093963623
Epoch: 16, Steps: 10 | Train Loss: 1.433 Vali Loss: 3.486 Vali Acc: 0.068 Test Loss: 3.486 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.668924331665039
Epoch: 17, Steps: 10 | Train Loss: 1.233 Vali Loss: 3.521 Vali Acc: 0.075 Test Loss: 3.521 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.290823459625244
Epoch: 18, Steps: 10 | Train Loss: 1.027 Vali Loss: 3.590 Vali Acc: 0.078 Test Loss: 3.590 Test Acc: 0.078
Validation loss decreased (-0.076436 --> -0.077611).  Saving model ...
Epoch: 19 cost time: 3.558500051498413
Epoch: 19, Steps: 10 | Train Loss: 0.856 Vali Loss: 3.642 Vali Acc: 0.075 Test Loss: 3.642 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.085904359817505
Epoch: 20, Steps: 10 | Train Loss: 0.713 Vali Loss: 3.735 Vali Acc: 0.078 Test Loss: 3.735 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6760237216949463
Epoch: 21, Steps: 10 | Train Loss: 0.556 Vali Loss: 3.832 Vali Acc: 0.071 Test Loss: 3.832 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.327741861343384
Epoch: 22, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.889 Vali Acc: 0.078 Test Loss: 3.889 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.448887586593628
Epoch: 23, Steps: 10 | Train Loss: 0.345 Vali Loss: 4.000 Vali Acc: 0.085 Test Loss: 4.000 Test Acc: 0.085
Validation loss decreased (-0.077611 --> -0.084666).  Saving model ...
Epoch: 24 cost time: 2.9960813522338867
Epoch: 24, Steps: 10 | Train Loss: 0.230 Vali Loss: 4.077 Vali Acc: 0.085 Test Loss: 4.077 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.2409749031066895
Epoch: 25, Steps: 10 | Train Loss: 0.197 Vali Loss: 4.136 Vali Acc: 0.092 Test Loss: 4.136 Test Acc: 0.092
Validation loss decreased (-0.084666 --> -0.091723).  Saving model ...
Epoch: 26 cost time: 3.380981206893921
Epoch: 26, Steps: 10 | Train Loss: 0.157 Vali Loss: 4.204 Vali Acc: 0.087 Test Loss: 4.204 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2437987327575684
Epoch: 27, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.259 Vali Acc: 0.096 Test Loss: 4.259 Test Acc: 0.096
Validation loss decreased (-0.091723 --> -0.096428).  Saving model ...
Epoch: 28 cost time: 3.710878849029541
Epoch: 28, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.342 Vali Acc: 0.096 Test Loss: 4.342 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2689857482910156
Epoch: 29, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.364 Vali Acc: 0.100 Test Loss: 4.364 Test Acc: 0.100
Validation loss decreased (-0.096428 --> -0.099956).  Saving model ...
Epoch: 30 cost time: 3.546466588973999
Epoch: 30, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.412 Vali Acc: 0.100 Test Loss: 4.412 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.2633731365203857
Epoch: 31, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.480 Vali Acc: 0.098 Test Loss: 4.480 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.7738287448883057
Epoch: 32, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.509 Vali Acc: 0.102 Test Loss: 4.509 Test Acc: 0.102
Validation loss decreased (-0.099956 --> -0.102308).  Saving model ...
Epoch: 33 cost time: 3.192305088043213
Epoch: 33, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.471 Vali Acc: 0.102 Test Loss: 4.471 Test Acc: 0.102
Validation loss decreased (-0.102308 --> -0.102308).  Saving model ...
Epoch: 34 cost time: 3.511810541152954
Epoch: 34, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.510 Vali Acc: 0.106 Test Loss: 4.510 Test Acc: 0.106
Validation loss decreased (-0.102308 --> -0.105837).  Saving model ...
Epoch: 35 cost time: 3.5011954307556152
Epoch: 35, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.562 Vali Acc: 0.101 Test Loss: 4.562 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.344991445541382
Epoch: 36, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.614 Vali Acc: 0.099 Test Loss: 4.614 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.5756237506866455
Epoch: 37, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.647 Vali Acc: 0.100 Test Loss: 4.647 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.5827815532684326
Epoch: 38, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.654 Vali Acc: 0.098 Test Loss: 4.654 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.5908496379852295
Epoch: 39, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.648 Vali Acc: 0.105 Test Loss: 4.648 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.9665744304656982
Epoch: 40, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.661 Vali Acc: 0.107 Test Loss: 4.661 Test Acc: 0.107
Validation loss decreased (-0.105837 --> -0.107012).  Saving model ...
Epoch: 41 cost time: 3.3774807453155518
Epoch: 41, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.677 Vali Acc: 0.106 Test Loss: 4.677 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.4090609550476074
Epoch: 42, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.699 Vali Acc: 0.107 Test Loss: 4.699 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.059020519256592
Epoch: 43, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.732 Vali Acc: 0.099 Test Loss: 4.732 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.8134379386901855
Epoch: 44, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.755 Vali Acc: 0.100 Test Loss: 4.755 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.0882315635681152
Epoch: 45, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.765 Vali Acc: 0.101 Test Loss: 4.765 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.448010206222534
Epoch: 46, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.773 Vali Acc: 0.101 Test Loss: 4.773 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.2571322917938232
Epoch: 47, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.785 Vali Acc: 0.104 Test Loss: 4.785 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.096721649169922
Epoch: 48, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.792 Vali Acc: 0.104 Test Loss: 4.792 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.3439950942993164
Epoch: 49, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.817 Vali Acc: 0.104 Test Loss: 4.817 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.1157732009887695
Epoch: 50, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.837 Vali Acc: 0.109 Test Loss: 4.837 Test Acc: 0.109
Validation loss decreased (-0.107012 --> -0.109363).  Saving model ...
Epoch: 51 cost time: 2.9884815216064453
Epoch: 51, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.882 Vali Acc: 0.102 Test Loss: 4.882 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.460754632949829
Epoch: 52, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.905 Vali Acc: 0.102 Test Loss: 4.905 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.350245475769043
Epoch: 53, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.906 Vali Acc: 0.099 Test Loss: 4.906 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.149919033050537
Epoch: 54, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.909 Vali Acc: 0.105 Test Loss: 4.909 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.1721105575561523
Epoch: 55, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.920 Vali Acc: 0.104 Test Loss: 4.920 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.5390100479125977
Epoch: 56, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.930 Vali Acc: 0.101 Test Loss: 4.930 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.4765567779541016
Epoch: 57, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.938 Vali Acc: 0.102 Test Loss: 4.938 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.9314463138580322
Epoch: 58, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.954 Vali Acc: 0.102 Test Loss: 4.954 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 3.3516013622283936
Epoch: 59, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.979 Vali Acc: 0.102 Test Loss: 4.979 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 3.17669415473938
Epoch: 60, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.992 Vali Acc: 0.102 Test Loss: 4.992 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.10941176470588235
model parameter : 365914
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.3686723709106445
Epoch: 1, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.314 Vali Acc: 0.038 Test Loss: 3.314 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 3.1848623752593994
Epoch: 2, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.307 Vali Acc: 0.045 Test Loss: 3.307 Test Acc: 0.045
Validation loss decreased (-0.037614 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 3.3548383712768555
Epoch: 3, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.320 Vali Acc: 0.049 Test Loss: 3.320 Test Acc: 0.049
Validation loss decreased (-0.044673 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 3.531869649887085
Epoch: 4, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.342 Vali Acc: 0.045 Test Loss: 3.342 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1738061904907227
Epoch: 5, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.363 Vali Acc: 0.054 Test Loss: 3.363 Test Acc: 0.054
Validation loss decreased (-0.049379 --> -0.054084).  Saving model ...
Epoch: 6 cost time: 2.811581611633301
Epoch: 6, Steps: 10 | Train Loss: 3.006 Vali Loss: 3.370 Vali Acc: 0.059 Test Loss: 3.370 Test Acc: 0.059
Validation loss decreased (-0.054084 --> -0.058790).  Saving model ...
Epoch: 7 cost time: 2.7867531776428223
Epoch: 7, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.373 Vali Acc: 0.053 Test Loss: 3.373 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.754246711730957
Epoch: 8, Steps: 10 | Train Loss: 2.842 Vali Loss: 3.359 Vali Acc: 0.060 Test Loss: 3.359 Test Acc: 0.060
Validation loss decreased (-0.058790 --> -0.059966).  Saving model ...
Epoch: 9 cost time: 2.671133041381836
Epoch: 9, Steps: 10 | Train Loss: 2.767 Vali Loss: 3.352 Vali Acc: 0.072 Test Loss: 3.352 Test Acc: 0.072
Validation loss decreased (-0.059966 --> -0.071731).  Saving model ...
Epoch: 10 cost time: 3.0056138038635254
Epoch: 10, Steps: 10 | Train Loss: 2.669 Vali Loss: 3.354 Vali Acc: 0.076 Test Loss: 3.354 Test Acc: 0.076
Validation loss decreased (-0.071731 --> -0.076437).  Saving model ...
Epoch: 11 cost time: 3.285202980041504
Epoch: 11, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.353 Vali Acc: 0.068 Test Loss: 3.353 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0785815715789795
Epoch: 12, Steps: 10 | Train Loss: 2.473 Vali Loss: 3.369 Vali Acc: 0.067 Test Loss: 3.369 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.034392833709717
Epoch: 13, Steps: 10 | Train Loss: 2.321 Vali Loss: 3.382 Vali Acc: 0.073 Test Loss: 3.382 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7575528621673584
Epoch: 14, Steps: 10 | Train Loss: 2.141 Vali Loss: 3.408 Vali Acc: 0.071 Test Loss: 3.408 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.992929220199585
Epoch: 15, Steps: 10 | Train Loss: 2.008 Vali Loss: 3.435 Vali Acc: 0.065 Test Loss: 3.435 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.0617451667785645
Epoch: 16, Steps: 10 | Train Loss: 1.883 Vali Loss: 3.484 Vali Acc: 0.065 Test Loss: 3.484 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.514320135116577
Epoch: 17, Steps: 10 | Train Loss: 1.601 Vali Loss: 3.527 Vali Acc: 0.062 Test Loss: 3.527 Test Acc: 0.062
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.262477397918701
Epoch: 18, Steps: 10 | Train Loss: 1.464 Vali Loss: 3.604 Vali Acc: 0.055 Test Loss: 3.604 Test Acc: 0.055
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.37027907371521
Epoch: 19, Steps: 10 | Train Loss: 1.222 Vali Loss: 3.662 Vali Acc: 0.059 Test Loss: 3.662 Test Acc: 0.059
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.1313443183898926
Epoch: 20, Steps: 10 | Train Loss: 1.098 Vali Loss: 3.739 Vali Acc: 0.056 Test Loss: 3.739 Test Acc: 0.056
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.07647058823529412
model parameter : 365914
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.270502328872681
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.044 Test Loss: 3.258 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 3.3569881916046143
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.044 Test Loss: 3.258 Test Acc: 0.044
Validation loss decreased (-0.043497 --> -0.043497).  Saving model ...
Epoch: 3 cost time: 3.247853994369507
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.044 Test Loss: 3.258 Test Acc: 0.044
Validation loss decreased (-0.043497 --> -0.043497).  Saving model ...
Epoch: 4 cost time: 3.2121264934539795
Epoch: 4, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.300823450088501
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1944563388824463
Epoch: 6, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2169032096862793
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.276484966278076
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2946534156799316
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.6181228160858154
Epoch: 10, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.963749408721924
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7890665531158447
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.111471652984619
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.04352941176470588
model parameter : 365914
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.658064126968384
Epoch: 1, Steps: 10 | Train Loss: 3.267 Vali Loss: 3.307 Vali Acc: 0.042 Test Loss: 3.307 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 3.209700345993042
Epoch: 2, Steps: 10 | Train Loss: 3.153 Vali Loss: 3.276 Vali Acc: 0.072 Test Loss: 3.276 Test Acc: 0.072
Validation loss decreased (-0.042320 --> -0.071732).  Saving model ...
Epoch: 3 cost time: 3.591329574584961
Epoch: 3, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.262 Vali Acc: 0.088 Test Loss: 3.262 Test Acc: 0.088
Validation loss decreased (-0.071732 --> -0.088203).  Saving model ...
Epoch: 4 cost time: 3.4801549911499023
Epoch: 4, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.229 Vali Acc: 0.127 Test Loss: 3.229 Test Acc: 0.127
Validation loss decreased (-0.088203 --> -0.127027).  Saving model ...
Epoch: 5 cost time: 3.1325128078460693
Epoch: 5, Steps: 10 | Train Loss: 2.496 Vali Loss: 3.194 Vali Acc: 0.133 Test Loss: 3.194 Test Acc: 0.133
Validation loss decreased (-0.127027 --> -0.132909).  Saving model ...
Epoch: 6 cost time: 3.194700241088867
Epoch: 6, Steps: 10 | Train Loss: 2.224 Vali Loss: 3.144 Vali Acc: 0.160 Test Loss: 3.144 Test Acc: 0.160
Validation loss decreased (-0.132909 --> -0.159969).  Saving model ...
Epoch: 7 cost time: 3.330125093460083
Epoch: 7, Steps: 10 | Train Loss: 1.950 Vali Loss: 3.120 Vali Acc: 0.185 Test Loss: 3.120 Test Acc: 0.185
Validation loss decreased (-0.159969 --> -0.184675).  Saving model ...
Epoch: 8 cost time: 3.479703187942505
Epoch: 8, Steps: 10 | Train Loss: 1.646 Vali Loss: 3.104 Vali Acc: 0.192 Test Loss: 3.104 Test Acc: 0.192
Validation loss decreased (-0.184675 --> -0.191734).  Saving model ...
Epoch: 9 cost time: 3.6062912940979004
Epoch: 9, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.109 Vali Acc: 0.205 Test Loss: 3.109 Test Acc: 0.205
Validation loss decreased (-0.191734 --> -0.204675).  Saving model ...
Epoch: 10 cost time: 3.1254420280456543
Epoch: 10, Steps: 10 | Train Loss: 1.130 Vali Loss: 3.124 Vali Acc: 0.219 Test Loss: 3.124 Test Acc: 0.219
Validation loss decreased (-0.204675 --> -0.218792).  Saving model ...
Epoch: 11 cost time: 2.916151285171509
Epoch: 11, Steps: 10 | Train Loss: 0.947 Vali Loss: 3.109 Vali Acc: 0.244 Test Loss: 3.109 Test Acc: 0.244
Validation loss decreased (-0.218792 --> -0.243498).  Saving model ...
Epoch: 12 cost time: 2.8739395141601562
Epoch: 12, Steps: 10 | Train Loss: 0.702 Vali Loss: 3.153 Vali Acc: 0.252 Test Loss: 3.153 Test Acc: 0.252
Validation loss decreased (-0.243498 --> -0.251733).  Saving model ...
Epoch: 13 cost time: 2.774399757385254
Epoch: 13, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.195 Vali Acc: 0.254 Test Loss: 3.195 Test Acc: 0.254
Validation loss decreased (-0.251733 --> -0.254086).  Saving model ...
Epoch: 14 cost time: 3.034005641937256
Epoch: 14, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.244 Vali Acc: 0.265 Test Loss: 3.244 Test Acc: 0.265
Validation loss decreased (-0.254086 --> -0.264673).  Saving model ...
Epoch: 15 cost time: 2.981367588043213
Epoch: 15, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.296 Vali Acc: 0.268 Test Loss: 3.296 Test Acc: 0.268
Validation loss decreased (-0.264673 --> -0.268202).  Saving model ...
Epoch: 16 cost time: 3.5949819087982178
Epoch: 16, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.334 Vali Acc: 0.282 Test Loss: 3.334 Test Acc: 0.282
Validation loss decreased (-0.268202 --> -0.282320).  Saving model ...
Epoch: 17 cost time: 3.278038263320923
Epoch: 17, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.423 Vali Acc: 0.275 Test Loss: 3.423 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7880396842956543
Epoch: 18, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.443 Vali Acc: 0.274 Test Loss: 3.443 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.956993341445923
Epoch: 19, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.493 Vali Acc: 0.287 Test Loss: 3.493 Test Acc: 0.287
Validation loss decreased (-0.282320 --> -0.287024).  Saving model ...
Epoch: 20 cost time: 3.0315489768981934
Epoch: 20, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.514 Vali Acc: 0.285 Test Loss: 3.514 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0749268531799316
Epoch: 21, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.529 Vali Acc: 0.286 Test Loss: 3.529 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.2949867248535156
Epoch: 22, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.574 Vali Acc: 0.285 Test Loss: 3.574 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9071238040924072
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.594 Vali Acc: 0.287 Test Loss: 3.594 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.029094696044922
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.642 Vali Acc: 0.287 Test Loss: 3.642 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.3236730098724365
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.664 Vali Acc: 0.286 Test Loss: 3.664 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.9241394996643066
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.674 Vali Acc: 0.294 Test Loss: 3.674 Test Acc: 0.294
Validation loss decreased (-0.287024 --> -0.294081).  Saving model ...
Epoch: 27 cost time: 3.3418519496917725
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.700 Vali Acc: 0.298 Test Loss: 3.700 Test Acc: 0.298
Validation loss decreased (-0.294081 --> -0.297610).  Saving model ...
Epoch: 28 cost time: 3.548362970352173
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.720 Vali Acc: 0.294 Test Loss: 3.720 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.5895328521728516
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.743 Vali Acc: 0.292 Test Loss: 3.743 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.9310569763183594
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.764 Vali Acc: 0.286 Test Loss: 3.764 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.1394457817077637
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.785 Vali Acc: 0.293 Test Loss: 3.785 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.2227437496185303
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.794 Vali Acc: 0.292 Test Loss: 3.794 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.1951162815093994
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.806 Vali Acc: 0.294 Test Loss: 3.806 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.2254278659820557
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.815 Vali Acc: 0.299 Test Loss: 3.815 Test Acc: 0.299
Validation loss decreased (-0.297610 --> -0.298785).  Saving model ...
Epoch: 35 cost time: 3.6444003582000732
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.827 Vali Acc: 0.298 Test Loss: 3.827 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.668436288833618
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.852 Vali Acc: 0.291 Test Loss: 3.852 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.916433811187744
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.869 Vali Acc: 0.292 Test Loss: 3.869 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.1116504669189453
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.884 Vali Acc: 0.294 Test Loss: 3.884 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.24410080909729
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.901 Vali Acc: 0.292 Test Loss: 3.901 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.0203359127044678
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.908 Vali Acc: 0.294 Test Loss: 3.908 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.241105079650879
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.918 Vali Acc: 0.295 Test Loss: 3.918 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.158090353012085
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.926 Vali Acc: 0.294 Test Loss: 3.926 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.453178644180298
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.938 Vali Acc: 0.294 Test Loss: 3.938 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.1835641860961914
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.953 Vali Acc: 0.293 Test Loss: 3.953 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 267610
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.257646083831787
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.343 Vali Acc: 0.033 Test Loss: 3.343 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 2.9655160903930664
Epoch: 2, Steps: 10 | Train Loss: 3.191 Vali Loss: 3.306 Vali Acc: 0.060 Test Loss: 3.306 Test Acc: 0.060
Validation loss decreased (-0.032908 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 3.4626338481903076
Epoch: 3, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.291 Vali Acc: 0.089 Test Loss: 3.291 Test Acc: 0.089
Validation loss decreased (-0.059967 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 3.552201271057129
Epoch: 4, Steps: 10 | Train Loss: 2.782 Vali Loss: 3.257 Vali Acc: 0.116 Test Loss: 3.257 Test Acc: 0.116
Validation loss decreased (-0.089379 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 3.073984384536743
Epoch: 5, Steps: 10 | Train Loss: 2.523 Vali Loss: 3.218 Vali Acc: 0.138 Test Loss: 3.218 Test Acc: 0.138
Validation loss decreased (-0.116438 --> -0.137615).  Saving model ...
Epoch: 6 cost time: 3.174393892288208
Epoch: 6, Steps: 10 | Train Loss: 2.261 Vali Loss: 3.166 Vali Acc: 0.162 Test Loss: 3.166 Test Acc: 0.162
Validation loss decreased (-0.137615 --> -0.162321).  Saving model ...
Epoch: 7 cost time: 3.253945827484131
Epoch: 7, Steps: 10 | Train Loss: 1.982 Vali Loss: 3.144 Vali Acc: 0.169 Test Loss: 3.144 Test Acc: 0.169
Validation loss decreased (-0.162321 --> -0.169380).  Saving model ...
Epoch: 8 cost time: 3.4417262077331543
Epoch: 8, Steps: 10 | Train Loss: 1.683 Vali Loss: 3.132 Vali Acc: 0.189 Test Loss: 3.132 Test Acc: 0.189
Validation loss decreased (-0.169380 --> -0.189380).  Saving model ...
Epoch: 9 cost time: 3.00359845161438
Epoch: 9, Steps: 10 | Train Loss: 1.442 Vali Loss: 3.134 Vali Acc: 0.199 Test Loss: 3.134 Test Acc: 0.199
Validation loss decreased (-0.189380 --> -0.198792).  Saving model ...
Epoch: 10 cost time: 3.067918062210083
Epoch: 10, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.150 Vali Acc: 0.226 Test Loss: 3.150 Test Acc: 0.226
Validation loss decreased (-0.198792 --> -0.225851).  Saving model ...
Epoch: 11 cost time: 3.472647190093994
Epoch: 11, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.133 Vali Acc: 0.264 Test Loss: 3.133 Test Acc: 0.264
Validation loss decreased (-0.225851 --> -0.263498).  Saving model ...
Epoch: 12 cost time: 3.11957049369812
Epoch: 12, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.180 Vali Acc: 0.255 Test Loss: 3.180 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.882277488708496
Epoch: 13, Steps: 10 | Train Loss: 0.588 Vali Loss: 3.219 Vali Acc: 0.261 Test Loss: 3.219 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3663065433502197
Epoch: 14, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.268 Vali Acc: 0.275 Test Loss: 3.268 Test Acc: 0.275
Validation loss decreased (-0.263498 --> -0.275261).  Saving model ...
Epoch: 15 cost time: 3.255113363265991
Epoch: 15, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.315 Vali Acc: 0.282 Test Loss: 3.315 Test Acc: 0.282
Validation loss decreased (-0.275261 --> -0.282320).  Saving model ...
Epoch: 16 cost time: 3.0440704822540283
Epoch: 16, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.374 Vali Acc: 0.288 Test Loss: 3.374 Test Acc: 0.288
Validation loss decreased (-0.282320 --> -0.288202).  Saving model ...
Epoch: 17 cost time: 3.1705434322357178
Epoch: 17, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.469 Vali Acc: 0.278 Test Loss: 3.469 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3371505737304688
Epoch: 18, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.481 Vali Acc: 0.292 Test Loss: 3.481 Test Acc: 0.292
Validation loss decreased (-0.288202 --> -0.291730).  Saving model ...
Epoch: 19 cost time: 3.361482620239258
Epoch: 19, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.523 Vali Acc: 0.294 Test Loss: 3.523 Test Acc: 0.294
Validation loss decreased (-0.291730 --> -0.294082).  Saving model ...
Epoch: 20 cost time: 3.40415096282959
Epoch: 20, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.579 Vali Acc: 0.289 Test Loss: 3.579 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0114200115203857
Epoch: 21, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.602 Vali Acc: 0.293 Test Loss: 3.602 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.5028626918792725
Epoch: 22, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.641 Vali Acc: 0.294 Test Loss: 3.641 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.2717666625976562
Epoch: 23, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.656 Vali Acc: 0.304 Test Loss: 3.656 Test Acc: 0.304
Validation loss decreased (-0.294082 --> -0.303493).  Saving model ...
Epoch: 24 cost time: 3.550551414489746
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.687 Vali Acc: 0.304 Test Loss: 3.687 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5902063846588135
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.704 Vali Acc: 0.302 Test Loss: 3.704 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.5307769775390625
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.721 Vali Acc: 0.305 Test Loss: 3.721 Test Acc: 0.305
Validation loss decreased (-0.303493 --> -0.304669).  Saving model ...
Epoch: 27 cost time: 3.2893283367156982
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.750 Vali Acc: 0.309 Test Loss: 3.750 Test Acc: 0.309
Validation loss decreased (-0.304669 --> -0.309374).  Saving model ...
Epoch: 28 cost time: 3.195223569869995
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.779 Vali Acc: 0.304 Test Loss: 3.779 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.5614511966705322
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.808 Vali Acc: 0.305 Test Loss: 3.808 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.9785947799682617
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.825 Vali Acc: 0.300 Test Loss: 3.825 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.9149303436279297
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.846 Vali Acc: 0.296 Test Loss: 3.846 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.2605888843536377
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.856 Vali Acc: 0.298 Test Loss: 3.856 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.464475393295288
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.866 Vali Acc: 0.301 Test Loss: 3.866 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.0448949337005615
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.873 Vali Acc: 0.307 Test Loss: 3.873 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.461120367050171
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.884 Vali Acc: 0.309 Test Loss: 3.884 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.5782053470611572
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.908 Vali Acc: 0.306 Test Loss: 3.908 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.1283040046691895
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.929 Vali Acc: 0.305 Test Loss: 3.929 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 267610
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.56935715675354
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.340 Vali Acc: 0.042 Test Loss: 3.340 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 3.4226150512695312
Epoch: 2, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.292 Vali Acc: 0.059 Test Loss: 3.292 Test Acc: 0.059
Validation loss decreased (-0.042320 --> -0.058791).  Saving model ...
Epoch: 3 cost time: 3.277221441268921
Epoch: 3, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.269 Vali Acc: 0.096 Test Loss: 3.269 Test Acc: 0.096
Validation loss decreased (-0.058791 --> -0.096438).  Saving model ...
Epoch: 4 cost time: 3.4735662937164307
Epoch: 4, Steps: 10 | Train Loss: 2.739 Vali Loss: 3.239 Vali Acc: 0.128 Test Loss: 3.239 Test Acc: 0.128
Validation loss decreased (-0.096438 --> -0.128203).  Saving model ...
Epoch: 5 cost time: 2.912781000137329
Epoch: 5, Steps: 10 | Train Loss: 2.493 Vali Loss: 3.212 Vali Acc: 0.131 Test Loss: 3.212 Test Acc: 0.131
Validation loss decreased (-0.128203 --> -0.130556).  Saving model ...
Epoch: 6 cost time: 3.248591184616089
Epoch: 6, Steps: 10 | Train Loss: 2.247 Vali Loss: 3.170 Vali Acc: 0.155 Test Loss: 3.170 Test Acc: 0.155
Validation loss decreased (-0.130556 --> -0.155262).  Saving model ...
Epoch: 7 cost time: 3.339172840118408
Epoch: 7, Steps: 10 | Train Loss: 2.004 Vali Loss: 3.157 Vali Acc: 0.178 Test Loss: 3.157 Test Acc: 0.178
Validation loss decreased (-0.155262 --> -0.177615).  Saving model ...
Epoch: 8 cost time: 3.177241802215576
Epoch: 8, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.149 Vali Acc: 0.201 Test Loss: 3.149 Test Acc: 0.201
Validation loss decreased (-0.177615 --> -0.201145).  Saving model ...
Epoch: 9 cost time: 3.3275251388549805
Epoch: 9, Steps: 10 | Train Loss: 1.502 Vali Loss: 3.160 Vali Acc: 0.228 Test Loss: 3.160 Test Acc: 0.228
Validation loss decreased (-0.201145 --> -0.228204).  Saving model ...
Epoch: 10 cost time: 3.4177515506744385
Epoch: 10, Steps: 10 | Train Loss: 1.261 Vali Loss: 3.184 Vali Acc: 0.236 Test Loss: 3.184 Test Acc: 0.236
Validation loss decreased (-0.228204 --> -0.236439).  Saving model ...
Epoch: 11 cost time: 3.5970146656036377
Epoch: 11, Steps: 10 | Train Loss: 1.031 Vali Loss: 3.162 Vali Acc: 0.262 Test Loss: 3.162 Test Acc: 0.262
Validation loss decreased (-0.236439 --> -0.262321).  Saving model ...
Epoch: 12 cost time: 3.523111581802368
Epoch: 12, Steps: 10 | Train Loss: 0.829 Vali Loss: 3.204 Vali Acc: 0.253 Test Loss: 3.204 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1634764671325684
Epoch: 13, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.240 Vali Acc: 0.276 Test Loss: 3.240 Test Acc: 0.276
Validation loss decreased (-0.262321 --> -0.276438).  Saving model ...
Epoch: 14 cost time: 3.2378721237182617
Epoch: 14, Steps: 10 | Train Loss: 0.559 Vali Loss: 3.295 Vali Acc: 0.278 Test Loss: 3.295 Test Acc: 0.278
Validation loss decreased (-0.276438 --> -0.277614).  Saving model ...
Epoch: 15 cost time: 3.079648017883301
Epoch: 15, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.329 Vali Acc: 0.281 Test Loss: 3.329 Test Acc: 0.281
Validation loss decreased (-0.277614 --> -0.281143).  Saving model ...
Epoch: 16 cost time: 3.2372734546661377
Epoch: 16, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.369 Vali Acc: 0.298 Test Loss: 3.369 Test Acc: 0.298
Validation loss decreased (-0.281143 --> -0.297613).  Saving model ...
Epoch: 17 cost time: 3.1403536796569824
Epoch: 17, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.509 Vali Acc: 0.262 Test Loss: 3.509 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5982165336608887
Epoch: 18, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.472 Vali Acc: 0.286 Test Loss: 3.472 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4485533237457275
Epoch: 19, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.538 Vali Acc: 0.292 Test Loss: 3.538 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.2990598678588867
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.573 Vali Acc: 0.296 Test Loss: 3.573 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2791168689727783
Epoch: 21, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.605 Vali Acc: 0.298 Test Loss: 3.605 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.8354365825653076
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.653 Vali Acc: 0.293 Test Loss: 3.653 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.469125509262085
Epoch: 23, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.664 Vali Acc: 0.295 Test Loss: 3.664 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.737190008163452
Epoch: 24, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.726 Vali Acc: 0.294 Test Loss: 3.726 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.3417017459869385
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.762 Vali Acc: 0.293 Test Loss: 3.762 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.615504026412964
Epoch: 26, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.776 Vali Acc: 0.304 Test Loss: 3.776 Test Acc: 0.304
Validation loss decreased (-0.297613 --> -0.303492).  Saving model ...
Epoch: 27 cost time: 3.2373554706573486
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.809 Vali Acc: 0.287 Test Loss: 3.809 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4444103240966797
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.823 Vali Acc: 0.296 Test Loss: 3.823 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.3217082023620605
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.846 Vali Acc: 0.299 Test Loss: 3.846 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.27964186668396
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.881 Vali Acc: 0.294 Test Loss: 3.881 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.0680339336395264
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.899 Vali Acc: 0.299 Test Loss: 3.899 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.44524884223938
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.913 Vali Acc: 0.295 Test Loss: 3.913 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.2857704162597656
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.930 Vali Acc: 0.295 Test Loss: 3.930 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.2479867935180664
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.939 Vali Acc: 0.296 Test Loss: 3.939 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.040052652359009
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.953 Vali Acc: 0.296 Test Loss: 3.953 Test Acc: 0.296
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.127887725830078
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.983 Vali Acc: 0.295 Test Loss: 3.983 Test Acc: 0.295
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 267610
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.508113145828247
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.305 Vali Acc: 0.040 Test Loss: 3.305 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.128986358642578
Epoch: 2, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.284 Vali Acc: 0.052 Test Loss: 3.284 Test Acc: 0.052
Validation loss decreased (-0.039967 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 3.113879442214966
Epoch: 3, Steps: 10 | Train Loss: 2.986 Vali Loss: 3.282 Vali Acc: 0.080 Test Loss: 3.282 Test Acc: 0.080
Validation loss decreased (-0.051732 --> -0.079967).  Saving model ...
Epoch: 4 cost time: 3.2119619846343994
Epoch: 4, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.267 Vali Acc: 0.121 Test Loss: 3.267 Test Acc: 0.121
Validation loss decreased (-0.079967 --> -0.121144).  Saving model ...
Epoch: 5 cost time: 3.2957603931427
Epoch: 5, Steps: 10 | Train Loss: 2.530 Vali Loss: 3.257 Vali Acc: 0.129 Test Loss: 3.257 Test Acc: 0.129
Validation loss decreased (-0.121144 --> -0.129379).  Saving model ...
Epoch: 6 cost time: 3.4688057899475098
Epoch: 6, Steps: 10 | Train Loss: 2.283 Vali Loss: 3.232 Vali Acc: 0.149 Test Loss: 3.232 Test Acc: 0.149
Validation loss decreased (-0.129379 --> -0.149379).  Saving model ...
Epoch: 7 cost time: 2.9836034774780273
Epoch: 7, Steps: 10 | Train Loss: 2.065 Vali Loss: 3.234 Vali Acc: 0.160 Test Loss: 3.234 Test Acc: 0.160
Validation loss decreased (-0.149379 --> -0.159968).  Saving model ...
Epoch: 8 cost time: 3.210759162902832
Epoch: 8, Steps: 10 | Train Loss: 1.801 Vali Loss: 3.244 Vali Acc: 0.161 Test Loss: 3.244 Test Acc: 0.161
Validation loss decreased (-0.159968 --> -0.161144).  Saving model ...
Epoch: 9 cost time: 3.6155600547790527
Epoch: 9, Steps: 10 | Train Loss: 1.562 Vali Loss: 3.278 Vali Acc: 0.172 Test Loss: 3.278 Test Acc: 0.172
Validation loss decreased (-0.161144 --> -0.171732).  Saving model ...
Epoch: 10 cost time: 3.714702844619751
Epoch: 10, Steps: 10 | Train Loss: 1.336 Vali Loss: 3.318 Vali Acc: 0.175 Test Loss: 3.318 Test Acc: 0.175
Validation loss decreased (-0.171732 --> -0.175261).  Saving model ...
Epoch: 11 cost time: 3.407214403152466
Epoch: 11, Steps: 10 | Train Loss: 1.147 Vali Loss: 3.323 Vali Acc: 0.188 Test Loss: 3.323 Test Acc: 0.188
Validation loss decreased (-0.175261 --> -0.188202).  Saving model ...
Epoch: 12 cost time: 3.332162618637085
Epoch: 12, Steps: 10 | Train Loss: 0.923 Vali Loss: 3.381 Vali Acc: 0.191 Test Loss: 3.381 Test Acc: 0.191
Validation loss decreased (-0.188202 --> -0.190554).  Saving model ...
Epoch: 13 cost time: 3.3193886280059814
Epoch: 13, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.447 Vali Acc: 0.196 Test Loss: 3.447 Test Acc: 0.196
Validation loss decreased (-0.190554 --> -0.196436).  Saving model ...
Epoch: 14 cost time: 3.33017897605896
Epoch: 14, Steps: 10 | Train Loss: 0.640 Vali Loss: 3.510 Vali Acc: 0.213 Test Loss: 3.510 Test Acc: 0.213
Validation loss decreased (-0.196436 --> -0.212906).  Saving model ...
Epoch: 15 cost time: 3.4853880405426025
Epoch: 15, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.574 Vali Acc: 0.219 Test Loss: 3.574 Test Acc: 0.219
Validation loss decreased (-0.212906 --> -0.218788).  Saving model ...
Epoch: 16 cost time: 3.383448839187622
Epoch: 16, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.654 Vali Acc: 0.221 Test Loss: 3.654 Test Acc: 0.221
Validation loss decreased (-0.218788 --> -0.221140).  Saving model ...
Epoch: 17 cost time: 3.249018907546997
Epoch: 17, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.790 Vali Acc: 0.208 Test Loss: 3.790 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.211082696914673
Epoch: 18, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.762 Vali Acc: 0.239 Test Loss: 3.762 Test Acc: 0.239
Validation loss decreased (-0.221140 --> -0.238786).  Saving model ...
Epoch: 19 cost time: 3.397416353225708
Epoch: 19, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.893 Vali Acc: 0.232 Test Loss: 3.893 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.517249345779419
Epoch: 20, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.927 Vali Acc: 0.238 Test Loss: 3.927 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.2145395278930664
Epoch: 21, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.943 Vali Acc: 0.248 Test Loss: 3.943 Test Acc: 0.248
Validation loss decreased (-0.238786 --> -0.248196).  Saving model ...
Epoch: 22 cost time: 2.701918840408325
Epoch: 22, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.027 Vali Acc: 0.246 Test Loss: 4.027 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0350732803344727
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.088 Vali Acc: 0.234 Test Loss: 4.088 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.41066312789917
Epoch: 24, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.183 Vali Acc: 0.240 Test Loss: 4.183 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0345518589019775
Epoch: 25, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.204 Vali Acc: 0.245 Test Loss: 4.204 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.6040492057800293
Epoch: 26, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.202 Vali Acc: 0.247 Test Loss: 4.202 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.148432970046997
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.247 Vali Acc: 0.246 Test Loss: 4.247 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.5067126750946045
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.262 Vali Acc: 0.251 Test Loss: 4.262 Test Acc: 0.251
Validation loss decreased (-0.248196 --> -0.250546).  Saving model ...
Epoch: 29 cost time: 3.795147657394409
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.303 Vali Acc: 0.249 Test Loss: 4.303 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.626119613647461
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.340 Vali Acc: 0.245 Test Loss: 4.340 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.3504199981689453
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.366 Vali Acc: 0.249 Test Loss: 4.366 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.5311100482940674
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.370 Vali Acc: 0.254 Test Loss: 4.370 Test Acc: 0.254
Validation loss decreased (-0.250546 --> -0.254074).  Saving model ...
Epoch: 33 cost time: 3.237394094467163
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.400 Vali Acc: 0.252 Test Loss: 4.400 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.345609426498413
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.419 Vali Acc: 0.252 Test Loss: 4.419 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.554837942123413
Epoch: 35, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.435 Vali Acc: 0.254 Test Loss: 4.435 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.204943895339966
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.474 Vali Acc: 0.255 Test Loss: 4.474 Test Acc: 0.255
Validation loss decreased (-0.254074 --> -0.255249).  Saving model ...
Epoch: 37 cost time: 3.8327109813690186
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.496 Vali Acc: 0.253 Test Loss: 4.496 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.440406322479248
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.510 Vali Acc: 0.254 Test Loss: 4.510 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.6395018100738525
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.525 Vali Acc: 0.259 Test Loss: 4.525 Test Acc: 0.259
Validation loss decreased (-0.255249 --> -0.258778).  Saving model ...
Epoch: 40 cost time: 2.890049457550049
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.538 Vali Acc: 0.258 Test Loss: 4.538 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.4457836151123047
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.552 Vali Acc: 0.256 Test Loss: 4.552 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.402174234390259
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.568 Vali Acc: 0.255 Test Loss: 4.568 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.0211341381073
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.585 Vali Acc: 0.252 Test Loss: 4.585 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.051194190979004
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.598 Vali Acc: 0.255 Test Loss: 4.598 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.085991621017456
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.612 Vali Acc: 0.259 Test Loss: 4.612 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.401465892791748
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.632 Vali Acc: 0.255 Test Loss: 4.632 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.341531753540039
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.660 Vali Acc: 0.254 Test Loss: 4.660 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.864220142364502
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.680 Vali Acc: 0.253 Test Loss: 4.680 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.1923112869262695
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.697 Vali Acc: 0.256 Test Loss: 4.697 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 267610
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.386524200439453
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.323 Vali Acc: 0.035 Test Loss: 3.323 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 3.230888843536377
Epoch: 2, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.319 Vali Acc: 0.039 Test Loss: 3.319 Test Acc: 0.039
Validation loss decreased (-0.035261 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 3.4758334159851074
Epoch: 3, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.334 Vali Acc: 0.058 Test Loss: 3.334 Test Acc: 0.058
Validation loss decreased (-0.038790 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 3.4916810989379883
Epoch: 4, Steps: 10 | Train Loss: 2.877 Vali Loss: 3.339 Vali Acc: 0.079 Test Loss: 3.339 Test Acc: 0.079
Validation loss decreased (-0.057614 --> -0.078790).  Saving model ...
Epoch: 5 cost time: 3.5544605255126953
Epoch: 5, Steps: 10 | Train Loss: 2.695 Vali Loss: 3.343 Vali Acc: 0.075 Test Loss: 3.343 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.235111951828003
Epoch: 6, Steps: 10 | Train Loss: 2.444 Vali Loss: 3.330 Vali Acc: 0.084 Test Loss: 3.330 Test Acc: 0.084
Validation loss decreased (-0.078790 --> -0.083496).  Saving model ...
Epoch: 7 cost time: 3.568303346633911
Epoch: 7, Steps: 10 | Train Loss: 2.218 Vali Loss: 3.346 Vali Acc: 0.088 Test Loss: 3.346 Test Acc: 0.088
Validation loss decreased (-0.083496 --> -0.088202).  Saving model ...
Epoch: 8 cost time: 3.3798084259033203
Epoch: 8, Steps: 10 | Train Loss: 1.951 Vali Loss: 3.362 Vali Acc: 0.089 Test Loss: 3.362 Test Acc: 0.089
Validation loss decreased (-0.088202 --> -0.089378).  Saving model ...
Epoch: 9 cost time: 3.799269676208496
Epoch: 9, Steps: 10 | Train Loss: 1.738 Vali Loss: 3.398 Vali Acc: 0.099 Test Loss: 3.398 Test Acc: 0.099
Validation loss decreased (-0.089378 --> -0.098790).  Saving model ...
Epoch: 10 cost time: 3.6955819129943848
Epoch: 10, Steps: 10 | Train Loss: 1.453 Vali Loss: 3.433 Vali Acc: 0.104 Test Loss: 3.433 Test Acc: 0.104
Validation loss decreased (-0.098790 --> -0.103495).  Saving model ...
Epoch: 11 cost time: 3.2301101684570312
Epoch: 11, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.458 Vali Acc: 0.109 Test Loss: 3.458 Test Acc: 0.109
Validation loss decreased (-0.103495 --> -0.109377).  Saving model ...
Epoch: 12 cost time: 3.4230055809020996
Epoch: 12, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.540 Vali Acc: 0.105 Test Loss: 3.540 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9810574054718018
Epoch: 13, Steps: 10 | Train Loss: 0.828 Vali Loss: 3.612 Vali Acc: 0.109 Test Loss: 3.612 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2937817573547363
Epoch: 14, Steps: 10 | Train Loss: 0.686 Vali Loss: 3.693 Vali Acc: 0.118 Test Loss: 3.693 Test Acc: 0.118
Validation loss decreased (-0.109377 --> -0.117610).  Saving model ...
Epoch: 15 cost time: 3.2980895042419434
Epoch: 15, Steps: 10 | Train Loss: 0.513 Vali Loss: 3.784 Vali Acc: 0.120 Test Loss: 3.784 Test Acc: 0.120
Validation loss decreased (-0.117610 --> -0.119962).  Saving model ...
Epoch: 16 cost time: 3.1997010707855225
Epoch: 16, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.882 Vali Acc: 0.125 Test Loss: 3.882 Test Acc: 0.125
Validation loss decreased (-0.119962 --> -0.124667).  Saving model ...
Epoch: 17 cost time: 3.106459140777588
Epoch: 17, Steps: 10 | Train Loss: 0.277 Vali Loss: 4.027 Vali Acc: 0.116 Test Loss: 4.027 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1181113719940186
Epoch: 18, Steps: 10 | Train Loss: 0.208 Vali Loss: 4.019 Vali Acc: 0.138 Test Loss: 4.019 Test Acc: 0.138
Validation loss decreased (-0.124667 --> -0.137607).  Saving model ...
Epoch: 19 cost time: 3.4269332885742188
Epoch: 19, Steps: 10 | Train Loss: 0.141 Vali Loss: 4.140 Vali Acc: 0.133 Test Loss: 4.140 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.128218173980713
Epoch: 20, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.218 Vali Acc: 0.135 Test Loss: 4.218 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.786296844482422
Epoch: 21, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.235 Vali Acc: 0.142 Test Loss: 4.235 Test Acc: 0.142
Validation loss decreased (-0.137607 --> -0.142311).  Saving model ...
Epoch: 22 cost time: 3.450474739074707
Epoch: 22, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.269 Vali Acc: 0.146 Test Loss: 4.269 Test Acc: 0.146
Validation loss decreased (-0.142311 --> -0.145840).  Saving model ...
Epoch: 23 cost time: 3.0997469425201416
Epoch: 23, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.346 Vali Acc: 0.133 Test Loss: 4.346 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9666788578033447
Epoch: 24, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.438 Vali Acc: 0.134 Test Loss: 4.438 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.9241371154785156
Epoch: 25, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.439 Vali Acc: 0.142 Test Loss: 4.439 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.6384687423706055
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.441 Vali Acc: 0.149 Test Loss: 4.441 Test Acc: 0.149
Validation loss decreased (-0.145840 --> -0.149367).  Saving model ...
Epoch: 27 cost time: 3.275998115539551
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.469 Vali Acc: 0.147 Test Loss: 4.469 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.446845054626465
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.493 Vali Acc: 0.145 Test Loss: 4.493 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.061126232147217
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.534 Vali Acc: 0.142 Test Loss: 4.534 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.250075578689575
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.556 Vali Acc: 0.140 Test Loss: 4.556 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.2425601482391357
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.580 Vali Acc: 0.145 Test Loss: 4.580 Test Acc: 0.145
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.6042580604553223
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.608 Vali Acc: 0.153 Test Loss: 4.608 Test Acc: 0.153
Validation loss decreased (-0.149367 --> -0.152895).  Saving model ...
Epoch: 33 cost time: 3.3101646900177
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.625 Vali Acc: 0.155 Test Loss: 4.625 Test Acc: 0.155
Validation loss decreased (-0.152895 --> -0.155248).  Saving model ...
Epoch: 34 cost time: 3.09637713432312
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.633 Vali Acc: 0.151 Test Loss: 4.633 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.4422075748443604
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.648 Vali Acc: 0.154 Test Loss: 4.648 Test Acc: 0.154
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.5500850677490234
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.682 Vali Acc: 0.147 Test Loss: 4.682 Test Acc: 0.147
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.3606152534484863
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.707 Vali Acc: 0.148 Test Loss: 4.707 Test Acc: 0.148
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.122190237045288
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.723 Vali Acc: 0.152 Test Loss: 4.723 Test Acc: 0.152
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.2768144607543945
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.739 Vali Acc: 0.155 Test Loss: 4.739 Test Acc: 0.155
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.9529836177825928
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.749 Vali Acc: 0.155 Test Loss: 4.749 Test Acc: 0.155
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.444744348526001
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.766 Vali Acc: 0.153 Test Loss: 4.766 Test Acc: 0.153
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.6646268367767334
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.771 Vali Acc: 0.155 Test Loss: 4.771 Test Acc: 0.155
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.2945258617401123
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.791 Vali Acc: 0.160 Test Loss: 4.791 Test Acc: 0.160
Validation loss decreased (-0.155248 --> -0.159952).  Saving model ...
Epoch: 44 cost time: 3.5450072288513184
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.813 Vali Acc: 0.155 Test Loss: 4.813 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.481142282485962
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.833 Vali Acc: 0.154 Test Loss: 4.833 Test Acc: 0.154
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.493802070617676
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.852 Vali Acc: 0.156 Test Loss: 4.852 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.0740039348602295
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.873 Vali Acc: 0.152 Test Loss: 4.873 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.4553136825561523
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.888 Vali Acc: 0.153 Test Loss: 4.888 Test Acc: 0.153
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.5586071014404297
Epoch: 49, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.902 Vali Acc: 0.151 Test Loss: 4.902 Test Acc: 0.151
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.071773052215576
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.910 Vali Acc: 0.155 Test Loss: 4.910 Test Acc: 0.155
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.4349911212921143
Epoch: 51, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.921 Vali Acc: 0.156 Test Loss: 4.921 Test Acc: 0.156
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.442596912384033
Epoch: 52, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.930 Vali Acc: 0.158 Test Loss: 4.930 Test Acc: 0.158
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.497689723968506
Epoch: 53, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.940 Vali Acc: 0.158 Test Loss: 4.940 Test Acc: 0.158
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16
model parameter : 267610
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.563601493835449
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.318 Vali Acc: 0.045 Test Loss: 3.318 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 3.4258737564086914
Epoch: 2, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.314 Vali Acc: 0.045 Test Loss: 3.314 Test Acc: 0.045
Validation loss decreased (-0.044673 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 3.3189785480499268
Epoch: 3, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.330 Vali Acc: 0.039 Test Loss: 3.330 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0391006469726562
Epoch: 4, Steps: 10 | Train Loss: 2.994 Vali Loss: 3.340 Vali Acc: 0.045 Test Loss: 3.340 Test Acc: 0.045
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6371169090270996
Epoch: 5, Steps: 10 | Train Loss: 2.846 Vali Loss: 3.351 Vali Acc: 0.038 Test Loss: 3.351 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.266981840133667
Epoch: 6, Steps: 10 | Train Loss: 2.679 Vali Loss: 3.338 Vali Acc: 0.053 Test Loss: 3.338 Test Acc: 0.053
Validation loss decreased (-0.044673 --> -0.052908).  Saving model ...
Epoch: 7 cost time: 3.4167771339416504
Epoch: 7, Steps: 10 | Train Loss: 2.520 Vali Loss: 3.343 Vali Acc: 0.066 Test Loss: 3.343 Test Acc: 0.066
Validation loss decreased (-0.052908 --> -0.065849).  Saving model ...
Epoch: 8 cost time: 3.5135796070098877
Epoch: 8, Steps: 10 | Train Loss: 2.290 Vali Loss: 3.349 Vali Acc: 0.072 Test Loss: 3.349 Test Acc: 0.072
Validation loss decreased (-0.065849 --> -0.071731).  Saving model ...
Epoch: 9 cost time: 3.485323667526245
Epoch: 9, Steps: 10 | Train Loss: 2.148 Vali Loss: 3.369 Vali Acc: 0.076 Test Loss: 3.369 Test Acc: 0.076
Validation loss decreased (-0.071731 --> -0.076437).  Saving model ...
Epoch: 10 cost time: 3.3865363597869873
Epoch: 10, Steps: 10 | Train Loss: 1.905 Vali Loss: 3.388 Vali Acc: 0.078 Test Loss: 3.388 Test Acc: 0.078
Validation loss decreased (-0.076437 --> -0.077613).  Saving model ...
Epoch: 11 cost time: 3.199582576751709
Epoch: 11, Steps: 10 | Train Loss: 1.723 Vali Loss: 3.390 Vali Acc: 0.079 Test Loss: 3.390 Test Acc: 0.079
Validation loss decreased (-0.077613 --> -0.078790).  Saving model ...
Epoch: 12 cost time: 3.17036771774292
Epoch: 12, Steps: 10 | Train Loss: 1.431 Vali Loss: 3.442 Vali Acc: 0.076 Test Loss: 3.442 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.526376724243164
Epoch: 13, Steps: 10 | Train Loss: 1.276 Vali Loss: 3.488 Vali Acc: 0.091 Test Loss: 3.488 Test Acc: 0.091
Validation loss decreased (-0.078790 --> -0.090553).  Saving model ...
Epoch: 14 cost time: 3.606518507003784
Epoch: 14, Steps: 10 | Train Loss: 1.063 Vali Loss: 3.548 Vali Acc: 0.094 Test Loss: 3.548 Test Acc: 0.094
Validation loss decreased (-0.090553 --> -0.094082).  Saving model ...
Epoch: 15 cost time: 3.3942484855651855
Epoch: 15, Steps: 10 | Train Loss: 0.867 Vali Loss: 3.602 Vali Acc: 0.092 Test Loss: 3.602 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.763021945953369
Epoch: 16, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.682 Vali Acc: 0.093 Test Loss: 3.682 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.597147226333618
Epoch: 17, Steps: 10 | Train Loss: 0.558 Vali Loss: 3.827 Vali Acc: 0.095 Test Loss: 3.827 Test Acc: 0.095
Validation loss decreased (-0.094082 --> -0.095256).  Saving model ...
Epoch: 18 cost time: 3.310100793838501
Epoch: 18, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.822 Vali Acc: 0.093 Test Loss: 3.822 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7482750415802
Epoch: 19, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.938 Vali Acc: 0.096 Test Loss: 3.938 Test Acc: 0.096
Validation loss decreased (-0.095256 --> -0.096431).  Saving model ...
Epoch: 20 cost time: 3.540128707885742
Epoch: 20, Steps: 10 | Train Loss: 0.221 Vali Loss: 4.006 Vali Acc: 0.096 Test Loss: 4.006 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5273032188415527
Epoch: 21, Steps: 10 | Train Loss: 0.164 Vali Loss: 4.065 Vali Acc: 0.102 Test Loss: 4.065 Test Acc: 0.102
Validation loss decreased (-0.096431 --> -0.102312).  Saving model ...
Epoch: 22 cost time: 3.8404009342193604
Epoch: 22, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.130 Vali Acc: 0.100 Test Loss: 4.130 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6258223056793213
Epoch: 23, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.196 Vali Acc: 0.098 Test Loss: 4.196 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.4270520210266113
Epoch: 24, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.286 Vali Acc: 0.105 Test Loss: 4.286 Test Acc: 0.105
Validation loss decreased (-0.102312 --> -0.104663).  Saving model ...
Epoch: 25 cost time: 3.60982084274292
Epoch: 25, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.305 Vali Acc: 0.101 Test Loss: 4.305 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.264862060546875
Epoch: 26, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.317 Vali Acc: 0.100 Test Loss: 4.317 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0557074546813965
Epoch: 27, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.367 Vali Acc: 0.102 Test Loss: 4.367 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.6942319869995117
Epoch: 28, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.398 Vali Acc: 0.098 Test Loss: 4.398 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.187936305999756
Epoch: 29, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.435 Vali Acc: 0.101 Test Loss: 4.435 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.8396363258361816
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.476 Vali Acc: 0.102 Test Loss: 4.476 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.411846399307251
Epoch: 31, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.509 Vali Acc: 0.101 Test Loss: 4.509 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.3353397846221924
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.516 Vali Acc: 0.104 Test Loss: 4.516 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.650968551635742
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.530 Vali Acc: 0.104 Test Loss: 4.530 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.53489351272583
Epoch: 34, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.544 Vali Acc: 0.107 Test Loss: 4.544 Test Acc: 0.107
Validation loss decreased (-0.104663 --> -0.107013).  Saving model ...
Epoch: 35 cost time: 3.3252828121185303
Epoch: 35, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.572 Vali Acc: 0.108 Test Loss: 4.572 Test Acc: 0.108
Validation loss decreased (-0.107013 --> -0.108190).  Saving model ...
Epoch: 36 cost time: 3.616447687149048
Epoch: 36, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.609 Vali Acc: 0.108 Test Loss: 4.609 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.3909361362457275
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.636 Vali Acc: 0.107 Test Loss: 4.636 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.5370194911956787
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.653 Vali Acc: 0.106 Test Loss: 4.653 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.646603584289551
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.669 Vali Acc: 0.107 Test Loss: 4.669 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.4837334156036377
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.672 Vali Acc: 0.108 Test Loss: 4.672 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.6811704635620117
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.692 Vali Acc: 0.112 Test Loss: 4.692 Test Acc: 0.112
Validation loss decreased (-0.108190 --> -0.111718).  Saving model ...
Epoch: 42 cost time: 3.442042827606201
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.706 Vali Acc: 0.112 Test Loss: 4.706 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.325169563293457
Epoch: 43, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.719 Vali Acc: 0.111 Test Loss: 4.719 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.7734322547912598
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.726 Vali Acc: 0.112 Test Loss: 4.726 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.1627728939056396
Epoch: 45, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.744 Vali Acc: 0.112 Test Loss: 4.744 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.8544209003448486
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.778 Vali Acc: 0.113 Test Loss: 4.778 Test Acc: 0.113
Validation loss decreased (-0.111718 --> -0.112893).  Saving model ...
Epoch: 47 cost time: 3.3429148197174072
Epoch: 47, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.800 Vali Acc: 0.112 Test Loss: 4.800 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.081441640853882
Epoch: 48, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.812 Vali Acc: 0.114 Test Loss: 4.812 Test Acc: 0.114
Validation loss decreased (-0.112893 --> -0.114070).  Saving model ...
Epoch: 49 cost time: 3.2703704833984375
Epoch: 49, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.829 Vali Acc: 0.112 Test Loss: 4.829 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.5275301933288574
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.836 Vali Acc: 0.108 Test Loss: 4.836 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.315443277359009
Epoch: 51, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.856 Vali Acc: 0.106 Test Loss: 4.856 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.053720235824585
Epoch: 52, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.867 Vali Acc: 0.109 Test Loss: 4.867 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.1009857654571533
Epoch: 53, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.876 Vali Acc: 0.108 Test Loss: 4.876 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.7635796070098877
Epoch: 54, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.894 Vali Acc: 0.112 Test Loss: 4.894 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.0955471992492676
Epoch: 55, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.913 Vali Acc: 0.113 Test Loss: 4.913 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.8728623390197754
Epoch: 56, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.927 Vali Acc: 0.114 Test Loss: 4.927 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 3.2714431285858154
Epoch: 57, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.936 Vali Acc: 0.114 Test Loss: 4.936 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 3.7505924701690674
Epoch: 58, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.933 Vali Acc: 0.112 Test Loss: 4.933 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.11411764705882353
model parameter : 267610
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.178785085678101
Epoch: 1, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.317 Vali Acc: 0.034 Test Loss: 3.317 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 3.451296091079712
Epoch: 2, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.320 Vali Acc: 0.036 Test Loss: 3.320 Test Acc: 0.036
Validation loss decreased (-0.034084 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 2.960456371307373
Epoch: 3, Steps: 10 | Train Loss: 3.144 Vali Loss: 3.337 Vali Acc: 0.046 Test Loss: 3.337 Test Acc: 0.046
Validation loss decreased (-0.036437 --> -0.045849).  Saving model ...
Epoch: 4 cost time: 3.464082956314087
Epoch: 4, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.352 Vali Acc: 0.042 Test Loss: 3.352 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3655080795288086
Epoch: 5, Steps: 10 | Train Loss: 2.993 Vali Loss: 3.364 Vali Acc: 0.052 Test Loss: 3.364 Test Acc: 0.052
Validation loss decreased (-0.045849 --> -0.051731).  Saving model ...
Epoch: 6 cost time: 3.5389950275421143
Epoch: 6, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.357 Vali Acc: 0.055 Test Loss: 3.357 Test Acc: 0.055
Validation loss decreased (-0.051731 --> -0.055261).  Saving model ...
Epoch: 7 cost time: 3.626685619354248
Epoch: 7, Steps: 10 | Train Loss: 2.754 Vali Loss: 3.362 Vali Acc: 0.062 Test Loss: 3.362 Test Acc: 0.062
Validation loss decreased (-0.055261 --> -0.062319).  Saving model ...
Epoch: 8 cost time: 3.45896577835083
Epoch: 8, Steps: 10 | Train Loss: 2.586 Vali Loss: 3.360 Vali Acc: 0.059 Test Loss: 3.360 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3859076499938965
Epoch: 9, Steps: 10 | Train Loss: 2.444 Vali Loss: 3.364 Vali Acc: 0.066 Test Loss: 3.364 Test Acc: 0.066
Validation loss decreased (-0.062319 --> -0.065849).  Saving model ...
Epoch: 10 cost time: 3.1427230834960938
Epoch: 10, Steps: 10 | Train Loss: 2.238 Vali Loss: 3.372 Vali Acc: 0.072 Test Loss: 3.372 Test Acc: 0.072
Validation loss decreased (-0.065849 --> -0.071731).  Saving model ...
Epoch: 11 cost time: 3.4303700923919678
Epoch: 11, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.368 Vali Acc: 0.069 Test Loss: 3.368 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2226614952087402
Epoch: 12, Steps: 10 | Train Loss: 1.882 Vali Loss: 3.383 Vali Acc: 0.073 Test Loss: 3.383 Test Acc: 0.073
Validation loss decreased (-0.071731 --> -0.072907).  Saving model ...
Epoch: 13 cost time: 3.7516610622406006
Epoch: 13, Steps: 10 | Train Loss: 1.706 Vali Loss: 3.395 Vali Acc: 0.079 Test Loss: 3.395 Test Acc: 0.079
Validation loss decreased (-0.072907 --> -0.078790).  Saving model ...
Epoch: 14 cost time: 3.311979055404663
Epoch: 14, Steps: 10 | Train Loss: 1.539 Vali Loss: 3.424 Vali Acc: 0.084 Test Loss: 3.424 Test Acc: 0.084
Validation loss decreased (-0.078790 --> -0.083495).  Saving model ...
Epoch: 15 cost time: 3.400343418121338
Epoch: 15, Steps: 10 | Train Loss: 1.300 Vali Loss: 3.459 Vali Acc: 0.085 Test Loss: 3.459 Test Acc: 0.085
Validation loss decreased (-0.083495 --> -0.084671).  Saving model ...
Epoch: 16 cost time: 3.8809399604797363
Epoch: 16, Steps: 10 | Train Loss: 1.143 Vali Loss: 3.489 Vali Acc: 0.091 Test Loss: 3.489 Test Acc: 0.091
Validation loss decreased (-0.084671 --> -0.090553).  Saving model ...
Epoch: 17 cost time: 3.475255250930786
Epoch: 17, Steps: 10 | Train Loss: 0.984 Vali Loss: 3.572 Vali Acc: 0.099 Test Loss: 3.572 Test Acc: 0.099
Validation loss decreased (-0.090553 --> -0.098788).  Saving model ...
Epoch: 18 cost time: 3.5989904403686523
Epoch: 18, Steps: 10 | Train Loss: 0.839 Vali Loss: 3.605 Vali Acc: 0.098 Test Loss: 3.605 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.091008186340332
Epoch: 19, Steps: 10 | Train Loss: 0.621 Vali Loss: 3.692 Vali Acc: 0.092 Test Loss: 3.692 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.487065553665161
Epoch: 20, Steps: 10 | Train Loss: 0.497 Vali Loss: 3.757 Vali Acc: 0.095 Test Loss: 3.757 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.031564950942993
Epoch: 21, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.823 Vali Acc: 0.091 Test Loss: 3.823 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.578404426574707
Epoch: 22, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.949 Vali Acc: 0.093 Test Loss: 3.949 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.353065013885498
Epoch: 23, Steps: 10 | Train Loss: 0.223 Vali Loss: 4.029 Vali Acc: 0.091 Test Loss: 4.029 Test Acc: 0.091
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.275609016418457
Epoch: 24, Steps: 10 | Train Loss: 0.164 Vali Loss: 4.189 Vali Acc: 0.089 Test Loss: 4.189 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.177276849746704
Epoch: 25, Steps: 10 | Train Loss: 0.127 Vali Loss: 4.222 Vali Acc: 0.089 Test Loss: 4.222 Test Acc: 0.089
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.723172664642334
Epoch: 26, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.264 Vali Acc: 0.082 Test Loss: 4.264 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.250447988510132
Epoch: 27, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.287 Vali Acc: 0.093 Test Loss: 4.287 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.0988235294117647
model parameter : 267610
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.033850193023682
Epoch: 1, Steps: 10 | Train Loss: 3.233 Vali Loss: 3.338 Vali Acc: 0.038 Test Loss: 3.338 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 3.2677464485168457
Epoch: 2, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.345 Vali Acc: 0.042 Test Loss: 3.345 Test Acc: 0.042
Validation loss decreased (-0.037614 --> -0.042319).  Saving model ...
Epoch: 3 cost time: 3.4824812412261963
Epoch: 3, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.364 Vali Acc: 0.047 Test Loss: 3.364 Test Acc: 0.047
Validation loss decreased (-0.042319 --> -0.047025).  Saving model ...
Epoch: 4 cost time: 3.2238264083862305
Epoch: 4, Steps: 10 | Train Loss: 3.138 Vali Loss: 3.383 Vali Acc: 0.051 Test Loss: 3.383 Test Acc: 0.051
Validation loss decreased (-0.047025 --> -0.050554).  Saving model ...
Epoch: 5 cost time: 3.8060853481292725
Epoch: 5, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.394 Vali Acc: 0.056 Test Loss: 3.394 Test Acc: 0.056
Validation loss decreased (-0.050554 --> -0.056437).  Saving model ...
Epoch: 6 cost time: 2.8314192295074463
Epoch: 6, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.390 Vali Acc: 0.061 Test Loss: 3.390 Test Acc: 0.061
Validation loss decreased (-0.056437 --> -0.061143).  Saving model ...
Epoch: 7 cost time: 3.7605366706848145
Epoch: 7, Steps: 10 | Train Loss: 2.909 Vali Loss: 3.396 Vali Acc: 0.064 Test Loss: 3.396 Test Acc: 0.064
Validation loss decreased (-0.061143 --> -0.063495).  Saving model ...
Epoch: 8 cost time: 3.1312332153320312
Epoch: 8, Steps: 10 | Train Loss: 2.740 Vali Loss: 3.389 Vali Acc: 0.065 Test Loss: 3.389 Test Acc: 0.065
Validation loss decreased (-0.063495 --> -0.064672).  Saving model ...
Epoch: 9 cost time: 3.191331148147583
Epoch: 9, Steps: 10 | Train Loss: 2.601 Vali Loss: 3.394 Vali Acc: 0.068 Test Loss: 3.394 Test Acc: 0.068
Validation loss decreased (-0.064672 --> -0.068201).  Saving model ...
Epoch: 10 cost time: 3.548631191253662
Epoch: 10, Steps: 10 | Train Loss: 2.484 Vali Loss: 3.398 Vali Acc: 0.074 Test Loss: 3.398 Test Acc: 0.074
Validation loss decreased (-0.068201 --> -0.074084).  Saving model ...
Epoch: 11 cost time: 3.4497029781341553
Epoch: 11, Steps: 10 | Train Loss: 2.395 Vali Loss: 3.386 Vali Acc: 0.068 Test Loss: 3.386 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6773436069488525
Epoch: 12, Steps: 10 | Train Loss: 2.208 Vali Loss: 3.385 Vali Acc: 0.073 Test Loss: 3.385 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0398571491241455
Epoch: 13, Steps: 10 | Train Loss: 2.052 Vali Loss: 3.390 Vali Acc: 0.075 Test Loss: 3.390 Test Acc: 0.075
Validation loss decreased (-0.074084 --> -0.075260).  Saving model ...
Epoch: 14 cost time: 3.8760645389556885
Epoch: 14, Steps: 10 | Train Loss: 1.909 Vali Loss: 3.410 Vali Acc: 0.075 Test Loss: 3.410 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1736464500427246
Epoch: 15, Steps: 10 | Train Loss: 1.665 Vali Loss: 3.434 Vali Acc: 0.072 Test Loss: 3.434 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.564478874206543
Epoch: 16, Steps: 10 | Train Loss: 1.493 Vali Loss: 3.434 Vali Acc: 0.082 Test Loss: 3.434 Test Acc: 0.082
Validation loss decreased (-0.075260 --> -0.082319).  Saving model ...
Epoch: 17 cost time: 3.0846269130706787
Epoch: 17, Steps: 10 | Train Loss: 1.345 Vali Loss: 3.497 Vali Acc: 0.087 Test Loss: 3.497 Test Acc: 0.087
Validation loss decreased (-0.082319 --> -0.087024).  Saving model ...
Epoch: 18 cost time: 3.5008609294891357
Epoch: 18, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.512 Vali Acc: 0.094 Test Loss: 3.512 Test Acc: 0.094
Validation loss decreased (-0.087024 --> -0.094083).  Saving model ...
Epoch: 19 cost time: 3.5529184341430664
Epoch: 19, Steps: 10 | Train Loss: 0.937 Vali Loss: 3.573 Vali Acc: 0.089 Test Loss: 3.573 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.576098918914795
Epoch: 20, Steps: 10 | Train Loss: 0.805 Vali Loss: 3.639 Vali Acc: 0.087 Test Loss: 3.639 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.877624750137329
Epoch: 21, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.683 Vali Acc: 0.106 Test Loss: 3.683 Test Acc: 0.106
Validation loss decreased (-0.094083 --> -0.105846).  Saving model ...
Epoch: 22 cost time: 3.7287020683288574
Epoch: 22, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.783 Vali Acc: 0.100 Test Loss: 3.783 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0835676193237305
Epoch: 23, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.842 Vali Acc: 0.105 Test Loss: 3.842 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.0935285091400146
Epoch: 24, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.990 Vali Acc: 0.086 Test Loss: 3.990 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.107001781463623
Epoch: 25, Steps: 10 | Train Loss: 0.225 Vali Loss: 4.073 Vali Acc: 0.092 Test Loss: 4.073 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.006166458129883
Epoch: 26, Steps: 10 | Train Loss: 0.187 Vali Loss: 4.119 Vali Acc: 0.095 Test Loss: 4.119 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.826275110244751
Epoch: 27, Steps: 10 | Train Loss: 0.146 Vali Loss: 4.166 Vali Acc: 0.092 Test Loss: 4.166 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.3090808391571045
Epoch: 28, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.242 Vali Acc: 0.091 Test Loss: 4.242 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.6776654720306396
Epoch: 29, Steps: 10 | Train Loss: 0.102 Vali Loss: 4.302 Vali Acc: 0.096 Test Loss: 4.302 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.2541913986206055
Epoch: 30, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.324 Vali Acc: 0.100 Test Loss: 4.324 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.223385810852051
Epoch: 31, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.354 Vali Acc: 0.098 Test Loss: 4.354 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.10588235294117647
model parameter : 267610
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.223536491394043
Epoch: 1, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.377 Vali Acc: 0.031 Test Loss: 3.377 Test Acc: 0.031
Validation loss decreased (inf --> -0.030554).  Saving model ...
Epoch: 2 cost time: 3.2663748264312744
Epoch: 2, Steps: 10 | Train Loss: 3.260 Vali Loss: 3.379 Vali Acc: 0.033 Test Loss: 3.379 Test Acc: 0.033
Validation loss decreased (-0.030554 --> -0.032907).  Saving model ...
Epoch: 3 cost time: 3.6009397506713867
Epoch: 3, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.396 Vali Acc: 0.042 Test Loss: 3.396 Test Acc: 0.042
Validation loss decreased (-0.032907 --> -0.042319).  Saving model ...
Epoch: 4 cost time: 3.280846118927002
Epoch: 4, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.411 Vali Acc: 0.044 Test Loss: 3.411 Test Acc: 0.044
Validation loss decreased (-0.042319 --> -0.043495).  Saving model ...
Epoch: 5 cost time: 3.6512250900268555
Epoch: 5, Steps: 10 | Train Loss: 3.044 Vali Loss: 3.430 Vali Acc: 0.044 Test Loss: 3.430 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5689001083374023
Epoch: 6, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.430 Vali Acc: 0.045 Test Loss: 3.430 Test Acc: 0.045
Validation loss decreased (-0.043495 --> -0.044672).  Saving model ...
Epoch: 7 cost time: 3.6679205894470215
Epoch: 7, Steps: 10 | Train Loss: 2.919 Vali Loss: 3.428 Vali Acc: 0.047 Test Loss: 3.428 Test Acc: 0.047
Validation loss decreased (-0.044672 --> -0.047025).  Saving model ...
Epoch: 8 cost time: 3.7109551429748535
Epoch: 8, Steps: 10 | Train Loss: 2.815 Vali Loss: 3.425 Vali Acc: 0.047 Test Loss: 3.425 Test Acc: 0.047
Validation loss decreased (-0.047025 --> -0.047025).  Saving model ...
Epoch: 9 cost time: 3.1107101440429688
Epoch: 9, Steps: 10 | Train Loss: 2.720 Vali Loss: 3.428 Vali Acc: 0.052 Test Loss: 3.428 Test Acc: 0.052
Validation loss decreased (-0.047025 --> -0.051730).  Saving model ...
Epoch: 10 cost time: 3.498903751373291
Epoch: 10, Steps: 10 | Train Loss: 2.620 Vali Loss: 3.439 Vali Acc: 0.051 Test Loss: 3.439 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1481950283050537
Epoch: 11, Steps: 10 | Train Loss: 2.552 Vali Loss: 3.409 Vali Acc: 0.051 Test Loss: 3.409 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.828791379928589
Epoch: 12, Steps: 10 | Train Loss: 2.423 Vali Loss: 3.402 Vali Acc: 0.053 Test Loss: 3.402 Test Acc: 0.053
Validation loss decreased (-0.051730 --> -0.052907).  Saving model ...
Epoch: 13 cost time: 3.577284812927246
Epoch: 13, Steps: 10 | Train Loss: 2.319 Vali Loss: 3.408 Vali Acc: 0.058 Test Loss: 3.408 Test Acc: 0.058
Validation loss decreased (-0.052907 --> -0.057613).  Saving model ...
Epoch: 14 cost time: 3.223785400390625
Epoch: 14, Steps: 10 | Train Loss: 2.155 Vali Loss: 3.425 Vali Acc: 0.059 Test Loss: 3.425 Test Acc: 0.059
Validation loss decreased (-0.057613 --> -0.058789).  Saving model ...
Epoch: 15 cost time: 3.740732192993164
Epoch: 15, Steps: 10 | Train Loss: 1.951 Vali Loss: 3.437 Vali Acc: 0.069 Test Loss: 3.437 Test Acc: 0.069
Validation loss decreased (-0.058789 --> -0.069377).  Saving model ...
Epoch: 16 cost time: 3.2996344566345215
Epoch: 16, Steps: 10 | Train Loss: 1.836 Vali Loss: 3.436 Vali Acc: 0.062 Test Loss: 3.436 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.475682497024536
Epoch: 17, Steps: 10 | Train Loss: 1.683 Vali Loss: 3.499 Vali Acc: 0.073 Test Loss: 3.499 Test Acc: 0.073
Validation loss decreased (-0.069377 --> -0.072906).  Saving model ...
Epoch: 18 cost time: 3.8240694999694824
Epoch: 18, Steps: 10 | Train Loss: 1.491 Vali Loss: 3.527 Vali Acc: 0.060 Test Loss: 3.527 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1675429344177246
Epoch: 19, Steps: 10 | Train Loss: 1.299 Vali Loss: 3.591 Vali Acc: 0.067 Test Loss: 3.591 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.16501522064209
Epoch: 20, Steps: 10 | Train Loss: 1.123 Vali Loss: 3.652 Vali Acc: 0.074 Test Loss: 3.652 Test Acc: 0.074
Validation loss decreased (-0.072906 --> -0.074081).  Saving model ...
Epoch: 21 cost time: 3.243579387664795
Epoch: 21, Steps: 10 | Train Loss: 0.918 Vali Loss: 3.702 Vali Acc: 0.075 Test Loss: 3.702 Test Acc: 0.075
Validation loss decreased (-0.074081 --> -0.075257).  Saving model ...
Epoch: 22 cost time: 3.242903470993042
Epoch: 22, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.801 Vali Acc: 0.079 Test Loss: 3.801 Test Acc: 0.079
Validation loss decreased (-0.075257 --> -0.078786).  Saving model ...
Epoch: 23 cost time: 3.4855973720550537
Epoch: 23, Steps: 10 | Train Loss: 0.649 Vali Loss: 3.846 Vali Acc: 0.092 Test Loss: 3.846 Test Acc: 0.092
Validation loss decreased (-0.078786 --> -0.091726).  Saving model ...
Epoch: 24 cost time: 3.3251824378967285
Epoch: 24, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.988 Vali Acc: 0.080 Test Loss: 3.988 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.49131178855896
Epoch: 25, Steps: 10 | Train Loss: 0.484 Vali Loss: 4.014 Vali Acc: 0.096 Test Loss: 4.014 Test Acc: 0.096
Validation loss decreased (-0.091726 --> -0.096430).  Saving model ...
Epoch: 26 cost time: 3.6141037940979004
Epoch: 26, Steps: 10 | Train Loss: 0.392 Vali Loss: 4.056 Vali Acc: 0.094 Test Loss: 4.056 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3183531761169434
Epoch: 27, Steps: 10 | Train Loss: 0.296 Vali Loss: 4.174 Vali Acc: 0.091 Test Loss: 4.174 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.351999044418335
Epoch: 28, Steps: 10 | Train Loss: 0.243 Vali Loss: 4.245 Vali Acc: 0.099 Test Loss: 4.245 Test Acc: 0.099
Validation loss decreased (-0.096430 --> -0.098781).  Saving model ...
Epoch: 29 cost time: 3.369016408920288
Epoch: 29, Steps: 10 | Train Loss: 0.212 Vali Loss: 4.261 Vali Acc: 0.106 Test Loss: 4.261 Test Acc: 0.106
Validation loss decreased (-0.098781 --> -0.105840).  Saving model ...
Epoch: 30 cost time: 3.203768014907837
Epoch: 30, Steps: 10 | Train Loss: 0.147 Vali Loss: 4.277 Vali Acc: 0.105 Test Loss: 4.277 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.755192995071411
Epoch: 31, Steps: 10 | Train Loss: 0.131 Vali Loss: 4.390 Vali Acc: 0.102 Test Loss: 4.390 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.4020779132843018
Epoch: 32, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.423 Vali Acc: 0.105 Test Loss: 4.423 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3617591857910156
Epoch: 33, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.446 Vali Acc: 0.114 Test Loss: 4.446 Test Acc: 0.114
Validation loss decreased (-0.105840 --> -0.114073).  Saving model ...
Epoch: 34 cost time: 3.1445724964141846
Epoch: 34, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.438 Vali Acc: 0.114 Test Loss: 4.438 Test Acc: 0.114
Validation loss decreased (-0.114073 --> -0.114073).  Saving model ...
Epoch: 35 cost time: 2.8171517848968506
Epoch: 35, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.499 Vali Acc: 0.114 Test Loss: 4.499 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.0372233390808105
Epoch: 36, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.546 Vali Acc: 0.112 Test Loss: 4.546 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.5178287029266357
Epoch: 37, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.577 Vali Acc: 0.113 Test Loss: 4.577 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.552119731903076
Epoch: 38, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.606 Vali Acc: 0.106 Test Loss: 4.606 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.4065022468566895
Epoch: 39, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.638 Vali Acc: 0.119 Test Loss: 4.638 Test Acc: 0.119
Validation loss decreased (-0.114073 --> -0.118777).  Saving model ...
Epoch: 40 cost time: 3.311210870742798
Epoch: 40, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.631 Vali Acc: 0.114 Test Loss: 4.631 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.7004966735839844
Epoch: 41, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.654 Vali Acc: 0.113 Test Loss: 4.654 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.1978793144226074
Epoch: 42, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.670 Vali Acc: 0.114 Test Loss: 4.670 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.9420182704925537
Epoch: 43, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.686 Vali Acc: 0.116 Test Loss: 4.686 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.530198812484741
Epoch: 44, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.711 Vali Acc: 0.120 Test Loss: 4.711 Test Acc: 0.120
Validation loss decreased (-0.118777 --> -0.119953).  Saving model ...
Epoch: 45 cost time: 3.1679229736328125
Epoch: 45, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.790 Vali Acc: 0.121 Test Loss: 4.790 Test Acc: 0.121
Validation loss decreased (-0.119953 --> -0.121129).  Saving model ...
Epoch: 46 cost time: 3.1888926029205322
Epoch: 46, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.803 Vali Acc: 0.122 Test Loss: 4.803 Test Acc: 0.122
Validation loss decreased (-0.121129 --> -0.122305).  Saving model ...
Epoch: 47 cost time: 3.26883864402771
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.790 Vali Acc: 0.122 Test Loss: 4.790 Test Acc: 0.122
Validation loss decreased (-0.122305 --> -0.122305).  Saving model ...
Epoch: 48 cost time: 3.388522148132324
Epoch: 48, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.788 Vali Acc: 0.119 Test Loss: 4.788 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.926271915435791
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.794 Vali Acc: 0.116 Test Loss: 4.794 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.640449285507202
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.799 Vali Acc: 0.118 Test Loss: 4.799 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.2915639877319336
Epoch: 51, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.825 Vali Acc: 0.118 Test Loss: 4.825 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.0511910915374756
Epoch: 52, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.842 Vali Acc: 0.118 Test Loss: 4.842 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.177560806274414
Epoch: 53, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.869 Vali Acc: 0.114 Test Loss: 4.869 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.0569980144500732
Epoch: 54, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.884 Vali Acc: 0.120 Test Loss: 4.884 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.0210065841674805
Epoch: 55, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.903 Vali Acc: 0.122 Test Loss: 4.903 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.3720719814300537
Epoch: 56, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.925 Vali Acc: 0.121 Test Loss: 4.925 Test Acc: 0.121
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.4815993309020996
Epoch: 57, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.943 Vali Acc: 0.118 Test Loss: 4.943 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1223529411764706
model parameter : 267610
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.859684944152832
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 2.977612018585205
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 3.3140878677368164
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 3.331321954727173
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 5 cost time: 3.207191228866577
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 6 cost time: 3.4986729621887207
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 7 cost time: 3.4191482067108154
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 8 cost time: 2.638212203979492
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.037614 --> -0.050556).  Saving model ...
Epoch: 9 cost time: 2.81892991065979
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 10 cost time: 2.9830777645111084
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 11 cost time: 3.2140090465545654
Epoch: 11, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 12 cost time: 3.0786259174346924
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 13 cost time: 3.2288129329681396
Epoch: 13, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 14 cost time: 3.022594451904297
Epoch: 14, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 15 cost time: 3.69761323928833
Epoch: 15, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 16 cost time: 2.9618146419525146
Epoch: 16, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 17 cost time: 3.6600401401519775
Epoch: 17, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 18 cost time: 3.5228896141052246
Epoch: 18, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 19 cost time: 3.3310234546661377
Epoch: 19, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 20 cost time: 3.2780895233154297
Epoch: 20, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 21 cost time: 3.3949432373046875
Epoch: 21, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 22 cost time: 3.171786069869995
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 23 cost time: 3.0695269107818604
Epoch: 23, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 24 cost time: 3.475668430328369
Epoch: 24, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 25 cost time: 3.5382778644561768
Epoch: 25, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 26 cost time: 3.634568214416504
Epoch: 26, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 27 cost time: 3.276244878768921
Epoch: 27, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 28 cost time: 2.859320640563965
Epoch: 28, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 29 cost time: 3.1172332763671875
Epoch: 29, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 30 cost time: 3.0931310653686523
Epoch: 30, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 31 cost time: 3.3799221515655518
Epoch: 31, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 32 cost time: 3.4095845222473145
Epoch: 32, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 33 cost time: 3.244530200958252
Epoch: 33, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 34 cost time: 3.31239652633667
Epoch: 34, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 35 cost time: 3.665825605392456
Epoch: 35, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 36 cost time: 3.2444121837615967
Epoch: 36, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 37 cost time: 3.3782458305358887
Epoch: 37, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 38 cost time: 3.214360475540161
Epoch: 38, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 39 cost time: 3.4286606311798096
Epoch: 39, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 40 cost time: 3.3504204750061035
Epoch: 40, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 41 cost time: 3.588791608810425
Epoch: 41, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 42 cost time: 3.363706111907959
Epoch: 42, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 43 cost time: 3.442551612854004
Epoch: 43, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 44 cost time: 3.407560110092163
Epoch: 44, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.36830735206604
Epoch: 45, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.257 Vali Acc: 0.051 Test Loss: 3.257 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 46 cost time: 2.9667506217956543
Epoch: 46, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.7714033126831055
Epoch: 47, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.1285176277160645
Epoch: 48, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.3373348712921143
Epoch: 49, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.2411046028137207
Epoch: 50, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.480090379714966
Epoch: 51, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.3230535984039307
Epoch: 52, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 3.0396201610565186
Epoch: 53, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 3.3921499252319336
Epoch: 54, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 3.2742135524749756
Epoch: 55, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.05058823529411765
model parameter : 267610
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.012767314910889
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.291 Vali Acc: 0.039 Test Loss: 3.291 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 3.2576658725738525
Epoch: 2, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.260 Vali Acc: 0.061 Test Loss: 3.260 Test Acc: 0.061
Validation loss decreased (-0.038791 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 3.835815668106079
Epoch: 3, Steps: 10 | Train Loss: 3.009 Vali Loss: 3.254 Vali Acc: 0.100 Test Loss: 3.254 Test Acc: 0.100
Validation loss decreased (-0.061144 --> -0.099967).  Saving model ...
Epoch: 4 cost time: 2.9826226234436035
Epoch: 4, Steps: 10 | Train Loss: 2.757 Vali Loss: 3.249 Vali Acc: 0.107 Test Loss: 3.249 Test Acc: 0.107
Validation loss decreased (-0.099967 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 3.2427103519439697
Epoch: 5, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.207 Vali Acc: 0.125 Test Loss: 3.207 Test Acc: 0.125
Validation loss decreased (-0.107026 --> -0.124674).  Saving model ...
Epoch: 6 cost time: 2.949927806854248
Epoch: 6, Steps: 10 | Train Loss: 2.251 Vali Loss: 3.168 Vali Acc: 0.144 Test Loss: 3.168 Test Acc: 0.144
Validation loss decreased (-0.124674 --> -0.143498).  Saving model ...
Epoch: 7 cost time: 2.935868501663208
Epoch: 7, Steps: 10 | Train Loss: 2.005 Vali Loss: 3.134 Vali Acc: 0.172 Test Loss: 3.134 Test Acc: 0.172
Validation loss decreased (-0.143498 --> -0.171733).  Saving model ...
Epoch: 8 cost time: 2.979334592819214
Epoch: 8, Steps: 10 | Train Loss: 1.744 Vali Loss: 3.109 Vali Acc: 0.188 Test Loss: 3.109 Test Acc: 0.188
Validation loss decreased (-0.171733 --> -0.188204).  Saving model ...
Epoch: 9 cost time: 3.2934374809265137
Epoch: 9, Steps: 10 | Train Loss: 1.485 Vali Loss: 3.115 Vali Acc: 0.191 Test Loss: 3.115 Test Acc: 0.191
Validation loss decreased (-0.188204 --> -0.190557).  Saving model ...
Epoch: 10 cost time: 3.658161163330078
Epoch: 10, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.111 Vali Acc: 0.211 Test Loss: 3.111 Test Acc: 0.211
Validation loss decreased (-0.190557 --> -0.210557).  Saving model ...
Epoch: 11 cost time: 3.365384817123413
Epoch: 11, Steps: 10 | Train Loss: 0.974 Vali Loss: 3.112 Vali Acc: 0.232 Test Loss: 3.112 Test Acc: 0.232
Validation loss decreased (-0.210557 --> -0.231734).  Saving model ...
Epoch: 12 cost time: 3.5688185691833496
Epoch: 12, Steps: 10 | Train Loss: 0.831 Vali Loss: 3.154 Vali Acc: 0.227 Test Loss: 3.154 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2852838039398193
Epoch: 13, Steps: 10 | Train Loss: 0.671 Vali Loss: 3.190 Vali Acc: 0.256 Test Loss: 3.190 Test Acc: 0.256
Validation loss decreased (-0.231734 --> -0.256439).  Saving model ...
Epoch: 14 cost time: 3.0617737770080566
Epoch: 14, Steps: 10 | Train Loss: 0.483 Vali Loss: 3.224 Vali Acc: 0.256 Test Loss: 3.224 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3364417552948
Epoch: 15, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.298 Vali Acc: 0.258 Test Loss: 3.298 Test Acc: 0.258
Validation loss decreased (-0.256439 --> -0.257614).  Saving model ...
Epoch: 16 cost time: 3.166808843612671
Epoch: 16, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.322 Vali Acc: 0.271 Test Loss: 3.322 Test Acc: 0.271
Validation loss decreased (-0.257614 --> -0.270555).  Saving model ...
Epoch: 17 cost time: 3.1323611736297607
Epoch: 17, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.407 Vali Acc: 0.266 Test Loss: 3.407 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5491912364959717
Epoch: 18, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.440 Vali Acc: 0.278 Test Loss: 3.440 Test Acc: 0.278
Validation loss decreased (-0.270555 --> -0.277613).  Saving model ...
Epoch: 19 cost time: 3.35921573638916
Epoch: 19, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.473 Vali Acc: 0.275 Test Loss: 3.473 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3443777561187744
Epoch: 20, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.515 Vali Acc: 0.278 Test Loss: 3.515 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.2375760078430176
Epoch: 21, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.547 Vali Acc: 0.286 Test Loss: 3.547 Test Acc: 0.286
Validation loss decreased (-0.277613 --> -0.285847).  Saving model ...
Epoch: 22 cost time: 3.304015636444092
Epoch: 22, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.583 Vali Acc: 0.279 Test Loss: 3.583 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1068077087402344
Epoch: 23, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.605 Vali Acc: 0.288 Test Loss: 3.605 Test Acc: 0.288
Validation loss decreased (-0.285847 --> -0.288199).  Saving model ...
Epoch: 24 cost time: 3.171626329421997
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.625 Vali Acc: 0.294 Test Loss: 3.625 Test Acc: 0.294
Validation loss decreased (-0.288199 --> -0.294081).  Saving model ...
Epoch: 25 cost time: 3.358234167098999
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.640 Vali Acc: 0.295 Test Loss: 3.640 Test Acc: 0.295
Validation loss decreased (-0.294081 --> -0.295258).  Saving model ...
Epoch: 26 cost time: 3.8380649089813232
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.664 Vali Acc: 0.296 Test Loss: 3.664 Test Acc: 0.296
Validation loss decreased (-0.295258 --> -0.296434).  Saving model ...
Epoch: 27 cost time: 3.515739917755127
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.697 Vali Acc: 0.299 Test Loss: 3.697 Test Acc: 0.299
Validation loss decreased (-0.296434 --> -0.298787).  Saving model ...
Epoch: 28 cost time: 3.5345170497894287
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.704 Vali Acc: 0.294 Test Loss: 3.704 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.885354518890381
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.724 Vali Acc: 0.298 Test Loss: 3.724 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.01741099357605
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.742 Vali Acc: 0.292 Test Loss: 3.742 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.137584686279297
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.752 Vali Acc: 0.302 Test Loss: 3.752 Test Acc: 0.302
Validation loss decreased (-0.298787 --> -0.302315).  Saving model ...
Epoch: 32 cost time: 3.241668224334717
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.771 Vali Acc: 0.298 Test Loss: 3.771 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.454545497894287
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.795 Vali Acc: 0.300 Test Loss: 3.795 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.526035785675049
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.817 Vali Acc: 0.302 Test Loss: 3.817 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.1208887100219727
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.834 Vali Acc: 0.301 Test Loss: 3.834 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.3001861572265625
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.846 Vali Acc: 0.300 Test Loss: 3.846 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.1485540866851807
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.860 Vali Acc: 0.298 Test Loss: 3.860 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.2647385597229004
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.876 Vali Acc: 0.300 Test Loss: 3.876 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.176694869995117
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.886 Vali Acc: 0.301 Test Loss: 3.886 Test Acc: 0.301
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.791928291320801
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.903 Vali Acc: 0.301 Test Loss: 3.903 Test Acc: 0.301
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.8755710124969482
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.905 Vali Acc: 0.306 Test Loss: 3.905 Test Acc: 0.306
Validation loss decreased (-0.302315 --> -0.305843).  Saving model ...
Epoch: 42 cost time: 3.3627657890319824
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.919 Vali Acc: 0.305 Test Loss: 3.919 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.3365776538848877
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.930 Vali Acc: 0.306 Test Loss: 3.930 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.2663357257843018
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.944 Vali Acc: 0.306 Test Loss: 3.944 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.512599229812622
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.954 Vali Acc: 0.307 Test Loss: 3.954 Test Acc: 0.307
Validation loss decreased (-0.305843 --> -0.307019).  Saving model ...
Epoch: 46 cost time: 3.526060104370117
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.969 Vali Acc: 0.306 Test Loss: 3.969 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.040144920349121
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.983 Vali Acc: 0.306 Test Loss: 3.983 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.582303524017334
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.991 Vali Acc: 0.307 Test Loss: 3.991 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.319591760635376
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.005 Vali Acc: 0.308 Test Loss: 4.005 Test Acc: 0.308
Validation loss decreased (-0.307019 --> -0.308195).  Saving model ...
Epoch: 50 cost time: 3.406806707382202
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.015 Vali Acc: 0.308 Test Loss: 4.015 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.6223206520080566
Epoch: 51, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.023 Vali Acc: 0.309 Test Loss: 4.023 Test Acc: 0.309
Validation loss decreased (-0.308195 --> -0.309372).  Saving model ...
Epoch: 52 cost time: 3.147404909133911
Epoch: 52, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.029 Vali Acc: 0.307 Test Loss: 4.029 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.9557290077209473
Epoch: 53, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.042 Vali Acc: 0.306 Test Loss: 4.042 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.038722515106201
Epoch: 54, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.052 Vali Acc: 0.307 Test Loss: 4.052 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.5299739837646484
Epoch: 55, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.062 Vali Acc: 0.307 Test Loss: 4.062 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.6307873725891113
Epoch: 56, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.074 Vali Acc: 0.306 Test Loss: 4.074 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.216643810272217
Epoch: 57, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.082 Vali Acc: 0.307 Test Loss: 4.082 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.476146936416626
Epoch: 58, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.094 Vali Acc: 0.307 Test Loss: 4.094 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.3526599407196045
Epoch: 59, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.107 Vali Acc: 0.309 Test Loss: 4.107 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 2.8619496822357178
Epoch: 60, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.109 Vali Acc: 0.307 Test Loss: 4.109 Test Acc: 0.307
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.5099472999572754
Epoch: 61, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.117 Vali Acc: 0.307 Test Loss: 4.117 Test Acc: 0.307
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 218458
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.180162191390991
Epoch: 1, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.303 Vali Acc: 0.045 Test Loss: 3.303 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 3.0626285076141357
Epoch: 2, Steps: 10 | Train Loss: 3.203 Vali Loss: 3.271 Vali Acc: 0.051 Test Loss: 3.271 Test Acc: 0.051
Validation loss decreased (-0.044673 --> -0.050556).  Saving model ...
Epoch: 3 cost time: 2.782177686691284
Epoch: 3, Steps: 10 | Train Loss: 3.015 Vali Loss: 3.264 Vali Acc: 0.073 Test Loss: 3.264 Test Acc: 0.073
Validation loss decreased (-0.050556 --> -0.072909).  Saving model ...
Epoch: 4 cost time: 3.3086800575256348
Epoch: 4, Steps: 10 | Train Loss: 2.761 Vali Loss: 3.261 Vali Acc: 0.088 Test Loss: 3.261 Test Acc: 0.088
Validation loss decreased (-0.072909 --> -0.088203).  Saving model ...
Epoch: 5 cost time: 3.299145221710205
Epoch: 5, Steps: 10 | Train Loss: 2.533 Vali Loss: 3.216 Vali Acc: 0.120 Test Loss: 3.216 Test Acc: 0.120
Validation loss decreased (-0.088203 --> -0.119968).  Saving model ...
Epoch: 6 cost time: 3.3879356384277344
Epoch: 6, Steps: 10 | Train Loss: 2.275 Vali Loss: 3.173 Vali Acc: 0.145 Test Loss: 3.173 Test Acc: 0.145
Validation loss decreased (-0.119968 --> -0.144674).  Saving model ...
Epoch: 7 cost time: 3.12479305267334
Epoch: 7, Steps: 10 | Train Loss: 2.000 Vali Loss: 3.140 Vali Acc: 0.158 Test Loss: 3.140 Test Acc: 0.158
Validation loss decreased (-0.144674 --> -0.157616).  Saving model ...
Epoch: 8 cost time: 2.968905210494995
Epoch: 8, Steps: 10 | Train Loss: 1.750 Vali Loss: 3.114 Vali Acc: 0.184 Test Loss: 3.114 Test Acc: 0.184
Validation loss decreased (-0.157616 --> -0.183498).  Saving model ...
Epoch: 9 cost time: 3.0099635124206543
Epoch: 9, Steps: 10 | Train Loss: 1.486 Vali Loss: 3.115 Vali Acc: 0.204 Test Loss: 3.115 Test Acc: 0.204
Validation loss decreased (-0.183498 --> -0.203498).  Saving model ...
Epoch: 10 cost time: 3.1152689456939697
Epoch: 10, Steps: 10 | Train Loss: 1.201 Vali Loss: 3.111 Vali Acc: 0.231 Test Loss: 3.111 Test Acc: 0.231
Validation loss decreased (-0.203498 --> -0.230557).  Saving model ...
Epoch: 11 cost time: 3.3096492290496826
Epoch: 11, Steps: 10 | Train Loss: 0.992 Vali Loss: 3.117 Vali Acc: 0.236 Test Loss: 3.117 Test Acc: 0.236
Validation loss decreased (-0.230557 --> -0.236439).  Saving model ...
Epoch: 12 cost time: 3.3080296516418457
Epoch: 12, Steps: 10 | Train Loss: 0.828 Vali Loss: 3.164 Vali Acc: 0.246 Test Loss: 3.164 Test Acc: 0.246
Validation loss decreased (-0.236439 --> -0.245851).  Saving model ...
Epoch: 13 cost time: 3.453416109085083
Epoch: 13, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.195 Vali Acc: 0.259 Test Loss: 3.195 Test Acc: 0.259
Validation loss decreased (-0.245851 --> -0.258792).  Saving model ...
Epoch: 14 cost time: 3.663487195968628
Epoch: 14, Steps: 10 | Train Loss: 0.474 Vali Loss: 3.230 Vali Acc: 0.266 Test Loss: 3.230 Test Acc: 0.266
Validation loss decreased (-0.258792 --> -0.265850).  Saving model ...
Epoch: 15 cost time: 3.4760239124298096
Epoch: 15, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.300 Vali Acc: 0.280 Test Loss: 3.300 Test Acc: 0.280
Validation loss decreased (-0.265850 --> -0.279967).  Saving model ...
Epoch: 16 cost time: 3.5200798511505127
Epoch: 16, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.342 Vali Acc: 0.280 Test Loss: 3.342 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2493674755096436
Epoch: 17, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.428 Vali Acc: 0.280 Test Loss: 3.428 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2514731884002686
Epoch: 18, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.458 Vali Acc: 0.293 Test Loss: 3.458 Test Acc: 0.293
Validation loss decreased (-0.279967 --> -0.292907).  Saving model ...
Epoch: 19 cost time: 3.205465078353882
Epoch: 19, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.505 Vali Acc: 0.293 Test Loss: 3.505 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0417070388793945
Epoch: 20, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.544 Vali Acc: 0.292 Test Loss: 3.544 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.340364694595337
Epoch: 21, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.576 Vali Acc: 0.295 Test Loss: 3.576 Test Acc: 0.295
Validation loss decreased (-0.292907 --> -0.295258).  Saving model ...
Epoch: 22 cost time: 3.6435036659240723
Epoch: 22, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.619 Vali Acc: 0.301 Test Loss: 3.619 Test Acc: 0.301
Validation loss decreased (-0.295258 --> -0.301140).  Saving model ...
Epoch: 23 cost time: 3.5530946254730225
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.643 Vali Acc: 0.298 Test Loss: 3.643 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.4346628189086914
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.662 Vali Acc: 0.305 Test Loss: 3.662 Test Acc: 0.305
Validation loss decreased (-0.301140 --> -0.304669).  Saving model ...
Epoch: 25 cost time: 3.275352954864502
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.681 Vali Acc: 0.306 Test Loss: 3.681 Test Acc: 0.306
Validation loss decreased (-0.304669 --> -0.305846).  Saving model ...
Epoch: 26 cost time: 2.8969614505767822
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.710 Vali Acc: 0.302 Test Loss: 3.710 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.9556660652160645
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.742 Vali Acc: 0.301 Test Loss: 3.742 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.4391610622406006
Epoch: 28, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.749 Vali Acc: 0.302 Test Loss: 3.749 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.331366539001465
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.765 Vali Acc: 0.308 Test Loss: 3.765 Test Acc: 0.308
Validation loss decreased (-0.305846 --> -0.308198).  Saving model ...
Epoch: 30 cost time: 3.7304975986480713
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.790 Vali Acc: 0.308 Test Loss: 3.790 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.6940767765045166
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.799 Vali Acc: 0.309 Test Loss: 3.799 Test Acc: 0.309
Validation loss decreased (-0.308198 --> -0.309374).  Saving model ...
Epoch: 32 cost time: 3.2820560932159424
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.820 Vali Acc: 0.312 Test Loss: 3.820 Test Acc: 0.312
Validation loss decreased (-0.309374 --> -0.311727).  Saving model ...
Epoch: 33 cost time: 3.3993711471557617
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.847 Vali Acc: 0.309 Test Loss: 3.847 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.625109910964966
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.870 Vali Acc: 0.308 Test Loss: 3.870 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.609998941421509
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.888 Vali Acc: 0.308 Test Loss: 3.888 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.0762805938720703
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.901 Vali Acc: 0.308 Test Loss: 3.901 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.2634167671203613
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.914 Vali Acc: 0.311 Test Loss: 3.914 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.303767681121826
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.932 Vali Acc: 0.309 Test Loss: 3.932 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.5080630779266357
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.943 Vali Acc: 0.312 Test Loss: 3.943 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.6773581504821777
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.962 Vali Acc: 0.307 Test Loss: 3.962 Test Acc: 0.307
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.1305675506591797
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.969 Vali Acc: 0.313 Test Loss: 3.969 Test Acc: 0.313
Validation loss decreased (-0.311727 --> -0.312901).  Saving model ...
Epoch: 42 cost time: 2.82224440574646
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.988 Vali Acc: 0.311 Test Loss: 3.988 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.937603235244751
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.006 Vali Acc: 0.314 Test Loss: 4.006 Test Acc: 0.314
Validation loss decreased (-0.312901 --> -0.314078).  Saving model ...
Epoch: 44 cost time: 3.3248164653778076
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.025 Vali Acc: 0.314 Test Loss: 4.025 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.1186885833740234
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.037 Vali Acc: 0.313 Test Loss: 4.037 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.301255464553833
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.049 Vali Acc: 0.315 Test Loss: 4.049 Test Acc: 0.315
Validation loss decreased (-0.314078 --> -0.315254).  Saving model ...
Epoch: 47 cost time: 3.2397868633270264
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.059 Vali Acc: 0.313 Test Loss: 4.059 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.3980398178100586
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.066 Vali Acc: 0.313 Test Loss: 4.066 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.775831460952759
Epoch: 49, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.081 Vali Acc: 0.313 Test Loss: 4.081 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.4647891521453857
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.093 Vali Acc: 0.312 Test Loss: 4.093 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.422187566757202
Epoch: 51, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.100 Vali Acc: 0.314 Test Loss: 4.100 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.880985736846924
Epoch: 52, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.105 Vali Acc: 0.314 Test Loss: 4.105 Test Acc: 0.314
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.4980251789093018
Epoch: 53, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.121 Vali Acc: 0.314 Test Loss: 4.121 Test Acc: 0.314
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 3.4964253902435303
Epoch: 54, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.135 Vali Acc: 0.316 Test Loss: 4.135 Test Acc: 0.316
Validation loss decreased (-0.315254 --> -0.316429).  Saving model ...
Epoch: 55 cost time: 3.284881591796875
Epoch: 55, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.146 Vali Acc: 0.315 Test Loss: 4.146 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.474998950958252
Epoch: 56, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.159 Vali Acc: 0.314 Test Loss: 4.159 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.5178382396698
Epoch: 57, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.172 Vali Acc: 0.312 Test Loss: 4.172 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.556318998336792
Epoch: 58, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.184 Vali Acc: 0.311 Test Loss: 4.184 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.2853622436523438
Epoch: 59, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.194 Vali Acc: 0.312 Test Loss: 4.194 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.0694499015808105
Epoch: 60, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.198 Vali Acc: 0.312 Test Loss: 4.198 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.131434440612793
Epoch: 61, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.204 Vali Acc: 0.314 Test Loss: 4.204 Test Acc: 0.314
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.9481780529022217
Epoch: 62, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.219 Vali Acc: 0.313 Test Loss: 4.219 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 4.13882303237915
Epoch: 63, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.231 Vali Acc: 0.312 Test Loss: 4.231 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.549198865890503
Epoch: 64, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.238 Vali Acc: 0.312 Test Loss: 4.238 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 218458
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.484037160873413
Epoch: 1, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.287 Vali Acc: 0.038 Test Loss: 3.287 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 3.3644638061523438
Epoch: 2, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.248 Vali Acc: 0.051 Test Loss: 3.248 Test Acc: 0.051
Validation loss decreased (-0.037614 --> -0.050556).  Saving model ...
Epoch: 3 cost time: 3.3881497383117676
Epoch: 3, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.236 Vali Acc: 0.095 Test Loss: 3.236 Test Acc: 0.095
Validation loss decreased (-0.050556 --> -0.095262).  Saving model ...
Epoch: 4 cost time: 3.171937942504883
Epoch: 4, Steps: 10 | Train Loss: 2.735 Vali Loss: 3.232 Vali Acc: 0.112 Test Loss: 3.232 Test Acc: 0.112
Validation loss decreased (-0.095262 --> -0.111732).  Saving model ...
Epoch: 5 cost time: 3.032792568206787
Epoch: 5, Steps: 10 | Train Loss: 2.523 Vali Loss: 3.197 Vali Acc: 0.116 Test Loss: 3.197 Test Acc: 0.116
Validation loss decreased (-0.111732 --> -0.116439).  Saving model ...
Epoch: 6 cost time: 3.1887412071228027
Epoch: 6, Steps: 10 | Train Loss: 2.259 Vali Loss: 3.165 Vali Acc: 0.148 Test Loss: 3.165 Test Acc: 0.148
Validation loss decreased (-0.116439 --> -0.148204).  Saving model ...
Epoch: 7 cost time: 3.458869695663452
Epoch: 7, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.140 Vali Acc: 0.156 Test Loss: 3.140 Test Acc: 0.156
Validation loss decreased (-0.148204 --> -0.156439).  Saving model ...
Epoch: 8 cost time: 3.3214046955108643
Epoch: 8, Steps: 10 | Train Loss: 1.763 Vali Loss: 3.126 Vali Acc: 0.192 Test Loss: 3.126 Test Acc: 0.192
Validation loss decreased (-0.156439 --> -0.191733).  Saving model ...
Epoch: 9 cost time: 3.1264047622680664
Epoch: 9, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.139 Vali Acc: 0.206 Test Loss: 3.139 Test Acc: 0.206
Validation loss decreased (-0.191733 --> -0.205851).  Saving model ...
Epoch: 10 cost time: 3.2520365715026855
Epoch: 10, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.141 Vali Acc: 0.227 Test Loss: 3.141 Test Acc: 0.227
Validation loss decreased (-0.205851 --> -0.227027).  Saving model ...
Epoch: 11 cost time: 3.293442487716675
Epoch: 11, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.148 Vali Acc: 0.238 Test Loss: 3.148 Test Acc: 0.238
Validation loss decreased (-0.227027 --> -0.237616).  Saving model ...
Epoch: 12 cost time: 3.3015856742858887
Epoch: 12, Steps: 10 | Train Loss: 0.929 Vali Loss: 3.194 Vali Acc: 0.248 Test Loss: 3.194 Test Acc: 0.248
Validation loss decreased (-0.237616 --> -0.248203).  Saving model ...
Epoch: 13 cost time: 3.5202505588531494
Epoch: 13, Steps: 10 | Train Loss: 0.792 Vali Loss: 3.217 Vali Acc: 0.271 Test Loss: 3.217 Test Acc: 0.271
Validation loss decreased (-0.248203 --> -0.270556).  Saving model ...
Epoch: 14 cost time: 3.652076482772827
Epoch: 14, Steps: 10 | Train Loss: 0.572 Vali Loss: 3.250 Vali Acc: 0.268 Test Loss: 3.250 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.417775869369507
Epoch: 15, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.321 Vali Acc: 0.271 Test Loss: 3.321 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.522454261779785
Epoch: 16, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.346 Vali Acc: 0.288 Test Loss: 3.346 Test Acc: 0.288
Validation loss decreased (-0.270556 --> -0.288202).  Saving model ...
Epoch: 17 cost time: 3.6560580730438232
Epoch: 17, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.447 Vali Acc: 0.278 Test Loss: 3.447 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0289087295532227
Epoch: 18, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.476 Vali Acc: 0.288 Test Loss: 3.476 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.164717197418213
Epoch: 19, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.530 Vali Acc: 0.298 Test Loss: 3.530 Test Acc: 0.298
Validation loss decreased (-0.288202 --> -0.297612).  Saving model ...
Epoch: 20 cost time: 2.9621026515960693
Epoch: 20, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.560 Vali Acc: 0.298 Test Loss: 3.560 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.388624906539917
Epoch: 21, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.597 Vali Acc: 0.292 Test Loss: 3.597 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3580617904663086
Epoch: 22, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.655 Vali Acc: 0.293 Test Loss: 3.655 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.210003614425659
Epoch: 23, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.677 Vali Acc: 0.296 Test Loss: 3.677 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.3207640647888184
Epoch: 24, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.696 Vali Acc: 0.302 Test Loss: 3.696 Test Acc: 0.302
Validation loss decreased (-0.297612 --> -0.302316).  Saving model ...
Epoch: 25 cost time: 3.208927631378174
Epoch: 25, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.711 Vali Acc: 0.302 Test Loss: 3.711 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2638168334960938
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.750 Vali Acc: 0.299 Test Loss: 3.750 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.294275999069214
Epoch: 27, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.779 Vali Acc: 0.300 Test Loss: 3.779 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.0576114654541016
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.786 Vali Acc: 0.299 Test Loss: 3.786 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.1164519786834717
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.817 Vali Acc: 0.294 Test Loss: 3.817 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.2647879123687744
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.846 Vali Acc: 0.296 Test Loss: 3.846 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.261779546737671
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.848 Vali Acc: 0.300 Test Loss: 3.848 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.4339370727539062
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.867 Vali Acc: 0.302 Test Loss: 3.867 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.286012887954712
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.897 Vali Acc: 0.300 Test Loss: 3.897 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.0998809337615967
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.922 Vali Acc: 0.300 Test Loss: 3.922 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 218458
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.661073684692383
Epoch: 1, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.277 Vali Acc: 0.054 Test Loss: 3.277 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 3.1628613471984863
Epoch: 2, Steps: 10 | Train Loss: 3.205 Vali Loss: 3.254 Vali Acc: 0.072 Test Loss: 3.254 Test Acc: 0.072
Validation loss decreased (-0.054085 --> -0.071732).  Saving model ...
Epoch: 3 cost time: 3.452716588973999
Epoch: 3, Steps: 10 | Train Loss: 3.010 Vali Loss: 3.255 Vali Acc: 0.104 Test Loss: 3.255 Test Acc: 0.104
Validation loss decreased (-0.071732 --> -0.103497).  Saving model ...
Epoch: 4 cost time: 3.3494725227355957
Epoch: 4, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.266 Vali Acc: 0.116 Test Loss: 3.266 Test Acc: 0.116
Validation loss decreased (-0.103497 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 3.622744083404541
Epoch: 5, Steps: 10 | Train Loss: 2.574 Vali Loss: 3.248 Vali Acc: 0.119 Test Loss: 3.248 Test Acc: 0.119
Validation loss decreased (-0.116438 --> -0.118791).  Saving model ...
Epoch: 6 cost time: 3.4567065238952637
Epoch: 6, Steps: 10 | Train Loss: 2.321 Vali Loss: 3.234 Vali Acc: 0.131 Test Loss: 3.234 Test Acc: 0.131
Validation loss decreased (-0.118791 --> -0.130556).  Saving model ...
Epoch: 7 cost time: 3.054278612136841
Epoch: 7, Steps: 10 | Train Loss: 2.090 Vali Loss: 3.223 Vali Acc: 0.138 Test Loss: 3.223 Test Acc: 0.138
Validation loss decreased (-0.130556 --> -0.137615).  Saving model ...
Epoch: 8 cost time: 3.457437515258789
Epoch: 8, Steps: 10 | Train Loss: 1.852 Vali Loss: 3.229 Vali Acc: 0.152 Test Loss: 3.229 Test Acc: 0.152
Validation loss decreased (-0.137615 --> -0.151732).  Saving model ...
Epoch: 9 cost time: 3.365813732147217
Epoch: 9, Steps: 10 | Train Loss: 1.630 Vali Loss: 3.267 Vali Acc: 0.152 Test Loss: 3.267 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.050318956375122
Epoch: 10, Steps: 10 | Train Loss: 1.396 Vali Loss: 3.292 Vali Acc: 0.173 Test Loss: 3.292 Test Acc: 0.173
Validation loss decreased (-0.151732 --> -0.172908).  Saving model ...
Epoch: 11 cost time: 3.311349630355835
Epoch: 11, Steps: 10 | Train Loss: 1.180 Vali Loss: 3.311 Vali Acc: 0.181 Test Loss: 3.311 Test Acc: 0.181
Validation loss decreased (-0.172908 --> -0.181143).  Saving model ...
Epoch: 12 cost time: 3.8425426483154297
Epoch: 12, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.369 Vali Acc: 0.181 Test Loss: 3.369 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2408194541931152
Epoch: 13, Steps: 10 | Train Loss: 0.881 Vali Loss: 3.425 Vali Acc: 0.196 Test Loss: 3.425 Test Acc: 0.196
Validation loss decreased (-0.181143 --> -0.196436).  Saving model ...
Epoch: 14 cost time: 3.0932421684265137
Epoch: 14, Steps: 10 | Train Loss: 0.690 Vali Loss: 3.473 Vali Acc: 0.202 Test Loss: 3.473 Test Acc: 0.202
Validation loss decreased (-0.196436 --> -0.202318).  Saving model ...
Epoch: 15 cost time: 3.5024259090423584
Epoch: 15, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.562 Vali Acc: 0.211 Test Loss: 3.562 Test Acc: 0.211
Validation loss decreased (-0.202318 --> -0.210553).  Saving model ...
Epoch: 16 cost time: 3.4312310218811035
Epoch: 16, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.594 Vali Acc: 0.221 Test Loss: 3.594 Test Acc: 0.221
Validation loss decreased (-0.210553 --> -0.221141).  Saving model ...
Epoch: 17 cost time: 3.1606993675231934
Epoch: 17, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.726 Vali Acc: 0.202 Test Loss: 3.726 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.522073745727539
Epoch: 18, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.764 Vali Acc: 0.229 Test Loss: 3.764 Test Acc: 0.229
Validation loss decreased (-0.221141 --> -0.229374).  Saving model ...
Epoch: 19 cost time: 3.169992446899414
Epoch: 19, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.833 Vali Acc: 0.233 Test Loss: 3.833 Test Acc: 0.233
Validation loss decreased (-0.229374 --> -0.232903).  Saving model ...
Epoch: 20 cost time: 3.6868667602539062
Epoch: 20, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.900 Vali Acc: 0.221 Test Loss: 3.900 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4217283725738525
Epoch: 21, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.941 Vali Acc: 0.222 Test Loss: 3.941 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.325222969055176
Epoch: 22, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.993 Vali Acc: 0.234 Test Loss: 3.993 Test Acc: 0.234
Validation loss decreased (-0.232903 --> -0.234078).  Saving model ...
Epoch: 23 cost time: 3.5604774951934814
Epoch: 23, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.072 Vali Acc: 0.229 Test Loss: 4.072 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9324402809143066
Epoch: 24, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.084 Vali Acc: 0.234 Test Loss: 4.084 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.045529365539551
Epoch: 25, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.097 Vali Acc: 0.236 Test Loss: 4.097 Test Acc: 0.236
Validation loss decreased (-0.234078 --> -0.236430).  Saving model ...
Epoch: 26 cost time: 2.89695405960083
Epoch: 26, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.145 Vali Acc: 0.239 Test Loss: 4.145 Test Acc: 0.239
Validation loss decreased (-0.236430 --> -0.238782).  Saving model ...
Epoch: 27 cost time: 3.15380859375
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.206 Vali Acc: 0.235 Test Loss: 4.206 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.1500377655029297
Epoch: 28, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.221 Vali Acc: 0.239 Test Loss: 4.221 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0334439277648926
Epoch: 29, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.255 Vali Acc: 0.241 Test Loss: 4.255 Test Acc: 0.241
Validation loss decreased (-0.238782 --> -0.241134).  Saving model ...
Epoch: 30 cost time: 3.7389700412750244
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.285 Vali Acc: 0.240 Test Loss: 4.285 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.032022476196289
Epoch: 31, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.302 Vali Acc: 0.239 Test Loss: 4.302 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.527637481689453
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.331 Vali Acc: 0.240 Test Loss: 4.331 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.250474452972412
Epoch: 33, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.360 Vali Acc: 0.242 Test Loss: 4.360 Test Acc: 0.242
Validation loss decreased (-0.241134 --> -0.242309).  Saving model ...
Epoch: 34 cost time: 3.303563356399536
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.379 Vali Acc: 0.242 Test Loss: 4.379 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.2590744495391846
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.404 Vali Acc: 0.247 Test Loss: 4.404 Test Acc: 0.247
Validation loss decreased (-0.242309 --> -0.247015).  Saving model ...
Epoch: 36 cost time: 3.391423463821411
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.416 Vali Acc: 0.245 Test Loss: 4.416 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.59248948097229
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.441 Vali Acc: 0.244 Test Loss: 4.441 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.375864267349243
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.466 Vali Acc: 0.247 Test Loss: 4.466 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.4884490966796875
Epoch: 39, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.477 Vali Acc: 0.245 Test Loss: 4.477 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.311819076538086
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.502 Vali Acc: 0.248 Test Loss: 4.502 Test Acc: 0.248
Validation loss decreased (-0.247015 --> -0.248190).  Saving model ...
Epoch: 41 cost time: 3.225297212600708
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.509 Vali Acc: 0.251 Test Loss: 4.509 Test Acc: 0.251
Validation loss decreased (-0.248190 --> -0.250543).  Saving model ...
Epoch: 42 cost time: 3.5762779712677
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.526 Vali Acc: 0.248 Test Loss: 4.526 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.2192223072052
Epoch: 43, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.541 Vali Acc: 0.249 Test Loss: 4.541 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.1851296424865723
Epoch: 44, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.564 Vali Acc: 0.252 Test Loss: 4.564 Test Acc: 0.252
Validation loss decreased (-0.250543 --> -0.251719).  Saving model ...
Epoch: 45 cost time: 3.385406017303467
Epoch: 45, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.572 Vali Acc: 0.251 Test Loss: 4.572 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.8114101886749268
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.586 Vali Acc: 0.251 Test Loss: 4.586 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.379394769668579
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.605 Vali Acc: 0.255 Test Loss: 4.605 Test Acc: 0.255
Validation loss decreased (-0.251719 --> -0.255248).  Saving model ...
Epoch: 48 cost time: 2.924299478530884
Epoch: 48, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.620 Vali Acc: 0.253 Test Loss: 4.620 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.208059549331665
Epoch: 49, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.640 Vali Acc: 0.252 Test Loss: 4.640 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.4480514526367188
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.659 Vali Acc: 0.251 Test Loss: 4.659 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.53017258644104
Epoch: 51, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.671 Vali Acc: 0.248 Test Loss: 4.671 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.963747024536133
Epoch: 52, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.672 Vali Acc: 0.249 Test Loss: 4.672 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.7846763134002686
Epoch: 53, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.687 Vali Acc: 0.252 Test Loss: 4.687 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.564330577850342
Epoch: 54, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.700 Vali Acc: 0.256 Test Loss: 4.700 Test Acc: 0.256
Validation loss decreased (-0.255248 --> -0.256424).  Saving model ...
Epoch: 55 cost time: 3.1584389209747314
Epoch: 55, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.716 Vali Acc: 0.260 Test Loss: 4.716 Test Acc: 0.260
Validation loss decreased (-0.256424 --> -0.259953).  Saving model ...
Epoch: 56 cost time: 3.206664562225342
Epoch: 56, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.731 Vali Acc: 0.261 Test Loss: 4.731 Test Acc: 0.261
Validation loss decreased (-0.259953 --> -0.261129).  Saving model ...
Epoch: 57 cost time: 3.3686234951019287
Epoch: 57, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.743 Vali Acc: 0.262 Test Loss: 4.743 Test Acc: 0.262
Validation loss decreased (-0.261129 --> -0.262306).  Saving model ...
Epoch: 58 cost time: 3.73582124710083
Epoch: 58, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.763 Vali Acc: 0.261 Test Loss: 4.763 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.3851404190063477
Epoch: 59, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.780 Vali Acc: 0.261 Test Loss: 4.780 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 3.3962748050689697
Epoch: 60, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.778 Vali Acc: 0.265 Test Loss: 4.778 Test Acc: 0.265
Validation loss decreased (-0.262306 --> -0.264658).  Saving model ...
Epoch: 61 cost time: 3.662719488143921
Epoch: 61, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.784 Vali Acc: 0.261 Test Loss: 4.784 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.0391526222229004
Epoch: 62, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.800 Vali Acc: 0.260 Test Loss: 4.800 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 3.103888988494873
Epoch: 63, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.812 Vali Acc: 0.262 Test Loss: 4.812 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 3.3342177867889404
Epoch: 64, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.822 Vali Acc: 0.261 Test Loss: 4.822 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 3.3373589515686035
Epoch: 65, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.829 Vali Acc: 0.262 Test Loss: 4.829 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 3.3505425453186035
Epoch: 66, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.841 Vali Acc: 0.261 Test Loss: 4.841 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 3.617685079574585
Epoch: 67, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.853 Vali Acc: 0.261 Test Loss: 4.853 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 3.3274850845336914
Epoch: 68, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.867 Vali Acc: 0.261 Test Loss: 4.867 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 3.091531753540039
Epoch: 69, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.876 Vali Acc: 0.261 Test Loss: 4.876 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 3.2921464443206787
Epoch: 70, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.887 Vali Acc: 0.260 Test Loss: 4.887 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 218458
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.868394374847412
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.306 Vali Acc: 0.040 Test Loss: 3.306 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.1417031288146973
Epoch: 2, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.300 Vali Acc: 0.041 Test Loss: 3.300 Test Acc: 0.041
Validation loss decreased (-0.039967 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 2.884087085723877
Epoch: 3, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.316 Vali Acc: 0.053 Test Loss: 3.316 Test Acc: 0.053
Validation loss decreased (-0.041143 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 3.008653163909912
Epoch: 4, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.342 Vali Acc: 0.058 Test Loss: 3.342 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 3.423844337463379
Epoch: 5, Steps: 10 | Train Loss: 2.732 Vali Loss: 3.337 Vali Acc: 0.069 Test Loss: 3.337 Test Acc: 0.069
Validation loss decreased (-0.057614 --> -0.069378).  Saving model ...
Epoch: 6 cost time: 3.250887393951416
Epoch: 6, Steps: 10 | Train Loss: 2.518 Vali Loss: 3.332 Vali Acc: 0.074 Test Loss: 3.332 Test Acc: 0.074
Validation loss decreased (-0.069378 --> -0.074084).  Saving model ...
Epoch: 7 cost time: 2.8121047019958496
Epoch: 7, Steps: 10 | Train Loss: 2.307 Vali Loss: 3.329 Vali Acc: 0.082 Test Loss: 3.329 Test Acc: 0.082
Validation loss decreased (-0.074084 --> -0.082320).  Saving model ...
Epoch: 8 cost time: 2.901784658432007
Epoch: 8, Steps: 10 | Train Loss: 2.056 Vali Loss: 3.331 Vali Acc: 0.091 Test Loss: 3.331 Test Acc: 0.091
Validation loss decreased (-0.082320 --> -0.090555).  Saving model ...
Epoch: 9 cost time: 3.4600272178649902
Epoch: 9, Steps: 10 | Train Loss: 1.810 Vali Loss: 3.358 Vali Acc: 0.096 Test Loss: 3.358 Test Acc: 0.096
Validation loss decreased (-0.090555 --> -0.096437).  Saving model ...
Epoch: 10 cost time: 3.125739336013794
Epoch: 10, Steps: 10 | Train Loss: 1.526 Vali Loss: 3.390 Vali Acc: 0.106 Test Loss: 3.390 Test Acc: 0.106
Validation loss decreased (-0.096437 --> -0.105848).  Saving model ...
Epoch: 11 cost time: 3.301396608352661
Epoch: 11, Steps: 10 | Train Loss: 1.325 Vali Loss: 3.420 Vali Acc: 0.113 Test Loss: 3.420 Test Acc: 0.113
Validation loss decreased (-0.105848 --> -0.112907).  Saving model ...
Epoch: 12 cost time: 3.685515880584717
Epoch: 12, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.491 Vali Acc: 0.118 Test Loss: 3.491 Test Acc: 0.118
Validation loss decreased (-0.112907 --> -0.117612).  Saving model ...
Epoch: 13 cost time: 3.59561824798584
Epoch: 13, Steps: 10 | Train Loss: 0.935 Vali Loss: 3.564 Vali Acc: 0.118 Test Loss: 3.564 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.396361827850342
Epoch: 14, Steps: 10 | Train Loss: 0.713 Vali Loss: 3.619 Vali Acc: 0.115 Test Loss: 3.619 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.470425844192505
Epoch: 15, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.730 Vali Acc: 0.112 Test Loss: 3.730 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.703512668609619
Epoch: 16, Steps: 10 | Train Loss: 0.463 Vali Loss: 3.786 Vali Acc: 0.122 Test Loss: 3.786 Test Acc: 0.122
Validation loss decreased (-0.117612 --> -0.122315).  Saving model ...
Epoch: 17 cost time: 3.055460214614868
Epoch: 17, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.915 Vali Acc: 0.109 Test Loss: 3.915 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0916824340820312
Epoch: 18, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.984 Vali Acc: 0.129 Test Loss: 3.984 Test Acc: 0.129
Validation loss decreased (-0.122315 --> -0.129372).  Saving model ...
Epoch: 19 cost time: 3.650620222091675
Epoch: 19, Steps: 10 | Train Loss: 0.168 Vali Loss: 4.062 Vali Acc: 0.136 Test Loss: 4.062 Test Acc: 0.136
Validation loss decreased (-0.129372 --> -0.136430).  Saving model ...
Epoch: 20 cost time: 3.49983286857605
Epoch: 20, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.137 Vali Acc: 0.133 Test Loss: 4.137 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3819472789764404
Epoch: 21, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.170 Vali Acc: 0.131 Test Loss: 4.170 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.5460565090179443
Epoch: 22, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.230 Vali Acc: 0.131 Test Loss: 4.230 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.913245916366577
Epoch: 23, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.276 Vali Acc: 0.138 Test Loss: 4.276 Test Acc: 0.138
Validation loss decreased (-0.136430 --> -0.137604).  Saving model ...
Epoch: 24 cost time: 3.07852840423584
Epoch: 24, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.306 Vali Acc: 0.141 Test Loss: 4.306 Test Acc: 0.141
Validation loss decreased (-0.137604 --> -0.141133).  Saving model ...
Epoch: 25 cost time: 3.4791574478149414
Epoch: 25, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.341 Vali Acc: 0.142 Test Loss: 4.341 Test Acc: 0.142
Validation loss decreased (-0.141133 --> -0.142310).  Saving model ...
Epoch: 26 cost time: 3.4039883613586426
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.383 Vali Acc: 0.142 Test Loss: 4.383 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.821183681488037
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.409 Vali Acc: 0.144 Test Loss: 4.409 Test Acc: 0.144
Validation loss decreased (-0.142310 --> -0.143485).  Saving model ...
Epoch: 28 cost time: 3.053036689758301
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.424 Vali Acc: 0.142 Test Loss: 4.424 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9683456420898438
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.464 Vali Acc: 0.142 Test Loss: 4.464 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.160629987716675
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.494 Vali Acc: 0.140 Test Loss: 4.494 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.2029736042022705
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.497 Vali Acc: 0.141 Test Loss: 4.497 Test Acc: 0.141
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.934985876083374
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.521 Vali Acc: 0.142 Test Loss: 4.521 Test Acc: 0.142
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.3759546279907227
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.553 Vali Acc: 0.144 Test Loss: 4.553 Test Acc: 0.144
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.1400907039642334
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.579 Vali Acc: 0.146 Test Loss: 4.579 Test Acc: 0.146
Validation loss decreased (-0.143485 --> -0.145837).  Saving model ...
Epoch: 35 cost time: 2.677725315093994
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.608 Vali Acc: 0.147 Test Loss: 4.608 Test Acc: 0.147
Validation loss decreased (-0.145837 --> -0.147013).  Saving model ...
Epoch: 36 cost time: 3.3127939701080322
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.626 Vali Acc: 0.147 Test Loss: 4.626 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.451864004135132
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.649 Vali Acc: 0.147 Test Loss: 4.649 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.1632704734802246
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.672 Vali Acc: 0.148 Test Loss: 4.672 Test Acc: 0.148
Validation loss decreased (-0.147013 --> -0.148189).  Saving model ...
Epoch: 39 cost time: 3.244187116622925
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.680 Vali Acc: 0.146 Test Loss: 4.680 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.1986243724823
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.710 Vali Acc: 0.147 Test Loss: 4.710 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.063331365585327
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.726 Vali Acc: 0.148 Test Loss: 4.726 Test Acc: 0.148
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.752837657928467
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.739 Vali Acc: 0.148 Test Loss: 4.739 Test Acc: 0.148
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.2116897106170654
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.740 Vali Acc: 0.142 Test Loss: 4.740 Test Acc: 0.142
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.960508346557617
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.751 Vali Acc: 0.144 Test Loss: 4.751 Test Acc: 0.144
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.0718166828155518
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.761 Vali Acc: 0.144 Test Loss: 4.761 Test Acc: 0.144
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.337303876876831
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.776 Vali Acc: 0.145 Test Loss: 4.776 Test Acc: 0.145
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.1060729026794434
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.797 Vali Acc: 0.148 Test Loss: 4.797 Test Acc: 0.148
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.158064603805542
Epoch: 48, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.820 Vali Acc: 0.148 Test Loss: 4.820 Test Acc: 0.148
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.14823529411764705
model parameter : 218458
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.187029838562012
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.334 Vali Acc: 0.022 Test Loss: 3.334 Test Acc: 0.022
Validation loss decreased (inf --> -0.022320).  Saving model ...
Epoch: 2 cost time: 3.1488797664642334
Epoch: 2, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.326 Vali Acc: 0.039 Test Loss: 3.326 Test Acc: 0.039
Validation loss decreased (-0.022320 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 3.302943229675293
Epoch: 3, Steps: 10 | Train Loss: 3.126 Vali Loss: 3.336 Vali Acc: 0.045 Test Loss: 3.336 Test Acc: 0.045
Validation loss decreased (-0.038790 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 3.1488375663757324
Epoch: 4, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.358 Vali Acc: 0.044 Test Loss: 3.358 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.520005702972412
Epoch: 5, Steps: 10 | Train Loss: 2.862 Vali Loss: 3.361 Vali Acc: 0.045 Test Loss: 3.361 Test Acc: 0.045
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7538821697235107
Epoch: 6, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.362 Vali Acc: 0.059 Test Loss: 3.362 Test Acc: 0.059
Validation loss decreased (-0.044673 --> -0.058790).  Saving model ...
Epoch: 7 cost time: 3.509671211242676
Epoch: 7, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.355 Vali Acc: 0.061 Test Loss: 3.355 Test Acc: 0.061
Validation loss decreased (-0.058790 --> -0.061143).  Saving model ...
Epoch: 8 cost time: 3.8023569583892822
Epoch: 8, Steps: 10 | Train Loss: 2.339 Vali Loss: 3.353 Vali Acc: 0.060 Test Loss: 3.353 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.320483684539795
Epoch: 9, Steps: 10 | Train Loss: 2.154 Vali Loss: 3.366 Vali Acc: 0.066 Test Loss: 3.366 Test Acc: 0.066
Validation loss decreased (-0.061143 --> -0.065849).  Saving model ...
Epoch: 10 cost time: 3.244398832321167
Epoch: 10, Steps: 10 | Train Loss: 1.933 Vali Loss: 3.377 Vali Acc: 0.085 Test Loss: 3.377 Test Acc: 0.085
Validation loss decreased (-0.065849 --> -0.084672).  Saving model ...
Epoch: 11 cost time: 3.528301477432251
Epoch: 11, Steps: 10 | Train Loss: 1.739 Vali Loss: 3.395 Vali Acc: 0.086 Test Loss: 3.395 Test Acc: 0.086
Validation loss decreased (-0.084672 --> -0.085848).  Saving model ...
Epoch: 12 cost time: 3.4886181354522705
Epoch: 12, Steps: 10 | Train Loss: 1.560 Vali Loss: 3.440 Vali Acc: 0.078 Test Loss: 3.440 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.565429925918579
Epoch: 13, Steps: 10 | Train Loss: 1.362 Vali Loss: 3.494 Vali Acc: 0.085 Test Loss: 3.494 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.680105686187744
Epoch: 14, Steps: 10 | Train Loss: 1.075 Vali Loss: 3.523 Vali Acc: 0.085 Test Loss: 3.523 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.4250876903533936
Epoch: 15, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.603 Vali Acc: 0.093 Test Loss: 3.603 Test Acc: 0.093
Validation loss decreased (-0.085848 --> -0.092905).  Saving model ...
Epoch: 16 cost time: 3.291452169418335
Epoch: 16, Steps: 10 | Train Loss: 0.753 Vali Loss: 3.649 Vali Acc: 0.098 Test Loss: 3.649 Test Acc: 0.098
Validation loss decreased (-0.092905 --> -0.097611).  Saving model ...
Epoch: 17 cost time: 3.725022077560425
Epoch: 17, Steps: 10 | Train Loss: 0.634 Vali Loss: 3.763 Vali Acc: 0.098 Test Loss: 3.763 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.006903886795044
Epoch: 18, Steps: 10 | Train Loss: 0.457 Vali Loss: 3.818 Vali Acc: 0.105 Test Loss: 3.818 Test Acc: 0.105
Validation loss decreased (-0.097611 --> -0.104668).  Saving model ...
Epoch: 19 cost time: 3.6891636848449707
Epoch: 19, Steps: 10 | Train Loss: 0.328 Vali Loss: 3.924 Vali Acc: 0.105 Test Loss: 3.924 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6952462196350098
Epoch: 20, Steps: 10 | Train Loss: 0.242 Vali Loss: 4.006 Vali Acc: 0.095 Test Loss: 4.006 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.240753412246704
Epoch: 21, Steps: 10 | Train Loss: 0.182 Vali Loss: 4.087 Vali Acc: 0.111 Test Loss: 4.087 Test Acc: 0.111
Validation loss decreased (-0.104668 --> -0.110547).  Saving model ...
Epoch: 22 cost time: 3.456346273422241
Epoch: 22, Steps: 10 | Train Loss: 0.141 Vali Loss: 4.233 Vali Acc: 0.101 Test Loss: 4.233 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.40061354637146
Epoch: 23, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.251 Vali Acc: 0.100 Test Loss: 4.251 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.9773268699645996
Epoch: 24, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.274 Vali Acc: 0.114 Test Loss: 4.274 Test Acc: 0.114
Validation loss decreased (-0.110547 --> -0.114075).  Saving model ...
Epoch: 25 cost time: 3.4718058109283447
Epoch: 25, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.328 Vali Acc: 0.113 Test Loss: 4.328 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.173280715942383
Epoch: 26, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.407 Vali Acc: 0.108 Test Loss: 4.407 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.9516451358795166
Epoch: 27, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.442 Vali Acc: 0.108 Test Loss: 4.442 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.454566717147827
Epoch: 28, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.461 Vali Acc: 0.107 Test Loss: 4.461 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.538572072982788
Epoch: 29, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.497 Vali Acc: 0.109 Test Loss: 4.497 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.753371000289917
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.550 Vali Acc: 0.108 Test Loss: 4.550 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.3936588764190674
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.575 Vali Acc: 0.111 Test Loss: 4.575 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.7036705017089844
Epoch: 32, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.604 Vali Acc: 0.114 Test Loss: 4.604 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.0399250984191895
Epoch: 33, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.634 Vali Acc: 0.107 Test Loss: 4.634 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.3198623657226562
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.644 Vali Acc: 0.109 Test Loss: 4.644 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.11411764705882353
model parameter : 218458
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.868638753890991
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.343 Vali Acc: 0.031 Test Loss: 3.343 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 3.53727388381958
Epoch: 2, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.347 Vali Acc: 0.038 Test Loss: 3.347 Test Acc: 0.038
Validation loss decreased (-0.030555 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 3.0400595664978027
Epoch: 3, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.365 Vali Acc: 0.038 Test Loss: 3.365 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.652622938156128
Epoch: 4, Steps: 10 | Train Loss: 3.073 Vali Loss: 3.388 Vali Acc: 0.042 Test Loss: 3.388 Test Acc: 0.042
Validation loss decreased (-0.037614 --> -0.042319).  Saving model ...
Epoch: 5 cost time: 3.3649892807006836
Epoch: 5, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.394 Vali Acc: 0.044 Test Loss: 3.394 Test Acc: 0.044
Validation loss decreased (-0.042319 --> -0.043495).  Saving model ...
Epoch: 6 cost time: 2.957108974456787
Epoch: 6, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.409 Vali Acc: 0.049 Test Loss: 3.409 Test Acc: 0.049
Validation loss decreased (-0.043495 --> -0.049378).  Saving model ...
Epoch: 7 cost time: 3.442598581314087
Epoch: 7, Steps: 10 | Train Loss: 2.777 Vali Loss: 3.402 Vali Acc: 0.051 Test Loss: 3.402 Test Acc: 0.051
Validation loss decreased (-0.049378 --> -0.050554).  Saving model ...
Epoch: 8 cost time: 3.1366195678710938
Epoch: 8, Steps: 10 | Train Loss: 2.603 Vali Loss: 3.396 Vali Acc: 0.051 Test Loss: 3.396 Test Acc: 0.051
Validation loss decreased (-0.050554 --> -0.050554).  Saving model ...
Epoch: 9 cost time: 3.670295000076294
Epoch: 9, Steps: 10 | Train Loss: 2.504 Vali Loss: 3.397 Vali Acc: 0.061 Test Loss: 3.397 Test Acc: 0.061
Validation loss decreased (-0.050554 --> -0.061143).  Saving model ...
Epoch: 10 cost time: 3.4236574172973633
Epoch: 10, Steps: 10 | Train Loss: 2.291 Vali Loss: 3.401 Vali Acc: 0.065 Test Loss: 3.401 Test Acc: 0.065
Validation loss decreased (-0.061143 --> -0.064672).  Saving model ...
Epoch: 11 cost time: 3.5895116329193115
Epoch: 11, Steps: 10 | Train Loss: 2.185 Vali Loss: 3.397 Vali Acc: 0.072 Test Loss: 3.397 Test Acc: 0.072
Validation loss decreased (-0.064672 --> -0.071731).  Saving model ...
Epoch: 12 cost time: 3.7153890132904053
Epoch: 12, Steps: 10 | Train Loss: 2.036 Vali Loss: 3.426 Vali Acc: 0.074 Test Loss: 3.426 Test Acc: 0.074
Validation loss decreased (-0.071731 --> -0.074083).  Saving model ...
Epoch: 13 cost time: 3.3694136142730713
Epoch: 13, Steps: 10 | Train Loss: 1.808 Vali Loss: 3.458 Vali Acc: 0.078 Test Loss: 3.458 Test Acc: 0.078
Validation loss decreased (-0.074083 --> -0.077612).  Saving model ...
Epoch: 14 cost time: 3.712099313735962
Epoch: 14, Steps: 10 | Train Loss: 1.608 Vali Loss: 3.458 Vali Acc: 0.084 Test Loss: 3.458 Test Acc: 0.084
Validation loss decreased (-0.077612 --> -0.083495).  Saving model ...
Epoch: 15 cost time: 3.3223748207092285
Epoch: 15, Steps: 10 | Train Loss: 1.437 Vali Loss: 3.503 Vali Acc: 0.082 Test Loss: 3.503 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.56819486618042
Epoch: 16, Steps: 10 | Train Loss: 1.264 Vali Loss: 3.538 Vali Acc: 0.081 Test Loss: 3.538 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4158968925476074
Epoch: 17, Steps: 10 | Train Loss: 1.130 Vali Loss: 3.592 Vali Acc: 0.093 Test Loss: 3.592 Test Acc: 0.093
Validation loss decreased (-0.083495 --> -0.092905).  Saving model ...
Epoch: 18 cost time: 3.5337767601013184
Epoch: 18, Steps: 10 | Train Loss: 0.906 Vali Loss: 3.638 Vali Acc: 0.096 Test Loss: 3.638 Test Acc: 0.096
Validation loss decreased (-0.092905 --> -0.096434).  Saving model ...
Epoch: 19 cost time: 3.868964910507202
Epoch: 19, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.737 Vali Acc: 0.089 Test Loss: 3.737 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.38157320022583
Epoch: 20, Steps: 10 | Train Loss: 0.581 Vali Loss: 3.805 Vali Acc: 0.079 Test Loss: 3.805 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.7225348949432373
Epoch: 21, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.867 Vali Acc: 0.091 Test Loss: 3.867 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2817914485931396
Epoch: 22, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.987 Vali Acc: 0.087 Test Loss: 3.987 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4617068767547607
Epoch: 23, Steps: 10 | Train Loss: 0.250 Vali Loss: 4.106 Vali Acc: 0.085 Test Loss: 4.106 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.128283977508545
Epoch: 24, Steps: 10 | Train Loss: 0.229 Vali Loss: 4.207 Vali Acc: 0.098 Test Loss: 4.207 Test Acc: 0.098
Validation loss decreased (-0.096434 --> -0.097605).  Saving model ...
Epoch: 25 cost time: 3.03898549079895
Epoch: 25, Steps: 10 | Train Loss: 0.157 Vali Loss: 4.284 Vali Acc: 0.098 Test Loss: 4.284 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.974088430404663
Epoch: 26, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.363 Vali Acc: 0.096 Test Loss: 4.363 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.844001054763794
Epoch: 27, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.378 Vali Acc: 0.106 Test Loss: 4.378 Test Acc: 0.106
Validation loss decreased (-0.097605 --> -0.105839).  Saving model ...
Epoch: 28 cost time: 3.052401065826416
Epoch: 28, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.402 Vali Acc: 0.105 Test Loss: 4.402 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.617921829223633
Epoch: 29, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.460 Vali Acc: 0.100 Test Loss: 4.460 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.371213436126709
Epoch: 30, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.508 Vali Acc: 0.104 Test Loss: 4.508 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.4743335247039795
Epoch: 31, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.531 Vali Acc: 0.104 Test Loss: 4.531 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.2815487384796143
Epoch: 32, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.572 Vali Acc: 0.108 Test Loss: 4.572 Test Acc: 0.108
Validation loss decreased (-0.105839 --> -0.108190).  Saving model ...
Epoch: 33 cost time: 3.1180922985076904
Epoch: 33, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.628 Vali Acc: 0.104 Test Loss: 4.628 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.202852249145508
Epoch: 34, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.662 Vali Acc: 0.102 Test Loss: 4.662 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.1976118087768555
Epoch: 35, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.717 Vali Acc: 0.105 Test Loss: 4.717 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.7058849334716797
Epoch: 36, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.759 Vali Acc: 0.104 Test Loss: 4.759 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.2525475025177
Epoch: 37, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.741 Vali Acc: 0.108 Test Loss: 4.741 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.7467849254608154
Epoch: 38, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.749 Vali Acc: 0.108 Test Loss: 4.749 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.510751962661743
Epoch: 39, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.767 Vali Acc: 0.105 Test Loss: 4.767 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.5222458839416504
Epoch: 40, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.801 Vali Acc: 0.107 Test Loss: 4.801 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.128481864929199
Epoch: 41, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.830 Vali Acc: 0.104 Test Loss: 4.830 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.5529568195343018
Epoch: 42, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.860 Vali Acc: 0.109 Test Loss: 4.860 Test Acc: 0.109
Validation loss decreased (-0.108190 --> -0.109363).  Saving model ...
Epoch: 43 cost time: 3.0478100776672363
Epoch: 43, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.879 Vali Acc: 0.109 Test Loss: 4.879 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.3025918006896973
Epoch: 44, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.904 Vali Acc: 0.107 Test Loss: 4.904 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.4270119667053223
Epoch: 45, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.896 Vali Acc: 0.111 Test Loss: 4.896 Test Acc: 0.111
Validation loss decreased (-0.109363 --> -0.110539).  Saving model ...
Epoch: 46 cost time: 3.139444351196289
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.917 Vali Acc: 0.109 Test Loss: 4.917 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.7227602005004883
Epoch: 47, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.946 Vali Acc: 0.107 Test Loss: 4.946 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.9596669673919678
Epoch: 48, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.950 Vali Acc: 0.109 Test Loss: 4.950 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.290457248687744
Epoch: 49, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.956 Vali Acc: 0.107 Test Loss: 4.956 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.201763153076172
Epoch: 50, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.978 Vali Acc: 0.104 Test Loss: 4.978 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.4462058544158936
Epoch: 51, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.000 Vali Acc: 0.104 Test Loss: 5.000 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.8582284450531006
Epoch: 52, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.030 Vali Acc: 0.112 Test Loss: 5.030 Test Acc: 0.112
Validation loss decreased (-0.110539 --> -0.111714).  Saving model ...
Epoch: 53 cost time: 3.1540188789367676
Epoch: 53, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.062 Vali Acc: 0.112 Test Loss: 5.062 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.498837471008301
Epoch: 54, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.077 Vali Acc: 0.107 Test Loss: 5.077 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.030367851257324
Epoch: 55, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.090 Vali Acc: 0.108 Test Loss: 5.090 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.0321624279022217
Epoch: 56, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.099 Vali Acc: 0.108 Test Loss: 5.099 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.06606125831604
Epoch: 57, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.106 Vali Acc: 0.107 Test Loss: 5.106 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.9444382190704346
Epoch: 58, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.120 Vali Acc: 0.107 Test Loss: 5.120 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.048819065093994
Epoch: 59, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.133 Vali Acc: 0.106 Test Loss: 5.133 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 3.0825929641723633
Epoch: 60, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.143 Vali Acc: 0.108 Test Loss: 5.143 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 3.5906355381011963
Epoch: 61, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.153 Vali Acc: 0.108 Test Loss: 5.153 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 3.2805747985839844
Epoch: 62, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.180 Vali Acc: 0.111 Test Loss: 5.180 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.11176470588235295
model parameter : 218458
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.2961931228637695
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.354 Vali Acc: 0.042 Test Loss: 3.354 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 3.0799825191497803
Epoch: 2, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.360 Vali Acc: 0.047 Test Loss: 3.360 Test Acc: 0.047
Validation loss decreased (-0.042319 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 3.237178325653076
Epoch: 3, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.380 Vali Acc: 0.049 Test Loss: 3.380 Test Acc: 0.049
Validation loss decreased (-0.047025 --> -0.049378).  Saving model ...
Epoch: 4 cost time: 3.395944356918335
Epoch: 4, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.405 Vali Acc: 0.044 Test Loss: 3.405 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.004803419113159
Epoch: 5, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.416 Vali Acc: 0.047 Test Loss: 3.416 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4492809772491455
Epoch: 6, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.426 Vali Acc: 0.046 Test Loss: 3.426 Test Acc: 0.046
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0683929920196533
Epoch: 7, Steps: 10 | Train Loss: 2.904 Vali Loss: 3.417 Vali Acc: 0.045 Test Loss: 3.417 Test Acc: 0.045
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.09149432182312
Epoch: 8, Steps: 10 | Train Loss: 2.797 Vali Loss: 3.409 Vali Acc: 0.049 Test Loss: 3.409 Test Acc: 0.049
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.140092372894287
Epoch: 9, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.411 Vali Acc: 0.055 Test Loss: 3.411 Test Acc: 0.055
Validation loss decreased (-0.049378 --> -0.055260).  Saving model ...
Epoch: 10 cost time: 2.7839150428771973
Epoch: 10, Steps: 10 | Train Loss: 2.536 Vali Loss: 3.408 Vali Acc: 0.056 Test Loss: 3.408 Test Acc: 0.056
Validation loss decreased (-0.055260 --> -0.056437).  Saving model ...
Epoch: 11 cost time: 3.240137815475464
Epoch: 11, Steps: 10 | Train Loss: 2.439 Vali Loss: 3.383 Vali Acc: 0.051 Test Loss: 3.383 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4513137340545654
Epoch: 12, Steps: 10 | Train Loss: 2.375 Vali Loss: 3.400 Vali Acc: 0.066 Test Loss: 3.400 Test Acc: 0.066
Validation loss decreased (-0.056437 --> -0.065848).  Saving model ...
Epoch: 13 cost time: 2.811765670776367
Epoch: 13, Steps: 10 | Train Loss: 2.194 Vali Loss: 3.415 Vali Acc: 0.061 Test Loss: 3.415 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0522589683532715
Epoch: 14, Steps: 10 | Train Loss: 1.999 Vali Loss: 3.407 Vali Acc: 0.061 Test Loss: 3.407 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4034626483917236
Epoch: 15, Steps: 10 | Train Loss: 1.781 Vali Loss: 3.442 Vali Acc: 0.066 Test Loss: 3.442 Test Acc: 0.066
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3095076084136963
Epoch: 16, Steps: 10 | Train Loss: 1.632 Vali Loss: 3.469 Vali Acc: 0.066 Test Loss: 3.469 Test Acc: 0.066
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.614469528198242
Epoch: 17, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.509 Vali Acc: 0.072 Test Loss: 3.509 Test Acc: 0.072
Validation loss decreased (-0.065848 --> -0.071730).  Saving model ...
Epoch: 18 cost time: 3.5885202884674072
Epoch: 18, Steps: 10 | Train Loss: 1.266 Vali Loss: 3.530 Vali Acc: 0.080 Test Loss: 3.530 Test Acc: 0.080
Validation loss decreased (-0.071730 --> -0.079965).  Saving model ...
Epoch: 19 cost time: 3.195692300796509
Epoch: 19, Steps: 10 | Train Loss: 1.035 Vali Loss: 3.591 Vali Acc: 0.068 Test Loss: 3.591 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0226731300354004
Epoch: 20, Steps: 10 | Train Loss: 0.910 Vali Loss: 3.658 Vali Acc: 0.075 Test Loss: 3.658 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.2226338386535645
Epoch: 21, Steps: 10 | Train Loss: 0.760 Vali Loss: 3.742 Vali Acc: 0.082 Test Loss: 3.742 Test Acc: 0.082
Validation loss decreased (-0.079965 --> -0.082316).  Saving model ...
Epoch: 22 cost time: 3.0764076709747314
Epoch: 22, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.842 Vali Acc: 0.078 Test Loss: 3.842 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3266518115997314
Epoch: 23, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.946 Vali Acc: 0.088 Test Loss: 3.946 Test Acc: 0.088
Validation loss decreased (-0.082316 --> -0.088196).  Saving model ...
Epoch: 24 cost time: 3.598038911819458
Epoch: 24, Steps: 10 | Train Loss: 0.390 Vali Loss: 4.003 Vali Acc: 0.087 Test Loss: 4.003 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6182243824005127
Epoch: 25, Steps: 10 | Train Loss: 0.292 Vali Loss: 4.072 Vali Acc: 0.082 Test Loss: 4.072 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.1334478855133057
Epoch: 26, Steps: 10 | Train Loss: 0.235 Vali Loss: 4.178 Vali Acc: 0.081 Test Loss: 4.178 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.1888272762298584
Epoch: 27, Steps: 10 | Train Loss: 0.196 Vali Loss: 4.221 Vali Acc: 0.092 Test Loss: 4.221 Test Acc: 0.092
Validation loss decreased (-0.088196 --> -0.091722).  Saving model ...
Epoch: 28 cost time: 2.8274199962615967
Epoch: 28, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.269 Vali Acc: 0.096 Test Loss: 4.269 Test Acc: 0.096
Validation loss decreased (-0.091722 --> -0.096428).  Saving model ...
Epoch: 29 cost time: 2.787212371826172
Epoch: 29, Steps: 10 | Train Loss: 0.114 Vali Loss: 4.364 Vali Acc: 0.094 Test Loss: 4.364 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4971752166748047
Epoch: 30, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.418 Vali Acc: 0.099 Test Loss: 4.418 Test Acc: 0.099
Validation loss decreased (-0.096428 --> -0.098779).  Saving model ...
Epoch: 31 cost time: 3.4001247882843018
Epoch: 31, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.426 Vali Acc: 0.101 Test Loss: 4.426 Test Acc: 0.101
Validation loss decreased (-0.098779 --> -0.101132).  Saving model ...
Epoch: 32 cost time: 3.3872530460357666
Epoch: 32, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.468 Vali Acc: 0.104 Test Loss: 4.468 Test Acc: 0.104
Validation loss decreased (-0.101132 --> -0.103485).  Saving model ...
Epoch: 33 cost time: 3.2499215602874756
Epoch: 33, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.537 Vali Acc: 0.098 Test Loss: 4.537 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.009308099746704
Epoch: 34, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.563 Vali Acc: 0.105 Test Loss: 4.563 Test Acc: 0.105
Validation loss decreased (-0.103485 --> -0.104660).  Saving model ...
Epoch: 35 cost time: 2.968456268310547
Epoch: 35, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.588 Vali Acc: 0.102 Test Loss: 4.588 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.263146162033081
Epoch: 36, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.635 Vali Acc: 0.105 Test Loss: 4.635 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.2734625339508057
Epoch: 37, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.641 Vali Acc: 0.102 Test Loss: 4.641 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.274866819381714
Epoch: 38, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.671 Vali Acc: 0.105 Test Loss: 4.671 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.3001205921173096
Epoch: 39, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.692 Vali Acc: 0.107 Test Loss: 4.692 Test Acc: 0.107
Validation loss decreased (-0.104660 --> -0.107012).  Saving model ...
Epoch: 40 cost time: 3.457331418991089
Epoch: 40, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.726 Vali Acc: 0.104 Test Loss: 4.726 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.0745325088500977
Epoch: 41, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.739 Vali Acc: 0.102 Test Loss: 4.739 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.4137766361236572
Epoch: 42, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.767 Vali Acc: 0.106 Test Loss: 4.767 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.6346282958984375
Epoch: 43, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.802 Vali Acc: 0.101 Test Loss: 4.802 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.5403199195861816
Epoch: 44, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.806 Vali Acc: 0.105 Test Loss: 4.806 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.3744289875030518
Epoch: 45, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.815 Vali Acc: 0.107 Test Loss: 4.815 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.2288591861724854
Epoch: 46, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.841 Vali Acc: 0.102 Test Loss: 4.841 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.5815951824188232
Epoch: 47, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.868 Vali Acc: 0.106 Test Loss: 4.868 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.2993783950805664
Epoch: 48, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.862 Vali Acc: 0.105 Test Loss: 4.862 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.1865012645721436
Epoch: 49, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.881 Vali Acc: 0.106 Test Loss: 4.881 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.10705882352941176
model parameter : 218458
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.309460878372192
Epoch: 1, Steps: 10 | Train Loss: 3.384 Vali Loss: 3.311 Vali Acc: 0.040 Test Loss: 3.311 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.299856662750244
Epoch: 2, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.313 Vali Acc: 0.046 Test Loss: 3.313 Test Acc: 0.046
Validation loss decreased (-0.039967 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 3.2073378562927246
Epoch: 3, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.334 Vali Acc: 0.042 Test Loss: 3.334 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.24509334564209
Epoch: 4, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.360 Vali Acc: 0.054 Test Loss: 3.360 Test Acc: 0.054
Validation loss decreased (-0.045849 --> -0.054084).  Saving model ...
Epoch: 5 cost time: 3.3065226078033447
Epoch: 5, Steps: 10 | Train Loss: 3.110 Vali Loss: 3.377 Vali Acc: 0.053 Test Loss: 3.377 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2919909954071045
Epoch: 6, Steps: 10 | Train Loss: 3.026 Vali Loss: 3.391 Vali Acc: 0.053 Test Loss: 3.391 Test Acc: 0.053
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4279990196228027
Epoch: 7, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.387 Vali Acc: 0.062 Test Loss: 3.387 Test Acc: 0.062
Validation loss decreased (-0.054084 --> -0.062319).  Saving model ...
Epoch: 8 cost time: 3.1890952587127686
Epoch: 8, Steps: 10 | Train Loss: 2.855 Vali Loss: 3.380 Vali Acc: 0.067 Test Loss: 3.380 Test Acc: 0.067
Validation loss decreased (-0.062319 --> -0.067025).  Saving model ...
Epoch: 9 cost time: 3.3873136043548584
Epoch: 9, Steps: 10 | Train Loss: 2.767 Vali Loss: 3.385 Vali Acc: 0.068 Test Loss: 3.385 Test Acc: 0.068
Validation loss decreased (-0.067025 --> -0.068201).  Saving model ...
Epoch: 10 cost time: 3.2183949947357178
Epoch: 10, Steps: 10 | Train Loss: 2.662 Vali Loss: 3.381 Vali Acc: 0.075 Test Loss: 3.381 Test Acc: 0.075
Validation loss decreased (-0.068201 --> -0.075260).  Saving model ...
Epoch: 11 cost time: 3.277275323867798
Epoch: 11, Steps: 10 | Train Loss: 2.610 Vali Loss: 3.368 Vali Acc: 0.076 Test Loss: 3.368 Test Acc: 0.076
Validation loss decreased (-0.075260 --> -0.076437).  Saving model ...
Epoch: 12 cost time: 3.7496931552886963
Epoch: 12, Steps: 10 | Train Loss: 2.501 Vali Loss: 3.382 Vali Acc: 0.078 Test Loss: 3.382 Test Acc: 0.078
Validation loss decreased (-0.076437 --> -0.077613).  Saving model ...
Epoch: 13 cost time: 3.527740478515625
Epoch: 13, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.407 Vali Acc: 0.069 Test Loss: 3.407 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.447399377822876
Epoch: 14, Steps: 10 | Train Loss: 2.227 Vali Loss: 3.405 Vali Acc: 0.066 Test Loss: 3.405 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.537447214126587
Epoch: 15, Steps: 10 | Train Loss: 2.105 Vali Loss: 3.443 Vali Acc: 0.069 Test Loss: 3.443 Test Acc: 0.069
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.455953598022461
Epoch: 16, Steps: 10 | Train Loss: 1.938 Vali Loss: 3.474 Vali Acc: 0.066 Test Loss: 3.474 Test Acc: 0.066
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.719616413116455
Epoch: 17, Steps: 10 | Train Loss: 1.818 Vali Loss: 3.546 Vali Acc: 0.061 Test Loss: 3.546 Test Acc: 0.061
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.8931713104248047
Epoch: 18, Steps: 10 | Train Loss: 1.605 Vali Loss: 3.587 Vali Acc: 0.062 Test Loss: 3.587 Test Acc: 0.062
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.787182331085205
Epoch: 19, Steps: 10 | Train Loss: 1.482 Vali Loss: 3.646 Vali Acc: 0.064 Test Loss: 3.646 Test Acc: 0.064
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.271432638168335
Epoch: 20, Steps: 10 | Train Loss: 1.236 Vali Loss: 3.697 Vali Acc: 0.062 Test Loss: 3.697 Test Acc: 0.062
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.1539700031280518
Epoch: 21, Steps: 10 | Train Loss: 1.118 Vali Loss: 3.796 Vali Acc: 0.067 Test Loss: 3.796 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.3508107662200928
Epoch: 22, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.893 Vali Acc: 0.061 Test Loss: 3.893 Test Acc: 0.061
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.07764705882352942
model parameter : 218458
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.558229684829712
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 3.424821615219116
Epoch: 2, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 3.3644471168518066
Epoch: 3, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 3.29823637008667
Epoch: 4, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 5 cost time: 3.5573408603668213
Epoch: 5, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 6 cost time: 3.3637707233428955
Epoch: 6, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 7 cost time: 3.1088802814483643
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 8 cost time: 3.045926332473755
Epoch: 8, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 9 cost time: 3.3356001377105713
Epoch: 9, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 10 cost time: 3.6986117362976074
Epoch: 10, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 11 cost time: 3.551048755645752
Epoch: 11, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 12 cost time: 3.018853187561035
Epoch: 12, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 13 cost time: 3.5124502182006836
Epoch: 13, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 14 cost time: 3.4832637310028076
Epoch: 14, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 15 cost time: 3.465769052505493
Epoch: 15, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 16 cost time: 3.3601174354553223
Epoch: 16, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 17 cost time: 2.9810307025909424
Epoch: 17, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 18 cost time: 3.1078073978424072
Epoch: 18, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 19 cost time: 3.007824659347534
Epoch: 19, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 20 cost time: 3.506751298904419
Epoch: 20, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 21 cost time: 3.6233887672424316
Epoch: 21, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 22 cost time: 3.1684443950653076
Epoch: 22, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 23 cost time: 3.0922751426696777
Epoch: 23, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 24 cost time: 3.4021055698394775
Epoch: 24, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 25 cost time: 3.098151206970215
Epoch: 25, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 26 cost time: 2.885110855102539
Epoch: 26, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 27 cost time: 3.4283394813537598
Epoch: 27, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 28 cost time: 3.5878987312316895
Epoch: 28, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 29 cost time: 3.425497531890869
Epoch: 29, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 30 cost time: 3.267855405807495
Epoch: 30, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 31 cost time: 3.466885805130005
Epoch: 31, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 32 cost time: 3.184267997741699
Epoch: 32, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 33 cost time: 3.255608320236206
Epoch: 33, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 34 cost time: 3.4934284687042236
Epoch: 34, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 35 cost time: 3.367403268814087
Epoch: 35, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 36 cost time: 3.428065299987793
Epoch: 36, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 37 cost time: 3.271343231201172
Epoch: 37, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.3642261028289795
Epoch: 38, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.4918360710144043
Epoch: 39, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.032090187072754
Epoch: 40, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.9274702072143555
Epoch: 41, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 42 cost time: 2.5878570079803467
Epoch: 42, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.995734214782715
Epoch: 43, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.116703987121582
Epoch: 44, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.309851884841919
Epoch: 45, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.0372800827026367
Epoch: 46, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.257 Vali Acc: 0.038 Test Loss: 3.257 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.1070637702941895
Epoch: 47, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.8361284732818604
Epoch: 48, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.1310741901397705
Epoch: 49, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.177568197250366
Epoch: 50, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.4876060485839844
Epoch: 51, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.258 Vali Acc: 0.038 Test Loss: 3.258 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.03764705882352941
model parameter : 218458
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         76                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.666478157043457
Epoch: 1, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.319 Vali Acc: 0.044 Test Loss: 3.319 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 3.3706247806549072
Epoch: 2, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.284 Vali Acc: 0.049 Test Loss: 3.284 Test Acc: 0.049
Validation loss decreased (-0.043496 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 3.431429624557495
Epoch: 3, Steps: 10 | Train Loss: 2.965 Vali Loss: 3.264 Vali Acc: 0.087 Test Loss: 3.264 Test Acc: 0.087
Validation loss decreased (-0.049379 --> -0.087026).  Saving model ...
Epoch: 4 cost time: 3.202284097671509
Epoch: 4, Steps: 10 | Train Loss: 2.719 Vali Loss: 3.244 Vali Acc: 0.108 Test Loss: 3.244 Test Acc: 0.108
Validation loss decreased (-0.087026 --> -0.108203).  Saving model ...
Epoch: 5 cost time: 3.095701217651367
Epoch: 5, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.218 Vali Acc: 0.134 Test Loss: 3.218 Test Acc: 0.134
Validation loss decreased (-0.108203 --> -0.134085).  Saving model ...
Epoch: 6 cost time: 2.95065975189209
Epoch: 6, Steps: 10 | Train Loss: 2.225 Vali Loss: 3.168 Vali Acc: 0.147 Test Loss: 3.168 Test Acc: 0.147
Validation loss decreased (-0.134085 --> -0.147027).  Saving model ...
Epoch: 7 cost time: 2.9089338779449463
Epoch: 7, Steps: 10 | Train Loss: 1.996 Vali Loss: 3.133 Vali Acc: 0.173 Test Loss: 3.133 Test Acc: 0.173
Validation loss decreased (-0.147027 --> -0.172910).  Saving model ...
Epoch: 8 cost time: 3.2173523902893066
Epoch: 8, Steps: 10 | Train Loss: 1.763 Vali Loss: 3.120 Vali Acc: 0.180 Test Loss: 3.120 Test Acc: 0.180
Validation loss decreased (-0.172910 --> -0.179969).  Saving model ...
Epoch: 9 cost time: 3.4007222652435303
Epoch: 9, Steps: 10 | Train Loss: 1.500 Vali Loss: 3.125 Vali Acc: 0.198 Test Loss: 3.125 Test Acc: 0.198
Validation loss decreased (-0.179969 --> -0.197616).  Saving model ...
Epoch: 10 cost time: 3.399374485015869
Epoch: 10, Steps: 10 | Train Loss: 1.251 Vali Loss: 3.112 Vali Acc: 0.206 Test Loss: 3.112 Test Acc: 0.206
Validation loss decreased (-0.197616 --> -0.205851).  Saving model ...
Epoch: 11 cost time: 3.326789617538452
Epoch: 11, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.108 Vali Acc: 0.216 Test Loss: 3.108 Test Acc: 0.216
Validation loss decreased (-0.205851 --> -0.216440).  Saving model ...
Epoch: 12 cost time: 2.835996150970459
Epoch: 12, Steps: 10 | Train Loss: 0.849 Vali Loss: 3.156 Vali Acc: 0.220 Test Loss: 3.156 Test Acc: 0.220
Validation loss decreased (-0.216440 --> -0.219968).  Saving model ...
Epoch: 13 cost time: 2.6977927684783936
Epoch: 13, Steps: 10 | Train Loss: 0.661 Vali Loss: 3.201 Vali Acc: 0.228 Test Loss: 3.201 Test Acc: 0.228
Validation loss decreased (-0.219968 --> -0.228203).  Saving model ...
Epoch: 14 cost time: 3.451559066772461
Epoch: 14, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.220 Vali Acc: 0.245 Test Loss: 3.220 Test Acc: 0.245
Validation loss decreased (-0.228203 --> -0.244674).  Saving model ...
Epoch: 15 cost time: 3.2144620418548584
Epoch: 15, Steps: 10 | Train Loss: 0.411 Vali Loss: 3.276 Vali Acc: 0.242 Test Loss: 3.276 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2577011585235596
Epoch: 16, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.318 Vali Acc: 0.247 Test Loss: 3.318 Test Acc: 0.247
Validation loss decreased (-0.244674 --> -0.247026).  Saving model ...
Epoch: 17 cost time: 3.033709764480591
Epoch: 17, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.372 Vali Acc: 0.266 Test Loss: 3.372 Test Acc: 0.266
Validation loss decreased (-0.247026 --> -0.265849).  Saving model ...
Epoch: 18 cost time: 3.3592309951782227
Epoch: 18, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.406 Vali Acc: 0.276 Test Loss: 3.406 Test Acc: 0.276
Validation loss decreased (-0.265849 --> -0.276437).  Saving model ...
Epoch: 19 cost time: 3.390583038330078
Epoch: 19, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.456 Vali Acc: 0.268 Test Loss: 3.456 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.598097085952759
Epoch: 20, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.497 Vali Acc: 0.274 Test Loss: 3.497 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.35671329498291
Epoch: 21, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.504 Vali Acc: 0.276 Test Loss: 3.504 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.4759299755096436
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.537 Vali Acc: 0.280 Test Loss: 3.537 Test Acc: 0.280
Validation loss decreased (-0.276437 --> -0.279965).  Saving model ...
Epoch: 23 cost time: 3.1439802646636963
Epoch: 23, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.588 Vali Acc: 0.281 Test Loss: 3.588 Test Acc: 0.281
Validation loss decreased (-0.279965 --> -0.281141).  Saving model ...
Epoch: 24 cost time: 3.2185699939727783
Epoch: 24, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.602 Vali Acc: 0.280 Test Loss: 3.602 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4595770835876465
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.626 Vali Acc: 0.286 Test Loss: 3.626 Test Acc: 0.286
Validation loss decreased (-0.281141 --> -0.285846).  Saving model ...
Epoch: 26 cost time: 3.630072593688965
Epoch: 26, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.652 Vali Acc: 0.284 Test Loss: 3.652 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3895628452301025
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.684 Vali Acc: 0.286 Test Loss: 3.684 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.3086915016174316
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.697 Vali Acc: 0.288 Test Loss: 3.697 Test Acc: 0.288
Validation loss decreased (-0.285846 --> -0.288198).  Saving model ...
Epoch: 29 cost time: 3.567899465560913
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.728 Vali Acc: 0.293 Test Loss: 3.728 Test Acc: 0.293
Validation loss decreased (-0.288198 --> -0.292904).  Saving model ...
Epoch: 30 cost time: 3.3476521968841553
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.749 Vali Acc: 0.298 Test Loss: 3.749 Test Acc: 0.298
Validation loss decreased (-0.292904 --> -0.297610).  Saving model ...
Epoch: 31 cost time: 3.408710479736328
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.762 Vali Acc: 0.300 Test Loss: 3.762 Test Acc: 0.300
Validation loss decreased (-0.297610 --> -0.299962).  Saving model ...
Epoch: 32 cost time: 3.290409564971924
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.782 Vali Acc: 0.295 Test Loss: 3.782 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.853297233581543
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.802 Vali Acc: 0.296 Test Loss: 3.802 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.303673505783081
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.819 Vali Acc: 0.298 Test Loss: 3.819 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.2984323501586914
Epoch: 35, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.838 Vali Acc: 0.299 Test Loss: 3.838 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.115628242492676
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.860 Vali Acc: 0.299 Test Loss: 3.860 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.2343215942382812
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.871 Vali Acc: 0.304 Test Loss: 3.871 Test Acc: 0.304
Validation loss decreased (-0.299962 --> -0.303491).  Saving model ...
Epoch: 38 cost time: 3.283764123916626
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.890 Vali Acc: 0.302 Test Loss: 3.890 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.8661515712738037
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.904 Vali Acc: 0.302 Test Loss: 3.904 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.318650245666504
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.909 Vali Acc: 0.300 Test Loss: 3.909 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.3755972385406494
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.922 Vali Acc: 0.302 Test Loss: 3.922 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.6469430923461914
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.943 Vali Acc: 0.298 Test Loss: 3.943 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.7306735515594482
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.955 Vali Acc: 0.298 Test Loss: 3.955 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.233875274658203
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.967 Vali Acc: 0.299 Test Loss: 3.967 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.196904420852661
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.978 Vali Acc: 0.301 Test Loss: 3.978 Test Acc: 0.301
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.3128387928009033
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.990 Vali Acc: 0.305 Test Loss: 3.990 Test Acc: 0.305
Validation loss decreased (-0.303491 --> -0.304666).  Saving model ...
Epoch: 47 cost time: 3.4540343284606934
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.994 Vali Acc: 0.302 Test Loss: 3.994 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.2224478721618652
Epoch: 48, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.009 Vali Acc: 0.304 Test Loss: 4.009 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.169422149658203
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.026 Vali Acc: 0.305 Test Loss: 4.026 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.3117504119873047
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.041 Vali Acc: 0.307 Test Loss: 4.041 Test Acc: 0.307
Validation loss decreased (-0.304666 --> -0.307018).  Saving model ...
Epoch: 51 cost time: 3.7214508056640625
Epoch: 51, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.057 Vali Acc: 0.308 Test Loss: 4.057 Test Acc: 0.308
Validation loss decreased (-0.307018 --> -0.308195).  Saving model ...
Epoch: 52 cost time: 3.727177381515503
Epoch: 52, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.074 Vali Acc: 0.309 Test Loss: 4.074 Test Acc: 0.309
Validation loss decreased (-0.308195 --> -0.309371).  Saving model ...
Epoch: 53 cost time: 2.9837806224823
Epoch: 53, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.084 Vali Acc: 0.308 Test Loss: 4.084 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.2993059158325195
Epoch: 54, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.093 Vali Acc: 0.312 Test Loss: 4.093 Test Acc: 0.312
Validation loss decreased (-0.309371 --> -0.311724).  Saving model ...
Epoch: 55 cost time: 2.798088312149048
Epoch: 55, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.099 Vali Acc: 0.309 Test Loss: 4.099 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.45383620262146
Epoch: 56, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.108 Vali Acc: 0.311 Test Loss: 4.108 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.4559526443481445
Epoch: 57, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.115 Vali Acc: 0.312 Test Loss: 4.115 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.608492374420166
Epoch: 58, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.123 Vali Acc: 0.311 Test Loss: 4.123 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.2030768394470215
Epoch: 59, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.133 Vali Acc: 0.306 Test Loss: 4.133 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.3603086471557617
Epoch: 60, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.145 Vali Acc: 0.306 Test Loss: 4.145 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.593714952468872
Epoch: 61, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.154 Vali Acc: 0.308 Test Loss: 4.154 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.9801924228668213
Epoch: 62, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.168 Vali Acc: 0.309 Test Loss: 4.168 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.2921957969665527
Epoch: 63, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.177 Vali Acc: 0.311 Test Loss: 4.177 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.001375198364258
Epoch: 64, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.186 Vali Acc: 0.309 Test Loss: 4.186 Test Acc: 0.309
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 193882
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         61                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.7920520305633545
Epoch: 1, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.334 Vali Acc: 0.044 Test Loss: 3.334 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 2.9861209392547607
Epoch: 2, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.298 Vali Acc: 0.055 Test Loss: 3.298 Test Acc: 0.055
Validation loss decreased (-0.043496 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 3.4763104915618896
Epoch: 3, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.281 Vali Acc: 0.091 Test Loss: 3.281 Test Acc: 0.091
Validation loss decreased (-0.055261 --> -0.090555).  Saving model ...
Epoch: 4 cost time: 3.6141674518585205
Epoch: 4, Steps: 10 | Train Loss: 2.735 Vali Loss: 3.262 Vali Acc: 0.104 Test Loss: 3.262 Test Acc: 0.104
Validation loss decreased (-0.090555 --> -0.103497).  Saving model ...
Epoch: 5 cost time: 3.2609236240386963
Epoch: 5, Steps: 10 | Train Loss: 2.575 Vali Loss: 3.234 Vali Acc: 0.121 Test Loss: 3.234 Test Acc: 0.121
Validation loss decreased (-0.103497 --> -0.121144).  Saving model ...
Epoch: 6 cost time: 3.419294595718384
Epoch: 6, Steps: 10 | Train Loss: 2.290 Vali Loss: 3.183 Vali Acc: 0.146 Test Loss: 3.183 Test Acc: 0.146
Validation loss decreased (-0.121144 --> -0.145851).  Saving model ...
Epoch: 7 cost time: 3.054574489593506
Epoch: 7, Steps: 10 | Train Loss: 2.037 Vali Loss: 3.149 Vali Acc: 0.174 Test Loss: 3.149 Test Acc: 0.174
Validation loss decreased (-0.145851 --> -0.174086).  Saving model ...
Epoch: 8 cost time: 3.0259573459625244
Epoch: 8, Steps: 10 | Train Loss: 1.816 Vali Loss: 3.133 Vali Acc: 0.172 Test Loss: 3.133 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3523216247558594
Epoch: 9, Steps: 10 | Train Loss: 1.541 Vali Loss: 3.131 Vali Acc: 0.212 Test Loss: 3.131 Test Acc: 0.212
Validation loss decreased (-0.174086 --> -0.211733).  Saving model ...
Epoch: 10 cost time: 3.4399325847625732
Epoch: 10, Steps: 10 | Train Loss: 1.306 Vali Loss: 3.118 Vali Acc: 0.224 Test Loss: 3.118 Test Acc: 0.224
Validation loss decreased (-0.211733 --> -0.223498).  Saving model ...
Epoch: 11 cost time: 3.3821218013763428
Epoch: 11, Steps: 10 | Train Loss: 1.084 Vali Loss: 3.109 Vali Acc: 0.245 Test Loss: 3.109 Test Acc: 0.245
Validation loss decreased (-0.223498 --> -0.244675).  Saving model ...
Epoch: 12 cost time: 3.1524100303649902
Epoch: 12, Steps: 10 | Train Loss: 0.897 Vali Loss: 3.152 Vali Acc: 0.256 Test Loss: 3.152 Test Acc: 0.256
Validation loss decreased (-0.244675 --> -0.256439).  Saving model ...
Epoch: 13 cost time: 2.9227614402770996
Epoch: 13, Steps: 10 | Train Loss: 0.702 Vali Loss: 3.189 Vali Acc: 0.256 Test Loss: 3.189 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.094616651535034
Epoch: 14, Steps: 10 | Train Loss: 0.547 Vali Loss: 3.217 Vali Acc: 0.268 Test Loss: 3.217 Test Acc: 0.268
Validation loss decreased (-0.256439 --> -0.268203).  Saving model ...
Epoch: 15 cost time: 3.6788833141326904
Epoch: 15, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.267 Vali Acc: 0.266 Test Loss: 3.267 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0990636348724365
Epoch: 16, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.320 Vali Acc: 0.278 Test Loss: 3.320 Test Acc: 0.278
Validation loss decreased (-0.268203 --> -0.277614).  Saving model ...
Epoch: 17 cost time: 3.2119252681732178
Epoch: 17, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.362 Vali Acc: 0.300 Test Loss: 3.362 Test Acc: 0.300
Validation loss decreased (-0.277614 --> -0.299966).  Saving model ...
Epoch: 18 cost time: 3.367953300476074
Epoch: 18, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.412 Vali Acc: 0.304 Test Loss: 3.412 Test Acc: 0.304
Validation loss decreased (-0.299966 --> -0.303495).  Saving model ...
Epoch: 19 cost time: 3.2068984508514404
Epoch: 19, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.465 Vali Acc: 0.302 Test Loss: 3.465 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4273109436035156
Epoch: 20, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.508 Vali Acc: 0.295 Test Loss: 3.508 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.4644882678985596
Epoch: 21, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.518 Vali Acc: 0.301 Test Loss: 3.518 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2847611904144287
Epoch: 22, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.555 Vali Acc: 0.300 Test Loss: 3.555 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.55470609664917
Epoch: 23, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.608 Vali Acc: 0.301 Test Loss: 3.608 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.34865403175354
Epoch: 24, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.627 Vali Acc: 0.311 Test Loss: 3.627 Test Acc: 0.311
Validation loss decreased (-0.303495 --> -0.310552).  Saving model ...
Epoch: 25 cost time: 3.3546230792999268
Epoch: 25, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.648 Vali Acc: 0.314 Test Loss: 3.648 Test Acc: 0.314
Validation loss decreased (-0.310552 --> -0.314081).  Saving model ...
Epoch: 26 cost time: 3.4429523944854736
Epoch: 26, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.678 Vali Acc: 0.308 Test Loss: 3.678 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3679378032684326
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.711 Vali Acc: 0.302 Test Loss: 3.711 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.348343849182129
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.723 Vali Acc: 0.308 Test Loss: 3.723 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.488450765609741
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.752 Vali Acc: 0.307 Test Loss: 3.752 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.585664987564087
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.777 Vali Acc: 0.302 Test Loss: 3.777 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.273465394973755
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.787 Vali Acc: 0.308 Test Loss: 3.787 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.928395986557007
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.810 Vali Acc: 0.308 Test Loss: 3.810 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.9249768257141113
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.832 Vali Acc: 0.304 Test Loss: 3.832 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.591106653213501
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.856 Vali Acc: 0.300 Test Loss: 3.856 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.44158935546875
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.879 Vali Acc: 0.299 Test Loss: 3.879 Test Acc: 0.299
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 193882
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         46                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.35588526725769
Epoch: 1, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.318 Vali Acc: 0.042 Test Loss: 3.318 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 3.147859573364258
Epoch: 2, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.282 Vali Acc: 0.066 Test Loss: 3.282 Test Acc: 0.066
Validation loss decreased (-0.042320 --> -0.065850).  Saving model ...
Epoch: 3 cost time: 3.2631125450134277
Epoch: 3, Steps: 10 | Train Loss: 2.958 Vali Loss: 3.263 Vali Acc: 0.101 Test Loss: 3.263 Test Acc: 0.101
Validation loss decreased (-0.065850 --> -0.101144).  Saving model ...
Epoch: 4 cost time: 3.204057216644287
Epoch: 4, Steps: 10 | Train Loss: 2.718 Vali Loss: 3.250 Vali Acc: 0.111 Test Loss: 3.250 Test Acc: 0.111
Validation loss decreased (-0.101144 --> -0.110556).  Saving model ...
Epoch: 5 cost time: 3.1008782386779785
Epoch: 5, Steps: 10 | Train Loss: 2.558 Vali Loss: 3.231 Vali Acc: 0.128 Test Loss: 3.231 Test Acc: 0.128
Validation loss decreased (-0.110556 --> -0.128203).  Saving model ...
Epoch: 6 cost time: 3.194690704345703
Epoch: 6, Steps: 10 | Train Loss: 2.292 Vali Loss: 3.187 Vali Acc: 0.140 Test Loss: 3.187 Test Acc: 0.140
Validation loss decreased (-0.128203 --> -0.139968).  Saving model ...
Epoch: 7 cost time: 2.9871463775634766
Epoch: 7, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.159 Vali Acc: 0.165 Test Loss: 3.159 Test Acc: 0.165
Validation loss decreased (-0.139968 --> -0.164674).  Saving model ...
Epoch: 8 cost time: 3.085646867752075
Epoch: 8, Steps: 10 | Train Loss: 1.856 Vali Loss: 3.156 Vali Acc: 0.168 Test Loss: 3.156 Test Acc: 0.168
Validation loss decreased (-0.164674 --> -0.168204).  Saving model ...
Epoch: 9 cost time: 3.327716827392578
Epoch: 9, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.157 Vali Acc: 0.212 Test Loss: 3.157 Test Acc: 0.212
Validation loss decreased (-0.168204 --> -0.211733).  Saving model ...
Epoch: 10 cost time: 3.168004035949707
Epoch: 10, Steps: 10 | Train Loss: 1.381 Vali Loss: 3.158 Vali Acc: 0.211 Test Loss: 3.158 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.117859363555908
Epoch: 11, Steps: 10 | Train Loss: 1.179 Vali Loss: 3.149 Vali Acc: 0.231 Test Loss: 3.149 Test Acc: 0.231
Validation loss decreased (-0.211733 --> -0.230557).  Saving model ...
Epoch: 12 cost time: 2.9638020992279053
Epoch: 12, Steps: 10 | Train Loss: 1.044 Vali Loss: 3.191 Vali Acc: 0.240 Test Loss: 3.191 Test Acc: 0.240
Validation loss decreased (-0.230557 --> -0.239968).  Saving model ...
Epoch: 13 cost time: 3.101353883743286
Epoch: 13, Steps: 10 | Train Loss: 0.815 Vali Loss: 3.227 Vali Acc: 0.248 Test Loss: 3.227 Test Acc: 0.248
Validation loss decreased (-0.239968 --> -0.248203).  Saving model ...
Epoch: 14 cost time: 3.2410991191864014
Epoch: 14, Steps: 10 | Train Loss: 0.661 Vali Loss: 3.251 Vali Acc: 0.259 Test Loss: 3.251 Test Acc: 0.259
Validation loss decreased (-0.248203 --> -0.258791).  Saving model ...
Epoch: 15 cost time: 2.9448695182800293
Epoch: 15, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.300 Vali Acc: 0.272 Test Loss: 3.300 Test Acc: 0.272
Validation loss decreased (-0.258791 --> -0.271732).  Saving model ...
Epoch: 16 cost time: 3.2213847637176514
Epoch: 16, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.340 Vali Acc: 0.267 Test Loss: 3.340 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4073610305786133
Epoch: 17, Steps: 10 | Train Loss: 0.354 Vali Loss: 3.394 Vali Acc: 0.274 Test Loss: 3.394 Test Acc: 0.274
Validation loss decreased (-0.271732 --> -0.274084).  Saving model ...
Epoch: 18 cost time: 3.3508248329162598
Epoch: 18, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.446 Vali Acc: 0.285 Test Loss: 3.446 Test Acc: 0.285
Validation loss decreased (-0.274084 --> -0.284671).  Saving model ...
Epoch: 19 cost time: 3.1928772926330566
Epoch: 19, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.490 Vali Acc: 0.282 Test Loss: 3.490 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.190786600112915
Epoch: 20, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.506 Vali Acc: 0.282 Test Loss: 3.506 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.430508613586426
Epoch: 21, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.533 Vali Acc: 0.299 Test Loss: 3.533 Test Acc: 0.299
Validation loss decreased (-0.284671 --> -0.298788).  Saving model ...
Epoch: 22 cost time: 3.483851909637451
Epoch: 22, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.605 Vali Acc: 0.291 Test Loss: 3.605 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7318670749664307
Epoch: 23, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.675 Vali Acc: 0.289 Test Loss: 3.675 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.940018892288208
Epoch: 24, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.677 Vali Acc: 0.289 Test Loss: 3.677 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.434981346130371
Epoch: 25, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.700 Vali Acc: 0.294 Test Loss: 3.700 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.1527528762817383
Epoch: 26, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.717 Vali Acc: 0.295 Test Loss: 3.717 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.2235941886901855
Epoch: 27, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.753 Vali Acc: 0.298 Test Loss: 3.753 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.3381717205047607
Epoch: 28, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.761 Vali Acc: 0.299 Test Loss: 3.761 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.627819299697876
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.794 Vali Acc: 0.300 Test Loss: 3.794 Test Acc: 0.300
Validation loss decreased (-0.298788 --> -0.299962).  Saving model ...
Epoch: 30 cost time: 3.2768099308013916
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.830 Vali Acc: 0.302 Test Loss: 3.830 Test Acc: 0.302
Validation loss decreased (-0.299962 --> -0.302315).  Saving model ...
Epoch: 31 cost time: 3.3709914684295654
Epoch: 31, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.852 Vali Acc: 0.298 Test Loss: 3.852 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3408091068267822
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.879 Vali Acc: 0.300 Test Loss: 3.879 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.649451732635498
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.900 Vali Acc: 0.304 Test Loss: 3.900 Test Acc: 0.304
Validation loss decreased (-0.302315 --> -0.303490).  Saving model ...
Epoch: 34 cost time: 3.289889097213745
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.918 Vali Acc: 0.301 Test Loss: 3.918 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.492792844772339
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.932 Vali Acc: 0.304 Test Loss: 3.932 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.743901491165161
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.948 Vali Acc: 0.304 Test Loss: 3.948 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.691086769104004
Epoch: 37, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.961 Vali Acc: 0.306 Test Loss: 3.961 Test Acc: 0.306
Validation loss decreased (-0.303490 --> -0.305843).  Saving model ...
Epoch: 38 cost time: 3.2984731197357178
Epoch: 38, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.985 Vali Acc: 0.300 Test Loss: 3.985 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.2576284408569336
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.002 Vali Acc: 0.305 Test Loss: 4.002 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.7425730228424072
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.012 Vali Acc: 0.305 Test Loss: 4.012 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.1513023376464844
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.024 Vali Acc: 0.306 Test Loss: 4.024 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.0620357990264893
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.044 Vali Acc: 0.305 Test Loss: 4.044 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.49960994720459
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.058 Vali Acc: 0.306 Test Loss: 4.058 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.7047464847564697
Epoch: 44, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.071 Vali Acc: 0.306 Test Loss: 4.071 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.3965461254119873
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.087 Vali Acc: 0.308 Test Loss: 4.087 Test Acc: 0.308
Validation loss decreased (-0.305843 --> -0.308194).  Saving model ...
Epoch: 46 cost time: 3.289546012878418
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.099 Vali Acc: 0.307 Test Loss: 4.099 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.4944143295288086
Epoch: 47, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.104 Vali Acc: 0.311 Test Loss: 4.104 Test Acc: 0.311
Validation loss decreased (-0.308194 --> -0.310547).  Saving model ...
Epoch: 48 cost time: 3.0494914054870605
Epoch: 48, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.134 Vali Acc: 0.306 Test Loss: 4.134 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.1023809909820557
Epoch: 49, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.151 Vali Acc: 0.308 Test Loss: 4.151 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.2989723682403564
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.169 Vali Acc: 0.307 Test Loss: 4.169 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.7529468536376953
Epoch: 51, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.183 Vali Acc: 0.307 Test Loss: 4.183 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.1690874099731445
Epoch: 52, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.195 Vali Acc: 0.304 Test Loss: 4.195 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.5297694206237793
Epoch: 53, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.198 Vali Acc: 0.307 Test Loss: 4.198 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.412912130355835
Epoch: 54, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.209 Vali Acc: 0.308 Test Loss: 4.209 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.7198636531829834
Epoch: 55, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.220 Vali Acc: 0.309 Test Loss: 4.220 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.304478883743286
Epoch: 56, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.227 Vali Acc: 0.311 Test Loss: 4.227 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.9756414890289307
Epoch: 57, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.237 Vali Acc: 0.312 Test Loss: 4.237 Test Acc: 0.312
Validation loss decreased (-0.310547 --> -0.311722).  Saving model ...
Epoch: 58 cost time: 3.71510648727417
Epoch: 58, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.244 Vali Acc: 0.311 Test Loss: 4.244 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.4543094635009766
Epoch: 59, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.264 Vali Acc: 0.305 Test Loss: 4.264 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 3.4707186222076416
Epoch: 60, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.275 Vali Acc: 0.309 Test Loss: 4.275 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 3.311730146408081
Epoch: 61, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.278 Vali Acc: 0.311 Test Loss: 4.278 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 3.241389036178589
Epoch: 62, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.285 Vali Acc: 0.311 Test Loss: 4.285 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 3.6285860538482666
Epoch: 63, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.290 Vali Acc: 0.312 Test Loss: 4.290 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 3.659055471420288
Epoch: 64, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.301 Vali Acc: 0.312 Test Loss: 4.301 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 3.3012256622314453
Epoch: 65, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.314 Vali Acc: 0.314 Test Loss: 4.314 Test Acc: 0.314
Validation loss decreased (-0.311722 --> -0.314075).  Saving model ...
Epoch: 66 cost time: 3.2649543285369873
Epoch: 66, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.323 Vali Acc: 0.314 Test Loss: 4.323 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 3.7022058963775635
Epoch: 67, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.337 Vali Acc: 0.308 Test Loss: 4.337 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 3.436420440673828
Epoch: 68, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.341 Vali Acc: 0.308 Test Loss: 4.341 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 3.564394474029541
Epoch: 69, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.355 Vali Acc: 0.306 Test Loss: 4.355 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 3.4408466815948486
Epoch: 70, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.362 Vali Acc: 0.308 Test Loss: 4.362 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 3.162390947341919
Epoch: 71, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.373 Vali Acc: 0.308 Test Loss: 4.373 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 2.9295198917388916
Epoch: 72, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.382 Vali Acc: 0.305 Test Loss: 4.382 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 3.431382417678833
Epoch: 73, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.394 Vali Acc: 0.306 Test Loss: 4.394 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 3.4109911918640137
Epoch: 74, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.405 Vali Acc: 0.307 Test Loss: 4.405 Test Acc: 0.307
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 3.4365341663360596
Epoch: 75, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.409 Vali Acc: 0.306 Test Loss: 4.409 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 193882
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.0764243602752686
Epoch: 1, Steps: 10 | Train Loss: 3.265 Vali Loss: 3.325 Vali Acc: 0.042 Test Loss: 3.325 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 3.332308292388916
Epoch: 2, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.295 Vali Acc: 0.055 Test Loss: 3.295 Test Acc: 0.055
Validation loss decreased (-0.042320 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 3.248474359512329
Epoch: 3, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.282 Vali Acc: 0.085 Test Loss: 3.282 Test Acc: 0.085
Validation loss decreased (-0.055261 --> -0.084673).  Saving model ...
Epoch: 4 cost time: 3.7302606105804443
Epoch: 4, Steps: 10 | Train Loss: 2.751 Vali Loss: 3.278 Vali Acc: 0.108 Test Loss: 3.278 Test Acc: 0.108
Validation loss decreased (-0.084673 --> -0.108203).  Saving model ...
Epoch: 5 cost time: 3.124725103378296
Epoch: 5, Steps: 10 | Train Loss: 2.584 Vali Loss: 3.275 Vali Acc: 0.120 Test Loss: 3.275 Test Acc: 0.120
Validation loss decreased (-0.108203 --> -0.119967).  Saving model ...
Epoch: 6 cost time: 2.948702335357666
Epoch: 6, Steps: 10 | Train Loss: 2.309 Vali Loss: 3.250 Vali Acc: 0.127 Test Loss: 3.250 Test Acc: 0.127
Validation loss decreased (-0.119967 --> -0.127026).  Saving model ...
Epoch: 7 cost time: 3.7226390838623047
Epoch: 7, Steps: 10 | Train Loss: 2.081 Vali Loss: 3.242 Vali Acc: 0.142 Test Loss: 3.242 Test Acc: 0.142
Validation loss decreased (-0.127026 --> -0.142321).  Saving model ...
Epoch: 8 cost time: 3.438154935836792
Epoch: 8, Steps: 10 | Train Loss: 1.901 Vali Loss: 3.259 Vali Acc: 0.144 Test Loss: 3.259 Test Acc: 0.144
Validation loss decreased (-0.142321 --> -0.143497).  Saving model ...
Epoch: 9 cost time: 3.5147452354431152
Epoch: 9, Steps: 10 | Train Loss: 1.666 Vali Loss: 3.284 Vali Acc: 0.166 Test Loss: 3.284 Test Acc: 0.166
Validation loss decreased (-0.143497 --> -0.165850).  Saving model ...
Epoch: 10 cost time: 3.450137138366699
Epoch: 10, Steps: 10 | Train Loss: 1.452 Vali Loss: 3.299 Vali Acc: 0.168 Test Loss: 3.299 Test Acc: 0.168
Validation loss decreased (-0.165850 --> -0.168202).  Saving model ...
Epoch: 11 cost time: 3.4849905967712402
Epoch: 11, Steps: 10 | Train Loss: 1.244 Vali Loss: 3.314 Vali Acc: 0.172 Test Loss: 3.314 Test Acc: 0.172
Validation loss decreased (-0.168202 --> -0.171732).  Saving model ...
Epoch: 12 cost time: 3.011068820953369
Epoch: 12, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.375 Vali Acc: 0.176 Test Loss: 3.375 Test Acc: 0.176
Validation loss decreased (-0.171732 --> -0.176437).  Saving model ...
Epoch: 13 cost time: 3.0396246910095215
Epoch: 13, Steps: 10 | Train Loss: 0.861 Vali Loss: 3.445 Vali Acc: 0.184 Test Loss: 3.445 Test Acc: 0.184
Validation loss decreased (-0.176437 --> -0.183495).  Saving model ...
Epoch: 14 cost time: 3.8427178859710693
Epoch: 14, Steps: 10 | Train Loss: 0.727 Vali Loss: 3.476 Vali Acc: 0.188 Test Loss: 3.476 Test Acc: 0.188
Validation loss decreased (-0.183495 --> -0.188201).  Saving model ...
Epoch: 15 cost time: 3.2160565853118896
Epoch: 15, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.533 Vali Acc: 0.201 Test Loss: 3.533 Test Acc: 0.201
Validation loss decreased (-0.188201 --> -0.201141).  Saving model ...
Epoch: 16 cost time: 3.1343119144439697
Epoch: 16, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.598 Vali Acc: 0.206 Test Loss: 3.598 Test Acc: 0.206
Validation loss decreased (-0.201141 --> -0.205846).  Saving model ...
Epoch: 17 cost time: 3.7401113510131836
Epoch: 17, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.667 Vali Acc: 0.214 Test Loss: 3.667 Test Acc: 0.214
Validation loss decreased (-0.205846 --> -0.214081).  Saving model ...
Epoch: 18 cost time: 3.1318135261535645
Epoch: 18, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.719 Vali Acc: 0.229 Test Loss: 3.719 Test Acc: 0.229
Validation loss decreased (-0.214081 --> -0.229375).  Saving model ...
Epoch: 19 cost time: 3.4302752017974854
Epoch: 19, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.807 Vali Acc: 0.238 Test Loss: 3.807 Test Acc: 0.238
Validation loss decreased (-0.229375 --> -0.237609).  Saving model ...
Epoch: 20 cost time: 3.2990710735321045
Epoch: 20, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.848 Vali Acc: 0.238 Test Loss: 3.848 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.454735040664673
Epoch: 21, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.863 Vali Acc: 0.240 Test Loss: 3.863 Test Acc: 0.240
Validation loss decreased (-0.237609 --> -0.239961).  Saving model ...
Epoch: 22 cost time: 3.411698818206787
Epoch: 22, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.935 Vali Acc: 0.245 Test Loss: 3.935 Test Acc: 0.245
Validation loss decreased (-0.239961 --> -0.244667).  Saving model ...
Epoch: 23 cost time: 2.8989176750183105
Epoch: 23, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.017 Vali Acc: 0.233 Test Loss: 4.017 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.378408193588257
Epoch: 24, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.014 Vali Acc: 0.246 Test Loss: 4.014 Test Acc: 0.246
Validation loss decreased (-0.244667 --> -0.245842).  Saving model ...
Epoch: 25 cost time: 3.539717435836792
Epoch: 25, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.050 Vali Acc: 0.236 Test Loss: 4.050 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3594303131103516
Epoch: 26, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.110 Vali Acc: 0.242 Test Loss: 4.110 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.4310688972473145
Epoch: 27, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.171 Vali Acc: 0.253 Test Loss: 4.171 Test Acc: 0.253
Validation loss decreased (-0.245842 --> -0.252899).  Saving model ...
Epoch: 28 cost time: 3.495633602142334
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.174 Vali Acc: 0.254 Test Loss: 4.174 Test Acc: 0.254
Validation loss decreased (-0.252899 --> -0.254076).  Saving model ...
Epoch: 29 cost time: 3.3013696670532227
Epoch: 29, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.214 Vali Acc: 0.254 Test Loss: 4.214 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.231475591659546
Epoch: 30, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.236 Vali Acc: 0.255 Test Loss: 4.236 Test Acc: 0.255
Validation loss decreased (-0.254076 --> -0.255252).  Saving model ...
Epoch: 31 cost time: 3.378547430038452
Epoch: 31, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.257 Vali Acc: 0.251 Test Loss: 4.257 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.135141372680664
Epoch: 32, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.298 Vali Acc: 0.252 Test Loss: 4.298 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.976447105407715
Epoch: 33, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.323 Vali Acc: 0.253 Test Loss: 4.323 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.6332085132598877
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.339 Vali Acc: 0.254 Test Loss: 4.339 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.0927107334136963
Epoch: 35, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.355 Vali Acc: 0.254 Test Loss: 4.355 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.262274980545044
Epoch: 36, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.377 Vali Acc: 0.258 Test Loss: 4.377 Test Acc: 0.258
Validation loss decreased (-0.255252 --> -0.257603).  Saving model ...
Epoch: 37 cost time: 3.7243289947509766
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.395 Vali Acc: 0.256 Test Loss: 4.395 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.5285894870758057
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.426 Vali Acc: 0.258 Test Loss: 4.426 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.1371970176696777
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.438 Vali Acc: 0.260 Test Loss: 4.438 Test Acc: 0.260
Validation loss decreased (-0.257603 --> -0.259956).  Saving model ...
Epoch: 40 cost time: 3.1582260131835938
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.441 Vali Acc: 0.260 Test Loss: 4.441 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.5312423706054688
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.454 Vali Acc: 0.259 Test Loss: 4.454 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.3900632858276367
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.477 Vali Acc: 0.253 Test Loss: 4.477 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.5018768310546875
Epoch: 43, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.494 Vali Acc: 0.256 Test Loss: 4.494 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.3579721450805664
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.517 Vali Acc: 0.260 Test Loss: 4.517 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.3263421058654785
Epoch: 45, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.538 Vali Acc: 0.260 Test Loss: 4.538 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.7164855003356934
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.554 Vali Acc: 0.262 Test Loss: 4.554 Test Acc: 0.262
Validation loss decreased (-0.259956 --> -0.262307).  Saving model ...
Epoch: 47 cost time: 3.705749034881592
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.561 Vali Acc: 0.265 Test Loss: 4.561 Test Acc: 0.265
Validation loss decreased (-0.262307 --> -0.264660).  Saving model ...
Epoch: 48 cost time: 3.252046585083008
Epoch: 48, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.582 Vali Acc: 0.262 Test Loss: 4.582 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.662463426589966
Epoch: 49, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.602 Vali Acc: 0.258 Test Loss: 4.602 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.5275259017944336
Epoch: 50, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.623 Vali Acc: 0.258 Test Loss: 4.623 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.361020565032959
Epoch: 51, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.640 Vali Acc: 0.259 Test Loss: 4.640 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.6007144451141357
Epoch: 52, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.662 Vali Acc: 0.258 Test Loss: 4.662 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.333404302597046
Epoch: 53, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.675 Vali Acc: 0.258 Test Loss: 4.675 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.31109619140625
Epoch: 54, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.685 Vali Acc: 0.258 Test Loss: 4.685 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.514357805252075
Epoch: 55, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.694 Vali Acc: 0.256 Test Loss: 4.694 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.013735055923462
Epoch: 56, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.701 Vali Acc: 0.261 Test Loss: 4.701 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.778330087661743
Epoch: 57, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.706 Vali Acc: 0.264 Test Loss: 4.706 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 193882
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.4256017208099365
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.300 Vali Acc: 0.045 Test Loss: 3.300 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 3.154498338699341
Epoch: 2, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.291 Vali Acc: 0.042 Test Loss: 3.291 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.724536895751953
Epoch: 3, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.306 Vali Acc: 0.044 Test Loss: 3.306 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2687180042266846
Epoch: 4, Steps: 10 | Train Loss: 2.847 Vali Loss: 3.327 Vali Acc: 0.049 Test Loss: 3.327 Test Acc: 0.049
Validation loss decreased (-0.044673 --> -0.049378).  Saving model ...
Epoch: 5 cost time: 3.114274263381958
Epoch: 5, Steps: 10 | Train Loss: 2.711 Vali Loss: 3.340 Vali Acc: 0.059 Test Loss: 3.340 Test Acc: 0.059
Validation loss decreased (-0.049378 --> -0.058790).  Saving model ...
Epoch: 6 cost time: 3.409419536590576
Epoch: 6, Steps: 10 | Train Loss: 2.472 Vali Loss: 3.326 Vali Acc: 0.068 Test Loss: 3.326 Test Acc: 0.068
Validation loss decreased (-0.058790 --> -0.068202).  Saving model ...
Epoch: 7 cost time: 2.975872278213501
Epoch: 7, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.327 Vali Acc: 0.084 Test Loss: 3.327 Test Acc: 0.084
Validation loss decreased (-0.068202 --> -0.083496).  Saving model ...
Epoch: 8 cost time: 3.5459845066070557
Epoch: 8, Steps: 10 | Train Loss: 2.063 Vali Loss: 3.340 Vali Acc: 0.089 Test Loss: 3.340 Test Acc: 0.089
Validation loss decreased (-0.083496 --> -0.089378).  Saving model ...
Epoch: 9 cost time: 3.534173011779785
Epoch: 9, Steps: 10 | Train Loss: 1.823 Vali Loss: 3.360 Vali Acc: 0.089 Test Loss: 3.360 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.417691707611084
Epoch: 10, Steps: 10 | Train Loss: 1.604 Vali Loss: 3.385 Vali Acc: 0.091 Test Loss: 3.385 Test Acc: 0.091
Validation loss decreased (-0.089378 --> -0.090554).  Saving model ...
Epoch: 11 cost time: 3.642033576965332
Epoch: 11, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.404 Vali Acc: 0.101 Test Loss: 3.404 Test Acc: 0.101
Validation loss decreased (-0.090554 --> -0.101142).  Saving model ...
Epoch: 12 cost time: 3.516842842102051
Epoch: 12, Steps: 10 | Train Loss: 1.150 Vali Loss: 3.475 Vali Acc: 0.098 Test Loss: 3.475 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5273005962371826
Epoch: 13, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.545 Vali Acc: 0.112 Test Loss: 3.545 Test Acc: 0.112
Validation loss decreased (-0.101142 --> -0.111729).  Saving model ...
Epoch: 14 cost time: 3.937363386154175
Epoch: 14, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.599 Vali Acc: 0.112 Test Loss: 3.599 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4393248558044434
Epoch: 15, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.694 Vali Acc: 0.109 Test Loss: 3.694 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.199936628341675
Epoch: 16, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.771 Vali Acc: 0.113 Test Loss: 3.771 Test Acc: 0.113
Validation loss decreased (-0.111729 --> -0.112903).  Saving model ...
Epoch: 17 cost time: 3.253093957901001
Epoch: 17, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.870 Vali Acc: 0.115 Test Loss: 3.870 Test Acc: 0.115
Validation loss decreased (-0.112903 --> -0.115255).  Saving model ...
Epoch: 18 cost time: 3.0751941204071045
Epoch: 18, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.951 Vali Acc: 0.125 Test Loss: 3.951 Test Acc: 0.125
Validation loss decreased (-0.115255 --> -0.124666).  Saving model ...
Epoch: 19 cost time: 3.5908188819885254
Epoch: 19, Steps: 10 | Train Loss: 0.190 Vali Loss: 4.035 Vali Acc: 0.126 Test Loss: 4.035 Test Acc: 0.126
Validation loss decreased (-0.124666 --> -0.125842).  Saving model ...
Epoch: 20 cost time: 3.9445502758026123
Epoch: 20, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.115 Vali Acc: 0.128 Test Loss: 4.115 Test Acc: 0.128
Validation loss decreased (-0.125842 --> -0.128194).  Saving model ...
Epoch: 21 cost time: 3.1208298206329346
Epoch: 21, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.139 Vali Acc: 0.129 Test Loss: 4.139 Test Acc: 0.129
Validation loss decreased (-0.128194 --> -0.129370).  Saving model ...
Epoch: 22 cost time: 3.4480278491973877
Epoch: 22, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.200 Vali Acc: 0.133 Test Loss: 4.200 Test Acc: 0.133
Validation loss decreased (-0.129370 --> -0.132899).  Saving model ...
Epoch: 23 cost time: 3.7169783115386963
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.278 Vali Acc: 0.135 Test Loss: 4.278 Test Acc: 0.135
Validation loss decreased (-0.132899 --> -0.135251).  Saving model ...
Epoch: 24 cost time: 2.9906246662139893
Epoch: 24, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.302 Vali Acc: 0.138 Test Loss: 4.302 Test Acc: 0.138
Validation loss decreased (-0.135251 --> -0.137604).  Saving model ...
Epoch: 25 cost time: 2.8599624633789062
Epoch: 25, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.332 Vali Acc: 0.139 Test Loss: 4.332 Test Acc: 0.139
Validation loss decreased (-0.137604 --> -0.138780).  Saving model ...
Epoch: 26 cost time: 3.5429770946502686
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.375 Vali Acc: 0.141 Test Loss: 4.375 Test Acc: 0.141
Validation loss decreased (-0.138780 --> -0.141133).  Saving model ...
Epoch: 27 cost time: 3.2738542556762695
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.402 Vali Acc: 0.140 Test Loss: 4.402 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.242877721786499
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.409 Vali Acc: 0.140 Test Loss: 4.409 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.366137981414795
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.439 Vali Acc: 0.139 Test Loss: 4.439 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.5615270137786865
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.474 Vali Acc: 0.141 Test Loss: 4.474 Test Acc: 0.141
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.0992891788482666
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.500 Vali Acc: 0.144 Test Loss: 4.500 Test Acc: 0.144
Validation loss decreased (-0.141133 --> -0.143484).  Saving model ...
Epoch: 32 cost time: 3.3391330242156982
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.535 Vali Acc: 0.140 Test Loss: 4.535 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.58896541595459
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.563 Vali Acc: 0.145 Test Loss: 4.563 Test Acc: 0.145
Validation loss decreased (-0.143484 --> -0.144660).  Saving model ...
Epoch: 34 cost time: 3.4823803901672363
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.579 Vali Acc: 0.142 Test Loss: 4.579 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.942678928375244
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.594 Vali Acc: 0.142 Test Loss: 4.594 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.344146966934204
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.630 Vali Acc: 0.147 Test Loss: 4.630 Test Acc: 0.147
Validation loss decreased (-0.144660 --> -0.147013).  Saving model ...
Epoch: 37 cost time: 3.5070934295654297
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.649 Vali Acc: 0.141 Test Loss: 4.649 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.367558717727661
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.679 Vali Acc: 0.141 Test Loss: 4.679 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.22121524810791
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.694 Vali Acc: 0.139 Test Loss: 4.694 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.48958420753479
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.700 Vali Acc: 0.144 Test Loss: 4.700 Test Acc: 0.144
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.9070231914520264
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.705 Vali Acc: 0.147 Test Loss: 4.705 Test Acc: 0.147
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.894827127456665
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.725 Vali Acc: 0.148 Test Loss: 4.725 Test Acc: 0.148
Validation loss decreased (-0.147013 --> -0.148188).  Saving model ...
Epoch: 43 cost time: 3.187995433807373
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.749 Vali Acc: 0.147 Test Loss: 4.749 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.664797782897949
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.768 Vali Acc: 0.148 Test Loss: 4.768 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.44352650642395
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.786 Vali Acc: 0.147 Test Loss: 4.786 Test Acc: 0.147
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.6043355464935303
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.798 Vali Acc: 0.148 Test Loss: 4.798 Test Acc: 0.148
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.9638705253601074
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.805 Vali Acc: 0.155 Test Loss: 4.805 Test Acc: 0.155
Validation loss decreased (-0.148188 --> -0.155246).  Saving model ...
Epoch: 48 cost time: 2.9789462089538574
Epoch: 48, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.831 Vali Acc: 0.153 Test Loss: 4.831 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.6673731803894043
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.850 Vali Acc: 0.152 Test Loss: 4.850 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.030733346939087
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.863 Vali Acc: 0.151 Test Loss: 4.863 Test Acc: 0.151
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.5984365940093994
Epoch: 51, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.876 Vali Acc: 0.152 Test Loss: 4.876 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.1888809204101562
Epoch: 52, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.898 Vali Acc: 0.151 Test Loss: 4.898 Test Acc: 0.151
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.940523624420166
Epoch: 53, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.914 Vali Acc: 0.152 Test Loss: 4.914 Test Acc: 0.152
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.75752592086792
Epoch: 54, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.926 Vali Acc: 0.154 Test Loss: 4.926 Test Acc: 0.154
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.2232484817504883
Epoch: 55, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.936 Vali Acc: 0.155 Test Loss: 4.936 Test Acc: 0.155
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.4956724643707275
Epoch: 56, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.941 Vali Acc: 0.152 Test Loss: 4.941 Test Acc: 0.152
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.3695614337921143
Epoch: 57, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.950 Vali Acc: 0.151 Test Loss: 4.950 Test Acc: 0.151
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.15529411764705883
model parameter : 193882
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.5404956340789795
Epoch: 1, Steps: 10 | Train Loss: 3.386 Vali Loss: 3.357 Vali Acc: 0.044 Test Loss: 3.357 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 3.6101279258728027
Epoch: 2, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.331 Vali Acc: 0.039 Test Loss: 3.331 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.381012439727783
Epoch: 3, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.332 Vali Acc: 0.034 Test Loss: 3.332 Test Acc: 0.034
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4290220737457275
Epoch: 4, Steps: 10 | Train Loss: 2.923 Vali Loss: 3.349 Vali Acc: 0.039 Test Loss: 3.349 Test Acc: 0.039
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1003875732421875
Epoch: 5, Steps: 10 | Train Loss: 2.837 Vali Loss: 3.370 Vali Acc: 0.047 Test Loss: 3.370 Test Acc: 0.047
Validation loss decreased (-0.043496 --> -0.047025).  Saving model ...
Epoch: 6 cost time: 3.3240513801574707
Epoch: 6, Steps: 10 | Train Loss: 2.675 Vali Loss: 3.359 Vali Acc: 0.048 Test Loss: 3.359 Test Acc: 0.048
Validation loss decreased (-0.047025 --> -0.048202).  Saving model ...
Epoch: 7 cost time: 3.201359748840332
Epoch: 7, Steps: 10 | Train Loss: 2.522 Vali Loss: 3.355 Vali Acc: 0.052 Test Loss: 3.355 Test Acc: 0.052
Validation loss decreased (-0.048202 --> -0.051731).  Saving model ...
Epoch: 8 cost time: 3.0275144577026367
Epoch: 8, Steps: 10 | Train Loss: 2.379 Vali Loss: 3.360 Vali Acc: 0.054 Test Loss: 3.360 Test Acc: 0.054
Validation loss decreased (-0.051731 --> -0.054084).  Saving model ...
Epoch: 9 cost time: 3.5474891662597656
Epoch: 9, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.368 Vali Acc: 0.074 Test Loss: 3.368 Test Acc: 0.074
Validation loss decreased (-0.054084 --> -0.074084).  Saving model ...
Epoch: 10 cost time: 3.274340867996216
Epoch: 10, Steps: 10 | Train Loss: 2.008 Vali Loss: 3.374 Vali Acc: 0.080 Test Loss: 3.374 Test Acc: 0.080
Validation loss decreased (-0.074084 --> -0.079966).  Saving model ...
Epoch: 11 cost time: 3.79516863822937
Epoch: 11, Steps: 10 | Train Loss: 1.745 Vali Loss: 3.377 Vali Acc: 0.075 Test Loss: 3.377 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.419682502746582
Epoch: 12, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.420 Vali Acc: 0.079 Test Loss: 3.420 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.805479049682617
Epoch: 13, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.473 Vali Acc: 0.082 Test Loss: 3.473 Test Acc: 0.082
Validation loss decreased (-0.079966 --> -0.082318).  Saving model ...
Epoch: 14 cost time: 2.7629547119140625
Epoch: 14, Steps: 10 | Train Loss: 1.197 Vali Loss: 3.507 Vali Acc: 0.082 Test Loss: 3.507 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7078492641448975
Epoch: 15, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.559 Vali Acc: 0.089 Test Loss: 3.559 Test Acc: 0.089
Validation loss decreased (-0.082318 --> -0.089376).  Saving model ...
Epoch: 16 cost time: 3.2158100605010986
Epoch: 16, Steps: 10 | Train Loss: 0.856 Vali Loss: 3.629 Vali Acc: 0.085 Test Loss: 3.629 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4199106693267822
Epoch: 17, Steps: 10 | Train Loss: 0.697 Vali Loss: 3.686 Vali Acc: 0.094 Test Loss: 3.686 Test Acc: 0.094
Validation loss decreased (-0.089376 --> -0.094081).  Saving model ...
Epoch: 18 cost time: 3.4646246433258057
Epoch: 18, Steps: 10 | Train Loss: 0.544 Vali Loss: 3.757 Vali Acc: 0.096 Test Loss: 3.757 Test Acc: 0.096
Validation loss decreased (-0.094081 --> -0.096433).  Saving model ...
Epoch: 19 cost time: 3.605482339859009
Epoch: 19, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.848 Vali Acc: 0.095 Test Loss: 3.848 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2222349643707275
Epoch: 20, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.932 Vali Acc: 0.100 Test Loss: 3.932 Test Acc: 0.100
Validation loss decreased (-0.096433 --> -0.099961).  Saving model ...
Epoch: 21 cost time: 3.6006293296813965
Epoch: 21, Steps: 10 | Train Loss: 0.224 Vali Loss: 4.024 Vali Acc: 0.101 Test Loss: 4.024 Test Acc: 0.101
Validation loss decreased (-0.099961 --> -0.101136).  Saving model ...
Epoch: 22 cost time: 3.2723584175109863
Epoch: 22, Steps: 10 | Train Loss: 0.175 Vali Loss: 4.106 Vali Acc: 0.102 Test Loss: 4.106 Test Acc: 0.102
Validation loss decreased (-0.101136 --> -0.102312).  Saving model ...
Epoch: 23 cost time: 3.318643569946289
Epoch: 23, Steps: 10 | Train Loss: 0.137 Vali Loss: 4.202 Vali Acc: 0.099 Test Loss: 4.202 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.4838991165161133
Epoch: 24, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.229 Vali Acc: 0.102 Test Loss: 4.229 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.3859527111053467
Epoch: 25, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.304 Vali Acc: 0.092 Test Loss: 4.304 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.5551958084106445
Epoch: 26, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.360 Vali Acc: 0.101 Test Loss: 4.360 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.601511001586914
Epoch: 27, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.393 Vali Acc: 0.101 Test Loss: 4.393 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.74530291557312
Epoch: 28, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.397 Vali Acc: 0.101 Test Loss: 4.397 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.3713889122009277
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.453 Vali Acc: 0.111 Test Loss: 4.453 Test Acc: 0.111
Validation loss decreased (-0.102312 --> -0.110544).  Saving model ...
Epoch: 30 cost time: 3.712552309036255
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.488 Vali Acc: 0.112 Test Loss: 4.488 Test Acc: 0.112
Validation loss decreased (-0.110544 --> -0.111720).  Saving model ...
Epoch: 31 cost time: 2.8696861267089844
Epoch: 31, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.517 Vali Acc: 0.111 Test Loss: 4.517 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.359591007232666
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.561 Vali Acc: 0.109 Test Loss: 4.561 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.277539014816284
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.584 Vali Acc: 0.109 Test Loss: 4.584 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.3901491165161133
Epoch: 34, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.604 Vali Acc: 0.112 Test Loss: 4.604 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.4375598430633545
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.622 Vali Acc: 0.112 Test Loss: 4.622 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.5046274662017822
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.643 Vali Acc: 0.109 Test Loss: 4.643 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.450193405151367
Epoch: 37, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.657 Vali Acc: 0.107 Test Loss: 4.657 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.327501058578491
Epoch: 38, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.696 Vali Acc: 0.111 Test Loss: 4.696 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.0333850383758545
Epoch: 39, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.708 Vali Acc: 0.105 Test Loss: 4.708 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.136308431625366
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.724 Vali Acc: 0.111 Test Loss: 4.724 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.11176470588235295
model parameter : 193882
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.588864803314209
Epoch: 1, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.369 Vali Acc: 0.034 Test Loss: 3.369 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 3.3954803943634033
Epoch: 2, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.357 Vali Acc: 0.040 Test Loss: 3.357 Test Acc: 0.040
Validation loss decreased (-0.034084 --> -0.039966).  Saving model ...
Epoch: 3 cost time: 3.3540360927581787
Epoch: 3, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.363 Vali Acc: 0.036 Test Loss: 3.363 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6252694129943848
Epoch: 4, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.380 Vali Acc: 0.035 Test Loss: 3.380 Test Acc: 0.035
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.261733293533325
Epoch: 5, Steps: 10 | Train Loss: 2.931 Vali Loss: 3.400 Vali Acc: 0.036 Test Loss: 3.400 Test Acc: 0.036
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0205674171447754
Epoch: 6, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.394 Vali Acc: 0.044 Test Loss: 3.394 Test Acc: 0.044
Validation loss decreased (-0.039966 --> -0.043495).  Saving model ...
Epoch: 7 cost time: 3.5318777561187744
Epoch: 7, Steps: 10 | Train Loss: 2.702 Vali Loss: 3.391 Vali Acc: 0.054 Test Loss: 3.391 Test Acc: 0.054
Validation loss decreased (-0.043495 --> -0.054084).  Saving model ...
Epoch: 8 cost time: 3.4949381351470947
Epoch: 8, Steps: 10 | Train Loss: 2.617 Vali Loss: 3.393 Vali Acc: 0.055 Test Loss: 3.393 Test Acc: 0.055
Validation loss decreased (-0.054084 --> -0.055260).  Saving model ...
Epoch: 9 cost time: 3.4480061531066895
Epoch: 9, Steps: 10 | Train Loss: 2.462 Vali Loss: 3.391 Vali Acc: 0.064 Test Loss: 3.391 Test Acc: 0.064
Validation loss decreased (-0.055260 --> -0.063495).  Saving model ...
Epoch: 10 cost time: 3.3083395957946777
Epoch: 10, Steps: 10 | Train Loss: 2.336 Vali Loss: 3.390 Vali Acc: 0.071 Test Loss: 3.390 Test Acc: 0.071
Validation loss decreased (-0.063495 --> -0.070554).  Saving model ...
Epoch: 11 cost time: 3.4171881675720215
Epoch: 11, Steps: 10 | Train Loss: 2.124 Vali Loss: 3.379 Vali Acc: 0.078 Test Loss: 3.379 Test Acc: 0.078
Validation loss decreased (-0.070554 --> -0.077613).  Saving model ...
Epoch: 12 cost time: 3.402385950088501
Epoch: 12, Steps: 10 | Train Loss: 2.021 Vali Loss: 3.401 Vali Acc: 0.085 Test Loss: 3.401 Test Acc: 0.085
Validation loss decreased (-0.077613 --> -0.084672).  Saving model ...
Epoch: 13 cost time: 3.8226659297943115
Epoch: 13, Steps: 10 | Train Loss: 1.844 Vali Loss: 3.430 Vali Acc: 0.078 Test Loss: 3.430 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.330655813217163
Epoch: 14, Steps: 10 | Train Loss: 1.610 Vali Loss: 3.440 Vali Acc: 0.078 Test Loss: 3.440 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.216693639755249
Epoch: 15, Steps: 10 | Train Loss: 1.509 Vali Loss: 3.472 Vali Acc: 0.080 Test Loss: 3.472 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.528367042541504
Epoch: 16, Steps: 10 | Train Loss: 1.335 Vali Loss: 3.502 Vali Acc: 0.085 Test Loss: 3.502 Test Acc: 0.085
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.561267614364624
Epoch: 17, Steps: 10 | Train Loss: 1.159 Vali Loss: 3.549 Vali Acc: 0.089 Test Loss: 3.549 Test Acc: 0.089
Validation loss decreased (-0.084672 --> -0.089376).  Saving model ...
Epoch: 18 cost time: 3.3844690322875977
Epoch: 18, Steps: 10 | Train Loss: 0.944 Vali Loss: 3.614 Vali Acc: 0.089 Test Loss: 3.614 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5373735427856445
Epoch: 19, Steps: 10 | Train Loss: 0.807 Vali Loss: 3.693 Vali Acc: 0.087 Test Loss: 3.693 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3863866329193115
Epoch: 20, Steps: 10 | Train Loss: 0.590 Vali Loss: 3.784 Vali Acc: 0.092 Test Loss: 3.784 Test Acc: 0.092
Validation loss decreased (-0.089376 --> -0.091727).  Saving model ...
Epoch: 21 cost time: 3.5589711666107178
Epoch: 21, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.878 Vali Acc: 0.082 Test Loss: 3.878 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.667909622192383
Epoch: 22, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.976 Vali Acc: 0.085 Test Loss: 3.976 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3991172313690186
Epoch: 23, Steps: 10 | Train Loss: 0.309 Vali Loss: 4.087 Vali Acc: 0.087 Test Loss: 4.087 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.263789176940918
Epoch: 24, Steps: 10 | Train Loss: 0.236 Vali Loss: 4.163 Vali Acc: 0.096 Test Loss: 4.163 Test Acc: 0.096
Validation loss decreased (-0.091727 --> -0.096429).  Saving model ...
Epoch: 25 cost time: 3.4385764598846436
Epoch: 25, Steps: 10 | Train Loss: 0.189 Vali Loss: 4.266 Vali Acc: 0.095 Test Loss: 4.266 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2848658561706543
Epoch: 26, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.351 Vali Acc: 0.095 Test Loss: 4.351 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3984503746032715
Epoch: 27, Steps: 10 | Train Loss: 0.114 Vali Loss: 4.394 Vali Acc: 0.089 Test Loss: 4.394 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.4285166263580322
Epoch: 28, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.382 Vali Acc: 0.106 Test Loss: 4.382 Test Acc: 0.106
Validation loss decreased (-0.096429 --> -0.105839).  Saving model ...
Epoch: 29 cost time: 3.3772873878479004
Epoch: 29, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.468 Vali Acc: 0.105 Test Loss: 4.468 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4708995819091797
Epoch: 30, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.504 Vali Acc: 0.107 Test Loss: 4.504 Test Acc: 0.107
Validation loss decreased (-0.105839 --> -0.107014).  Saving model ...
Epoch: 31 cost time: 3.302922487258911
Epoch: 31, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.506 Vali Acc: 0.106 Test Loss: 4.506 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3894431591033936
Epoch: 32, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.547 Vali Acc: 0.106 Test Loss: 4.547 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.2043557167053223
Epoch: 33, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.577 Vali Acc: 0.107 Test Loss: 4.577 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.52923583984375
Epoch: 34, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.610 Vali Acc: 0.102 Test Loss: 4.610 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.101905107498169
Epoch: 35, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.644 Vali Acc: 0.105 Test Loss: 4.644 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.1944773197174072
Epoch: 36, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.669 Vali Acc: 0.104 Test Loss: 4.669 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.2337682247161865
Epoch: 37, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.668 Vali Acc: 0.106 Test Loss: 4.668 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.1104276180267334
Epoch: 38, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.719 Vali Acc: 0.101 Test Loss: 4.719 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.0312905311584473
Epoch: 39, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.754 Vali Acc: 0.102 Test Loss: 4.754 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.662302255630493
Epoch: 40, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.775 Vali Acc: 0.104 Test Loss: 4.775 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.10705882352941176
model parameter : 193882
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.097207307815552
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.325 Vali Acc: 0.036 Test Loss: 3.325 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 3.2277777194976807
Epoch: 2, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.324 Vali Acc: 0.033 Test Loss: 3.324 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2021281719207764
Epoch: 3, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.342 Vali Acc: 0.041 Test Loss: 3.342 Test Acc: 0.041
Validation loss decreased (-0.036437 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 3.126499891281128
Epoch: 4, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.367 Vali Acc: 0.046 Test Loss: 3.367 Test Acc: 0.046
Validation loss decreased (-0.041143 --> -0.045849).  Saving model ...
Epoch: 5 cost time: 3.1861319541931152
Epoch: 5, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.392 Vali Acc: 0.046 Test Loss: 3.392 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1822986602783203
Epoch: 6, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.391 Vali Acc: 0.054 Test Loss: 3.391 Test Acc: 0.054
Validation loss decreased (-0.045849 --> -0.054084).  Saving model ...
Epoch: 7 cost time: 3.0818405151367188
Epoch: 7, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.387 Vali Acc: 0.052 Test Loss: 3.387 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.609546422958374
Epoch: 8, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.390 Vali Acc: 0.055 Test Loss: 3.390 Test Acc: 0.055
Validation loss decreased (-0.054084 --> -0.055260).  Saving model ...
Epoch: 9 cost time: 2.921290636062622
Epoch: 9, Steps: 10 | Train Loss: 2.612 Vali Loss: 3.386 Vali Acc: 0.054 Test Loss: 3.386 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.483819007873535
Epoch: 10, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.386 Vali Acc: 0.066 Test Loss: 3.386 Test Acc: 0.066
Validation loss decreased (-0.055260 --> -0.065848).  Saving model ...
Epoch: 11 cost time: 3.172102212905884
Epoch: 11, Steps: 10 | Train Loss: 2.443 Vali Loss: 3.363 Vali Acc: 0.066 Test Loss: 3.363 Test Acc: 0.066
Validation loss decreased (-0.065848 --> -0.065849).  Saving model ...
Epoch: 12 cost time: 3.6269304752349854
Epoch: 12, Steps: 10 | Train Loss: 2.332 Vali Loss: 3.366 Vali Acc: 0.069 Test Loss: 3.366 Test Acc: 0.069
Validation loss decreased (-0.065849 --> -0.069378).  Saving model ...
Epoch: 13 cost time: 3.3348228931427
Epoch: 13, Steps: 10 | Train Loss: 2.199 Vali Loss: 3.391 Vali Acc: 0.071 Test Loss: 3.391 Test Acc: 0.071
Validation loss decreased (-0.069378 --> -0.070554).  Saving model ...
Epoch: 14 cost time: 3.4988884925842285
Epoch: 14, Steps: 10 | Train Loss: 1.976 Vali Loss: 3.401 Vali Acc: 0.067 Test Loss: 3.401 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0019607543945312
Epoch: 15, Steps: 10 | Train Loss: 1.907 Vali Loss: 3.424 Vali Acc: 0.059 Test Loss: 3.424 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9417898654937744
Epoch: 16, Steps: 10 | Train Loss: 1.693 Vali Loss: 3.441 Vali Acc: 0.067 Test Loss: 3.441 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5646467208862305
Epoch: 17, Steps: 10 | Train Loss: 1.585 Vali Loss: 3.473 Vali Acc: 0.060 Test Loss: 3.473 Test Acc: 0.060
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0781970024108887
Epoch: 18, Steps: 10 | Train Loss: 1.356 Vali Loss: 3.512 Vali Acc: 0.066 Test Loss: 3.512 Test Acc: 0.066
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.364670515060425
Epoch: 19, Steps: 10 | Train Loss: 1.194 Vali Loss: 3.583 Vali Acc: 0.074 Test Loss: 3.583 Test Acc: 0.074
Validation loss decreased (-0.070554 --> -0.074082).  Saving model ...
Epoch: 20 cost time: 3.4411771297454834
Epoch: 20, Steps: 10 | Train Loss: 0.950 Vali Loss: 3.642 Vali Acc: 0.082 Test Loss: 3.642 Test Acc: 0.082
Validation loss decreased (-0.074082 --> -0.082317).  Saving model ...
Epoch: 21 cost time: 3.3476979732513428
Epoch: 21, Steps: 10 | Train Loss: 0.835 Vali Loss: 3.708 Vali Acc: 0.080 Test Loss: 3.708 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7095141410827637
Epoch: 22, Steps: 10 | Train Loss: 0.682 Vali Loss: 3.814 Vali Acc: 0.074 Test Loss: 3.814 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5236284732818604
Epoch: 23, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.920 Vali Acc: 0.075 Test Loss: 3.920 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.4205245971679688
Epoch: 24, Steps: 10 | Train Loss: 0.480 Vali Loss: 3.991 Vali Acc: 0.081 Test Loss: 3.991 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.6911964416503906
Epoch: 25, Steps: 10 | Train Loss: 0.345 Vali Loss: 4.085 Vali Acc: 0.080 Test Loss: 4.085 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.560896873474121
Epoch: 26, Steps: 10 | Train Loss: 0.257 Vali Loss: 4.195 Vali Acc: 0.087 Test Loss: 4.195 Test Acc: 0.087
Validation loss decreased (-0.082317 --> -0.087017).  Saving model ...
Epoch: 27 cost time: 3.3465611934661865
Epoch: 27, Steps: 10 | Train Loss: 0.197 Vali Loss: 4.258 Vali Acc: 0.086 Test Loss: 4.258 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.103027105331421
Epoch: 28, Steps: 10 | Train Loss: 0.162 Vali Loss: 4.276 Vali Acc: 0.092 Test Loss: 4.276 Test Acc: 0.092
Validation loss decreased (-0.087017 --> -0.091722).  Saving model ...
Epoch: 29 cost time: 2.9926393032073975
Epoch: 29, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.381 Vali Acc: 0.087 Test Loss: 4.381 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.731034994125366
Epoch: 30, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.435 Vali Acc: 0.087 Test Loss: 4.435 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.3453896045684814
Epoch: 31, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.432 Vali Acc: 0.099 Test Loss: 4.432 Test Acc: 0.099
Validation loss decreased (-0.091722 --> -0.098779).  Saving model ...
Epoch: 32 cost time: 3.5002880096435547
Epoch: 32, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.473 Vali Acc: 0.101 Test Loss: 4.473 Test Acc: 0.101
Validation loss decreased (-0.098779 --> -0.101132).  Saving model ...
Epoch: 33 cost time: 3.794494867324829
Epoch: 33, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.524 Vali Acc: 0.102 Test Loss: 4.524 Test Acc: 0.102
Validation loss decreased (-0.101132 --> -0.102308).  Saving model ...
Epoch: 34 cost time: 3.401052713394165
Epoch: 34, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.573 Vali Acc: 0.096 Test Loss: 4.573 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.3175811767578125
Epoch: 35, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.609 Vali Acc: 0.091 Test Loss: 4.609 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.2191786766052246
Epoch: 36, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.630 Vali Acc: 0.099 Test Loss: 4.630 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.1227736473083496
Epoch: 37, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.626 Vali Acc: 0.099 Test Loss: 4.626 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.4775640964508057
Epoch: 38, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.692 Vali Acc: 0.095 Test Loss: 4.692 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.491413116455078
Epoch: 39, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.714 Vali Acc: 0.100 Test Loss: 4.714 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.425417900085449
Epoch: 40, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.722 Vali Acc: 0.099 Test Loss: 4.722 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.3024327754974365
Epoch: 41, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.714 Vali Acc: 0.101 Test Loss: 4.714 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.1990582942962646
Epoch: 42, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.722 Vali Acc: 0.096 Test Loss: 4.722 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.102656364440918
Epoch: 43, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.740 Vali Acc: 0.100 Test Loss: 4.740 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.10235294117647059
model parameter : 193882
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.154001235961914
Epoch: 1, Steps: 10 | Train Loss: 3.347 Vali Loss: 3.324 Vali Acc: 0.034 Test Loss: 3.324 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 3.3632776737213135
Epoch: 2, Steps: 10 | Train Loss: 3.261 Vali Loss: 3.317 Vali Acc: 0.044 Test Loss: 3.317 Test Acc: 0.044
Validation loss decreased (-0.034084 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 3.5499773025512695
Epoch: 3, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.330 Vali Acc: 0.047 Test Loss: 3.330 Test Acc: 0.047
Validation loss decreased (-0.043496 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 3.4692137241363525
Epoch: 4, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.353 Vali Acc: 0.049 Test Loss: 3.353 Test Acc: 0.049
Validation loss decreased (-0.047026 --> -0.049378).  Saving model ...
Epoch: 5 cost time: 3.180161952972412
Epoch: 5, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.379 Vali Acc: 0.049 Test Loss: 3.379 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1903727054595947
Epoch: 6, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.385 Vali Acc: 0.045 Test Loss: 3.385 Test Acc: 0.045
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.132772445678711
Epoch: 7, Steps: 10 | Train Loss: 2.978 Vali Loss: 3.385 Vali Acc: 0.048 Test Loss: 3.385 Test Acc: 0.048
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.034040927886963
Epoch: 8, Steps: 10 | Train Loss: 2.918 Vali Loss: 3.392 Vali Acc: 0.051 Test Loss: 3.392 Test Acc: 0.051
Validation loss decreased (-0.049378 --> -0.050554).  Saving model ...
Epoch: 9 cost time: 3.2961976528167725
Epoch: 9, Steps: 10 | Train Loss: 2.834 Vali Loss: 3.389 Vali Acc: 0.052 Test Loss: 3.389 Test Acc: 0.052
Validation loss decreased (-0.050554 --> -0.051731).  Saving model ...
Epoch: 10 cost time: 3.314034938812256
Epoch: 10, Steps: 10 | Train Loss: 2.745 Vali Loss: 3.392 Vali Acc: 0.053 Test Loss: 3.392 Test Acc: 0.053
Validation loss decreased (-0.051731 --> -0.052907).  Saving model ...
Epoch: 11 cost time: 3.2128896713256836
Epoch: 11, Steps: 10 | Train Loss: 2.672 Vali Loss: 3.375 Vali Acc: 0.054 Test Loss: 3.375 Test Acc: 0.054
Validation loss decreased (-0.052907 --> -0.054084).  Saving model ...
Epoch: 12 cost time: 3.338430881500244
Epoch: 12, Steps: 10 | Train Loss: 2.612 Vali Loss: 3.382 Vali Acc: 0.058 Test Loss: 3.382 Test Acc: 0.058
Validation loss decreased (-0.054084 --> -0.057613).  Saving model ...
Epoch: 13 cost time: 3.2103073596954346
Epoch: 13, Steps: 10 | Train Loss: 2.458 Vali Loss: 3.399 Vali Acc: 0.061 Test Loss: 3.399 Test Acc: 0.061
Validation loss decreased (-0.057613 --> -0.061142).  Saving model ...
Epoch: 14 cost time: 3.5364186763763428
Epoch: 14, Steps: 10 | Train Loss: 2.299 Vali Loss: 3.409 Vali Acc: 0.067 Test Loss: 3.409 Test Acc: 0.067
Validation loss decreased (-0.061142 --> -0.067025).  Saving model ...
Epoch: 15 cost time: 3.6024253368377686
Epoch: 15, Steps: 10 | Train Loss: 2.183 Vali Loss: 3.424 Vali Acc: 0.061 Test Loss: 3.424 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9895222187042236
Epoch: 16, Steps: 10 | Train Loss: 2.035 Vali Loss: 3.436 Vali Acc: 0.067 Test Loss: 3.436 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.875717878341675
Epoch: 17, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.455 Vali Acc: 0.068 Test Loss: 3.455 Test Acc: 0.068
Validation loss decreased (-0.067025 --> -0.068201).  Saving model ...
Epoch: 18 cost time: 3.076251983642578
Epoch: 18, Steps: 10 | Train Loss: 1.753 Vali Loss: 3.477 Vali Acc: 0.066 Test Loss: 3.477 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0325541496276855
Epoch: 19, Steps: 10 | Train Loss: 1.580 Vali Loss: 3.530 Vali Acc: 0.066 Test Loss: 3.530 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.580756902694702
Epoch: 20, Steps: 10 | Train Loss: 1.418 Vali Loss: 3.574 Vali Acc: 0.065 Test Loss: 3.574 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.3136398792266846
Epoch: 21, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.627 Vali Acc: 0.064 Test Loss: 3.627 Test Acc: 0.064
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.5091426372528076
Epoch: 22, Steps: 10 | Train Loss: 1.049 Vali Loss: 3.709 Vali Acc: 0.066 Test Loss: 3.709 Test Acc: 0.066
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.358755111694336
Epoch: 23, Steps: 10 | Train Loss: 0.913 Vali Loss: 3.811 Vali Acc: 0.072 Test Loss: 3.811 Test Acc: 0.072
Validation loss decreased (-0.068201 --> -0.071727).  Saving model ...
Epoch: 24 cost time: 3.289130687713623
Epoch: 24, Steps: 10 | Train Loss: 0.825 Vali Loss: 3.866 Vali Acc: 0.074 Test Loss: 3.866 Test Acc: 0.074
Validation loss decreased (-0.071727 --> -0.074079).  Saving model ...
Epoch: 25 cost time: 3.537914514541626
Epoch: 25, Steps: 10 | Train Loss: 0.622 Vali Loss: 3.963 Vali Acc: 0.071 Test Loss: 3.963 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.49155855178833
Epoch: 26, Steps: 10 | Train Loss: 0.529 Vali Loss: 4.056 Vali Acc: 0.086 Test Loss: 4.056 Test Acc: 0.086
Validation loss decreased (-0.074079 --> -0.085842).  Saving model ...
Epoch: 27 cost time: 3.316364288330078
Epoch: 27, Steps: 10 | Train Loss: 0.406 Vali Loss: 4.123 Vali Acc: 0.088 Test Loss: 4.123 Test Acc: 0.088
Validation loss decreased (-0.085842 --> -0.088194).  Saving model ...
Epoch: 28 cost time: 3.548473834991455
Epoch: 28, Steps: 10 | Train Loss: 0.335 Vali Loss: 4.168 Vali Acc: 0.087 Test Loss: 4.168 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.59390926361084
Epoch: 29, Steps: 10 | Train Loss: 0.295 Vali Loss: 4.301 Vali Acc: 0.095 Test Loss: 4.301 Test Acc: 0.095
Validation loss decreased (-0.088194 --> -0.095251).  Saving model ...
Epoch: 30 cost time: 3.4579198360443115
Epoch: 30, Steps: 10 | Train Loss: 0.214 Vali Loss: 4.396 Vali Acc: 0.091 Test Loss: 4.396 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.7953872680664062
Epoch: 31, Steps: 10 | Train Loss: 0.187 Vali Loss: 4.420 Vali Acc: 0.095 Test Loss: 4.420 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.279773235321045
Epoch: 32, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.540 Vali Acc: 0.098 Test Loss: 4.540 Test Acc: 0.098
Validation loss decreased (-0.095251 --> -0.097602).  Saving model ...
Epoch: 33 cost time: 3.436936616897583
Epoch: 33, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.525 Vali Acc: 0.095 Test Loss: 4.525 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.3678348064422607
Epoch: 34, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.545 Vali Acc: 0.096 Test Loss: 4.545 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.993807077407837
Epoch: 35, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.632 Vali Acc: 0.092 Test Loss: 4.632 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.224412202835083
Epoch: 36, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.733 Vali Acc: 0.091 Test Loss: 4.733 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.1265649795532227
Epoch: 37, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.743 Vali Acc: 0.091 Test Loss: 4.743 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.2748076915740967
Epoch: 38, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.779 Vali Acc: 0.093 Test Loss: 4.779 Test Acc: 0.093
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.247013807296753
Epoch: 39, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.850 Vali Acc: 0.096 Test Loss: 4.850 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.275958776473999
Epoch: 40, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.861 Vali Acc: 0.099 Test Loss: 4.861 Test Acc: 0.099
Validation loss decreased (-0.097602 --> -0.098775).  Saving model ...
Epoch: 41 cost time: 2.772195339202881
Epoch: 41, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.862 Vali Acc: 0.100 Test Loss: 4.862 Test Acc: 0.100
Validation loss decreased (-0.098775 --> -0.099951).  Saving model ...
Epoch: 42 cost time: 3.3349084854125977
Epoch: 42, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.888 Vali Acc: 0.094 Test Loss: 4.888 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.0790348052978516
Epoch: 43, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.909 Vali Acc: 0.092 Test Loss: 4.909 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.0469493865966797
Epoch: 44, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.967 Vali Acc: 0.098 Test Loss: 4.967 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.2580485343933105
Epoch: 45, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.007 Vali Acc: 0.095 Test Loss: 5.007 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.1769933700561523
Epoch: 46, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.011 Vali Acc: 0.101 Test Loss: 5.011 Test Acc: 0.101
Validation loss decreased (-0.099951 --> -0.101126).  Saving model ...
Epoch: 47 cost time: 3.1619701385498047
Epoch: 47, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.053 Vali Acc: 0.102 Test Loss: 5.053 Test Acc: 0.102
Validation loss decreased (-0.101126 --> -0.102302).  Saving model ...
Epoch: 48 cost time: 3.3694345951080322
Epoch: 48, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.051 Vali Acc: 0.104 Test Loss: 5.051 Test Acc: 0.104
Validation loss decreased (-0.102302 --> -0.103479).  Saving model ...
Epoch: 49 cost time: 3.048851490020752
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 5.050 Vali Acc: 0.107 Test Loss: 5.050 Test Acc: 0.107
Validation loss decreased (-0.103479 --> -0.107008).  Saving model ...
Epoch: 50 cost time: 2.9681332111358643
Epoch: 50, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.099 Vali Acc: 0.096 Test Loss: 5.099 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.261798143386841
Epoch: 51, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.144 Vali Acc: 0.101 Test Loss: 5.144 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.1499409675598145
Epoch: 52, Steps: 10 | Train Loss: 0.019 Vali Loss: 5.178 Vali Acc: 0.101 Test Loss: 5.178 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.4311952590942383
Epoch: 53, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.184 Vali Acc: 0.104 Test Loss: 5.184 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.727132797241211
Epoch: 54, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.196 Vali Acc: 0.102 Test Loss: 5.196 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.3512167930603027
Epoch: 55, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.202 Vali Acc: 0.104 Test Loss: 5.202 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.3380303382873535
Epoch: 56, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.207 Vali Acc: 0.104 Test Loss: 5.207 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.3465094566345215
Epoch: 57, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.211 Vali Acc: 0.107 Test Loss: 5.211 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.630228042602539
Epoch: 58, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.196 Vali Acc: 0.109 Test Loss: 5.196 Test Acc: 0.109
Validation loss decreased (-0.107008 --> -0.109360).  Saving model ...
Epoch: 59 cost time: 3.3243517875671387
Epoch: 59, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.195 Vali Acc: 0.113 Test Loss: 5.195 Test Acc: 0.113
Validation loss decreased (-0.109360 --> -0.112889).  Saving model ...
Epoch: 60 cost time: 3.160247564315796
Epoch: 60, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.210 Vali Acc: 0.112 Test Loss: 5.210 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.1997640132904053
Epoch: 61, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.238 Vali Acc: 0.107 Test Loss: 5.238 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 3.4150774478912354
Epoch: 62, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.307 Vali Acc: 0.106 Test Loss: 5.307 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 3.53676700592041
Epoch: 63, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.312 Vali Acc: 0.104 Test Loss: 5.312 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 3.285512924194336
Epoch: 64, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.318 Vali Acc: 0.106 Test Loss: 5.318 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 3.389190196990967
Epoch: 65, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.321 Vali Acc: 0.106 Test Loss: 5.321 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 3.4513485431671143
Epoch: 66, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.323 Vali Acc: 0.106 Test Loss: 5.323 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 3.0794854164123535
Epoch: 67, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.335 Vali Acc: 0.106 Test Loss: 5.335 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 3.0412845611572266
Epoch: 68, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.366 Vali Acc: 0.111 Test Loss: 5.366 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 3.3510148525238037
Epoch: 69, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.408 Vali Acc: 0.112 Test Loss: 5.408 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.11294117647058824
model parameter : 193882
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 13, 20, 22, 23, 27, 28, 30, 31, 32, 34, 37, 39, 40, 43, 45, 47, 51, 53, 55, 56, 59, 61, 63, 65, 69, 73, 74, 75]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 33, 34, 35, 37]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 4, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37]
modes_kv=32, index_kv=[0, 1, 5, 8, 9, 11, 13, 15, 17, 20, 24, 30, 31, 32, 35, 36, 37, 41, 42, 43, 47, 48, 49, 57, 60, 61, 65, 67, 70, 72, 73, 74]
>>>>>>>start training : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.3215320110321045
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.040 Test Loss: 3.258 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.291428565979004
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3730804920196533
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5133371353149414
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4569268226623535
Epoch: 5, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.0355098247528076
Epoch: 6, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.3754992485046387
Epoch: 7, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.118635892868042
Epoch: 8, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.642439842224121
Epoch: 9, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.031 Test Loss: 3.258 Test Acc: 0.031
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.4679625034332275
Epoch: 10, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.3442564010620117
Epoch: 11, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.258 Vali Acc: 0.034 Test Loss: 3.258 Test Acc: 0.034
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_FEDformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.04
model parameter : 193882
model size : 1.98MB
